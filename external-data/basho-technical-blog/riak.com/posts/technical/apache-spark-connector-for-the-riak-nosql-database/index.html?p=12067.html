
<!doctype html>
<html class="no-js"  xmlns="http://www.w3.org/1999/xhtml" prefix="" lang="en-US" xmlns:og="http://ogp.me/ns#" xmlns:fb="http://ogp.me/ns/fb#" prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/content/themes/basho-v2/dist/images/favicon.ico" />
    
<!-- BEGIN Metadata added by the Add-Meta-Tags WordPress plugin -->
<link rel="alternate" hreflang="en-US" href="/posts/technical/apache-spark-connector-for-the-riak-nosql-database/index.html?p=12067.html" />
<meta name="description" content="Riak Riak Apache Spark Connector – an open source library, which bridges the gap between Apache Spark and Riak. It brings the full power of Apache Spark to the operational data, managed in Riak distributed clusters. With the Riak Apache Spark Connector, Riak users now have an integrated, scalable solution for Big Data analytics and Spark users now have a resilient, highly available big data databased." />
<meta name="keywords" content="apache spark, riak, basho, big data database, edge analytics, time series database, databricks" />
<!-- END Metadata added by the Add-Meta-Tags WordPress plugin -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-39891693-3"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-39891693-3');
</script>
<!-- END Global site tag (gtag.js) - Google Analytics -->
<title>The Quest for Hidden Treasure: An Apache Spark Connector for the Riak NoSQL database &#8211; Riak</title>
<link rel='dns-prefetch' href='https://ajax.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel='stylesheet' id='contact-form-7-css'  href='/content/plugins/contact-form-7/includes/css/styles.css?ver=4.9' type='text/css' media='all' />
<link rel='stylesheet' id='popup-maker-site-css'  href='/content/plugins/popup-maker/assets/css/site.min.css?ver=1.6.6' type='text/css' media='all' />
<link rel='stylesheet' id='rs-plugin-settings-css'  href='/content/plugins/revslider/public/assets/css/settings.css?ver=5.4.6.1' type='text/css' media='all' />
<style id='rs-plugin-settings-inline-css' type='text/css'>
.regmark{font-size:15px;  position:relative;  top:-10px}@media screen and (max-width:700px){.regmark{font-size:13px;  top:-4px}}
</style>
<link rel='stylesheet' id='megamenu-css'  href='/content/uploads/maxmegamenu/style.css?ver=a8ce69' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/includes/css/dashicons.min.css?ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='megamenu-fontawesome-css'  href='/content/plugins/megamenu-pro/icons/fontawesome/css/font-awesome.min.css?ver=1.4.5' type='text/css' media='all' />
<link rel='stylesheet' id='megamenu-genericons-css'  href='/content/plugins/megamenu-pro/icons/genericons/genericons/genericons.css?ver=1.4.5' type='text/css' media='all' />
<link rel='stylesheet' id='evcal_cal_default-css'  href='/content/plugins/eventON/assets/css/eventon_styles.css?ver=2.3.15' type='text/css' media='all' />
<!-- inject:css -->
<link rel="stylesheet" href="/content/themes/basho-v2/dist/styles/styles-846178cbe9.min.css">
<!-- endinject -->
<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js'></script>
<script>window.jQuery || document.write('<script src="/content/themes/basho-v2/dist/scripts/jquery.js"><\/script>')</script>
<script type='text/javascript' src='/content/plugins/revslider/public/assets/js/jquery.themepunch.tools.min.js?ver=5.4.6.1'></script>
<script type='text/javascript' src='/content/plugins/revslider/public/assets/js/jquery.themepunch.revolution.min.js?ver=5.4.6.1'></script>
<link rel='https://api.w.org/' href='/json/index.html' />
<link rel='prev' title='Apache Spark together with Riak TS &#8211; A Powerful Solution for Event Processing' href='/posts/technical/apache-spark-together-with-riak-ts-a-powerful-solution-for-event-processing/index.html?p=11966.html' />
<link rel='next' title='IoT Education Crusade Gathers Momentum' href='/posts/business/iot-education-crusade-gathers-momentum/index.html?p=12102.html' />
<link rel="canonical" href="/posts/technical/apache-spark-connector-for-the-riak-nosql-database/index.html?p=12067.html" />
<link rel='shortlink' href='/index.html?p=12067.html' />



<script type="text/javascript">function setREVStartSize(e){
				try{ var i=jQuery(window).width(),t=9999,r=0,n=0,l=0,f=0,s=0,h=0;					
					if(e.responsiveLevels&&(jQuery.each(e.responsiveLevels,function(e,f){f>i&&(t=r=f,l=e),i>f&&f>r&&(r=f,n=e)}),t>r&&(l=n)),f=e.gridheight[l]||e.gridheight[0]||e.gridheight,s=e.gridwidth[l]||e.gridwidth[0]||e.gridwidth,h=i/s,h=h>1?1:h,f=Math.round(h*f),"fullscreen"==e.sliderLayout){var u=(e.c.width(),jQuery(window).height());if(void 0!=e.fullScreenOffsetContainer){var c=e.fullScreenOffsetContainer.split(",");if (c) jQuery.each(c,function(e,i){u=jQuery(i).length>0?u-jQuery(i).outerHeight(!0):u}),e.fullScreenOffset.split("%").length>1&&void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0?u-=jQuery(window).height()*parseInt(e.fullScreenOffset,0)/100:void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0&&(u-=parseInt(e.fullScreenOffset,0))}f=u}else void 0!=e.minHeight&&f<e.minHeight&&(f=e.minHeight);e.c.closest(".rev_slider_wrapper").css({height:f})					
				}catch(d){console.log("Failure at Presize of Slider:"+d)}
			};</script>
<style type="text/css">/** Mega Menu CSS Disabled **/</style>
	<style id="pum-styles" type="text/css" media="all">
	/* Popup Google Fonts */
@import url('https://fonts.googleapis.com/css?family=Acme|Montserrat');

/* Popup Theme 12762: Blank Center */
.pum-theme-12762, .pum-theme-blank-center { background: none } 
.pum-theme-12762 .pum-container, .pum-theme-blank-center .pum-container { padding: 0px; border-radius: 0px; border: 1px none #000000; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 1 ); background-color: rgba( 249, 249, 249, 1 ); background: none } 
.pum-theme-12762 .pum-title, .pum-theme-blank-center .pum-title { color: #000000; text-align: center; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 16px; line-height: 16px } 
.pum-theme-12762 .pum-content, .pum-theme-blank-center .pum-content { color: #8c8c8c; font-family: inherit } 
.pum-theme-12762 .pum-content + .pum-close, .pum-theme-blank-center .pum-content + .pum-close { height: auto; width: auto; left: auto; right: 0px; bottom: auto; top: 10px; padding: 4px; color: #ffffff; font-family: inherit; font-size: 12px; line-height: 14px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 158, 1, 1 ) } 
/* Popup Theme 11529: Default No Padding */
.pum-theme-11529, .pum-theme-default-no-padding { background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11529 .pum-container, .pum-theme-default-no-padding .pum-container { padding: 0px; border-radius: 0px; border: 1px none #000000; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.23 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11529 .pum-title, .pum-theme-default-no-padding .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 32px; line-height: 36px } 
.pum-theme-11529 .pum-content, .pum-theme-default-no-padding .pum-content { color: #8c8c8c; font-family: inherit } 
.pum-theme-11529 .pum-content + .pum-close, .pum-theme-default-no-padding .pum-content + .pum-close { height: auto; width: auto; left: auto; right: 0px; bottom: auto; top: 0px; padding: 8px; color: #ffffff; font-family: inherit; font-size: 12px; line-height: 14px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 158, 1, 1 ) } 
/* Popup Theme 11527: Framed Border */
.pum-theme-11527, .pum-theme-framed-border { background-color: rgba( 255, 255, 255, 0.5 ) } 
.pum-theme-11527 .pum-container, .pum-theme-framed-border .pum-container { padding: 18px; border-radius: 0px; border: 20px outset #dd3333; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.97 ) inset; background-color: rgba( 255, 251, 239, 1 ) } 
.pum-theme-11527 .pum-title, .pum-theme-framed-border .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 32px; line-height: 36px } 
.pum-theme-11527 .pum-content, .pum-theme-framed-border .pum-content { color: #2d2d2d; font-family: inherit } 
.pum-theme-11527 .pum-content + .pum-close, .pum-theme-framed-border .pum-content + .pum-close { height: 20px; width: 20px; left: auto; right: -20px; bottom: auto; top: -20px; padding: 0px; color: #ffffff; font-family: Acme; font-size: 20px; line-height: 20px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 0, 0, 0, 0.55 ) } 
/* Popup Theme 11526: Cutting Edge */
.pum-theme-11526, .pum-theme-cutting-edge { background-color: rgba( 0, 0, 0, 0.5 ) } 
.pum-theme-11526 .pum-container, .pum-theme-cutting-edge .pum-container { padding: 18px; border-radius: 0px; border: 1px none #000000; box-shadow: 0px 10px 25px 0px rgba( 2, 2, 2, 0.5 ); background-color: rgba( 30, 115, 190, 1 ) } 
.pum-theme-11526 .pum-title, .pum-theme-cutting-edge .pum-title { color: #ffffff; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: Sans-Serif; font-size: 26px; line-height: 28px } 
.pum-theme-11526 .pum-content, .pum-theme-cutting-edge .pum-content { color: #ffffff; font-family: inherit } 
.pum-theme-11526 .pum-content + .pum-close, .pum-theme-cutting-edge .pum-content + .pum-close { height: 24px; width: 24px; left: auto; right: 0px; bottom: auto; top: 0px; padding: 0px; color: #1e73be; font-family: inherit; font-size: 32px; line-height: 24px; border: 1px none #ffffff; border-radius: 0px; box-shadow: -1px 1px 1px 0px rgba( 2, 2, 2, 0.1 ); text-shadow: -1px 1px 1px rgba( 0, 0, 0, 0.1 ); background-color: rgba( 238, 238, 34, 1 ) } 
/* Popup Theme 11525: Hello Box */
.pum-theme-11525, .pum-theme-hello-box { background-color: rgba( 0, 0, 0, 0.75 ) } 
.pum-theme-11525 .pum-container, .pum-theme-hello-box .pum-container { padding: 30px; border-radius: 80px; border: 14px solid #81d742; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11525 .pum-title, .pum-theme-hello-box .pum-title { color: #2d2d2d; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: Montserrat; font-size: 32px; line-height: 36px } 
.pum-theme-11525 .pum-content, .pum-theme-hello-box .pum-content { color: #2d2d2d; font-family: inherit } 
.pum-theme-11525 .pum-content + .pum-close, .pum-theme-hello-box .pum-content + .pum-close { height: auto; width: auto; left: auto; right: -30px; bottom: auto; top: -30px; padding: 0px; color: #2d2d2d; font-family: inherit; font-size: 32px; line-height: 28px; border: 1px none #ffffff; border-radius: 28px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 255, 255, 1 ) } 
/* Popup Theme 11524: Enterprise Blue */
.pum-theme-11524, .pum-theme-enterprise-blue { background-color: rgba( 0, 0, 0, 0.7 ) } 
.pum-theme-11524 .pum-container, .pum-theme-enterprise-blue .pum-container { padding: 28px; border-radius: 5px; border: 1px none #000000; box-shadow: 0px 10px 25px 4px rgba( 2, 2, 2, 0.5 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11524 .pum-title, .pum-theme-enterprise-blue .pum-title { color: #315b7c; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 34px; line-height: 36px } 
.pum-theme-11524 .pum-content, .pum-theme-enterprise-blue .pum-content { color: #2d2d2d; font-family: inherit } 
.pum-theme-11524 .pum-content + .pum-close, .pum-theme-enterprise-blue .pum-content + .pum-close { height: 28px; width: 28px; left: auto; right: 8px; bottom: auto; top: 8px; padding: 4px; color: #ffffff; font-family: inherit; font-size: 20px; line-height: 20px; border: 1px none #ffffff; border-radius: 42px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 49, 91, 124, 1 ) } 
/* Popup Theme 11523: Light Box */
.pum-theme-11523, .pum-theme-lightbox { background-color: rgba( 0, 0, 0, 0.6 ) } 
.pum-theme-11523 .pum-container, .pum-theme-lightbox .pum-container { padding: 18px; border-radius: 3px; border: 8px solid #000000; box-shadow: 0px 0px 30px 0px rgba( 2, 2, 2, 1 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11523 .pum-title, .pum-theme-lightbox .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 32px; line-height: 36px } 
.pum-theme-11523 .pum-content, .pum-theme-lightbox .pum-content { color: #000000; font-family: inherit } 
.pum-theme-11523 .pum-content + .pum-close, .pum-theme-lightbox .pum-content + .pum-close { height: 30px; width: 30px; left: auto; right: -24px; bottom: auto; top: -24px; padding: 0px; color: #ffffff; font-family: inherit; font-size: 24px; line-height: 26px; border: 2px solid #ffffff; border-radius: 30px; box-shadow: 0px 0px 15px 1px rgba( 2, 2, 2, 0.75 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 0, 0, 0, 1 ) } 
/* Popup Theme 11522: Default Theme */
.pum-theme-11522, .pum-theme-default-theme { background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11522 .pum-container, .pum-theme-default-theme .pum-container { padding: 15px; border-radius: 3px; border: 1px none #000000; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.23 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11522 .pum-title, .pum-theme-default-theme .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 28px; line-height: 30px } 
.pum-theme-11522 .pum-content, .pum-theme-default-theme .pum-content { color: #8c8c8c; font-family: inherit } 
.pum-theme-11522 .pum-content + .pum-close, .pum-theme-default-theme .pum-content + .pum-close { height: auto; width: auto; left: auto; right: 0px; bottom: auto; top: 0px; padding: 8px; color: #ffffff; font-family: inherit; font-weight: 400; font-size: 11px; line-height: 13px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 158, 1, 1 ) } 

	
		</style>
<!-- START - Facebook Open Graph, Google+ and Twitter Card Tags 2.1.2 -->
 <!-- Facebook Open Graph -->
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Riak"/>
  <meta property="og:title" content="The Quest for Hidden Treasure: An Apache Spark Connector for the Riak NoSQL database"/>
  <meta property="og:url" content="/posts/technical/apache-spark-connector-for-the-riak-nosql-database/"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This article introduces Riak Spark Connector, an open source library which bridges the gap between Apache Spark and Riak NoSQL database. It brings the full power of Apache Spark to the operational data, managed in Riak distributed clusters."/>
  <meta property="og:image" content="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-3-of-31.png"/>
  <meta property="article:published_time" content="2016-08-11T20:44:09+00:00"/>
  <meta property="article:modified_time" content="2016-08-16T13:11:53+00:00" />
  <meta property="og:updated_time" content="2016-08-16T13:11:53+00:00" />
  <meta property="article:section" content="Technical Blog"/>
 <!-- Google+ / Schema.org -->
  <meta itemprop="name" content="The Quest for Hidden Treasure: An Apache Spark Connector for the Riak NoSQL database"/>
  <meta itemprop="description" content="This article introduces Riak Spark Connector, an open source library which bridges the gap between Apache Spark and Riak NoSQL database. It brings the full power of Apache Spark to the operational data, managed in Riak distributed clusters."/>
  <meta itemprop="image" content="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-3-of-31.png"/>
 <!-- Twitter Cards -->
 <!-- SEO -->
 <!-- Misc. tags -->
<!-- END - Facebook Open Graph, Google+ and Twitter Card Tags 2.1.2 -->
	
	<style>
	_:-ms-input-placeholder, :root .page-template-tpl-riakkv .title_ph {  margin-left:16%; }
	_:-ms-input-placeholder, :root .page-template-tpl-products .home_3_data .title_ph {  margin-left:28.5%; }
	_:-ms-input-placeholder, :root .page-template-tpl-products .home_4_data .title_ph {  margin-left:20.5%; }
	</style>
	 </head>
  <body class="post-template-default single single-post postid-12067 single-format-standard mega-menu-primary-navigation apache-spark-connector-for-the-riak-nosql-database sidebar-primary">
    <!--[if lt IE 9]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    


<div id="screen_viewport">
	
	<div id="head_container" class="row">
		<header>
			
			<div class="row upper">
				
				<div class="header-contain">
				
					<div class="col-sm-3 header-upper-left">
						
						<div class="logo_home">
							<a href="/index.html"><img alt="Riak logo" src="/content/themes/basho-v2/dist/images/riak.png"></a>
						</div>
	
					</div><!-- end header-upper-left-->
					<div class="col-sm-9 header-upper-right">
					
		
						<div class="quick_tools">
	<ul class="quick_links">
								<li><a href="https://docs.riak.com/index.html" target="_blank">DOWNLOAD RIAK</a></li><li><a href="https://docs.riak.com/index.html">DOCS</a></li>								<li class="lang_menu sling_lang"><a href="javascript: void(0);" class="language_choice">ENGLISH</a>
									<ul>
										<li class="language sling_lang"><a href="http://www.riak.com/index.html" rel="http://www.riak.com">English</a></li>
										<li class="language sling_lang"><a href="http://jp.riak.com/posts/technical/apache-spark-connector-for-the-riak-nosql-database/" rel="http://jp.riak.com">日本語</a></li>
										<li class="language sling_lang"><a href="http://de.riak.com/posts/technical/apache-spark-connector-for-the-riak-nosql-database/" rel="http://de.riak.com">Deutsch</a></li>
										<li class="language sling_lang"><a href="http://fr.riak.com/posts/technical/apache-spark-connector-for-the-riak-nosql-database/" rel="http://fr.riak.com">Fran&ccedil;ais</a></li>
									</ul>
								</li>
							</ul>
						</div>
		
					</div><!-- end header-upper-right-->
					<div class="cf clearfix"></div>
				</div>	<!-- end header-contain -->
		</div><!-- end row -->
		<div class="col-sm-12 row header-lower">

			<div class="header-contain">

				<div class="main_nav">
					<ul class="main_nav_top">

						<div id="mega-menu-wrap-primary_navigation" class="mega-menu-wrap"><div class="mega-menu-toggle" tabindex="0"><div class='mega-toggle-block mega-menu-toggle-block mega-toggle-block-right mega-toggle-block-1' id='mega-toggle-block-1'></div></div><ul id="mega-menu-primary_navigation" class="mega-menu mega-menu-horizontal mega-no-js" data-event="hover_intent" data-effect="slide" data-effect-speed="200" data-second-click="close" data-document-click="collapse" data-vertical-behaviour="standard" data-breakpoint="600" data-unbind="true"><li class='mega-add-arrow mega-m-products mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-left mega-menu-megamenu mega-hide-arrow mega-menu-item-11815' id='mega-menu-item-11815'><a class="mega-menu-link" href="/products/" aria-haspopup="true" tabindex="0">Products</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-columns-1-of-3 mega-menu-item-11816' id='mega-menu-item-11816'><a class="mega-menu-link" href="/products/">Overview</a></li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-menu-columns-1-of-3 mega-menu-item-11817' id='mega-menu-item-11817'><a class="mega-menu-link" href="/products/riak-kv/" aria-haspopup="true">Riak<sup>®</sup> KV</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11819' id='mega-menu-item-11819'><a class="mega-menu-link" href="/products/riak-kv/index.html#features">Features</a></li><li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11820' id='mega-menu-item-11820'><a class="mega-menu-link" href="/products/riak-kv/index.html#commercial">Commercial V. OSS</a></li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-has-icon mega-menu-item-11821' id='mega-menu-item-11821'><a class="fa-sign-out mega-menu-link" href="/products/riak-kv/resiliency/index.html?p=10906.html">Take Feature Tour</a></li>	</ul>
	</li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-menu-columns-1-of-3 mega-menu-item-11822' id='mega-menu-item-11822'><a class="mega-menu-link" href="/products/riak-ts/" aria-haspopup="true">Riak<sup>®</sup> TS</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11824' id='mega-menu-item-11824'><a class="mega-menu-link" href="/products/riak-ts/index.html#features">Features</a></li><li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11825' id='mega-menu-item-11825'><a class="mega-menu-link" href="/products/riak-ts/index.html#commercial">Commercial V. OSS</a></li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-has-icon mega-menu-item-11826' id='mega-menu-item-11826'><a class="fa-sign-out mega-menu-link" href="/products/riak-ts/resiliency/index.html?p=10650.html">Take Feature Tour</a></li>	</ul>
	</li></ul>
	</li><li class='mega-m-integrations mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-left mega-menu-megamenu mega-hide-arrow mega-menu-item-11827' id='mega-menu-item-11827'><a class="mega-menu-link" href="/products/integrations/" aria-haspopup="true" tabindex="0">Integrations</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-10' id='mega-menu-item-nav_menu-10'><ul id="menu-integrations-column-1" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11990"><a href="/products/apache-spark/">Apache Spark</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11885"><a href="/products/solr/">Apache Solr</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11883"><a href="/products/apache-mesos/index.html?p=11511.html">Apache Mesos</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11886"><a href="/products/redis/index.html?p=6927.html">Redis Caching</a></li>
	</ul></li><li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-11' id='mega-menu-item-nav_menu-11'><ul id="menu-integrations-column-2" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-11887"><a href="/products/riak-s2/index.html?p=6196.html">Riak S2</a>
	<ul  class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11888"><a href="/products/riak-s2/index.html?p=6196.html#features">Features</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11889"><a href="/products/riak-s2/index.html?p=6196.html#commercial">Commercial V. OSS</a></li>
	</ul>
	</li>
	</ul></li></ul>
	</li><li class='mega-m-resources mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-left mega-menu-megamenu mega-hide-arrow mega-menu-item-11837' id='mega-menu-item-11837'><a class="mega-menu-link" href="/resources/" aria-haspopup="true" tabindex="0">Resources</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-2' id='mega-menu-item-nav_menu-2'><ul id="menu-resources-column-1" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-11890"><a href="/resources/">Resource Center</a>
	<ul  class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11892"><a href="/resources/index.html?resource=types&amp;t=DATASHEET">DataSheets</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11893"><a href="/resources/index.html?resource=types&amp;t=WHITEPAPER">WhitePapers</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11894"><a href="/resources/index.html?resource=types&amp;t=SOLUTION BRIEF">Solution Briefs</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11895"><a href="/resources/index.html?resource=types&amp;t=CASE STUDY">Case Studies</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11896"><a href="/resources/index.html?resource=types&amp;t=USER STORY">User Stories</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11897"><a href="/resources/index.html?resource=types&amp;t=CUSTOMER TESTIMONIAL">Customer Testimonials</a></li>
	</ul>
	</li>
	</ul></li><li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-3' id='mega-menu-item-nav_menu-3'><ul id="menu-resources-column-2" class="menu">
	</ul></li></ul>
	</li><li class='mega-add-arrow mega-m-blog mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-right mega-menu-flyout mega-hide-arrow mega-menu-item-11839' id='mega-menu-item-11839'><a class="mega-menu-link" href="/blog/" aria-haspopup="true" tabindex="0">Blog</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-item-11841' id='mega-menu-item-11841'><a class="mega-menu-link" href="/category/technical/">Technical</a></li><li class='mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-item-11840' id='mega-menu-item-11840'><a class="mega-menu-link" href="/category/business/">Business</a></li></ul>
	</li></ul></div>						</ul>
				</div>
				<div class="cf clearfix"></div>
			</div>	<!-- end header-contain -->	

			</div><!-- end header-lower-->

			
		</header>
	</div>
	    <div class="wrap container" role="document">
      <div class="content row">
        <main class="main" role="main">
          
<div id="subpage_nav">
	<div class="subpage_nav_content">
				<h1>Riak Blog</h1>
				<div class="right_side">
					<ul>
						<li><a class="home_link" href="/index.html">Home</a></li>
						<li><a class="home_link" href="/blog/index.html">Blog</a></li>
					</ul>
				</div>
		</div>
	</div>
</div>
<div id="fb-root"></div>
<script>(function (d, s, id) {
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id))
			return;
		js = d.createElement(s);
		js.id = id;
		js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=291833560991925";
		fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>
	<div id="content_blogsingle" class="row">
		<div class="tier_1 tier">
			<div class="content_home_1">
				<article class="post-12067 post type-post status-publish format-standard has-post-thumbnail hentry category-technical tag-apache-spark tag-big-data-database tag-databricks tag-edge-analytics tag-key-value-database tag-riak-kv tag-riak-ts tag-time-series-database">
					<header> 
												<h1 class="entry-title">The Quest for Hidden Treasure: An Apache Spark Connector for the Riak NoSQL database</h1>
						<div class="entry-meta">
							<time class="updated" datetime="2016-08-11T20:44:09+00:00">Posted August 11, 2016</time>
							<p class="byline author vcard"> <a href="/posts/author/pavelhardak/index.html" rel="author" class="fn">by Pavel Hardak</a></p>							<p class="category">Category: <a href="/category/technical/index.html" rel="category tag">Technical Blog</a></p>
													</div>
					</header>
					<div class="entry-content">
						<p><span style="font-weight: 400;">Databricks recently published my blog <a href="https://databricks.com/blog/2016/08/11/the-quest-for-hidden-treasure-an-apache-spark-connector-for-the-riak-nosql-database.html">“The Quest for Hidden Treasure: An Apache Spark Connector for Riak NoSQL Database”</a><a href="http://Databricks recently published my blog “The Quest for Hidden Treasure: An Apache Spark Connector for Riak NoSQL Database”. We have taken the liberty of reposting this blog below. This blog describes Riak Spark Connector – an open source library, which bridges the gap between Apache Spark and Riak. It brings the full power of Apache Spark to the operational data, managed in Riak distributed clusters. With the Riak Apache Spark Connector, Riak users now have an integrated, scalable solution for Big Data analytics and Spark users now have a resilient, highly available data store. I wanted to add a bit more information about the beginnings of NoSQL, more about and Riak and finally provide some information on Riak TS.">.</a> We have taken the liberty of reposting this blog below.  </span>I&#8217;m adding more information about Riak and the development of Riak TS for some added context.</p>
<p><b>Riak KV &#8211; a flexible database</b></p>
<p><span style="font-weight: 400;">There are continual debates about which NoSQL database is better, or faster, or easier to operate, or has “that specific feature really needed for this use case”. In reality, it very much depends on many factors &#8211; data size and life cycle, read and write query ratios and patterns, environment (cloud vs on-premises vs hybrid), cost of hardware and software licenses, skill set of the operations team, resilience aligned to use case, ease of operational support and more. </span></p>
<p><span style="font-weight: 400;">Riak is a multi-model Big Data database and since it&#8217;s a key/value database, can be used as a document database, time series database and many other models. </span><a href="/products/riak-enterprise/index.html#riak"><span style="font-weight: 400;">Riak</span></a><span style="font-weight: 400;">, with many new capabilities, is being adopted for use cases that require scale, speed, high availability and operational simplicity like </span><a href="/use-cases/iot-sensor-device-data/index.html?p=538.html"><span style="font-weight: 400;">IoT</span></a><span style="font-weight: 400;">, </span><a href="/use-cases/metrics-log-analytics/index.html?p=556.html"><span style="font-weight: 400;">metrics</span></a><span style="font-weight: 400;"> and </span><a href="/use-cases/iot-sensor-device-data/index.html?p=538.html"><span style="font-weight: 400;">edge-device analytics</span></a><span style="font-weight: 400;">. </span></p>
<p><b>Riak TS – focus on Time Series and SQL</b></p>
<p><span style="font-weight: 400;">Riak TS reuses much of the same code as Riak KV and provides the same scalability, resilience and operational simplicity, but adds specific features to handle time-series data. Typical key/value use cases are session data, customer profiles, chat, and content-agnostic storage but Riak TS is designed specifically for</span><a href="/use-cases/index.html"><span style="font-weight: 400;"> time-series use cases</span></a><span style="font-weight: 400;">, like IoT (Internet of Things), sensor data, financial transactions, etc. Riak TS and Riak KV share the same proven Riak Core, which implements principles from “Dynamo paper”, but Riak TS adds very fast bulk writes and very efficient “time slice” query operations.</span></p>
<p><span style="font-weight: 400;">In addition to being a distributed, masterless, highly available and linearly scalable NoSQL data store, Riak TS adds a number of SQL-like capabilities. It includes a DDL for tables (yeah, </span><a href="https://docs.riak.com/riak/ts/latest/using/creating-activating/"><span style="font-weight: 400;">CREATE TABLE</span></a><span style="font-weight: 400;"> &#8230;) with named attributes and data types, primary keys (used both for local indexing and clustering), a subset of </span><a href="https://docs.riak.com/riak/ts/1.3.0/using/querying/index.html"><span style="font-weight: 400;">SQL query language</span></a><span style="font-weight: 400;"> with filters and </span><a href="https://docs.riak.com/riak/ts/latest/using/aggregate-functions/"><span style="font-weight: 400;">aggregations</span></a><span style="font-weight: 400;"> and more (additional SQL commands are being added as we speak).</span></p>
<p><span style="font-weight: 400;">Adding SQL support for a NoSQL database is not a trivial endeavor by itself and we were happy to leverage SQL capabilities, mapping them to well-known Spark constructs, such as </span><a href="https://docs.riak.com/riak/ts/latest/add-ons/spark-riak-connector/usage/dataframes/index.html"><span style="font-weight: 400;">DataFrames</span></a><span style="font-weight: 400;"> and </span><a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#reading-data-from-ts-table"><span style="font-weight: 400;">Spark SQL</span></a><span style="font-weight: 400;">. Riak Spark Connector automatically </span><a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#ts-table-range-query-partitioning"><span style="font-weight: 400;">partitions SQL queries</span></a><span style="font-weight: 400;"> between Spark workers. Riak TS also supports key/value functionality, which does not have a schema, so we used Spark RDDs to </span><a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#reading-data-from-kv-bucket"><span style="font-weight: 400;">integrate with key/value (KV) buckets</span></a><span style="font-weight: 400;">. It is convenient and more efficient to store device metadata, configuration information and profiles in key/value buckets.</span></p>
<p>Riak Spark Connector features:</p>
<ul>
<li style="font-weight: 400;"><span style="font-weight: 400;">Expose data in Riak TS tables as a Spark RDD or Spark DataFrames</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Leverage Riak TS SQL range queries using Spark SQL</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">The ability to construct an RDD from a given set of keys</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Parallel full-table reads into multiple partitions</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Save Spark DataFrames in Riak TS</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Save an RDD in Riak TS</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Plus more….</span></li>
</ul>
<p>Enjoy as we dig into our Apache Spark integration below.</p>
<hr />
<h2>As published on <a href="https://databricks.com/blog/2016/08/11/the-quest-for-hidden-treasure-an-apache-spark-connector-for-the-riak-nosql-database.html">Databricks.com</a></h2>
<p>&nbsp;</p>
<p>This article introduces <a href="/products/riak-ts/apache-spark-connector/index.html?p=10657.html" target="_blank">Riak Spark Connector</a>, an open source library which bridges the gap between Apache Spark and Riak NoSQL database. It brings the full power of Apache Spark to the operational data, managed in Riak distributed clusters. With the Riak Apache Spark Connector, Riak users now have an integrated, scalable solution for Big Data analytics and Spark users now have a resilient, highly available data store.</p>
<h2>About Riak</h2>
<p>Riak is open source, distributed NoSQL database, which is developed and supported by <a href="/index.html" target="_blank">Riak Technologies</a>. Riak offers two major products: Riak KV (Key Value) and Riak TS (Time Series). Both products share the same core code base, but are tuned for different use cases. <a href="https://docs.riak.com/riak/kv/latest/" target="_blank">Riak KV</a> is a highly resilient, scalable, key-value store. Riak KV is known for its ability to scale up and down in a linear fashion, handle huge amounts of reads, updates and writes with low latency while being extremely reliable and fault tolerant. More recently, <a href="/products/riak-ts/index.html" target="_blank">Riak TS</a> was introduced, specifically optimized for time series data. It adds very fast bulk writes, very efficient “time slice” read queries and supports a subset of the SQL language over Riak TS tables.</p>
<h2>Introducing the Riak Connector for Apache Spark</h2>
<p>We have found that many leading organizations use a mix of NoSQL and SQL database products in their infrastructure as each one has specific advantages depending on the use case. In the past, some databases were used more for analytical workloads while others were used for operational ones. As modern NoSQL databases, like <a href="/products/riak-enterprise/index.html#riak" target="_blank">Riak</a>, are gaining new capabilities, they are being adopted for additional use cases, like <a href="/use-cases/iot-sensor-device-data/index.html?p=538.html" target="_blank">IoT</a>, <a href="/use-cases/metrics-log-analytics/index.html?p=556.html" target="_blank">metrics</a>, and <a href="/use-cases/iot-sensor-device-data/index.html?p=538.html" target="_blank">edge-device analytics</a>. To make it easier to perform such tasks, Riak has created a <a href="/products/riak-ts/apache-spark-connector/index.html?p=10657.html" target="_blank">Riak Spark Connector</a>, as we believe that Apache Spark is currently the best technology choice to use alongside Riak. Riak selected Spark for this development effort not only due to customer and market demand but also due to the fact that Spark and Riak share major design principles: high performance, scalability, resiliency and operational simplicity.</p>
<h2>Implementing the Apache Spark Connector for Riak</h2>
<p>Modeled using principles from the <a href="https://docs.riak.com/riak/kv/latest/learn/dynamo/" target="_blank">“AWS Dynamo” paper</a>, Riak KV buckets are good for scenarios which require frequent, small data-sized operations in near real-time, especially workloads with reads, writes, and updates — something which might cause data corruption in some distributed databases or bring them to “crawl” under bigger workloads. In Riak, each data item is <a href="https://docs.riak.com/riak/kv/latest/learn/concepts/replication/" target="_blank">replicated</a> on several nodes, which allows the database to process a huge number of operations with very low latency while having unique <a href="https://docs.riak.com/riak/kv/2.1.4/learn/concepts/active-anti-entropy/active-anti-entropy.1.html" target="_blank">anti-corruption</a> and <a href="https://docs.riak.com/riak/kv/latest/developing/usage/conflict-resolution/" target="_blank">conflict-resolution mechanisms</a>. However, integration with Apache Spark requires a very different mode of operation — extracting large amounts of data in bulk, so that Spark can do its “magic” in memory over the whole data set. One approach to solve this challenge is to create a myriad of Spark workers, each asking for several data items. This approach works well with Riak, but it creates unacceptable overhead on the Spark side.</p>
<p><img class="aligncenter wp-image-12072" src="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-1-of-31.png" alt="Riak-Spark-Connector-Diagram-1-of-3.png" width="650" height="571" srcset="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-1-of-31.png 850w, /content/uploads/2016/08/Riak-Spark-Connector-Diagram-1-of-31-300x264.png 300w, /content/uploads/2016/08/Riak-Spark-Connector-Diagram-1-of-31-768x675.png 768w" sizes="(max-width: 650px) 100vw, 650px" /></p>
<p>Another option is using Riak’s built-in <a href="https://docs.riak.com/riak/kv/latest/developing/usage/secondary-indexes/" target="_blank">secondary index query</a> (2i). In this approach, the user’s application contacts any Riak node with a query, then this Riak node, becoming a “coordinating node”, queries all other relevant Riak nodes, collects required keys and streams it back to the user application. Then the user app will loop over the keys to retrieve the values. Alas, it was found that queries with a bigger result set could possibly overload the coordinating node. Again, not a good result, so we had to teach Riak new tricks.</p>
<p><img class="aligncenter wp-image-12073" src="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-2-of-31.png" alt="Riak-Spark-Connector-Diagram-2-of-3[1]" width="650" height="630" srcset="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-2-of-31.png 850w, /content/uploads/2016/08/Riak-Spark-Connector-Diagram-2-of-31-300x291.png 300w, /content/uploads/2016/08/Riak-Spark-Connector-Diagram-2-of-31-768x745.png 768w" sizes="(max-width: 650px) 100vw, 650px" /></p>
<p>The solution was found in enhancing the 2i query with a smart Coverage Plan and Parallel Extract APIs. In the new approach, the user application contacts the coordinating node, but this time instead of doing all the work, this node returns the locations of the data using cluster replication and availability information. Then “N” Spark workers open “N” parallel connections to different nodes, which allow the application to retrieve the desired dataset “N” times faster, without generating “hot spots”. To make it even faster, we implemented a special type of bulk query, called a “full bucket read”, which extracts the whole logical bucket without the need for a query condition. Also, it returns both keys and values, saving another round-trip to the server.</p>
<p><img class="aligncenter wp-image-12074" src="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-3-of-31.png" alt="Riak-Spark-Connector-Diagram-3-of-3.png" width="650" height="602" srcset="/content/uploads/2016/08/Riak-Spark-Connector-Diagram-3-of-31.png 850w, /content/uploads/2016/08/Riak-Spark-Connector-Diagram-3-of-31-300x278.png 300w, /content/uploads/2016/08/Riak-Spark-Connector-Diagram-3-of-31-768x711.png 768w" sizes="(max-width: 650px) 100vw, 650px" /></p>
<p>The strength of a <a href="https://docs.riak.com/riak/kv/2.1.4/learn/concepts/buckets/" target="_blank">Riak KV bucket</a> is its ability to store unstructured data in a schema-less architecture with the “values” being opaque. But for many Spark use cases, data must be mapped into a record with Scala or Java types. Fortunately, many Riak applications use JSON, which allows Spark developers to easily <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#spark-dataframes-with-kv-bucket" target="_blank">convert it into a Spark DataFrame</a> by providing a user-defined schema. The conversion happens “on the fly” and makes it easier for a Spark programmer to work with the retrieved data.</p>
<p><code>import sqlContext.implicits._<br />
val sqlContext = new org.apache.spark.sql.SQLContext(sc)<br />
case class UserData(user_id: String, name: String, age: Int, category: String)<br />
val kv_bucket_name = new Namespace("test-data")<br />
val riakRdd = sc.riakBucket[UserData](kv_bucket_name).queryAll()<br />
val df = riakRdd.toDF()<br />
df.where(df("age") &gt;= 50).select("id", "name")<br />
df.groupBy("category").count</code></p>
<h2>Riak TS meets Spark SQL</h2>
<p>Being a distributed, masterless, highly available and linearly scalable NoSQL data store, Riak TS adds a number of SQL-like capabilities. It includes a DDL for tables (yeah, <a href="https://docs.riak.com/riak/ts/latest/using/creating-activating/" target="_blank">CREATE TABLE</a> …) with named attributes and data types, primary keys (used both for local indexing and clustering), a subset of <a href="https://docs.riak.com/riak/ts/1.3.0/using/querying/index.html" target="_blank">SQL query language</a> with filters and <a href="https://docs.riak.com/riak/ts/latest/using/aggregate-functions/" target="_blank">aggregations</a> and more (additional SQL commands are being added as we speak).</p>
<p>Adding SQL support for a NoSQL database is not a trivial endeavor by itself and we were happy to leverage SQL capabilities, mapping them to well-known Spark constructs, such as <a href="https://docs.riak.com/riak/ts/latest/add-ons/spark-riak-connector/usage/dataframes/index.html" target="_blank">DataFrames</a> and <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#reading-data-from-ts-table" target="_blank">Spark SQL</a>. Riak Spark Connector <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#ts-table-range-query-partitioning" target="_blank">automatically partitions SQL queries</a> between Spark workers. Riak TS also supports key/value functionality, which does not have a schema, so <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#reading-data-from-kv-bucket" target="_blank">we used Spark RDDs to integrate with key/value (KV) buckets</a>. It is convenient and more efficient to store device metadata, configuration information, and profiles in key/value buckets.</p>
<p><code>val ts_table_name = "input-table"<br />
val df = sc.riakTSTable(ts_table_name)<br />
.sql(s"SELECT * FROM $ts_table_name WHERE time &gt;= $from AND time &lt;= $to")<br />
// ...<br />
val output_ts_table = "result-table"<br />
df.saveToRiakTS(output_ts_table);</code></p>
<p><a href="https://github.com/basho/spark-riak-connector" target="_blank">Riak Spark Connector</a> is implemented in Scala, supporting both <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/getting-connector.md#java" target="_blank">Java</a> and <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/getting-connector.md#scala" target="_blank">Scala</a>, but its <a href="https://docs.riak.com/riak/ts/latest/add-ons/spark-riak-connector/usage/dataframes/index.html" target="_blank">DataFrames</a> functionality gave us an easy way to also support <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/getting-connector.md#python" target="_blank">Python</a> to query and write into Riak TS tables. Python support for KV buckets will arrive soon, but for now developers can use either Java or Scala with KV buckets.</p>
<p><code>df = sqlContext.read \<br />
.option("spark.riak.connection.hosts","riak_host_ip:10017") \<br />
.format("org.apache.spark.sql.riak") \<br />
.load(ts_table_name) \<br />
.select("time", "col1", "col2") \<br />
.filter(s"time &gt;= CAST($from AS TIMESTAMP) AND time &lt;= CAST($to AS TIMESTAMP) AND col1= $value1")</code></p>
<p><a href="https://docs.riak.com/riak/ts/latest/add-ons/spark-riak-connector/usage/streaming-example/index.html" target="_blank">Spark Streaming</a> is also supported for writing into Riak TS. In a typical pipeline, a Spark Streaming job would read (a.k.a. “consume”) the data from a Kafka topic and <a href="https://docs.riak.com/riak/ts/latest/add-ons/spark-riak-connector/usage/writing-data/index.html" target="_blank">efficiently write (stream) it into Riak TS</a> at high speed, automatically spreading the load across multiple nodes. Then <a href="https://docs.riak.com/riak/ts/latest/using/querying/" target="_blank">users can query Riak TS</a> using familiar SQL commands or use the Spark Connector to <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#reading-data-from-ts-table" target="_blank">extract the data</a> for processing in the Spark Cluster, optionally <a href="https://github.com/basho/spark-riak-connector/blob/master/docs/using-connector.md#ts-bulk-write" target="_blank">writing the results back</a> into Riak TS.</p>
<p><code>df.write \<br />
.option("spark.riak.connection.hosts","riak_host_ip:10017") \<br />
.format("org.apache.spark.sql.riak") \<br />
.mode(SaveMode.Append) \<br />
.save(ts_table_name)</code></p>
<h2>Conclusion</h2>
<p>As mentioned earlier in this post, there is no “best” NoSQL database for every possible use case. Riak KV and Riak TS provide an excellent solution for a number of popular use cases, as evidenced by the fact that Riak is the underlying database supporting many of the world’s most highly trafficked applications. The Riak Spark Connector gives users the ability to efficiently analyze the data in Riak utilizing the power of Apache Spark. This makes the quest for discovering incredible insights hidden in the enormous volumes of data being driven by modern applications, a lot easier. Riak Spark Connector fully supports Riak TS 1.3 for both time-series tables and key/value buckets<sup><a href="https://databricks.com/blog/2016/08/11/the-quest-for-hidden-treasure-an-apache-spark-connector-for-the-riak-nosql-database.html#footnote-1">1</a></sup>.</p>
<p>Working closely with the Databricks team, <a href="https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html#03%20Data%20Sources/5%20Databases%20%26%20Other%20Data%20Sources/7%20RiakTS%20Tutorial.html" target="_blank">we created a notebook</a>, showing Spark and Riak TS integration, which can be found in Databricks at <strong>‘Data Sources / Databases &amp; Other Data Sources / RiakTS Tutorial’</strong>.</p>
<p><a href="https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html#03%20Data%20Sources/5%20Databases%20%26%20Other%20Data%20Sources/7%20RiakTS%20Tutorial.html" target="_blank"><img class="aligncenter size-large wp-image-12075" src="/content/uploads/2016/08/RiakTS-Tutorial-on-Databricks-Screenshot1-1024x597.png" alt="RiakTS-Tutorial-on-Databricks-Screenshot.png" width="1024" height="597" srcset="/content/uploads/2016/08/RiakTS-Tutorial-on-Databricks-Screenshot1-1024x597.png 1024w, /content/uploads/2016/08/RiakTS-Tutorial-on-Databricks-Screenshot1-300x175.png 300w, /content/uploads/2016/08/RiakTS-Tutorial-on-Databricks-Screenshot1-768x447.png 768w, /content/uploads/2016/08/RiakTS-Tutorial-on-Databricks-Screenshot1.png 1114w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>Additionally, there are a couple of nice tutorials/demonstrations on Riak.com. The first <a href="/products/riak-ts/index.html" target="_blank">gives a demonstration of Riak TS</a> using a publicly available data set and the second builds on this example by <a href="/products/riak-ts/apache-spark-connector/index.html?p=10657.html" target="_blank">using the same data set and analyzing it using the Apache Spark Connector</a>.</p>
<h4>Pavel Hardek</h4>
<h4>Product Director</h4>
<h4><a class="ProfileHeaderCard-screennameLink u-linkComplex js-nav" href="https://twitter.com/PavelHardak">@<span class="u-linkComplex-target">PavelHardak</span></a></h4>
<p><img class="alignnone size-large wp-image-12078" src="/content/uploads/2016/08/blog-single-line-1024x17.png" alt="blog-single-line" width="1024" height="17" srcset="/content/uploads/2016/08/blog-single-line-1024x17.png 1024w, /content/uploads/2016/08/blog-single-line-300x5.png 300w, /content/uploads/2016/08/blog-single-line-768x13.png 768w, /content/uploads/2016/08/blog-single-line.png 1277w" sizes="(max-width: 1024px) 100vw, 1024px" /><br />
<sup>1</sup> Riak KV will gain Spark support soon, <a href="/2016-08_WR_SparkConnectorForKV_StayUpToDate_Landing-Page.html" target="_blank">contact me</a> if you are interested in being notified once it is available.</p>
						<p>Read the full story at: <br/><a href='https://databricks.com/blog/2016/08/11/the-quest-for-hidden-treasure-an-apache-spark-connector-for-the-riak-nosql-database.html' target='_blank'>https://databricks.com/blog/2016/08/11/the-quest-for-hidden-treasure-an-apache-spark-connector-for-the-riak-nosql-database.html</a></p>							
					</div>
				</article>
				</div></div><div class="tier_2 tier">
		<div class="content_home_2 row">
			<h1>Recent Articles</h1>
			<div class="divider_line">
				<img alt="" src="/content/themes/basho-v2/assets/images/blog/divider-line.png">
			</div>
			
<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13488 post type-post status-publish format-standard hentry category-technical tag-apache-mesos tag-mesosphere tag-riak">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/dcos-and-riak-mesos-framework/index.html?p=13488.html">DC/OS 1.9 and Riak Mesos Framework</a></h2>
			<time class="updated" datetime="2017-03-13T09:47:39+00:00">March 13, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/pavelhardak/index.html" rel="author" class="fn">Pavel Hardak</a></p>
					</header>
		<div class="entry-summary">
			<p>We are pleased today to announce with Mesosphere, the launch of DC/OS 1.9 and a major upgrade of the integration&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/dcos-and-riak-mesos-framework/index.html?p=13488.html">Read More</a></div>
		</div>
	</article>
</div>

<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13441 post type-post status-publish format-standard hentry category-technical tag-iot tag-riak tag-riak-ts tag-the-weather-company">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/traditional-data-lake-approach-may-not-be-a-good-choice-for-iot-data/index.html?p=13441.html">Traditional “Data Lake” Approach May Not Be A Good Choice for IoT Data</a></h2>
			<time class="updated" datetime="2017-03-01T16:46:22+00:00">March 1, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/dorothy-pults/index.html" rel="author" class="fn">Dorothy Pults</a></p>
					</header>
		<div class="entry-summary">
			<p>The momentum around Apache Spark continues. Spark Summit East was a big success and Riak’s own Pavel Hardak was among&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/traditional-data-lake-approach-may-not-be-a-good-choice-for-iot-data/index.html?p=13441.html">Read More</a></div>
		</div>
	</article>
</div>

<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13409 post type-post status-publish format-standard hentry category-technical tag-basho-academy tag-riak tag-riak-kv tag-riak-ts">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/basho-academy-install-code-and-go/index.html?p=13409.html">Riak Academy: Install, Code and Go</a></h2>
			<time class="updated" datetime="2017-02-27T10:25:05+00:00">February 27, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/dorothy-pults/index.html" rel="author" class="fn">Dorothy Pults</a></p>
					</header>
		<div class="entry-summary">
			<p>Are you new to NoSQL and want to find out more about Riak? Riak Academy may be the right place for&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/basho-academy-install-code-and-go/index.html?p=13409.html">Read More</a></div>
		</div>
	</article>
</div>

<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13356 post type-post status-publish format-standard hentry category-technical tag-iot tag-riak-ts">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/create-your-first-riak-ts-table/index.html?p=13356.html">Create Your First Riak TS Table</a></h2>
			<time class="updated" datetime="2017-02-21T19:05:56+00:00">February 21, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/dorothy-pults/index.html" rel="author" class="fn">Dorothy Pults</a></p>
					</header>
		<div class="entry-summary">
			<p>Customers like Intellicore are doing real-time analysis of IoT data using Riak TS. We want to make it easy for&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/create-your-first-riak-ts-table/index.html?p=13356.html">Read More</a></div>
		</div>
	</article>
</div>
		</div>
	</div>
		
	<div class="divider_bar shadow"></div>
</div>         </main><!-- /.main -->
                  <aside class="sidebar" role="complementary">
                      </aside><!-- /.sidebar -->
              </div><!-- /.content -->
    </div><!-- /.wrap -->
    <footer class="content-info" role="contentinfo">
	<div class="container">
		<div class="footer_menu row">
			<div class="footer-content row">

				<div class="col-sm-12 col-md-8">

					<div class="four-menus">

	<div class="col-xs-6 col-sm-3 menu_col left">
		<ul>
		<li><a href="/products/">Products</a></li><li><a href="/products/integrations/">Integrations</a></li><li><a href="/resources/">Resources</a></li><li><a href="/resources/nosql-databases/index.html?p=9937.html">NoSQL Explained</a></li>							</ul>
	</div>
	<div class="col-xs-6 col-sm-3 menu_col middle">
		<ul>
		<li><a href="/about/">About Riak</a></li><li><a href="/newsroom/">Newsroom</a></li>							</ul>
	</div>
	<div class="col-xs-6 col-sm-3 menu_col middle">
		<ul>
		<li><a href="/blog/">Blog</a></li><li><a href="/community/">DEVELOPERS</a></li>							</ul>
	</div>
	<div class="col-xs-6  col-sm-3 menu_col right">
		<ul>
									</ul>

	</div>

</div>
<div class="copyright col-xs-12">
						
											</div>
				</div>
				<div class="col-sm-12 col-md-3 footer-right">

					<div class="logo">
						<a href="/index.html"><img alt="" src="/content/themes/basho-v2/dist/images/riak-footer-logo.png"></a>
					</div>

										<div class="cf clearfix"></div>

				</div>

				<div class="back_top">
					<img alt="" src="/content/themes/basho-v2/dist/images/back-top.png">
				</div>


			</div>


		</div>
	</div>
</footer>
<div class="sidenav">
 

</div>


</div>


<!-- google analytics code here -->
<link rel='stylesheet' id='eventon_dynamic_styles-css'  href='/content/plugins/eventON/assets/css/eventon_dynamic_styles.css?ver=4.8.2' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"http:\/\/riak.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='/content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9'></script>
<script type='text/javascript' src='/includes/js/hoverIntent.min.js?ver=1.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var megamenu = {"timeout":"300","interval":"100","effect":{"fadeUp":{"in":{"animate":{"opacity":"show","margin-top":"0"},"css":{"margin-top":"10px"}},"out":{"animate":{"opacity":"hide","margin-top":"10px"}}}}};
/* ]]> */
</script>
<script type='text/javascript' src='/content/plugins/megamenu/js/maxmegamenu.js?ver=2.3.8'></script>
<script type='text/javascript' src='/content/plugins/megamenu-pro/assets/public.js?ver=1.4.5'></script>
<script type='text/javascript' src='/includes/js/jquery/ui/core.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='/includes/js/jquery/ui/position.min.js?ver=1.11.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var pum_vars = {"ajaxurl":"http:\/\/riak.com\/wp-admin\/admin-ajax.php","restapi":"http:\/\/riak.com\/wp-json\/pum\/v1","rest_nonce":null,"default_theme":"11522","debug_mode":"","disable_open_tracking":""};
var pum_debug_vars = {"debug_mode_enabled":"Popup Maker Debug Mode Enabled","debug_started_at":"Debug started at:","debug_more_info":"For more information on how to use this information visit http:\/\/docs.wppopupmaker.com\/?utm_medium=js-debug-info&utm_campaign=ContextualHelp&utm_source=browser-console&utm_content=more-info","global_info":"Global Information","localized_vars":"Localized variables","popups_initializing":"Popups Initializing","popups_initialized":"Popups Initialized","single_popup_label":"Popup: #","theme_id":"Theme ID: ","label_method_call":"Method Call:","label_method_args":"Method Arguments:","label_popup_settings":"Settings","label_triggers":"Triggers","label_cookies":"Cookies","label_delay":"Delay:","label_conditions":"Conditions","label_cookie":"Cookie:","label_settings":"Settings:","label_selector":"Selector:","label_mobile_disabled":"Mobile Disabled:","label_tablet_disabled":"Tablet Disabled:","label_display_settings":"Display Settings:","label_close_settings":"Close Settings:","label_event_before_open":"Event: Before Open","label_event_after_open":"Event: After Open","label_event_open_prevented":"Event: Open Prevented","label_event_setup_close":"Event: Setup Close","label_event_close_prevented":"Event: Close Prevented","label_event_before_close":"Event: Before Close","label_event_after_close":"Event: After Close","label_event_before_reposition":"Event: Before Reposition","label_event_after_reposition":"Event: After Reposition","label_event_checking_condition":"Event: Checking Condition","triggers":{"click_open":{"name":"Click Open","modal_title":"Click Trigger Settings","settings_column":"<strong>Extra Selectors<\/strong>: {{data.extra_selectors}}"},"auto_open":{"name":"Auto Open","modal_title":"Auto Open Settings","settings_column":"<strong>Delay<\/strong>: {{data.delay}}"},"scroll":{"name":"Scroll","modal_title":"Scroll Trigger Settings","settings_column":"<strong>Trigger<\/strong>: {{data.trigger}}"}},"cookies":{"on_popup_open":{"name":"On Popup Open","modal_title":"On Popup Open Settings"},"on_popup_close":{"name":"On Popup Close","modal_title":"On Popup Close Settings"},"manual":{"name":"Manual JavaScript","modal_title":"Click Trigger Settings"}}};
var ajaxurl = "http:\/\/riak.com\/wp-admin\/admin-ajax.php";
var popmake_default_theme = "11522";
/* ]]> */
</script>
<script type='text/javascript' src='/content/plugins/popup-maker/assets/js/site.min.js?defer&amp;ver=1.6.6.js' defer='defer'></script>
<script type='text/javascript' src='/content/plugins/popup-maker-scroll-triggered-popups/assets/js/site.min.js?defer&amp;ver=1.2.3.js' defer='defer'></script>

<!-- inject:js -->
<script src="/content/themes/basho-v2/dist/scripts/scripts-cd91f277db.min.js"></script>
<!-- endinject -->
<script type='text/javascript' src='/includes/js/embed.min.js?ver=4.8.2'></script>
  </body>
</html>
