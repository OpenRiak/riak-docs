
<!doctype html>
<html class="no-js"  xmlns="http://www.w3.org/1999/xhtml" prefix="" lang="en-US" xmlns:og="http://ogp.me/ns#" xmlns:fb="http://ogp.me/ns/fb#" prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/content/themes/basho-v2/dist/images/favicon.ico" />
    
<!-- BEGIN Metadata added by the Add-Meta-Tags WordPress plugin -->
<link rel="alternate" hreflang="en-US" href="/posts/technical/running-riak-in-docker/index.html?p=12629.html" />
<meta name="description" content="Unless you&#039;ve been living under a rock for the last couple of years (and believe me, given what&#039;s happening in the world today, I ain&#039;t gonna judge) you know that Docker is building an Empire in the World of Containers." />
<meta name="keywords" content="technical blog, docker, riak" />
<!-- END Metadata added by the Add-Meta-Tags WordPress plugin -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-39891693-3"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-39891693-3');
</script>
<!-- END Global site tag (gtag.js) - Google Analytics -->
<title>Running Riak in Docker &#8211; Riak</title>
<link rel='dns-prefetch' href='https://ajax.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel='stylesheet' id='contact-form-7-css'  href='/content/plugins/contact-form-7/includes/css/styles.css?ver=4.9' type='text/css' media='all' />
<link rel='stylesheet' id='popup-maker-site-css'  href='/content/plugins/popup-maker/assets/css/site.min.css?ver=1.6.6' type='text/css' media='all' />
<link rel='stylesheet' id='rs-plugin-settings-css'  href='/content/plugins/revslider/public/assets/css/settings.css?ver=5.4.6.1' type='text/css' media='all' />
<style id='rs-plugin-settings-inline-css' type='text/css'>
.regmark{font-size:15px;  position:relative;  top:-10px}@media screen and (max-width:700px){.regmark{font-size:13px;  top:-4px}}
</style>
<link rel='stylesheet' id='megamenu-css'  href='/content/uploads/maxmegamenu/style.css?ver=a8ce69' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='/includes/css/dashicons.min.css?ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='megamenu-fontawesome-css'  href='/content/plugins/megamenu-pro/icons/fontawesome/css/font-awesome.min.css?ver=1.4.5' type='text/css' media='all' />
<link rel='stylesheet' id='megamenu-genericons-css'  href='/content/plugins/megamenu-pro/icons/genericons/genericons/genericons.css?ver=1.4.5' type='text/css' media='all' />
<link rel='stylesheet' id='evcal_cal_default-css'  href='/content/plugins/eventON/assets/css/eventon_styles.css?ver=2.3.15' type='text/css' media='all' />
<!-- inject:css -->
<link rel="stylesheet" href="/content/themes/basho-v2/dist/styles/styles-846178cbe9.min.css">
<!-- endinject -->
<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js'></script>
<script>window.jQuery || document.write('<script src="/content/themes/basho-v2/dist/scripts/jquery.js"><\/script>')</script>
<script type='text/javascript' src='/content/plugins/revslider/public/assets/js/jquery.themepunch.tools.min.js?ver=5.4.6.1'></script>
<script type='text/javascript' src='/content/plugins/revslider/public/assets/js/jquery.themepunch.revolution.min.js?ver=5.4.6.1'></script>
<link rel='https://api.w.org/' href='/json/index.html' />
<link rel='prev' title='Riak Advances NoSQL and IoT Technologies with Latest Versions of Industry-leading Riak Databases' href='/posts/press/basho-advances-nosql-and-iot-technologies-with-latest-versions-of-industry-leading-riak-databases/index.html?p=12626.html' />
<link rel='next' title='Welcome to the (IoT) Jungle' href='/posts/business/welcome-to-the-iot-jungle/index.html?p=12650.html' />
<link rel="canonical" href="/posts/technical/running-riak-in-docker/index.html?p=12629.html" />
<link rel='shortlink' href='/index.html?p=12629.html' />



<script type="text/javascript">function setREVStartSize(e){
				try{ var i=jQuery(window).width(),t=9999,r=0,n=0,l=0,f=0,s=0,h=0;					
					if(e.responsiveLevels&&(jQuery.each(e.responsiveLevels,function(e,f){f>i&&(t=r=f,l=e),i>f&&f>r&&(r=f,n=e)}),t>r&&(l=n)),f=e.gridheight[l]||e.gridheight[0]||e.gridheight,s=e.gridwidth[l]||e.gridwidth[0]||e.gridwidth,h=i/s,h=h>1?1:h,f=Math.round(h*f),"fullscreen"==e.sliderLayout){var u=(e.c.width(),jQuery(window).height());if(void 0!=e.fullScreenOffsetContainer){var c=e.fullScreenOffsetContainer.split(",");if (c) jQuery.each(c,function(e,i){u=jQuery(i).length>0?u-jQuery(i).outerHeight(!0):u}),e.fullScreenOffset.split("%").length>1&&void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0?u-=jQuery(window).height()*parseInt(e.fullScreenOffset,0)/100:void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0&&(u-=parseInt(e.fullScreenOffset,0))}f=u}else void 0!=e.minHeight&&f<e.minHeight&&(f=e.minHeight);e.c.closest(".rev_slider_wrapper").css({height:f})					
				}catch(d){console.log("Failure at Presize of Slider:"+d)}
			};</script>
<style type="text/css">/** Mega Menu CSS Disabled **/</style>
	<style id="pum-styles" type="text/css" media="all">
	/* Popup Google Fonts */
@import url('https://fonts.googleapis.com/css?family=Acme|Montserrat');

/* Popup Theme 12762: Blank Center */
.pum-theme-12762, .pum-theme-blank-center { background: none } 
.pum-theme-12762 .pum-container, .pum-theme-blank-center .pum-container { padding: 0px; border-radius: 0px; border: 1px none #000000; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 1 ); background-color: rgba( 249, 249, 249, 1 ); background: none } 
.pum-theme-12762 .pum-title, .pum-theme-blank-center .pum-title { color: #000000; text-align: center; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 16px; line-height: 16px } 
.pum-theme-12762 .pum-content, .pum-theme-blank-center .pum-content { color: #8c8c8c; font-family: inherit } 
.pum-theme-12762 .pum-content + .pum-close, .pum-theme-blank-center .pum-content + .pum-close { height: auto; width: auto; left: auto; right: 0px; bottom: auto; top: 10px; padding: 4px; color: #ffffff; font-family: inherit; font-size: 12px; line-height: 14px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 158, 1, 1 ) } 
/* Popup Theme 11529: Default No Padding */
.pum-theme-11529, .pum-theme-default-no-padding { background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11529 .pum-container, .pum-theme-default-no-padding .pum-container { padding: 0px; border-radius: 0px; border: 1px none #000000; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.23 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11529 .pum-title, .pum-theme-default-no-padding .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 32px; line-height: 36px } 
.pum-theme-11529 .pum-content, .pum-theme-default-no-padding .pum-content { color: #8c8c8c; font-family: inherit } 
.pum-theme-11529 .pum-content + .pum-close, .pum-theme-default-no-padding .pum-content + .pum-close { height: auto; width: auto; left: auto; right: 0px; bottom: auto; top: 0px; padding: 8px; color: #ffffff; font-family: inherit; font-size: 12px; line-height: 14px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 158, 1, 1 ) } 
/* Popup Theme 11527: Framed Border */
.pum-theme-11527, .pum-theme-framed-border { background-color: rgba( 255, 255, 255, 0.5 ) } 
.pum-theme-11527 .pum-container, .pum-theme-framed-border .pum-container { padding: 18px; border-radius: 0px; border: 20px outset #dd3333; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.97 ) inset; background-color: rgba( 255, 251, 239, 1 ) } 
.pum-theme-11527 .pum-title, .pum-theme-framed-border .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 32px; line-height: 36px } 
.pum-theme-11527 .pum-content, .pum-theme-framed-border .pum-content { color: #2d2d2d; font-family: inherit } 
.pum-theme-11527 .pum-content + .pum-close, .pum-theme-framed-border .pum-content + .pum-close { height: 20px; width: 20px; left: auto; right: -20px; bottom: auto; top: -20px; padding: 0px; color: #ffffff; font-family: Acme; font-size: 20px; line-height: 20px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 0, 0, 0, 0.55 ) } 
/* Popup Theme 11526: Cutting Edge */
.pum-theme-11526, .pum-theme-cutting-edge { background-color: rgba( 0, 0, 0, 0.5 ) } 
.pum-theme-11526 .pum-container, .pum-theme-cutting-edge .pum-container { padding: 18px; border-radius: 0px; border: 1px none #000000; box-shadow: 0px 10px 25px 0px rgba( 2, 2, 2, 0.5 ); background-color: rgba( 30, 115, 190, 1 ) } 
.pum-theme-11526 .pum-title, .pum-theme-cutting-edge .pum-title { color: #ffffff; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: Sans-Serif; font-size: 26px; line-height: 28px } 
.pum-theme-11526 .pum-content, .pum-theme-cutting-edge .pum-content { color: #ffffff; font-family: inherit } 
.pum-theme-11526 .pum-content + .pum-close, .pum-theme-cutting-edge .pum-content + .pum-close { height: 24px; width: 24px; left: auto; right: 0px; bottom: auto; top: 0px; padding: 0px; color: #1e73be; font-family: inherit; font-size: 32px; line-height: 24px; border: 1px none #ffffff; border-radius: 0px; box-shadow: -1px 1px 1px 0px rgba( 2, 2, 2, 0.1 ); text-shadow: -1px 1px 1px rgba( 0, 0, 0, 0.1 ); background-color: rgba( 238, 238, 34, 1 ) } 
/* Popup Theme 11525: Hello Box */
.pum-theme-11525, .pum-theme-hello-box { background-color: rgba( 0, 0, 0, 0.75 ) } 
.pum-theme-11525 .pum-container, .pum-theme-hello-box .pum-container { padding: 30px; border-radius: 80px; border: 14px solid #81d742; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11525 .pum-title, .pum-theme-hello-box .pum-title { color: #2d2d2d; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: Montserrat; font-size: 32px; line-height: 36px } 
.pum-theme-11525 .pum-content, .pum-theme-hello-box .pum-content { color: #2d2d2d; font-family: inherit } 
.pum-theme-11525 .pum-content + .pum-close, .pum-theme-hello-box .pum-content + .pum-close { height: auto; width: auto; left: auto; right: -30px; bottom: auto; top: -30px; padding: 0px; color: #2d2d2d; font-family: inherit; font-size: 32px; line-height: 28px; border: 1px none #ffffff; border-radius: 28px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 255, 255, 1 ) } 
/* Popup Theme 11524: Enterprise Blue */
.pum-theme-11524, .pum-theme-enterprise-blue { background-color: rgba( 0, 0, 0, 0.7 ) } 
.pum-theme-11524 .pum-container, .pum-theme-enterprise-blue .pum-container { padding: 28px; border-radius: 5px; border: 1px none #000000; box-shadow: 0px 10px 25px 4px rgba( 2, 2, 2, 0.5 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11524 .pum-title, .pum-theme-enterprise-blue .pum-title { color: #315b7c; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 34px; line-height: 36px } 
.pum-theme-11524 .pum-content, .pum-theme-enterprise-blue .pum-content { color: #2d2d2d; font-family: inherit } 
.pum-theme-11524 .pum-content + .pum-close, .pum-theme-enterprise-blue .pum-content + .pum-close { height: 28px; width: 28px; left: auto; right: 8px; bottom: auto; top: 8px; padding: 4px; color: #ffffff; font-family: inherit; font-size: 20px; line-height: 20px; border: 1px none #ffffff; border-radius: 42px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 49, 91, 124, 1 ) } 
/* Popup Theme 11523: Light Box */
.pum-theme-11523, .pum-theme-lightbox { background-color: rgba( 0, 0, 0, 0.6 ) } 
.pum-theme-11523 .pum-container, .pum-theme-lightbox .pum-container { padding: 18px; border-radius: 3px; border: 8px solid #000000; box-shadow: 0px 0px 30px 0px rgba( 2, 2, 2, 1 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11523 .pum-title, .pum-theme-lightbox .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 32px; line-height: 36px } 
.pum-theme-11523 .pum-content, .pum-theme-lightbox .pum-content { color: #000000; font-family: inherit } 
.pum-theme-11523 .pum-content + .pum-close, .pum-theme-lightbox .pum-content + .pum-close { height: 30px; width: 30px; left: auto; right: -24px; bottom: auto; top: -24px; padding: 0px; color: #ffffff; font-family: inherit; font-size: 24px; line-height: 26px; border: 2px solid #ffffff; border-radius: 30px; box-shadow: 0px 0px 15px 1px rgba( 2, 2, 2, 0.75 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 0, 0, 0, 1 ) } 
/* Popup Theme 11522: Default Theme */
.pum-theme-11522, .pum-theme-default-theme { background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11522 .pum-container, .pum-theme-default-theme .pum-container { padding: 15px; border-radius: 3px; border: 1px none #000000; box-shadow: 1px 1px 3px 0px rgba( 2, 2, 2, 0.23 ); background-color: rgba( 255, 255, 255, 1 ) } 
.pum-theme-11522 .pum-title, .pum-theme-default-theme .pum-title { color: #000000; text-align: left; text-shadow: 0px 0px 0px rgba( 2, 2, 2, 0.23 ); font-family: inherit; font-size: 28px; line-height: 30px } 
.pum-theme-11522 .pum-content, .pum-theme-default-theme .pum-content { color: #8c8c8c; font-family: inherit } 
.pum-theme-11522 .pum-content + .pum-close, .pum-theme-default-theme .pum-content + .pum-close { height: auto; width: auto; left: auto; right: 0px; bottom: auto; top: 0px; padding: 8px; color: #ffffff; font-family: inherit; font-weight: 400; font-size: 11px; line-height: 13px; border: 1px none #ffffff; border-radius: 0px; box-shadow: 0px 0px 0px 0px rgba( 2, 2, 2, 0.23 ); text-shadow: 0px 0px 0px rgba( 0, 0, 0, 0.23 ); background-color: rgba( 255, 158, 1, 1 ) } 

	
		</style>
<!-- START - Facebook Open Graph, Google+ and Twitter Card Tags 2.1.2 -->
 <!-- Facebook Open Graph -->
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Riak"/>
  <meta property="og:title" content="Running Riak in Docker"/>
  <meta property="og:url" content="/posts/technical/running-riak-in-docker/"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Unless you&#039;ve been living under a rock for the last couple of years (and believe me, given what&#039;s happening in the world today, I ain&#039;t gonna judge) you know that Docker is building an Empire in the World of Containers. It&#039;s permeating DevOps and infrastructure, microservices, financial services, he"/>
  <meta property="og:image" content="/content/uploads/2016/09/explorer_graphs-300x201.jpg"/>
  <meta property="article:published_time" content="2016-09-29T06:00:28+00:00"/>
  <meta property="article:modified_time" content="2016-09-29T06:44:47+00:00" />
  <meta property="og:updated_time" content="2016-09-29T06:44:47+00:00" />
  <meta property="article:section" content="Technical Blog"/>
 <!-- Google+ / Schema.org -->
  <meta itemprop="name" content="Running Riak in Docker"/>
  <meta itemprop="description" content="Unless you&#039;ve been living under a rock for the last couple of years (and believe me, given what&#039;s happening in the world today, I ain&#039;t gonna judge) you know that Docker is building an Empire in the World of Containers. It&#039;s permeating DevOps and infrastructure, microservices, financial services, he"/>
  <meta itemprop="image" content="/content/uploads/2016/09/explorer_graphs-300x201.jpg"/>
 <!-- Twitter Cards -->
 <!-- SEO -->
 <!-- Misc. tags -->
<!-- END - Facebook Open Graph, Google+ and Twitter Card Tags 2.1.2 -->
	
	<style>
	_:-ms-input-placeholder, :root .page-template-tpl-riakkv .title_ph {  margin-left:16%; }
	_:-ms-input-placeholder, :root .page-template-tpl-products .home_3_data .title_ph {  margin-left:28.5%; }
	_:-ms-input-placeholder, :root .page-template-tpl-products .home_4_data .title_ph {  margin-left:20.5%; }
	</style>
	 </head>
  <body class="post-template-default single single-post postid-12629 single-format-standard mega-menu-primary-navigation running-riak-in-docker sidebar-primary">
    <!--[if lt IE 9]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    


<div id="screen_viewport">
	
	<div id="head_container" class="row">
		<header>
			
			<div class="row upper">
				
				<div class="header-contain">
				
					<div class="col-sm-3 header-upper-left">
						
						<div class="logo_home">
							<a href="/index.html"><img alt="Riak logo" src="/content/themes/basho-v2/dist/images/riak.png"></a>
						</div>
	
					</div><!-- end header-upper-left-->
					<div class="col-sm-9 header-upper-right">
					
		
						<div class="quick_tools">
	<ul class="quick_links">
								<li><a href="https://docs.riak.com/index.html" target="_blank">DOWNLOAD RIAK</a></li><li><a href="https://docs.riak.com/index.html">DOCS</a></li>								<li class="lang_menu sling_lang"><a href="javascript: void(0);" class="language_choice">ENGLISH</a>
									<ul>
										<li class="language sling_lang"><a href="http://www.riak.com/index.html" rel="http://www.riak.com">English</a></li>
										<li class="language sling_lang"><a href="http://jp.riak.com/posts/technical/running-riak-in-docker/" rel="http://jp.riak.com">日本語</a></li>
										<li class="language sling_lang"><a href="http://de.riak.com/posts/technical/running-riak-in-docker/" rel="http://de.riak.com">Deutsch</a></li>
										<li class="language sling_lang"><a href="http://fr.riak.com/posts/technical/running-riak-in-docker/" rel="http://fr.riak.com">Fran&ccedil;ais</a></li>
									</ul>
								</li>
							</ul>
						</div>
		
					</div><!-- end header-upper-right-->
					<div class="cf clearfix"></div>
				</div>	<!-- end header-contain -->
		</div><!-- end row -->
		<div class="col-sm-12 row header-lower">

			<div class="header-contain">

				<div class="main_nav">
					<ul class="main_nav_top">

						<div id="mega-menu-wrap-primary_navigation" class="mega-menu-wrap"><div class="mega-menu-toggle" tabindex="0"><div class='mega-toggle-block mega-menu-toggle-block mega-toggle-block-right mega-toggle-block-1' id='mega-toggle-block-1'></div></div><ul id="mega-menu-primary_navigation" class="mega-menu mega-menu-horizontal mega-no-js" data-event="hover_intent" data-effect="slide" data-effect-speed="200" data-second-click="close" data-document-click="collapse" data-vertical-behaviour="standard" data-breakpoint="600" data-unbind="true"><li class='mega-add-arrow mega-m-products mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-left mega-menu-megamenu mega-hide-arrow mega-menu-item-11815' id='mega-menu-item-11815'><a class="mega-menu-link" href="/products/" aria-haspopup="true" tabindex="0">Products</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-columns-1-of-3 mega-menu-item-11816' id='mega-menu-item-11816'><a class="mega-menu-link" href="/products/">Overview</a></li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-menu-columns-1-of-3 mega-menu-item-11817' id='mega-menu-item-11817'><a class="mega-menu-link" href="/products/riak-kv/" aria-haspopup="true">Riak<sup>®</sup> KV</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11819' id='mega-menu-item-11819'><a class="mega-menu-link" href="/products/riak-kv/index.html#features">Features</a></li><li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11820' id='mega-menu-item-11820'><a class="mega-menu-link" href="/products/riak-kv/index.html#commercial">Commercial V. OSS</a></li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-has-icon mega-menu-item-11821' id='mega-menu-item-11821'><a class="fa-sign-out mega-menu-link" href="/products/riak-kv/resiliency/index.html?p=10906.html">Take Feature Tour</a></li>	</ul>
	</li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-menu-columns-1-of-3 mega-menu-item-11822' id='mega-menu-item-11822'><a class="mega-menu-link" href="/products/riak-ts/" aria-haspopup="true">Riak<sup>®</sup> TS</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11824' id='mega-menu-item-11824'><a class="mega-menu-link" href="/products/riak-ts/index.html#features">Features</a></li><li class='mega-menu-item mega-menu-item-type-custom mega-menu-item-object-custom mega-menu-item-11825' id='mega-menu-item-11825'><a class="mega-menu-link" href="/products/riak-ts/index.html#commercial">Commercial V. OSS</a></li><li class='mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-has-icon mega-menu-item-11826' id='mega-menu-item-11826'><a class="fa-sign-out mega-menu-link" href="/products/riak-ts/resiliency/index.html?p=10650.html">Take Feature Tour</a></li>	</ul>
	</li></ul>
	</li><li class='mega-m-integrations mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-left mega-menu-megamenu mega-hide-arrow mega-menu-item-11827' id='mega-menu-item-11827'><a class="mega-menu-link" href="/products/integrations/" aria-haspopup="true" tabindex="0">Integrations</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-10' id='mega-menu-item-nav_menu-10'><ul id="menu-integrations-column-1" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11990"><a href="/products/apache-spark/">Apache Spark</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11885"><a href="/products/solr/">Apache Solr</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11883"><a href="/products/apache-mesos/index.html?p=11511.html">Apache Mesos</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11886"><a href="/products/redis/index.html?p=6927.html">Redis Caching</a></li>
	</ul></li><li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-11' id='mega-menu-item-nav_menu-11'><ul id="menu-integrations-column-2" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-11887"><a href="/products/riak-s2/index.html?p=6196.html">Riak S2</a>
	<ul  class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11888"><a href="/products/riak-s2/index.html?p=6196.html#features">Features</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11889"><a href="/products/riak-s2/index.html?p=6196.html#commercial">Commercial V. OSS</a></li>
	</ul>
	</li>
	</ul></li></ul>
	</li><li class='mega-m-resources mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-left mega-menu-megamenu mega-hide-arrow mega-menu-item-11837' id='mega-menu-item-11837'><a class="mega-menu-link" href="/resources/" aria-haspopup="true" tabindex="0">Resources</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-2' id='mega-menu-item-nav_menu-2'><ul id="menu-resources-column-1" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-11890"><a href="/resources/">Resource Center</a>
	<ul  class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11892"><a href="/resources/index.html?resource=types&amp;t=DATASHEET">DataSheets</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11893"><a href="/resources/index.html?resource=types&amp;t=WHITEPAPER">WhitePapers</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11894"><a href="/resources/index.html?resource=types&amp;t=SOLUTION BRIEF">Solution Briefs</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11895"><a href="/resources/index.html?resource=types&amp;t=CASE STUDY">Case Studies</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11896"><a href="/resources/index.html?resource=types&amp;t=USER STORY">User Stories</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11897"><a href="/resources/index.html?resource=types&amp;t=CUSTOMER TESTIMONIAL">Customer Testimonials</a></li>
	</ul>
	</li>
	</ul></li><li class='mega-menu-item mega-menu-item-type-widget widget_nav_menu mega-menu-columns-1-of-2 mega-menu-item-nav_menu-3' id='mega-menu-item-nav_menu-3'><ul id="menu-resources-column-2" class="menu">
	</ul></li></ul>
	</li><li class='mega-add-arrow mega-m-blog mega-menu-item mega-menu-item-type-post_type mega-menu-item-object-page mega-menu-item-has-children mega-align-bottom-right mega-menu-flyout mega-hide-arrow mega-menu-item-11839' id='mega-menu-item-11839'><a class="mega-menu-link" href="/blog/" aria-haspopup="true" tabindex="0">Blog</a>
	<ul class="mega-sub-menu">
	<li class='mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-item-11841' id='mega-menu-item-11841'><a class="mega-menu-link" href="/category/technical/">Technical</a></li><li class='mega-menu-item mega-menu-item-type-taxonomy mega-menu-item-object-category mega-menu-item-11840' id='mega-menu-item-11840'><a class="mega-menu-link" href="/category/business/">Business</a></li></ul>
	</li></ul></div>						</ul>
				</div>
				<div class="cf clearfix"></div>
			</div>	<!-- end header-contain -->	

			</div><!-- end header-lower-->

			
		</header>
	</div>
	    <div class="wrap container" role="document">
      <div class="content row">
        <main class="main" role="main">
          
<div id="subpage_nav">
	<div class="subpage_nav_content">
				<h1>Riak Blog</h1>
				<div class="right_side">
					<ul>
						<li><a class="home_link" href="/index.html">Home</a></li>
						<li><a class="home_link" href="/blog/index.html">Blog</a></li>
					</ul>
				</div>
		</div>
	</div>
</div>
<div id="fb-root"></div>
<script>(function (d, s, id) {
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id))
			return;
		js = d.createElement(s);
		js.id = id;
		js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=291833560991925";
		fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>
	<div id="content_blogsingle" class="row">
		<div class="tier_1 tier">
			<div class="content_home_1">
				<article class="post-12629 post type-post status-publish format-standard hentry category-technical tag-docker tag-riak">
					<header> 
												<h1 class="entry-title">Running Riak in Docker</h1>
						<div class="entry-meta">
							<time class="updated" datetime="2016-09-29T06:00:28+00:00">Posted September 29, 2016</time>
							<p class="byline author vcard"> <a href="/posts/author/jbrisbin/index.html" rel="author" class="fn">by Jon Brisbin</a></p>							<p class="category">Category: <a href="/category/technical/index.html" rel="category tag">Technical Blog</a></p>
													</div>
					</header>
					<div class="entry-content">
						<p>Unless you&#8217;ve been living under a rock for the last couple of years (and believe me, given what&#8217;s happening in the world today, I ain&#8217;t gonna judge) you know that Docker is <a href="https://www.datadoghq.com/docker-adoption/" target="_blank">building an Empire in the World of Containers</a>. It&#8217;s permeating DevOps and infrastructure, microservices, financial services, healthcare, and just about anywhere that containerized applications make sense. Although it might one day power a smart IoT application that helps beat cancer, by itself it is no operational <a href="http://lotr.wikia.com/wiki/One_Ring" target="_blank">panacea</a>. It can do more harm than good if wielded irresponsibly. In this blog post, I&#8217;ll lay out some groundwork for running a Riak cluster in Docker. Expect to see:</p>
<ul>
<li>How to run single nodes as well as multiple node clusters.</li>
<li>How to test the container.</li>
<li>How to run applications that connect to Riak.</li>
<li>How to build your own Docker container with Riak installed.</li>
</ul>
<p><strong>Getting Started</strong></p>
<p>To run Riak in Docker you need <a href="https://docs.docker.com/engine/installation/" target="_blank">a relatively recent version of the daemon</a>. Everything should probably work on 1.11, though for the purposes of this article I&#8217;ll assume you&#8217;re using a recent version of 1.12. <a href="https://docs.docker.com/engine/swarm/" target="_blank">Swarm mode</a> is outside the scope of this post but it&#8217;s there if you want to experiment on your own.</p>
<p>You don&#8217;t need anything special to run Riak in Docker beyond just Docker. It seems a little anti-climactic, but here&#8217;s all you need to run a single node of Riak KV using a Ubuntu Trusty base image:</p>
<pre>docker run --name=riak -d -p 8087:8087 -p 8098:8098 basho/riak-kv
</pre>
<p>Docker will download the image from Docker Hub (<a href="https://hub.docker.com/r/basho/riak-kv/" target="_blank">KV</a>, <a href="https://hub.docker.com/r/basho/riak-ts/" target="_blank">TS</a>) and start a single node.</p>
<p>You should then be able to start any client in your preferred language and connect to either <code>localhost:8087</code> or the IP address of your box (or VM, if you happen to be running the above inside a virtual machine).</p>
<p>Similarly for Riak TS (Time Series):</p>
<pre>docker run --name=riak -d -p 8087:8087 -p 8098:8098 basho/riak-ts
</pre>
<p><em>NOTE: Since both these example commands use the container name &#8220;riak&#8221; and the standard ports, you&#8217;ll have to stop the first container before starting the second. <code>docker rm -f riak</code> should do the trick.</em></p>
<p>In this example, we&#8217;re mapping the ports to their standard values using <a href="https://docs.docker.com/engine/reference/commandline/run/#/publish-or-expose-port-p-expose" target="_blank">port mapping</a>. If you want to use randomly-assigned ports that you can discover later (because you want to run multiple containers on the same host), just remove the <code>-p</code> options and replace them with a single <code>-P</code>:</p>
<pre>docker run --name=riak -d -P basho/riak-ts
</pre>
<p><strong>Connecting to a Riak Node</strong></p>
<p><em>NOTE: This entire section assumes the use of Docker&#8217;s bridge networking. Using host networking will involve additional considerations and will be the topic of a different post.</em></p>
<p>In order to connect to a Riak node running in Docker, you need to know what IP address to use. That will vary depending on the <a href="https://docs.docker.com/engine/reference/run/#/network-settings" target="_blank">network settings</a> you&#8217;re using for that container. In the default bridge configuration, you can access Riak via the internal Docker IP address (probably <code>172.17.</code> or similar) and use the default port of 8087, *regardless* of what you have set in the port mappings. If you access Riak via <code>localhost</code>, however, you can *only* use the mapped ports (in our example: <code>8087</code> and <code>8098</code>).</p>
<p><em>TIP: If you&#8217;re running an application in another Docker container and that container has access to the Docker subnet your Riak container is running in, you should have no problems. Before confusing everything too much with custom configurations and multiple subnets, try running your Riak nodes using the Docker defaults&#8211;at least until you&#8217;re comfortable with the peculiarities of running a clustered database with complex networking needs inside Docker.</em></p>
<p>To discover the IP address and port combinations needed to connect to Riak, use <code>docker inspect</code>. In general, you only need to discover one of the two HOST:PORT values: either <code>HOST</code> or <code>PORT</code>. If you use the Docker internal IPs, then you can use the standard Riak ports of <code>8087</code> and <code>8098</code> for Protobuf and HTTP, respectively. If you use any other IP (like the IP address of your box or VM), then you&#8217;ll need to discover the <code>PORT</code> values and use a pre-determined IP address value. The two variations can be supported by using <code>docker inspect</code> and specifying a Go template string in the <code>-f</code> flag to <a href="https://docs.docker.com/engine/reference/commandline/inspect/" target="_blank">filter the JSON output to only show the values we care about</a>.</p>
<p><strong>To discover the port</strong></p>
<p>Assuming all your containers are running on a single host and you&#8217;ll reuse the IP address (for the purposes of this example: <code>localhost</code>), you only need to discover what the port mappings are. The following Go template expression should spit out the protobuf ports (replace <code>8087</code> with <code>8098</code> to get the HTTP ports):</p>
<pre>docker inspect -f 'localhost:{{(index (index .NetworkSettings.Ports "8087/tcp") 0).HostPort}}' riak
</pre>
<p>This will print a list of the mapped ports, one host:port line per container. In this example, we&#8217;re only specifying the <code>riak</code> container which we started earlier. If we wanted to inspect an entire cluster, we&#8217;d have to list all the containers of the cluster.</p>
<pre>docker inspect -f 'localhost:{{(index (index .NetworkSettings.Ports "8087/tcp") 0).HostPort}}' riak-1 riak-2 riak-3 riak-4 riak-5
</pre>
<p>If we pipe this output through <code>tr</code>, we can create a comma-separated list of <code>HOST:PORT</code> pairs suitable for passing to the various Riak client libraries. They each have their own way of specifying a list of nodes to connect to, so <a href="http://www.urbandictionary.com/define.php?term=ymmv" target="_blank">YMMV</a>. At a minimum, you&#8217;ll want to translate the newlines to commas and maybe set an environment variable.</p>
<pre>export RIAK_HOSTS=$(docker inspect -f 'localhost:{{(index (index .NetworkSettings.Ports "8087/tcp") 0).HostPort}}' riak | tr '\\n' , | sed 's/,$//')
</pre>
<p><em>NOTE: The <code>tr</code> is to pull the separate lines into a single line, separating them by commas, and the <code>sed</code> is to strip the final comma off the end since it might be a little more awkward for some logic to deal with an empty string when it&#8217;s expecting <code>HOST:PORT</code>.</em></p>
<p><strong>To discover the IP</strong></p>
<p>This will work on just about any Linux distribution or Mac OS X using <code>docker-machine</code> with <a href="http://stackoverflow.com/questions/29437022/direct-access-to-containers-using-boot2docker" target="_blank">an appropriate route set up</a>. This will *not* work on the Mac OS X native Docker beta since it&#8217;s not currently possible to route traffic from your Mac across the internal <code>xhyve VM</code> running the Docker daemon to the <code>172.17.</code> addresses that Docker uses. For more information, read <a href="https://github.com/docker/for-mac/issues/171" target="_blank">the GitHub issue on this topic</a>.</p>
<pre>export RIAK_HOSTS=$(docker inspect -f '{{.NetworkSettings.IPAddress}}:8087' riak | tr '\\n' , | sed 's/,$//')
</pre>
<p>This will give you something like <code>172.17.0.3:8087</code>. Pass this value to the client library of your choice (assuming where you&#8217;re running this client has access to the <code>172.17.</code> subnet, as just discussed). That&#8217;s easiest to do if your client code is _also_ running inside a Docker container. If you&#8217;re using the native Mac beta of Docker, this is also the only way to access those <code>172.17.</code> addresses reported by <code>docker inspect</code>.</p>
<p><strong>Clustering</strong></p>
<p>If you already have the infrastructure for creating Riak clusters, then you could likely reuse it with Docker by replacing direct calls to <code>riak</code> and <code>riak-admin</code> with <code>docker exec $CONTAINER riak|riak-admin</code>. Another option for taking advantage of Riak&#8217;s clustering is to create the cluster manually using <code>docker exec</code> and <code>riak-admin</code>. Just follow the <a href="https://docs.riak.com/riak/kv/2.1.4/using/running-a-cluster/" target="_blank">excellent documentation on creating a cluster</a> and prepend all the <code>riak-admin</code> commands with <code>docker exec</code> in the appropriate container. Since this is a manual process and will be blown away when you restart the node, you should really only consider this approach appropriate for ad hoc testing and custom automation; it&#8217;s also beyond the scope of this post.</p>
<p>Unless you&#8217;re building your own Docker image and intentionally excluding <a href="https://github.com/basho-labs/riak_explorer" target="_blank">Riak Explorer</a> for a specific reason, you can take advantage of the <a href="https://github.com/basho-labs/riak-docker/blob/master/poststart.d/99-join-cluster.sh" target="_blank">simple cluster bootstrapping functionality</a> that&#8217;s baked into the Docker image. Riak Explorer is used for this because <a href="https://github.com/basho-labs/riak_explorer#full-api-endpoint-listing" target="_blank">its clustering operation</a> combines the node add and cluster commit operations into a single REST call. This bootstrapping is activated when the value of the <code>COORDINATOR_NODE</code> environment variable passed to <code>docker run</code> is the IP address of the first node in a cluster.</p>
<p><strong>Starting a Dockerized Cluster</strong></p>
<p>In order to start a Dockerized cluster, you must first start a coordinator node. This is the first node in a cluster and the one which subsequent nodes will join to in order to create the cluster. In these examples, we&#8217;ll start the nodes manually with <code>docker run</code> to illustrate the steps. Afterward, we&#8217;ll create a <code>docker-compose.yml</code> file to encapsulate this functionality into an easily-digestible form.</p>
<p>The following starts a coordinator node, mapping the ports to their default settings. This will be the primary node we interact with and the one we pass the IP address to when we start other nodes.</p>
<pre>docker run --name=riak -d -p 8087:8087 -p 8098:8098 --label cluster.name=adhoc basho/riak-kv
</pre>
<p><em>NOTE: The ability to tag containers with arbitrary labels is a very powerful&#8211;and sometimes overlooked&#8211;feature of Docker. Whenever you start a container for a Riak cluster, it will make your life easier to tag that container with a label to make them easy to find and manipulate later.</em></p>
<p>We can now discover the IP address we&#8217;ll need to use as the value of <code>COORDINATOR_NODE</code> by using docker inspect:</p>
<pre>$ docker inspect -f '{{.NetworkSettings.IPAddress}}' riak
172.17.0.3
</pre>
<p>Whenever we start the other containers in this cluster, we&#8217;ll just pass <code>-e COORDINATOR_NODE=172.17.0.3</code> and the cluster will be auto-created.</p>
<pre>docker run -d -P -e COORDINATOR_NODE=172.17.0.3 --label cluster.name=adhoc basho/riak-kv
</pre>
<p><em>TIP: Instead of using a hard-coded IP address, you can replace it with a shell expression like <code>$(docker inspect -f '{{.NetworkSettings.IPAddress}}' riak)</code> to facilitate automating these steps. Don&#8217;t forget to parameterize the name of the container being passed to the coordinator node (the value of <code>--name</code> in the docker run command).</em></p>
<p>Some notable differences between this command and the one we used to start the coordinator node are:</p>
<ul>
<li>No <code>--name</code> specified. We likely won&#8217;t be referring to this individual node itself, but by finding the container ID using <code>docker ps</code> and filtering on the label.</li>
<li>No specific port mapping. Running multiple nodes on the same host means each container will have to have the standard ports mapped to available ones. It&#8217;s easiest to let Docker handle that and randomly assign the mappings. We&#8217;ll look these values up later with <code>docker inspect</code> anyway.</li>
<li>Addition of the <code>COORDINATOR_NODE</code> environment variable. The bootstrapping code will use this IP address to join to when starting the container.</li>
</ul>
<p>Simply repeat the above command once for each node you want to start.</p>
<p><strong>Using Riak Explorer</strong></p>
<p><a href="https://github.com/basho-labs/riak_explorer" target="_blank">Riak Explorer</a> comes bundled with Riak in the standard Docker image. It provides <a href="http://basho-labs.github.io/riak_explorer/docs/api.html" target="_blank">a comprehensive HTTP API</a> that adds functionality not available in the <a href="https://docs.riak.com/riak/kv/2.1.4/developing/api/http/http.1.html" target="_blank">standard Riak HTTP API</a>. If you started the coordinator node using a command similar to the one shown above, you should be able to open the Riak Explorer UI in a web browser by navigating to <a href="http://localhost:8098/admin/" target="_blank">http://localhost:8098/admin/</a>. If you&#8217;re using Linux, you can alternatively use the Docker IP passed as the <code>COORDINATOR_NODE</code> value (from the example above: <a href="http://172.17.0.3:8098/admin/" target="_blank">http://172.17.0.3:8098/admin/</a>).</p>
<p><a href="/content/uploads/2016/09/explorer_data.jpg"><img class="alignnone size-medium wp-image-12647" src="/content/uploads/2016/09/explorer_data-300x184.jpg" alt="explorer_data" width="300" height="184" srcset="/content/uploads/2016/09/explorer_data-300x184.jpg 300w, /content/uploads/2016/09/explorer_data-768x472.jpg 768w, /content/uploads/2016/09/explorer_data-1024x629.jpg 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong>Operational Info</strong></p>
<p>Besides providing a nice web GUI for interacting with data in Riak, Explorer provides some nice graphs on resource usage for the cluster, as well as providing information about the nodes in the cluster. Pull up the <a href="http://localhost:8098/admin/#/cluster/default/ops" target="_blank">Ops tab</a>, where you can select &#8220;Individual Node Details&#8221; to see the list of nodes in the cluster and have links provided to view statistics, log files, and current configuration values for each node.</p>
<p><a href="/content/uploads/2016/09/explorer_graphs.jpg"><img class="alignnone size-medium wp-image-12648" src="/content/uploads/2016/09/explorer_graphs-300x201.jpg" alt="explorer_graphs" width="300" height="201" srcset="/content/uploads/2016/09/explorer_graphs-300x201.jpg 300w, /content/uploads/2016/09/explorer_graphs-768x516.jpg 768w, /content/uploads/2016/09/explorer_graphs-1024x688.jpg 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>I&#8217;ll let you two get acquainted. Spend as much time as you like.</p>
<p><strong>Using docker-compose</strong></p>
<p>It&#8217;s fairly easy to encapsulate the necessary parameters to <code>docker run</code> to create a Riak cluster by using <a href="https://docs.docker.com/compose/" target="_blank">docker-compose</a>. First, download one (or both) of the following example <code>docker-compose.yml</code> files and save them to your local disk.</p>
<p><script src="https://gist.github.com/jbrisbin/51b5f40616bf3265f250d5fd2e707810.js"></script></p>
<p><em>NOTE: If you name them anything other than <code>docker-compose.yml</code>, remember that you&#8217;ll have to add the -f myfile.yml option to <code>docker-compose</code> every time you run the command.</em></p>
<p>There are two services defined in this <code>docker-compose.yml</code> file: a coordinator node and a member node. The intent is to use the <code>coordinator</code> as the value for the <code>COORDINATOR_NODE</code> in subsequent member nodes to create the cluster. You will <code>scale</code> the service to 1 for coordinator and N for members (N = $CLUSTER_SIZE &#8211; 1).</p>
<p>To start a 5-node cluster using <code>docker-compose</code>, use the command <code>scale</code>:</p>
<pre>docker-compose scale coordinator=1 member=4
</pre>
<p>The containers will start in the background. You can monitor their progress with the <code>logs</code> command.</p>
<pre>docker-compose logs
</pre>
<p>When all the member containers have started, you should be able to execute commands like <code>riak-admin cluster status</code> on the coordinator and see that the member nodes have successfully joined the cluster.</p>
<pre>$ docker-compose exec coordinator riak-admin cluster status

---- Cluster Status ----
Ring ready: true

+---------------------+------+-------+-----+-------+
|        node         |status| avail |ring |pending|
+---------------------+------+-------+-----+-------+
| (C) riak@172.17.0.2 |valid |  up   | 87.5|  50.0 |
|     riak@172.17.0.4 |valid |  up   |  0.0|   0.0 |
|     riak@172.17.0.5 |valid |  up   |  0.0|   0.0 |
|     riak@172.17.0.6 |valid |  up   |  0.0|   0.0 |
|     riak@172.17.0.7 |valid |  up   | 12.5|  50.0 |
+---------------------+------+-------+-----+-------+
</pre>
<p>When you&#8217;re ready to take down the cluster, just use <code>docker-compose down</code>.</p>
<p><strong>A Word on Volumes</strong></p>
<p>You can use volumes in <code>docker-compose</code> for <code>/var/lib/data</code> and <code>/var/log/riak</code>&#8211;as well as for the schemas in <code>/etc/riak/schemas</code>. Compose seems to encourage using <code>--volumes-from</code> a specific container (which you&#8217;re certainly free to do). In order to use, say, a local directory, you&#8217;ll need to <a href="https://docs.docker.com/compose/compose-file/#/external" target="_blank">declare the volume as external in the YAML config</a>.</p>
<p><strong>Advanced Configuration</strong></p>
<p>In order to customize the container bootstrapping process with custom configuration, you have several options:</p>
<ul>
<li>Mount the needed configuration items into the container as a volume. e.g. Add <code>-v $(pwd)/riak.conf:/etc/riak/riak.conf</code> to the <code>docker run</code> command.</li>
<li>Augment the default <code>riak.conf</code> using <code>sed</code> like <a href="https://github.com/basho-labs/riak-docker/blob/master/prestart.d/00-update-riak-conf.sh" target="_blank">the built-in bootstrapping script</a>.</li>
<li>Derive a new container from the standard container and copy in the config using <code>COPY</code> in a <code>Dockerfile</code>.</li>
<li>Log into the container interactively using <code>docker exec -it</code>, change the config, and manually restart the node (not really recommended except for one-off, ad hoc situations where you&#8217;re just experimenting since everything will be lost when the container stops).</li>
</ul>
<p><strong>Bucket Type Bootstrapping</strong></p>
<p>The Riak Docker images contain <a href="https://github.com/basho-labs/riak-docker/tree/master/poststart.d" target="_blank">specialized bootstrapping code</a> to find files in the <code>/etc/riak/schemas</code> directory that end in <code>.dt</code> or <code>.sql</code> and use the contents of those files to create bucket types or time series tables, respectively.</p>
<p><strong>Create Schema Files</strong></p>
<p>If you want to bootstrap a <a href="https://docs.riak.com/riak/kv/2.1.4/developing/data-types/" target="_blank">KV datatype</a>, create a file in the <code>/etc/riak/schemas</code> directory named <code>bucket_name.dt</code>. Replace <code>bucket_name</code> with the name you want to use for the bucket. Inside the file, include a single line that contains the datatype you want to use for this bucket.</p>
<p>For example, to create a bucket named &#8220;counter&#8221; for the CRDT datatype <code>counter</code>, create a file named <code>counter.dt</code> and put the text <code>counter</code> as the only content in the file.</p>
<pre>echo "counter" &gt;schemas/counter.dt
</pre>
<p>Mount the schemas into the container as a volume when running the container:</p>
<pre>docker run -d -P -v $(pwd)/schemas:/etc/riak/schemas basho/riak-ts
</pre>
<p>If you pull up Riak Explorer, as described above, you should see a bucket type of &#8220;counter&#8221; listed in the DATA tab.</p>
<p><strong>Create TS Tables</strong></p>
<p>The process for creating <a href="https://docs.riak.com/riak/ts/1.4.0/using/planning/index.html" target="_blank">time series tables</a> is identical to that for bucket types, except the content of the file will be a <code>CREATE TABLE</code> command.</p>
<pre>cat &lt;schemas/GeoCheckin.sql

CREATE TABLE GeoCheckin
(
   id           SINT64    NOT NULL,
   time         TIMESTAMP NOT NULL,
   region       VARCHAR   NOT NULL,
   state        VARCHAR   NOT NULL,
   weather      VARCHAR   NOT NULL,
   temperature  DOUBLE,
   PRIMARY KEY (
     (id, QUANTUM(time, 15, 'm')),
      id, time
   )
)

EOF
</pre>
<p>When you run the container using the above command, the bootstrapping code will create and activate your table and you can then start using it right away.</p>
<p><strong>Volumes for Data and Logs</strong></p>
<p>The Riak Docker image exposes several volumes you can use instead of leaving the nodes to be completely ephemeral and losing everything when the container is shut down. Attach volumes using the <code>-v</code> or <a href="https://docs.docker.com/engine/reference/commandline/run/#/mount-volumes-from-container-volumes-from" target="_blank">&#8211;volumes-from</a> switches when starting the container.</p>
<pre>docker run -d -P -v $(pwd)/data:/var/lib/riak -v $(pwd)/logs:/var/log/riak basho/riak-kv
</pre>
<p><strong>BYOC: Build Your Own Container</strong></p>
<p>If you want the complete flexibility of building your own Docker container. Clone the source of the repo <a href="https://github.com/basho-labs/riak-docker" target="_blank">basho-labs/riak-docker</a> and follow the build instructions in the README.adoc (which is executable using <a href="https://github.com/jbrisbin/asciibuild" target="_blank">asciibuild</a>).</p>
<p><strong>Appendix</strong></p>
<ul>
<li><a href="https://github.com/basho-labs/riak-docker" target="_blank">Riak Docker image repo</a></li>
<li><a href="https://github.com/basho-labs/riak_explorer" target="_blank">Riak Explorer repo</a></li>
<li><a href="https://github.com/basho/riak-python-client" target="_blank">Riak Python client repo</a></li>
<li><a href="https://docs.riak.com/riak/kv/2.1.4/" target="_blank">Riak KV docs</a></li>
<li><a href="https://docs.riak.com/riak/ts/1.4.0/" target="_blank">Riak TS docs</a></li>
<li><a href="https://hub.docker.com/r/basho/riak-kv/" target="_blank">Riak KV on Docker Hub</a></li>
<li><a href="https://hub.docker.com/r/basho/riak-ts/" target="_blank">Riak TS on Docker Hub</a></li>
<li><a href="https://github.com/jbrisbin/asciibuild" target="_blank">asciibuild</a> literate build extension to <a href="https://github.com/asciidoctor/asciidoctor/" target="_blank">Asciidoctor</a></li>
</ul>
<p>Jon Brisbin &lt;jbrisbin@riak.com&gt;<br />
@j_brisbin</p>
													
					</div>
				</article>
				</div></div><div class="tier_2 tier">
		<div class="content_home_2 row">
			<h1>Recent Articles</h1>
			<div class="divider_line">
				<img alt="" src="/content/themes/basho-v2/assets/images/blog/divider-line.png">
			</div>
			
<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13488 post type-post status-publish format-standard hentry category-technical tag-apache-mesos tag-mesosphere tag-riak">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/dcos-and-riak-mesos-framework/index.html?p=13488.html">DC/OS 1.9 and Riak Mesos Framework</a></h2>
			<time class="updated" datetime="2017-03-13T09:47:39+00:00">March 13, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/pavelhardak/index.html" rel="author" class="fn">Pavel Hardak</a></p>
					</header>
		<div class="entry-summary">
			<p>We are pleased today to announce with Mesosphere, the launch of DC/OS 1.9 and a major upgrade of the integration&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/dcos-and-riak-mesos-framework/index.html?p=13488.html">Read More</a></div>
		</div>
	</article>
</div>

<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13441 post type-post status-publish format-standard hentry category-technical tag-iot tag-riak tag-riak-ts tag-the-weather-company">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/traditional-data-lake-approach-may-not-be-a-good-choice-for-iot-data/index.html?p=13441.html">Traditional “Data Lake” Approach May Not Be A Good Choice for IoT Data</a></h2>
			<time class="updated" datetime="2017-03-01T16:46:22+00:00">March 1, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/dorothy-pults/index.html" rel="author" class="fn">Dorothy Pults</a></p>
					</header>
		<div class="entry-summary">
			<p>The momentum around Apache Spark continues. Spark Summit East was a big success and Riak’s own Pavel Hardak was among&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/traditional-data-lake-approach-may-not-be-a-good-choice-for-iot-data/index.html?p=13441.html">Read More</a></div>
		</div>
	</article>
</div>

<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13409 post type-post status-publish format-standard hentry category-technical tag-basho-academy tag-riak tag-riak-kv tag-riak-ts">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/basho-academy-install-code-and-go/index.html?p=13409.html">Riak Academy: Install, Code and Go</a></h2>
			<time class="updated" datetime="2017-02-27T10:25:05+00:00">February 27, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/dorothy-pults/index.html" rel="author" class="fn">Dorothy Pults</a></p>
					</header>
		<div class="entry-summary">
			<p>Are you new to NoSQL and want to find out more about Riak? Riak Academy may be the right place for&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/basho-academy-install-code-and-go/index.html?p=13409.html">Read More</a></div>
		</div>
	</article>
</div>

<div class="col-sm-6 col-md-3 single_blog">
	<article class="post-13356 post type-post status-publish format-standard hentry category-technical tag-iot tag-riak-ts">
				<header>
						<h2 class="entry-title"><a href="/posts/technical/create-your-first-riak-ts-table/index.html?p=13356.html">Create Your First Riak TS Table</a></h2>
			<time class="updated" datetime="2017-02-21T19:05:56+00:00">February 21, 2017</time>
							<p class="byline author vcard"> <a href="/posts/author/dorothy-pults/index.html" rel="author" class="fn">Dorothy Pults</a></p>
					</header>
		<div class="entry-summary">
			<p>Customers like Intellicore are doing real-time analysis of IoT data using Riak TS. We want to make it easy for&#8230; </p>
<div class="learn_more_btn"><a href="/posts/technical/create-your-first-riak-ts-table/index.html?p=13356.html">Read More</a></div>
		</div>
	</article>
</div>
		</div>
	</div>
		
	<div class="divider_bar shadow"></div>
</div>         </main><!-- /.main -->
                  <aside class="sidebar" role="complementary">
                      </aside><!-- /.sidebar -->
              </div><!-- /.content -->
    </div><!-- /.wrap -->
    <footer class="content-info" role="contentinfo">
	<div class="container">
		<div class="footer_menu row">
			<div class="footer-content row">

				<div class="col-sm-12 col-md-8">

					<div class="four-menus">

	<div class="col-xs-6 col-sm-3 menu_col left">
		<ul>
		<li><a href="/products/">Products</a></li><li><a href="/products/integrations/">Integrations</a></li><li><a href="/resources/">Resources</a></li><li><a href="/resources/nosql-databases/index.html?p=9937.html">NoSQL Explained</a></li>							</ul>
	</div>
	<div class="col-xs-6 col-sm-3 menu_col middle">
		<ul>
		<li><a href="/about/">About Riak</a></li><li><a href="/newsroom/">Newsroom</a></li>							</ul>
	</div>
	<div class="col-xs-6 col-sm-3 menu_col middle">
		<ul>
		<li><a href="/blog/">Blog</a></li><li><a href="/community/">DEVELOPERS</a></li>							</ul>
	</div>
	<div class="col-xs-6  col-sm-3 menu_col right">
		<ul>
									</ul>

	</div>

</div>
<div class="copyright col-xs-12">
						
											</div>
				</div>
				<div class="col-sm-12 col-md-3 footer-right">

					<div class="logo">
						<a href="/index.html"><img alt="" src="/content/themes/basho-v2/dist/images/riak-footer-logo.png"></a>
					</div>

										<div class="cf clearfix"></div>

				</div>

				<div class="back_top">
					<img alt="" src="/content/themes/basho-v2/dist/images/back-top.png">
				</div>


			</div>


		</div>
	</div>
</footer>
<div class="sidenav">
 

</div>


</div>


<!-- google analytics code here -->
<link rel='stylesheet' id='eventon_dynamic_styles-css'  href='/content/plugins/eventON/assets/css/eventon_dynamic_styles.css?ver=4.8.2' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"http:\/\/riak.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='/content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9'></script>
<script type='text/javascript' src='/includes/js/hoverIntent.min.js?ver=1.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var megamenu = {"timeout":"300","interval":"100","effect":{"fadeUp":{"in":{"animate":{"opacity":"show","margin-top":"0"},"css":{"margin-top":"10px"}},"out":{"animate":{"opacity":"hide","margin-top":"10px"}}}}};
/* ]]> */
</script>
<script type='text/javascript' src='/content/plugins/megamenu/js/maxmegamenu.js?ver=2.3.8'></script>
<script type='text/javascript' src='/content/plugins/megamenu-pro/assets/public.js?ver=1.4.5'></script>
<script type='text/javascript' src='/includes/js/jquery/ui/core.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='/includes/js/jquery/ui/position.min.js?ver=1.11.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var pum_vars = {"ajaxurl":"http:\/\/riak.com\/wp-admin\/admin-ajax.php","restapi":"http:\/\/riak.com\/wp-json\/pum\/v1","rest_nonce":null,"default_theme":"11522","debug_mode":"","disable_open_tracking":""};
var pum_debug_vars = {"debug_mode_enabled":"Popup Maker Debug Mode Enabled","debug_started_at":"Debug started at:","debug_more_info":"For more information on how to use this information visit http:\/\/docs.wppopupmaker.com\/?utm_medium=js-debug-info&utm_campaign=ContextualHelp&utm_source=browser-console&utm_content=more-info","global_info":"Global Information","localized_vars":"Localized variables","popups_initializing":"Popups Initializing","popups_initialized":"Popups Initialized","single_popup_label":"Popup: #","theme_id":"Theme ID: ","label_method_call":"Method Call:","label_method_args":"Method Arguments:","label_popup_settings":"Settings","label_triggers":"Triggers","label_cookies":"Cookies","label_delay":"Delay:","label_conditions":"Conditions","label_cookie":"Cookie:","label_settings":"Settings:","label_selector":"Selector:","label_mobile_disabled":"Mobile Disabled:","label_tablet_disabled":"Tablet Disabled:","label_display_settings":"Display Settings:","label_close_settings":"Close Settings:","label_event_before_open":"Event: Before Open","label_event_after_open":"Event: After Open","label_event_open_prevented":"Event: Open Prevented","label_event_setup_close":"Event: Setup Close","label_event_close_prevented":"Event: Close Prevented","label_event_before_close":"Event: Before Close","label_event_after_close":"Event: After Close","label_event_before_reposition":"Event: Before Reposition","label_event_after_reposition":"Event: After Reposition","label_event_checking_condition":"Event: Checking Condition","triggers":{"click_open":{"name":"Click Open","modal_title":"Click Trigger Settings","settings_column":"<strong>Extra Selectors<\/strong>: {{data.extra_selectors}}"},"auto_open":{"name":"Auto Open","modal_title":"Auto Open Settings","settings_column":"<strong>Delay<\/strong>: {{data.delay}}"},"scroll":{"name":"Scroll","modal_title":"Scroll Trigger Settings","settings_column":"<strong>Trigger<\/strong>: {{data.trigger}}"}},"cookies":{"on_popup_open":{"name":"On Popup Open","modal_title":"On Popup Open Settings"},"on_popup_close":{"name":"On Popup Close","modal_title":"On Popup Close Settings"},"manual":{"name":"Manual JavaScript","modal_title":"Click Trigger Settings"}}};
var ajaxurl = "http:\/\/riak.com\/wp-admin\/admin-ajax.php";
var popmake_default_theme = "11522";
/* ]]> */
</script>
<script type='text/javascript' src='/content/plugins/popup-maker/assets/js/site.min.js?defer&amp;ver=1.6.6.js' defer='defer'></script>
<script type='text/javascript' src='/content/plugins/popup-maker-scroll-triggered-popups/assets/js/site.min.js?defer&amp;ver=1.2.3.js' defer='defer'></script>

<!-- inject:js -->
<script src="/content/themes/basho-v2/dist/scripts/scripts-cd91f277db.min.js"></script>
<!-- endinject -->
<script type='text/javascript' src='/includes/js/embed.min.js?ver=4.8.2'></script>
  </body>
</html>
