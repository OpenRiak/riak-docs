---
title: "Re: Riak 1.4.2 10G Ethernet Performance Problems"
description: ""
project: community
lastmod: 2013-10-26T09:39:01-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12765"
mailinglist_parent_id: "msg12761"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2013-10-26T09:39:01-07:00
---


Chris,

Are you using jumbo frames on your network? (MTU 9000 or w/e) That's just
one aspect, but we've also found there are many other kernel/TCP-stack
tunings that need to be done to get Riak to push the limits of the network.


On Fri, Oct 25, 2013 at 9:10 PM, Chris Read  wrote:

&gt; Greetings all...
&gt;
&gt; Context: We're running Riak 1.4.2 on Ubuntu 12.04 using the Basho build
&gt; .deb package. Out object size varies between 1K and 512K
&gt;
&gt; I've been having some trouble trying to figure out why handoffs between
&gt; our nodes takes so long and never pushes the network card over 2.5 Gb/s.
&gt; Testing communication between nodes using iperf shows that the
&gt; configuration we have can sustain 10G.
&gt;
&gt; Further investigation shows that communication between nodes never uses
&gt; messages &gt; 4k which gets the network cards to top out on packages per
&gt; second before they reach the top bits per second.
&gt;
&gt; Possibly related: I see exactly the same problem when using Basho Bench
&gt; and the pb driver - I can never get the client to go over 2.5Gb/s. This is
&gt; pushing me to suspect erlang vm or something as the problem.
&gt;
&gt; Anyone seen this before? Is there a magic "use bigger messages" flag
&gt; hidden somewhere?
&gt;
&gt; Thanks,
&gt;
&gt; Chris
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

