---
title: "Re: Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime"
description: ""
project: community
lastmod: 2015-04-01T00:55:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15940"
mailinglist_parent_id: "msg15939"
author_name: "Alex De la rosa"
project_section: "mailinglistitem"
sent_date: 2015-04-01T00:55:22-07:00
---


Hi Vitaliy,

How did you find out a node in the cluster was not part in the cluster? any
commands to check that? And then, how did you fix that? (Just curious and
for future references)

Thanks,
Alex

On Wed, Apr 1, 2015 at 9:50 AM, Vitaliy E &lt;13vitam...@gmail.com&gt; wrote:

&gt; Hello everyone,
&gt;
&gt; I've just joined the list, and am a bit late to the party. Sorry about
&gt; that. Thought I would contribute an answer anyway.
&gt;
&gt; Santi, what is you n\_val?
&gt;
&gt; I observed the behavior you are describing on Riak 2.0.0 with n\_val=3 in
&gt; two cases:
&gt;
&gt; 1. One of the nodes was not part of the cluster although the cluster was
&gt; thinking it was. Don't ask me how that happened. Obviously, when a request
&gt; hit that node part of the entries could not be found there.
&gt;
&gt; 2. Look for indexing errors in Solr console and Riak logs. Each Riak node
&gt; has its own Solr "repository", so if an entry fails to be indexed on any of
&gt; them, search results will be inconsistent depending on which set of nodes
&gt; returns it. Let's say you have replicas on nodes A, B, and C. Entry X
&gt; failed to be indexed on A, entry Y failed to be indexed on A and B, and
&gt; entry Z was indexed OK on all nodes. Then you may get {X,Y,Z}, {X,Z}, or
&gt; {Z} as your search results.
&gt;
&gt; In our case the indexing failures were caused by disk/filesystem errors.
&gt;
&gt; Regards,
&gt; Vitaly
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

