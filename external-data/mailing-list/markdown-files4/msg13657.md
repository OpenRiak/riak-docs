---
title: "Re: pagination over 2i indexes in java"
description: ""
project: community
lastmod: 2014-02-16T12:36:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13657"
mailinglist_parent_id: "msg13648"
author_name: "joe dude"
project_section: "mailinglistitem"
sent_date: 2014-02-16T12:36:06-08:00
---


Ok, so now i'm starting to wonder if i have some sort of mis-install. I'm using 
the java 1.4.4 client, with a 1.4.7 server. Now, the server is just one 
instance running inside an ubuntu vmware vm on my windows box.This is what i 
get when i run your gist above:

STORING: key0
STORING: key1
STORING: key2
STORING: key3
STORING: key4
STORING: key5
Exception in thread "main" com.basho.riak.pbc.RiakError: 50693238
at com.basho.riak.pbc.RiakConnection.receive(RiakConnection.java:125)
at com.basho.riak.pbc.RiakClient.store(RiakClient.java:674)
at com.basho.riak.client.raw.pbc.PBClientAdapter.store(PBClientAdapter.java:185)
at com.basho.riak.client.raw.pbc.PBClientAdapter.store(PBClientAdapter.java:205)
at IndexTester.java:27) // This is the store call in that initial for loop.

I'll run this over and over, changing the bucket name, and it blows up at 
different objects. Sometimes i only get 2 objects in there before it blows up, 
and sometimes as many as 15, but so far never more than that. I can query riak 
and see the buckets, see the keys, and see the objects that made it just fine.

So first, what is that error telling me?Â 

Second, nothing shows up in the riak logs at all. Note that i run the above on 
both the windows host machine, and on the ubuntu instance, with the same 
results.

Perhaps there are issues running riak inside an ubuntu vmware vm?

Thanks.




On Wednesday, February 12, 2014 8:48 AM, Brian Roach  wrote:
 
Joe -

The current Java client codebase it built in layers. The top-level
user API uses an instance of the mid-level RawClient interface which
passes it to the appropriate protocol-specific layer at the bottom.

We are not able to reproduce what you are describing using the 1.4.4
version of the client. Doing a 2i query (with a range or a single
value) and specifying a max number of results returns the results
requested and a continuation.

Here's a gist using the RawClient:

https://gist.github.com/broach/99880915e8c71c53e9bb

If you have a test case that demonstrates the issue you're having and
can post it as a gist in github (or a pastie, etc) we'll be happy to
look at it.

Thanks!
- Roach

On Tue, Feb 11, 2014 at 10:32 PM, joe dude  wrote:
&gt; Yeah, i looked at your code and it looks very similar to what i'm doing. The
&gt; difference is i'm just talking to the client directly:
&gt;
&gt; StreamingOperation result = rawClient.fetchIndex(query);
&gt;
&gt; And rawClient is a "PBClusterClient". Might that have something to do with
&gt; it?
&gt;
&gt;
&gt; On Tuesday, February 11, 2014 5:00 PM, Dave Rusek  wrote:
&gt; Joe,
&gt;
&gt; Sorry, I wanted to get that email out before I stepped out. The specific
&gt; test I added is here:
&gt;
&gt; https://github.com/basho/riak-java-client/blob/1.4.x-develop/src/test/java/com/basho/riak/client/itest/ITestBucket.java#L280
&gt;
&gt; Does this represent your use case? If not, do you happen to have a failing
&gt; test I could take a look at?
&gt;
&gt; Thanks!
&gt;
&gt; --
&gt; Dave Rusek
&gt; Software Engineer
&gt; Basho Technologies
&gt; @davidjrusek
&gt;
&gt; On February 11, 2014 at 5:33:57 PM, Dave Rusek (dru...@basho.com) wrote:
&gt;
&gt; Joe,
&gt;
&gt; I added an integration test to the 1.4.x-develop and the 1.4.4 branch of the
&gt; client and tried them against the latest 1.4 branch of Riak but was not able
&gt; to reproduce your issue.
&gt;
&gt; https://github.com/basho/riak-java-client/tree/1.4.x-develop
&gt;
&gt; --
&gt; Dave Rusek
&gt; Software Engineer
&gt; Basho Technologies
&gt; @davidjrusek
&gt;
&gt; On February 11, 2014 at 5:21:11 PM, Brian Roach (ro...@basho.com) wrote:
&gt;
&gt; ---------- Forwarded message ----------
&gt; From: joe dude 
&gt; Date: Tue, Feb 11, 2014 at 2:15 PM
&gt; Subject: Re: pagination over 2i indexes in java
&gt; To: Brian Roach 
&gt; Cc: "riak-users@lists.basho.com" 
&gt;
&gt;
&gt; I'm using 1.4.4, and creating a PBClusterClient.
&gt;
&gt; Thanks.
&gt;
&gt;
&gt; On Tuesday, February 11, 2014 11:03 AM, Brian Roach  wrote:
&gt; Hi Joe -
&gt;
&gt; What version of the Riak Java client are you using, and which protocol
&gt; (PB or HTTP)?
&gt;
&gt; Will take a look at it.
&gt;
&gt; Thanks!
&gt; - Roach
&gt;
&gt; On Tue, Feb 11, 2014 at 11:50 AM, joe dude  wrote:
&gt;&gt; Hi, trying to figure out how to use the java client to do 2i index queries
&gt;&gt; with pagination.
&gt;&gt;
&gt;&gt; I can issue the query with max\_results and get back exactly the number
&gt;&gt; that
&gt;&gt; i asked for, but the continuation value in the returned StreamingOperation
&gt;&gt; object is null.
&gt;&gt;
&gt;&gt; In contrast, i get pagination to work just fine using the examples from:
&gt;&gt; http://docs.basho.com/riak/latest/dev/using/2i/
&gt;&gt;
&gt;&gt; I'm using:
&gt;&gt;
&gt;&gt; public StreamingOperation fetchIndex(IndexSpec indexSpec)
&gt;&gt; throws IOException
&gt;&gt;
&gt;&gt;
&gt;&gt; It's as if i'm missing something when building IndexSpec, but not sure
&gt;&gt; what.
&gt;&gt;
&gt;&gt; Thx.
&gt;&gt;
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

&gt;&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

