---
title: "Re: 1.4.2: 'riak-admin reip' no longer works?"
description: ""
project: community
lastmod: 2013-10-21T09:58:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12719"
mailinglist_parent_id: "msg12718"
author_name: "Joe Caswell"
project_section: "mailinglistitem"
sent_date: 2013-10-21T09:58:40-07:00
---


Reip is the old, evil way to do it that is fraught with peril. When it
works it works spectacularly, and when it doesn't, it fails spectacularly.
The only use case left for reip is when you have simultaneously changed the
node name for every node in the cluster, such as when loading an entire
cluster's worth of backups to new machines. Since a node will not be able
to start unless it is a member of the ring it currently holds, and
`riak-admin cluster [force-]replace` requires there to be at least one node
in the cluster running, reip is the only option to get the first node
started. After the first node, all the rest can be handled with cluster
replace.

Joe Caswell

From: Brady Wetherington 
Date: Monday, October 21, 2013 12:26 PM
To: Dave Brady 
Cc: Riak Users Mailing List 
Subject: Re: 1.4.2: 'riak-admin reip' no longer works?

Huh. I thought we were supposed to use "force-replace" instead of "reip"?

I remember having a discussion a few months back about the documentation and
we cleared it up a little.

Is "reip" the same as "force-replace", or is it more..."quick-and-dirty?" Is
it deprecated?

-B.


On Mon, Oct 21, 2013 at 11:33 AM, Dave Brady  wrote:
&gt; Thanks for clarifying it!
&gt; 
&gt; This functionality has been \*great\* to create quick-and-dirty test rings.
&gt; 
&gt; --
&gt; Dave Brady
&gt; 
&gt; 
&gt; From: "Jared Morrow" 
&gt; To: "Dave Brady" 
&gt; Cc: "Riak Users Mailing List" 
&gt; Sent: Lundi 21 Octobre 2013 16:42:22
&gt; 
&gt; Subject: Re: 1.4.2: 'riak-admin reip' no longer works?
&gt; 
&gt; We actually discussed this recently, my understanding of reip was clearly not
&gt; complete, and Joe Caswell put me on the right track. 'reip' will continue to
&gt; stick around.
&gt; 
&gt; -Jared
&gt; 
&gt; 
&gt; On Mon, Oct 21, 2013 at 8:23 AM, Dave Brady  wrote:
&gt;&gt; No problem, Jared! I'm happy it was a very simple fix.
&gt;&gt; 
&gt;&gt; What concerns me is that the 'cluster' commands do not have an analogous
&gt;&gt; feature: 'replace' does not do the same thing as 'reip'.
&gt;&gt; 
&gt;&gt; Is it truly a foregone conclusion that 'reip' is going away?
&gt;&gt; 
&gt;&gt; --
&gt;&gt; Dave Brady
&gt;&gt; 
&gt;&gt; 
&gt;&gt; From: "Jared Morrow" 
&gt;&gt; To: "Dave Brady" 
&gt;&gt; Cc: "Riak Users Mailing List" 
&gt;&gt; Sent: Lundi 21 Octobre 2013 16:17:52
&gt;&gt; Subject: Re: 1.4.2: 'riak-admin reip' no longer works?
&gt;&gt; 
&gt;&gt; 
&gt;&gt; This was a mistake on my part, if you s/up/down/ (node\_down\_check) on that
&gt;&gt; line it will correctly ensure the node is down before running reip. Sorry
&gt;&gt; about that, clearly 'reip' is not heavily used with the new cluster commands
&gt;&gt; and it slipped under the radar for all these months.
&gt;&gt; 
&gt;&gt; -Jared
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Mon, Oct 21, 2013 at 7:48 AM, Dave Brady  wrote:
&gt;&gt;&gt; Thanks to Joe Caswell at Basho: just have to comment out line 382
&gt;&gt;&gt; (node\_up\_check) in the riak-admin script.
&gt;&gt;&gt; 
&gt;&gt;&gt; --
&gt;&gt;&gt; Dave Brady
&gt;&gt;&gt; 
&gt;&gt;&gt; ----- Original Message -----
&gt;&gt;&gt; From: "Dave Brady" 
&gt;&gt;&gt; To: riak-users@lists.basho.com
&gt;&gt;&gt; Sent: Lundi 21 Octobre 2013 13:59:37
&gt;&gt;&gt; Subject: 1.4.2: 'riak-admin reip' no longer works?
&gt;&gt;&gt; 
&gt;&gt;&gt; Hi everyone,
&gt;&gt;&gt; 
&gt;&gt;&gt; So, I went to copy /var/lib/riak/\* from one five-node cluster to another, so
&gt;&gt;&gt; that we could experiment on the data.
&gt;&gt;&gt; 
&gt;&gt;&gt; I did this fairly frequently in the past (&lt; 1.4.0), and always used
&gt;&gt;&gt; "riak-admin reip  ".
&gt;&gt;&gt; 
&gt;&gt;&gt; Now, when I try that command on our 1.4.2 ring, 'riak-admin' dies with "Node
&gt;&gt;&gt; is not running!"
&gt;&gt;&gt; 
&gt;&gt;&gt; This confuses me, since "reip" requires the ring to be down, but the
&gt;&gt;&gt; "riak-admin" script is indeed expecting the local node to be running when
&gt;&gt;&gt; using this option.
&gt;&gt;&gt; 
&gt;&gt;&gt; I see on the wiki that it is mentioned that "cluster replace" will replace
&gt;&gt;&gt; "reip" in the future. I hope not, since "cluster replace" does not provide
&gt;&gt;&gt; the same functionality.
&gt;&gt;&gt; 
&gt;&gt;&gt; Anyone run into this and find a fix? (Or I am missing something obvious?)
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt; 
&gt;&gt;&gt; --
&gt;&gt;&gt; Dave Brady
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; 
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt; 
&gt;&gt; 
&gt; 
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

