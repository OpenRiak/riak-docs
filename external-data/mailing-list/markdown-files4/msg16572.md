---
title: "Re: adding auth user not valid"
description: ""
project: community
lastmod: 2015-09-28T18:03:07-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16572"
mailinglist_parent_id: "msg16528"
author_name: "Shunichi Shinohara"
project_section: "mailinglistitem"
sent_date: 2015-09-28T18:03:07-07:00
---


Hi Outback,

Sorry for very late response.
It seems that riak-cs doesn't/can't communicate with stanchion node.
There are a couple of possible reasons:

- admin.key and admin.secret should be set both in riak-cs and stanchion
- stanchion\_host should be set properly as stanchion node's listen configuration
- servers that riak-cs node and stanchion nodes are running should be
 communicate by TCP.

I think packet capture (by tcpdump or wireshark or...) is useful to
investigate the communication between riak-cs and stanchion.

Thanks,
Shino

2015-09-15 13:21 GMT+09:00 Outback Dingo :
&gt; seems the docs with auth creds is invalid... or im still broken...
&gt;
&gt;
&gt;
&gt; curl -XPOST http://localhost:8080/riak-cs/user \
&gt; -H 'Content-Type: application/json' \
&gt; -d '{"email":"ad...@admin.com", "name":"admin"}'
&gt;
&gt;
&gt; returns
&gt;
&gt; curl -H 'Content-Type: application/json' -X POST
&gt; http://localhost:8080/riak-cs/user --data '{"email":"ad...@admin.com",
&gt; "name":"admin"}'
&gt;
&gt; 500 Internal Server
&gt; ErrorInternal Server Error
=====================

The server
&gt; encountered an error while processing this
&gt; requestroot@vmbsd:/usr/local/etc/riak-cs #
&gt;
&gt; and the log shows
&gt; 2015-09-15 14:20:33.678 [error] &lt;0.9846.4&gt; Webmachine error at path
&gt; "/riak-cs/user" :
&gt; {error,{error,{badmatch,{error,malformed\_xml}},[{riak\_cs\_s3\_response,xml\_error\_code,1,[{file,"src/riak\_cs\_s3\_response.erl"},{line,335}]},{riak\_cs\_s3\_r
&gt; esponse,error\_response,1,[{file,"src/riak\_cs\_s3\_response.erl"},{line,249}]},{riak\_cs\_wm\_user,accept\_json,2,[{file,"src/riak\_cs\_wm\_user.erl"},{line,119}]},{webmachine\_resource,resource\_call,3,[{file,"src/webmachine\_resource.erl"},{line,1
&gt; 86}]},{webmachine\_resource,do,3,[{file,"src/webmachine\_resource.erl"},{line,142}]},{webmachine\_decision\_core,resource\_call,...},...]}}
&gt; in riak\_cs\_s3\_response:xml\_error\_code/1 line 335
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

