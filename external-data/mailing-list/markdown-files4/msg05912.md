---
title: "Re: About the file size in luwak"
description: ""
project: community
lastmod: 2011-12-09T19:35:51-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05912"
mailinglist_parent_id: "msg05880"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2011-12-09T19:35:51-08:00
---


Fisher,

Once upon a time, I knew Luwak pretty darn well. From what I remember, the
length should be the number of bytes of the content. So if you're file on
the client is 1056 bytes (as an example), but Luwak says 1098, then yea,
maybe something is wrong. To be sure pull the data from Luwak into another
file and compare the two via `wc` and `diff`. If this is a large file
perhaps something failed during the process, check the log files for
failures. Also, if the file is large you'll get a response back \_before\_
Luwak has finished persisting all the data as it buffers it in memory.
 IIRC, the length only accounts for persisted data and not data that it is
still waiting in the buffer. There is a synchronous API but it's only
available via Erlang.

I just realized you have a later thread talking about lost data in Luwak
but I figured I'd still send this response in case anyone else has the same
behavior and is curious how to diagnose.

-Ryan

On Wed, Dec 7, 2011 at 7:28 AM, vuleetu  wrote:

&gt; Hi, All
&gt;
&gt; Right now, the size get from luwak is not the same as record in our
&gt; datbase. Can i use the way to get rid of these broken files:
&gt;
&gt; 1) After write file to luwak using luwak\_put\_stream:send(), then call
&gt; luwak\_put\_stream:close() to close the put stream.
&gt; 2) Use luwak\_put\_stream:status() to get the latest luwak file handler,
&gt; then call luwak\_file:length(Riak, RiakFileHandler) to get the file final
&gt; size in riak. Check if the size in database is the same as the size, if the
&gt; size is different, does that mean the file is broken? Does this way make
&gt; sence?
&gt;
&gt; Thanks
&gt; Fisher
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

