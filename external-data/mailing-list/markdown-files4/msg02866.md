---
title: "Re: Has-A vs Links-To"
description: ""
project: community
lastmod: 2011-04-03T20:56:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02866"
mailinglist_parent_id: "msg02865"
author_name: "Dmitry Demeshchuk"
project_section: "mailinglistitem"
sent_date: 2011-04-03T20:56:08-07:00
---


Something tells me that Riak's current design is not well-suited for
pub-sub, especially with frequent channels removing.

However, I think innostore backend can give you such functionalities.
What you'll need is:

1. Add first\_key and next\_key functionalities to Riak itself (they'll
give you the first and the next keys from the given bucket, which
means first/next keys from the table on the InnoDB level)

2. Add remove\_bucket functionality to Riak, which in fact will call
'DROP TABLE' on the innostore level, giving you an ability to remove
buckets fast.

So, your pub-sub design will look like the following:

1. Each channel has an associated bucket named "channel-ChannelName"

2. When trying to get the next message from the channel, you get the
first key from the bucket and then read its value.

3. Depending on your needs, you may want to read the next key
immediately or stop reading keys until the next subscriber query.

4. If you unsubscribe, you just remove the bucket using 'DROP TABLE'.


On Mon, Apr 4, 2011 at 2:46 AM, Mike Oxford  wrote:
&gt; Pub-sub style, with frequent unsub and channel destruction.
&gt;
&gt; -Mike
&gt;
&gt; On Sun, Apr 3, 2011 at 2:11 PM, Dan Reverri  wrote:
&gt;&gt;
&gt;&gt; Can you describe a bit more what you are trying to model?
&gt;&gt; Thanks,
&gt;&gt; Dan
&gt;&gt; Daniel Reverri
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; d...@basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; On Fri, Apr 1, 2011 at 2:40 PM, Mike Oxford  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; In Riak design, with a given bucket of "subscribers" would it be better
&gt;&gt;&gt; to use the bucket as an actual container of users (denormallized) or use
&gt;&gt;&gt; Riak's linking feature?
&gt;&gt;&gt; While both will work, there are surely some under-the-covers things to
&gt;&gt;&gt; consider...
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt; -mox
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;



-- 
Best regards,
Dmitry Demeshchuk

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

