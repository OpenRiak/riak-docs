---
title: "Re: Link walking with Erlang riak client"
description: ""
project: community
lastmod: 2012-06-19T10:48:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07714"
mailinglist_parent_id: "msg07713"
author_name: "Eric Moritz"
project_section: "mailinglistitem"
sent_date: 2012-06-19T10:48:54-07:00
---


Links may not be the most appropriate way to model a set of associated
users. They have a limited length and both the user data and the
links have to be saved at the same time.

What you can do is emulate a set using a separate bucket and secondary indexes.

So basically the bucket would look like this:

So if I'm a friend of yours,

PUT /buckets/friends/keys/eric-morgan
x-riak-index-friend\_id\_bin: morgan
x-riak-index-user\_id\_bin: eric
Content-Type: application/json

{"user\_id": "eric", "friend\_id": "morgan"}

Then you can fetch a set of my friends by doing a 2i query for the
bucket friends and the index
user\_id.

If you want to a set of all the people that have friended you, do a 2i
query on friend\_id with the value "morgan".

You can quickly see if we're mutual friends by fetching:

/buckets/friends/keys/eric-morgan and /buckets/friends/keys/morgan-eric.

If both are found, then we're mutual friends.

Eric.

On Tue, Jun 19, 2012 at 12:35 PM, Morgan Segalis  wrote:
&gt; Hi everyone !
&gt;
&gt; I'm looking for a NoSQL solution to get ride of MySQL.
&gt; In this particular issue, I think that Riak is one of the top of my choices 
&gt; in order to do what I'm looking for.
&gt;
&gt; I would like to store all my users into Riak.
&gt; I understand that Riak is document oriented, so that's great for getting 
&gt; every information really fast from one user.
&gt; One of the feature I'm really interested in, are Links.
&gt;
&gt; Links seems to be a great way for me to create association between usersâ€¦
&gt;
&gt; When A adds B, I create a link from A to B.
&gt; When B accepts A's invitation, I create a link from B to A.
&gt;
&gt; If links are not both ways, e.g. A to B to A, message can not go through (B 
&gt; who didn't accept A should not get its message yet)
&gt;
&gt; My server is coded in Erlang, I have checked the Erlang riak client, and I 
&gt; didn't see something as simple as the HTTP use of Links in the demo.
&gt;
&gt; 1 - Are Link walking in Erlang fast & easy ?
&gt; 2 - Is it possible to check fast if A -&gt; B -&gt; A (still in Erlang)? ('-&gt;' 
&gt; represents Links)
&gt;
&gt; Thank you for your help !
&gt;
&gt; Morgan.
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

