---
title: "Re: riak restart does not restart yokozuka well"
description: ""
project: community
lastmod: 2015-09-14T08:45:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16520"
mailinglist_parent_id: "msg16519"
author_name: "Alexander Popov"
project_section: "mailinglistitem"
sent_date: 2015-09-14T08:45:13-07:00
---


Yes there is plenty of errors there like
Committed before 500 {msg=GC overhead limit
exceeded,trace=java.lang.OutOfMemoryError: GC overhead limit exceeded
 null:org.eclipse.jetty.io.EofException

and so on, this is reason why I try to restart node

My concerns is:
\* search on this node come to un-working state and not repaired itself
\* halted node, requires manual actions
\* false positive report or\* riak restart \*


On Mon, Sep 14, 2015 at 6:22 PM, Fred Dushin  wrote:

&gt; Check the solr logs to see why it failed to shut down. If necessary, find
&gt; the pid bound to port 8985 and kill it.
&gt;
&gt; -Fred
&gt;
&gt; On Sep 14, 2015, at 5:28 AM, Alexander Popov  wrote:
&gt;
&gt; i'm doing riak restart
&gt; and got 'ok' in answer, but node appears in shutdown state.
&gt;
&gt; in proccess list i found that solr is still running, and in logs found :
&gt;
&gt; 2015-09-14 09:21:03.939 [info] &lt;0.579.0&gt;@yz\_solr\_proc:init:96 Starting
&gt; solr: "/usr/bin/java"
&gt; ["-Djava.awt.headless=true","-Djetty.home=/usr/lib/riak/lib/yokozuna-2.1.0-0-gcb41c27/priv/solr","-Djetty.port=80
&gt; 2015-09-14 09:21:04.006 [warning] &lt;0.6.0&gt; lager\_error\_logger\_h dropped 6
&gt; messages in the last second that exceeded the limit of 100 messages/sec
&gt; 2015-09-14 09:21:04.006 [info] &lt;0.7.0&gt; Application yokozuna started on
&gt; node 'riak@ip-10-0-0-147.ec2.internal'
&gt; 2015-09-14 09:21:04.010 [info] &lt;0.7.0&gt; Application cluster\_info started on
&gt; node 'riak@ip-10-0-0-147.ec2.internal'
&gt; 2015-09-14 09:21:04.047 [info]
&gt; &lt;0.209.0&gt;@riak\_core\_capability:process\_capability\_changes:555 New
&gt; capability: {riak\_control,member\_info\_version} = v1
&gt; 2015-09-14 09:21:04.051 [info] &lt;0.7.0&gt; Application riak\_control started on
&gt; node 'riak@ip-10-0-0-147.ec2.internal'
&gt; 2015-09-14 09:21:04.051 [info] &lt;0.7.0&gt; Application erlydtl started on node
&gt; 'riak@ip-10-0-0-147.ec2.internal'
&gt; 2015-09-14 09:21:04.062 [info] &lt;0.7.0&gt; Application riak\_auth\_mods started
&gt; on node 'riak@ip-10-0-0-147.ec2.internal'
&gt; 2015-09-14 09:21:04.156 [info] &lt;0.579.0&gt;@yz\_solr\_proc:handle\_info:135 solr
&gt; stdout/err: Error: Exception thrown by the agent.
&gt; 2015-09-14 09:21:04.156 [info] &lt;0.579.0&gt;@yz\_solr\_proc:handle\_info:135 solr
&gt; stdout/err: : java.rmi.server.ExportException: Port already in use: 8985;
&gt; nested exception is:.
&gt; &lt;------&gt;java.net.BindException: Address already in use
&gt;
&gt; 2015-09-14 09:21:04.476 [error] &lt;0.579.0&gt; gen\_server yz\_solr\_proc
&gt; terminated with reason: {"solr OS process exited",1}
&gt; 2015-09-14 09:21:04.476 [error] &lt;0.579.0&gt; CRASH REPORT Process
&gt; yz\_solr\_proc with 0 neighbours exited with reason: {"solr OS process
&gt; exited",1} in gen\_server:terminate/6 line 744
&gt; 2015-09-14 09:21:04.476 [error] &lt;0.578.0&gt; Supervisor yz\_solr\_sup had child
&gt; yz\_solr\_proc started with yz\_solr\_proc:start\_link("/var/lib/riak/yz", 8093,
&gt; 8985) at &lt;0.579.0&gt; exit with reason {"solr OS process e
&gt; 2015-09-14 09:21:04.477 [info] &lt;0.622.0&gt;@yz\_solr\_proc:init:96 Starting
&gt; solr: "/usr/bin/java"
&gt; ["-Djava.awt.headless=true","-Djetty.home=/usr/lib/riak/lib/yokozuna-2.1.0-0-gcb41c27/priv/solr","-Djetty.port=80
&gt; 2015-09-14 09:21:04.710 [info] &lt;0.622.0&gt;@yz\_solr\_proc:handle\_info:135 solr
&gt; stdout/err: Error: Exception thrown by the agent.
&gt; 2015-09-14 09:21:04.710 [info] &lt;0.622.0&gt;@yz\_solr\_proc:handle\_info:135 solr
&gt; stdout/err: : java.rmi.server.ExportException: Port already in use: 8985;
&gt; nested exception is:.
&gt; &lt;------&gt;java.net.BindException: Address already in use
&gt;
&gt; 2015-09-14 09:21:05.029 [error] &lt;0.622.0&gt; gen\_server yz\_solr\_proc
&gt; terminated with reason: {"solr OS process exited",1}
&gt; 2015-09-14 09:21:05.029 [error] &lt;0.622.0&gt; CRASH REPORT Process
&gt; yz\_solr\_proc with 0 neighbours exited with reason: {"solr OS process
&gt; exited",1} in gen\_server:terminate/6 line 744
&gt; 2015-09-14 09:21:05.030 [error] &lt;0.578.0&gt; Supervisor yz\_solr\_sup had child
&gt; yz\_solr\_proc started with yz\_solr\_proc:start\_link("/var/lib/riak/yz", 8093,
&gt; 8985) at &lt;0.622.0&gt; exit with reason {"solr OS process e
&gt; 2015-09-14 09:21:05.030 [error] &lt;0.578.0&gt; Supervisor yz\_solr\_sup had child
&gt; yz\_solr\_proc started with yz\_solr\_proc:start\_link("/var/lib/riak/yz", 8093,
&gt; 8985) at &lt;0.622.0&gt; exit with reason reached\_max\_restart
&gt; 2015-09-14 09:21:05.030 [error] &lt;0.577.0&gt; Supervisor yz\_sup had child
&gt; yz\_solr\_sup started with yz\_solr\_sup:start\_link() at &lt;0.578.0&gt; exit with
&gt; reason shutdown in context child\_terminated
&gt; 2015-09-14 09:21:05.030 [error] &lt;0.577.0&gt; Supervisor yz\_sup had child
&gt; yz\_solr\_sup started with yz\_solr\_sup:start\_link() at &lt;0.578.0&gt; exit with
&gt; reason reached\_max\_restart\_intensity in context shutdown
&gt; 2015-09-14 09:21:05.031 [info] &lt;0.7.0&gt; Application yokozuna exited with
&gt; reason: shutdown
&gt; 2015-09-14 09:21:05.033 [info] &lt;0.340.0&gt;@riak\_kv\_app:prep\_stop:232
&gt; Stopping application riak\_kv - marked service down.
&gt; 2015-09-14 09:21:05.034 [info] &lt;0.340.0&gt;@riak\_kv\_app:prep\_stop:236
&gt; Unregistered pb services
&gt; 2015-09-14 09:21:05.034 [info] &lt;0.340.0&gt;@riak\_kv\_app:prep\_stop:241
&gt; unregistered webmachine routes
&gt; 2015-09-14 09:21:05.037 [info] &lt;0.340.0&gt;@riak\_kv\_app:prep\_stop:243 all
&gt; active put FSMs completed
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.415.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_hook) host stopping (&lt;0.415.0&gt;)
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.416.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_hook) host stopping (&lt;0.416.0&gt;)
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.408.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (&lt;0.408.0&gt;)
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.410.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (&lt;0.410.0&gt;)
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.409.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (&lt;0.409.0&gt;)
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.412.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (&lt;0.412.0&gt;)
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.413.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (&lt;0.413.0&gt;)
&gt; 2015-09-14 09:21:05.038 [info] &lt;0.411.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (&lt;0.411.0&gt;)
&gt; 2015-09-14 09:21:05.039 [info] &lt;0.404.0&gt;@riak\_kv\_js\_vm:terminate:237
&gt; Spidermonkey VM (pool: riak\_kv\_js\_map) host stopping (&lt;0.404.0&gt;)
&gt; 2015-09-14 09:21:05.039 [info] &lt;0.340.0&gt;@riak\_kv\_app:stop:254 Stopped
&gt; application riak\_kv.
&gt; 2015-09-14 09:21:05.043 [info] &lt;0.165.0&gt;@riak\_core\_app:stop:114 Stopped
&gt; application riak\_core.
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

