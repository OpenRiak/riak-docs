---
title: "Re: Loosing data with bucket types,	custom backend and active data entropy"
description: ""
project: community
lastmod: 2014-05-21T10:25:03-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14254"
mailinglist_parent_id: "msg14252"
author_name: "Matthew Dawson"
project_section: "mailinglistitem"
sent_date: 2014-05-21T10:25:03-07:00
---


On May 21, 2014 02:33:40 PM Oleksiy Krivoshey wrote:
&gt; I think I've found that rare case when I don't get deletedvlock before
&gt; 'put' in my code.
&gt; 
&gt; Sorry for bothering everyone :)
&gt; 
&gt; On 21 May 2014 14:15, Oleksiy Krivoshey  wrote:
&gt; &gt; I think its a different issue and might be my own misunderstanding:
&gt; &gt; 
&gt; &gt; The actual order of operations is (all same key):
&gt; &gt; 
&gt; &gt; 1. write
&gt; &gt; 3. read
&gt; &gt; 4. delete
&gt; &gt; 5. write
&gt; &gt; 6. read - failed
&gt; &gt; 
&gt; &gt; So it might be tombstone problem. However I always do 'get' with
&gt; &gt; 'deletedvclock: true' before 'put' or 'delete' and provide a vclock.
I've seen a similar failure case when I was playing around with Riak. I found 
the solution is to do a read before 5 with r=n (r=3 in the default case), and 
then do the write with the returned vclock, if any is returned. Try that and 
see if it helps.
-- 
Matthew

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

