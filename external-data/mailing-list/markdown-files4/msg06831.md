---
title: "Re: riakkit, a python riak object mapper, has hit beta!"
description: ""
project: community
lastmod: 2012-03-01T18:35:16-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06831"
mailinglist_parent_id: "msg06829"
author_name: "Andrey V. Martyanov"
project_section: "mailinglistitem"
sent_date: 2012-03-01T18:35:16-08:00
---


Hi!

Two things force me to avoid using Riakkit: the code is GPL licensed and
non pep8 compliant. So, I cannot fork it and make changes. The code needs
clean up, for example, json module is imported in document.py, but not
used. Riakkit has no conflict resolution logic, it's basically delegate the
work to underlying python client. If I'd like to implement my save method I
need to copy and rewrite more than 150 lines of code mess. What I think the
mapper should do:
1. Serialize the objects to valid json;
2. Deserialize the data back to class instances;
3. Validate the fields data;
4. Track dependencies between models;

Simple example using Riakkit-like syntax;

class Post(Document):

 bucket\_name = 'posts'

 title = types.StringProperty(required=True)
 content = types.StringProperty(required=True)


class Comment(Document):

 bucket\_name = 'comments'

 text = types.StringProperty(required=True)
 post = types.IndexReferenceProperty(reference\_class=Post,
collection\_name='comments')

&gt;&gt;&gt; post = Post('title', 'content')
&gt;&gt;&gt; comment1 = ('comment1', post=post)
&gt;&gt;&gt; comment2 = ('comment2', post=post)
&gt;&gt;&gt; post.is\_valid()
True
&gt;&gt; post.serialize()
{
 "key": "post\_key",
 "title": "title",
 "content": "content",
 "comments": [
 {
 "key": "comment1\_key",
 "text": "comment1"
 },
 {
 "key": "comment2\_key",
 "text": "comment2"
 },
 ]
}
&gt;&gt;&gt; post.store()
True
&gt;&gt;&gt; post = Post.get\_with\_key('post\_key')
&gt;&gt;&gt; post.comments
['Post comment1', 'Post comment2']
&gt;&gt;&gt; post\_json\_data = get\_json\_data\_from\_request()
&gt;&gt;&gt; post = Post.deserialize(post\_json\_data)
&gt;&gt;&gt; post.title
'title'
&gt;&gt;&gt; post.comments
['Post comment1', 'Post comment2']

Something like that.


Best regards,
Andrey Martyanov

On Fri, Mar 2, 2012 at 5:39 AM, Sean Carey  wrote:

&gt; Keep up the great work Shuhao!
&gt;
&gt;
&gt; On Mar 1, 2012, at 7:36 PM, Shuhao Wu  wrote:
&gt;
&gt; Hey guys,
&gt;
&gt; I started writing riakkit approximately 3 months ago and announced it
&gt; here. In case you missed that, Riakkit is basically an object mapper for
&gt; python and riak, which seemed to be lacking in at the time. Now that 3
&gt; months has passed and I have developed this project into much more than
&gt; what I had envisioned to begin with. It's currently also being used and
&gt; tested in a project of mine (web application) as well and functioning quite
&gt; nicely. I would say that currently this is the only object mapper that can
&gt; compete with their counterparts in other languages for Riak in Python,
&gt; although a lot of work still needs to be done before it could fully compete.
&gt;
&gt; So today I felt that riakkit is "stable" and "clean" enough to deserve the
&gt; first beta release. So I whipped up a website and it's released to pypi.
&gt; Here's (again), a demo (the full tutorial can be found on the links below)
&gt;
&gt; class User(Document):
&gt; client = riak.RiakClient()
&gt; bucket\_name = "users"
&gt;
&gt; name = StringProperty(required=True)
&gt;
&gt; &gt;&gt;&gt; user = User(name="foo")
&gt; &gt;&gt;&gt; user.save()
&gt; &gt;&gt;&gt; print user.name
&gt; foo
&gt;
&gt; If anyone is interested, you can find the website here:
&gt; http://ultimatebuster.github.com/riakkit and the code at
&gt; http://github.com/ultimatebuster/riakkit
&gt;
&gt; Cheers!
&gt;
&gt; Shuhao
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

