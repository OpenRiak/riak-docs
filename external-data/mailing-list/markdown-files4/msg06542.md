---
title: "Re: How to represent relationships, when there may be 1 <-> thousands"
description: ""
project: community
lastmod: 2012-02-05T09:34:09-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06542"
mailinglist_parent_id: "msg06541"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-02-05T09:34:09-08:00
---


Hi Nico,

Links are great when small in number, but run into issues when more numerous, 
including HTTP header size limitations, plus the extra storage overhead of 
bucket+key+tag on disk. I recommend using secondary indexes for this problem, 
but you will need to be using the LevelDB storage engine.

Another possibility is to use an OR-set (CRDT) in a secondary key, as you 
suggest. The difference between an OR-set and a flat list is that the former 
will converge easily when there are conflicts. 

Sean Cribbs

On Feb 5, 2012, at 7:36 AM, Nicolas Petton  wrote:

&gt; Hi!
&gt; 
&gt; We're working on a replacement of the old Smalltalk project hosting
&gt; website http://squeaksource.com/
&gt; 
&gt; For this app we'd like to use Riak, using the Smalltalk client
&gt; http://www.squeaksource.com/Phriak
&gt; 
&gt; You can think of SqueakSource as a Github-like app specific to Smalltalk
&gt; code. 
&gt; 
&gt; Now, my problem is we have a following/followers feature in the new app:
&gt; users can follow projects.
&gt; Some projects may have thousands of followers. We need to be able to get
&gt; followers of a projects \*and\* projects followed by an user quickly.
&gt; 
&gt; Typically, an user will follow a few projects, so this part is easily
&gt; solved with links. It becomes more complicated when it comes to getting
&gt; all users following a specific project, since it can be thousands, using
&gt; links looks like a bad idea.
&gt; 
&gt; I thought of the following solution, but I may be completely off the
&gt; tracks:
&gt; 
&gt; - users have links to projects they follow. 
&gt; - projects don't have links to the users following them, but a link to
&gt; 'following/projectKey'. This object represents the relationship itself,
&gt; and contains the list of the names of users following the project in a
&gt; JSON array.
&gt; 
&gt; This means following a project represents 2 writes, the user with the
&gt; link, and the 'following object'.
&gt; 
&gt; Does that seem reasonable?
&gt; 
&gt; Thanks,
&gt; Nico
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

