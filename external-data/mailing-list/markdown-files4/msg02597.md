---
title: "Re: annoying javascript problem in Reduce phases"
description: ""
project: community
lastmod: 2011-03-10T05:37:39-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02597"
mailinglist_parent_id: "msg02596"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-03-10T05:37:39-08:00
---



On Mar 10, 2011, at 8:26 AM, Antonio Rohman Fernandez wrote:

&gt; Dear Sean,
&gt; thank you for your quick reply.
&gt; 
&gt; "Your reduce function can (almost) never assume that it is operating on the 
&gt; entire result set." -&gt; wow! that totally kills my implementation... i wanted 
&gt; to use the Reduce phase to cut the array as a Limit + Pagination ( like LIMIT 
&gt; 10 PAGE 2 in SQL )... but if i don't have the full result set is impossible 
&gt; and useless. I will have to get all the rows and then process it outside Riak 
&gt; for that.
&gt; 

Note I said "(almost)". In the case where the reduce phase is preceded by 
another reduce phase, you can generally assume that it will only be executed 
once. So, pagination is hard to do but not impossible - do a sorting phase 
before your limit/slice.

&gt; "you must structure your reduce function such that it can receive as inputs 
&gt; anything that it outputs" -&gt; what do you mean with that? can i merge Reduce 
&gt; phases? any example?
&gt; 

What that means is any data you return might again become inputs to the same 
function as I described. The properties we say are needed for reduce functions 
are "commutative, associative, and idempotent". Commutative - it can be applied 
in any order and produce the same result. Associative - any grouping of the 
same inputs will produce the same result. Idempotent - given the same inputs, 
you will get the same result every time (i.e. it has no side-effects).

&gt; i'm building a php MVC framework in top of Riak, and i would like to clone 
&gt; from my SQL implementation as much functionality as i can, so people can 
&gt; easily use Riak as if they were using MySQL/PostgreSQL/etc without noticing.
&gt; thanks.

I can understand the desire to provide similar functionality, but Riak is NOT 
an SQL-like system. Having tried some similar things in Ruby, I believe it's ok 
to provide your users a nice interface, but don't delude them about having the 
same querying capabilities -- it's just NOT the same. It's better to craft the 
features in a way that exposes tradeoffs to them rather than hiding them.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

