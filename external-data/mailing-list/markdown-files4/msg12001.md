---
title: "Re: different versions in upgrade"
description: ""
project: community
lastmod: 2013-08-13T06:59:49-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12001"
mailinglist_parent_id: "msg11999"
author_name: "Charlie Voiselle"
project_section: "mailinglistitem"
sent_date: 2013-08-13T06:59:49-07:00
---


Louis-Philippe et al:

You can follow the rolling upgrade procedure to upgrade a node from 1.2 to 
1.4.x directly. The note in the instructions only concerns upgrading from 1.0 
to 1.4. 

No need to stop at 1.3.2.

Thanks,
Charlie Voiselle

On Aug 13, 2013, at 9:23 AM, Guido Medina  wrote:

&gt; Also, in theory if you have at least 5 nodes in the cluster one node down at 
&gt; a time doesn't stop your cluster from working properly.
&gt; 
&gt; You could do the following node by node which I have done several times:
&gt; Stop Riak on the upgrading node and in another node mark the upgrading node 
&gt; as down (riak-admin down riak@upgrading-node)
&gt; Upgrade Riak on that node to version 1.3.2, start it up and wait till it is 
&gt; completely operative (riak\_kv is up and all transfers are finished, check by 
&gt; typing "riak-admin transfers")
&gt; For Riak 1.3.2 once the step is over, type "riak-admin reformat-indexes" and 
&gt; tail -f /var/log/riak/console.log which should be done really fast if there 
&gt; isn't anything to fix.
&gt; Do 1 to 3 per node.
&gt; Do 1 and 2 but for for Riak 1.4.1.
&gt; 
&gt; HTH,
&gt; 
&gt; Guido.
&gt; 
&gt; On 13/08/13 13:50, Guido Medina wrote:
&gt;&gt; Same here, except that Riak 1.3.2 did that for me automatically. As Jeremiah 
&gt;&gt; mentioned, you should go first to 1.3.2 on all nodes, per node the first 
&gt;&gt; time Riak starts it will take some time upgrading the 2i indexes storage 
&gt;&gt; format, if you see any weirdness then execute "riak-admin reformat-indexes" 
&gt;&gt; as soon as you upgrade a node, 1 by 1.
&gt;&gt; 
&gt;&gt; Before you even start read the release notes for each major version besides 
&gt;&gt; the rolling upgrade doc:
&gt;&gt; 
&gt;&gt; Riak 1.3.2: https://github.com/basho/riak/blob/1.3/RELEASE-NOTES.md
&gt;&gt; Riak 1.4.1: https://github.com/basho/riak/blob/1.4/RELEASE-NOTES.md
&gt;&gt; 
&gt;&gt; HTH,
&gt;&gt; 
&gt;&gt; Guido.
&gt;&gt; 
&gt;&gt; On 13/08/13 13:41, Bhuwan Chawla wrote:
&gt;&gt;&gt; Having done a similar upgrade, a gotcha to keep in mind: 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; "Note for Secondary Index users
&gt;&gt;&gt; If you use Riak's Secondary Indexes and are upgrading from a version prior 
&gt;&gt;&gt; to Riak version 1.3.1, you need to reformat the indexes using the 
&gt;&gt;&gt; riak-admin reformat-indexes command"
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; On Tue, Aug 13, 2013 at 8:36 AM, Jeremiah Peschka 
&gt;&gt;&gt;  wrote:
&gt;&gt;&gt; From http://docs.basho.com/riak/latest/ops/running/rolling-upgrades/ it 
&gt;&gt;&gt; looks like you should upgrade to 1.3.2 and then 1.4.1
&gt;&gt;&gt; 
&gt;&gt;&gt; Depending on how badly you need the extra capacity, it would probably be 
&gt;&gt;&gt; better to start by upgrading all nodes and then adding the new one.
&gt;&gt;&gt; 
&gt;&gt;&gt; --
&gt;&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar Unlimited
&gt;&gt;&gt; MCITP: SQL Server 2008, MVP
&gt;&gt;&gt; Cloudera Certified Developer for Apache Hadoop
&gt;&gt;&gt; 
&gt;&gt;&gt; On Aug 13, 2013, at 5:06 AM, Louis-Philippe Perron  
&gt;&gt;&gt; wrote:
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Hi riak peoples,
&gt;&gt;&gt;&gt; I'm in the process of adding a new node to a aging (1 node) cluster. I 
&gt;&gt;&gt;&gt; would like to know what would be the prefered incrementing upgrade to get 
&gt;&gt;&gt;&gt; all my nodes on the latest riak version. The best scenario would also 
&gt;&gt;&gt;&gt; have the least downtime. The old node is at riak version 1.2.1.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; My actual plan is:
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; - install riak 1.4.1 on the new node
&gt;&gt;&gt;&gt; - add the new 1.4.1 node to the old 1.2.1 cluster.
&gt;&gt;&gt;&gt; - bring the 1.2.1 node offline
&gt;&gt;&gt;&gt; - upgrade the 1.2.1 node to 1.4.1
&gt;&gt;&gt;&gt; - put the upgraded node back online
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; will this work?
&gt;&gt;&gt;&gt; thanks!
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; 
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

