---
title: "Re: secondary index issue"
description: ""
project: community
lastmod: 2013-09-15T07:44:11-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12265"
mailinglist_parent_id: "msg12264"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2013-09-15T07:44:11-07:00
---


While I can't say for sure, what I suspect is happening is that the escape
character is being ignored and you're getting a query for a range. Both the
original and the range query produce the same result:

# original
$ curl
http://127.0.0.1:10018/buckets/youmag/index/contentid\_bin/1570\/204004
{"keys":["art3","art1"]}

#range
$ curl http://127.0.0.1:10018/buckets/youmag/index/contentid\_bin/1570/204004
{"keys":["art3","art1"]}

If I URL encode the query I get the right results back:

$ curl
http://127.0.0.1:10018/buckets/youmag/index/contentid\_bin/1570%2F204004
{"keys":["art3"]}

Hope that helps

---
Jeremiah Peschka - Founder, Brent Ozar Unlimited
MCITP: SQL Server 2008, MVP
Cloudera Certified Developer for Apache Hadoop


On Sun, Sep 15, 2013 at 7:21 AM, Fabrice Sznajderman wrote:

&gt; Hello,
&gt;
&gt; I a new comer on Riak.
&gt;
&gt; I started to work with it and i faced with a strange behavior in case of
&gt; secondary index.
&gt;
&gt; First of all I added many objects into RIak with the following queries :
&gt;
&gt; curl -XPUT -H 'x-riak-index-contentid\_bin: '1641/199095'' -H
&gt; 'Content-Type: application/json' -d '{ "permalink\_url" : "
&gt; http://lemonde.fr/planete/article/2012/04/12/shell-a-detecte-une-nappe-de-petrole-dans-le-golfe-du-mexique\_1684795\_3244.html#xtor=RSS-3208",
&gt; "title" : "Shell a détecté une nappe de pétrole dans le golfe du
&gt; Mexique", "content\_id" : "1641/199095", "publication\_date" :
&gt; "2012-04-12T15:23:07.000Z"}' http://localhost:8098/riak/youmag/art1
&gt;
&gt; curl -XPUT -H 'x-riak-index-contentid\_bin: '390/203664'' -H 'Content-Type:
&gt; application/json' -d '{ "permalink\_url" : "
&gt; http://auto-buzz.com/photos-officielles-citroen-concept-numero-9-542805.html",
&gt; "title" : "Les photos officielles du Concept Citroën Numéro 9",
&gt; "content\_id" : "390/203664", "publication\_date" :
&gt; "2012-04-13T07:54:56.000Z"}' http://localhost:8098/riak/youmag/art2
&gt;
&gt; curl -XPUT -H 'x-riak-index-contentid\_bin: '1570/204004'' -H
&gt; 'Content-Type: application/json' -d '{ "permalink\_url" : "
&gt; http://latribune.fr/actualites/economie/france/20120413trib000693391/forte-augmentation-des-creations-d-entreprises-en-mars.html",
&gt; "title" : "Forte augmentation des créations d''entreprises en mars",
&gt; "content\_id" : "1570/204004", "publication\_date" :
&gt; "2012-04-13T08:19:14.000Z"}' http://localhost:8098/riak/youmag/art3
&gt;
&gt; Queries above are an sample, i created more than 200 objects.
&gt;
&gt; You will notice that each query create an secondary index called :
&gt; contentid\_bin.
&gt;
&gt; The strange behavior is when I search for one object by secondary index,
&gt; the result contain more than just the object pointed by the value of
&gt; secondary index.
&gt;
&gt; below the query that i used to queried an indexed object :
&gt;
&gt; curl http://127.0.0.1:8098/buckets/youmag/index/contentid\_bin/390\/203664
&gt;
&gt; the result should be :
&gt;
&gt; keys : art2
&gt;
&gt; The result i got :
&gt;
&gt; keys : art2, art3 ,art1
&gt;
&gt; i hope i am clear in my explanation
&gt;
&gt; Many thanks for your help,
&gt;
&gt; Best regards
&gt;
&gt;
&gt;
&gt; Fabrice Sznajderman
&gt; G+ : http://gplus.to/fsznajderman,
&gt; Rédacteur sur Java - 
&gt; ʕ๏̮๏ʔ
&gt; Communautés G+ : http://gplus.to/developpeurFR -
&gt; http://gplus.to/JavaFRcommunity
&gt;
&gt; Blog : http://blog.fsznajderman.fr 
&gt; Twitter : fsznajderman
&gt; photographie : http://photos.fsznajderman.fr
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

