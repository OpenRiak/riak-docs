---
title: "Re: No message in sasl-error.log for wrong post commit erlang hook"
description: ""
project: community
lastmod: 2012-02-03T05:36:37-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06521"
mailinglist_parent_id: "msg06518"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-02-03T05:36:37-08:00
---


Alin,

Riak no longer uses the default sasl error\_logger, but our own logging
library, lager. You can find the output in crash.log (and probably a
transformed version of it in console.log).

On Fri, Feb 3, 2012 at 5:53 AM, Alin Popa  wrote:

&gt; Forgot to mention that I've also configured the bucket to be using the
&gt; postcommit hook:
&gt;
&gt; curl -v -X PUT -H "Content-Type: application/json" -d
&gt; '{"props":{"postcommit":[{"mod":"post\_commit\_hooks","fun":"log"}]}}'
&gt; http://127.0.0.1:8098/riak/mybucket
&gt;
&gt; Alin
&gt;
&gt;
&gt; On Fri, Feb 3, 2012 at 12:37 PM, Alin Popa  wrote:
&gt;
&gt;&gt; Hi guys,
&gt;&gt;
&gt;&gt; I've worked a bit with the Riak's post commit hooks:
&gt;&gt;
&gt;&gt; 1. Create a post commit module/function:
&gt;&gt;
&gt;&gt; \*-module(post\_commit\_hooks).\*
&gt;&gt; \*
&gt;&gt; \*
&gt;&gt; \*-export([log/1]).\*
&gt;&gt; \*
&gt;&gt; \*
&gt;&gt; \*log(Object) -&gt;\*
&gt;&gt; \* error\_logger:info\_msg("OBJECT: ~p~n",[Object]).\*
&gt;&gt;
&gt;&gt; 2. Updated the app.conf file in order to pick it up
&gt;&gt; 3. Compiled the file using the erts that's embedded into the riak
&gt;&gt; distribution (which is 1.0.3 btw)
&gt;&gt; 4. Started the riak node
&gt;&gt; 5. Done some simple operations (get and save of objects) and I was able
&gt;&gt; to see the object being dumped to the console.log file.
&gt;&gt;
&gt;&gt; For the failing scenario:
&gt;&gt; 1. Changed the function a bit in order to call an inexistent function
&gt;&gt;
&gt;&gt; \*-module(post\_commit\_hooks).\*
&gt;&gt; \*
&gt;&gt; \*
&gt;&gt; \*-export([log/1]).\*
&gt;&gt; \*
&gt;&gt; \*
&gt;&gt; \*log(Object) -&gt;\*
&gt;&gt; \* error\_loggerrrrr:info\_msg("OBJECT: ~p~n",[Object]).\*
&gt;&gt;
&gt;&gt; 2. Stop riak
&gt;&gt; 3. Enabled sasl logging {sasl,[{error\_logger\_mf\_maxfiles,
&gt;&gt; 5},{sasl\_error\_logger, {file,
&gt;&gt; "/Users/alin/riak/log/sasl-error.log"}},{error\_logger\_mf\_maxbytes,
&gt;&gt; 10485760},{errorlog\_type, error},{error\_logger\_mf\_dir,
&gt;&gt; "/Users/alin/riak/log"}]}
&gt;&gt; 4. Recompile the file, using the same erts version
&gt;&gt; 5. Start riak
&gt;&gt; 6. Read and save of the riak objects, but this time, can't see any error
&gt;&gt; to the log files (especially sasl-error.log, as basho's wiki is suggesting
&gt;&gt; [1], even though I can see different kind of messages to sasl-error.log
&gt;&gt; that are not related to the failing execution).
&gt;&gt;
&gt;&gt; Is it something that I'm missing, or is this a bug ?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Alin
&gt;&gt;
&gt;&gt; [1] http://wiki.basho.com/Commit-Hooks.html
&gt;&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

