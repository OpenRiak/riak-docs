---
title: "Re: Am I misunderstand read and write quorum? Or am I losing writes?"
description: ""
project: community
lastmod: 2013-04-12T02:15:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10867"
mailinglist_parent_id: "msg10862"
author_name: "Christian Dahlqvist"
project_section: "mailinglistitem"
sent_date: 2013-04-12T02:15:05-07:00
---


Hi Rob,

If you print the fields in the document you retrieved from Riak, does it appear 
to be an older version? Could there perhaps be some problem with 
serialisation/de-serialisation of the data?

Regards,

Christian 



On 12 Apr 2013, at 07:30, Erik Søe Sørensen  wrote:

&gt; Is there any chance that the key in question exists in the bucket prior to 
&gt; the test? If so, then you should update the value (read+write) instead of 
&gt; trying to create it as a whole new object. This has to do with the nature of 
&gt; vector clocks.
&gt; 
&gt; /Erik [not familiar with the Python client API]
&gt; 
&gt; 
&gt; 
&gt; -------- Oprindelig meddelelse --------
&gt; Fra: Rob Speer 
&gt; Dato:
&gt; Til: riak-users Users 
&gt; Emne: Am I misunderstand read and write quorum? Or am I losing writes?
&gt; 
&gt; 
&gt; My understanding is that if you write a document to a cluster of 4 riak 
&gt; servers with w='quorum', then read from that same cluster with r='quorum', 
&gt; that the read should reflect the result of the right.
&gt; 
&gt; My understanding is also that, in the Python client (version 5525f4f3, from 
&gt; master), w = r = 'quorum' by default.
&gt; 
&gt; And yet, the following check in my code fails occasionally:
&gt; 
&gt; riak\_obj = bucket.new(docid, doc)
&gt; riak\_obj.store()
&gt; echo\_doc = bucket.get(docid).data
&gt; for field in doc:
&gt; assert doc[field] == echo\_doc[field], (doc, echo\_doc)
&gt; 
&gt; 
&gt; I thought perhaps my W and R settings were wrong and I was just getting 
&gt; "eventual consistency", so I tried a very slow version where I waited five 
&gt; seconds before reading the updated document. This seems to fail just as 
&gt; often. So it doesn't just seem like I'm reading a write that hasn't happened 
&gt; yet; it seems that the occasional write may \_never happen at all\_.
&gt; 
&gt; Have I misunderstood something? If not, why would this happen, and how can I 
&gt; track it down?
&gt; -- Rob
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

