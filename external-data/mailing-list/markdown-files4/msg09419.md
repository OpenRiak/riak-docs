---
title: "Ordering and Offset problem while performing riak search queries	against 1.2.1 stable"
description: ""
project: community
lastmod: 2012-12-04T05:55:20-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09419"
author_name: "Abhinav Singh"
project_section: "mailinglistitem"
sent_date: 2012-12-04T05:55:20-08:00
---


Hello Everyone,

I have been developing an application using riak search.
I have `riak-1.2.1rc2` installed on my local dev box and most of the things 
works as expected on my local dev,
except for offset problem while using `start=N&rows=M` in riak search queries, 
as shown below:

NOTE: This problem persists when I move the application to our production 
environment setup which uses riak-1.2.1 stable release.

1) /select?start=0&rows=28&sort=ts\_num 
asc&wt=json&q=to:71ad5c26855312ad414caa60c841d48e9a92af1e

Returns me docs with id in following order (I have added ts\_num field info for 
ordering reference):

"5998c1fe483ff4e5289542ea7a9b7eabb8265fbc" 1354624548
"011a4a8c3caccaa61e6d7568dcac5c2b994b3b42" 1354626378
"ffc9b15ea3756b31ea56298e87c4083a1f49080f" 1354626493
"5eed8e6f9a3a804b3c3ae05d32f0bc2b09bdd44f" 1354626724
"657c38f5832a6f421465093edf93e1b5597891a1" 1354626724
…
…

2) /select?start=1&rows=28&sort=ts\_num 
asc&wt=json&q=to:71ad5c26855312ad414caa60c841d48e9a92af1e

"5998c1fe483ff4e5289542ea7a9b7eabb8265fbc" 1354624548 &lt;--- I 
wasn't really expecting this doc id to be returned, infact doc id 
"011a4a8c3caccaa61e6d7568dcac5c2b994b3b42" from above result set is gone missing
"ffc9b15ea3756b31ea56298e87c4083a1f49080f" 1354626493
"5eed8e6f9a3a804b3c3ae05d32f0bc2b09bdd44f" 1354626724
"657c38f5832a6f421465093edf93e1b5597891a1" 1354626724
"aace68ad8eb490e2a7053482c403b18b18567190" 1354626724
…
…

3) /select?start=0&rows=5&sort=ts\_num 
asc&wt=json&q=to:71ad5c26855312ad414caa60c841d48e9a92af1e

"011a4a8c3caccaa61e6d7568dcac5c2b994b3b42" 1354626378 &lt;---- starting 
with doc id "011a4a8c3caccaa61e6d7568dcac5c2b994b3b42", while I was expecting 
"5998c1fe483ff4e5289542ea7a9b7eabb8265fbc" as the first item
"02c790e1e15e82166c91eee37ec1dfd8a1f0b588" 1354626755 &lt;---- doc ids 
from here on are picked from entirely unexpected offset
"0739a91ec35495be32e55deb7fe859b4ea7734e9" 1354626755
"101dc3d3cf005802b8c89efb05e11556535c5ff6" 1354626755
"2224778981d100fb30709e0127fe1a7640ef68ae" 1354626755

4) /select?start=1&rows=5&sort=ts\_num 
asc&wt=json&q=to:71ad5c26855312ad414caa60c841d48e9a92af1e

"02c790e1e15e82166c91eee37ec1dfd8a1f0b588" 1354626755 &lt;---- ordering 
of results look fine but I was expecting them to start from 
"011a4a8c3caccaa61e6d7568dcac5c2b994b3b42" i.e. results are returned from an 
unexpected offset
"0739a91ec35495be32e55deb7fe859b4ea7734e9" 1354626755
"101dc3d3cf005802b8c89efb05e11556535c5ff6" 1354626755
"2224778981d100fb30709e0127fe1a7640ef68ae" 1354626755
"346bf1800c904c811a8ac5eca195462a5829cbd8" 1354626755

Is there a problem with my understanding of riak search? or is this a known bug?
Feedback and help is greatly appreciated.
Thanks in advance.

--
Abhinav

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

