---
title: "Re: Riak Search Precommit Hook in 1.0"
description: ""
project: community
lastmod: 2011-09-20T10:53:36-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04801"
mailinglist_parent_id: "msg04796"
author_name: "Greg Pascale"
project_section: "mailinglistitem"
sent_date: 2011-09-20T10:53:36-07:00
---


Hi Jon,

Thanks for getting back to me.

I'm doing full-text indexing, but I don't need to keep the text around once my 
object has been indexed, so I wrote a second precommit hook to remove the text 
from the object. This reduces the size of my objects drastically (since text 
tends to be the largest part) and has given us substantial perf gains in our 
tests.

-Greg
Clipboard



On Sep 20, 2011, at 7:54 AM, Jon Meredith wrote:

&gt; Hi Greg,
&gt; 
&gt; This is a consequence of the changes we made to bucket properties to try and 
&gt; simplify a few configuration issues. I've filed a bug for it.
&gt; 
&gt; https://issues.basho.com/show\_bug.cgi?id=1216
&gt; 
&gt; Why does your hook need to go after the search hook? 
&gt; 
&gt; Cheers, Jon.
&gt; 
&gt; 
&gt; On Mon, Sep 19, 2011 at 6:37 PM, Greg Pascale  wrote:
&gt; Hi,
&gt; 
&gt; I've noticed that the Riak Search precommit hook behaves in a really odd and 
&gt; non-standard way in Riak 1.0. It seems that setting search:true on a bucket 
&gt; automatically causes the precommit hook to be installed, and setting 
&gt; search:false automatically uninstalls it.
&gt; 
&gt; Ok, but if I set search true and then set precommit to [], it still shows the 
&gt; search hook. Weird. And now if I set precommit to some other hook that I 
&gt; wrote, it just slots it in before the search hook. 
&gt; 
&gt; I find this really lame. I've been working on a precommit hook that needs to 
&gt; come after the search hook, but that seems to be impossible now. Prior to 
&gt; 1.0, I could just issue the command 
&gt; 
&gt; curl -X PUT -d 
&gt; '{"props":{"precommit":[{"mod":"riak\_search\_kv\_hook","fun":"precommit"}, { hook&gt;}]}}' 
&gt; 
&gt; to install the hooks in the right order.
&gt; 
&gt; -- 
&gt; Greg
&gt; Clipboard
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

