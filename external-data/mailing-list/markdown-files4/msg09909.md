---
title: "Re: big cache vs. many partitions and replicas placement"
description: ""
project: community
lastmod: 2013-01-29T02:14:20-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09909"
mailinglist_parent_id: "msg09898"
author_name: "Simon Effenberg"
project_section: "mailinglistitem"
sent_date: 2013-01-29T02:14:20-08:00
---


Hi Christian,

thanks a lot. Yes I talked about eLevelDB (forgot to write it into the
mail). This helps me a lot. I already thought to use 256 as ringsize
but wasn't 100% sure.

Cheers,
Simon

On Mon, 28 Jan 2013 17:23:56 +0000
Christian Dahlqvist  wrote:

&gt; Hi Simon,
&gt; 
&gt; By cache size, I am assuming you are referring to the leveldb internal cache. 
&gt; Is this correct?
&gt; 
&gt; The arguably most important parameter in your configuration is the ring size. 
&gt; Defining an appropriate ring size is very important as it can't change later 
&gt; on and determines how far you can scale. It is recommended that you allow for 
&gt; at about 10 partitions per physical node 
&gt; (http://docs.basho.com/riak/1.3.0/references/appendices/Cluster-Capacity-Planning/#Ring-Size-Number-of-Partitions),
&gt; which means that if you are preparing for a cluster of around 20 nodes, you 
&gt; should probably use 256 partitions.
&gt; 
&gt; At the moment we do not recommend tuning the eleveldb cache\_size at all, so 
&gt; it would be best to leave it at the default value.
&gt; 
&gt; With an n\_val of 3, Riak will store every record on 3 consecutive vnodes in 
&gt; the ring. The case where multiple copies may end up on less than 3 different 
&gt; physical servers primarily applies to cases where there are less than 4 nodes 
&gt; in the cluster as nodes will repeat around the ring wrap around point.This is 
&gt; one of the reasons we recommend using at least 5 nodes in the cluster.
&gt; 
&gt; Best regards,
&gt; 
&gt; Christian
&gt; 
&gt; 
&gt; On 28 Jan 2013, at 15:47, "Effenberg, Simon"  
&gt; wrote:
&gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; we want to save plenty of mails in riak which are in average 14k big. Our 
&gt; &gt; cluster will become between 10 to 20 nodes so the question is: what is 
&gt; &gt; better, having more partitions but each has less cache or is it the other 
&gt; &gt; way around so having less partitions with more cache size?
&gt; &gt; 
&gt; &gt; Also with an n\_val of 3 it is always said, that there is no guarantee for 
&gt; &gt; having this on 3 physical nodes but also that it should be distributed 
&gt; &gt; evenly. What does it mean? Is there any calculation I can do to get a 
&gt; &gt; feeling how often 3 replicas are only on 2 nodes? Or can you say: with 6 
&gt; &gt; nodes and an n\_val of 3 it should be the case that almost 99.9 percent is 
&gt; &gt; distributed over different physical nodes?
&gt; &gt; 
&gt; &gt; Cheers,
&gt; &gt; Simon
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 


-- 
Simon Effenberg | Site Ops Engineer | mobile.international GmbH
Fon: + 49-(0)30-8109 - 7173
Fax: + 49-(0)30-8109 - 7131

Mail: seffenb...@team.mobile.de
Web: www.mobile.de

Marktplatz 1 | 14532 Europarc Dreilinden | Germany


Geschäftsführer: Malte Krüger
HRB Nr.: 18517 P, Amtsgericht Potsdam
Sitz der Gesellschaft: Kleinmachnow 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

