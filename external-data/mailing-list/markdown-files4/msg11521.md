---
title: "Re: Unique secondary index"
description: ""
project: community
lastmod: 2013-07-14T07:41:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11521"
mailinglist_parent_id: "msg11520"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2013-07-14T07:41:57-07:00
---


There's not currently a way to do this that is a pure Riak secondary index
solution.

You could, however, rig something up by creating your own indexes in a
separate bucket. In effect, you end up creating your own inverted index.

Since bucket + key combinations must be unique, you can create an
username\_index bucket as well as an email-address\_index bucket. Assuming
that a user's key is an integer (for the sake of laziness), you would end
up with something like:

username\_index/peschkaj : 12345
email-address\_index/jeremiah.pesc...@gmail.com : 12345

As of today (and to the best of my understanding), it's up to your code to
make sure that a value doesn't exist before writing which means every write
to an index becomes multiple actions against the database (read to check
for existence followed by write), or you'll at least want to make sure your
client sends If-None-Match when you attempt to write new records.

---
Jeremiah Peschka - Founder, Brent Ozar Unlimited
MCITP: SQL Server 2008, MVP
Cloudera Certified Developer for Apache Hadoop


On Sun, Jul 14, 2013 at 4:17 AM, Sandy Herman  wrote:

&gt; Hello,
&gt;
&gt; Is it possible to create a unique secondary index?
&gt; E.g.: The "user"-table would need a unique index:
&gt; \* username
&gt; \* email-address
&gt;
&gt; Thanks a lot
&gt; Sandy
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\*\*\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/\*\*mailman/listinfo/riak-users\_\*\*lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

