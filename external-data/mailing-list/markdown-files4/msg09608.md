---
title: "Re: riak stats via http interface not working"
description: ""
project: community
lastmod: 2012-12-17T13:09:28-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09608"
mailinglist_parent_id: "msg09607"
author_name: "Michael Johnson"
project_section: "mailinglistitem"
sent_date: 2012-12-17T13:09:28-08:00
---


That did it. Thanks!

As a side note for anyone else who might run into this problem, I did have
to make sure this change was made on all nodes and then restart before the
problem went away. Not unexpected, but worth noting.


On Mon, Dec 17, 2012 at 12:51 PM, Sean Cribbs  wrote:

&gt; Michael,
&gt;
&gt; Make sure the mapred\_name and stats\_urlpath values are strings, not atoms.
&gt; e.g.:
&gt;
&gt; {mapred\_name, "mapred"},
&gt; {stats\_urlpath, "stats"}
&gt;
&gt; On Mon, Dec 17, 2012 at 2:48 PM, Michael Johnson wrote:
&gt;
&gt;&gt; For some reason, I am not able to get the riak stats via the http
&gt;&gt; interface. Here is what I get:
&gt;&gt;
&gt;&gt; -bash-4.1$ curl -k https://127.0.0.1:8091/stats/ -E 'text/plain' -D -
&gt;&gt; HTTP/1.1 400 Bad Request
&gt;&gt; Server: MochiWeb/1.1 WebMachine/1.9.0 (someone had painted it blue)
&gt;&gt; Date: Mon, 17 Dec 2012 20:35:25 GMT
&gt;&gt; Content-Type: text/plain
&gt;&gt; Content-Length: 150
&gt;&gt;
&gt;&gt; This resource accepts POSTs with bodies containing JSON of the form:
&gt;&gt; {
&gt;&gt; "inputs":[...list of inputs...],
&gt;&gt; "query":[...list of map/reduce phases...]
&gt;&gt; }
&gt;&gt;
&gt;&gt; And here is the riak\_kv section of my app.config:
&gt;&gt;
&gt;&gt; {riak\_kv, [
&gt;&gt; {hook\_js\_vm\_count, 2},
&gt;&gt; {http\_url\_encoding, on},
&gt;&gt; {js\_max\_vm\_mem, 8},
&gt;&gt; {js\_source\_dir, "/tmp/js\_source"},
&gt;&gt; {js\_thread\_stack, 16},
&gt;&gt; {legacy\_keylisting, false},
&gt;&gt; {legacy\_stats, true},
&gt;&gt; {listkeys\_backpressure, true},
&gt;&gt; {map\_cache\_size, 10000},
&gt;&gt; {map\_js\_vm\_count, 8},
&gt;&gt; {mapper\_batch\_size, 5},
&gt;&gt; {mapred\_2i\_pipe, true},
&gt;&gt; {mapred\_name, mapred},
&gt;&gt; {mapred\_queue\_dir, "/var/lib/riak/mr\_queue"},
&gt;&gt; {mapred\_system, pipe},
&gt;&gt; {raw\_name, "riak"},
&gt;&gt; {reduce\_js\_vm\_count, 6},
&gt;&gt; {riak\_kv\_stat, true},
&gt;&gt; {stats\_urlpath, stats},
&gt;&gt; {storage\_backend, riak\_kv\_eleveldb\_backend},
&gt;&gt; {vnode\_vclocks, true}
&gt;&gt; ]},
&gt;&gt;
&gt;&gt; I have tried single and double quoting 'stats' in the stats\_urlpath
&gt;&gt; value, and I have tried commenting that out as well as setting legacy\_stats
&gt;&gt; to false and simply commenting out the legacy\_stats declaration. The
&gt;&gt; result is always the same. I originally was running riak 1.2.0. Thinking
&gt;&gt; this might be and issue that was resolved in riak 1.2.1, I upgraded and
&gt;&gt; restarted all the nodes, but continue the get the exact same results.
&gt;&gt;
&gt;&gt; In all cases I can run 'riak-admin status' and get the data that way. Is
&gt;&gt; this a known issue, or am I missing something? I found some bug reports
&gt;&gt; that might be related be related, but nothing that I can say for sure.
&gt;&gt;
&gt;&gt; If someone else can let me know if they have the same problem, that would
&gt;&gt; be immensely helpful as it would confirm I an not just missing something.
&gt;&gt; I've read over the docs several times and have not been able to find
&gt;&gt; anything that indicates I am doing anything wrong, so I am at a bit of a
&gt;&gt; loss right now.
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; Sean Cribbs 
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

