---
title: "Re: [ANN] Riak 2.9.0 - Release Candidate 1 Available"
description: ""
project: community
lastmod: 2019-02-04T05:24:03-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18588"
mailinglist_parent_id: "msg18584"
author_name: "Bryan Hunt"
project_section: "mailinglistitem"
sent_date: 2019-02-04T05:24:03-08:00
---


Yeah - it used to be the case that it would be typical to rolling upgrade 
replace, leave, individual cluster nodes - but that was the era when :

a). It cost $5000 per node for a riak\_repl (enterprise) license
b) Most folk ran on physical hardware 

Now with most deployments (Bet366/NHS being notable exceptions) running on 
cloud, and no license fee to pay - it’s a no brainer to go the route of create 
new cluster, replicate, verify, switch over, archive old data.

B

&gt; On 1 Feb 2019, at 14:08, Guido Medina  wrote:
&gt; 
&gt; We could probably go the "replace" way, but maybe we take this as a good 
&gt; opportunity to increase our ring size, it is still something we are 
&gt; considering.
&gt; 
&gt; Resizing the cluster while operating daily is no joke, too much data and Riak 
&gt; becomes extremely slow when we have to add a new node, so it would either go 
&gt; the "replace" way or replicate and switch to the new cluster.
&gt; 
&gt; Thanks for all the answers ;-)
&gt; Guido.
&gt; 
&gt; On 01/02/2019 13:50, Nicholas Adams wrote:
&gt;&gt; If he has an extra node he can add then a replace would be much better. I 
&gt;&gt; provided this example under the assumption that he had no additional 
&gt;&gt; resources to play with.
&gt;&gt; 
&gt;&gt; Nicholas
&gt;&gt; 
&gt;&gt; From: riak-users  
&gt;&gt;  On Behalf Of Fred Dushin
&gt;&gt; Sent: 01 February 2019 22:47
&gt;&gt; To: riak-users@lists.basho.com 
&gt;&gt; Subject: Re: [ANN] Riak 2.9.0 - Release Candidate 1 Available
&gt;&gt; 
&gt;&gt; Wouldn't it be better to do a `riak-admin replace`? Leave could be 
&gt;&gt; problematic if there are other nodes in the cluster that are 
&gt;&gt; under-provisioned (disk space, for example). Plus a leave and add would 
&gt;&gt; move the data around the cluster twice, for each node in the cluster, 
&gt;&gt; whereas a replace would just move the data to the new node once, no?
&gt;&gt; 
&gt;&gt; -Fred
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Feb 1, 2019, at 8:32 AM, Nicholas Adams &gt; &gt; wrote:
&gt;&gt; 
&gt;&gt; Hi Guido,
&gt;&gt; Although Martin would be the most qualified to comment on this, I believe 
&gt;&gt; you should be able to do a slow migration.
&gt;&gt; 
&gt;&gt; Choose target node.
&gt;&gt; Make target node leave cluster as in a full “riak-admin cluster leave”, 
&gt;&gt; commit and wait for transfers to finish.
&gt;&gt; Set up target node with leveled and TicTac AAE.
&gt;&gt; Have node rejoin cluster and wait for transfers to finish.
&gt;&gt; Repeat with every single node in the cluster until all have been done.
&gt;&gt; 
&gt;&gt; Unless you are using specific features restricted to your current backend 
&gt;&gt; then Riak will usually put up with multiple backends in the same cluster.
&gt;&gt; 
&gt;&gt; Failing that, I’d go with Bryan’s suggestion to use MDC to replicate from 
&gt;&gt; your existing cluster to a separate cluster that is using the leveled 
&gt;&gt; backend and TicTac AAE.
&gt;&gt; 
&gt;&gt; Either way, be sure to try in a dev environment first and only proceed when 
&gt;&gt; you are happy with the process.
&gt;&gt; 
&gt;&gt; Best regards,
&gt;&gt; 
&gt;&gt; Nicholas
&gt;&gt; 
&gt;&gt; From: riak-users &gt; &gt; On Behalf Of Bryan Hunt
&gt;&gt; Sent: 01 February 2019 19:22
&gt;&gt; To: Guido Medina &gt;
&gt;&gt; Cc: riak-users@lists.basho.com 
&gt;&gt; Subject: Re: [ANN] Riak 2.9.0 - Release Candidate 1 Available
&gt;&gt; 
&gt;&gt; Replication would be the optimum solution - in theory anything can be 
&gt;&gt; implemented - but it would be enormously painful in comparison to simply 
&gt;&gt; standing up a new cluster.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On 1 Feb 2019, at 10:14, Guido Medina &gt; &gt; wrote:
&gt;&gt; 
&gt;&gt; Hi all,
&gt;&gt; 
&gt;&gt; Nice work on the upcoming 2.9.0 release, I have a quick question:
&gt;&gt; Will it be possible to switch from the eleveldb to the new leveled backend 
&gt;&gt; and Tictac AAE for an existing cluster?
&gt;&gt; 
&gt;&gt; In case it is not possible we are thinking to use the new replication and 
&gt;&gt; move to a brand new cluster.
&gt;&gt; 
&gt;&gt; Kind regards,
&gt;&gt; Guido.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On 30/01/2019 15:23, Nicholas Adams wrote:
&gt;&gt; Dear All,
&gt;&gt; Following on from Martin’s email, the initial builds of the KV 2.9.0rc1 
&gt;&gt; packages are complete. Currently we are limited to Redhat/CentOS 6 and 7 as 
&gt;&gt; well as Ubuntu Bionic. We shall be adding more packages over the next few 
&gt;&gt; days. Please see https://files.tiot.jp/riak/kv/2.9/2.9.0rc1/ 
&gt;&gt;  to download.
&gt;&gt; 
&gt;&gt; Disclaimer: This is a release candidate. Please do not use in production as 
&gt;&gt; we expect bugs and abnormal functionality may occur in certain conditions. 
&gt;&gt; However, please test this lots and place any issues on github so that they 
&gt;&gt; can be fixed before the final release.
&gt;&gt; 
&gt;&gt; Best regards,
&gt;&gt; 
&gt;&gt; Nicholas
&gt;&gt; 
&gt;&gt; From: riak-users  
&gt;&gt;  On Behalf Of Martin Sumner
&gt;&gt; Sent: 30 January 2019 21:07
&gt;&gt; To: riak-users@lists.basho.com 
&gt;&gt; Subject: [ANN] Riak 2.9.0 - Release Candidate 1 Available
&gt;&gt; 
&gt;&gt; All,
&gt;&gt; 
&gt;&gt; There is now a publicly available release candidate for Riak 2.9.0 for users 
&gt;&gt; to test in their own environment. The release candidate is available to 
&gt;&gt; build from source here - https://github.com/basho/riak/tree/riak-2.9.0rc1 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; There is only one significant change to Riak 2.2.6 for users maintaining 
&gt;&gt; existing configuration settings. The release adds the `vnode\_soft\_limits` 
&gt;&gt; feature that aims to reduce high percentile PUT latency, by checking the 
&gt;&gt; outstanding work queue for a vnode before selecting it as a coordinator of a 
&gt;&gt; PUT.
&gt;&gt; 
&gt;&gt; With additional configuration, there are two major features added in riak 
&gt;&gt; 2.9.0:
&gt;&gt; 
&gt;&gt; - Support for the leveled backend (as an alternative to bitcask or 
&gt;&gt; eleveldb), to provide for improved throughput in some use cases and lower 
&gt;&gt; tail latency in some use cases 
&gt;&gt; -https://github.com/martinsumner/riak\_testing\_notes/blob/master/Release%202.9%20-%20Choosing%20a%20Backend.md
&gt;&gt; 
&gt;&gt; ;
&gt;&gt; - Support for a new anti-entropy mechanism (Tictac AAE) as an alternative 
&gt;&gt; for the existing anti-entropy mechanism (to provide both intra-cluster and 
&gt;&gt; inter-cluster data repair, with greater flexibility and reliability).
&gt;&gt; 
&gt;&gt; The release also adds support for:
&gt;&gt; - The riak\_core node\_worker\_pool - which provides a mechanism for queueing 
&gt;&gt; background jobs and queries to control the resource consumed on the node by 
&gt;&gt; different queries. No pre-existing features will use the node-worker\_pool.
&gt;&gt; - AAE folds which allow for both cluster-wide AAE queries (e.g. produce a 
&gt;&gt; merkle tree representing all or a partial range of the cluster data), and 
&gt;&gt; administrative queries (e.g. discovering object sizes and sibling counts 
&gt;&gt; within the database depending on bucket name, key range and last modified 
&gt;&gt; date). AAE folds depend on the Tictac AAE feature being activated.
&gt;&gt; - An interface to request re-replication of an object (where variances 
&gt;&gt; between clusters have been discovered).
&gt;&gt; 
&gt;&gt; Further details of the release, and the release plan in general can be found 
&gt;&gt; here - 
&gt;&gt; https://github.com/basho/riak/blob/develop-2.9/doc/Release%202.9%20Series%20-%20Overview.md
&gt;&gt; 
&gt;&gt; .
&gt;&gt; 
&gt;&gt; It is hoped that there will be a short period of about 1 month before the 
&gt;&gt; release candidate will be converted into a formal release. The period will 
&gt;&gt; allow for more testing by Riak users, and also there will be further 
&gt;&gt; enhanced testing of the new modules with the help of Quviq 
&gt;&gt; (http://www.quviq.com/ ). 
&gt;&gt; 
&gt;&gt; There will follow additional releases under the 2.9 banner, targeted at 
&gt;&gt; enhancing both new and existing inter-cluster replication features. In 
&gt;&gt; parallel to this, work will continue on Release 3.0 which is intended to 
&gt;&gt; modernise the OTP/rebar platform used by Riak.
&gt;&gt; 
&gt;&gt; Thanks to all those who contributed to the release. Apologies to those who 
&gt;&gt; have been kept waiting over the past few months as finalising the changes 
&gt;&gt; and completing the testing has dragged on.
&gt;&gt; 
&gt;&gt; Regards
&gt;&gt; 
&gt;&gt; Martin
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
&gt;&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com 
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

