---
title: "saving meta data always wraps value in an array"
description: ""
project: community
lastmod: 2013-05-19T20:20:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11115"
author_name: "Adam Greene"
project_section: "mailinglistitem"
sent_date: 2013-05-19T20:20:05-07:00
---


hello,

I searched the archives and I didn't see this mentioned; I'm sure I'm
missing something here.

I'm using riak-client 1.2, riak 1.3.1, and the http interface. When I add
a string metadata and store the object, it returns an array. If I store it
again, it returns an array where the first element is the json string of
the previous array. Storing it again creates another nested level, and so
on. See the following example

client = Riak::Client.new #defaults to using the http client
bucket = client.bucket('my\_bucket')
obj = bucket.new(client.stamp.next.to\_s)
obj.data = 'my data'
obj.meta['foo'] = 'bar'
obj.store
=&gt; #]&gt;
obj.meta
=&gt; {"foo"=&gt;["bar"]}
obj.store
=&gt; #]&gt;
obj.meta
=&gt; {"foo"=&gt;["[\"bar\"]"]}

however, when I do this with protocol buffers, it works correctly as
expected.

Any suggestions? I can provide a patch to hack this in the
http\_backend/object\_methods.rb class, but it seems like this might be a
'quirk' of the server? I'm new to riak so again, I do wonder if I'm
missing something!

thanks,
adam
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

