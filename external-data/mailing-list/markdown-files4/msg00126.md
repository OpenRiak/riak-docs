---
title: "Re: Map/Reduce : mapred_funterm() for qfun problem"
description: ""
project: community
lastmod: 2010-04-22T12:18:19-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00126"
mailinglist_parent_id: "msg00123"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2010-04-22T12:18:19-07:00
---


I am slow, you already answered yourself.

Hi,
Yes. If you look in the log on the Riak node you well see that the env around 
your Fun is the module that contains it (even though it is an anon fun, this is 
weird to a JavaScript programer) so if the module changes you will need to 
reload it on the riak nodes. If you need highly dynamic, oft changing M/R fun 
it might be best to use JavaScript. If it is just because you are in dev then 
use that gist to propagate your code changes (maybe hook it into a reloader 
type module 
(http://code.google.com/p/mochiweb/source/browse/trunk/src/reloader.erl)).

There is a thread about this on the trapexit forum here 
http://www.trapexit.org/forum/viewtopic.php?p=53520

Cheers

Russell


On 22 Apr 2010, at 19:35, Abeming Sf wrote:

&gt; Hi Russel,
&gt; 
&gt; Thank you for the link.
&gt; 
&gt; After recompile mapred module, do we need to add it again to riak node?I 
&gt; still got the same error "all nodes failed" when execute m/r from that module.
&gt; 
&gt; Regards,
&gt; Abe
&gt; 
&gt; On 23 April 2010 01:45, Russell Brown  wrote:
&gt; Hi,
&gt; Have a look at this thread
&gt; 
&gt; http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2010-April/000830.html
&gt; 
&gt; The issue is that the code needs to be on the riak node. I use the gist here 
&gt; http://gist.github.com/351659 from that thread in development to make sure my 
&gt; M/R funs are available.
&gt; 
&gt; HTH
&gt; 
&gt; Russell
&gt; On 22 Apr 2010, at 18:08, Abeming Sf wrote:
&gt; 
&gt;&gt; Hi,
&gt;&gt; 
&gt;&gt; I encounter the same problem with this guy 
&gt;&gt; http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2010-March/000809.html
&gt;&gt; where I able to use qfun as fun term in riak/erlang console but failed when 
&gt;&gt; execute it from erlang module. It always returning "all nodes failed" error. 
&gt;&gt; Fyi, I able to use jsanon/jsfun as fun term and execute it from erlang 
&gt;&gt; module.
&gt;&gt; 
&gt;&gt; There is a workaround 
&gt;&gt; http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2010-March/000810.html.
&gt;&gt; 
&gt;&gt; Instead of using jsanon/jsfun and modfun as workaround, is there any 
&gt;&gt; solution if I still want to use qfun?
&gt;&gt; 
&gt;&gt; Regards,
&gt;&gt; Abe
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; 
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

