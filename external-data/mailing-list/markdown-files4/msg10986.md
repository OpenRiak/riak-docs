---
title: "cloned machines issues"
description: ""
project: community
lastmod: 2013-04-27T02:58:06-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10986"
author_name: "Pieter Breed"
project_section: "mailinglistitem"
sent_date: 2013-04-27T02:58:06-07:00
---


Hi,

I'm trying to get two cloned machines to form a new cluster but I'm
struggling to get rid of the old cluster config.

10.10.12.47 and 10.10.12.48 were the two machines the clones were made from
10.10.12.75 and 10.10.12.95 are the new machines' ip

I updated the /var/lib/riak/.erlang.cookie file on both machines to
the same value
I changed the /etc/riak/\* files to use the new ips
I ran the reip command, which on both machines succeeded

riak ping responds on both machines with pong

running riak-admin status on both machines shows this:

ring\_members : ['riak@10.10.12.47','riak@10.10.12.48','riak@10.10.12.75',
 'riak@10.10.12.95']
ring\_num\_partitions : 64
ring\_ownership : &lt;&lt;"[{'riak@10.10.12.75',18},\n
{'riak@10.10.12.95',18},\n {'riak@10.10.12.47',14},\n
{'riak@10.10.12.48',14}]"&gt;&gt;

As you can see the old ip's are still considered part of the cluster,
but they should not be.

I tried this: riak-admin cluster force-remove riak@10.10.12.47
Attempting to restart script through sudo -H -u riak
Remove failed, see log for details

/var/log/riak/console.log shows this in the last few lines:

2013-04-27 11:39:28.442 [info] &lt;0.41.0&gt; alarm\_handler:
{set,{system\_memory\_high\_watermark,[]}}
2013-04-27 11:39:50.528 [info]
&lt;0.325.0&gt;@riak\_core:wait\_for\_service:445 Waiting for service riak\_kv
to start (60 seconds)
2013-04-27 11:41:12.231 [info]
&lt;0.325.0&gt;@riak\_core:wait\_for\_service:439 Wait complete for service
riak\_kv (119 seconds)
2013-04-27 11:41:24.962 [error]
&lt;0.1648.0&gt;@riak\_core\_console:stage\_remove:234 Remove failed
exit:{{nodedown,undefined},{gen\_server,call,[{riak\_core\_claimant,undefined},{stage,'riak@10.10.12.47',remove},infinity]}}

It kind of makes sense because those other ip's are not running at the moment.

Can anyone help me to get rid of those machines in the new cluster?

Regards,
Pieter
--
Give a man fire, he will be warm for a night ; set a man on fire and
he will be warm for the rest of his life.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

