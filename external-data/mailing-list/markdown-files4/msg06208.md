---
title: "Re: documents disappear from riak search index"
description: ""
project: community
lastmod: 2012-01-10T08:32:00-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06208"
mailinglist_parent_id: "msg06205"
author_name: "francisco treacy"
project_section: "mailinglistitem"
sent_date: 2012-01-10T08:32:00-08:00
---


2012/1/10 Ryan Zezeski :
&gt; When you say "doesn't show up on the search query results \*anymore\*" does
&gt; that imply that at one time they did?

Absolutely. As a matter of fact that's what some of my users were
asking: "why can't I see X anymore?".

&gt;  I'm trying to understand if the index
&gt; entries appear to have been lost or if it was never successfully written in
&gt; the first place.

They are definitely written to the index in the first place. I recall
noticing a similar situation early December, where I compared item
counts from a full-bucket map/reduce vs. a search map/reduce and they
didn't match.

Went about it by re-saving all items in the bucket as I said before.
Did a check just after, and numbers matched.

And this morning I was back to the inequality after a user complaint,
so passed the re-save script once again. Obviously this is not
sustainable.

The curious thing is that those documents are not even regularly
updated or deleted.

&gt; Any errors you see in the logs may be relevant.  Feel free to include
&gt; snippets of anything you find.

I went through all sasl-error.log from all 3 nodes and couldn't find
anything related to search. Where else could I look? Do you have any
idea what could be causing this behaviour?

Francisco

&gt;
&gt; On Tue, Jan 10, 2012 at 4:16 AM, francisco treacy
&gt;  wrote:
&gt;&gt;
&gt;&gt; Hi all,
&gt;&gt;
&gt;&gt; I am running (still) 0.14.2 in production, and using Riak Search to
&gt;&gt; index certain buckets. Those buckets have the Riak Search pre-commit
&gt;&gt; hook enabled.
&gt;&gt;
&gt;&gt; Once in a while I get complaints of missing documents from my clients,
&gt;&gt; and it just happened.
&gt;&gt;
&gt;&gt; I checked and the document:
&gt;&gt;  - is correctly stored in Riak
&gt;&gt;  - doesn't show up on the search query results \*anymore\*
&gt;&gt;
&gt;&gt; My workaround before was to go through every key in the bucket and
&gt;&gt; save it again, as to trigger the search hook. Of course, this is less
&gt;&gt; than ideal.
&gt;&gt;
&gt;&gt; Should I be looking for something specific in the logs? What could be
&gt;&gt; going on here?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; Francisco
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

