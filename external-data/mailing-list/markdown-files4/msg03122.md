---
title: "Re: Wrapping my thinking around vector clocks"
description: ""
project: community
lastmod: 2011-04-21T18:29:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03122"
mailinglist_parent_id: "msg03113"
author_name: "Ben Tilly"
project_section: "mailinglistitem"
sent_date: 2011-04-21T18:29:15-07:00
---


Riak's design explicitly falls into the AP corner of the widely cited
CAP Theorem. This means that it gives up consistency. The scenario
that you are asking about involves consistency in a deep way, and so
is tricky to do with Riak.

Your life will be much easier if you visit
http://blog.nahurst.com/visual-guide-to-nosql-systems and pick a
system that supports consistency from the get go for the part of your
work that requires those semantics.

On Thu, Apr 21, 2011 at 11:47 AM, Jeffrey Kesselman  wrote:
&gt; Hi Guys,
&gt;
&gt; I've been studying Riak and am considering a major technology base
&gt; shift in a project I've been working on for more then  a decade (the
&gt; Project Darkstar/RedDwarf game server.)  As may coming to this from a
&gt; strict RDBMS background I am sure, I am trying to wrap my head around
&gt; vector clocks.
&gt;
&gt; I read the "Why vector clocks are reasy" blog and think i follow that.
&gt;  My question is this: what if I have multiple data changes to multipel
&gt; data structures that all have to remain in sync (be atomic)? Which
&gt; data strictures are  involved in any one change is not predictable.  I
&gt; can allow for eventual resolution of that consistent state, and even
&gt; change from one consistent state to another, but the state must always
&gt; be consistant.  This is easy to do in a traitional transaction btu im
&gt; having trouble with the VC equivalent.
&gt;
&gt; As a gedanken experiment picture two players trying to buy a limited
&gt; commodity of which there is only 1 available.  In both cases they are
&gt; attempting to decrement their money, remove the object from the store
&gt; inventory, and add it to their own inventory. Only one can succeed as
&gt; these 3 actions must be atomic.  It is okay for both to initially
&gt; think they succeeded as long as next time we go to look at these
&gt; states they resolve themselves. (Assume a resolution mechanism, for
&gt; argument we can say earliest timestamp wins.)
&gt;
&gt; This needs to be a general solution, knowledge of what the data
&gt; structures are or do \*cannot\* be part of the solution.  This means
&gt; that the item cant itself have an "owner" field which is part of the
&gt; disambiguating logic.  Disambiguating all structures (the 2 player
&gt; inventories, the store  inventory and the two players money values)
&gt; must be done without any semantic knowledge of what the data is for.
&gt;
&gt; Is this possible?  Can someone lay out the solution based on the
&gt; simpel case above?
&gt;
&gt; Thanks
&gt;
&gt; JK
&gt;
&gt;
&gt; Note that I need a general solutioso any
&gt;
&gt; --
&gt; It's always darkest just before you are eaten by a grue.
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

