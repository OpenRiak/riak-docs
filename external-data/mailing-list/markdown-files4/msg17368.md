---
title: "Re: Querying SOLR outside of Riak"
description: ""
project: community
lastmod: 2016-05-16T06:09:59-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17368"
mailinglist_parent_id: "msg17367"
author_name: "Alex De la rosa"
project_section: "mailinglistitem"
sent_date: 2016-05-16T06:09:59-07:00
---


Hi Fred,

Yeah, I realised that on my testing node with n\_val of 3 I was getting the
triple of results in the count... that is not ideal.

I was just concerned on how much extra-work would get Riak to talk with
SOLR and compile data against hitting SOLR directly... For my tests these
days, seems the /search interface is pretty fast and it may not be a real
problem for Riak... but still have my fears from Riak 0.14 an Riak 1.4

Thanks,
Alex

On Mon, May 16, 2016 at 4:49 PM, Fred Dushin  wrote:

&gt; Hi Alex,
&gt;
&gt; Other people have chimed in, but let me repeat that while the
&gt; internal\_solr interface is accessible via HTTP (and needs to be, at least
&gt; from Riak processes), you cannot use that interface to query Solr and
&gt; expect a correct result set (unless you are using a single node cluster
&gt; with an n\_val of 1).
&gt;
&gt; When you run your queries through Riak, Yokozuna, the component that
&gt; interfaces with Solr, will use a riak\_core coverage plan to generate a
&gt; distributed Solr filter query across the entire cluster that guarantees
&gt; that for any document stored on all Solr nodes in the cluster, the query
&gt; will select one (and only one) replica. If you were to run your query
&gt; locally using the internal\_solr interface, your query would not span the
&gt; cluster (likely missing documents on other nodes) and may have duplicates
&gt; (e.g., in degenerate cases where you have more than one replica on the same
&gt; node).
&gt;
&gt; I hope that helps explain why using the internal\_solr interface is not
&gt; only not recommended, it's also not going to give you the results you
&gt; expect.
&gt;
&gt; -Fred
&gt;
&gt; On May 15, 2016, at 4:18 AM, Alex De la rosa 
&gt; wrote:
&gt;
&gt; Hi Vitaly,
&gt;
&gt; I know that you can access search via HTTP through Riak like this:
&gt;
&gt; http://localhost:8098/search/query/famous?wt=json&q=leader:true AND
&gt; age\_i:[25 TO \*]
&gt;
&gt; I didn't find documentation about this, but according to your words I
&gt; could access SOLR directly like this?
&gt;
&gt; http://localhost:8093/internal\_solr/famous/select?wt=json&q=leader:true
&gt; AND age\_i:[25 TO \*]
&gt;
&gt; If I go through "8098/search" would it be adding extra stress into the
&gt; Riak cluster? Or is recommended to go through "8098/search" instead of
&gt; "8093/internal\_solr"??
&gt;
&gt; I just want to see if I can make use of SOLR with an external mapreduce
&gt; platform (Disco) without giving extra stress to Riak.
&gt;
&gt; Thanks,
&gt; Rohman
&gt;
&gt; On Sun, May 15, 2016 at 12:07 PM, Vitaly &lt;13vitam...@gmail.com&gt; wrote:
&gt;
&gt;&gt; There is, you can \*query \*Solr directly via HTTP, at least as of Riak
&gt;&gt; 2.0.x
&gt;&gt;
&gt;&gt; Have a look at http://:8093/internal\_solr/#/ and
&gt;&gt; http://docs.basho.com/riak/kv/2.1.4/developing/usage/search/#querying
&gt;&gt;
&gt;&gt; Vitaly
&gt;&gt;
&gt;&gt;
&gt;&gt; On Sun, May 15, 2016 at 10:49 AM, Alex De la rosa &lt;
&gt;&gt; alex.rosa....@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Nobody knows if there is a way to access SOLR right away without going
&gt;&gt;&gt; through RIAK's interface?
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Alex
&gt;&gt;&gt;
&gt;&gt;&gt; On Fri, May 13, 2016 at 11:07 PM, Alex De la rosa &lt;
&gt;&gt;&gt; alex.rosa....@gmail.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi all,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; If I want to create a Disco cluster [ http://discoproject.org ] to
&gt;&gt;&gt;&gt; build statistics and compile data attacking Riak's SOLR directly without
&gt;&gt;&gt;&gt; using Riak, how can I do it?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; In this way, I would leave Riak mainly for data IO (post/get) and leave
&gt;&gt;&gt;&gt; the heavy duty of searching and compiling data to Disco; so Riak's
&gt;&gt;&gt;&gt; performance shouldn't be affected for searching as mainly it will store and
&gt;&gt;&gt;&gt; retrieve data only.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt; Alex
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

