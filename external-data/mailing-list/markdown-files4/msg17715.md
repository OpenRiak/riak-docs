---
title: "Re: Riak nodes constantly crashing"
description: ""
project: community
lastmod: 2016-10-27T01:40:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17715"
mailinglist_parent_id: "msg17714"
author_name: "Steven Joseph"
project_section: "mailinglistitem"
sent_date: 2016-10-27T01:40:44-07:00
---


I don't think you should disable AAE, you can tune its frequency.

Steven

On Thu, 27 Oct 2016 03:50 Ricardo Mayerhofer  wrote:

&gt; Yes, I'll check if the problem is the AAE! I will disable it and see the
&gt; results.
&gt;
&gt; Thanks Steven!
&gt;
&gt; On Tue, Oct 25, 2016 at 6:54 PM, Steven Joseph 
&gt; wrote:
&gt;
&gt; Hi Ricardo,
&gt;
&gt; If you are using systemd might have to check LimitNOFILE for your units.
&gt; Active anti entropy runs periodically.
&gt;
&gt; Steven
&gt;
&gt; On Wed, 26 Oct 2016 04:36 Ricardo Mayerhofer 
&gt; wrote:
&gt;
&gt; What's weird is that the node crashes every minute at the same second. Is
&gt; there anything Riak may be running every minute?
&gt;
&gt; On Mon, Oct 24, 2016 at 8:28 PM, Ricardo Mayerhofer  &gt; wrote:
&gt;
&gt; I'm also pasting the free -m:
&gt;
&gt; total used free shared buffers cached
&gt; Mem: 15039 14557 482 0 37 4594
&gt; -/+ buffers/cache: 9925 5114
&gt; Swap: 0 0 0
&gt;
&gt; On Mon, Oct 24, 2016 at 8:24 PM, Ricardo Mayerhofer  &gt; wrote:
&gt;
&gt; Hi Alexander,
&gt; Thanks for your response. We use multi-backend with bitcask and leveldb.
&gt;
&gt; - File descriptors seems to be ok, at least the config.
&gt;
&gt; ubuntu@ip-10-2-58-5:/var/log/riak$ sudo su riak
&gt; sudo: unable to resolve host ip-10-2-58-5
&gt; riak@ip-10-2-58-5:/var/log/riak$ ulimit -n
&gt; 65535
&gt;
&gt; - Memory seems to be ok as well:
&gt;
&gt; KiB Mem: \* 15400916 \*total,\* 14493744 \*used,\* 907172 \*free,\* 36244 \*
&gt; buffers
&gt;
&gt; - Disk is ok
&gt;
&gt; /dev/xvda1 20G 4.1G 15G 22% / # root device
&gt; /dev/xvdb 148G 69G 72G 49% /mnt/riak-data # bitcask and riak
&gt; data disk
&gt; /dev/xvdc 296G 23G 258G 8% /mnt/riak-data/leveldb #leveldb disk
&gt;
&gt; Any other idea? Thanks.
&gt;
&gt; On Mon, Oct 24, 2016 at 8:06 PM, Alexander Sicular 
&gt; wrote:
&gt;
&gt; Disk, memory or file descriptors would be my guess. Bitcask?
&gt;
&gt;
&gt; On Monday, October 24, 2016, Ricardo Mayerhofer 
&gt; wrote:
&gt;
&gt; Hi all,
&gt; I have a Riak 1.4 where the nodes seems to be constantly crashing. All 5
&gt; nodes are affected.
&gt;
&gt; However it seems Riak manage to get them up again.
&gt;
&gt; Any idea on whats going on? Erros logs below.
&gt;
&gt; Thanks.
&gt;
&gt; error.log
&gt; ...
&gt; 2016-10-24 21:57:29.185 [error] &lt;0.24570.1174&gt; CRASH REPORT Process
&gt; &lt;0.24570.1174&gt; with 0 neighbours crashed with reason: no case clause
&gt; matching {ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;} in mochiweb\_http:request/3 line
&gt; 107
&gt; 2016-10-24 21:58:29.187 [error] &lt;0.7109.1175&gt; CRASH REPORT Process
&gt; &lt;0.7109.1175&gt; with 0 neighbours crashed with reason: no case clause
&gt; matching {ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;} in mochiweb\_http:request/3 line
&gt; 107
&gt; 2016-10-24 21:59:29.228 [error] &lt;0.19612.1175&gt; CRASH REPORT Process
&gt; &lt;0.19612.1175&gt; with 0 neighbours crashed with reason: no case clause
&gt; matching {ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;} in mochiweb\_http:request/3 line
&gt; 107
&gt; 2016-10-24 22:00:29.218 [error] &lt;0.1356.1176&gt; CRASH REPORT Process
&gt; &lt;0.1356.1176&gt; with 0 neighbours crashed with reason: no case clause
&gt; matching {ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;} in mochiweb\_http:request/3 line
&gt; 107
&gt; 2016-10-24 22:01:29.197 [error] &lt;0.11380.1176&gt; CRASH REPORT Process
&gt; &lt;0.11380.1176&gt; with 0 neighbours crashed with reason: no case clause
&gt; matching {ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;} in mochiweb\_http:request/3 line
&gt; 107
&gt; 2016-10-24 22:02:29.231 [error] &lt;0.24279.1176&gt; CRASH REPORT Process
&gt; &lt;0.24279.1176&gt; with 0 neighbours crashed with reason: no case clause
&gt; matching {ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;} in mochiweb\_http:request/3 line
&gt; 107
&gt;
&gt; crash.log
&gt; 2016-10-24 21:51:56 =CRASH REPORT====
&gt; crasher:
&gt; initial call: mochiweb\_acceptor:init/3
&gt; pid: &lt;0.28136.1621&gt;
&gt; registered\_name: []
&gt; exception error:
&gt; {{case\_clause,{ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;}},[{mochiweb\_http,request,3,[{file,"src/mochiweb\_http.erl"},{line,107}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,227}]}]}
&gt; ancestors: ['http\_0.0.0.0:8098\_mochiweb',riak\_core\_sup,&lt;0.148.0&gt;]
&gt; messages: []
&gt; links: [&lt;0.201.0&gt;,#Port&lt;0.235869290&gt;]
&gt; dictionary: []
&gt; trap\_exit: false
&gt; status: running
&gt; heap\_size: 377
&gt; stack\_size: 24
&gt; reductions: 423
&gt; neighbours:
&gt; 2016-10-24 21:52:56 =CRASH REPORT====
&gt; crasher:
&gt; initial call: mochiweb\_acceptor:init/3
&gt; pid: &lt;0.7845.1622&gt;
&gt; registered\_name: []
&gt; exception error:
&gt; {{case\_clause,{ok,{http\_error,"exit\r\n"},&lt;&lt;&gt;&gt;}},[{mochiweb\_http,request,3,[{file,"src/mochiweb\_http.erl"},{line,107}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,227}]}]}
&gt; ancestors: ['http\_0.0.0.0:8098\_mochiweb',riak\_core\_sup,&lt;0.148.0&gt;]
&gt; messages: []
&gt; links: [&lt;0.201.0&gt;,#Port&lt;0.235879110&gt;]
&gt; dictionary: []
&gt; trap\_exit: false
&gt; status: running
&gt; heap\_size: 377
&gt; stack\_size: 24
&gt; reductions: 406
&gt; --
&gt; Ricardo Mayerhofer
&gt;
&gt;
&gt;
&gt; --
&gt;
&gt;
&gt; Alexander Sicular
&gt; Solutions Architect
&gt; Basho Technologies
&gt; 9175130679
&gt; @siculars
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Ricardo Mayerhofer
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Ricardo Mayerhofer
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Ricardo Mayerhofer
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Ricardo Mayerhofer
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

