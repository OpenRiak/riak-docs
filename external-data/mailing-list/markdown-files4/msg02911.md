---
title: "Re: riak_core and crashed FSM vnode"
description: ""
project: community
lastmod: 2011-04-06T20:46:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02911"
mailinglist_parent_id: "msg02909"
author_name: "Mike Oxford"
project_section: "mailinglistitem"
sent_date: 2011-04-06T20:46:21-07:00
---


Good call, that was it.

Seems dangerous.

-mox


On Wed, Apr 6, 2011 at 5:24 PM, Ryan Zezeski  wrote:

&gt; Lemme guess, sync\_spawn\_command? If so it sets timeout to infinity so your
&gt; shell process is locked in a receive.
&gt;
&gt; [Sent from my iPhone]
&gt;
&gt; On Apr 6, 2011, at 7:41 PM, Mike Oxford  wrote:
&gt;
&gt; &gt; When you crash a riak\_cord vnode with a console attached, what is the
&gt; expected behaviour (ba-dum, dump)?
&gt; &gt;
&gt; &gt; I ran a riak\_core vnode with some bad code (1/0) to cause a bad arith
&gt; crash in the FSM, initiated from the a console (via node "attach").
&gt; &gt;
&gt; &gt; It crashed as expected, obviously, "\*\* State machine &lt;0.85.0&gt;
&gt; terminating" Good.
&gt; &gt; The attached console was then hung. I could ^C and break out of it...but
&gt; I chose ^D to close the connection. Okay, now reattach.
&gt; &gt;
&gt; &gt; I would expect that the vnode\_master supervisor would have restarted the
&gt; FSM, as it's set to start\_link in the supervisor's init.
&gt; &gt;
&gt; &gt; However, when I reattached it was in a "dead" state. I could not execute
&gt; any command, including "2+2."
&gt; &gt; ^C-q to quit out, reattach, node is down (obviously.)
&gt; &gt;
&gt; &gt; Is this "hang status" because I took it down while a shell was attached,
&gt; or is there something else which may prevent the vnode\_master from
&gt; &gt; restarted the crashed vnode/FSM?
&gt; &gt;
&gt; &gt; Thanks!
&gt; &gt;
&gt; &gt; -mox
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

