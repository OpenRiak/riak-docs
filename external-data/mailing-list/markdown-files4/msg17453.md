---
title: "Re: Put failure: too many siblings"
description: ""
project: community
lastmod: 2016-06-05T15:18:46-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17453"
mailinglist_parent_id: "msg17451"
author_name: "Vladyslav Zakhozhai"
project_section: "mailinglistitem"
sent_date: 2016-06-05T15:18:46-07:00
---


Hi, Luke.

Thank you for your answer. I did not understand you completely about
transfer-limit. How does it relate to my problem. Transfer limit - is a
limit of concurrent data transfer from different nodes. Am I wright? You
mean that riak can handoff one partition from several nodes concurrently?

Now I have transfer-limit 1 on all riak nodes.

But I am not sure that my cluster will be converged ever. All nodes
experiences low memory and are killed by OOM Killer periodically. I try to
add new nodes to the cluster but due problem with OOM killer this process
is very-very slow.

In the official docs I've read:

"Sibling explosion occurs when an object rapidly collects siblings that are
not reconciled. This can lead to a variety of problems, including degraded
performance, especially if many objects in a cluster suffer from siblings
explosion. At the extreme, having an enormous object in a node can cause
reads of that object to crash the entire node. Other issues include undue
latency
 and
out-of-memory errors."

I mentioned that new nodes in the cluster do not experience such problems
(I mean out of RAM).

Regarding to siblings maybe your are right, this is manifest object. I can
recognize key name but not bucket name. But more than 100 siblings on many
keys is really confused me. Each time I try to PUT some object to Riak via
Riak CS S3 interface I got errors with siblings.

On Fri, Jun 3, 2016 at 6:43 PM Luke Bakken  wrote:

&gt; Hi Vladyslav,
&gt;
&gt; If you recognize the full name of the object raising the sibling
&gt; warning, it is most likely a manifest object. Sometimes, during hinted
&gt; handoff, you can see these messages. They should resolve after handoff
&gt; completes.
&gt;
&gt; Please see the documentation for the transfer-limit command as well:
&gt;
&gt; http://docs.basho.com/riak/kv/2.1.4/using/admin/riak-admin/#transfer-limit
&gt;
&gt; --
&gt; Luke Bakken
&gt; Engineer
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Fri, Jun 3, 2016 at 2:55 AM, Vladyslav Zakhozhai
&gt;  wrote:
&gt; &gt; Hi.
&gt; &gt;
&gt; &gt; I have a trouble with PUT to Riak CS cluster. During this process I
&gt; &gt; periodically see the following message in Riak error.log:
&gt; &gt;
&gt; &gt; 2016-06-03 11:15:55.201 [error]
&gt; &gt; &lt;0.15536.142&gt;@riak\_kv\_vnode:encode\_and\_put:2253 Put failure: too many
&gt; &gt; siblings for object OBJECT\_NAME (101)
&gt; &gt;
&gt; &gt; and also
&gt; &gt;
&gt; &gt; 2016-06-03 12:41:50.678 [error]
&gt; &gt; &lt;0.20448.515&gt;@riak\_api\_pb\_server:handle\_info:331 Unrecognized message
&gt; &gt; {7345880,{error,{too\_many\_siblings,101}}}
&gt; &gt;
&gt; &gt; Here OBJECT\_NAME - is the name of object in Riak which has too many
&gt; &gt; siblings.
&gt; &gt;
&gt; &gt; I definitely sure that this objects are static. Nobody deletes is, nobody
&gt; &gt; rewrites it. I have no idea why more than 100 siblings of this object
&gt; &gt; occurs.
&gt; &gt;
&gt; &gt; The following effect of this issue occurs:
&gt; &gt;
&gt; &gt; Great amount of keys are loaded to RAM. I almost out of RAM (Do each
&gt; sibling
&gt; &gt; has it own key or key duplicate?).
&gt; &gt; Nodes are slow - adding new nodes are too slow
&gt; &gt; Presence of "too many siblings" affects ownership handoffs
&gt; &gt;
&gt; &gt; So I have several questions:
&gt; &gt;
&gt; &gt; Do hinted or ownership handoffs can affect siblings count (I mean can
&gt; &gt; siblings be created during ownership of hinted handoffs)
&gt; &gt; Is there any workaround of this issue. Do I need remove siblings
&gt; manually or
&gt; &gt; it removes during merges, read repairs and so on
&gt; &gt;
&gt; &gt;
&gt; &gt; My configuration:
&gt; &gt;
&gt; &gt; riak from basho's packages - 2.1.3-1
&gt; &gt; riak cs from basho's packages - 2.1.0-1
&gt; &gt; 24 riak/riak-cs nodes
&gt; &gt; 32 GB RAM per node
&gt; &gt; AAE is disabled
&gt; &gt;
&gt; &gt;
&gt; &gt; I appreciate you help.
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

