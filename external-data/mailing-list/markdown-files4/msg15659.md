---
title: "Re: Riak CS expiration"
description: ""
project: community
lastmod: 2015-02-06T11:22:02-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15659"
mailinglist_parent_id: "msg15655"
author_name: "Kota Uenishi"
project_section: "mailinglistitem"
sent_date: 2015-02-06T11:22:02-08:00
---


Bitcask doesn't have such interface like hooking anything. As of
internal data structure of Riak CS built on top of Riak, bitcask keys
don't correspond simply to leveldb key. Say, things like this cannot
happen: "all tombstones of blocks of this object were collected and
space were reclaimed by merged, so I'm gonna officially hit S3
interface to delete that object". This is because blocks are
distributed all across the cluster.

I'd rather recommend to make up a simple cron job that walks over
objects and see timestamp and hit CS API to delete them when they're
old, or wait for lifecycle API gets implemented.

On Fri, Feb 6, 2015 at 12:24 AM, Damien Krotkine  wrote:
&gt;
&gt; Hi,
&gt;
&gt; As far as I understand, Riak CS uses bitcask for data storage and
&gt; leveldb for metadata.
&gt;
&gt; Trying to implement expiration of data in riak cs, bitcask expiration
&gt; works fine, but of course metadata are still in the leveldb backend. Is
&gt; there any way to expire metadata from riak cs automatically ?
&gt;
&gt; Ideally, I'd like to be able to install a hook or callback on the
&gt; bitcask compaction. Is that possible ?
&gt;
&gt; Thanks,
&gt; dams
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



-- 
Kota UENISHI / @kuenishi
Basho Japan KK

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

