---
title: "Re: Cleaning up bucket after basho_bench run"
description: ""
project: community
lastmod: 2014-03-17T19:33:26-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13827"
mailinglist_parent_id: "msg13824"
author_name: "István"
project_section: "mailinglistitem"
sent_date: 2014-03-17T19:33:26-07:00
---


Thanks Toby!

I think running basho\_bench with only delete operations solves my problem.

Regards,
Istvan

On Mon, Mar 17, 2014 at 5:44 PM, Toby Corkindale  wrote:
&gt; Hi Istvan,
&gt; I posted about this same problem to the list quite a while ago.
&gt; The problem is that the Erlang API allows arbitrary binary sequences,
&gt; whereas the PBC (via Java) and HTTP APIs only handle valid Unicode
&gt; strings.
&gt; So basho\_bench creates keys that can't be manipulated by anything
&gt; except erlang :/
&gt; You can delete them if you write some erlang though..
&gt; -Toby
&gt;
&gt; On 15 March 2014 04:00, István  wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I am trying to clean up some of the test data that was inserted by
&gt;&gt; basho\_bench. The first approach to use curl and streaming the keys
&gt;&gt; fails like this:
&gt;&gt;
&gt;&gt; # curl -XGET -i http://127.0.0.1:8098/buckets/test/keys?keys=stream
&gt;&gt; HTTP/1.1 200 OK
&gt;&gt; Vary: Accept-Encoding
&gt;&gt; Transfer-Encoding: chunked
&gt;&gt; Server: MochiWeb/1.1 WebMachine/1.10.0 (never breaks eye contact)
&gt;&gt; Date: Fri, 14 Mar 2014 16:59:08 GMT
&gt;&gt; Content-Type: application/json
&gt;&gt;
&gt;&gt; curl: (18) transfer closed with outstanding read data remaining
&gt;&gt;
&gt;&gt; When I am trying to the same thing with MapReduce it fails like this:
&gt;&gt;
&gt;&gt; curl -X POST "http://localhost:8098/mapred" -H "Content-Type:
&gt;&gt; application/json" -d '{
&gt;&gt; "inputs": "test",
&gt;&gt; "query": [
&gt;&gt; {
&gt;&gt; "map": {
&gt;&gt; "language": "javascript",
&gt;&gt; "source": "function(riakObject) { return [riakObject.key]; }"
&gt;&gt; }
&gt;&gt; }
&gt;&gt; ]
&gt;&gt; }'
&gt;&gt;
&gt;&gt; Error:
&gt;&gt;
&gt;&gt; {"phase":0,"error":"bad\_utf8\_character\_code","input":"{ok,{r\_object,&lt;&lt;\"test\"&gt;&gt;,&lt;&lt;0,116,71,0&gt;&gt;,[{r\_content,{dict,3,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[],[],[],[],[],[],[],[],[[&lt;&lt;\"X-Riak-VTag\"&gt;&gt;,71,81,80,81,87,76,105,54,113,120,97,116,114,106,51,86,72,53,67,50,82]],[[&lt;&lt;\"index\"&gt;&gt;]],[],[[&lt;&lt;\"X-Riak-Last-Modified\"&gt;&gt;|{1391,27501,255280}]],[],[]}}},&lt;&lt;75,191,51,171,193,113,206,163,24,68,247,188,84,72,5,72,179,195,99,44,202,122,136,31,250,94,166,5,160,199,182,137,40,6,253,115,100,4,34,67,64,10,25,210,58,23,104,97,228,...&gt;&gt;}],...},...}"}
&gt;&gt;
&gt;&gt; I am wondering how else could I just get a list of keys in that
&gt;&gt; bucket. The ultimate goal is to be able to delete them all.
&gt;&gt;
&gt;&gt; Thank you in advance,
&gt;&gt; Istvan
&gt;&gt;
&gt;&gt; --
&gt;&gt; the sun shines for all
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt; --
&gt; Turning and turning in the widening gyre
&gt; The falcon cannot hear the falconer
&gt; Things fall apart; the center cannot hold
&gt; Mere anarchy is loosed upon the world



-- 
the sun shines for all

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

