---
title: "Re: RiakError: timeout"
description: ""
project: community
lastmod: 2014-03-17T23:51:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13829"
mailinglist_parent_id: "msg13817"
author_name: "Massimiliano Ciancio"
project_section: "mailinglistitem"
sent_date: 2014-03-17T23:51:29-07:00
---


I tried to raise each param in sysctl.con (now the configuration is a
bit strange with all that 9s :-)
But I still get many "RiakError: timeout" :(
Have you any suggestion, please?
Thanks in advance
Massimiliano

fs.file-max = 999999
vm.swappiness = 0
net.ipv4.tcp\_max\_syn\_backlog = 999999
net.core.somaxconn = 999999
net.ipv4.tcp\_timestamps = 0
net.ipv4.tcp\_sack = 1
net.ipv4.tcp\_window\_scaling = 1
net.ipv4.tcp\_fin\_timeout = 15
net.ipv4.tcp\_keepalive\_intvl = 30
net.ipv4.tcp\_tw\_reuse = 1
net.ipv4.tcp\_tw\_recycle = 1
vm.max\_map\_count = 32000000
net.core.rmem\_default = 8388608
net.core.rmem\_max = 8388608
net.core.wmem\_default = 8388608
net.core.wmem\_max = 8388608
net.core.netdev\_max\_backlog = 999999

2014-03-17 21:15 GMT+01:00 Michael Dillon :
&gt; On the server which is sending write requests to the Riak cluster, you may
&gt; have run into some network limits, possibly max sockets or one of the
&gt; network buffer settings. I would try to tune your kernel for a high level of
&gt; network traffic and try again. Or just split your load across more than one
&gt; server.
&gt;
&gt; If you are going to have very high loads of requests going to a Riak cluster
&gt; it is a good idea to put a load balancer in front of it so that you spread
&gt; the requests across nodes in the cluster. Riak's clustering only distributes
&gt; work AFTER Riak receives the requests. If you sent all your Riak requests to
&gt; just one member of the cluster, then you can potentially create an incoming
&gt; network bottleneck on that server.
&gt;
&gt;
&gt;
&gt; On Mon, Mar 17, 2014 at 11:34 AM, Massimiliano Ciancio
&gt;  wrote:
&gt;&gt;
&gt;&gt; Hi list,
&gt;&gt; I'm in troubles...
&gt;&gt; I'm getting many timeout errors from Riak (see traceback at end of mail).
&gt;&gt; I'm using a 5 node Debian cluster. Riak version is 1.4.8. Riak Python
&gt;&gt; client is installed with 'pip install riak' and is up to date.
&gt;&gt; The errors come from different processes on the same machine trying to
&gt;&gt; write intensively on Riak, using each one their own connection.
&gt;&gt; The errors start after some time the processes are running.
&gt;&gt; What can I check?
&gt;&gt; Thanks in advance
&gt;&gt; Massimiliano
&gt;&gt;
&gt;&gt;
&gt;&gt; Traceback (most recent call last):
&gt;&gt; ...
&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/bucket.py", line
&gt;&gt; 206, in get
&gt;&gt; return obj.reload(r=r, pr=pr, timeout=timeout)
&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/riak\_object.py",
&gt;&gt; line 307, in reload
&gt;&gt; self.client.get(self, r=r, pr=pr, timeout=timeout)
&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/client/transport.py",
&gt;&gt; line 127, in wrapper
&gt;&gt; return self.\_with\_retries(pool, thunk)
&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/client/transport.py",
&gt;&gt; line 69, in \_with\_retries
&gt;&gt; return fn(transport)
&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/client/transport.py",
&gt;&gt; line 125, in thunk
&gt;&gt; return fn(self, transport, \*args, \*\*kwargs)
&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/client/operations.py",
&gt;&gt; line 333, in get
&gt;&gt; return transport.get(robj, r=r, pr=pr, timeout=timeout)
&gt;&gt; File
&gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/transports/pbc/transport.py",
&gt;&gt; line 146, in get
&gt;&gt; MSG\_CODE\_GET\_RESP)
&gt;&gt; File
&gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/transports/pbc/connection.py",
&gt;&gt; line 43, in \_request
&gt;&gt; return self.\_recv\_msg(expect)
&gt;&gt; File
&gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/transports/pbc/connection.py",
&gt;&gt; line 55, in \_recv\_msg
&gt;&gt; raise RiakError(err.errmsg)
&gt;&gt; RiakError: 'timeout'
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; PageFreezer.com
&gt; #200 - 311 Water Street
&gt; Vancouver, BC V6B 1B8

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

