---
title: "Re: Performance of link walking versus map/reduce"
description: ""
project: community
lastmod: 2012-02-03T11:10:00-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06534"
mailinglist_parent_id: "msg06533"
author_name: "Bryan Fink"
project_section: "mailinglistitem"
sent_date: 2012-02-03T11:10:00-08:00
---


On Fri, Feb 3, 2012 at 12:31 PM, Nicolas Petton
 wrote:
&gt; curl
&gt; http://localhost:8098/buckets/artists/keys/pink\_floyd/albums,author,\_
&gt; was nearly immediate, it took 0.156s
&gt;
&gt; while:
&gt;
&gt; curl -X POST -H "content-type:application/json" \
&gt; Â http://localhost:8098/mapred --data @-
&gt; {"inputs":[["artists","pink\_floyd"]],"query":[{"link":{"bucket":"albums","tag":"author"}},{"map":{"language":"javascript","source":"function(v)
&gt; { return [v]; }"}}]}
&gt;
&gt; Took nearly 2 seconds.

The biggest difference I see is that the link-walk uses an Erlang
function where your MapReduce query uses a Javascript function
(link-walking is implemented as a MapReduce query internally).
Serializing/deserializing to JSON as well as contention for Javascript
VMs likely accounts for the lost time.

Unfortunately, you can't use exactly the same Erlang function here
(riak\_kv\_mapreduce:map\_identity), since the /mapred resource doesn't
know how to encode its output to JSON.

-Bryan

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

