---
title: "Re: Slow bucket create/delete in Riak CS"
description: ""
project: community
lastmod: 2014-08-18T08:06:52-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14693"
mailinglist_parent_id: "msg14655"
author_name: "David Whittington"
project_section: "mailinglistitem"
sent_date: 2014-08-18T08:06:52-07:00
---


Ah, yeah, that was it. I thought GC had already run, but it hadn't. After
GC it went back to normal. Thanks!


On Thu, Aug 14, 2014 at 10:54 PM, Kota Uenishi  wrote:

&gt; David,
&gt;
&gt; I'm sure your version of Riak CS is 1.5.0. At 1.5.0 we fixed bug #475
&gt; by traversing whole bucket in creation and deletion [1]. This traverse
&gt; reads all objects in the bucket, even if it is already deleted.
&gt; Deleted objects remains physically for a while - (called leeway
&gt; seconds) - with it's manifests. Checking bucket before deletion or
&gt; creation reads manifests in a scheduled\_delete state. That's why it's
&gt; slow. If you wait for leeway seconds and make sure GC cleaned up all
&gt; of them, bucket creation or deletion will be as fast as before
&gt; creating many objects.
&gt;
&gt; [2] is a little bit deeper description of how object chunking and
&gt; garbage collection work, for further reading.
&gt;
&gt; [1]
&gt; https://github.com/basho/riak\_cs/blob/release/1.5/RELEASE-NOTES.md#incomplete-multipart-uploads
&gt; [2]
&gt; https://github.com/basho/riak\_cs/wiki/Object-Chunking-and-Garbage-Collection
&gt;
&gt; On Fri, Aug 15, 2014 at 5:12 AM, David Whittington 
&gt; wrote:
&gt; &gt; In testing Riak CS I've noticed that buckets that have had a lot of
&gt; object
&gt; &gt; updates take a while to delete even if they're empty at the time of
&gt; &gt; deletion. Also, after deletion, creating a new bucket with the same name
&gt; &gt; takes a similar amount of time. This effect seems to persist
&gt; indefinitely.
&gt; &gt;
&gt; &gt; Here's an example: https://gist.github.com/djwhitt/9480a1adb52a4b87d246
&gt; &gt;
&gt; &gt; While this isn't a huge problem since the operation ultimately succeeds
&gt; and
&gt; &gt; it doesn't need to be super fast for my use case, it does make me
&gt; curious.
&gt; &gt; What is going on here? Is something not getting cleaned up properly?
&gt; Anyone
&gt; &gt; else experiencing anything like this?
&gt; &gt;
&gt; &gt; --
&gt; &gt; David Whittington
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Kota UENISHI / @kuenishi
&gt; Basho Japan KK
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

