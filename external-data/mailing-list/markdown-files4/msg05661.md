---
title: "Re: Distributed reduce phases via pre-reduce [Was \"Secondary Indexes	- Feedback?\"]"
description: ""
project: community
lastmod: 2011-11-18T08:36:10-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05661"
mailinglist_parent_id: "msg05660"
author_name: "Gordon Tillman"
project_section: "mailinglistitem"
sent_date: 2011-11-18T08:36:10-08:00
---


Bryan thanks very much for the info. I am going to investigate this over the 
weekend. What I am trying to achieve is the ability to sort a potentially very 
large dataset in the most efficient way possible.

Regards,

--g



On Nov 18, 2011, at 10:12 , Bryan Fink wrote:

&gt; On Thu, Nov 17, 2011 at 9:45 AM, Gordon Tillman  wrote:
&gt;&gt; I'm really interested in being able to implement distributed
&gt;&gt; reduce phases (specifically to do a partial sort) and then have that output
&gt;&gt; handle by a final reduce phase that could perform an efficient merge sort
&gt;&gt; and stream results back to the client. That would be really cool!
&gt; 
&gt; Hi, Gordon. I just caught up on the 2i thread, and noticed your
&gt; comment at the end. As of 1.0 and RiakPipe-based MapReduce, you are
&gt; able to do something like this with the "pre-reduce" tuning
&gt; functionality:
&gt; 
&gt; http://wiki.basho.com/MapReduce.html#Pre-Reduce
&gt; 
&gt; With pre-reduce enabled, your reduce function is run in two stages.
&gt; The first stage processes the outputs of the previous map stage in
&gt; parallel, on the vnode where each output was produced. The second
&gt; stage is reduce as you know it, processing all of the results of that
&gt; pre-reduce stage in one place.
&gt; 
&gt; For example, if you had these vnodes producing these outputs:
&gt; 
&gt; A: 1,2,3
&gt; B: 4,5,6
&gt; C: 7,8,9
&gt; 
&gt; enabling pre-reduce would cause three parallel reduces:
&gt; 
&gt; x = reduce(1,2,3)
&gt; y = reduce(4,5,6)
&gt; z = reduce(7,8,9)
&gt; 
&gt; followed by a final all-together reduce of those results:
&gt; 
&gt; reduce(x,y,z)
&gt; 
&gt; So, it's the same function evaluated in both stages, but if you've
&gt; written it to play well with re-reduce, it should "just work".
&gt; 
&gt; Hope that helps,
&gt; Bryan


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

