---
title: "Re: Limit the number of results for a query"
description: ""
project: community
lastmod: 2010-08-13T05:37:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00880"
mailinglist_parent_id: "msg00878"
author_name: "Kevin Smith"
project_section: "mailinglistitem"
sent_date: 2010-08-13T05:37:44-07:00
---


Felix - 

You can adjust the timeout for a map/reduce job in the JSON job descriptor. 
This might fix the problem you're experiencing since it looks like Riak is 
stopping the job because the job ran out of time. The default timeout is 60 
seconds and is actually specified in milliseconds. You can adjust the timeout 
like so:

{ "inputs": "some\_bucket",
 "timeout": 90000,
 "query": ... }

--Kevin
On Aug 13, 2010, at 8:27 AM, Felix Ritter wrote:

&gt; Hello,
&gt; 
&gt; I'm currently testing RIAK (on Mac OS X) and it looks really promising.
&gt; Currently I'm looking for a good way to implement something like
&gt; 'LIMIT 10, 100' to retrieve 10 results starting at offset 100.
&gt; Most web applications have some sort of paging implemented for bigger
&gt; lists, and I'm interested to hear what's the best way to implement it
&gt; with RIAK.
&gt; Any ideas are really appreciated.
&gt; 
&gt; And I have one data loss issue:
&gt; for testing I created one bucket with 10.000 JSON-Objects (really
&gt; small and simple objects) and run some MapReduce jobs.
&gt; Everything worked as expected.
&gt; Then I created another 90.000 Objects in the same bucket.
&gt; The first query after the data creation just returned a strange
&gt; 'bucket not found' message, all following queries are now returning an
&gt; empty result list.
&gt; In the sasl-error.log file I found a message that points to a timeout problem:
&gt; 
&gt; =SUPERVISOR REPORT==== 13-Aug-2010::14:14:49 ===
&gt; Supervisor: {local,luke\_phase\_sup}
&gt; Context: child\_terminated
&gt; Reason: flow\_timeout
&gt; Offender: [{pid,&lt;0.12957.21&gt;},
&gt; {name,undefined},
&gt; {mfa,
&gt; {luke\_phase,start\_link,
&gt; [riak\_kv\_map\_phase,0,
&gt; [accumulate],
&gt; [&lt;0.12956.21&gt;,&lt;0.12955.21&gt;],
&gt; &lt;0.12954.21&gt;,66000,
&gt; [{javascript,
&gt; {map,
&gt; {jsanon,
&gt; &lt;&lt;"function (value,keydata,arg) {
&gt; ejsLog('/riakcluster/mapred.log', JSON.stringify(arg)); var website =
&gt; Riak.mapValuesJson(value)[0]; if (website.name.indexOf('12345')&gt;=0)
&gt; return [website]; else return []; }"&gt;&gt;},
&gt; none,true}}]]}},
&gt; {restart\_type,temporary},
&gt; {shutdown,brutal\_kill},
&gt; {child\_type,worker}]
&gt; 
&gt; Any idea? Are there any known limitations regarding the maximum bucket size?
&gt; 
&gt; Thanks,
&gt; Felix
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

