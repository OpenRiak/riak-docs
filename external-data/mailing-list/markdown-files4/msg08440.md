---
title: "Re: LevelDB memory problem crashes Erlang"
description: ""
project: community
lastmod: 2012-09-03T11:30:39-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08440"
mailinglist_parent_id: "msg08278"
author_name: "leonickel"
project_section: "mailinglistitem"
sent_date: 2012-09-03T11:30:39-07:00
---


Hello guys, i've put this issue on hold and now i'm back on it. I tried to
increase memory for riak user in limits.conf but still getting the same
problem. I start my riak node and begin storing some data when at a certain
of time (proccess "/usr/lib/riak/erts-5.9.1/bin/beam.smp" with 500mb
approximately) erlang crashes and system goes down. A few seconds before
system crashes i've got this bevahior on "riak-admin top":

========================================================================================
 'riak@127.0.0.1' 
18:02:20
 Load: cpu 154 Memory: total 25213 binary 
1463
 procs 1435 processes 5795 code 
5249
 runq 0 atom 338 ets 
9556

Pid Name or Initial Func Time Reds Memory MsgQ Current
Function
----------------------------------------------------------------------------------------
&lt;6086.103.0&gt; application\_master:s '-' 0 300524 0
application\_master:l
&lt;6086.43.0&gt; release\_handler '-' 0 115092 0
gen\_server:loop/6 
&lt;6086.150.0&gt; riak\_core\_vnode\_prox '-' 0 73868 0
gen\_server:loop/6 
&lt;6086.32.0&gt; erlang:apply/2 '-' 0 71348 0
shell:get\_command1/5
&lt;6086.153.0&gt; riak\_core\_vnode\_mana '-' 16861 49368 0
gen\_server:loop/6 
&lt;6086.69.0&gt; memsup '-' 0 44268 0
gen\_server:loop/6 
&lt;6086.30485.4&gt; proc\_lib:init\_p/5 '-' 3335631 44268 0
mochiweb\_http:reques
&lt;6086.25.0&gt; code\_server '-' 0 44248 0
code\_server:loop/1 
&lt;6086.3.0&gt; erl\_prim\_loader '-' 0 44208 0
erl\_prim\_loader:loop
&lt;6086.7.0&gt; application\_controll '-' 0 27964 0
gen\_server:loop/6 
========================================================================================

Output server crashed: noconnection

On "riak-admin status" command my system seems to be healthy:

(...)
mem\_total : 4081463296
mem\_allocated : 3447291904
disk : [{"/",144185016,76},
 {"/dev",1986272,1},
 {"/dev/shm",1992900,1},
 {"/var/run",1992900,1},
 {"/var/lock",1992900,0},
 {"/home",288370316,97}]
nodename : 'riak@127.0.0.1'
connected\_nodes : []
sys\_driver\_version : &lt;&lt;"2.0"&gt;&gt;
sys\_global\_heaps\_size : 0
sys\_heap\_type : private
sys\_logical\_processors : 4
sys\_otp\_release : &lt;&lt;"R15B01"&gt;&gt;
sys\_process\_count : 1391
sys\_smp\_support : true
sys\_system\_version : &lt;&lt;"Erlang R15B01 (erts-5.9.1) [source] [smp:4:4]
[async-threads:64] [kernel-poll:true]"&gt;&gt;
sys\_system\_architecture : &lt;&lt;"i686-pc-linux-gnu"&gt;&gt;
sys\_threads\_enabled : true
sys\_thread\_pool\_size : 64
sys\_wordsize : 4
ring\_members : ['riak@127.0.0.1']
ring\_num\_partitions : 64
ring\_ownership : &lt;&lt;"[{'riak@127.0.0.1',64}]"&gt;&gt;
ring\_creation\_size : 64
storage\_backend : riak\_kv\_eleveldb\_backend
riak\_api\_version : &lt;&lt;"1.2.0"&gt;&gt;
(...)

I'm running a single riak node with "n\_val=1", "allow\_mult=false" and
"last\_write\_wins=true".
Is there any erlang configuration that I am missing ou doing wrong?

Thanks for the help!

Leo




--
View this message in context: 
http://riak-users.197444.n3.nabble.com/LevelDB-memory-problem-crashes-Erlang-tp4024974p4025155.html
Sent from the Riak Users mailing list archive at Nabble.com.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

