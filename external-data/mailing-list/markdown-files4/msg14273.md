---
title: "Re: how to change bucket property when node is down"
description: ""
project: community
lastmod: 2014-05-28T08:15:51-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14273"
mailinglist_parent_id: "msg14271"
author_name: "Jordan West"
project_section: "mailinglistitem"
sent_date: 2014-05-28T08:15:51-07:00
---


Gavin,

Riak stores bucket properties separately from key/values, along with other
metadata about the cluster. Where these files live depend on your platform
and configuration. By default, there will be a directory named "ring" in
the same directory that contains either the "bitcask" or "leveldb" data
directories depending on the backend you chose -- this also assumes you
haven't change the location of these directories in the config.

Jordan


On Wed, May 28, 2014 at 3:10 AM, Gavin Huang  wrote:

&gt; I'd like to ask another question about where do riak save bucket property
&gt; in disk space.
&gt; is it different from key/values?
&gt;
&gt; Thanks.
&gt; Gavin
&gt;
&gt;
&gt;
&gt; On Wed, May 28, 2014 at 11:15 AM, Gavin Huang wrote:
&gt;
&gt;&gt; Thanks Jordan, I've tried the first option and it works for me.
&gt;&gt; thanks again for all your help.
&gt;&gt;
&gt;&gt; Gavin
&gt;&gt;
&gt;&gt;
&gt;&gt; On Wed, May 28, 2014 at 2:36 AM, Jordan West  wrote:
&gt;&gt;
&gt;&gt;&gt; Gavin,
&gt;&gt;&gt;
&gt;&gt;&gt; Are you able to stop all other traffic to Riak? Testing locally, the
&gt;&gt;&gt; crashes only start occurring once the first request to a key in the
&gt;&gt;&gt; mis-configured bucket is issued after restarting. Using curl I am able to
&gt;&gt;&gt; change the property back to 3, as an integer, as long as no keys are
&gt;&gt;&gt; requested in that bucket after restarting isn't made.
&gt;&gt;&gt;
&gt;&gt;&gt; Otherwise, if you can keep Riak running long enough, executing the
&gt;&gt;&gt; following from `riak attach` should have the same end result:
&gt;&gt;&gt;
&gt;&gt;&gt; riak\_core\_bucket:set\_bucket(&lt;&lt;"b"&gt;&gt;, lists:keystore(n\_val, 1,
&gt;&gt;&gt; riak\_core\_bucket:get\_bucket(&lt;&lt;"b"&gt;&gt;), {n\_val, 3})).
&gt;&gt;&gt;
&gt;&gt;&gt; A third option, I haven't tried, is to temporarily disable active
&gt;&gt;&gt; anti-entropy (the subsystem where the error seems to be coming from), until
&gt;&gt;&gt; you've had a chance to make the fix.
&gt;&gt;&gt;
&gt;&gt;&gt; Jordan
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Fri, May 23, 2014 at 9:47 PM, Gavin Huang wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi, Alexander
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks for your reply. the problem I have is riak is down and can not
&gt;&gt;&gt;&gt; server any requests.
&gt;&gt;&gt;&gt; I'd like to see if there a solution to "repair" bucket, if the bucket
&gt;&gt;&gt;&gt; properties are stored in a file in some where.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks.
&gt;&gt;&gt;&gt; Gavin
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Sat, May 24, 2014 at 1:52 AM, agrytsenko &lt;
&gt;&gt;&gt;&gt; alexander.grytse...@dev-pro.net&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; just use curl to set the correct value, e.g.:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; &gt; curl -v -XPUT http://127.0.0.1:8098/buckets/test/props -H
&gt;&gt;&gt;&gt;&gt; "Content-Type:
&gt;&gt;&gt;&gt;&gt; &gt; application/json" -d '{"props":{"n\_val":3}}'
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; more about bucket properties:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; http://docs.basho.com/riak/latest/dev/references/http/set-bucket-props/#Request
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt; View this message in context:
&gt;&gt;&gt;&gt;&gt; http://riak-users.197444.n3.nabble.com/how-to-change-bucket-property-when-node-is-down-tp4031160p4031161.html
&gt;&gt;&gt;&gt;&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

