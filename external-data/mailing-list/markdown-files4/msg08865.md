---
title: "Re: Riak JAVA Client Performance"
description: ""
project: community
lastmod: 2012-10-10T05:14:07-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08865"
mailinglist_parent_id: "msg08864"
author_name: "Guido Medina"
project_section: "mailinglistitem"
sent_date: 2012-10-10T05:14:07-07:00
---



That question has been answered few times, here is my old answer:

Hi,

 It is the Java client which to be honest, doesn't handle well one node
going down, so, for example, in my company we use HA proxy for that, here is
a starting configuration:https://gist.github.com/1507077

 Once we switched to HA proxy we just use a simple client without cluster
config, so the Java client doesn't know anything about the load balancing
going on. It works well, I can upgrade and restart servers without our Java
application be complaining.

Regards,

Guido.


On 10/10/12 12:58, Pavel Kogan wrote:

Thanks,

I will try this solution.

Pavel

On Wed, Oct 10, 2012 at 1:51 PM, kamiseq &gt; wrote:


 well I asked same question few days ago (maybe 2 weeks form now) and
 the answer was that yes sharing client is thread safe and all you
 should do is to create new bucket instance on every request

 pozdrawiam
 Pawe? Kamin'ski

 kami...@gmail.com 
 pkaminski....@gmail.com 
 \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_


 On 10 October 2012 09:25, Pavel Kogan &gt; wrote:
 &gt; 1) Is it ok to share a single pbc client object between 50
 threads? Should
 &gt; it be protected by lock ?
 &gt; 2) I didn't do load balancing between nodes yet, cause I want to
 understand
 &gt; better throughput limit. I am planning to do it for much higher
 throughput.
 &gt;
 &gt; Pavel
 &gt;
 &gt;
 &gt; On Wed, Oct 10, 2012 at 9:21 AM, kamiseq &gt; wrote:
 &gt;&gt;
 &gt;&gt; maybe the good start is to share pbclient object and only create
 &gt;&gt; bucket per request, you will save few steps on client
 configuration.
 &gt;&gt; have you tried balancing requests to cluster and distribute
 them over all
 &gt;&gt; nodes?
 &gt;&gt;
 &gt;&gt; pozdrawiam
 &gt;&gt; Pawe? Kamin'ski
 &gt;&gt;
 &gt;&gt; kami...@gmail.com 
 &gt;&gt; pkaminski....@gmail.com 
 &gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
 &gt;&gt;
 &gt;&gt;
 &gt;&gt; On 10 October 2012 06:18, Pavel Kogan &gt; wrote:
 &gt;&gt; &gt; Hi all,
 &gt;&gt; &gt;
 &gt;&gt; &gt; I have Riak cluster consisting of 5 nodes that contains about 30
 &gt;&gt; &gt; millions of
 &gt;&gt; &gt; keys (35% of capacity according to Riak Control).
 &gt;&gt; &gt; Currently we have single JAVA client reading and writing
 records to same
 &gt;&gt; &gt; node. I need some tips, how to use the client efficiently
 &gt;&gt; &gt; to reach maximal throughput - I would like to be able to
 read/write up
 &gt;&gt; &gt; to
 &gt;&gt; &gt; 100 records/sec on 1Gbit network. Currently I get a lot
 &gt;&gt; &gt; of JAVA socket exceptions after a while (even for the much
 slower rate -
 &gt;&gt; &gt; 10
 &gt;&gt; &gt; records/sec), after which I need to restart client and node.
 &gt;&gt; &gt;
 &gt;&gt; &gt; Thanks,
 &gt;&gt; &gt; Pavel
 &gt;&gt; &gt;
 &gt;&gt; &gt; P.S: My client using 50 threads and pbc client is created and
 &gt;&gt; &gt; shut-downed
 &gt;&gt; &gt; per request.
 &gt;&gt; &gt;
 &gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
 &gt;&gt; &gt; riak-users mailing list
 &gt;&gt; &gt; riak-users@lists.basho.com 
 &gt;&gt; &gt;
 http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
 &gt;&gt; &gt;
 &gt;
 &gt;




\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

