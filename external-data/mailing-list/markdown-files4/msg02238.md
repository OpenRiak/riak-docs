---
title: "Re: Removing properties in Ripple"
description: ""
project: community
lastmod: 2011-02-08T17:21:37-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02238"
mailinglist_parent_id: "msg02234"
author_name: "Adam Hunter"
project_section: "mailinglistitem"
sent_date: 2011-02-08T17:21:37-08:00
---


I am really glad you brought this up because this has bitten me many
times. I don't know the original intent but it would be nice to have
some sort of deprecated\_property declaration that allows using the
data attributes and can possibly have options for migration, like
keep, delete, log or a proc that could transition it to a new
attribute. This sort if thing had been on my to do list for a while
but now that I have more free time I may just scratch it. I'd love to
get migration ideas from the community at large beforehand though.

Thanks,

Adam Hunter

Sent from my iPhone

On Feb 8, 2011, at 6:29 PM, Duff OMelia  wrote:

&gt; Hi all,
&gt; 
&gt; There's a test in ripple:
&gt; 
&gt; describe Ripple::Document::Finders do
&gt; it "should raise an exception when finding an existing document
&gt; that has properties we don't know about" do
&gt; @plain.raw\_data = '{"non\_existent\_property":"whatever"}'
&gt; lambda { Box.find("square") }.should raise\_error
&gt; end
&gt; end
&gt; 
&gt; 
&gt; I'd like to understand the motivation for that behavior.
&gt; Specifically, if we have data stored in Riak and we want to eliminate
&gt; one of the Ripple properties, what's the best way to do that? So for
&gt; example, if we had:
&gt; 
&gt; class Account
&gt; include Ripple::Document
&gt; 
&gt; property :email, String, :presence =&gt; true
&gt; property :feature\_level, String
&gt; 
&gt; end
&gt; 
&gt; 
&gt; And then we wanted to change the Account to look like this:
&gt; 
&gt; 
&gt; class Account
&gt; include Ripple::Document
&gt; 
&gt; property :email, String, :presence =&gt; true
&gt; 
&gt; end
&gt; 
&gt; such that it no longer has the feature\_level property, then we can't
&gt; find existing Accounts using Ripple because it'll raise an exception.
&gt; 
&gt; I was thinking I'd be able to find one of those old accounts,
&gt; potentially access the feature\_level using the attributes from
&gt; ActiveModel, potentially remove that feature level from the Riak
&gt; storage, etc. The fact that there's a test there verifying that
&gt; finding a document with unknown properties raises an exception makes
&gt; me think there's something I'm missing as far as renaming properties
&gt; or deleting old data goes.
&gt; 
&gt; Anyone have any insight to share?
&gt; 
&gt; 
&gt; Thanks!
&gt; 
&gt; 
&gt; ------------------------------------------------------------
&gt; Duff OMelia
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

