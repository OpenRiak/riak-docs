---
title: "Re: Using MapReduce with Counters"
description: ""
project: community
lastmod: 2013-08-02T14:13:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11873"
mailinglist_parent_id: "msg11872"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2013-08-02T14:13:40-07:00
---



On 2 Aug 2013, at 16:56, João Machado  wrote:

&gt; Hi Sean,
&gt; 
&gt; Thanks for your quick response. If I follow the steps from Sam, it works as 
&gt; expected. I tried the same steps but with my own bucket (and data) and it 
&gt; worked too. The difference between what I was trying and what Sam did was 
&gt; because I used JavaScript and Sam Erlang.
&gt; 
&gt; Is there any trick to use Javascript?
Hi João,

Not right now, sorry, the internal representation is a binary format stored in 
a regular riak\_object, that requires the riak\_kv\_counter module to decode.

Russell

&gt; 
&gt; 
&gt; []'s
&gt; 
&gt; 
&gt; 
&gt; João Machado
&gt; joao.mach...@ideais.com.br
&gt; Tel.: 55 21 3553 1301 R: 215
&gt; Cel.: 55 21 8124 3531
&gt; Site: www.ideais.com.br
&gt; 
&gt; 
&gt; On Fri, Aug 2, 2013 at 5:09 PM, Sean Cribbs  wrote:
&gt; Hi João,
&gt; 
&gt; You might want to try the steps shown in Sam Elliott's "cookbook": 
&gt; https://github.com/basho/riak\_crdt\_cookbook/blob/master/counters/README.md
&gt; 
&gt; 
&gt; On Fri, Aug 2, 2013 at 2:56 PM, João Machado  
&gt; wrote:
&gt; Hello,
&gt; 
&gt; Anyone tried to use MR with counters?
&gt; 
&gt; I'm trying with the following steps:
&gt; 
&gt; Increment the counter:
&gt; -&gt; curl -X POST http://localhost:8098/buckets/BUCKET/counters/MY\_COUNTER -d 1
&gt; 
&gt; Confirm the actual value:
&gt; -&gt; curl http://localhost:8098/buckets/BUCKET/counters/MY\_COUNTER 
&gt; 1
&gt; 
&gt; Execute mapreduce:
&gt; -&gt; curl -X POST -H "content-type: application/json" 
&gt; http://127.0.0.1:8098/mapred -d @map\_red.js
&gt; {"error":"bad\_utf8\_character\_code"}
&gt; 
&gt; Where the map\_red.js is:
&gt; 
&gt; {
&gt; "inputs":"BUCKET",
&gt; "query":[
&gt; {"map":{"language":"javascript","name":"Riak.mapValues"}}
&gt; ,{"reduce":{"language":"javascript","name":"Riak.reduceSum"}}
&gt; 
&gt; ]
&gt; }
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; []'s
&gt; 
&gt; 
&gt; 
&gt; João Machado
&gt; joao.mach...@ideais.com.br
&gt; Tel.: 55 21 3553 1301 R: 215
&gt; Cel.: 55 21 8124 3531
&gt; Site: www.ideais.com.br
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Sean Cribbs 
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

