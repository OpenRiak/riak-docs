---
title: "Re: issue creating a custom index/schema"
description: ""
project: community
lastmod: 2016-05-09T10:29:50-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17318"
mailinglist_parent_id: "msg17317"
author_name: "Alex De la rosa"
project_section: "mailinglistitem"
sent_date: 2016-05-09T10:29:50-07:00
---


Ok, definitely I won't need that spatialContextFactory:

Solr supports polygons via JTS Topology Suite, which does not come with
Solr. It's a JAR file that you need to put on Solr's classpath (but not via
the standard solrconfig.xml mechanisms). If you intend to use those shapes,
set this attribute to
org.locationtech.spatial4j.context.jts.JtsSpatialContextFactory. (note:
prior to Solr 6, the "org.locationtech.spatial4j" part was
"com.spatial4j.core").

So I believe I can go on with your snippet. Thanks!
Alex

On Mon, May 9, 2016 at 9:26 PM, Alex De la rosa 
wrote:

&gt; Thank Jorge,
&gt;
&gt; I was reading the documentation of Solr and seems they changed the
&gt; spatialContextFactory in their latest version:
&gt;
&gt;
&gt; https://cwiki.apache.org/confluence/display/solr/Spatial+Search#SpatialSearch-SpatialRecursivePrefixTreeFieldType(abbreviatedasRPT)
&gt;
&gt; This should work according to new documentation:
&gt;
&gt;  class="solr.SpatialRecursivePrefixTreeFieldType"
&gt; spatialContextFactory="org.locationtech.spatial4j.context.jts.JtsSpatialContextFactory"
&gt; distErrPct="0.025" maxDistErr="0.000009" units="degrees" /&gt;
&gt;
&gt; Although maybe is not needed to add the spatialContentFactory as per your
&gt; example...
&gt;
&gt; Thanks,
&gt; Alex
&gt;
&gt; On Mon, May 9, 2016 at 9:23 PM, Jorge Garrido gomez &lt;
&gt; jorge.garr...@hovanetworks.com&gt; wrote:
&gt;
&gt;&gt; Hello Alex,
&gt;&gt;
&gt;&gt; We solved the issue using the Spatial:
&gt;&gt;
&gt;&gt; &gt; class="solr.SpatialRecursivePrefixTreeFieldType"
&gt;&gt; distErrPct="0.025"
&gt;&gt; maxDistErr="0.000009"
&gt;&gt; units="degrees"
&gt;&gt; /&gt;
&gt;&gt;
&gt;&gt; We use that definition for the field and works perfectly, I hope this can be 
&gt;&gt; helpful, if you want more info maybe we can help you
&gt;&gt;
&gt;&gt;
&gt;&gt; Thank you! :-)
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On May 9, 2016, at 12:06 PM, Alex De la rosa 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt; Ok, i solved the issues for the datatypes "int", "string", but still
&gt;&gt; getting errors for the "location\_rpt":
&gt;&gt;
&gt;&gt; &gt; class="solr.SpatialRecursivePrefixTreeFieldType"
&gt;&gt; spatialContextFactory="com.spatial4j.core.context.jts.JtsSpatialContextFactory"
&gt;&gt; distErrPct="0.025" maxDistErr="0.000009" units="degrees" /&gt;
&gt;&gt;
&gt;&gt; 2016-05-09 19:03:56.798 [error] &lt;0.588.0&gt;@yz\_index:core\_create:287
&gt;&gt; Couldn't create index leaders\_b:
&gt;&gt; {ok,"500",[{"Content-Type","text/html;charset=ISO-8859-1"},{"Cache-Control","must-revalidate,no-cache,no-store"},{"Content-Length","11214"}],&lt;&lt;"\n\n&gt; http-equiv=\"Content-Type\" content=\"text/html;
&gt;&gt; charset=ISO-8859-1\"/&gt;\nError 500
&gt;&gt; {msg=com/vividsolutions/jts/geom/CoordinateSequenceFactory,trace=java.lang.NoClassDefFoundError:
&gt;&gt; com/vividsolutions/jts/geom/CoordinateSequenceFactory\n\tat
&gt;&gt; java.lang.Class.getDeclaredConstructors0(Native Method)\n\tat
&gt;&gt; java.lang.Class.privateGetDeclaredConstructors(Class.java:2595)\n\tat
&gt;&gt; java.lang.Class.getConstructor0(Class.java:2895)\n\tat
&gt;&gt; java.lang.Class.newInstance(Class.java:354)\n\tat
&gt;&gt; com.spatial4j.core.context.SpatialContextFactory.makeSpatialContext(SpatialContextFactory.java:96)\n\tat
&gt;&gt; org.apache.solr.schema.AbstractSpatialFieldType.init(AbstractSpatialFieldType.java:107)\n\tat
&gt;&gt; org.apache.solr.schema.AbstractSpatialPrefixTreeFieldType.init(AbstractSpatialPrefixTreeFieldType.java:43)\n\tat
&gt;&gt; org.apache.solr.schema.SpatialRecursivePrefixTreeFieldType.init(SpatialRecursivePrefixTreeFieldType.java:37)\n\tat
&gt;&gt; org.apache.solr.schema.FieldType.setArgs(FieldType.java:165)\n\tat
&gt;&gt; org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:141)\n\tat
&gt;&gt; org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:43)\n\tat
&gt;&gt; org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:190)\n\tat
&gt;&gt; org.apache.solr.schema.IndexSchema.readSchema(IndexSchema.java:468)\n\tat
&gt;&gt; org.apache.solr.schema.IndexSchema.&lt;init&gt;(IndexSchema.java:166)\n\tat
&gt;&gt; org.apache.solr.schema.IndexSchemaFactory.create(IndexSchemaFactory.java:55)\n\tat
&gt;&gt; org.apache.solr.schema.IndexSchemaFactory.buildIndexSchema(IndexSchemaFactory.java:69)\n\tat
&gt;&gt; org.apache.solr.core.CoreContainer.createFromLocal(CoreContainer.java:559)\n\tat
&gt;&gt; org.apache.solr.core.CoreContainer.create(CoreContainer.java:597)\n\tat
&gt;&gt; org.apache.solr.handler.admin.CoreAdminHandler.handleCreateAction(CoreAdminHandler.java:509)\n\tat
&gt;&gt; org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:152)\n\tat
&gt;&gt; org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)\n\tat
&gt;&gt; org.apache.solr.servlet.SolrDispatchFilter.handleAdminRequest(SolrDispatchFilter.java:732)\n\tat
&gt;&gt; org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:268)\n\tat
&gt;&gt; org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:217)\n\tat
&gt;&gt; org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)\n\tat
&gt;&gt; org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)\n\tat
&gt;&gt; org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n\tat
&gt;&gt; org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)\n\tat
&gt;&gt; org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n\tat
&gt;&gt; org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)\n\tat
&gt;&gt; org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)\n\tat
&gt;&gt; org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n\tat
&gt;&gt; org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)\n\tat
&gt;&gt; org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n\tat
&gt;&gt; org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\n\tat
&gt;&gt; org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\n\tat
&gt;&gt; org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n\tat
&gt;&gt; org.eclipse.jetty.server.Server.handle(Server.java:368)\n\tat
&gt;&gt; org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n\tat
&gt;&gt; org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)\n\tat
&gt;&gt; org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:942)\n\tat
&gt;&gt; org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:1004)\n\tat
&gt;&gt; org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.ja..."&gt;&gt;}
&gt;&gt; Anyone knows how to fix it?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Alex
&gt;&gt;
&gt;&gt; On Mon, May 9, 2016 at 8:50 PM, Alex De la rosa 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; i see... that part of the schema was written in another code block in
&gt;&gt;&gt; the documentation:
&gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt; positionIncrementGap="0"/&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; will try with that :) thanks
&gt;&gt;&gt;
&gt;&gt;&gt; Alex
&gt;&gt;&gt;
&gt;&gt;&gt; On Mon, May 9, 2016 at 8:48 PM, Vitaly &lt;13vitam...@gmail.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; You don't have this type under . The failure is about "int"
&gt;&gt;&gt;&gt; because it's the first one encountered in the list of fields.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Regards,
&gt;&gt;&gt;&gt; Vitaly
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Mon, May 9, 2016 at 7:16 PM, Alex De la rosa &lt;
&gt;&gt;&gt;&gt; alex.rosa....@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hi there,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I'm trying to create a custom index as seen at
&gt;&gt;&gt;&gt;&gt; http://docs.basho.com/riak/kv/2.1.4/developing/usage/search-schemas
&gt;&gt;&gt;&gt;&gt; and I'm getting the following errors in my log:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2016-05-09 18:08:05.229 [error] &lt;0.588.0&gt;@yz\_index:core\_create:287
&gt;&gt;&gt;&gt;&gt; Couldn't create index scores: {ok,"400",[{"Content-Type","application/xml;
&gt;&gt;&gt;&gt;&gt; charset=UTF-8"},{"Transfer-Encoding","chunked"}],&lt;&lt;"xml version=\"1.0\"
&gt;&gt;&gt;&gt; encoding=\"UTF-8\"?&gt;\n\n&gt;&gt;&gt;&gt; name=\"status\"&gt;40026&gt;&gt;&gt;&gt; name=\"error\"&gt;Error CREATEing SolrCore 'scores': 
&gt;&gt;&gt;&gt;&gt; \*Unable
&gt;&gt;&gt;&gt;&gt; to create core: scores Caused by: Unknown fieldType 'int' specified on
&gt;&gt;&gt;&gt;&gt; field points\*&gt;&gt;&gt;&gt; name=\"code\"&gt;400\n\n"&gt;&gt;}
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2016-05-09 18:08:43.096 [error] &lt;0.9673.1&gt;@yz\_index:sync\_index:464
&gt;&gt;&gt;&gt;&gt; Solr core error after trying to create index scores:
&gt;&gt;&gt;&gt;&gt; &lt;&lt;"org.apache.solr.common.SolrException:org.apache.solr.common.SolrException:
&gt;&gt;&gt;&gt;&gt; \*Unknown fieldType 'int' specified on field points\*. Schema file is
&gt;&gt;&gt;&gt;&gt; /var/lib/riak/yz/scores/./leaders.xml"&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; is saying the type "int" is unknown!! any ideas why? this is the
&gt;&gt;&gt;&gt;&gt; schema i'm uploading:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; xml version="1.0" encoding="UTF-8" ?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="true"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="true"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="true"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="true" multiValued="false" required="true"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="false" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="false" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="false" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="false" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="true" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="true" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="true" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="false" multiValued="false"/&gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \_yz\_id
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; class="solr.SpatialRecursivePrefixTreeFieldType"
&gt;&gt;&gt;&gt;&gt; spatialContextFactory="com.spatial4j.core.context.jts.JtsSpatialContextFactory"
&gt;&gt;&gt;&gt;&gt; distErrPct="0.025" maxDistErr="0.000009" units="degrees" /&gt;
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; multiValued="true" class="solr.StrField" /&gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; sortMissingLast="true" /&gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt; Alex
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

