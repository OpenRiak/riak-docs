---
title: "Re: Ripple and formbuilding in rails 3"
description: ""
project: community
lastmod: 2010-09-01T12:01:30-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01004"
mailinglist_parent_id: "msg01003"
author_name: "John Axel Eriksson"
project_section: "mailinglistitem"
sent_date: 2010-09-01T12:01:30-07:00
---


Yeah, I tried that earlier I think... did it again but I get the same error.

1 sep 2010 kl. 20.53 skrev Brian Kaney:

&gt; I think you want to use the :key as the identifier for the selection.
&gt; 
&gt; = f.collection\_select(:web\_server, WebServer.all, :key, :name)
&gt; 
&gt; 
&gt; --
&gt; Brian
&gt; 
&gt; 
&gt; 
&gt; On Sep 1, 2010, at 2:48 PM, John Axel Eriksson wrote:
&gt; 
&gt;&gt; I'm not exactly an expert on Rails but I've built a few simpler apps. Now
&gt;&gt; I'm working on an app using Ripple and I'm having a few issues, perhaps
&gt;&gt; I just haven't grasped riak/ripple yet...
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Anyway...
&gt;&gt; 
&gt;&gt; 
&gt;&gt; class Client
&gt;&gt; include Ripple::Document
&gt;&gt; 
&gt;&gt; timestamps!
&gt;&gt; 
&gt;&gt; property :name, String
&gt;&gt; property :hostname, String
&gt;&gt; property :url, String
&gt;&gt; property :blocked, Boolean
&gt;&gt; 
&gt;&gt; key\_on :hostname
&gt;&gt; 
&gt;&gt; one :web\_server
&gt;&gt; 
&gt;&gt; def id
&gt;&gt; hostname
&gt;&gt; end
&gt;&gt; 
&gt;&gt; 
&gt;&gt; end
&gt;&gt; 
&gt;&gt; 
&gt;&gt; class WebServer
&gt;&gt; include Ripple::Document
&gt;&gt; 
&gt;&gt; timestamps!
&gt;&gt; 
&gt;&gt; property :name, String
&gt;&gt; many :users
&gt;&gt; many :clients
&gt;&gt; 
&gt;&gt; key\_on :name
&gt;&gt; 
&gt;&gt; def id
&gt;&gt; name
&gt;&gt; end
&gt;&gt; 
&gt;&gt; end
&gt;&gt; 
&gt;&gt; in Rails console:
&gt;&gt; 
&gt;&gt; c = Client.new(:name =&gt; 'abc')
&gt;&gt; ws = WebServer.find('some.domain.name')
&gt;&gt; 
&gt;&gt; c.web\_server = ws
&gt;&gt; 
&gt;&gt; c.save
&gt;&gt; 
&gt;&gt; the above works just fine (and doing curl -i against the resources in riak 
&gt;&gt; shows the links too) but...
&gt;&gt; 
&gt;&gt; in a (haml) form I do:
&gt;&gt; 
&gt;&gt; .select
&gt;&gt; %label= f.label :web\_server
&gt;&gt; = f.collection\_select(:web\_server, WebServer.all, :id, :name)
&gt;&gt; 
&gt;&gt; but here I get an error when saving saying:
&gt;&gt; ArgumentError (Invalid value "some.domain.name" for association web\_server 
&gt;&gt; of type WebServer on &gt; UTC 2010 updated\_at=Wed Sep 01 17:38:13 UTC 2010 url="abc.somedomain.name" 
&gt;&gt; blocked=nil hostname="abc"&gt;):
&gt;&gt; app/controllers/clients\_controller.rb:63:in `update'
&gt;&gt; 
&gt;&gt; 
&gt;&gt; I ported the code over from a MongoDB-version of the app where these forms 
&gt;&gt; worked just fine. I'm having trouble seeing whats wrong with this, maybe I 
&gt;&gt; don't know rails
&gt;&gt; well enough...
&gt;&gt; 
&gt;&gt; Also, does ripple support accepts\_nested\_attributes\_for (afaict it doesn't)?
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

