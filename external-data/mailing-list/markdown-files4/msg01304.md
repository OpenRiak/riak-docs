---
title: "Re: Designing Your Buckets"
description: ""
project: community
lastmod: 2010-10-15T04:58:20-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01304"
mailinglist_parent_id: "msg01300"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2010-10-15T04:58:20-07:00
---


Based on my experience, you're on the right track.

In addition to your main 'entity' buckets, you'll want to create index
buckets that you use to speed lookups and create links back to the entity
buckets.

e.g. If you have a People bucket that is a nested record for a person with a
mailing address, you might want to create some kind of States bucket with
links to a ZipCodes bucket with further links to the People bucket. This way
you can do link traversal from a state -&gt; zip code -&gt; person.

To perform aggregations, you can use MapReduce. Using buckets and link
walking can make it very easy to perform operations that closely mimic index
seeks.

Someone correct me if I've gone completely off the deep end on this one :)

Jeremiah Peschka
Microsoft SQL Server MVP
MCITP: Database Developer, DBA
614.515.0727


On Fri, Oct 15, 2010 at 1:49 AM, Cagdas Tulek  wrote:

&gt; Hi,
&gt;
&gt; I'm a newbie to Riak (and riak like databases) and unfortunately I am a
&gt; long time RDB user. So, my mind is very biased but I try to think
&gt; differently and this will take some time.
&gt;
&gt; What I understand is that you try to avoid range queries and map/reduce
&gt; operations for live traffic. This part, I guess I understand better.
&gt;
&gt; However, one thing that I don't understand is the needs on admin side.
&gt; Although on frontend you can play smart to limit the objects that a user
&gt; should interact, on the admin side you usually want to list all records and
&gt; usually you want them to be sorted by id or creation time. These are also
&gt; true for your stats etc.
&gt;
&gt; How do you design your buckets in Riak to solve this problem? Or do you use
&gt; different approaches on admin side.
&gt;
&gt; One (maybe dirty) solution with my RDB biased mind is to have auxiliary
&gt; buckets to list items:
&gt; books/book1..n
&gt; lists/list1..n
&gt; where list-i is an array of x keys (where x is a small number like 10, 20).
&gt; This way we can have features like pagination. Same thing maybe for days:
&gt; days/20101014
&gt;
&gt; I try to find slides/documents about these topics but usually the
&gt; information I find is about dealing with individual items and their
&gt; relations, not a list of these items.
&gt;
&gt; I would appreciate any resources addressing these problems.
&gt;
&gt; Best,
&gt;
&gt; Cagdas
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

