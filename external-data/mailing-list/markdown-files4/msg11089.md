---
title: "Re: Receiving ulimit warning despite setting it"
description: ""
project: community
lastmod: 2013-05-15T22:39:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11089"
mailinglist_parent_id: "msg11088"
author_name: "Jared Morrow"
project_section: "mailinglistitem"
sent_date: 2013-05-15T22:39:44-07:00
---


I've considered packaging separate files for configuring the limit for people, 
but the user in me always felt like that was something the sysadmin should have 
a say in. I rather dislike packages that make system changes without my 
knowledge or consent. Maybe that is just me?

I do agree that the documentation should be updated. We do take PRs ;)

-Jared


On May 15, 2013, at 10:54 PM, Toby Corkindale 
 wrote:

&gt; On 16/05/13 14:39, Toby Corkindale wrote:
&gt;&gt; On 16/05/13 14:24, Jared Morrow wrote:
&gt;&gt;&gt; Well the riak-cs / riak / stanchion scripts all drop privileges using
&gt;&gt;&gt; sudo. On RHEL/Centos this sudo exec carries the settings from the
&gt;&gt;&gt; calling user (in the case of init.d, root) so things are fine there. On
&gt;&gt;&gt; Ubuntu/Debian that does not always work. So if you set the ulimit for
&gt;&gt;&gt; the root user, it might not propagate through to the riak-cs / riak /
&gt;&gt;&gt; stanchion users.
&gt;&gt;&gt; 
&gt;&gt;&gt; So to change that, you should try to change it in
&gt;&gt;&gt; /etc/security/limits.conf.
&gt;&gt; 
&gt;&gt; My understanding is that only sessions opened through PAM will be
&gt;&gt; effected by the limits.d/\* config files. ie. Not daemon processes.
&gt;&gt; (I've checked this anyway with the following
&gt;&gt; /etc/security/limits.d/riakcs.conf:
&gt;&gt; riak-cs hard nofile 32002
&gt;&gt; riak-cs soft nofile 32001
&gt;&gt; )
&gt;&gt; 
&gt;&gt; As noted previously, this problem was not occurring on the current
&gt;&gt; Ubuntu LTS nodes; just the Debian Squeeze ones. Which makes it
&gt;&gt; particularly odd.
&gt;&gt; 
&gt;&gt; Thanks for your help so far; I'll continue to investigate and report
&gt;&gt; back if I find a solution.
&gt; 
&gt; I realised that the Riak CS user was called "riakcs" and not "riak-cs".
&gt; Once I changed that in the limits.d/riakcs.conf file, riakcs started working 
&gt; without the file warning.
&gt; 
&gt; I also added in a line for the regular "riak" user while I was there.
&gt; 
&gt; May I suggest you add this to the debian/ubuntu packages by default?
&gt; (ie. a file in /etc/security/limits.d/ )
&gt; 
&gt; 
&gt; Cheers,
&gt; Toby
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

