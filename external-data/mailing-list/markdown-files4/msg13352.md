---
title: "Re: Anti-Entropy Sudden Exchange"
description: ""
project: community
lastmod: 2014-01-02T16:40:29-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13352"
mailinglist_parent_id: "msg13351"
author_name: "Justin Long"
project_section: "mailinglistitem"
sent_date: 2014-01-02T16:40:29-08:00
---


Ok here’s an update on the issue, I’m really hoping someone can chime in. I 
disabled Anti-Entropy, restarted Riak, and then tried to run a repair on 
indexes. After running the command [riak\_kv\_vnode:repair(P) || P &lt;- 
Partitions]. Riak then returned the error 

\*\* exception exit: {timeout,{gen\_server,call,
 
[{riak\_core\_vnode\_manager,'riak@192.168.3.2'},
 {repair,riak\_kv,
 
{riak\_kv\_vnode,22835963083295358096932575511191922182123945984},
 
{riak\_kv\_vnode,repair\_filter}}]}}
 in function gen\_server:call/2 (gen\_server.erl, line 180)

We then tried to use the Basho Riak Data Migrator tool to back up the most 
recent data on the node, but it takes 2 minutes to export a simple KV object 
(and these are less than 32kb in size). Thanks for your help.

FYI Using Riak 1.4.6



On Jan 2, 2014, at 11:31 AM, Justin Long  wrote:

&gt; Hi everyone,
&gt; 
&gt; Experiencing some weird behaviour in a cluster of 3 nodes. As of this 
&gt; morning, we noticed a massive performance lag and when checking the logs 
&gt; Active Anti-Entropy Exchange suddenly began initiating a huge series of 
&gt; transfers. Here’s what we see in the logs:
&gt; 
&gt; 2014-01-02 19:26:34.396 [info] 
&gt; &lt;0.1571.1800&gt;@riak\_kv\_exchange\_fsm:key\_exchange:206 Repaired 882 keys during 
&gt; active anti-entropy exchange of 
&gt; {228359630832953580969325755111919221821239459840,3} between 
&gt; {228359630832953580969325755111919221821239459840,'riak@192.168.3.2'} and 
&gt; {251195593916248939066258330623111144003363405824,'riak@192.168.3.3’}
&gt; 
&gt; When we check the logs on all 3 nodes we only had a few process crashes 10 
&gt; hours ago, nothing in between that time and now. It all came on suddenly. Any 
&gt; idea if this is normal and will fix itself or if we need to intervene?
&gt; 
&gt; Thanks!

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

