---
title: "Re: AAE disk usage"
description: ""
project: community
lastmod: 2014-05-20T09:33:38-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14247"
mailinglist_parent_id: "msg14246"
author_name: "Brian Sparrow"
project_section: "mailinglistitem"
sent_date: 2014-05-20T09:33:38-07:00
---


OK, the disk space used by AAE is a function of the number of keys rather than 
the size of the objects stored in Riak. Let us know the disk usage after the 
AAE trees are finished building. 

When nodes go down in a Riak cluster, the remaining nodes spin up fallback 
partitions to handle writes/reads for data the downed node owned. Since this 
node was down for a long time, the count of keys built up on these fallback 
partitions which would result in increased AAE disk usage.

We recommend using less than 75% of available disk space during normal cluster 
operation. This allows for growth when nodes go down.

Let us know what disk usage looks like after trees are built.

Thanks, 

-- 
Brian Sparrow
Developer Advocate
Basho Technologies

Sent with Sparrow (http://www.sparrowmailapp.com/?sig)


On Tuesday, May 20, 2014 at 12:17 PM, Ingo Rockel wrote:

&gt; Brian,
&gt; 
&gt; the used version is 1.4.2. No, not all aae-Trees are built. We had to 
&gt; free disk space on two nodes last weekend, these are currently building 
&gt; their tree. And I also saw missing parts on two other nodes. The others 
&gt; currently consume between 80GB and 110GB. The ones building their trees 
&gt; consume less.
&gt; 
&gt; Thanks,
&gt; 
&gt; Ingo
&gt; 
&gt; Am 20.05.2014 17:16, schrieb Brian Sparrow:
&gt; &gt; Ingo,
&gt; &gt; 
&gt; &gt; Sorry for the lack of response. What version of Riak are you using? At
&gt; &gt; this point, i assumee riak-admin aae\_status shows alls trees as built
&gt; &gt; across the cluster. How much space is the AAE directory currently using?
&gt; &gt; 
&gt; &gt; Thanks,
&gt; &gt; Brian
&gt; &gt; 
&gt; &gt; --
&gt; &gt; Brian Sparrow
&gt; &gt; Developer Advocate
&gt; &gt; Basho Technologies
&gt; &gt; 
&gt; &gt; Sent with Sparrow 
&gt; &gt; 
&gt; &gt; On Tuesday, May 20, 2014 at 10:55 AM, Ingo Rockel wrote:
&gt; &gt; 
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; 
&gt; &gt; &gt; sorry to bother again, can anyone shed a light on this issue?
&gt; &gt; &gt; 
&gt; &gt; &gt; Best,
&gt; &gt; &gt; 
&gt; &gt; &gt; Ingo
&gt; &gt; &gt; 
&gt; &gt; &gt; Am 12.05.2014 15:44, schrieb Ingo Rockel:
&gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; we had a little outage of our 12 node riak cluster yesterday, the first
&gt; &gt; &gt; &gt; so far, four nodes had gone down because of exhausted disk space.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; What happened: our backup crashed, leaving one node down. Because of a
&gt; &gt; &gt; &gt; misconfiguration in our monitoring, this node stayed down for 9 days. It
&gt; &gt; &gt; &gt; was then started and recovered after about 7 hours of running.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; But then the disk space usage on six of our nodes start to explode until
&gt; &gt; &gt; &gt; the disks were full on four of them. This seems to have been caused by
&gt; &gt; &gt; &gt; AAE. We have about 320GB of real user data stored in levelDB and
&gt; &gt; &gt; &gt; yesterday night AAE consumed about 150GB on each of this nodes. Is this
&gt; &gt; &gt; &gt; normal or what should I expect?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I deleted the "anti\_entropy" on these six nodes and started the nodes
&gt; &gt; &gt; &gt; again, running fine since then. AAE gets rebuild but at a lot of lower
&gt; &gt; &gt; &gt; level so far. I would be happy if someone could shed a light on this, I
&gt; &gt; &gt; &gt; didn't find anything helpful in the logs or the docs on
&gt; &gt; &gt; &gt; docs.basho.com 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Best,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Ingo
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; --
&gt; &gt; &gt; Software Architect
&gt; &gt; &gt; 
&gt; &gt; &gt; Blue Lion mobile GmbH
&gt; &gt; &gt; Tel. +49 (0) 221 788 797 14
&gt; &gt; &gt; Fax. +49 (0) 221 788 797 19
&gt; &gt; &gt; Mob. +49 (0) 176 24 87 30 89
&gt; &gt; &gt; 
&gt; &gt; &gt; ingo.roc...@bluelionmobile.com 
&gt; &gt; &gt; &gt; &gt; &gt; qeep: Hefferwolf
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; www.bluelionmobile.com 
&gt; &gt; &gt; www.qeep.net 
&gt; &gt; &gt; 
&gt; &gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com 
&gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Software Architect
&gt; 
&gt; Blue Lion mobile GmbH
&gt; Tel. +49 (0) 221 788 797 14
&gt; Fax. +49 (0) 221 788 797 19
&gt; Mob. +49 (0) 176 24 87 30 89
&gt; 
&gt; ingo.roc...@bluelionmobile.com (mailto:ingo.roc...@bluelionmobile.com)
&gt; &gt;&gt;&gt; qeep: Hefferwolf
&gt; 
&gt; www.bluelionmobile.com (http://www.bluelionmobile.com)
&gt; www.qeep.net (http://www.qeep.net)
&gt; 
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

