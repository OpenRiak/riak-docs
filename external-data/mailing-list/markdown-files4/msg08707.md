---
title: "Re: data modeling question"
description: ""
project: community
lastmod: 2012-09-26T10:36:17-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08707"
mailinglist_parent_id: "msg08696"
author_name: "Charlie Bowman"
project_section: "mailinglistitem"
sent_date: 2012-09-26T10:36:17-07:00
---


I think, I may copy the contents of each message in the PlayerMessage model
to avoid having another lookup. I'll choose higher storage capacity over
10 calls to load each individual message.


On Wed, Sep 26, 2012 at 2:51 AM, Rune Skou Larsen  wrote:

&gt; On 25-09-2012 23:18, Charlie Bowman wrote:
&gt;
&gt; Can I load 10 messages in 1 call? similar to a sql call "select \* from
&gt; messages where id in (1,2,3,4,5,6,7,8)"
&gt;
&gt; You can specify an array of keys as inputs to a MapReduce job.
&gt; http://wiki.basho.com/MapReduce-Implementation.html#Inputs
&gt; MR jobs can be slow - especially if they involve javascript. Link Walking
&gt; also fires up a MR job so it has some of the same performance penalties.
&gt;
&gt; Whether Link Walking/MR is faster than just getting all values
&gt; individually depends on a lot of things. To name some: Your network latency
&gt; between client and riak, how many values you get, how big they are, if you
&gt; are able to parallelize retrieval of the individual values.
&gt;
&gt; If you have 10ms latency between client and Riak and have to get 100
&gt; Messages sequentially, then my money is on LW/MR to be faster.
&gt; If you have &lt;1 ms latency, 10 messages and can get them in 1 + 10 parallel
&gt; calls, then I'm not so sure, which is fastest.
&gt;
&gt; It would be interesting with some performance tests!
&gt;
&gt; "If you need to read PlayerMessage and corresponding Messages in one go,
&gt; you can model the relation from PlayerMessage to Message with Riak Links,
&gt; and avoid a database roundtrip by using link walking."
&gt;&gt;
&gt;&gt; If I do this, would I need to keep a second array in the
&gt;&gt;&gt; PlayerMessage object to then also map which messages have been read?
&gt;&gt;&gt;
&gt;&gt; Link Walking doesn't care what's inside your JSON. Link walking is
&gt; based on metadata that you specify, when you PUT the Riak object.
&gt; Here is a good example on how you can specify the links using HTTP
&gt; headers, and walk them afterwards:
&gt; http://basho.com/blog/technical/2010/02/24/link-walking-by-example/
&gt;
&gt; As Links have "tags", you can add different link tags to Links for read
&gt; and unread messages. Then you could get unread messages using a link walk
&gt; like this:
&gt; curl http://localhost:8098/buckets/PlayerMessages/keys/
&gt; /Message,unread,1
&gt;
&gt; And all messages (read and unread):
&gt; curl http://localhost:8098/buckets/PlayerMessages/keys/
&gt; /Message,\_,1
&gt;
&gt;
&gt; - Rune
&gt;
&gt; Trifork
&gt;
&gt; --
&gt;
&gt; Best regards / Venlig hilsen
&gt; \*Rune Skou Larsen\*
&gt; Trifork Public A/S / Team Riak
&gt; Margrethepladsen 4, 8000 Ã…rhus C, Denmark
&gt; Phone: +45 3160 2497 Skype: runeskoularsen twitter: @RuneSkouLarsen
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

