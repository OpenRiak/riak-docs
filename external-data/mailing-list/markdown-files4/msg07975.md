---
title: "Re: riak doesn't start on new Macbook Pro Retina"
description: ""
project: community
lastmod: 2012-07-17T09:47:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07975"
mailinglist_parent_id: "msg07971"
author_name: "Mark Phillips"
project_section: "mailinglistitem"
sent_date: 2012-07-17T09:47:35-07:00
---


Update to pass along:

We're working on the fix for this - https://github.com/basho/riak\_api/pull/6

Thanks for the thorough reports.

Mark

PS - So how \*is\* the retina display anyway?

On Mon, Jul 16, 2012 at 6:48 PM, Shuhao Wu  wrote:

&gt; I'm also noticing an issue with starting riak. I too cannot start riak
&gt; regularly, but riak console works just fine.
&gt;
&gt; Checked all the permission, they seems to be okay.
&gt;
&gt; Shuhao
&gt;
&gt;
&gt; On Mon, Jul 16, 2012 at 3:20 PM, Steve Hull  wrote:
&gt; &gt; So one thing that seems bizarre is that riak has created directory
&gt; structure
&gt; &gt; under /tmp to mirror the directory structure from root to the binary
&gt; &gt; executable.
&gt; &gt;
&gt; &gt; For example, after I tried to start riak using the binary installed by
&gt; brew,
&gt; &gt; I noticed this directory structure that got added to /tmp:
&gt; &gt;
&gt; &gt; ! ls -alhrt /tmp/usr/local/Cellar/riak/1.1.2-x86\_64/libexec/
&gt; &gt; total 0
&gt; &gt; drwxr-xr-x 3 shull wheel 102B Jul 13 13:56 ../
&gt; &gt; drwxr-xr-x 2 shull wheel 68B Jul 13 14:24 ./
&gt; &gt;
&gt; &gt;
&gt; &gt; And similarly for the local pre-packaged version, it created:
&gt; &gt;
&gt; &gt; ! ls -alhrt /tmp/Users/shull/Dev/prodar/riak-1.1.4/
&gt; &gt; total 0
&gt; &gt; drwxr-xr-x 3 shull wheel 102B Jul 13 14:08 ../
&gt; &gt; drwxr-xr-x 4 shull wheel 136B Jul 16 11:56 ./
&gt; &gt; prw------- 1 shull wheel 0B Jul 16 11:57 erlang.pipe.1.w|
&gt; &gt; prw------- 1 shull wheel 0B Jul 16 11:57 erlang.pipe.1.r|
&gt; &gt;
&gt; &gt;
&gt; &gt; I guess there's nothing really \*wrong\* with that, it just kind of
&gt; worried me
&gt; &gt; at first to see that directory structure under /tmp.
&gt; &gt;
&gt; &gt; Anyway if I read your email correctly, you wanted me to try to start riak
&gt; &gt; and then after it reports failure, try to attach to it:
&gt; &gt;
&gt; &gt; [07-16 11:55] (master)~/Dev/prodar
&gt; &gt; ! riak-1.1.4/bin/riak start
&gt; &gt; Riak failed to start within 15 seconds,
&gt; &gt; see the output of 'riak console' for more information.
&gt; &gt; If you want to wait longer, set the environment variable
&gt; &gt; WAIT\_FOR\_ERLANG to the number of seconds to wait.
&gt; &gt;
&gt; &gt; [07-16 11:56] (master)~/Dev/prodar
&gt; &gt; ! riak-1.1.4/bin/riak attach
&gt; &gt; Node is not running!
&gt; &gt;
&gt; &gt;
&gt; &gt; Not sure if any logs would be interesting to look at after this.
&gt; &gt; Interestingly, riak does seem to be running, as basic REST stuff seems to
&gt; &gt; work OK (using Ruby + Ripple).
&gt; &gt;
&gt; &gt; -S
&gt; &gt;
&gt; &gt; On Mon, Jul 16, 2012 at 12:23 AM, Erik Søe Sørensen 
&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Well, from the logs it looks like a normal and successful startup...
&gt; &gt;&gt; consistent with the fact that a riak process continues to exists.
&gt; &gt;&gt; And the startup does not seem to be slow (which would cause a timeout
&gt; for
&gt; &gt;&gt; the script waiting for the node to come up); from logging starts to the
&gt; node
&gt; &gt;&gt; is ready takes just 2s.
&gt; &gt;&gt; It then remains to be determined why the start script reports timeout.
&gt; &gt;&gt;
&gt; &gt;&gt; Either it can't connect to the node, or the check it attempts to make
&gt; &gt;&gt; within the node (whether an Erlang process called
&gt; 'riak\_core\_node\_watcher'
&gt; &gt;&gt; is registered) never succeeds.
&gt; &gt;&gt; Have you tried attaching to the node, using "riak attach"? That would
&gt; &gt;&gt; check which of the two things fail.
&gt; &gt;&gt;
&gt; &gt;&gt; The pipe files are usually called things like
&gt; &gt;&gt; /tmp/riak/erlang.pipe.2.r
&gt; &gt;&gt; (they exist in pairs: one to and one from the node).
&gt; &gt;&gt;
&gt; &gt;&gt; /Erik
&gt; &gt;&gt;
&gt; &gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt;&gt; From: Steve Hull [st...@taskrabbit.com]
&gt; &gt;&gt; Sent: 16 July 2012 08:20
&gt; &gt;&gt; To: Erik Søe Sørensen
&gt; &gt;&gt; Cc: videlalv...@gmail.com; riak-users@lists.basho.com
&gt; &gt;&gt; Subject: Re: riak doesn't start on new Macbook Pro Retina
&gt; &gt;&gt;
&gt; &gt;&gt; Hi Erik!
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks for the suggestions. I checked out /tmp but didn't see anything
&gt; &gt;&gt; that looked like a pipe for riak... perhaps could you tell me what the
&gt; file
&gt; &gt;&gt; would be named?
&gt; &gt;&gt;
&gt; &gt;&gt; Not sure which logs would be most useful, but please find everything
&gt; that
&gt; &gt;&gt; was generated attached.
&gt; &gt;&gt;
&gt; &gt;&gt; -S
&gt; &gt;&gt;
&gt; &gt;&gt; On Sat, Jul 14, 2012 at 9:40 AM, Erik Søe Sørensen
&gt; &gt;&gt; &gt; wrote:
&gt; &gt;&gt; If I remember correctly, this may be a symptom that the pipe file on
&gt; /tmp
&gt; &gt;&gt; which Riak wants to use does already exists but is owned by another
&gt; user.
&gt; &gt;&gt; This happens if Riak has previously been run by a different user.
&gt; &gt;&gt; If it's not that, I suggest you provide the logs from the failed "riak
&gt; &gt;&gt; start" attempt for further diagnosis...
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Steve Hull | TaskRabbit |Software Engineer
&gt; &gt; P: 510.928.4719
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

