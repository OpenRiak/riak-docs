---
title: "Re: Searching"
description: ""
project: community
lastmod: 2015-03-07T08:08:05-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15856"
mailinglist_parent_id: "msg15854"
author_name: "Jason Ryan"
project_section: "mailinglistitem"
sent_date: 2015-03-07T08:08:05-08:00
---


Just as some FYI - we've just had another crash as of 15mins ago.

[image: photo]
\*Jason Ryan\*
VP Engineering

Trustev
Real Time, Online Identity Verification

email: jason.r...@trustev.com
skype: jason\_j\_ryan
web: www.trustev.com

Trustev Ltd, 2100 Cork Airport Business Park, Cork, Ireland.

On 7 March 2015 at 15:54, Zeeshan Lakhani  wrote:

&gt; Hello Jason,
&gt;
&gt; I initially was thinking that you’re issues were similar to what we’ve
&gt; found here,
&gt; https://github.com/basho/yokozuna/issues/442#issuecomment-77233636, but
&gt; seeing {error, retry\_later} and the 500s seem to place the problems more on
&gt; the Solr end. Just to make sure, are you seeing `yz\_events` crashes in your
&gt; logs?
&gt;
&gt; Can you tell me how much RAM each node has and have you adjusted/increased
&gt; the search.sol.jmv\_options max heap size at all (more info on
&gt; issues/factors w/ Solr performance here -&gt;
&gt; http://docs.basho.com/riak/latest/ops/advanced/configs/search/#Solr-for-Operators
&gt; )?
&gt;
&gt; What kind of issues are you getting in your solr logs? Anything related to
&gt; bad/corrupted data (which will index into \_yz\_err fields when dealing with
&gt; failed extractions) or possible sibling explosion (duplicates of the same
&gt; object with different \_yz\_vtag fields)?
&gt;
&gt; Thanks.
&gt;
&gt;
&gt; Zeeshan Lakhani
&gt; programmer |
&gt; software engineer at @basho |
&gt; org. member/founder of @papers\_we\_love | paperswelove.org
&gt; twitter =&gt; @zeeshanlakhani
&gt;
&gt; On Mar 7, 2015, at 5:43 AM, Jason Ryan  wrote:
&gt;
&gt; Hi all,
&gt;
&gt; We're having real trouble with Riak Search.
&gt; We are seeing an awful lot of errors, which leads to alot of logging for
&gt; solr and the disk IO reaching 95% + which is causing lots of issues.
&gt;
&gt; - We consistently see errors around Riak trying to create indexes which
&gt; already exist - only a restart of each Riak node stops this for a period of
&gt; time - indexes are only ever created manually, not by software.
&gt;
&gt; - We see lots of errors around failing to index objects - details of what
&gt; appears in the log are:
&gt;
&gt; 2015-03-07 10:30:26.871 [error] &lt;0.2538.0&gt;@yz\_kv:index:215 failed to index
&gt; object
&gt; {{&lt;&lt;"Production"&gt;&gt;,&lt;&lt;"Grains.Domain.Case"&gt;&gt;},&lt;&lt;"455203890918dfc6fd3c7da49dd6adb00300000043a46a51"&gt;&gt;}
&gt; with error {"Failed to index docs",{error,retry\_later}} because
&gt; [{yz\_solr,index,3,[{file,"src/yz\_solr.erl"},{line,192}]},{yz\_kv,index,7,[{file,"src/yz\_kv.erl"},{line,267}]},{yz\_kv,index,3,[{file,"src/yz\_kv.erl"},{line,202}]},{riak\_kv\_vnode,actual\_put,6,[{file,"src/riak\_kv\_vnode.erl"},{line,1418}]},{riak\_kv\_vnode,perform\_put,3,[{file,"src/riak\_kv\_vnode.erl"},{line,1406}]},{riak\_kv\_vnode,do\_put,7,[{file,"src/riak\_kv\_vnode.erl"},{line,1201}]},{riak\_kv\_vnode,handle\_command,3,[{file,"src/riak\_kv\_vnode.erl"},{line,486}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]}]
&gt;
&gt; - We are also starting to see 500's being returned for search queries -
&gt; the response looks like this:
&gt;
&gt; 500 Internal Server
&gt; ErrorInternal Server Error
=====================

The server
&gt; encountered an error while processing this request:  

```
{error,
&gt;
&gt;     {throw,
&gt;
&gt;         {"Failed to search",
&gt;
&gt;          "http://localhost:8093/internal_solr/sessions/select",
&gt;
&gt;          {error,retry_later}},
&gt;
&gt;         [{yz_solr,search,3,[{file,"src/yz_solr.erl"},{line,278}]},
&gt;
&gt;
&gt; {yz_wm_search,search,2,[{file,"src/yz_wm_search.erl"},{line,129}]},
&gt;
&gt;          {webmachine_resource,resource_call,3,
&gt;
&gt;              [{file,"src/webmachine_resource.erl"},{line,186}]},
&gt;
&gt;          {webmachine_resource,do,3,
&gt;
&gt;              [{file,"src/webmachine_resource.erl"},{line,142}]},
&gt;
&gt;          {webmachine_decision_core,resource_call,1,
&gt;
&gt;              [{file,"src/webmachine_decision_core.erl"},{line,48}]},
&gt;
&gt;          {webmachine_decision_core,decision,1,
&gt;
&gt;              [{file,"src/webmachine_decision_core.erl"},{line,558}]},
&gt;
&gt;          {webmachine_decision_core,handle_request,2,
&gt;
&gt;              [{file,"src/webmachine_decision_core.erl"},{line,33}]},
&gt;
&gt;          {webmachine_mochiweb,loop,2,
&gt;
&gt; * Connection #0 to host 10.0.5.6 left intact
&gt;
&gt;
&gt; [{file,"src/webmachine_mochiweb.erl"},{line,74}]}]}}
```


---

mochiweb+webmachine
&gt; web server


&gt;
&gt;
&gt; Anyone that could point us in the right direction of where to look and
&gt; debug, as this is becoming a huge issue for us.
&gt;
&gt;
&gt; Thanks,
&gt;
&gt; Jason
&gt;
&gt;
&gt;
&gt;
&gt; This message is for the named person's use only. If you received this
&gt; message in error, please immediately delete it and all copies and notify
&gt; the sender. You must not, directly or indirectly, use, disclose,
&gt; distribute, print, or copy any part of this message if you are not the
&gt; intended recipient. Any views expressed in this message are those of the
&gt; individual sender and not Trustev Ltd. Trustev is registered in Ireland
&gt; No. 516425 and trades from 2100 Cork Airport Business Park, Cork, Ireland.
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;

-- 


This message is for the named person's use only. If you received this 
message in error, please immediately delete it and all copies and notify 
the sender. You must not, directly or indirectly, use, disclose, 
distribute, print, or copy any part of this message if you are not the 
intended recipient. Any views expressed in this message are those of the 
individual sender and not Trustev Ltd. Trustev is registered in Ireland No. 
516425 and trades from 2100 Cork Airport Business Park, Cork, Ireland.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

