---
title: "Re: tuning riak for 100s of concurrent connections"
description: ""
project: community
lastmod: 2011-02-25T09:36:49-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02464"
mailinglist_parent_id: "msg02459"
author_name: "Les Mikesell"
project_section: "mailinglistitem"
sent_date: 2011-02-25T09:36:49-08:00
---


But it sounds like the thing causing the latency - and I can't imagine a 
scenario where you would want additional latency. It is going to add a 
delay any time you need to send a small packet with an unacknowledged 
packet already outstanding and you aren't closing the socket. If that's 
a common scenario (as it would be with connection caching) it should be 
disabled. It only helps when an app does small writes on an output 
stream and you want them transparently buffered into large packets 
anyway. Not sure if that applies to riak or if it does it's own buffer 
chunking.



On 2/25/2011 11:00 AM, Sean Cribbs wrote:

I wasn't commenting that one should disable it, just that the option is there. 
I think it depends on your operational needs, namely the latency between the 
clients and Riak.

Sean Cribbs
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Feb 25, 2011, at 11:52 AM, Les Mikesell wrote:


On 2/25/2011 10:37 AM, Sean Cribbs wrote:

You can disable Nagle on the riak side (at least on 0.14 and later). Put this 
in the riak\_core section of app.config:

{disable\_http\_nagle, true}


Shouldn't that be the default if clients are able to cache connections? You'll 
normally get the delay if your protocol isn't a strict serial handshake and you 
need to send a small packet with data already outstanding (like at the end of a 
request where the socket isn't being closed).

--
 Les Mikesell
 lesmikes...@gmail.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com





\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

