---
title: "Re: Moving mapred* functions out of riak_client?"
description: ""
project: community
lastmod: 2011-06-10T08:19:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03641"
mailinglist_parent_id: "msg03639"
author_name: "Kresten Krab Thorup"
project_section: "mailinglistitem"
sent_date: 2011-06-10T08:19:56-07:00
---


We are using those APIs in our new stuff for riak sync/mobile. My problem with 
your change would be that we have a mock riak\_client which is super convenient 
for unit testing, and it would be good to still be able to have that somehow. 
Our mock is just an eta-backed parameterized module which has 
put/get/mapred\_bucket/etc. .... 

Kresten 

On 10/06/2011, at 12.33, "Bryan Fink"  wrote:

&gt; Hello, Community.
&gt; 
&gt; I'd like to know how many of you are directly using the mapred\*
&gt; functions in the riak\_client module (riak\_client:mapred/2,3,4,
&gt; :mapred\_stream/2,3,4, :mapred\_bucket/2,3,4, etc.). Of those that are,
&gt; how many of you would mind if they moved out of riak\_client and into a
&gt; separate module?
&gt; 
&gt; Just to be clear: if you're accessing Riak's MapReduce system over
&gt; HTTP or ProtocolBuffers, this change would not affect you. My search
&gt; is only for people using the native distributed Erlang client
&gt; (https://github.com/basho/riak\_kv/blob/master/src/riak\_client.erl).
&gt; 
&gt; I'm doing some other work on Riak's MapReduce system, and as part of
&gt; the cleanup, I'd like to deprecate the riak\_client:mapred\* functions,
&gt; and replace them with functions in another module. Basically, any
&gt; code you had like this:
&gt; 
&gt; {ok, C} = riak:local\_client(),
&gt; {ok, Results} = C:mapred(Inputs, Query).
&gt; 
&gt; would need to be converted to this:
&gt; 
&gt; {ok, Results} = riak\_kv\_mapred\_iface:mapred(Inputs, Query).
&gt; 
&gt; Additionally, remote connections that looked like this:
&gt; 
&gt; {ok, C} = riak:client\_connect(RiakNode),
&gt; {ok, Results} = C:mapred(Inputs, Query).
&gt; 
&gt; would need to be converted to something like this:
&gt; 
&gt; {ok, Results} = rpc:call(RiakNode, riak\_kv\_mapred\_iface, mapred,
&gt; [Inputs, Query]).
&gt; 
&gt; Would this change be distasteful or unbearable for any of you?
&gt; 
&gt; Thanks,
&gt; 
&gt; Bryan Fink
&gt; Senior Software Engineer
&gt; Basho Technologies
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

