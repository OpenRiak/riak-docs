---
title: "Re: atomically updating multiple keys"
description: ""
project: community
lastmod: 2011-10-28T18:28:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05360"
mailinglist_parent_id: "msg05358"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2011-10-28T18:28:40-07:00
---


This would have to be implemented in application space... Or an rdbms that
supports acid. Maybe a combination of the two.

@siculars
http://siculars.posterous.com

Sent from my rotary phone.
On Oct 28, 2011 8:56 PM, "Justin Karneges"  wrote:

&gt; Hi,
&gt;
&gt; Suppose I've got a key A that points to a set of child keys. What's the
&gt; best
&gt; way to add child key B and update the reference in A, without the DB
&gt; becoming
&gt; inconsistent in a fail case?
&gt;
&gt; I imagine I want to do:
&gt;
&gt; set B (create the child)
&gt; get A (to fetch the original key set)
&gt; set A (resave A with an updated key set that includes B)
&gt;
&gt; However, if there's a failure applying the changes to A, then I end up with
&gt; this orphaned B key with nobody pointing to it. Should the client try to
&gt; perform a rollback then? That is, if setting A fails then delete B? What
&gt; if
&gt; there's a failure to delete B? Cron job garbage collectors that delete
&gt; orphaned keys? How can I not make a mess of my DB? :)
&gt;
&gt; I know this is probably a KV 101 question that applies to everything, not
&gt; just
&gt; Riak, but nothing obvious came up on Google...
&gt;
&gt; Justin
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

