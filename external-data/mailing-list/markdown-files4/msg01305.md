---
title: "Re: Designing Your Buckets"
description: ""
project: community
lastmod: 2010-10-15T06:02:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01305"
mailinglist_parent_id: "msg01304"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2010-10-15T06:02:45-07:00
---


State &gt; zip &gt; person with links in between seems very normalized to
me. Ya, you can do it, but I wouldn't. You in flat space now.
Denormalize ftw.

Sean Cribbs had a blog post on m/r'ing over some people and I have a
post on using m/r to sort by date. Google will find em.

-Alexander

On 2010-10-15, Jeremiah Peschka  wrote:
&gt; Based on my experience, you're on the right track.
&gt;
&gt; In addition to your main 'entity' buckets, you'll want to create index
&gt; buckets that you use to speed lookups and create links back to the entity
&gt; buckets.
&gt;
&gt; e.g. If you have a People bucket that is a nested record for a person with a
&gt; mailing address, you might want to create some kind of States bucket with
&gt; links to a ZipCodes bucket with further links to the People bucket. This way
&gt; you can do link traversal from a state -&gt; zip code -&gt; person.
&gt;
&gt; To perform aggregations, you can use MapReduce. Using buckets and link
&gt; walking can make it very easy to perform operations that closely mimic index
&gt; seeks.
&gt;
&gt; Someone correct me if I've gone completely off the deep end on this one :)
&gt;
&gt; Jeremiah Peschka
&gt; Microsoft SQL Server MVP
&gt; MCITP: Database Developer, DBA
&gt; 614.515.0727
&gt;
&gt;
&gt; On Fri, Oct 15, 2010 at 1:49 AM, Cagdas Tulek  wrote:
&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I'm a newbie to Riak (and riak like databases) and unfortunately I am a
&gt;&gt; long time RDB user. So, my mind is very biased but I try to think
&gt;&gt; differently and this will take some time.
&gt;&gt;
&gt;&gt; What I understand is that you try to avoid range queries and map/reduce
&gt;&gt; operations for live traffic. This part, I guess I understand better.
&gt;&gt;
&gt;&gt; However, one thing that I don't understand is the needs on admin side.
&gt;&gt; Although on frontend you can play smart to limit the objects that a user
&gt;&gt; should interact, on the admin side you usually want to list all records
&gt;&gt; and
&gt;&gt; usually you want them to be sorted by id or creation time. These are also
&gt;&gt; true for your stats etc.
&gt;&gt;
&gt;&gt; How do you design your buckets in Riak to solve this problem? Or do you
&gt;&gt; use
&gt;&gt; different approaches on admin side.
&gt;&gt;
&gt;&gt; One (maybe dirty) solution with my RDB biased mind is to have auxiliary
&gt;&gt; buckets to list items:
&gt;&gt; books/book1..n
&gt;&gt; lists/list1..n
&gt;&gt; where list-i is an array of x keys (where x is a small number like 10,
&gt;&gt; 20).
&gt;&gt; This way we can have features like pagination. Same thing maybe for days:
&gt;&gt; days/20101014
&gt;&gt;
&gt;&gt; I try to find slides/documents about these topics but usually the
&gt;&gt; information I find is about dealing with individual items and their
&gt;&gt; relations, not a list of these items.
&gt;&gt;
&gt;&gt; I would appreciate any resources addressing these problems.
&gt;&gt;
&gt;&gt; Best,
&gt;&gt;
&gt;&gt; Cagdas
&gt;&gt;
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;

-- 
Sent from my mobile device

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

