---
title: "Re: Cluster on startup."
description: ""
project: community
lastmod: 2012-11-07T07:09:56-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09230"
mailinglist_parent_id: "msg09226"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2012-11-07T07:09:56-08:00
---


Responses inline.

---
Jeremiah Peschka
Founder, Brent Ozar Unlimited

On Nov 7, 2012, at 6:45 AM, "Kevin Burton"  wrote:

&gt; Thank you this will help. I am a little new to the administration of init.d. 
&gt; What do I need to edit to remove the startup of the Riak instance? What 
&gt; should be changed to the init.d to run the script on boot up? I notice that 
&gt; the script only has functions.

You should consult your Linux distribution for helpful hints on doing this. 
This[1] may be of some help.

[1]: http://www.unixtutorial.org/2009/01/disable-service-startup-in-ubuntu/

&gt; How are the functions used?

You'd use those functions the same way you would use any other Linux command. 

&gt; You also do ‘ulimit –n 1024’. On installation I received a warning that 1024 
&gt; was too low. Should the ulimit be changed?

Yes. You'll rapidly run into problems with open file handles, especially with 
multiple Riak nodes on the same box.

&gt; 
&gt; Thanks again.
&gt; 
&gt; 
&gt; From: riak-users [mailto:riak-users-boun...@lists.basho.com] On Behalf Of 
&gt; Jeremiah Peschka
&gt; Sent: Wednesday, November 07, 2012 8:17 AM
&gt; To: riak-users@lists.basho.com
&gt; Subject: Re: Cluster on startup.
&gt; 
&gt; To add a node to a cluster, you can execute riak-admin cluster join 
&gt; riak@192.168.0.1 See [1] for more details. There is no need to reboot for the 
&gt; cluster to be formed; the nodes will talk amongst themselves and once they 
&gt; find each other, the cluster is up.
&gt; 
&gt; To start and stop my dev cluster, I wrote a quick bash function [2] to handle 
&gt; starting and stopping my local dev cluster. In production, you'd add Riak to 
&gt; the init scripts like you did with your single node. You could even tell 
&gt; init.d to not start the main cluster and instead execute your dev cluster if 
&gt; you'd prefer.
&gt; 
&gt; If I were you, I'd remove (or at the very least, stop) the Riak instance 
&gt; you've got and walk through the Fast Track/Quick Start.
&gt; 
&gt; 
&gt; [1]: http://docs.basho.com/riak/latest/cookbooks/Adding-and-Removing-Nodes/
&gt; [2]: https://github.com/peschkaj/dotfiles/blob/master/bash/functions.sh#L4
&gt; ---
&gt; Jeremiah Peschka
&gt; Founder, Brent Ozar Unlimited
&gt; 
&gt; On Nov 7, 2012, at 4:27 AM, "Kevin Burton"  wrote:
&gt; 
&gt; On more question. The “Quick Start” shows manually starting each riak server 
&gt; then joining. But when I start my Linux server I see that a riak server is 
&gt; started. I am assuming that this is the main riak server that was installed. 
&gt; How do I start three riak instances instead of just one or by starting one 
&gt; they all are started automatically? I understand the join cannot be 
&gt; configured. So after I have these three riak instances running (presumably 
&gt; after a reboot) then I join them into a cluster, reboot, and the cluster will 
&gt; be formed? After the cluster has been formed how do I “edit” it? I would 
&gt; foresee needing to add or remove nodes from the cluster.
&gt; 
&gt; From: Reid Draper [mailto:reiddra...@gmail.com] 
&gt; Sent: Tuesday, November 06, 2012 9:36 PM
&gt; To: Kevin Burton
&gt; Cc: riak-users@lists.basho.com
&gt; Subject: Re: Cluster on startup.
&gt; 
&gt; 
&gt; On Nov 6, 2012, at 5:43 PM, Kevin Burton  wrote:
&gt; 
&gt; 
&gt; 
&gt; This is probably an FAQ but I was unable to find an answer so hopefully there 
&gt; will be some patient people.
&gt; 
&gt; The “Quick Start” builds a simple cluster all on the same machine (called 
&gt; dev1, dev2, and dev3). It assigns the ports, IP addresses, etc. I would like 
&gt; to do something similar but I would like the cluster to startup 
&gt; automatically. What do I need to add to the configuration file so that all of 
&gt; the joins etc. happen on startup? This would be a Ubuntu Server if it makes 
&gt; any difference.
&gt; 
&gt; There is no configuration option to do this. However, once the nodes have 
&gt; been joined to a cluster, they'll
&gt; remain part of the same cluster even if they're restarted. Hope this helps.
&gt; 
&gt; Reid
&gt; 
&gt; 
&gt; Thank you.
&gt; 
&gt; Kevin
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

