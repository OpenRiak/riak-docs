---
title: "Re: Waiting for riak to handoff ?"
description: ""
project: community
lastmod: 2014-08-22T02:30:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14784"
mailinglist_parent_id: "msg14773"
author_name: "Marcel Koopman"
project_section: "mailinglistitem"
sent_date: 2014-08-22T02:30:13-07:00
---


Hello, we upgraded to 1.4.10 on all nodes. Please see below:

 riak-admin transfers

'riak@newnode5 waiting to handoff 11 partitions

'riak@newnode4' waiting to handoff 11 partitions

'riak@newnode3' waiting to handoff 11 partitions

'riak@newnode2' waiting to handoff 11 partitions

'riak@newnode1' waiting to handoff 11 partitions

'riak@oldnode2' waiting to handoff 11 partitions

'riak@oldnode3' waiting to handoff 11 partitions


Active Transfers:



$ riak-admin transfer-limit

=============================== Transfer Limit
================================

Limit Node

-------------------------------------------------------------------------------

 2 'riak@oldnode3'

 2 'riak@oldnode2'

 2 'riak@oldnode1'

 2 'riak@newnode1'

 2 'riak@newnode2'

 2 'riak@newnode3'

 2 'riak@newnode4'

 2 'riak@newnode5'

-------------------------------------------------------------------------------

Note: You can change transfer limits with 'riak-admin transfer\_limit
'

 and 'riak-admin transfer\_limit  '

$ riak-admin status

1-minute stats for 'riak@newnode1'

-------------------------------------------

riak\_kv\_stat\_ts : 1408692262

vnode\_gets : 0

vnode\_gets\_total : 374554

vnode\_puts : 0

vnode\_puts\_total : 11795

vnode\_index\_refreshes : 0

vnode\_index\_refreshes\_total : 0

vnode\_index\_reads : 0

vnode\_index\_reads\_total : 683394

vnode\_index\_writes : 0

vnode\_index\_writes\_total : 11715

vnode\_index\_writes\_postings : 0

vnode\_index\_writes\_postings\_total : 10449

vnode\_index\_deletes : 0

vnode\_index\_deletes\_total : 0

vnode\_index\_deletes\_postings : 0

vnode\_index\_deletes\_postings\_total : 675

node\_gets : 0

node\_gets\_total : 117806

node\_get\_fsm\_siblings\_mean : 0

node\_get\_fsm\_siblings\_median : 0

node\_get\_fsm\_siblings\_95 : 0

node\_get\_fsm\_siblings\_99 : 0

node\_get\_fsm\_siblings\_100 : 0

node\_get\_fsm\_objsize\_mean : 0

node\_get\_fsm\_objsize\_median : 0

node\_get\_fsm\_objsize\_95 : 0

node\_get\_fsm\_objsize\_99 : 0

node\_get\_fsm\_objsize\_100 : 0

node\_get\_fsm\_time\_mean : 0

node\_get\_fsm\_time\_median : 0

node\_get\_fsm\_time\_95 : 0

node\_get\_fsm\_time\_99 : 0

node\_get\_fsm\_time\_100 : 0

node\_puts : 0

node\_puts\_total : 4575

node\_put\_fsm\_time\_mean : 0

node\_put\_fsm\_time\_median : 0

node\_put\_fsm\_time\_95 : 0

node\_put\_fsm\_time\_99 : 0

node\_put\_fsm\_time\_100 : 0

read\_repairs : 0

read\_repairs\_total : 129

coord\_redirs\_total : 1427

executing\_mappers : 0

precommit\_fail : 0

postcommit\_fail : 0

index\_fsm\_create : 0

index\_fsm\_create\_error : 0

index\_fsm\_active : 0

list\_fsm\_create : 0

list\_fsm\_create\_error : 0

list\_fsm\_active : 0

pbc\_active : 56

pbc\_connects : 60

pbc\_connects\_total : 163594

node\_get\_fsm\_active : 0

node\_get\_fsm\_active\_60s : 10

node\_get\_fsm\_in\_rate : 0

node\_get\_fsm\_out\_rate : 0

node\_get\_fsm\_rejected : 0

node\_get\_fsm\_rejected\_60s : 0

node\_get\_fsm\_rejected\_total : 0

node\_put\_fsm\_active : 0

node\_put\_fsm\_active\_60s : 0

node\_put\_fsm\_in\_rate : 0

node\_put\_fsm\_out\_rate : 0

node\_put\_fsm\_rejected : 0

node\_put\_fsm\_rejected\_60s : 0

node\_put\_fsm\_rejected\_total : 0

read\_repairs\_primary\_outofdate\_one : 0

read\_repairs\_primary\_outofdate\_count : 104

read\_repairs\_primary\_notfound\_one : 0

read\_repairs\_primary\_notfound\_count : 61

read\_repairs\_fallback\_notfound\_one : 0

read\_repairs\_fallback\_notfound\_count : 40

leveldb\_read\_block\_error : 0

riak\_pipe\_stat\_ts : 1408692262

pipeline\_active : 0

pipeline\_create\_count : 0

pipeline\_create\_one : 0

pipeline\_create\_error\_count : 0

pipeline\_create\_error\_one : 0

cpu\_nprocs : 263

cpu\_avg1 : 20

cpu\_avg5 : 23

cpu\_avg15 : 33

mem\_total : 8374890496

mem\_allocated : 7878340608

disk : [{"/",5766260,42},

 {"/dev",4080488,1},

 {"/run",1635724,1},

 {"/run/lock",5120,0},

 {"/run/shm",4089300,0},

 {"/var/log",1922060,4},

 {"/data",258030980,69}]

nodename : 'riak@ \*oldnode2\*'

connected\_nodes :
['newnode1','newnode2','newnode3','newnode4',newnode5','oldnode1','oldnode3',

 'riak@oldnode2']

sys\_driver\_version : &lt;&lt;"2.0"&gt;&gt;

sys\_global\_heaps\_size : 0

sys\_heap\_type : private

sys\_logical\_processors : 2

sys\_otp\_release : &lt;&lt;"R15B01"&gt;&gt;

sys\_process\_count : 1175

sys\_smp\_support : true

sys\_system\_version : &lt;&lt;"Erlang R15B01 (erts-5.9.1) [source] [64-bit]
[smp:2:2] [async-threads:64] [kernel-poll:true]"&gt;&gt;

sys\_system\_architecture : &lt;&lt;"x86\_64-unknown-linux-gnu"&gt;&gt;

sys\_threads\_enabled : true

sys\_thread\_pool\_size : 64

sys\_wordsize : 8

ring\_members :
 ['newnode1','newnode2','newnode3','newnode4',newnode5','oldnode1','oldnode3',

 'riak@oldnode2']

ring\_num\_partitions : 64

ring\_ownership : &lt;&lt;"[{'riak@oldnode1',16},\n {'riak@oldnode2',32},\n
{'riak@oldnode3',16}]"&gt;&gt;

ring\_creation\_size : 64

storage\_backend : riak\_kv\_eleveldb\_backend

erlydtl\_version : &lt;&lt;"0.7.0"&gt;&gt;

riak\_control\_version : &lt;&lt;"1.4.10-0-g73c43c3"&gt;&gt;

cluster\_info\_version : &lt;&lt;"1.2.4"&gt;&gt;

riak\_search\_version : &lt;&lt;"1.4.10-0-g6e548e7"&gt;&gt;

merge\_index\_version : &lt;&lt;"1.3.2-0-gcb38ee7"&gt;&gt;

riak\_kv\_version : &lt;&lt;"1.4.10-0-g64b6ad8"&gt;&gt;

sidejob\_version : &lt;&lt;"0.2.0"&gt;&gt;

riak\_api\_version : &lt;&lt;"1.4.10-0-gc407ac0"&gt;&gt;

riak\_pipe\_version : &lt;&lt;"1.4.10-0-g9353526"&gt;&gt;

riak\_core\_version : &lt;&lt;"1.4.10"&gt;&gt;

bitcask\_version : &lt;&lt;"1.6.6-0-g230b6d6"&gt;&gt;

basho\_stats\_version : &lt;&lt;"1.0.3"&gt;&gt;

webmachine\_version : &lt;&lt;"1.10.4-0-gfcff795"&gt;&gt;

mochiweb\_version : &lt;&lt;"1.5.1p6"&gt;&gt;

inets\_version : &lt;&lt;"5.9"&gt;&gt;

erlang\_js\_version : &lt;&lt;"1.2.2"&gt;&gt;

runtime\_tools\_version : &lt;&lt;"1.8.8"&gt;&gt;

os\_mon\_version : &lt;&lt;"2.2.9"&gt;&gt;

riak\_sysmon\_version : &lt;&lt;"1.1.3"&gt;&gt;

ssl\_version : &lt;&lt;"5.0.1"&gt;&gt;

public\_key\_version : &lt;&lt;"0.15"&gt;&gt;

crypto\_version : &lt;&lt;"2.1"&gt;&gt;

sasl\_version : &lt;&lt;"2.2.1"&gt;&gt;

lager\_version : &lt;&lt;"2.0.1"&gt;&gt;

goldrush\_version : &lt;&lt;"0.1.5"&gt;&gt;

compiler\_version : &lt;&lt;"4.8.1"&gt;&gt;

syntax\_tools\_version : &lt;&lt;"1.6.8"&gt;&gt;

stdlib\_version : &lt;&lt;"1.18.1"&gt;&gt;

kernel\_version : &lt;&lt;"2.15.1"&gt;&gt;

memory\_total : 222011368

memory\_processes : 29166010

memory\_processes\_used : 29165996

memory\_system : 192845358

memory\_atom : 545377

memory\_atom\_used : 519982

memory\_binary : 133403072

memory\_code : 11477147

memory\_ets : 7076680


2014-08-21 17:53 GMT+02:00 Luke Bakken :

&gt; Hi Marcel -
&gt;
&gt; What version of Riak are you using?
&gt;
&gt; What is the output of "riak-admin transfer-limit" ?
&gt; --
&gt; Luke Bakken
&gt; CSE
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Wed, Aug 20, 2014 at 8:02 AM, Marcel Koopman
&gt;  wrote:
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; It seems that adding new nodes does not have any effect.
&gt; &gt;
&gt; &gt; Why it Riak waiting for transfers? When does it start handoff the new
&gt; nodes?
&gt; &gt;
&gt; &gt;
&gt; &gt; riak-admin member-status
&gt; &gt;
&gt; &gt; ================================= Membership
&gt; &gt; ==================================
&gt; &gt;
&gt; &gt; Status Ring Pending Node
&gt; &gt;
&gt; &gt;
&gt; -------------------------------------------------------------------------------
&gt; &gt;
&gt; &gt; valid 25.0% 34.4% 'riak@oldnode1'
&gt; &gt;
&gt; &gt; valid 25.0% 32.8% 'riak@oldnode2'
&gt; &gt;
&gt; &gt; valid 50.0% 32.8% 'riak@oldnode3
&gt; &gt;
&gt; &gt; valid 0.0% 0.0% 'riak@newnode1'
&gt; &gt;
&gt; &gt; valid 0.0% 0.0% 'riak@newnode2'
&gt; &gt;
&gt; &gt; valid 0.0% 0.0% 'riak@newnode3'
&gt; &gt;
&gt; &gt; valid 0.0% 0.0% 'riak@newnode4'
&gt; &gt;
&gt; &gt; valid 0.0% 0.0% 'riak@newnode5'
&gt; &gt;
&gt; &gt;
&gt; -------------------------------------------------------------------------------
&gt; &gt;
&gt; &gt; Valid:8 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt; &gt;
&gt; &gt;
&gt; &gt; riak-admin transfers
&gt; &gt;
&gt; &gt; 'riak@newnode5' waiting to handoff 11 partitions
&gt; &gt;
&gt; &gt; 'riak@newnode4' waiting to handoff 11 partitions
&gt; &gt;
&gt; &gt; 'riak@newnode3' waiting to handoff 11 partitions
&gt; &gt;
&gt; &gt; 'riak@newnode2' waiting to handoff 11 partitions
&gt; &gt;
&gt; &gt; 'riak@newnode1' waiting to handoff 11 partitions
&gt; &gt;
&gt; &gt; 'riak@oldnode1' waiting to handoff 11 partitions
&gt; &gt;
&gt; &gt; 'riak@oldnode2' waiting to handoff 11 partitions
&gt; &gt;
&gt; &gt; Active Transfers:
&gt; &gt;
&gt; &gt; (nothing here)
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Met vriendelijke groet,
&gt; &gt;
&gt; &gt; Marcel Koopman
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;



-- 
Met vriendelijke groet,

Marcel Koopman
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

