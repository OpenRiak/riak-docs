---
title: "Re: Riak Java client API"
description: ""
project: community
lastmod: 2016-10-29T10:46:53-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17720"
mailinglist_parent_id: "msg17719"
author_name: "AJAX DoneBy Jack"
project_section: "mailinglistitem"
sent_date: 2016-10-29T10:46:53-07:00
---


Hi Pratik,

&gt;From exception msg you are missing joda time jar, download one and put in
your classpath.
If you use maven it will download the dependency for you automatically.

Hope this help.
Ajax

On Friday, 28 October 2016, Pratik Kulkarni  wrote:

&gt; Hi All,
&gt;
&gt; I am working on a distributed file storage system using the Java Netty
&gt; framework. For this purpose i have Raik KV as an in memory storage
&gt; solution.
&gt; Following jar dependencies are present in my build path :
&gt;
&gt; jackson-all-1.8.5.jar
&gt; netty-all-4.0.15.Final.jar
&gt; slf4j-api-1.7.2.jar
&gt; slf4j-simple-1.7.2.jar
&gt; protobuf-java-2.6.1.jar
&gt; json-20160212.jar
&gt; riak-client-2.0.5.jar
&gt;
&gt; When i try initiate connection with the riak node. The connection attempt
&gt; is successful but when i try to store the object in \*Riak KV.\* I keep
&gt; getting the following NoClassDefFoundError. I am not sure why these errors
&gt; arrive though i have included all the jars. Do we require apart from\*
&gt; riak-client X.X jar\* any more dependencies. As per the terminal output I
&gt; tried to add the dependencies by downloading the jars. But it just keeps
&gt; giving me new dependencies error every time. Kindly help ?
&gt;
&gt; \*Please see the riak client code in java to store the file object \*
&gt;
&gt;
&gt; package gash.router.inmemory;
&gt;
&gt; import com.basho.riak.client.api.RiakClient;
&gt; import com.basho.riak.client.api.commands.kv.DeleteValue;
&gt; import com.basho.riak.client.api.commands.kv.FetchValue;
&gt; import com.basho.riak.client.api.commands.kv.StoreValue;
&gt; import com.basho.riak.client.core.RiakCluster;
&gt; import com.basho.riak.client.core.RiakNode;
&gt; import com.basho.riak.client.core.query.Location;
&gt; import com.basho.riak.client.core.query.Namespace;
&gt; import com.basho.riak.client.core.query.RiakObject;
&gt; import com.basho.riak.client.core.util.BinaryValue;
&gt;
&gt; import java.net.UnknownHostException;
&gt;
&gt; public class RiakClientHandler {
&gt; private static RiakCluster setUpCluster() throws UnknownHostException{
&gt; // This example will use only one node listening on
&gt; localhost:8098--default config
&gt;
&gt; RiakNode node = new RiakNode.Builder()
&gt; .withRemoteAddress("127.0.0.1")
&gt; .withRemotePort(8098)
&gt; .build();
&gt; // This cluster object takes our one node as an argument
&gt; RiakCluster cluster = new RiakCluster.Builder(node)
&gt; .build();
&gt;
&gt; // The cluster must be started to work, otherwise you will see
&gt; errors
&gt; cluster.start();
&gt;
&gt; return cluster;
&gt; }
&gt; private static class RiakFile{
&gt; public String filename;
&gt; public byte[] byteData;
&gt; }
&gt; public static void saveFile(String filename,byte[] byteData)
&gt; {
&gt; try{
&gt; System.out.println("Inside Riak handler");
&gt; RiakCluster cluster = setUpCluster();
&gt; RiakClient client = new RiakClient(cluster);
&gt; RiakFile newFile = createRiakFile(filename, byteData);
&gt; System.out.println("Riak file created");
&gt; Namespace fileBucket = new Namespace("files");
&gt; Location fileLocation = new Location(fileBucket, filename);
&gt; StoreValue storeFile = new StoreValue.Builder(newFile).
&gt; withLocation(fileLocation).build();
&gt; client.execute(storeFile);
&gt; System.out.println("File saved to riak ");
&gt; cluster.shutdown();
&gt; }
&gt; catch(Exception e){
&gt; e.printStackTrace();
&gt; }
&gt; }
&gt; private static RiakFile createRiakFile(String filename, byte[] byteData)
&gt; {
&gt; RiakFile file=new RiakFile();
&gt; file.filename=filename;
&gt; file.byteData=byteData;
&gt; return file;
&gt; }
&gt;
&gt; }
&gt;
&gt;
&gt; \*The terminal Output error:\*
&gt;
&gt;
&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

