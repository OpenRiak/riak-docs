---
title: "stream_list_keys"
description: ""
project: community
lastmod: 2013-04-16T07:50:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10897"
author_name: "tom kelly"
project_section: "mailinglistitem"
sent_date: 2013-04-16T07:50:35-07:00
---


Hi List,
I'm experimenting with riak 1.3.1 and I've started a cluster with two
nodes, connected from a dev node and wrote & read a few test keys and
everything was looking good. I was in the process of writing a few
functions we'll need in our system, one of which needs to cycle through all
the keys at startup, stream\_list\_keys looked like it would do the job but
I've just noticed this strange behavior:

(a...@dev1.bfast.com)41&gt;
(a...@dev1.bfast.com)41&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,2583625}
(a...@dev1.bfast.com)42&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,98542259}
(a...@dev1.bfast.com)43&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,83513611}
(a...@dev1.bfast.com)44&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,112529022}
(a...@dev1.bfast.com)45&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,66267591}
(a...@dev1.bfast.com)46&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,90620806}
(a...@dev1.bfast.com)47&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,24108838}
(a...@dev1.bfast.com)48&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,17013899}
(a...@dev1.bfast.com)49&gt; DB:stream\_list\_keys(&lt;&lt;"test"&gt;&gt;).
{ok,48399864}
(a...@dev1.bfast.com)50&gt; flush().
Shell got {2583625,{&lt;5272.17627.0&gt;,#Ref&lt;5272.0.0.95523&gt;},{keys,[&lt;&lt;1&gt;&gt;]}}
Shell got {98542259,{&lt;5272.17656.0&gt;,#Ref&lt;5272.0.0.95733&gt;},{keys,[&lt;&lt;1&gt;&gt;]}}
Shell got {83513611,{&lt;5272.17670.0&gt;,#Ref&lt;5272.0.0.95901&gt;},{keys,[&lt;&lt;1&gt;&gt;]}}
Shell got {112529022,{&lt;5272.17683.0&gt;,#Ref&lt;5272.0.0.96064&gt;},{keys,[]}}
Shell got {66267591,{&lt;5272.17698.0&gt;,#Ref&lt;5272.0.0.96224&gt;},{keys,[]}}
Shell got {90620806,{&lt;5272.17708.0&gt;,#Ref&lt;5272.0.0.96375&gt;},{keys,[&lt;&lt;1&gt;&gt;]}}
Shell got {24108838,{&lt;5272.17717.0&gt;,#Ref&lt;5272.0.0.96482&gt;},{keys,[&lt;&lt;1&gt;&gt;]}}
Shell got {17013899,{&lt;5272.17731.0&gt;,#Ref&lt;5272.0.0.96638&gt;},{keys,[&lt;&lt;1&gt;&gt;]}}
Shell got {48399864,{&lt;5272.17736.0&gt;,#Ref&lt;5272.0.0.96767&gt;},{keys,[]}}
ok

The key &lt;&lt;1&gt;&gt; was written over an hour ago and these successive calls to
stream\_list\_keys are ~2 seconds apart, The key isn't always in the first
keys message returned and there's only ever one message returned per call.
&gt;From the comments in the source I expected all the keys to be returned
followed by the done message.
Am I misunderstanding or misusing anything here? Any pointers welcomed.
Thanks,
//TTom.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

