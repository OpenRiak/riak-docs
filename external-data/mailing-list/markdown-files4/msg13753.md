---
title: "Re: Looking for an easy cache solution based on pre-commit hook"
description: ""
project: community
lastmod: 2014-03-05T07:38:12-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13753"
mailinglist_parent_id: "msg13752"
author_name: "Christian Dahlqvist"
project_section: "mailinglistitem"
sent_date: 2014-03-05T07:38:12-08:00
---


Hi Ivaylo,

For read intensive applications a common solution is to perform the caching
outside Riak, e.g. using Varnish, memcached or Redis. Often the application
will be responsible for populating the cache, but either the application or
Riak (through a commit hook) can be responsible for purging old records
from the cache when they are updated in Riak.

If you still choose to perform the caching in Riak, you always have the
option of using different bucket properties for the cache bucket, e.g. a
smaller n\_val, in order to optimise performance.

Best regards,

Christian


On Wed, Mar 5, 2014 at 2:24 PM, Brian Sparrow  wrote:

&gt; Hello Ivaylo,
&gt;
&gt; Yes, you could use a pre-commit hook for this but it's important to
&gt; understand the limitations of this design. A pre-commit hook blocks the
&gt; write until the hook comes back successful and then it proceeds. This is
&gt; going to add latency to write operations on the bitcask backend. An
&gt; alternative design would be to do 2 PUTs for each object, one in bitcask
&gt; and one in memory, to remove the hook all together. Either will work but
&gt; obviously have different trade offs.
&gt;
&gt; I recommend having a look at the riak\_search pre-commit hook(specifically
&gt; the pre-commit function)[0] for an example of how to write/install a
&gt; pre-commit hook.
&gt;
&gt; Let me know if you have any questions.
&gt;
&gt; Thanks!
&gt; Brian
&gt;
&gt; [0]
&gt; https://github.com/basho/riak\_search/blob/develop/src/riak\_search\_kv\_hook.erl
&gt;
&gt;
&gt; On Tue, Mar 4, 2014 at 11:39 AM, Ivaylo Panitchkov &lt;
&gt; ipanitch...@hibernum.com&gt; wrote:
&gt;
&gt;&gt;
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I'm playing with the Bitcask storage backend and realized it will be nice
&gt;&gt; if there is a cache functionality realized with the Memory backend. If I
&gt;&gt; install both Bitcask and Memory storage backends as Mult Is there any easy
&gt;&gt; way, a simple script that could do the caching by simply installing it with
&gt;&gt; pre-commit hook?
&gt;&gt;
&gt;&gt; Thanks in advance,
&gt;&gt; Ivaylo Panitchkov
&gt;&gt;
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

