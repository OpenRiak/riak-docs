---
title: "Re: Can I store the different bucket objects but with same key in the	same place"
description: ""
project: community
lastmod: 2011-01-10T05:15:27-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01940"
mailinglist_parent_id: "msg01938"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-01-10T05:15:27-08:00
---


To clear up this confusion, let me spell it out. The hash value of any 
bucket/key pair is the SHA1 of the serialized tuple of {Bucket, Key}. That is, 
{Bucket, Key} -&gt; term\_to\_binary -&gt; sha1.

The actual function that does the hashing:

https://github.com/basho/riak\_core/blob/master/src/chash.erl#L140

The helper function that most riak\_core applications use:

https://github.com/basho/riak\_core/blob/master/src/riak\_core\_util.erl#L160

An example of usage in the Get FSM:

https://github.com/basho/riak\_kv/blob/master/src/riak\_kv\_get\_fsm.erl#L70

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Jan 10, 2011, at 7:36 AM, Jeremiah Peschka wrote:

&gt; I believe that keys hare hashed using a combination of bucket name and key 
&gt; name. The bucket+key string is then run through SHA1. Don't take that as 
&gt; gospel, though. I searched my mailing list archive and couldn't find it, but 
&gt; this also could have happened on the IRC channel. Hopefully someone who knows 
&gt; the source can point you in the right direction.
&gt; 
&gt; Until then, you can safely assume that the hashed key is the result of 
&gt; SHA1(bucket\_name + key\_name). You should be able to determine if they're on 
&gt; the same node by hashing both bucket/key combos and then looking at the ring. 
&gt; Take a look at 
&gt; http://wiki.basho.com/Replication.html#Routing-an-object-to-a-set-of-partitions
&gt; for more info on looking at the state of the ring.
&gt; 
&gt; Jeremiah Peschka
&gt; Microsoft SQL Server MVP
&gt; MCITP: Database Developer, DBA
&gt; 
&gt; 
&gt; On Mon, Jan 10, 2011 at 3:42 AM, 吴磊  wrote:
&gt; Hi, guys
&gt; 
&gt; I'm a newbie to Riak, I have the question. Will the objects, which in
&gt; different buckets but have the same key, be stored in the same vnode
&gt; and be managed by this vnode?
&gt; 
&gt; Best regards,
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

