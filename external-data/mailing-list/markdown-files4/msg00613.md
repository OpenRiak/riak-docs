---
title: "Re: riak stats maintenance?"
description: ""
project: community
lastmod: 2010-06-17T21:42:07-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00613"
mailinglist_parent_id: "msg00612"
author_name: "Gareth Stokes"
project_section: "mailinglistitem"
sent_date: 2010-06-17T21:42:07-07:00
---


Hey Dan,

Sounds like i do need to check some things then.

The load balancer does a health check every 30 seconds.
Going through the monitor logs, the cpu was peaking up to about 60% which im
not too sure if was caused by load or by the riak process doing whatever it
was doing.

And, I do seem to be running pretty high on memory so ill see if i can lower
that by configuring the buffer size on the innostore backend.

If i see it happening again, ill try and gather more information.

gs

On 18 June 2010 14:15, Dan Reverri  wrote:

&gt; Hi Gareth,
&gt;
&gt; I'm not aware of any mechanism that turns the stats url off for any reason.
&gt; How often are you pinging the stats url? Do the timeouts correlate with any
&gt; other event on the system (higher load, cron job, etc.)?
&gt;
&gt; Thanks,
&gt; Dan
&gt;
&gt; Daniel Reverri
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; d...@basho.com
&gt;
&gt;
&gt; On Thu, Jun 17, 2010 at 8:40 PM, Gareth Stokes  &gt; wrote:
&gt;
&gt;&gt; hey guys,
&gt;&gt;
&gt;&gt; so i have a cluster of 4 physical machines with a load balancer sitting in
&gt;&gt; front to handle requests going into riak.
&gt;&gt; i thought it would be a good idea (not anymore) to use the /stats url to
&gt;&gt; ping the machines the cluster for their health. this is what i've noticed in
&gt;&gt; the logs every few days or so
&gt;&gt;
&gt;&gt; =ERROR REPORT==== 16-Jun-2010::03:48:37 ===
&gt;&gt; webmachine error: path="/stats"
&gt;&gt; {error,{exit,{timeout,{gen\_server2,call,[riak\_kv\_stat,get\_stats]}},
&gt;&gt; [{gen\_server2,call,2},
&gt;&gt; {riak\_kv\_wm\_stats,get\_stats,0},
&gt;&gt; {riak\_kv\_wm\_stats,produce\_body,2},
&gt;&gt; {webmachine\_resource,resource\_call,3},
&gt;&gt; {webmachine\_resource,do,3},
&gt;&gt; {webmachine\_decision\_core,resource\_call,1},
&gt;&gt; {webmachine\_decision\_core,decision,1},
&gt;&gt; {webmachine\_decision\_core,handle\_request,2}]}}
&gt;&gt;
&gt;&gt; it lasts anywhere between 5 - 40 minutes.
&gt;&gt; what im thinking is that a riak machine will enter "maintenance" mode
&gt;&gt; every now and then, when it does it turns the /stats url off.
&gt;&gt;
&gt;&gt; am i correct in thinking this, or should i be worried?
&gt;&gt;
&gt;&gt; regards,
&gt;&gt; gareth stokes
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

