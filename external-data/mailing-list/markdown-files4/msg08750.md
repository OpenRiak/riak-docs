---
title: "Re: read-modify-write via python client"
description: ""
project: community
lastmod: 2012-09-28T21:28:11-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08750"
mailinglist_parent_id: "msg08749"
author_name: "Michael Clemmons"
project_section: "mailinglistitem"
sent_date: 2012-09-28T21:28:11-07:00
---


David,
The way you're doing it is correct. As far as I can tell populate is
mostly meant for internal use similar to set\_siblings which has this
comment in the code

 Set the array of siblings - used internally

Not sure why they arnt using the convention of setting internal methods
with \_ but \*shrugs\*.
-Michael

On Fri, Sep 28, 2012 at 7:23 PM, David Lowell  wrote:

&gt; Hi folks,
&gt;
&gt; Simple question here. Based on the python client documentation, I'm
&gt; unclear on the canonical means to perform in python a read-modify-write
&gt; cycle on an object stored in Riak.
&gt;
&gt; What seems intuitive to me:
&gt;
&gt; obj = kv.bucket(b).get(name)
&gt; if f.exists():
&gt; data = f.get\_data()
&gt; # todo: check for siblings, and resolve
&gt; else:
&gt; data = {'my\_list': []}
&gt; data['my\_list'].append(something)
&gt;
&gt; obj.set\_data(data)
&gt; obj.store()
&gt;
&gt; My assumption here is that the RiakObject 'obj' has internally kept the
&gt; vector clock for this key, and when this update gets stored, it will do the
&gt; right thing. However, the documentation doesn't say that's what will
&gt; happen. In fact, I can't find anything in the documentation that makes it
&gt; clear how to do this read-modify-write.
&gt;
&gt; There is this piece of documentation for the python client API:
&gt;
&gt; | populate(self, Result)
&gt; | Populate the object based on the return from get.
&gt; |
&gt; | If None returned, then object is not found
&gt; | If a tuple of vclock, contents then one or more
&gt; | whole revisions of the key were found
&gt; | If a list of vtags is returned there are multiple
&gt; | sibling that need to be retrieved with get.
&gt;
&gt; This is obviously not very clear. This sounds like it has something to do
&gt; with read-modify-write, but who knows.
&gt;
&gt; So, is my intuition in the code above correct? Or should we write back a
&gt; modified object through some other means like populate()?
&gt;
&gt; Thanks for the guidance,
&gt;
&gt; Dave
&gt;
&gt; --
&gt; Dave Lowell
&gt; d...@connectv.com
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;



-- 
-Michael
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

