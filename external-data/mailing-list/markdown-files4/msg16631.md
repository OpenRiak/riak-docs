---
title: "Re: riak health check"
description: ""
project: community
lastmod: 2015-10-08T02:27:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16631"
mailinglist_parent_id: "msg16630"
author_name: "Sargun Dhillon"
project_section: "mailinglistitem"
sent_date: 2015-10-08T02:27:57-07:00
---


It's possible that during the strongly consistent joined, there was some
leader instability. Do you have any logs of the event? Can you recreate the
event? Also, the recommendation for SC, is to either turn off tree
verification, or run with 7 nodes, and n=5.

On Thu, Oct 8, 2015 at 2:23 AM, Ali Rıza KELEŞ 
wrote:

&gt; Hi,
&gt;
&gt; I have a riak cluster of 5 nodes, runinng strong consistent and behind
&gt; an HaProxy. Yesterday I needed to replace a node which was misplaced.
&gt; I removed the node and all was OK. Other nodes responded all requests
&gt; properly and my application continued to run well.
&gt;
&gt; I created a new node and make it join the cluster. Application logged
&gt; some riak errors for 10 or 15 seconds, just after re-clustering. After
&gt; this period of errors, everything was OK again.
&gt;
&gt; I have an idea why I encountered this stiuation but i am not sure.
&gt; HaProxy health checks got OK from the new node, unless it wasn't ready
&gt; or even it wasn't a member of riak cluster. And some requests
&gt; redirected by haproxy to this new alive node.
&gt;
&gt; If this scenario is correct, then i need to make haproxy more clever
&gt; by tuning health check. "option httpchk GET /ping" is not enough to
&gt; identify a node is really ready for requests. Is there any fine tuned
&gt; way to achieve this.
&gt;
&gt; Thanks for any suggestions.
&gt;
&gt; --
&gt; --
&gt; Ali Rıza Keleş
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

