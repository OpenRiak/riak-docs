---
title: "Re: Using $bucket index for listing keys"
description: ""
project: community
lastmod: 2016-03-11T05:23:12-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17145"
mailinglist_parent_id: "msg17144"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2016-03-11T05:23:12-08:00
---


That seems very wrong. Can you do me a favour and try with a larger 
max\_results. I remember a bug with small results set, I thought it was fixed, 
I’m looking into the past issues, but can you try “max\_results=1000” or 
something, and let me know what you see?

On 11 Mar 2016, at 13:03, Oleksiy Krivoshey  wrote:

&gt; Here it is without the `value` part of request:
&gt; 
&gt; curl 
&gt; 'http://127.0.0.1:8098/types/fs\_chunks/buckets/0r0e5wahrhsgpolk9stbnrqmp77fjjye.chunks/index/$bucket/\_?max\_results=10&continuation=g20AAAAja1AzdzJwOXpYcVoyb0F4NDhTMVNnRUpBbGJ0ZkhVdkk6MjU='
&gt; 
&gt; {"keys":["4rpG2PwRTs3YqasGGYrhACBvZqTg7mQW:0","4rpG2PwRTs3YqasGGYrhACBvZqTg7mQW:2","FSEky50kr2TLkBuo1JKv6sphINYwnJfV:1","F3KcwtjG9VAtM5u8vbwBuCjuGBrPTnfq:0","RToMNlsnVKvXcawQK6BGnCAKx58pC9xX:1","UMiHx4qDR5pHWT9OgLAu1KMlFeEKbISm:0","F3KcwtjG9VAtM5u8vbwBuCjuGBrPTnfq:2","YQlRWkJPFYiLlAwhvgqOysJC3ycmQ9OA:0","kP3w2p9zXqZ2oAx48S1SgEJAlbtfHUvI:15","kP3w2p9zXqZ2oAx48S1SgEJAlbtfHUvI:25"],"continuation":"g20AAAAja1AzdzJwOXpYcVoyb0F4NDhTMVNnRUpBbGJ0ZkhVdkk6MjU="}
&gt; 
&gt; On 11 March 2016 at 14:58, Oleksiy Krivoshey  wrote:
&gt; I'm actually using PB interface, but I can replicate the problem with HTTP as 
&gt; in my previous email. Request with '&continuation=AAAA' returns the result 
&gt; set with the same continuation AAAA. 
&gt; 
&gt; On 11 March 2016 at 14:55, Magnus Kessler  wrote:
&gt; Hi Oleksiy,
&gt; 
&gt; How are you performing your 2i-based key listing? Querying with pagination as 
&gt; shown in the documentation[0] should work.
&gt; 
&gt; As an example here is the HTTP invocation:
&gt; 
&gt; curl 
&gt; "https://localhost:8098/types/default/buckets/test/index/\$bucket/\_?max\_results=10&continuation=g20AAAACNTM="
&gt; 
&gt; Once the end of the key list is reached, the server returns an empty keys 
&gt; list and no further continuation value.
&gt; 
&gt; Please let me know if this works for you.
&gt; 
&gt; Kind Regards,
&gt; 
&gt; Magnus
&gt; 
&gt; 
&gt; [0]: http://docs.basho.com/riak/latest/dev/using/2i/#Querying
&gt; 
&gt; On 11 March 2016 at 10:06, Oleksiy Krivoshey  wrote:
&gt; Anyone?
&gt; 
&gt; On 4 March 2016 at 19:11, Oleksiy Krivoshey  wrote:
&gt; I have a bucket with ~200 keys in it and I wanted to iterate them with the 
&gt; help of $bucket index and 2i request, however I'm facing the recursive 
&gt; behaviour, for example I send the following 2i request:
&gt; 
&gt; { 
&gt; bucket: 'BUCKET\_NAME', 
&gt; type: 'BUCKET\_TYPE', 
&gt; index: '$bucket', 
&gt; key: 'BUCKET\_NAME', 
&gt; qtype: 0, 
&gt; max\_results: 10, 
&gt; continuation: 'AAAA'
&gt; }
&gt; 
&gt; I receive 10 keys and continuation 'BBBB', I then repeat the request with 
&gt; continuation 'BBBB' and at this point I can receive a reply with continuation 
&gt; 'CCCC' or 'AAAA' or even 'BBBB' and its going in never ending recursion. 
&gt; 
&gt; I'm running this on a 5 node 2.1.3 cluster.
&gt; 
&gt; What I'm doing wrong? Or is this not supported at all?
&gt; 
&gt; Thanks!
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Magnus Kessler
&gt; Client Services Engineer
&gt; Basho Technologies Limited
&gt; 
&gt; Registered Office - 8 Lincoln’s Inn Fields London WC2A 3BP Reg 07970431
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

