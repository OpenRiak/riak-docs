---
title: "Re: Running multiple Riak instances."
description: ""
project: community
lastmod: 2010-07-25T13:58:06-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00787"
mailinglist_parent_id: "msg00786"
author_name: "Misha Gorodnitzky"
project_section: "mailinglistitem"
sent_date: 2010-07-25T13:58:06-07:00
---


Ya, I changed that in my vm.staging.args config file. However, in the
process list I see these two processes:

 /usr/lib/riak/erts-5.7.5/bin/run\_erl -daemon /var/run/riak-staging/
/var/log/riak-staging exec /usr/sbin/riak console -
 /usr/lib/riak/erts-5.7.5/bin/beam.smp -K true -A 5 -- -root
/usr/lib/riak -progname riak -- -home /var/lib/riak -- -boot
/usr/lib/riak/releases/0.12.0/riak -embedded -config
/etc/riak/app.staging.config -name riak\_stag...@127.0.0.1 -setcookie
riak-staging -home /var/lib/riak-staging -- console -

The second one being a child to the first. I can see that the -name is
being set there, what worries me is that -progname is 'riak', I'm not
sure if that needs to be unique or not, or how to change it.


--M

On 25 July 2010 17:29, Grant Schofield  wrote:
&gt; Does the second vm.args have the same -name setting as the first node? Each 
&gt; node will need to have a unique name configured.
&gt;
&gt; Grant Schofield
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt;
&gt;
&gt; On Jul 25, 2010, at 9:00 AM, Misha Gorodnitzky wrote:
&gt;
&gt;&gt; Hi all,
&gt;&gt;
&gt;&gt; I'm trying to run multiple instances of Riak on my server with the
&gt;&gt; goal to run both the staging environment and eventually the production
&gt;&gt; environment on the same server (I only have one for this project).
&gt;&gt; This is an Ubuntu server and if at all possible I'd prefer not to
&gt;&gt; build Riak from source, although I understand that it would be easier
&gt;&gt; to have multiple instances running that way. I would rather keep
&gt;&gt; software managed with the package manager here.
&gt;&gt;
&gt;&gt; What I've done is I've modified /usr/sbin/riak to allow specifying the
&gt;&gt; config files to use (app.config, vm.args), the log dir, run dir (for
&gt;&gt; the pipe) and the home dir, and I can startup an instance of Riak
&gt;&gt; using my "staging" environment. However, when I try to start up the
&gt;&gt; second Riak instance, it fails with just a couple of things
&gt;&gt; out-of-the-ordinary in it's logs:
&gt;&gt;
&gt;&gt;  =INFO REPORT==== 25-Jul-2010::13:54:35 ===
&gt;&gt;      application: riak\_kv
&gt;&gt;      exited: {shutdown,{riak\_kv\_app,start,[normal,[]]}}
&gt;&gt;      type: permanent
&gt;&gt;  =INFO REPORT==== 25-Jul-2010::13:54:35 ===
&gt;&gt;      alarm\_handler: {clear,system\_memory\_high\_watermark}
&gt;&gt;  {"Kernel pid 
&gt;&gt; terminated",application\_controller,"{application\_start\_failure,riak\_kv,{shutdown,{riak\_kv\_app,start,[normal,[]]}}}"}^M
&gt;&gt;  Kernel pid terminated (application\_controller)
&gt;&gt; ({application\_start\_failure,riak\_kv,{shutdown,{riak\_kv\_app,start,[normal,[]]}}})^M
&gt;&gt;
&gt;&gt; And the Riak process that's already running logs this:
&gt;&gt;
&gt;&gt;  \*\* Connection attempt from disallowed node 'riak\_stag...@127.0.0.1' \*\*
&gt;&gt;
&gt;&gt; Any ideas what this might be? Has anyone managed to do this using the
&gt;&gt; Riak .deb package?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; --Misha
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

