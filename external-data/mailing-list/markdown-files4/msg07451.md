---
title: "Re: Riak Overload Behavior"
description: ""
project: community
lastmod: 2012-05-14T16:56:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07451"
mailinglist_parent_id: "msg07450"
author_name: "Sean O'Connor"
project_section: "mailinglistitem"
sent_date: 2012-05-14T16:56:56-07:00
---


Interesting. I am running Riak 1.1.2 and I am making the requests via version 
1.4.0 of the python client using the HTTP transport class. I'll see if I can 
create a simple script that replicates the problem and post it to the list 
sometime later tonight or tomorrow.

-- 
Sean O'Connor
Co-Founder/CTO

FocusLab (http://www.focuslab.io)
(845)669-0883


On Monday, May 14, 2012 at 7:48 PM, Sean Cribbs wrote:

&gt; Hi Sean,
&gt; 
&gt; Are you running your test suite against 1.1.x? We have seen 400 errors in the 
&gt; past where the client in a keep-alive connection emitted additional CRLFs or 
&gt; other whitespace beyond the ones required for the request. The next time a 
&gt; request was made, the 400 error was already on the wire because the HTTP 
&gt; parser failed to recognize the (non-existent) request in the additional 
&gt; whitespace. This error should be fixed already in 1.1.x. 
&gt; 
&gt; On Mon, May 14, 2012 at 5:45 PM, Sean O'Connor  (mailto:s...@focuslab.io)&gt; wrote:
&gt; &gt; Hello, 
&gt; &gt; 
&gt; &gt; I've been seeing some strange behavior from Riak and any help or feedback 
&gt; &gt; would be very welcome.
&gt; &gt; 
&gt; &gt; In particular, we've been seeing pseudo-radom 400 errors from Riak when we 
&gt; &gt; run our test suite. Our test suite hits riak pretty hard to test various 
&gt; &gt; queries and situations in our app and the errors seem to happen a few 
&gt; &gt; seconds after the CPUs on the testing machine get saturated. I say 
&gt; &gt; psuodo-random as the errors tends to happen in a particularly riak heavy 
&gt; &gt; portion of our test suite but the specific call to riak that errors is 
&gt; &gt; often different (reads, writes, map/reduce jobs, 2i queries). The thing 
&gt; &gt; that is really baffling about these errors is there doesn't seem to be any 
&gt; &gt; information attached other than the 400 message and nothing shows up in any 
&gt; &gt; of the riak logs. 
&gt; &gt; 
&gt; &gt; If we introduce a 2 second delay between tests in our test suite, the 
&gt; &gt; problem goes away but obviously slows down our test suite quite a bit. 
&gt; &gt; Aside from that, I am concerned about this potentially happening in our 
&gt; &gt; production cluster. 
&gt; &gt; 
&gt; &gt; Is this more or less the expected behavior of Riak when it gets overwhelmed 
&gt; &gt; or does it sound like there is something that should be investigated 
&gt; &gt; further here? I suspect that I can create a script to replicate the 
&gt; &gt; problem but if this is somewhat expected then I won't waste the time 
&gt; &gt; writing it. 
&gt; &gt; 
&gt; &gt; Thanks! 
&gt; &gt; 
&gt; &gt; -- 
&gt; &gt; Sean O'Connor
&gt; &gt; Co-Founder/CTO
&gt; &gt; 
&gt; &gt; FocusLab (http://www.focuslab.io)
&gt; &gt; (845)669-0883 (tel:%28845%29669-0883) 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt; 
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Sean Cribbs 
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

