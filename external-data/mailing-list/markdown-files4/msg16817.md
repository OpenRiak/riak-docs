---
title: "Re: Memory Errors when using RiakCS"
description: ""
project: community
lastmod: 2015-11-25T11:31:18-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16817"
mailinglist_parent_id: "msg16809"
author_name: "Ben Rudolph"
project_section: "mailinglistitem"
sent_date: 2015-11-25T11:31:18-08:00
---


Thanks Kota, this is a great resource.

On Wed, Nov 25, 2015 at 4:24 AM, Kota Uenishi  wrote:

&gt; Hi Ben,
&gt; The memory size of your nodes looks rather small. I wrote a section
&gt; for such environment to design right configurations. Hope you could
&gt; take a look.
&gt;
&gt;
&gt; https://github.com/basho/riak\_cs/blob/develop/RELEASE-NOTES.md#upgrading-riak---step-3-review-memory-size
&gt;
&gt; On Tue, Nov 24, 2015 at 3:30 AM, Ben Rudolph  wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; We've been trying to setup RiakCS for storing files on our website,
&gt; &gt; http://commcarehq.org/. It's been difficult for us to deploy because
&gt; we've
&gt; &gt; been having issues with our servers not being able to start Riak due to
&gt; &gt; memory errors. Here's what a traceback looks like when I try and start
&gt; Riak
&gt; &gt; with `riak-console`:
&gt; &gt;
&gt; &gt;&gt; config is OK
&gt; &gt;&gt; -config
&gt; /var/lib/riak-cs/generated.configs/app.2015.11.23.18.11.17.config
&gt; &gt;&gt; -args\_file
&gt; /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
&gt; &gt;&gt; -vm\_args /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
&gt; &gt;&gt; Exec: /usr/lib/riak-cs/erts-5.10.3/bin/erlexec -boot
&gt; &gt;&gt; /usr/lib/riak-cs/releases/2.0.1/riak-cs -config
&gt; &gt;&gt; /var/lib/riak-cs/generated.configs/app.2015.11.23.18.11.17.config
&gt; -args\_file
&gt; &gt;&gt; /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args -vm\_args
&gt; &gt;&gt; /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
&gt; &gt;&gt; -pa /usr/lib/riak-cs/lib/basho-patches -- console
&gt; &gt;&gt; Root: /usr/lib/riak-cs
&gt; &gt;&gt; Erlang R16B02\_basho8 (erts-5.10.3) [source] [64-bit] [smp:8:8]
&gt; &gt;&gt; [async-threads:64] [kernel-poll:true] [frame-pointer]
&gt; &gt;&gt;
&gt; &gt;&gt; =INFO REPORT==== 23-Nov-2015::18:11:18 ===
&gt; &gt;&gt; alarm\_handler: {set,{system\_memory\_high\_watermark,[]}}
&gt; &gt;&gt; =INFO REPORT==== 23-Nov-2015::18:11:18 ===
&gt; &gt;&gt; opening log file: "/var/log/riak-cs/access.log.2015\_11\_23\_18"
&gt; &gt;&gt; Eshell V5.10.3 (abort with ^G)
&gt; &gt;&gt; (\*\*)1&gt; [os\_mon] memory supervisor port (memsup): Erlang has closed
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt; The machines we are trying to deploy to have 8GB of RAM and also running
&gt; a
&gt; &gt; few other services, but have 3-4GB of RAM available. Are there any
&gt; &gt; configuration params we can use so it consumes less memory? I've taken a
&gt; &gt; look at the `system\_memory\_high\_watermark` which is the error we see
&gt; &gt; (http://docs.basho.com/riak/latest/ops/running/recovery/errors/). Our
&gt; &gt; configs can be found here in case that's useful:
&gt; &gt;
&gt; &gt;
&gt; https://github.com/dimagi/commcarehq-ansible/tree/riak/ansible/roles/riakcs/templates
&gt; &gt;
&gt; &gt; Any insight would be useful! Thank you!
&gt; &gt;
&gt; &gt; Ben
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Kota UENISHI / @kuenishi
&gt; Basho Japan KK
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

