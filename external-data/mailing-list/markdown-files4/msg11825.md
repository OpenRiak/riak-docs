---
title: "Re: setting ACL in a put request, riak cs 1.3.1-1"
description: ""
project: community
lastmod: 2013-07-30T18:43:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11825"
mailinglist_parent_id: "msg11801"
author_name: "Kota Uenishi"
project_section: "mailinglistitem"
sent_date: 2013-07-30T18:43:13-07:00
---


Eugene,

Congratulations, and thank you! You have found a bug X'(
Could you open an issue on github issues[1] ? Your report is very nice
and sufficient so just copy and pasting your mail will work. We will
be working on that.

[1] https://github.com/basho/riak\_cs

Cheers,
Kota

On Mon, Jul 29, 2013 at 11:47 AM, Eugene Doudine  wrote:
&gt; Greetings,
&gt;
&gt; I'm trying to set object ACL in the put request using the
&gt; x-amz-grant-\* headers as described in the docs:
&gt; http://docs.basho.com/riakcs/latest/references/apis/storage/RiakCS-PUT-Object/
&gt;
&gt; The server creates objects, but neither sets the ACL nor
&gt; returns any warnings or errors.
&gt;
&gt; Setting same ACL in a separate request (PUT /test1.txt?acl=) works as
&gt; expected.
&gt;
&gt; Is this a bug, or not yet implemented or I simply miss something?
&gt; I'm pretty new to Riak-CS and the cloud API's.
&gt;
&gt; Thanks!
&gt;
&gt; Here is dump of the put request and server's responce :
&gt;
&gt; PUT /test1.txt HTTP/1.1
&gt; Host: bucketsys1.localhost.localhost:8080
&gt; x-amz-grant-full-control: emailAddress="sys1@localhost"
&gt; x-amz-meta-testkey1: testvar1
&gt; Authorization: AWS \_BZLP5L3UTR\_UYZRDZY6:xNSHzb7VUlHothQx+e1dTYjN0HU=
&gt; Date: Mon, 29 Jul 2013 02:30:49 GMT
&gt; Content-MD5: 65wr8Otj86e8DqN+8YrrpQ==
&gt; User-Agent: aws-sdk-java/1.4.5 Linux/3.2.0-48-generic
&gt; Java\_HotSpot(TM)\_Server\_VM/19.1-b02
&gt; x-amz-grant-write: emailAddress="sys3@localhost"
&gt; x-amz-meta-test-key2: testval2
&gt; Content-Type: application/json
&gt; x-amz-grant-read: emailAddress="sys2@localhost"
&gt; Content-Length: 13
&gt; Connection: Keep-Alive
&gt; Expect: 100-continue
&gt;
&gt; HTTP/1.1 100 Continue
&gt;
&gt; some content
&gt; HTTP/1.1 200 OK
&gt; Server: Riak CS
&gt; ETag: "eb9c2bf0eb63f3a7bc0ea37ef18aeba5"
&gt; Date: Mon, 29 Jul 2013 02:30:50 GMT
&gt; Content-Type: text/plain
&gt; Content-Length: 0
&gt;
&gt;
&gt; Here is info on the created object as given by s3cmd, only
&gt; owners has the requested rights:
&gt;
&gt; s3://bucketsys1.localhost/test1.txt (object):
&gt; File size: 13
&gt; Last mod: Mon, 29 Jul 2013 02:30:50 GMT
&gt; MIME type: application/json
&gt; MD5 sum: eb9c2bf0eb63f3a7bc0ea37ef18aeba5
&gt; policy: none
&gt; ACL: sys1: FULL\_CONTROL
&gt;
&gt;
&gt; Here is the separate acl modification request which works as expected:
&gt;
&gt;
&gt; PUT /test1.txt?acl= HTTP/1.1
&gt; Host: bucketsys1.localhost.localhost:8080
&gt; Authorization: AWS \_BZLP5L3UTR\_UYZRDZY6:aLXe+A5bQFIft2ELJLLWob0AAAE=
&gt; Date: Mon, 29 Jul 2013 02:33:27 GMT
&gt; User-Agent: aws-sdk-java/1.4.5 Linux/3.2.0-48-generic
&gt; Java\_HotSpot(TM)\_Server\_VM/19.1-b02
&gt; Content-Type: text/plain
&gt; Content-Length: 793
&gt; Connection: Keep-Alive
&gt; Expect: 100-continue
&gt;
&gt; HTTP/1.1 100 Continue
&gt;
&gt;  xmlns="http://s3.amazonaws.com/doc/2006-03-01/"&gt;\_BZLP5L3UTR\_UYZRDZY6sys1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
&gt; xsi:type="AmazonCustomerByEmail"&gt;sys1@localhostFULL\_CONTROL xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
&gt; xsi:type="AmazonCustomerByEmail"&gt;sys3@localhostWRITE xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
&gt; xsi:type="AmazonCustomerByEmail"&gt;sys2@localhostREAD
&gt;
&gt; HTTP/1.1 200 OK
&gt; Server: Riak CS
&gt; Date: Mon, 29 Jul 2013 02:33:27 GMT
&gt; Content-Type: text/plain
&gt; Content-Length: 0
&gt;
&gt; Now the object has the requested ACL:
&gt;
&gt; s3://bucketsys1.localhost/test1.txt (object):
&gt; File size: 13
&gt; Last mod: Mon, 29 Jul 2013 02:30:50 GMT
&gt; MIME type: application/json
&gt; MD5 sum: eb9c2bf0eb63f3a7bc0ea37ef18aeba5
&gt; policy: none
&gt; ACL: sys1: FULL\_CONTROL
&gt; ACL: sys3: WRITE
&gt; ACL: sys2: READ
&gt;
&gt;
&gt; Regards,
&gt; Eugene
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;



-- 
Kota UENISHI / @kuenishi
Basho Japan KK

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

