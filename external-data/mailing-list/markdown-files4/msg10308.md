---
title: "Re: Multiple writes to same key/value"
description: ""
project: community
lastmod: 2013-03-03T07:56:00-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10308"
mailinglist_parent_id: "msg10306"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2013-03-03T07:56:00-08:00
---


Hi Jimmy,

Sorry for taking this off-list; I meant to reply-all on that message!
Anyway, we do have a work-in-progress CRDT integration and we hope to
have it production-ready later this year.

On Sun, Mar 3, 2013 at 9:02 AM, Jimmy Ho  wrote:
&gt; Hi Sean,
&gt;
&gt; Thanks for the quick response.
&gt; All makes good sense.
&gt;
&gt; Am using python, found this on git hub which seems to do what I need (will
&gt; need to test it further)
&gt;
&gt; https://github.com/ericmoritz/riak\_crdt
&gt;
&gt; Any future plans to built CRDT features into Riak, or is it something
&gt; believed to sit more at the client side to implement merging/conflict
&gt; resolution?
&gt;
&gt; Thanks for the help.
&gt; Regards,
&gt; Jimmy
&gt;
&gt; On Sat, Mar 2, 2013 at 8:57 PM, Sean Cribbs  wrote:
&gt;&gt;
&gt;&gt; Jimmy,
&gt;&gt;
&gt;&gt; Links are going to quickly become difficult to manage.
&gt;&gt;
&gt;&gt; This is the perfect problem for a CRDT, probably an OR-set. The nice
&gt;&gt; thing about CRDTs is that even when multiple writers are involved,
&gt;&gt; there's a single way to merge conflicts which always moves toward the
&gt;&gt; real value (monotonic). When someone clicks the "like button", you
&gt;&gt; would add their user ID to the set. (Assuming they can un-like, you
&gt;&gt; would remove them from the set when they do that.) You would probably
&gt;&gt; do something similar for the other direction, the user's list of post
&gt;&gt; -- but is easy to manage from the concurrent-writes standpoint, since
&gt;&gt; a user is probably the only one modifying that. If you never need to
&gt;&gt; "un-like", then the set only grows and is thus simpler to put
&gt;&gt; together.
&gt;&gt;
&gt;&gt; Unfortunately, the CRDT support built into Riak is somewhat limited
&gt;&gt; right now. You would need to implement the convergent set yourself, or
&gt;&gt; use an existing client-side library. Here are a few:
&gt;&gt;
&gt;&gt; \* Knockbox (Clojure) https://github.com/reiddraper/knockbox
&gt;&gt; \* Statebox (Erlang) https://github.com/mochi/statebox
&gt;&gt;
&gt;&gt; A quick search on Github will find you a lot of other options, too (in
&gt;&gt; various states of completion).
&gt;&gt;
&gt;&gt; On Sat, Mar 2, 2013 at 2:10 PM, Jimmy Ho  wrote:
&gt;&gt; &gt; Hi guys,
&gt;&gt; &gt;
&gt;&gt; &gt; Am currently designing the data schema for an application; I have a
&gt;&gt; &gt; question
&gt;&gt; &gt; hoping some of you could help. Thanks in advance.
&gt;&gt; &gt;
&gt;&gt; &gt; One of the functionalities is a 'like button' to posts
&gt;&gt; &gt;
&gt;&gt; &gt; Each post is stored as an object in Riak, eg /post/
&gt;&gt; &gt;
&gt;&gt; &gt; To like a post, I am planning on creating a link from user object to the
&gt;&gt; &gt; post object, and the reverse direction, such that it would be easier to
&gt;&gt; &gt; link-walk/mapreduce.
&gt;&gt; &gt;
&gt;&gt; &gt; My question is, if a particular post is very very popular, and everyone
&gt;&gt; &gt; is
&gt;&gt; &gt; pressing 'like'. Would the write requests (to the post's object
&gt;&gt; &gt; header)
&gt;&gt; &gt; conflict each other?
&gt;&gt; &gt;
&gt;&gt; &gt; Is the above a bad schema design from that perspective? Any suggestion
&gt;&gt; &gt; of a
&gt;&gt; &gt; better design?
&gt;&gt; &gt;
&gt;&gt; &gt; Thanks.
&gt;&gt; &gt; Regards, Jimmy
&gt;&gt; &gt;
&gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sean Cribbs 
&gt;&gt; Software Engineer
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;
&gt;



-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

