---
title: "PB problems with 1.0.0"
description: ""
project: community
lastmod: 2011-10-13T12:37:51-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05150"
author_name: "Peter Fales"
project_section: "mailinglistitem"
sent_date: 2011-10-13T12:37:51-07:00
---


Trying to upgrade from 0.14.1 to 1.0.0...

This python program works with 0.14.1:

====================================================================
 import riak
 client = riak.RiakClient(port=XXXX, host="YYYY.ZZZZ", 
transport\_class=riak.RiakPbcTransport)
 test\_bucket = client.bucket('test')
 x=test\_bucket.new('0-0-0','hello6')
 x.store()
====================================================================
However, with the server running 1.0.0, I get:

====================================================================
Traceback (most recent call last):
 File "./bench/client.py", line 6, in 
 x.store()
 File 
"/usr/lib/python2.7/site-packages/riak-1.2.2-py2.7.egg/riak/riak\_object.py", 
line 296, in store
 Result = t.put(self, w, dw, return\_body)
 File 
"/usr/lib/python2.7/site-packages/riak-1.2.2-py2.7.egg/riak/transports/pbc.py", 
line 188, in put
 msg\_code, resp = self.recv\_msg()
 File 
"/usr/lib/python2.7/site-packages/riak-1.2.2-py2.7.egg/riak/transports/pbc.py", 
line 357, in recv\_msg
 self.recv\_pkt()
 File 
"/usr/lib/python2.7/site-packages/riak-1.2.2-py2.7.egg/riak/transports/pbc.py", 
line 401, in recv\_pkt
 format(nmsglen))
riak.RiakError: 'Socket returned short packet length - expected 4'
====================================================================

When this happens, console.logg gets:

2011-10-13 15:52:41.920 [error] &lt;0.17823.0&gt; CRASH REPORT Process &lt;0.17823.0&gt; 
with 0 neighbours crashed with reason: call to undefined function 
protobuffs:next\_field\_num(&lt;&lt;10,4,116,101,115,116,18,5,48,45,48,45,48,34,28,10,8,34,104,101,108,108,111,54,34,18,16,97,112...&gt;&gt;)


Both 0.14.1 and 1.0.0 work with the HTTP interface, but I want to use
the PB interface. 

I suspect I'm just missing something simple, but I haven't been puzzling
over this for some time and haven't been able to find anything yet!


-- 
Peter Fales
Alcatel-Lucent
Member of Technical Staff
1960 Lucent Lane
Room: 9H-505
Naperville, IL 60566-7033
Email: peter.fa...@alcatel-lucent.com
Phone: 630 979 8031

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

