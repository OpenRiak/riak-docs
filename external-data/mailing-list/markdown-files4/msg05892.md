---
title: "Re: Why is the data lost in luwak"
description: ""
project: community
lastmod: 2011-12-07T22:14:00-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05892"
mailinglist_parent_id: "msg05891"
author_name: "vuleetu"
project_section: "mailinglistitem"
sent_date: 2011-12-07T22:14:00-08:00
---


On Thu, Dec 8, 2011 at 1:57 PM, Kelly McLaughlin  wrote:
&gt; Fisher,
&gt;
&gt; You need to call luwak\_put\_stream:close(Ps) to force the flush. That should
&gt; get it for you. Cheers.
&gt;
&gt; Kelly

Hi, Kelly

 RiakNode = 'riak@127.0.0.1'.
 {ok, Riak} = riak:client\_connect(RiakNode).
 {ok, RiakFile} = luwak\_file:create(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;, dict:new()).
 Ps = luwak\_put\_stream:start(Riak, RiakFile, 0, 1000000).
 luwak\_put\_stream:send(Ps, &lt;&lt;"1234"&gt;&gt;).
 luwak\_put\_stream:flush(Ps).
 {ok, RiakFile2} = luwak\_file:get(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;).
 luwak\_file:length(Riak, RiakFile2). %% Length is 4
 luwak\_put\_stream:send(Ps, &lt;&lt;"56789"&gt;&gt;).
 luwak\_put\_stream:close(Ps).
 {ok, RiakFile3} = luwak\_file:get(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;).
 luwak\_file:length(Riak, RiakFile3). %% Length still 13


 After i call close(), I still get the unexpected size(13bytes), is
this the expected behavior? Can I not call flush() manually on a
stream?

 this is the version info:
 luwak-1.1.0
 riak\_core-1.0.0 riak\_kv-1.0.0 riak\_pipe-1.0.0
 riak\_search-1.0.0 riak\_sysmon-1.0.0 riakc-1.2.0

Thanks,

Fisher


&gt;
&gt; On Dec 7, 2011, at 10:05 PM, vuleetu wrote:
&gt;
&gt; luwak\_put\_stream:send(Ps, &lt;&lt;"56789"&gt;&gt;).
&gt; luwak\_put\_stream:flush(Ps).
&gt; {ok, RiakFile3} = luwak\_file:get(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;).
&gt; luwak\_file:length(Riak, RiakFile3).
&gt;
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

