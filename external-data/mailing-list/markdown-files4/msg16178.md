---
title: "Re: Riak Search 2.0 & Tagging"
description: ""
project: community
lastmod: 2015-06-02T15:04:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16178"
mailinglist_parent_id: "msg15989"
author_name: "Antonio Teixeira"
project_section: "mailinglistitem"
sent_date: 2015-06-02T15:04:55-07:00
---


Hi Zee,

Sorry for the extremely late response and I would to say , I'm highly
thankful for your time.

Antonio

2015-04-07 18:29 GMT+01:00 Zeeshan Lakhani :

&gt; Hello Antonio,
&gt;
&gt; Firstly, please always reply to the list and not via personal email.
&gt;
&gt; In regards to your question, I wrote a test that showcases how to write
&gt; objects with tags in pb for search:
&gt; https://github.com/basho/yokozuna/pull/479/files#diff-f9f0e102b2a5208f41b2f304ada0ee5cR306.
&gt; It’s a bit of a workaround, needing the ‘x-riak-meta\*’, which gets stripped
&gt; in preparation for query, but it does work.
&gt;
&gt; Please make sure you’ve also created an index and associated it with a
&gt; bucket\_type/bucket, i.e.
&gt; http://docs.basho.com/riak/latest/dev/using/search/#Simple-Setup. To
&gt; query, it’d be the same as in the docs (field:\*query\*):
&gt; http://docs.basho.com/riak/latest/dev/using/search/#Querying.
&gt;
&gt; Thanks.
&gt;
&gt; Zeeshan Lakhani
&gt; programmer |
&gt; software engineer at @basho |
&gt; org. member/founder of @papers\_we\_love | paperswelove.org
&gt; twitter =&gt; @zeeshanlakhani
&gt;
&gt; On Apr 7, 2015, at 4:28 AM, Antonio Teixeira 
&gt; wrote:
&gt;
&gt; Hi ,
&gt;
&gt; I've been experimenting with with Riak Search and Tags but I've reached a
&gt; dead-end. I can't find any documentation on Querying Tags, I have followed
&gt; your example at:
&gt; https://github.com/basho/riak-erlang-client/blob/7487c90275c88dbe8ef4c2fed6540864364ca3d4/src/riakc\_...
&gt; 
&gt; Here is my Code:
&gt;
&gt; O0 = riakc\_obj:new(&lt;&lt;"test"&gt;&gt;, &lt;&lt;"key0"&gt;&gt;, &lt;&lt;"value0"&gt;&gt;),
&gt; MD0 = riakc\_obj:get\_update\_metadata(O0),
&gt; MD1 = riakc\_obj:set\_user\_metadata\_entry(MD0, {&lt;&lt;"ola\_s"&gt;&gt;,&lt;&lt;"nuno"&gt;&gt;}),
&gt; O1 = riakc\_obj:update\_metadata(O0, MD1),
&gt; ok = riakc\_pb\_socket:put(Pid, O1).
&gt;
&gt; My question is, how do I query this data without knowing the Key of the
&gt; Object.
&gt;
&gt; Regards
&gt; Antonio
&gt;
&gt; 2015-04-02 16:10 GMT+01:00 Zeeshan Lakhani :
&gt;
&gt;&gt; Hello Antonio,
&gt;&gt;
&gt;&gt; You can insert an object and tag in the same operation, and you can query
&gt;&gt; on that tag via Riak Search.
&gt;&gt;
&gt;&gt; Before writing the object, just apply/set the metadata accordingly.
&gt;&gt; Here’s an example in the Erlang client:
&gt;&gt; https://github.com/basho/riak-erlang-client/blob/7487c90275c88dbe8ef4c2fed6540864364ca3d4/src/riakc\_pb\_socket.erl#L3348
&gt;&gt; .
&gt;&gt;
&gt;&gt; Also, this can be done via http:
&gt;&gt; https://github.com/basho/yokozuna/blob/5868266b11f131d14c85495e50f899f3fe8158ba/riak\_test/yokozuna\_essential.erl#L281
&gt;&gt; .
&gt;&gt;
&gt;&gt; Thanks.
&gt;&gt;
&gt;&gt; Zeeshan Lakhani
&gt;&gt; programmer |
&gt;&gt; software engineer at @basho |
&gt;&gt; org. member/founder of @papers\_we\_love | paperswelove.org
&gt;&gt; twitter =&gt; @zeeshanlakhani
&gt;&gt;
&gt;&gt; On Apr 2, 2015, at 5:24 AM, Antonio Teixeira 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt; I've been using Riak as my main database for a few months, now I've been
&gt;&gt; experimenting with Riak Search 2.0 and for what I read in your
&gt;&gt; documentation there is no way to insert a object and tag it in the same
&gt;&gt; operation.
&gt;&gt; Right now we have an opaque object and we query them through secondary
&gt;&gt; indexes, this is becoming unbearable.
&gt;&gt; What we need is to store an object and tag(
&gt;&gt; https://github.com/basho/yokozuna/blob/develop/docs/TAGGING.md) it all
&gt;&gt; in one step.
&gt;&gt; Our objects consist of erlang dictionaries and it would be a bit
&gt;&gt; expensive (performance wise) to convert the Dictionary to a list and then
&gt;&gt; to json in every database related operation.
&gt;&gt; We are using Riak 2.0.5, Erlang 17.0 and the PB Driver.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

