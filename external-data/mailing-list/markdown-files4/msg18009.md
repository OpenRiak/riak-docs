---
title: "Re: Testing netsplit in Riak"
description: ""
project: community
lastmod: 2017-02-22T10:13:59-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18009"
mailinglist_parent_id: "msg18008"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2017-02-22T10:13:59-08:00
---


1. Check the erlang vm variable "nettick", I believe.

2. Hinted handoff resource allocation are configurable via config file or
at runtime.

On Wed, Feb 22, 2017 at 12:07 Andrey Ershov  wrote:

&gt; Hi, guys!
&gt;
&gt; I'm testing netsplit in Riak and can not achieve satisfiable behaviour.
&gt; I've just two nodes cluster and bucket with the following settings n=3,
&gt; w=2, r=2. And I have just a couple of entries.
&gt; Basically I have two problems:
&gt; 1) After the split, writes on one side of the partition start lagging
&gt; hard. It takes more than 1 minute for the first write to be become
&gt; successful. I understand that this is related to the process of setting up
&gt; backup vnodes in Riak, but is any way to speed up the process? Which
&gt; configuration parameters influence that?
&gt; 2) More weird problem is after netsplit. "riak-admin transfers" command
&gt; immediately reports that there should 5 partition transfers from one node
&gt; to another and 5 partition transfers in the opposite direction. But active
&gt; transfers output is empty!
&gt; I've put a watch on this command and active transfers are always empty.
&gt; Finally, it takes several minutes for Riak to finish hinted handoff.
&gt; Several minutes just for several keys!
&gt; What Riak is doing all this time? Anyway to speed up the process?
&gt; 3) The reason why I'm concerned about hinted-handoff speed is because, I
&gt; noticed that until this process finishes, I read stale data on both sides
&gt; of ex-netsplit.
&gt;
&gt;
&gt; --
&gt; Thanks,
&gt; Andrey
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
-- 


Alexander Sicular
Solutions Architect
Basho Technologies
9175130679
@siculars
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

