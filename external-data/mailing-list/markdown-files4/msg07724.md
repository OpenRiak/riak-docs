---
title: "Re: Riak Cluster Crash down on heavy load Benchmarking"
description: ""
project: community
lastmod: 2012-06-20T08:22:51-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07724"
mailinglist_parent_id: "msg07715"
author_name: "Amol Rajoba"
project_section: "mailinglistitem"
sent_date: 2012-06-20T08:22:51-07:00
---


Thanks Guys.

And I did try with default eleveldb configuration and it worked very well,
Thanks. I am now thinking of migration from cassandra to riak.
At start I thought that giving more write\_buffer\_size will help in write
performance like it happens in cassandra.

I have 3 more queries, I hope I am not troubling you guys much:

1. As LevelDB keeps keys and values in a block cache, how it does the
management of key spaces that are larger than available memory? like in
memcached/redis LRU is used for memory management, here in leveldb how
block cache gets managed?

2. if at start i have 2 nodes and i set n\_val of 2, can I change n\_val to 3
after adding 3rd node without making cluster down?

3. What are the chances/probability of cluster failure for 2 node cluster
with n\_val of 2? I will be increasing cluster size on the availability of
new nodes and n\_val as well.

Thanks for the help guys.
Amol Rajoba


On Wed, Jun 20, 2012 at 12:23 AM, Daniel Reverri  wrote:

&gt; Hi Amol,
&gt;
&gt; What motivated the eleveldb configuration changes in app.config? Have you
&gt; evaluated performance using the default configuration values?
&gt;
&gt; The settings you modified are per vnode. A 2 node cluster, using the
&gt; default ring size of 64, has 32 vnodes per node. The chosen
&gt; write\_buffer\_size seems quite large. Can you retry your test using the
&gt; default configuration values?
&gt;
&gt; Thanks,
&gt; Dan
&gt;
&gt; --
&gt; Daniel Reverri
&gt; Architect
&gt; Basho Technologies, Inc.
&gt; d...@basho.com
&gt;
&gt; On Tuesday, June 19, 2012 at 10:51 AM, Mark Phillips wrote:
&gt;
&gt; Hi Amol,
&gt;
&gt; It looks like you're out of RAM. One of the offending entries from your
&gt; log:
&gt;
&gt; 2012-06-15 19:09:31.777 [error] &lt;0.20970.188&gt; gen\_server &lt;0.20970.188&gt;
&gt; terminated with reason:
&gt; {mem\_error,[{zlib,call,3},{zlib,zip,1},{riak\_kv\_pb\_socket,process\_message,2},{riak\_kv\_pb\_socket,handle\_info,2},{gen\_server2,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]}
&gt;
&gt; Is there any any chance you could add a machine or two and to the cluster
&gt; and run the test gain?
&gt;
&gt; Mark
&gt;
&gt;
&gt;
&gt;
&gt; On Mon, Jun 18, 2012 at 11:34 PM, Amol Rajoba wrote:
&gt;
&gt; Hi Guys,
&gt;
&gt; Can anybody help here?
&gt;
&gt; Also found that due to continuous put operation beam.smp taking 2.9G RAM,
&gt; what could be reason of this?
&gt;
&gt; Thanks.
&gt; Amol Rajoba
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

