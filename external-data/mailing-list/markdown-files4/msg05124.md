---
title: "Re: batch adding of keys to LevelDB backend"
description: ""
project: community
lastmod: 2011-10-11T08:50:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05124"
mailinglist_parent_id: "msg05114"
author_name: "Nate Lawson"
project_section: "mailinglistitem"
sent_date: 2011-10-11T08:50:44-07:00
---


It's not just for testing. We found that loading/updating keys was somewhat 
slow, even with a low replication count. So we're exploring routes of taking a 
node down in an existing cluster, loading a large batch of keys, and then 
bringing it up. It's ok if it takes the data a while to rebalance after we 
rejoin the node.

It sounds like this isn't as explored as I first thought, so we'll do our own 
analysis.

-Nate

On Oct 10, 2011, at 9:18 AM, Ryan Zezeski wrote:

&gt; Nate,
&gt; 
&gt; You could do this but if you're just doing it for testing then it seems like 
&gt; more work than necessary. If you insist on doing it this way you'll want to 
&gt; write it in Erlang so you can make use of the preflist calculation, 
&gt; riak\_object, and eleveldb driver.
&gt; 
&gt; You could do the following:
&gt; 
&gt; 1. stand up a fresh cluster
&gt; 
&gt; 2. use one of the clients to load the data
&gt; 
&gt; 3. archive the data dir on all nodes
&gt; 
&gt; Next time you want to stand up a cluster with the same data simply unarchive 
&gt; the data dirs before starting the cluster.
&gt; 
&gt; -Ryan
&gt; 
&gt; 
&gt; On Fri, Oct 7, 2011 at 9:29 PM, Nate Lawson  wrote:
&gt; We're working on a test where we want to add batches of keys to Riak. We're 
&gt; using the LevelDB backend with 1.0. One suggestion we heard was to take down 
&gt; a node, batch insert directly into the backing store, and then bring the node 
&gt; up again.
&gt; 
&gt; Could someone give us some more details on this? How would Riak know which 
&gt; keys in LevelDB had not yet been redistributed to the rest of the cluster?
&gt; 
&gt; Thanks,
&gt; Nate
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

