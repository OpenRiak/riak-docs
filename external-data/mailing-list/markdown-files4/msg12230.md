---
title: "Re: Should content-type not be required?"
description: ""
project: community
lastmod: 2013-09-11T01:52:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12230"
mailinglist_parent_id: "msg12229"
author_name: "Vincenzo Vitale"
project_section: "mailinglistitem"
sent_date: 2013-09-11T01:52:35-07:00
---


I'm sorry I cannot disclose all the details but essentially for this bucket
it's enough to check if a specific item is already present or not.
All the information identifying the item is part of the key so there is no
need to have anything in the body.

A generic example could be a discount voucher system where the voucher id
is unique. As soon as the voucher has been used a new item is created in
the bucket \*used-vouchers\* and every time the system needs to validate a
voucher, then it's enough to check if that id already exists in the bucket.
Who really used the voucher can be part of another bucket (named orders
maybe?) and associated with a secondary index to the voucher, with slower
performances compared to key lookup.


Does it make sense?


Vincenzo




On Wed, Sep 11, 2013 at 4:22 AM, Sam Elliott  wrote:

&gt; I'm interested to know why you're trying to store an empty body in Riak.
&gt; Surely just don't even make the request to Riak? I guess I could be
&gt; overlooking something obvious.
&gt;
&gt; Sam
&gt; --
&gt; Sam Elliott
&gt; Engineer
&gt; sam.elli...@basho.com
&gt; --
&gt;
&gt;
&gt; On Tuesday, 10 September 2013 at 6:29PM, Vincenzo Vitale wrote:
&gt;
&gt; &gt; Hi Sam,
&gt; &gt; thanks for the fast reply.
&gt; &gt;
&gt; &gt; In my company we normally use your third suggestion and indeed it's a
&gt; robust strategy.
&gt; &gt;
&gt; &gt; At the moment we are relying on a riak client based on spray (
&gt; https://github.com/agemooij/riak-scala-client) so even if we set the
&gt; Content-Type - when the body is empty - it doesn't get to the final request
&gt; being dispatched.
&gt; &gt;
&gt; &gt; Our workaround is to have a content body equal to the one byte carriage
&gt; return.
&gt; &gt; It's not a big deal...
&gt; &gt;
&gt; &gt; Writing to the mailing list was mainly because curious to know your
&gt; thoughts about this :)
&gt; &gt;
&gt; &gt;
&gt; &gt; Have a good day,
&gt; &gt; V.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; On Wed, Sep 11, 2013 at 12:03 AM, Sam Elliott  sam.elli...@basho.com)&gt; wrote:
&gt; &gt; &gt; The content-type is important for Riak KV: Various clients will use it
&gt; to identify the difference between a response where the whole body is the
&gt; key, or a response that contains siblings (if you have allow\_mult=true).
&gt; &gt; &gt;
&gt; &gt; &gt; I suggest finding or creating a content type, so that this is clearer
&gt; to your app. It will also allow you to version your objects better. Here
&gt; are a few suggestions (of course replace the text between the &lt; &gt;):
&gt; &gt; &gt; - application/octet-stream - this is usually used for binary data, and
&gt; is the easiest thing to set the content-type to.
&gt; &gt; &gt; - application/vnd.. - a
&gt; vendor-specific type, which you can create yourself
&gt; &gt; &gt; - application/vnd...v number&gt; - another vendor-specific type, which supports versioning.
&gt; &gt; &gt;
&gt; &gt; &gt; You don't have to use the information in your final app, but it is
&gt; used by riak and riak clients, so that's why we require it.
&gt; &gt; &gt;
&gt; &gt; &gt; --
&gt; &gt; &gt; Sam Elliott
&gt; &gt; &gt; Engineer
&gt; &gt; &gt; sam.elli...@basho.com (mailto:sam.elli...@basho.com)
&gt; &gt; &gt; --
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; On Tuesday, 10 September 2013 at 5:03PM, Vincenzo Vitale wrote:
&gt; &gt; &gt;
&gt; &gt; &gt; &gt; Suppose I want to just store keys in a bucket without any body, this
&gt; make sense in scenarios where the key completely identify the entity. Is it
&gt; possible to use the riak http api without including the content-type header?
&gt; &gt; &gt; &gt; Looking at the http specifications, content–type is not mandatory or
&gt; suggested when the body is empty:
&gt; &gt; &gt; &gt; http://www.w3.org/Protocols/rfc2616/rfc2616-sec7.html#sec7.2.1
&gt; &gt; &gt; &gt; and it's probably a good argument to say that if the entity message
&gt; is empty then the content type doesn't really make sense.
&gt; &gt; &gt; &gt; Personally I think that just the existence of an http entity - body
&gt; or not body – is sufficient to justify a "type"; it's unfortunate that any
&gt; other higher type (entity type maybe?) - decoupled from what is defined as
&gt; content - exist in the spec.
&gt; &gt; &gt; &gt; Framework like spray are quite strict about this, not setting any
&gt; content type when the content is empty:
&gt; &gt; &gt; &gt;
&gt; https://github.com/spray/spray/blob/master/spray-http/src/main/scala/spray/http/HttpEntity.scala#L74
&gt; &gt; &gt; &gt; how to deal with such situation? Adding a fake content because of
&gt; this data store constraint doesn't seems right.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; Vincenzo.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; --
&gt; &gt; &gt; &gt; If your e-mail inbox is out of control, check out
&gt; http://sanebox.com/t/mmzve. I love it.
&gt; &gt; &gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; (mailto:riak-users@lists.basho.com)
&gt; &gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; If your e-mail inbox is out of control, check out
&gt; http://sanebox.com/t/mmzve. I love it.
&gt;
&gt;
&gt;
&gt;


-- 
If your e-mail inbox is out of control, check out http://sanebox.com/t/mmzve.
I love it.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

