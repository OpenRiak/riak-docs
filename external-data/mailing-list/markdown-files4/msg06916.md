---
title: "Re: Blog riak design"
description: ""
project: community
lastmod: 2012-03-07T09:41:24-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06916"
mailinglist_parent_id: "msg06915"
author_name: "Jeff Kirkell"
project_section: "mailinglistitem"
sent_date: 2012-03-07T09:41:24-08:00
---


Buriwoy,

I apologize in advance as I tend to write daily long replies. You have a
couple options and I can provide some of the insight I have learned up till
now but confusing answer is you can do both of what you wrote.

You can have a bucket which is just called posts that also contains the
comments or threads of comments (bad example as this could nest) like so

{data : "'name':'My Blog Post', 'detail':'my long blog post information',
'comments': [{'from': 'someone', text:'test'}], {'from': 'someone else',
'text': 'more comments'} "}

As long as you can format it, you can store it. In talking with people that
deal with large amounts of data who are general NoSQL experts (Cassandra
which is also a Dynamo derivative) they strongly push to not keep
relationships in the same object. I will say that it really depends on what
you are trying to do since, if you just have simple data, it is fine.

The better approach is to have a separate bucket called "posts" and another
called "comments" You can then use secondary indexes as an option to link
the two together. Basically, you take the unique identifier of the post
object and you make it a index header so you can get the comments based on
the post object. With the comments bucket, I would probably just store the
chain of comments together so if someone replies the a comment, all that
goes into the actual comment's object instead of having to manage some form
of hierarchy data.

At the end of the day I basically built a solution that uses both of your
original options at the same time.

Hopefully that provides some insight into the flexibility.

Jeff

On Wed, Mar 7, 2012 at 12:03 PM, Buri Arslon  wrote:

&gt; I have another crazy idea :) What if I create a bucket for each blog's
&gt; comments? So, riak/blog\_bucket/blog\_01 and comments go to
&gt; riak/blog\_01\_comments?
&gt;
&gt; Any ideas?
&gt; -- Buriwoy
&gt;
&gt; On Tue, Mar 6, 2012 at 10:07 AM, Buri Arslon  wrote:
&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I'm very new to NoSQL/KV database systems. Sean's webinar "Schema Design
&gt;&gt; for Riak" http://vimeo.com/17604126 gave me some idea about how to move
&gt;&gt; to kv database, but I feel I need some more advice/docs to fully grasp this
&gt;&gt; new concept for me.
&gt;&gt;
&gt;&gt; I was thinking about developing a blog application using Riak. Which
&gt;&gt; schema would be most effective for that kind of application (regular blog:
&gt;&gt; content + comments):
&gt;&gt;
&gt;&gt; bucket\_blogs -&gt; blog content;
&gt;&gt; bucket\_blogs\_comments -&gt; comments for the blogs in the bucket\_blogs
&gt;&gt;
&gt;&gt; or,
&gt;&gt;
&gt;&gt; bucket\_blogs -&gt; JSON("blog": &lt;&gt;, "comments":
&gt;&gt; &lt;&gt;)?
&gt;&gt;
&gt;&gt; The second option seems less effective if number of comments grow
&gt;&gt; significantly. But I'm not sure. Any hints? Ideas?
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt; -- Buriwoy
&gt;&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

