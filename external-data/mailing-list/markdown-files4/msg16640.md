---
title: "Re: Sudden frequent node crashes"
description: ""
project: community
lastmod: 2015-10-08T12:29:49-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16640"
mailinglist_parent_id: "msg16639"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2015-10-08T12:29:49-07:00
---


Hi Allen,
What version of erlang are you running, please?

Cheers

Russell

&gt; On 8 Oct 2015, at 19:58, Allen Landsidel  wrote:
&gt; 
&gt; Background:
&gt; Riak 2.1.1
&gt; FreeBSD 9.1.
&gt; Servers are all virtualized on VMWare ESX 5.5. Each node is given ~300G of 
&gt; storage, 4G of RAM, and 2 core SMP.
&gt; Storage is via FC SAN.
&gt; Access to the cluster from clients is strictly over the HTTP interface and is 
&gt; funneled through haproxy.
&gt; The cluster was five nodes using leveldb with a ring size of 16.
&gt; 
&gt; The cluster is setup this way so that we could start small and add nodes as 
&gt; needed, with a small memory footprint, rather than preallocating a ton of 
&gt; memory and disk space that we may never use. The cluster has been running 
&gt; fine for the past month.
&gt; 
&gt; Today the cluster has begun experiencing strange repeated failures. No 
&gt; changes in any of the clients have been made, so the problem seems as though 
&gt; it must be in the data coming in.
&gt; 
&gt; I started a fresh two-node cluster and shortly after data begins flowing into 
&gt; the cluster, nodes begin crashing.
&gt; 
&gt; The first report in the crash log is below. I'm far from an expert at 
&gt; understanding these errors, but "invalid\_unicode" seems telling.
&gt; 
&gt; If more from the crash log is needed, I can provide it. Once this first 
&gt; error comes in, the node goes offline and errors just continue to roll in to 
&gt; the log file, in what looks like an attempt to automatically restart the node.
&gt; 
&gt; --------------------------------------------
&gt; \*\* Generic server &lt;0.2136.0&gt; terminating
&gt; \*\* Last message in was {vnodeid,10000}
&gt; \*\* When Server state == {state,"/var/db/riak/kv\_vnode/0",0,&lt;0.2135.0&gt;,2}
&gt; \*\* Reason for termination ==
&gt; \*\* 
&gt; {{badmatch,{error,{4,file\_io\_server,invalid\_unicode}}},[{riak\_kv\_vnode\_status\_mgr,handle\_call,3,[{file,"src/riak\_kv\_vnode\_status\_mgr.erl"},{line,178}]},{gen\_server,try\_handle\_call,4,[{file,"gen\_server.erl"},{line,607}]},{gen\_server,handle\_msg,5,[{file,"gen\_server.erl"},{line,639}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,237}]}]}
&gt; 2015-10-08 18:36:18 =CRASH REPORT====
&gt; crasher:
&gt; initial call: riak\_kv\_vnode\_status\_mgr:init/1
&gt; pid: &lt;0.2136.0&gt;
&gt; registered\_name: []
&gt; exception exit: 
&gt; {{{badmatch,{error,{4,file\_io\_server,invalid\_unicode}}},[{riak\_kv\_vnode\_status\_mgr,handle\_call,3,[{file,"src/riak\_kv\_vnode\_status\_mgr.erl"},{line,178}]},{gen\_server,try\_handle\_call,4,[{file,"gen\_server.erl"},{line,607}]},{gen\_server,handle\_msg,5,[{file,"gen\_server.erl"},{line,639}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,237}]}]},[{gen\_server,terminate,7,[{file,"gen\_server.erl"},{line,804}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,237}]}]}
&gt; ancestors: [&lt;0.2135.0&gt;,riak\_core\_vnode\_sup,riak\_core\_sup,&lt;0.169.0&gt;]
&gt; messages: []
&gt; links: [&lt;0.2135.0&gt;]
&gt; dictionary: []
&gt; trap\_exit: false
&gt; status: running
&gt; heap\_size: 610
&gt; stack\_size: 27
&gt; reductions: 569
&gt; neighbours:
&gt; --------------------------------------------
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

