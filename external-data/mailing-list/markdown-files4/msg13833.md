---
title: "Re: Partitions placement"
description: ""
project: community
lastmod: 2014-03-18T05:35:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13833"
mailinglist_parent_id: "msg13816"
author_name: "Ciprian Manea"
project_section: "mailinglistitem"
sent_date: 2014-03-18T05:35:31-07:00
---


Hi Daniel,

target\_n\_val can be changed at any time and will take effect at the first
iteration of the claim algorithm [0] (which usually runs whenever you
add/remove nodes from the cluster via the riak-admin command)

On default settings, Riak is able to replicate data to distinct nodes in
all clusters with more than 3 nodes.

[0]
https://github.com/basho/riak\_core/blob/develop/src/riak\_core\_claim.erl#L429


Thanks,
Ciprian


On Mon, Mar 17, 2014 at 5:50 PM, Daniel Iwan  wrote:

&gt; Hi Ciprian
&gt;
&gt; Thanks for reply
&gt; I'm assuming 'overlay' you are talking about are vnodes?
&gt; When creating cluster and joining 2 nodes to first node (3-node cluster)
&gt; there should be possible distributing partitions to guarantee 3 copies are
&gt; on distinct machines. Simple sequential vnode assignment would do.
&gt; Then I guess it's a matter of calculating distances between indexes within
&gt; each of nodes. Partitions that do not meet that criteria should be moved
&gt; when scaling up.
&gt;
&gt; Scaling up in my opinion should be easier as more nodes in the cluster,
&gt; sequential partitions are more spread horizontally so probability that a
&gt; server will hold sequential partitions decreases.
&gt;
&gt; With 3 servers it should be guaranteed that at least 2 copies are on
&gt; distinct servers. On 5 servers should be guaranteed 3 copies are on
&gt; distinct
&gt; servers. etc.
&gt;
&gt; Does Riak give such guarantees?
&gt;
&gt; Can target\_n\_val be changed later. What are the implications? Is there a
&gt; description what algorithm will be used for partition placement?
&gt;
&gt; Cheers
&gt; Daniel
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; View this message in context:
&gt; http://riak-users.197444.n3.nabble.com/Partitions-placement-tp4030664p4030679.html
&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

