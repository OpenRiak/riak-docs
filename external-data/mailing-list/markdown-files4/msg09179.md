---
title: "Re: How to make Riak work faster (writing)"
description: ""
project: community
lastmod: 2012-11-02T23:08:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09179"
mailinglist_parent_id: "msg09169"
author_name: "Jared Morrow"
project_section: "mailinglistitem"
sent_date: 2012-11-02T23:08:18-07:00
---


I forgot to mention that 2000 ops/sec was on bitcask, not memory. I didn't
bother with the memory backend.

-Jared

On Sat, Nov 3, 2012 at 12:05 AM, Jared Morrow  wrote:

&gt; Uruka,
&gt;
&gt; So looking at your results something is really wrong with your setup. I
&gt; was surprised by your numbers, so I made two VM's each with only 1gb of RAM
&gt; on two different boxes also on a 1gb switch.
&gt;
&gt; I ran a put of 100,000 keys at 10kb in size.
&gt;
&gt; I didn't do any tuning at all on the VM's and these were quick Ubuntu
&gt; 10.04 VM's with 2 virtual CPU's and 1 gig of ram. I also didn't change any
&gt; settings in Riak, except for the IP address and listening ports.
&gt;
&gt; Here is the summary of the results showing around 2000 ops/sec
&gt; https://dl.dropbox.com/u/183971/summary.png
&gt;
&gt; So my main thought is that you weren't actually using N=1 for your puts
&gt; and you were using the default N value of 3, meaning you were writing each
&gt; key/value 3 times, and with 2 nodes this is doing a lot of writes to the
&gt; same disk multiple times.
&gt;
&gt; To be sure you have N=1, you can use 'riak attach' on each node and enter
&gt; the following command:
&gt;
&gt; riak\_core\_bucket:set\_bucket(&lt;&lt;"pop1"&gt;&gt;,[{n\_val,1}]).
&gt;
&gt;
&gt; If you bucket name is "pop1" as in my case. That name is completely
&gt; arbitrary.
&gt;
&gt; Sorry I'm late to this thread, I had to find some time to setup the test.
&gt;
&gt; For reference I used https://github.com/basho/basho\_bench for the
&gt; benchmark. With the following .config file
&gt; https://gist.github.com/e630b63f4a025a0fb634
&gt;
&gt; Hope this helps,
&gt; Jared
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

