---
title: "a weird error while post request to server for store object"
description: ""
project: community
lastmod: 2016-09-06T22:31:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17626"
author_name: "HQS^??^"
project_section: "mailinglistitem"
sent_date: 2016-09-06T22:31:56-07:00
---


dear everyone:
 I follow the tutorial at 
http://docs.basho.com/riak/kv/2.1.4/developing/usage/document-store/ , Step 
by Step Practice , when I've Post a request for store object , but the riak 
server respond 400 (Bad Request) , I review my code again and again , but no 
problem found . see below:

php


class BlogPost {
 var $\_title = '';
 var $\_author = '';
 var $\_content = '';
 var $\_keywords = [];
 var $\_datePosted = '';
 var $\_published = false;
 var $\_bucketType = "cms";
 var $\_bucket = null;
 var $\_riak = null;
 var $\_location = null;
 public function \_\_construct(Riak $riak, $bucket, $title, $author, $content, 
array $keywords, $date, $published)
 {
 $this-\_riak = $riak;
 $this-&gt;\_bucket = new Bucket($bucket, "cms");
 $this-&gt;\_location = new Riak\Location('blog1',$this-&gt;\_bucket,"cms");
 $this-&gt;\_title = $title;
 $this-&gt;\_author = $author;
 $this-&gt;\_content = $content;
 $this-&gt;\_keywords = $keywords;
 $this-&gt;\_datePosted = $date;
 $this-&gt;\_published = $published;
 }

 public function store()
 {
 $setBuilder = (new UpdateSet($this-&gt;\_riak));
 
 foreach($this-&gt;\_keywords as $keyword) {
 $setBuilder-&gt;add($keyword);
 }
/\*
 (new UpdateMap($this-&gt;\_riak))
 -&gt;updateRegister('title', $this-&gt;\_title)
 -&gt;updateRegister('author', $this-&gt;\_author)
 -&gt;updateRegister('content', $this-&gt;\_content)
 -&gt;updateRegister('date', $this-&gt;\_datePosted)
 -&gt;updateFlag('published', $this-&gt;\_published)
 -&gt;updateSet('keywords', $setBuilder)
 -&gt;withBucket($this-&gt;\_bucket)
 -&gt;build()
 -&gt;execute();

\*/
 $response = (new UpdateMap($this-&gt;\_riak))
 -&gt;updateRegister('title', $this-&gt;\_title)
 -&gt;updateRegister('author', $this-&gt;\_author)
 -&gt;updateRegister('content', $this-&gt;\_content)
 -&gt;updateRegister('date', $this-&gt;\_datePosted)
 -&gt;updateFlag('published', $this-&gt;\_published)
 -&gt;updateSet('keywords', $setBuilder)
 -&gt;atLocation($this-&gt;\_location)
 -&gt;build()
 -&gt;execute();

 echo '';
 var\_dump($response);
 echo '';
 }
}

 $node = (new Node\Builder)
 -&gt;atHost('192.168.111.2')
 -&gt;onPort(8098)
 -&gt;build();

 $riak = new Riak([$node]);


$keywords = ['adorbs', 'cheshire'];
$date = new \DateTime('now');


$post1 = new BlogPost(
 $riak,
 'cat\_pics', // bucket
 'This one is so lulz!', // title
 'Cat Stevens', // author
 'Please check out these cat pics!', // content
 $keywords, // keywords
 $date, // date posted
 true // published
);
$post1-&gt;store();

the wireshark captured packet : 

 192.168.171.124(client ip) =&gt; 192.168.111.2(riak server ip) HTTP 511 
 POST /types/cms/buckets/cat\_pics/datatypes/alldoc? HTTP/1.1 (application/json)
 192.168.111.2 192.168.171.124 HTTP 251 HTTP/1.1 400 Bad Request 

 GET http://192.168.111.2:8098//types/cms/buckets/cat\_pics/props
{"props":{"name":"cat\_pics","young\_vclock":20,"w":"quorum","small\_vclock":50,"search\_index":"blog\_posts","rw":"quorum","r":"quorum","pw":0,"precommit":[],"pr":0,"postcommit":[],"old\_vclock":86400,"notfound\_ok":true,"n\_val":3,"linkfun":{"mod":"riak\_kv\_wm\_link\_walker","fun":"mapreduce\_linkfun"},"last\_write\_wins":false,"dw":"quorum","dvv\_enabled":true,"chash\_keyfun":{"mod":"riak\_core\_util","fun":"chash\_std\_keyfun"},"big\_vclock":50,"basic\_quorum":false,"allow\_mult":true,"datatype":"map","active":true,"claimant":"node1@192.168.111.1"}}

 please help me catch the bugs thanks in advance! 

regards
 
 Alan\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

