---
title: "Re: native erlang client on non-Riak node?"
description: ""
project: community
lastmod: 2012-04-05T13:13:04-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07155"
mailinglist_parent_id: "msg07154"
author_name: "John E. Vincent"
project_section: "mailinglistitem"
sent_date: 2012-04-05T13:13:04-07:00
---


ElasticSearch has this feature as well.

When using the Java transport client (as opposed to the HTTP/JSON
interface), you actually become a cluster member as a non-data node.
You can also add any number of nodes to the cluster as non-data nodes
that then participate in general processing.

http://www.elasticsearch.org/guide/reference/modules/node.html
http://www.elasticsearch.org/guide/reference/java-api/client.html

On Thu, Apr 5, 2012 at 3:52 PM, Alexander Sicular  wrote:
&gt; I think that being able to have a native erlang interface to a riak cluster
&gt; would be a "Good Thing." I can imagine some compute applications that could
&gt; benefit from having access to data at the speed of network but not actually
&gt; be a member of the storage pool.
&gt;
&gt; Just watched Rich Hickey discussing similar concepts employed in his new
&gt; system, Datomic, here, http://www.infoq.com/interviews/hickey-datomic .
&gt; Worth the 30min.
&gt;
&gt; -Alexander Sicular
&gt;
&gt; @siculars
&gt;
&gt; On Apr 5, 2012, at 3:30 PM, Ryan Zezeski wrote:
&gt;
&gt; Mike,
&gt;
&gt; The native Erlang client was never designed to be used in this fashion, as
&gt; you are finding out first hand.  You are correct in that some operations
&gt; assume they are running on the Riak VM, e.g. mapred\_dynamic\_inputs\_stream.
&gt;
&gt; Normally I would say not to establish a Erlang dist connection to the Riak
&gt; cluster but given you need a work around for the performance issue it seems
&gt; to be your only good choice ATM.  You can use `rpc:call` to invoke the
&gt; mapred queries.
&gt;
&gt; -Z
&gt;
&gt; On Wed, Apr 4, 2012 at 2:40 PM, Michael Radford  wrote:
&gt;&gt;
&gt;&gt; In case anyone else is wondering, the answer is no, the native client
&gt;&gt; isn't fully usable from a non-Riak node.
&gt;&gt;
&gt;&gt; I started a hidden node and connected to one of my Riak nodes using
&gt;&gt; riak:client\_connect. The returned client is able to successfully
&gt;&gt; execute Client:get(Bucket, Key) (and probably other simple things like
&gt;&gt; put/delete), but it fails on mapred with a {modfun, ...} input.
&gt;&gt;
&gt;&gt;
&gt;&gt; The problem is that the native client tries to run the input function
&gt;&gt; on the local node, rather than the node the client points to, which of
&gt;&gt; course won't work unless the local node is participating in the Riak
&gt;&gt; cluster.
&gt;&gt;
&gt;&gt; Mike
&gt;&gt;
&gt;&gt; On Tue, Apr 3, 2012 at 9:43 AM, Michael Radford  wrote:
&gt;&gt; &gt; Is it OK to use Riak's native erlang client from an erlang node that's
&gt;&gt; &gt; connected to a Riak cluster via normal erlang distribution
&gt;&gt; &gt; (net\_adm:ping etc.), but isn't participating in the Riak cluster?  I'm
&gt;&gt; &gt; wondering if e.g. Riak makes any assumptions about nodes listed in
&gt;&gt; &gt; nodes(), or the nodes of processes running client code, that would
&gt;&gt; &gt; break if a node isn't running Riak.
&gt;&gt; &gt;
&gt;&gt; &gt; I'm trying to figure out a fallback strategy in case I can't resolve
&gt;&gt; &gt; performance issues I'm seeing with the protocol buffers client (see
&gt;&gt; &gt; other thread about slow searches).  The scariest option would be to
&gt;&gt; &gt; run my application on the same nodes as Riak, which seems like it
&gt;&gt; &gt; would complicate operations too much.  Or if
&gt;&gt; &gt; connected-but-not-participating nodes aren't a good idea, maybe my
&gt;&gt; &gt; application nodes could each start a slave node with -hidden, which
&gt;&gt; &gt; would then connect to Riak and act as a proxy?
&gt;&gt; &gt;
&gt;&gt; &gt; Mike
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

