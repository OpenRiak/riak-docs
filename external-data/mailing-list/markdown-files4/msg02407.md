---
title: "Re: Riak search question (Python)"
description: ""
project: community
lastmod: 2011-02-22T12:05:52-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02407"
mailinglist_parent_id: "msg02384"
author_name: "Rusty Klophaus"
project_section: "mailinglistitem"
sent_date: 2011-02-22T12:05:52-08:00
---


Hi Mike,

You are missing the "run()" command at the end of client.search(). The
"search()" function creates a MapReduce object to which you can add map and
reduce phases. The "run()" command bundles up MapReduce job and sends it to
the Riak cluster for processing.

client.search('tweets', 'name:[andy TO john]').run() should give you the
results you are looking for.

If that still doesn't work, some sample code is below and more examples are
at
https://github.com/basho/riak-python-client/blob/master/riak/tests/test\_all.py

Best,
Rusty

from riak import RiakClient
from riak import RiakHttpTransport

client = RiakClient("127.0.0.1", 8098)
bucket = client.bucket("tweets")

tweet = bucket.new('key1', data={ 'name': 'andy', 'text': 'text1' })
tweet.store()

tweet = bucket.new('key2', data={ 'name': 'bob', 'text': 'text2' })
tweet.store()

tweet = bucket.new('key3', data={ 'name': 'john', 'text': 'text3' })
tweet.store()

tweet = bucket.new('key4', data={ 'name': 'lloyd', 'text': 'text4' })
tweet.store()

results = client.search('tweets', 'name:[andy TO john]').run()
results[0].get().get\_data()
results[1].get().get\_data()
results[2].get().get\_data()


On Fri, Feb 18, 2011 at 7:44 PM, Mike Stoddart  wrote:

&gt; I'm experimenting with Riak Search; I'm storing tweets and then trying
&gt; to query them. My code to store a tweet is:
&gt;
&gt; tweet = bucket.new(str(uuid.uuid1()), data={
&gt; 'name': s.user.name,
&gt; 'text': s.text,
&gt; })
&gt; tweet.store()
&gt;
&gt; My code to search the tweets is:
&gt;
&gt; search\_query = client.search('tweets', 'name:[andy TO john]')
&gt;
&gt; I've tried many different queries including:
&gt;
&gt; search\_query = client.search('tweets', 'text:and')
&gt;
&gt; But I never get any hits. Am I doing something fundamentally wrong? I
&gt; print out the tweet as I add it to the database so I know what terms I
&gt; can search on. But nothing works. I did remember to do:
&gt;
&gt; serach-cmd install tweets
&gt;
&gt; Any suggestions appreciated.
&gt;
&gt; Thanks
&gt; Mike
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

