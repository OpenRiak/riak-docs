---
title: "Re: Minimal number of nodes for production"
description: ""
project: community
lastmod: 2013-04-10T15:17:43-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10840"
mailinglist_parent_id: "msg10839"
author_name: "Eric Redmond"
project_section: "mailinglistitem"
sent_date: 2013-04-10T15:17:43-07:00
---


I certainly won't get drawn into a public debate about which database is faster 
per node, but I would recommend you never take such claims at face value.

Eric


On Apr 10, 2013, at 3:02 PM, Tom Zeng  wrote:

&gt; Thanks Eric for the info, that's very helpful. 7 was mentioned at the last 
&gt; Riak DC meetup. not as the minimal but for better performance, when I was 
&gt; chatting with a couple of Basho devs about performance benchmarking, and 
&gt; about Riak is quite a bit slower on single node against Mongo.
&gt; 
&gt; 
&gt; On Wed, Apr 10, 2013 at 5:56 PM, Eric Redmond  wrote:
&gt; 
&gt; 
&gt; On Apr 10, 2013, at 2:26 PM, Tom Zeng  wrote:
&gt; 
&gt;&gt; Hi list,
&gt;&gt; 
&gt;&gt; We have a production installation with only 3 nodes and running on 1.2.1. 
&gt;&gt; I'd appreciate to get some facts to convince IT to increase the number of 
&gt;&gt; nodes to 7 and upgrade to 1.3. I heard people from Basho mentioned ideally 
&gt;&gt; 7 nodes for production a couple of time, can someone explain why 7, is 4, or 
&gt;&gt; 5 nodes good enough?
&gt; 
&gt; I'm not sure where you heard the number 7 as a minimum, unless if was for a 
&gt; specific use-case. In general the minimum recommended number is 5 nodes.
&gt; 
&gt; Running with only 3 nodes isn't a great idea. Since a core purpose of Riak is 
&gt; to remain available in the face of outages, 3 will not support any outage. 
&gt; Less than 3 is lower than the default replication value (N=3). This is so 
&gt; important, in fact, that we recommend 5 solely to act as a buffer in the case 
&gt; where 1 of the 5 is down, the remaining 4 is dangerously close to the 
&gt; inflexible 3 node number. Even if you do not upgrade to 1.3, you really need 
&gt; to have at least 5 nodes.
&gt; 
&gt; There are many benefits to upgrading to 1.3, but one of the most compelling 
&gt; from an operations point of view is active anti-entropy (AAE). Rather than 
&gt; waiting on read-repair to fix inconsistent values (which is passive), AAE 
&gt; routinely attempts to keep all node values in sync. This can be a godsend if 
&gt; a node goes down, since you don't need to fore read-repair when you bring the 
&gt; node back up by reading every key... you just let your cluster actively 
&gt; self-heal.
&gt; 
&gt; 
&gt;&gt; Also on the 3 three nodes, the file size for the bitcask directory very 
&gt;&gt; quite a bit: 21GB, 14GB, and 20GB. Could the node with only 14GB missing 
&gt;&gt; something or it's expected to have such big difference?
&gt; 
&gt; There are several reasons sizes could be different. Values are not yet/ever 
&gt; replicated (based on your N and W values). Files may have not been compacted. 
&gt; Some keys have been deleted but not yet reaped...
&gt; 
&gt;&gt; Thanks,
&gt;&gt; Tom
&gt;&gt; 
&gt;&gt; -- 
&gt;&gt; Tom Zeng
&gt;&gt; Director of Engineering
&gt;&gt; Intridea, Inc. | www.intridea.com
&gt;&gt; t...@intridea.com
&gt;&gt; (o) 888.968.4332 x519
&gt;&gt; (c) 240-643-8728
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

