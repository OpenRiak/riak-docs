---
title: "Re: RiakSearch with java-client"
description: ""
project: community
lastmod: 2014-12-17T08:57:32-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15380"
mailinglist_parent_id: "msg15379"
author_name: "Santi Kumar"
project_section: "mailinglistitem"
sent_date: 2014-12-17T08:57:32-08:00
---


I wiped out the data folder yesterday Luke, so I didn't have those log
files. I'll try that Storing the schema with the above code and send you
the stack

Thanks
Santi

On Wed, Dec 17, 2014 at 9:58 PM, Luke Bakken  wrote:
&gt;
&gt; Santi,
&gt;
&gt; The code you provided looks correct which is why I'm hoping that you
&gt; can get an error message out of a log file.
&gt;
&gt; Another test would be to use HTTP to upload your schema and create the
&gt; index. We may get more information that way.
&gt;
&gt; Uploading a schema via HTTP:
&gt; http://docs.basho.com/riak/latest/dev/advanced/search-schema/
&gt; Creating an index via HTTP:
&gt; http://docs.basho.com/riak/latest/dev/using/search/#Simple-Setup
&gt; --
&gt; Luke Bakken
&gt; Engineer / CSE
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Wed, Dec 17, 2014 at 8:17 AM, Santi Kumar  wrote:
&gt; &gt; Hi Luke,
&gt; &gt; Yes I couldn't capture it. Looks like the message that was sent to Riak
&gt; has
&gt; &gt; wrong format, so it's relate to Message. I am not able to recollect now.
&gt; It
&gt; &gt; displayed the complete message.
&gt; &gt;
&gt; &gt; If you can help me out with the the right way of using the Java Client
&gt; api
&gt; &gt; that would be great. When I use StoreSchema with the schema content as
&gt; the
&gt; &gt; string, this is happening. Is there any elegant way?
&gt; &gt;
&gt; &gt; Appreciate your help Luke
&gt; &gt;
&gt; &gt; Thanks
&gt; &gt; Santi
&gt; &gt;
&gt; &gt; On Wed, Dec 17, 2014 at 8:37 PM, Luke Bakken  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Hi Santi,
&gt; &gt;&gt;
&gt; &gt;&gt; Do you have any error in your Riak log files? They'll be located in
&gt; &gt;&gt; /var/log/riak or dev\*/log (if you're using a devrel). In particular,
&gt; &gt;&gt; look in the solr.log file.
&gt; &gt;&gt; --
&gt; &gt;&gt; Luke Bakken
&gt; &gt;&gt; Engineer / CSE
&gt; &gt;&gt; lbak...@basho.com
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; On Mon, Dec 15, 2014 at 2:08 AM, Santi Kumar 
&gt; wrote:
&gt; &gt;&gt; &gt; Hi
&gt; &gt;&gt; &gt; I'm tying to use Riak Search 2.0 with java client. Couldn't find any
&gt; &gt;&gt; &gt; good
&gt; &gt;&gt; &gt; documentation around that so I'm trying on my own. I've created my own
&gt; &gt;&gt; &gt; custom schema and want to setup this to my index. While executing the
&gt; &gt;&gt; &gt; StoreSchema command, was getting below error with some message bits.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; com.basho.riak.client.core.netty.RiakResponseException: Error
&gt; processing
&gt; &gt;&gt; &gt; incoming message: error:function\_clause:xxxxxxx
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Here is how I'm adding the Custom schema and adding index. Let me know
&gt; &gt;&gt; &gt; If
&gt; &gt;&gt; &gt; I'm doing something wrong
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; public static void buildSearchIndex(String bucketName,String
&gt; indexName)
&gt; &gt;&gt; &gt; throws Exception{
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; InputStream systemResourceAsStream =
&gt; &gt;&gt; &gt; ClassLoader.getSystemResourceAsStream("./veradocs-solr-schema.xml");
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; String schema = IOUtils.toString(systemResourceAsStream,"UTF-8");
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; RiakClient client = RiakClientUtil.getClient();
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; YokozunaSchema yschema = new YokozunaSchema("veradocs-rs",
&gt; schema);
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; StoreSchema storeSchemaOp = new
&gt; &gt;&gt; &gt; StoreSchema.Builder(yschema).build();
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; client.execute(storeSchemaOp);
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; YokozunaIndex vdIndex = new YokozunaIndex(indexName,schema);
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; StoreIndex storeIndex =
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; new StoreIndex.Builder(vdIndex).build();
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; client.execute(storeIndex);
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Namespace catsBucket = new Namespace(bucketName);
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; StoreBucketProperties storeBucketProps = new
&gt; &gt;&gt; &gt; StoreBucketProperties.Builder(catsBucket)
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; .withSearchIndex(indexName)
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; .build();
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; RiakFuture executeAsync =
&gt; &gt;&gt; &gt; client.executeAsync(storeBucketProps);
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; executeAsync.get();
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; }
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Thanks
&gt; &gt;&gt; &gt; Santi
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt;&gt; &gt; riak-users mailing list
&gt; &gt;&gt; &gt; riak-users@lists.basho.com
&gt; &gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;&gt; &gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

