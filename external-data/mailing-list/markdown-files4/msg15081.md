---
title: "Re: Riak Search Schema Question"
description: ""
project: community
lastmod: 2014-10-27T08:36:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15081"
mailinglist_parent_id: "msg15079"
author_name: "Andrew Zeneski"
project_section: "mailinglistitem"
sent_date: 2014-10-27T08:36:57-07:00
---


I know this might sound strange, but what if the data was formatted like so:

{"id": 1, stats: [ {"stat1": {"name":"stat1", "group": "x", "value": 1}},
{"stat2": {"name": "stat2", "group": "x", "value": 5}} ] }

Would the default extractor flatten this to :

stats.stat1.name = stat1, stats.stat1.group = x, stats.stat1.value = 1
stats.stat2.name = stat2, stats.stat2.group = x, stats.stat2.value = 5

As far as indexing is concerned, would this be the same as {"stats":
{"stat1": {...}, "stat2": {...}} ?

Andrew

On Sun, Oct 26, 2014 at 1:46 PM, Andrew Zeneski 
wrote:

&gt; That would be ideal I know, but would require a huge effort and is
&gt; something I am saving as a last resort. A custom extractor should allow me
&gt; to massage the value into a more index friendly format before sending to
&gt; Solr but allowing the value to remain in its current form.
&gt;
&gt; I have no experience with this so I'm not sure the LoE involved in such a
&gt; task. Any advice is surely appreciated! Thanks for your input.
&gt;
&gt; Andrew
&gt;
&gt; On Sun, Oct 26, 2014 at 10:58 AM, Alexander Sicular 
&gt; wrote:
&gt;
&gt;&gt; That might happen.
&gt;&gt;
&gt;&gt; Could you rearrange your data to look like
&gt;&gt;
&gt;&gt; Id: ... , stats: {
&gt;&gt; Stat1: [ ... ],
&gt;&gt; Stat2: [ ... ],
&gt;&gt; ...
&gt;&gt;
&gt;&gt; }
&gt;&gt;
&gt;&gt; Then you could do a stats\_stat1 &gt; 1 query. It's also more space
&gt;&gt; efficient. Derived vs explicit naming. Stat(N) could even be an array of
&gt;&gt; hashes like [{value:..., dates:...},...] if you needed that.
&gt;&gt;
&gt;&gt; -Alexander
&gt;&gt;
&gt;&gt; @siculars
&gt;&gt; http://siculars.posthaven.com
&gt;&gt;
&gt;&gt; Sent from my iRotaryPhone
&gt;&gt;
&gt;&gt; On Oct 26, 2014, at 10:43, Andrew Zeneski 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt; Yes right, I was tired when I typed this; stats should be an array:
&gt;&gt;
&gt;&gt; {"id": 1, "stats": [{ "name": "stat1", "value": 1 }, {"name": "stat2",
&gt;&gt; "value": 5}]}
&gt;&gt; {"id": 2, "stats": [{ "name": "stat3", "value": 2 }, {"name": "stat1",
&gt;&gt; "value": 3}]}
&gt;&gt; {"id": 3, "stats": [{ "name": "stat2", "value": 3 }, {"name": "stat3",
&gt;&gt; "value": 1}}]
&gt;&gt;
&gt;&gt; I haven't tried it either, but I was worried that stats\_name = stat1 and
&gt;&gt; stats\_value &gt; 1 would return both ID 1 and 2 because both have a name
&gt;&gt; stats1 and both have some value &gt; 1.
&gt;&gt;
&gt;&gt; Andrew
&gt;&gt;
&gt;&gt;
&gt;&gt; On Sun, Oct 26, 2014 at 12:50 AM, Alexander Sicular 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Haven't tried it out but should stats be an array?
&gt;&gt;&gt;
&gt;&gt;&gt; And the query would be something like
&gt;&gt;&gt;
&gt;&gt;&gt; Stats\_name = stat1 and stats\_value &gt; 1
&gt;&gt;&gt;
&gt;&gt;&gt; I think the extractor flattens everything and separates with underscores.
&gt;&gt;&gt;
&gt;&gt;&gt; -Alexander
&gt;&gt;&gt;
&gt;&gt;&gt; @siculars
&gt;&gt;&gt; http://siculars.posthaven.com
&gt;&gt;&gt;
&gt;&gt;&gt; Sent from my iRotaryPhone
&gt;&gt;&gt;
&gt;&gt;&gt; &gt; On Oct 25, 2014, at 22:53, Andrew Zeneski 
&gt;&gt;&gt; wrote:
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Hi All, I'm trying to determine if a use case is supported by
&gt;&gt;&gt; Yokozuna or not.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; With a stored value that looks like:
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; {"id": 1, "stats": { "name": "stat1", "value": 1 }, {"name": "stat2",
&gt;&gt;&gt; "value": 5}}
&gt;&gt;&gt; &gt; {"id": 2, "stats": { "name": "stat3", "value": 2 }, {"name": "stat1",
&gt;&gt;&gt; "value": 3}}
&gt;&gt;&gt; &gt; {"id": 3, "stats": { "name": "stat2", "value": 3 }, {"name": "stat3",
&gt;&gt;&gt; "value": 1}}
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; I want to find those who have stat1 &gt; 2. The result should be id 2.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; I believe Solr 4.8 would handle this as a block-join, but I don't
&gt;&gt;&gt; think Yokozuna supports this feature. My first thought was a custom
&gt;&gt;&gt; extractor; are there other options I'm not seeing?
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Thanks!
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Andrew
&gt;&gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; &gt; riak-users mailing list
&gt;&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

