---
title: "Re: Cleaning old indexes"
description: ""
project: community
lastmod: 2014-12-11T10:56:21-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15354"
mailinglist_parent_id: "msg15353"
author_name: "Geoff Garbers"
project_section: "mailinglistitem"
sent_date: 2014-12-11T10:56:21-08:00
---


Hey Luke.

There are actually some legacy items within Riak that still use the global
search index - so we haven't yet had a need to remove it. It's good to know
that there is a way to remove it though.

And just a side question - I take it you're able to remove a search index
even if there are still objects referencing it, correct?

Regards,
Geoff


Geoffrey Garbers
Senior Developer

[image: Total Send] 

Cell: +27 (0)766 476 920
Skype: geoff.garbers
ge...@totalsend.com
www.totalsend.com

 +1 347-431-0494 
 +44 (0)203 519 1082 
 +61 (0)3 9111 5760 
 +27 (0)21 200 6981 

On Thu, Dec 11, 2014 at 8:28 PM, Luke Bakken  wrote:

&gt; Hi Geoff,
&gt;
&gt; Are you having issues removing the old "global" index? You should be
&gt; able to delete it this way:
&gt;
&gt; curl -XDELETE riak-host:8098/search/index/global
&gt;
&gt; &gt; Is it safe to mess with anything within the Solr admin interface (is
&gt; there a possibility of corruption from Riak -&gt; Solr, or vice versa)?
&gt;
&gt; It's best to leave things alone in production as Riak expects to be
&gt; the sole source of control for Solr
&gt;
&gt; --
&gt; Luke Bakken
&gt; Engineer / CSE
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Tue, Nov 18, 2014 at 3:36 AM, Geoff Garbers 
&gt; wrote:
&gt; &gt; Hey all.
&gt; &gt;
&gt; &gt; When our company started out with Riak, there were some choices made with
&gt; &gt; regards to indexing that are now coming back to bite us. Currently,
&gt; &gt; everything in our Riak cluster is being indexed (dynamicField \* indexed
&gt; as
&gt; &gt; text\_general).
&gt; &gt;
&gt; &gt; We've learnt a lot about Riak and Solr since then, and we're in the
&gt; process
&gt; &gt; now of trying to fix this; indexing the fields we need with the correct
&gt; data
&gt; &gt; type.
&gt; &gt;
&gt; &gt; Previously, we had a single search index (called "global") - and
&gt; everything
&gt; &gt; was indexed under this. This is now split out into separate indexes
&gt; &gt; ("contacts", "lists", "messages", etc); and I've tried to re-index
&gt; &gt; everything - but I don't seem to be able to get rid of the old indexes.
&gt; &gt;
&gt; &gt; There are a few things I've tried; and they don't seem to help:
&gt; &gt;
&gt; &gt; 1. Streaming all keys in all buckets, fetching the object, and then
&gt; putting
&gt; &gt; the object.
&gt; &gt; 2. Streaming all keys in all buckets, fetching the object, deleting the
&gt; &gt; object, and then putting the object back with the same key.
&gt; &gt; 2. Unloading the core in the Solr admin interface (it seems like it gets
&gt; &gt; re-populated by Riak again).
&gt; &gt;
&gt; &gt; In summary, this is what I'm struggling to understand:
&gt; &gt;
&gt; &gt; 1. Is it safe to mess with anything within the Solr admin interface (is
&gt; &gt; there a possibility of corruption from Riak -&gt; Solr, or vice versa)?
&gt; &gt; 2. How do I go about cleaning out old index data, versus simply (what
&gt; seems
&gt; &gt; to be) creating new index data, without clearing out the old data?
&gt; &gt;
&gt; &gt; Any help will really be appreciated!
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Geoff
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

