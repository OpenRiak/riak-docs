---
title: "Re: Trouble with Riak Search JSON Extractor"
description: ""
project: community
lastmod: 2015-03-22T18:38:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15908"
mailinglist_parent_id: "msg15907"
author_name: "Matt Brooks"
project_section: "mailinglistitem"
sent_date: 2015-03-22T18:38:44-07:00
---


Just discovered this on GitHub https://github.com/basho/yokozuna/issues/130.
Looks like auto-reloading is a work in progress.

On Sun, Mar 22, 2015 at 9:24 PM Matt Brooks  wrote:

&gt; Not getting any errors... but I did notice something interesting after
&gt; deleting the nodes on my system and then reconfiguring them.
&gt;
&gt; If the first time I set up a schema I add the multivalued field in
&gt; question, everything works. If I then change the schema and then update it
&gt; over HTTP, the changes do not take affect.
&gt;
&gt; For example, when I reconfigured the nodes on my system I added kept the
&gt; multivalued "groups" field I mentioned above. I then added some users and
&gt; was able to successfully retrieve them using q=groups:\* or something more
&gt; specific. I then changed the schema from "groups" to "groups.id" and PUT
&gt; it on the server successfully (a subsequent GET returned the new schema). I
&gt; also updated the users so that the "groups" array was changed to an array
&gt; of JSON objects, each with an "id" field that would match the "groups.id"
&gt; field in the schema. I then tried to query the users using q=groups.id:\*.
&gt; This failed.
&gt;
&gt; Do changed to the schema not cause the solr indexes to update?
&gt;
&gt; PS: I dug around in $RIAK/data/yz/user/conf and noticed a user.xml file.
&gt; The file held the ORIGINAL schema, not the updated one.
&gt;
&gt;
&gt; On Sun, Mar 22, 2015 at 6:45 PM Zeeshan Lakhani 
&gt; wrote:
&gt;
&gt;&gt; Hello Matt,
&gt;&gt;
&gt;&gt; Are you receiving any indexing errors in your logs (check the Solr logs
&gt;&gt; as well)? To be sure, I just wrote a test (using our erlang pb api,
&gt;&gt; https://github.com/basho/yokozuna/pull/474/files#diff-5
&gt;&gt; d0015658ff90b94cb1a00329ffafe00R251) using a custom schema, and I didn’t
&gt;&gt; run into any troubles; I also checked via the http api. If you have the
&gt;&gt; required \_yz\* fields, you should get those back with the document. If you
&gt;&gt; want the groups items themselves, you’d have to make `stored` true.
&gt;&gt;
&gt;&gt; Zeeshan Lakhani
&gt;&gt; programmer |
&gt;&gt; software engineer at @basho |
&gt;&gt; org. member/founder of @papers\_we\_love | paperswelove.org
&gt;&gt; twitter =&gt; @zeeshanlakhani
&gt;&gt;
&gt;&gt; On Mar 22, 2015, at 4:13 PM, Matt Brooks  wrote:
&gt;&gt;
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I have a quick question about a search schema that would index an array
&gt;&gt; of strings in a JSON object. I am storing user data in JSON that looks
&gt;&gt; something like this:
&gt;&gt;
&gt;&gt; {
&gt;&gt; "name" : "John Smith",
&gt;&gt; "email" : "jsm...@gmail.com",
&gt;&gt; "groups" : [
&gt;&gt; "3304cf79",
&gt;&gt; "abe155cf"
&gt;&gt; ]}
&gt;&gt;
&gt;&gt; The custom schema I use for users includes this field entry:
&gt;&gt;
&gt;&gt; &gt; multiValued="true"/&gt;
&gt;&gt;
&gt;&gt; I also have the following field type entry:
&gt;&gt;
&gt;&gt; 
&gt;&gt;
&gt;&gt; I assumed that these entries would allow me to search for users using a
&gt;&gt; query like:
&gt;&gt;
&gt;&gt; curl $RIAK/search/query/user?wt=json&q=groups:3304cf79
&gt;&gt;
&gt;&gt; But no docs are returned. I'm almost certain I have an issue with my
&gt;&gt; schema. How can I query users by string entries in the "groups" array?
&gt;&gt;
&gt;&gt; Thank you,
&gt;&gt; Matt.
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

