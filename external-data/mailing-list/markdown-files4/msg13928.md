---
title: "Re: CRDT objects and 2i?"
description: ""
project: community
lastmod: 2014-03-26T01:37:48-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13928"
mailinglist_parent_id: "msg13927"
author_name: "Paul Walk"
project_section: "mailinglistitem"
sent_date: 2014-03-26T01:37:48-07:00
---


Thanks Christian - that’s nice and clear.

Paul

On 26 Mar 2014, at 08:15, Christian Dahlqvist  wrote:

&gt; Hi Paul,
&gt; 
&gt; CRDTs are stored as a normal object in Riak, although in a format that allows 
&gt; Riak to resolve conflicts automatically, meaning that the normal restrictions 
&gt; on object size applies. As secondary indexes do not have to be related to the 
&gt; data in any way, Riak would not be able to determine how secondary indexes 
&gt; are to be resolved, and secondary indexes are therefore not supported for 
&gt; CRDTs.
&gt; 
&gt; If you need to query CRDTs I would instead recommend enabling Riak Search 2.0 
&gt; as this supports querying CRDTs through Solr.
&gt; 
&gt; Best regards,
&gt; 
&gt; Christian
&gt; 
&gt; 
&gt; On Wed, Mar 26, 2014 at 6:39 AM, Paul Walk  wrote:
&gt; I’m still a little unclear on the relationship between CRDT, K/V objects and 
&gt; buckets. I understand that bucket\_types add a third level of name-spacing, so 
&gt; I expected that so long as I used a bucket\_type consistently I would be able 
&gt; to use CRDT objects with 2i indexes. However, using the Ruby client, I find 
&gt; that while this successfully returns my previously saved CRDT map called 
&gt; ‘my\_map\_object\_key’:
&gt; 
&gt; map = 
&gt; Riak::Crdt::Map.new(my\_bucket,’my\_map\_object\_key’,’my\_map\_bucket\_type’)
&gt; 
&gt; its key is not recognised in the same bucket, using the same bucket\_type. So 
&gt; this:
&gt; 
&gt; puts my\_bucket.get\_index('$key','0'..'zzzzzzzz',{:bucket\_type=&gt; 
&gt; my\_map\_bucket\_type}).size
&gt; 
&gt; returns ‘0’.
&gt; 
&gt; I suspect I am misunderstanding something fundamental - can anyone advise?
&gt; 
&gt; Thanks,
&gt; 
&gt; Paul
&gt; 
&gt; -------------------------------------------
&gt; Paul Walk
&gt; http://www.paulwalk.net
&gt; -------------------------------------------
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 

-------------------------------------------
Paul Walk
http://www.paulwalk.net
-------------------------------------------






\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

