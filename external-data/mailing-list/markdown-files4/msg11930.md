---
title: "Re: Nailing down the bucket design?"
description: ""
project: community
lastmod: 2013-08-07T07:58:59-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11930"
mailinglist_parent_id: "msg11928"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2013-08-07T07:58:59-07:00
---


Responses inline.

---
Jeremiah Peschka - Founder, Brent Ozar Unlimited
MCITP: SQL Server 2008, MVP
Cloudera Certified Developer for Apache Hadoop


On Wed, Aug 7, 2013 at 2:28 AM, Maksymilian Strzelecki wrote:

&gt; Hi. I've read somewhere around the Internet that Riak benefits its
&gt; performence when there are more buckets and not massive amount of keys in
&gt; them. Now, if this is true I'm asking for an advice on how to go about my
&gt; data model.
&gt;

Riak can benefit from having a large number of buckets, but it's very use
case specific.


&gt; I've started off with one bucket called accounts\_units. Every player has
&gt; his set of units in-game (like 10-20) and they all have their individual
&gt; keys in there. Since knowing what your units are is pretty important thing
&gt; I would be doing a lot of queries on that bucket. Then I thought I could
&gt; create individual buckets for every player and his units. Though it would
&gt; create A LOT of buckets with little keys. Would that be better? What do you
&gt; think?
&gt;

In direct answer to your question, your data model might be better served
by storing all of a player's units in a single value; e.g. units/peschkaj
instead of having between 10 and 20 keys in a units\_peschkaj bucket. The
reasoning here being that a read of a single key is going to be less load
on the system than 20 reads, even though that one key might be 20x larger.

You need to be aware of data access patterns - if multiple actors in your
system can modify the same value, then you need to account for that in your
data access patterns and either serialize writes through a single point
(not a great idea for concurrency) or potentially allow conflicts to occur
and have your application manage sibling resolution.

You also need to be aware of the size of each value that you're storing,
especially if you have siblings. There are performance implications of
storing objects around 4MB in size.


&gt;
&gt; Thanks for your time,
&gt; Max.
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

