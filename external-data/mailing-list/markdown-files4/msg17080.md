---
title: "Re: Yokozuna inconsistent search results"
description: ""
project: community
lastmod: 2016-02-26T07:53:58-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17080"
mailinglist_parent_id: "msg17078"
author_name: "Oleksiy Krivoshey"
project_section: "mailinglistitem"
sent_date: 2016-02-26T07:53:58-08:00
---


Yes, AAE is enabled:

anti\_entropy = active

anti\_entropy.use\_background\_manager = on
handoff.use\_background\_manager = on

anti\_entropy.throttle.tier1.mailbox\_size = 0
anti\_entropy.throttle.tier1.delay = 5ms

anti\_entropy.throttle.tier2.mailbox\_size = 50
anti\_entropy.throttle.tier2.delay = 50ms

anti\_entropy.throttle.tier3.mailbox\_size = 100
anti\_entropy.throttle.tier3.delay = 500ms

anti\_entropy.throttle.tier4.mailbox\_size = 200
anti\_entropy.throttle.tier4.delay = 2000ms

anti\_entropy.throttle.tier5.mailbox\_size = 500
anti\_entropy.throttle.tier5.delay = 5000ms

However the output of "riak-admin search aae-status" looks like this:
http://oleksiy.sirv.com/misc/search-aae.png


On Fri, 26 Feb 2016 at 17:13 Fred Dushin  wrote:

&gt; I would check the coverage plans that are being used for the different
&gt; queries, which you can usually see in the headers of the resulting
&gt; document. When you run a search query though yokozuna, it will use a
&gt; coverage plan from riak core to find a minimal set of nodes (and
&gt; partitions) to query to get a set of results, and the coverage plan may
&gt; change every few seconds. You might be hitting nodes that have
&gt; inconsistencies or are in need of repair. Do you have AAE enabled?
&gt;
&gt; -Fred
&gt;
&gt; &gt; On Feb 26, 2016, at 8:36 AM, Oleksiy Krivoshey 
&gt; wrote:
&gt; &gt;
&gt; &gt; Hi!
&gt; &gt;
&gt; &gt; Riak 2.1.3
&gt; &gt;
&gt; &gt; Having a stable data set (no documents deleted in months) I'm receiving
&gt; inconsistent search results with Yokozuna. For example first query can
&gt; return num\_found: 3000 (correct), the same query repeated in next seconds
&gt; can return 2998, or 2995, then 3000 again. Similar inconsistency happens
&gt; when trying to receive data in pages (using start/rows options): sometimes
&gt; I get the same document twice (in different pages), sometimes some
&gt; documents are missing completely.
&gt; &gt;
&gt; &gt; There are no errors or warning in Yokozuna logs. What should I look for
&gt; in order to debug the problem?
&gt; &gt;
&gt; &gt; Thanks!
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

