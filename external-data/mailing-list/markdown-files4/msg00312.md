---
title: "Re: Having N replicas more than nodes in the cluster"
description: ""
project: community
lastmod: 2010-05-11T08:21:01-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00312"
mailinglist_parent_id: "msg00311"
author_name: "Grant Schofield"
project_section: "mailinglistitem"
sent_date: 2010-05-11T08:21:01-07:00
---



On May 11, 2010, at 10:07 AM, Germain Maurice wrote:

&gt; I'd like to know how works Riak when my bucket has n\_val = 3 and only 2 
&gt; physical nodes.
&gt; Does Riak make 3 copies of the bucket over the 2 nodes or it maintains only 2 
&gt; copies of my bucket on the cluster ?
&gt; 
The data partitioning is done on they key level not the bucket level. An n\_val 
of three will result in 3 vnodes/partitions holding replicas of the data. One 
of your nodes would control two of the three partitions.


&gt; I'm doing tests of riak and i find some things weird.
&gt; 
&gt; I have a two nodes cluster and a bucket with n\_val = 3.
&gt; I put more than 1 600 000 documents in the bucket and it takes less than 200 
&gt; GB with Innostore.
&gt; I shut down the second node with "q()." in a "riak console".
&gt; Firstly, there was no synchronisation of data on the first node, i assume 
&gt; it's better because very similar to a node crash.
&gt; Secondly, when i did a read request on a document with :
&gt; - ?r=1 -&gt; success
&gt; - ?r=2 -&gt; success
&gt; - ?r=3 -&gt; fail

This is due to the fact that 2 of the 3 vnodes were able to respond with your 
data, but not the third because your took down the node that had 1 of the 3 
partitions.

&gt; 
&gt; An other question, "n replicas" means "1 + n copies" or "n copies" of the 
&gt; bucket ?
&gt; 

N replicas means N instances of the key will exist throughout the cluster.

Grant Schofield
Developer Advocate
Basho Technologies


&gt; I really appreciate if you can explain me this behavior ?
&gt; 
&gt; Thank you
&gt; Best Regards,
&gt; -- 
&gt; Germain Maurice
&gt; Administrateur Système/Réseau
&gt; Tel : +33.(0)1.42.43.54.33
&gt; 
&gt; http://www.linkfluence.net
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

