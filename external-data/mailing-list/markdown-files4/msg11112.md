---
title: "Re: First Write Wins"
description: ""
project: community
lastmod: 2013-05-19T19:45:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11112"
mailinglist_parent_id: "msg11111"
author_name: "Jeremy Ong"
project_section: "mailinglistitem"
sent_date: 2013-05-19T19:45:44-07:00
---


Thanks and yes, for the case of the user creation example I gave, I am
setting pw=pr=quorum.

Immutable values is a much better way of putting it, although I technically
need deletion as well for this particular example.

Cheers,
Jeremy


On Sun, May 19, 2013 at 7:24 PM, John Daily  wrote:

&gt; A few quick thoughts...
&gt;
&gt; We're tackling a very similar problem (perhaps even the identical problem)
&gt; with user accounts in Riak CS via the Stanchion subsystem. I know that
&gt; started out as a component running on a single node to avoid conflicts like
&gt; this, but I believe it is evolving into a more sophisticated solution.
&gt;
&gt; This feels like a feature request for allowing keys to be created with
&gt; immutable values. I would assume that topic has arisen before, but I'm not
&gt; aware of when or whether it's something we've seriously considering
&gt; implementing.
&gt;
&gt; Certainly one would have to be careful with sloppy quorums: in the event
&gt; of a network partition, with default settings it would be possible to
&gt; create identical keys on different parts of the cluster without an
&gt; immediate conflict. You should make certain the primary vnodes are always
&gt; required by specifying pw=quorum and pr=quorum (which would mean that
&gt; attempting to write the same key in a partitioned scenario would fail
&gt; unless a majority of the primary vnodes are reachable).
&gt;
&gt; Hopefully someone else who's given this some thought in the past will jump
&gt; in; I'll make further inquiries tomorrow.
&gt;
&gt; -John Daily
&gt; Technical Evangelist
&gt;
&gt; On May 19, 2013, at 7:29 PM, Jeremy Ong  wrote:
&gt;
&gt; For automatic conflict resolution, often times, the easiest thing to do is
&gt; impose a Last Write Wins policy.
&gt;
&gt; However, in certain circumstances, First Write Wins makes more sense. For
&gt; example, suppose you are handling user creation. Creating a single user
&gt; will populate values for two keys:
&gt;
&gt; User Id =&gt; User data
&gt; Username =&gt; User Id
&gt;
&gt; A unique User Id is generated to accommodate future username changes. In
&gt; the event that another user attempts to create an account simultaneously
&gt; with the same username, a conflict will exist. The easiest thing for me to
&gt; do here, is after the account is created, check the username to see if it
&gt; points to the correct User Id. If so, return a success message. Otherwise,
&gt; rollback changes to the first key.
&gt;
&gt; I'm OK with last write wins for now, but is there a way of imposing a
&gt; simple first write wins policy without needing siblings and client conflict
&gt; resolution?
&gt;
&gt; Cheers,
&gt; Jeremy
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

