---
title: "Re: Massive json schema update"
description: ""
project: community
lastmod: 2016-06-08T04:17:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17465"
mailinglist_parent_id: "msg17463"
author_name: "Guillaume Boddaert"
project_section: "mailinglistitem"
sent_date: 2016-06-08T04:17:18-07:00
---



Well,

We are talking about ~30 million items, in a single bucket. Those are 
standard tweets, I need to alter all of them because of an invalid 
structure.
My cluster is not in production, but I am willing to start validating a 
procedure that will be used at some point on a production cluster, 
that's a pre-release rehearsal.


I can write my own script that read/update every entries in big scan of 
the bucket, but It may suffer from network lag, or other external 
stuffs. I'd really like to learn how to alter a set of document in the 
erlang console for instance, in order to validate that I can patch data 
easily in something that would looks more like an SQL command (Yes, 
that's not how it works, understand a map-reduce script in a mongo shell 
for instance) in the Riak core than a programmatic fetch/update loop 
that I already know.


Guillaume

On 08/06/2016 08:49, Damien Krotkine wrote:

Hi Guillaume,

If I understand correctly you need to change all the values of your JSON data.

How many keys are we talking about, how big are the data, and in how many 
buckets are the keys?

Also, is your cluster in production yet?




Le 7 juin 2016 à 18:43, Guillaume Boddaert  
a écrit :

Hi,

I'd like to patch my current riak collection to rename a field inside a JSON 
schema, how can I achieve that from command line on the riak server itself ? Is 
there some kind of map/reduce mechanism that allow any json record to be 
updated then saved to the riak cluster ?

Guillaume

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

