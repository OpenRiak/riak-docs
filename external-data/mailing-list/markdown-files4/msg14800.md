---
title: "Multi-backend and retiring storage"
description: ""
project: community
lastmod: 2014-08-26T17:55:48-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14800"
author_name: "Matt Black"
project_section: "mailinglistitem"
sent_date: 2014-08-26T17:55:48-07:00
---


Hello list,

Apologies in advance for the longish preamble - the question (when I get to
it) is fairly straight forward.

We’ve been happily running Riak for a couple of years now using
multi-backend to map various buckets onto different disk locations (for
infosec compliance reasons).

Our config is essentially this:

{riak\_kv, [
 {storage\_backend, riak\_kv\_multi\_backend},

 %% Configure multiple eleveldb storage locations
 {multi\_backend\_default, &lt;&lt;"default"&gt;&gt;},
 {multi\_backend, [
 %% Default fallback: this is unused
 {&lt;&lt;"default"&gt;&gt;, riak\_kv\_eleveldb\_backend, [
 {data\_root, "/mnt/riak/eleveldb/default"}
 ]},
 %% Storage1
 {&lt;&lt;"eleveldb\_storage1"&gt;&gt;, riak\_kv\_eleveldb\_backend, [
 {data\_root, "/mnt/riak/eleveldb/storage1"}
 ]},
 %% Storage2
 {&lt;&lt;"eleveldb\_storage2"&gt;&gt;, riak\_kv\_eleveldb\_backend, [
 {data\_root, "/mnt/riak/eleveldb/storage2"}
 ]},
 ...

Bucket properties then map Riak buckets onto the relevant backend.

Again for infosec compliance reasons, we need to “retire” one of our
backends, and the data contained therein.

What would a process be for doing this? What happens across the cluster as
I remove the config from each node? At what point can I safely delete the
data directories?

Thanks
Matt
​
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

