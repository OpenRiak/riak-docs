---
title: "Re: Riak backend when using Riak search"
description: ""
project: community
lastmod: 2010-10-20T06:13:10-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01332"
mailinglist_parent_id: "msg01331"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-10-20T06:13:10-07:00
---


Germain,

There are new innostore packages available on downloads.basho.com, but also the 
name of the backend is "riak\_kv\_innostore\_backend", which was changed sometime 
before 0.12.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Oct 20, 2010, at 8:47 AM, Germain Maurice wrote:

&gt; Hello,
&gt; 
&gt; I have to confess I tested Riak Search with Innostore to quickly because I 
&gt; just got these error messages when installing a new node :
&gt; 
&gt; 
&gt; &gt; riaksearch console
&gt; 
&gt; =ERROR REPORT==== 20-Oct-2010::14:32:58 ===
&gt; storage\_backend innostore\_riak is non-loadable.
&gt; 
&gt; =INFO REPORT==== 20-Oct-2010::14:32:58 ===
&gt; application: riak\_kv
&gt; exited: {invalid\_storage\_backend,{riak\_kv\_app,start,[normal,[]]}}
&gt; type: permanent
&gt; /usr/lib/riaksearch/lib/os\_mon-2.2.5/priv/bin/memsup: Erlang has closed.
&gt; 
&gt; Erlang has closed
&gt; 
&gt; 
&gt; &gt; riaksearch console
&gt; 
&gt; =ERROR REPORT==== 20-Oct-2010::14:39:35 ===
&gt; storage\_backend riak\_kv\_innostore\_backend is non-loadable.
&gt; 
&gt; =INFO REPORT==== 20-Oct-2010::14:39:35 ===
&gt; application: riak\_kv
&gt; exited: {invalid\_storage\_backend,{riak\_kv\_app,start,[normal,[]]}}
&gt; type: permanent
&gt; /usr/lib/riaksearch/lib/os\_mon-2.2.5/priv/bin/memsup: Erlang has closed. 
&gt; 
&gt; I'm using Riak Search 0.13.0 and innostore 1.0.2-2-amd64.
&gt; 
&gt; Is it normal ? Dan said me it could be not incompatible with innostore.
&gt; 
&gt; Thanks
&gt; 
&gt; 
&gt; Le 12/10/10 21:48, Germain Maurice a écrit :
&gt;&gt; 
&gt;&gt; Argh, i replied directly to Dan :/
&gt;&gt; 
&gt;&gt; ==========
&gt;&gt; Hi Germain,
&gt;&gt; 
&gt;&gt; You can use Riak Search as you would a normal installation of Riak KV; Riak 
&gt;&gt; Search is a superset of Riak KV. You can modify the riak\_kv portion of Riak 
&gt;&gt; Search exactly as you would a typical Riak KV installation.
&gt;&gt; 
&gt;&gt; One thing to note; along with index data Riak Search will also store a 
&gt;&gt; representation of indexed documents as an object in Riak KV. For example, 
&gt;&gt; indexing a document in the "search" index will do the following:
&gt;&gt; 1. Store indexed data in the Merge Index backend using the merge\_index 
&gt;&gt; data\_root
&gt;&gt; 2. Store a new document in Riak KV using the configured backend:
&gt;&gt; Bucket: \_rsid\_search
&gt;&gt; Key: DocId
&gt;&gt; Value: Data from the document
&gt;&gt; 
&gt;&gt; The document's data representation could be retrieved through the standard 
&gt;&gt; REST API as follows:
&gt;&gt; http://localhost:8098/riak/\_rsid\_search/DocId
&gt;&gt; 
&gt;&gt; Thanks,
&gt;&gt; Dan
&gt;&gt; 
&gt;&gt; Daniel Reverri
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; d...@basho.com
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Tue, Oct 12, 2010 at 12:11 PM, Germain Maurice 
&gt;&gt;  wrote:
&gt;&gt; Not really Dan, it was about pure data storage not about indexes storage.
&gt;&gt; 
&gt;&gt; I just tried Riak Search with Innostore for my buckets and it works, i was a 
&gt;&gt; bit hurry (and it was simple to make some test).
&gt;&gt; However, thank you for having answered.
&gt;&gt; 
&gt;&gt; Le 12/10/10 20:47, Dan Reverri a écrit :
&gt;&gt;&gt; 
&gt;&gt;&gt; Riak Search uses a custom backend called Merge Index. The Riak Search 
&gt;&gt;&gt; backend is configurable in app.config, however, Merge Index is the only 
&gt;&gt;&gt; backend that works for search:
&gt;&gt;&gt; {riak\_search, [
&gt;&gt;&gt; {search\_backend, merge\_index\_backend},
&gt;&gt;&gt; {java\_home, "/usr"}
&gt;&gt;&gt; ]},
&gt;&gt;&gt; 
&gt;&gt;&gt; Merge index is configurable in app.config as well:
&gt;&gt;&gt; %% Merge Index Config
&gt;&gt;&gt; {merge\_index, [
&gt;&gt;&gt; {data\_root, "data/merge\_index"},
&gt;&gt;&gt; {buffer\_rollover\_size, 10485760},
&gt;&gt;&gt; {buffer\_delayed\_write\_size, 524288},
&gt;&gt;&gt; {buffer\_delayed\_write\_ms, 2000},
&gt;&gt;&gt; {max\_compact\_segments, 20},
&gt;&gt;&gt; {segment\_query\_read\_ahead\_size, 65536},
&gt;&gt;&gt; {segment\_compaction\_read\_ahead\_size, 5242880},
&gt;&gt;&gt; {segment\_file\_buffer\_size, 20971520},
&gt;&gt;&gt; {segment\_delayed\_write\_size, 20971520},
&gt;&gt;&gt; {segment\_delayed\_write\_ms, 10000},
&gt;&gt;&gt; {segment\_full\_read\_size, 20971520},
&gt;&gt;&gt; {segment\_block\_size, 32767},
&gt;&gt;&gt; {segment\_values\_staging\_size, 1000},
&gt;&gt;&gt; {segment\_values\_compression\_threshold, 0},
&gt;&gt;&gt; {segment\_values\_compression\_level, 1}
&gt;&gt;&gt; ]},
&gt;&gt;&gt; 
&gt;&gt;&gt; The data\_root parameter will tell Merge Index where to store it's data 
&gt;&gt;&gt; files.
&gt;&gt;&gt; 
&gt;&gt;&gt; Does this answer your question?
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Dan
&gt;&gt;&gt; 
&gt;&gt;&gt; Daniel Reverri
&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; d...@basho.com
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; On Tue, Oct 12, 2010 at 9:51 AM, Germain Maurice 
&gt;&gt;&gt;  wrote:
&gt;&gt;&gt; Hi everybody,
&gt;&gt;&gt; 
&gt;&gt;&gt; Is there any requirements concerning riak storage backend when we are using 
&gt;&gt;&gt; Riak Search ?
&gt;&gt;&gt; I think it's independant but we have to be insured about this.
&gt;&gt;&gt; 
&gt;&gt;&gt; Thank you..
&gt;&gt;&gt; 
&gt;&gt;&gt; -- 
&gt;&gt;&gt; Germain Maurice
&gt;&gt;&gt; Administrateur Système/Réseau
&gt;&gt;&gt; Tel : +33.(0)1.42.43.54.33
&gt;&gt;&gt; 
&gt;&gt;&gt; http://www.linkfluence.net
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; -- 
&gt; Germain Maurice
&gt; Administrateur Système/Réseau
&gt; Tel : +33.(0)1.42.43.54.33
&gt; 
&gt; http://www.linkfluence.net
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

