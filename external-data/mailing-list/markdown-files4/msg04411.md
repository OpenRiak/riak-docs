---
title: "Re: Riak Bitcask merging"
description: ""
project: community
lastmod: 2011-08-22T15:04:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04411"
mailinglist_parent_id: "msg04405"
author_name: "Joseph Blomstedt"
project_section: "mailinglistitem"
sent_date: 2011-08-22T15:04:22-07:00
---


&gt; And while I'm pining for additional command line tools, any idea if
&gt; transfers will ever work without disrupting the actual transfers?
&gt; It's sort of annoying that it's listed as one of the steps for a
&gt; rolling upgrade/restart but if you actually use it, it can cause
&gt; upgrade or startup to take longer.  Also, it tends to timeout on
&gt; a highly trafficked cluster.

Not guaranteeing anything, but there is a very high chance that
'riak-admin transfers' will not delay handoff in the next release of
Riak.

-Joe


&gt; On Mon, Aug 22, 2011 at 11:18 AM, Anthony Molinaro
&gt;  wrote:
&gt;&gt; While I didn't ask this time, I'll explain why I think manual
&gt;&gt; merging as an option would be great.
&gt;&gt;
&gt;&gt; As far as I know specifying a merge window doesn't guarantee the
&gt;&gt; merging happens, only that it might if other thresholds are met.
&gt;&gt;
&gt;&gt; With our cassandra cluster we've ended up scheduling twice weekly
&gt;&gt; full compactions (the close equivalent to merging I believe), via
&gt;&gt; cron.  The days and times are specificaly chosen based on traffic
&gt;&gt; patterns, and can be changed without restarting the servers.
&gt;&gt;
&gt;&gt; We don't have this convenience with riak.  We can set it up to only
&gt;&gt; merge during a window, but can't guarantee everything was merged
&gt;&gt; or even that any merges will occur.  If I wanted to change when I
&gt;&gt; do the merging, I have to restart the servers to pick up the new
&gt;&gt; config (at least I think I would).  I have no way to stagger the
&gt;&gt; merging (have different nodes merge at different times), unless
&gt;&gt; I have slightly different config on each node.
&gt;&gt;
&gt;&gt; If there were a riak-admin command called merge/compact/cleanup/expire
&gt;&gt; or something which triggered a manual merge I know we would use it.
&gt;&gt;
&gt;&gt; And while I'm pining for additional command line tools, any idea if
&gt;&gt; transfers will ever work without disrupting the actual transfers?
&gt;&gt; It's sort of annoying that it's listed as one of the steps for a
&gt;&gt; rolling upgrade/restart but if you actually use it, it can cause
&gt;&gt; upgrade or startup to take longer.  Also, it tends to timeout on
&gt;&gt; a highly trafficked cluster.
&gt;&gt;
&gt;&gt; Anyway, sorry about hijacking someone else's question, but
&gt;&gt; figured more information from users is usually welcome?
&gt;&gt;
&gt;&gt; -Anthony
&gt;&gt;
&gt;&gt; On Mon, Aug 22, 2011 at 09:14:06AM -0700, Dan Reverri wrote:
&gt;&gt;&gt; There is no way to manually trigger a Bticask merge. What's the use case for
&gt;&gt;&gt; needing to manually trigger the merge? Are you concerned about the size of
&gt;&gt;&gt; the data files? Are you trying to avoid merging at a particular time?
&gt;&gt;&gt;
&gt;&gt;&gt; Not sure if this will help but you can restrict Bitcask merging to a
&gt;&gt;&gt; specified window of time:
&gt;&gt;&gt; http://wiki.basho.com/Bitcask-Configuration.html#Merge-Window
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Dan
&gt;&gt;&gt;
&gt;&gt;&gt; Daniel Reverri
&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; d...@basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Sun, Aug 21, 2011 at 11:36 PM, raghwani sohil wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Hi All,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Is there any way to run  bitcask merging process manually ?
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; thanks ,
&gt;&gt;&gt; &gt; Sohil Raghwani .
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; &gt; riak-users mailing list
&gt;&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt;
&gt;&gt;
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; ------------------------------------------------------------------------
&gt;&gt; Anthony Molinaro                           
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

