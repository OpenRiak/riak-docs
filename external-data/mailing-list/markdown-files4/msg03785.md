---
title: "Re: Concurrency hazard when updating links"
description: ""
project: community
lastmod: 2011-06-22T08:18:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03785"
mailinglist_parent_id: "msg03774"
author_name: "Mathias Meyer"
project_section: "mailinglistitem"
sent_date: 2011-06-22T08:18:40-07:00
---


Manuel,

what you're seeing is not specific to links, it's generally how concurrent 
updates to a single object are handled in Riak, links are no exception. If you 
want to handle that properly you need to enable the allow\_mult property on the 
bucket in question.

Now, whenever two clients update the same object based on the same origin (i.e. 
vector clock) they'll cause siblings to be created. The next time you fetch the 
object you'll get both siblings and you can then reconcile the difference, e.g. 
merging all links together, checking if they're still valid, etc., and then 
store back the updated value using the vector clock you got when requesting the 
object including the siblings.

We have wiki page [1] dedicated to vector clocks and conflict resolution, 
explaining the process in more detail.

Mathias Meyer
Developer Advocate, Basho Technologies

[1] 

On Mittwoch, 22. Juni 2011 at 11:14, Manuel Astudillo wrote:

&gt; 
&gt; Hello,
&gt; 
&gt; 
&gt; Probably I have some miss understating on whats the best way to update links 
&gt; in Riak, but I am wondering if you know about this hazard when updating links:
&gt; 
&gt; 
&gt; client A: getLinks(X)
&gt; client B: getLinks(X)
&gt; 
&gt; 
&gt; clientB:updateLinks(X)
&gt; clientA:updateLinks(X)
&gt; 
&gt; 
&gt; where the update made by B is cleaned by A, and it seems like there is not 
&gt; even any way to get a notification about it or detect it somehow... 
&gt; 
&gt; 
&gt; 
&gt; Manuel Astudillo, M.Sc.C.E
&gt; Chief Executive Officer, founder.
&gt; 
&gt; Optimal Bits
&gt; Skolskeppsgatan 26
&gt; SE-23443, Lomma, Sweden.
&gt; mobile:+46 (0) 733 329536
&gt; @optimalbits
&gt; 
&gt; www.optimalbits.com (http://www.optimalbits.com)
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

