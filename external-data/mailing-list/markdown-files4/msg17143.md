---
title: "Re: Using $bucket index for listing keys"
description: ""
project: community
lastmod: 2016-03-11T05:00:43-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17143"
mailinglist_parent_id: "msg17142"
author_name: "Oleksiy Krivoshey"
project_section: "mailinglistitem"
sent_date: 2016-03-11T05:00:43-08:00
---


I'm actually using PB interface, but I can replicate the problem with HTTP
as in my previous email. Request with '&continuation=AAAA' returns the
result set with the same continuation AAAA.

On 11 March 2016 at 14:55, Magnus Kessler  wrote:

&gt; Hi Oleksiy,
&gt;
&gt; How are you performing your 2i-based key listing? Querying with pagination
&gt; as shown in the documentation[0] should work.
&gt;
&gt; As an example here is the HTTP invocation:
&gt;
&gt; curl "
&gt; https://localhost:8098/types/default/buckets/test/index/\$bucket/\_?max\_results=10&continuation=g20AAAACNTM=
&gt; "
&gt;
&gt; Once the end of the key list is reached, the server returns an empty keys
&gt; list and no further continuation value.
&gt;
&gt; Please let me know if this works for you.
&gt;
&gt; Kind Regards,
&gt;
&gt; Magnus
&gt;
&gt;
&gt; [0]: http://docs.basho.com/riak/latest/dev/using/2i/#Querying
&gt;
&gt; On 11 March 2016 at 10:06, Oleksiy Krivoshey  wrote:
&gt;
&gt;&gt; Anyone?
&gt;&gt;
&gt;&gt; On 4 March 2016 at 19:11, Oleksiy Krivoshey  wrote:
&gt;&gt;
&gt;&gt;&gt; I have a bucket with ~200 keys in it and I wanted to iterate them with
&gt;&gt;&gt; the help of $bucket index and 2i request, however I'm facing the recursive
&gt;&gt;&gt; behaviour, for example I send the following 2i request:
&gt;&gt;&gt;
&gt;&gt;&gt; {
&gt;&gt;&gt; bucket: 'BUCKET\_NAME',
&gt;&gt;&gt; type: 'BUCKET\_TYPE',
&gt;&gt;&gt; index: '$bucket',
&gt;&gt;&gt; key: 'BUCKET\_NAME',
&gt;&gt;&gt; qtype: 0,
&gt;&gt;&gt; max\_results: 10,
&gt;&gt;&gt; continuation: 'AAAA'
&gt;&gt;&gt; }
&gt;&gt;&gt;
&gt;&gt;&gt; I receive 10 keys and continuation 'BBBB', I then repeat the request
&gt;&gt;&gt; with continuation 'BBBB' and at this point I can receive a reply with
&gt;&gt;&gt; continuation 'CCCC' or 'AAAA' or even 'BBBB' and its going in never ending
&gt;&gt;&gt; recursion.
&gt;&gt;&gt;
&gt;&gt;&gt; I'm running this on a 5 node 2.1.3 cluster.
&gt;&gt;&gt;
&gt;&gt;&gt; What I'm doing wrong? Or is this not supported at all?
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; Magnus Kessler
&gt; Client Services Engineer
&gt; Basho Technologies Limited
&gt;
&gt; Registered Office - 8 Lincolnâ€™s Inn Fields London WC2A 3BP Reg 07970431
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

