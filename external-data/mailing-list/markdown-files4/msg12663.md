---
title: "Re: Read Before Writes on Distributed Counters"
description: ""
project: community
lastmod: 2013-10-17T08:47:46-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12663"
mailinglist_parent_id: "msg12661"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2013-10-17T08:47:46-07:00
---


Since Jeremiah loves it when I'm pedantic, it bears mentioning that the
list of operations are rolled up immediately (not kept around), grouping by
which partition took the increment. So if I increment by 2 and then by 50,
and the increment goes to different replicas, my counter will look like
[{a, 2}, {b, 50}], for a sum of 52.


On Thu, Oct 17, 2013 at 4:21 PM, Jeremiah Peschka &lt;
jeremiah.pesc...@gmail.com&gt; wrote:

&gt; When you 'update' a counter, you send in an increment operation. That's
&gt; added to an internal list in Riak. The operations are then zipped up to
&gt; provide the correct counter value on read. The worst that you'll do is add
&gt; a large(ish) number of values to the op list inside Riak.
&gt;
&gt; Siblings will be created, but they will not be visible to the end user who
&gt; is reading from the counter.
&gt;
&gt; Check out this demo of the new counter types from Sean Cribbs:
&gt; https://vimeo.com/43903960
&gt;
&gt; ---
&gt; Jeremiah Peschka - Founder, Brent Ozar Unlimited
&gt; MCITP: SQL Server 2008, MVP
&gt; Cloudera Certified Developer for Apache Hadoop
&gt;
&gt;
&gt; On Thu, Oct 17, 2013 at 9:55 AM, Daniil Churikov  wrote:
&gt;
&gt;&gt; Correct me if I wrong, but when you blindly do update without previous
&gt;&gt; read,
&gt;&gt; you create a sibling, which should be resolved on read. In case if you
&gt;&gt; make
&gt;&gt; a lot of increments for counter and rarely reads it will lead to siblings
&gt;&gt; explosion.
&gt;&gt;
&gt;&gt; I am not familiar with new counters datatypes, so I am curious.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; View this message in context:
&gt;&gt; http://riak-users.197444.n3.nabble.com/Read-Before-Writes-on-Distributed-Counters-tp4029492p4029498.html
&gt;&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

