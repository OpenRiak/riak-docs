---
title: "Re: Do not expose Riak to the Internet"
description: ""
project: community
lastmod: 2011-10-20T08:43:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05207"
mailinglist_parent_id: "msg05198"
author_name: "Jonathan Langevin"
project_section: "mailinglistitem"
sent_date: 2011-10-20T08:43:22-07:00
---


Don't the other KVs implement M/R as well? If so, how is it they don't have
a similar exploit?
Is this issue due specifically to Basho's usage of Erlang for processing
M/R?

Is it possible to circumvent this type of exploit by running Erlang & Riak
as unprivileged users?

Seems sandboxing may be needed for all nodes to ensure server integrity. If
someone made it into a node somehow (regardless of public availability),
it's still quite a concern that they could then exploit Riak to gain root
access.
\*

 
 Jonathan Langevin
Manager, Information Technology
Loom Inc.
Wilmington, NC: (910) 241-0433 - jlange...@loomlearning.com -
www.loomlearning.com - Skype: intel352
\*


On Wed, Oct 19, 2011 at 7:29 PM, Eric Redmond wrote:

&gt; There's exposing and then there's \*exposing\* (like celebrity nip-slip
&gt; versus leaked sex tape... yes, my mind went there). A DB like Postgres is
&gt; fairly harmless to expose, since it has so much built-in security there's
&gt; not much danger in it. Of course you still need to secure your server, but
&gt; to offer accounts and databases to multiples users is fairly safe, since you
&gt; can lock down a lot.
&gt;
&gt; Even other KVs like Redis can be largely exposed, you can just route
&gt; requests to a block of DBs per account and globally suppress some of the
&gt; more destructive commands like FLUSHALL.
&gt;
&gt; MongoHQ makes a living offering exposed mongo instances to people. You need
&gt; to monitor for over-utilization, sure, but support is robust.
&gt;
&gt; Riak offers little in the way of multitenancy. I've hacked a solution in
&gt; node.js to control per-account bucket access, but Kyle points out
&gt; interesting issue. The fact that one can execute arbitrary erlang poses
&gt; another layer of security risk, and anyone who dreams of being a Riak host
&gt; (ala MongoHQ) must deal with the issue.
&gt;
&gt; Eric
&gt;
&gt; On Oct 19, 2011, at 4:18 PM, Paul Fisher wrote:
&gt;
&gt; Generally I would never put any database open on the Internet... Is there
&gt; something special about Riak that would cause people to change this rule of
&gt; thumb?
&gt;
&gt; --
&gt; paul
&gt;
&gt; On Oct 19, 2011, at 4:50 PM, "Aphyr"  wrote:
&gt;
&gt; With Eric Redmond's permission\*, I am releasing a proof-of-concept
&gt;
&gt; exploit which uses Riak's mapreduce API to execute arbitrary Erlang code
&gt;
&gt; and obtain shell access.
&gt;
&gt;
&gt; http://aphyr.com/journals/show/do-not-expose-riak-directly-to-the-internet
&gt;
&gt;
&gt; Please stop doing this.
&gt;
&gt;
&gt; --Kyle
&gt;
&gt;
&gt; \* Eric (http://crudcomic.com/post/11656603627/downside-of-crowdsourcing)
&gt;
&gt; announced a publicly accessible Riak cluster today; with his
&gt;
&gt; permission/supervision I used this exploit to gain shell access to his
&gt;
&gt; server. He's taken down that cluster and encouraged me to release this
&gt;
&gt; information.
&gt;
&gt;
&gt; I love the idea of a public sandbox for Riak--but it should be wrapped
&gt;
&gt; in a rate-limiting HTTP proxy that only allows certain URLs, object
&gt;
&gt; sizes, and methods. And limits the number of keys. :)
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;
&gt; riak-users mailing list
&gt;
&gt; riak-users@lists.basho.com
&gt;
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

