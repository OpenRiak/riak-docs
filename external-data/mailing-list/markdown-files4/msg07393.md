---
title: "Re: Issues with Riak Control"
description: ""
project: community
lastmod: 2012-05-07T14:00:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07393"
mailinglist_parent_id: "msg07022"
author_name: "Chris Meiklejohn"
project_section: "mailinglistitem"
sent_date: 2012-05-07T14:00:15-07:00
---


Hi Dmitry,

We haven't merged a fix in just yet, but we're hoping to over the next week
or so.

In the interim, you should be able to modify priv/admin/js/pjax.js, line
184 and increase the timeout to something larger, like 10000 (or larger)
which should resolve the issue when you are dealing with high latency.
 Please let us know if this works for you.

In regards to the incorrect content types, I've just merged a change [1]
which will return the correct content types for files served from
webmachine off the filesystem.

[1] https://github.com/basho/riak\_control/pull/18

Thanks.

Christopher Meiklejohn
Software Engineer

On Mon, May 7, 2012 at 4:45 PM,  wrote:

&gt; Hi Dmitry,
&gt;
&gt; I was actually able to solve this problem a while back. I was also told
&gt; that the changes would be pushed to Github, I haven't had cause to check if
&gt; this was actually done.
&gt;
&gt; The problem was with some files in the
&gt; /usr/lib/riak/lib/riak\_control-0.1.0/priv directory. It's somewhat of a
&gt; timeout issue in one of the javascript files.
&gt;
&gt; If you like I could tell you what you need to update to get it working?!
&gt;
&gt; Cheers.
&gt;
&gt; Charles.
&gt;
&gt; -----Original Message-----
&gt; From: "Dmitry Demeshchuk" 
&gt; Sent: Monday, 7 May, 2012 8:54pm
&gt; To: char...@contentomni.com
&gt; Cc: "Jeffrey Massung" , "riak-users" &lt;
&gt; riak-users@lists.basho.com&gt;
&gt; Subject: Re: Issues with Riak Control
&gt;
&gt; Hi, Charles.
&gt;
&gt; We are experiencing the same problem. I replaced all the files with
&gt; the newest ones, not result. Restarted Riak just in case â€“ still the
&gt; same.
&gt;
&gt; For what it's worth, the CSS that is being served (by webmachine, I
&gt; guess) has content-type "text/html".
&gt;
&gt; Also, I have very long ping to our servers (200-500ms), and when
&gt; riak\_control main page is loading I can see it for about a second.
&gt; Then this white non-CSS'ed page appears. But the folks that reside in
&gt; SF close to the servers say they don't even see the home page, just
&gt; this "Current Snapshot" stuff.
&gt;
&gt; Riak version is 1.1.2.
&gt;
&gt; Please let me know if you need to know anything else.
&gt;
&gt; Thank you.
&gt;
&gt; On Fri, Mar 23, 2012 at 1:18 AM,  wrote:
&gt; &gt; Jeff,
&gt; &gt;
&gt; &gt; Thanks a lot for helping me deal with the issue.
&gt; &gt;
&gt; &gt; For those who need to make changes now without having to edit any
&gt; javascript files, you can do the following:
&gt; &gt;
&gt; &gt; 1. Clone Riak Control from Github
&gt; &gt; 2. Remove your old priv file (/usr/lib/riak/lib/riak\_control-0.1.0/priv)
&gt; &gt; 3. Copy the new priv folder over to the same location
&gt; &gt;
&gt; &gt; Hopefully these changes would already have been pushed to github by the
&gt; time you need to use them.
&gt; &gt;
&gt; &gt; Cheers.
&gt; &gt;
&gt; &gt; -----Original Message-----
&gt; &gt; From: "Jeffrey Massung" 
&gt; &gt; Sent: Thursday, 22 March, 2012 9:50pm
&gt; &gt; To: char...@contentomni.com
&gt; &gt; Cc: "riak-users" 
&gt; &gt; Subject: Re: Issues with Riak Control
&gt; &gt;
&gt; &gt; Replying now for posterity:
&gt; &gt;
&gt; &gt; Riak Control uses pjax for templating and dynamic updating of page
&gt; elements. It's a great tool. However, it also has a very small default ajax
&gt; timeout for page requests, and when there's a timeout, the ajax callback
&gt; returns a success code, but with an empty document. The Riak Control code
&gt; makes an assumption about empty pages (to-be fixed), which then performs a
&gt; redirect to the document in question.
&gt; &gt;
&gt; &gt; Charles' issue has been corrected by modifying some JavaScript in Riak
&gt; Control. We're going to be fixing this issue with something a bit more
&gt; robust and and pushing it to GitHub.
&gt; &gt;
&gt; &gt; Note: while we saw the reason for the problem quickly, Armon's email
&gt; about timeouts is what led us down that path. A hearty thanks goes out to
&gt; him for that insight! ;-)
&gt; &gt;
&gt; &gt; --
&gt; &gt; Jeffrey Massung
&gt; &gt; Software Engineer
&gt; &gt; j...@basho.com
&gt; &gt;
&gt; &gt; On Mar 22, 2012, at 9:28 AM, Jeffrey Massung wrote:
&gt; &gt;
&gt; &gt;&gt; Charles, I've emailed you off-list with a whole set of things to test.
&gt; We have an idea what the problem might be. For posterity, once a solution
&gt; is arrived at, I'll post it back to the mailing list.
&gt; &gt;&gt;
&gt; &gt;&gt; --
&gt; &gt;&gt; Jeffrey Massung
&gt; &gt;&gt; Software Engineer
&gt; &gt;&gt; j...@basho.com
&gt; &gt;&gt;
&gt; &gt;&gt; On Mar 21, 2012, at 9:13 PM, char...@contentomni.com wrote:
&gt; &gt;&gt;
&gt; &gt;&gt;&gt; Yes, it does return the css file.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; The way I've setup my cluster is that I am using my private ip address
&gt; (remember I'm using Rackspace Cloud Servers) for my riak\_core-&gt;http setting
&gt; in app.config, and I am using my public ip address for the riak\_core-&gt;https
&gt; setting.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Everything is working ok on the cluster, everything looks ok from
&gt; riak-admin status. I just have the problem with riak control.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; -----Original Message-----
&gt; &gt;&gt;&gt; From: "Jeffrey Massung" 
&gt; &gt;&gt;&gt; Sent: Wednesday, 21 March, 2012 11:59pm
&gt; &gt;&gt;&gt; To: char...@contentomni.com
&gt; &gt;&gt;&gt; Cc: "riak-users" 
&gt; &gt;&gt;&gt; Subject: Re: Issues with Riak Control
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Charles,
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; A quick test... on the command prompt, does the following return the
&gt; CSS file?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; curl -k https://user:pass@localhost:8069/admin/ui/style.css
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Note: change the credentials, ip, and port appropriately for your
&gt; cluster setup. I'll look at something else for the URL redirection to the
&gt; template folder - that shouldn't be happening (obviously).
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; --
&gt; &gt;&gt;&gt; Jeffrey Massung
&gt; &gt;&gt;&gt; Software Engineer
&gt; &gt;&gt;&gt; j...@basho.com
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; On Mar 21, 2012, at 4:32 PM, char...@contentomni.com wrote:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; I tried Firefox 9, Safari 5, and the latest Chrome. I would hardly
&gt; consider these old browsers.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; -----Original Message-----
&gt; &gt;&gt;&gt;&gt; From: "Jeffrey Massung" 
&gt; &gt;&gt;&gt;&gt; Sent: Wednesday, 21 March, 2012 11:22pm
&gt; &gt;&gt;&gt;&gt; To: char...@contentomni.com
&gt; &gt;&gt;&gt;&gt; Cc: "riak-users" 
&gt; &gt;&gt;&gt;&gt; Subject: Re: Issues with Riak Control
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; This is very much the behavior of older browsers not loading the CSS
&gt; properly and displaying it. IE7, old versions of FireFox, etc. Have you
&gt; tried Chrome, Safari, a latest FireFox, IE8+, etc?
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; --
&gt; &gt;&gt;&gt;&gt; Jeffrey Massung
&gt; &gt;&gt;&gt;&gt; Software Engineer
&gt; &gt;&gt;&gt;&gt; j...@basho.com
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; On Mar 21, 2012, at 4:09 PM, char...@contentomni.com wrote:
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I recently installed a Riak (1.1.1) Cluster on Rackspace Cloud
&gt; Servers. Everything seems to be working ok.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I set up the configuration to enable Riak Control. However, I am
&gt; having a few issues using it.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; As soon as I login in it shows me the home page briefly and then it
&gt; just displays the following in only text:
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Current Snapshot...
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Your cluster is healthy.
&gt; &gt;&gt;&gt;&gt;&gt; You currently have...
&gt; &gt;&gt;&gt;&gt;&gt; 0 Unreachable nodes
&gt; &gt;&gt;&gt;&gt;&gt; 0 Nodes marked as 'down'
&gt; &gt;&gt;&gt;&gt;&gt; 0 Nodes experiencing low memory
&gt; &gt;&gt;&gt;&gt;&gt; Nothing to worry about because Riak is your friend
&gt; &gt;&gt;&gt;&gt;&gt; Your cluster has problems.
&gt; &gt;&gt;&gt;&gt;&gt; The following nodes are currently unreachable:
&gt; &gt;&gt;&gt;&gt;&gt; The following nodes are currently marked as 'down':
&gt; &gt;&gt;&gt;&gt;&gt; The following nodes are currently experiencing low memory:
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; The URL has also changed from https://:8069/admin/ui/index.html
&gt; to https://:8069/admin/ui/templates/snapshot.pjax. It's like it's
&gt; forcing some kind of redirection and I don't know why.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Kindly assist,
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Charles.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt; &gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt; &gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt; --
&gt; Best regards,
&gt; Dmitry Demeshchuk
&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

