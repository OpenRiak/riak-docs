---
title: "Re: http 400 while addings links(and python client bug)"
description: ""
project: community
lastmod: 2010-04-25T06:40:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00166"
mailinglist_parent_id: "msg00165"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-04-25T06:40:35-07:00
---


Alexander,

The solution is to send multiple instances of the same header, which is valid 
HTTP. Split your long headers (I'm guessing "Link"?) into &lt; 8K chunks.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Apr 25, 2010, at 6:28 AM, alexander krohn wrote:

&gt; hi.
&gt; 
&gt; sorry for replying myself ;)
&gt; 
&gt; the header hits the 8k size mark, that causes the 400.
&gt; 
&gt; is there a way to configure the max header length for the rest api's http 
&gt; server? like apache's LimitRequestFieldsize?
&gt; 
&gt; also there's a bug in the python client lib, the links are qouted but not 
&gt; unquoted. this leads to "growing" and wrong tag names.
&gt; 
&gt; patch for \_\_init\_\_.py:
&gt; 
&gt; 1650c1650,1653
&gt; &lt; link = RiakLink(matches.group(2), 
&gt; matches.group(3), matches.group(4))
&gt; ---
&gt; &gt; bucket = 
&gt; &gt; urllib.unquote\_plus(matches.group(2))
&gt; &gt; key = urllib.unquote\_plus(matches.group(3))
&gt; &gt; tag = urllib.unquote\_plus(matches.group(4))
&gt; &gt; link = RiakLink(bucket, key, tag)
&gt; 
&gt; 
&gt; cheers,
&gt; 
&gt; alexander
&gt; 
&gt; alexander krohn wrote:
&gt;&gt; hi.
&gt;&gt; (i already posted this yesterday in irc, mailing-list subscribe was pending)
&gt;&gt; i'm using python to insert several items to riak. the code i'm using[1] 
&gt;&gt; receives an http 400 exactly while inserting the 238th link to an object.
&gt;&gt; the response tells no additional errors, also the erlang-log doesn't show 
&gt;&gt; anything.
&gt;&gt; something wrong on my side or bug?
&gt;&gt; can anyone reproduce this 400?
&gt;&gt; thanks in advance.
&gt;&gt; cheers,
&gt;&gt; alexander
&gt;&gt; [1] used code:
&gt;&gt; import riak
&gt;&gt; client = riak.RiakClient('127.0.0.1',
&gt;&gt; 8098,
&gt;&gt; transport\_class=riak.RiakHttpTransport)
&gt;&gt; print "client alive: ", client.is\_alive()
&gt;&gt; bucket = client.bucket('t1')
&gt;&gt; a = bucket.new('a', (1, 2, 3))
&gt;&gt; for i in range(1000):
&gt;&gt; x = bucket.new('x\_%i' % i, i)
&gt;&gt; x.store()
&gt;&gt; print "stored", i + 1, "items"
&gt;&gt; a.add\_link(x, 'dings').store()
&gt;&gt; print "stored", i + 1, "links"
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

