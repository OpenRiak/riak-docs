---
title: "Re: Querying Secondary Indexes"
description: ""
project: community
lastmod: 2011-09-21T12:22:59-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04825"
mailinglist_parent_id: "msg04824"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-09-21T12:22:59-07:00
---


Fantastic. Good to know that my local spike makes sense to someone other than 
me.
---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Sep 21, 2011, at 12:21 PM, Russell Brown wrote:

&gt; 
&gt; On 21 Sep 2011, at 20:13, Jeremiah Peschka wrote:
&gt; 
&gt;&gt; Have you implemented any wrappers to make querying easier in the Java client 
&gt;&gt; or are you leaving that up to the users to find?
&gt; 
&gt; Yes, wrappers to make it easy.
&gt; 
&gt; So in the java client I have added a fetchIndex method to the Bucket class. 
&gt; You specify the index name, the value (or start, end of a range) and then 
&gt; (behind the curtain) I either call the HTTP API for the HTTP transport, or 
&gt; generate a M/R query for the PB transport. The M/R query has a reduce phase 
&gt; that makes sure only the keys are returned to bring it inline with the HTTP 
&gt; API's return value.
&gt; 
&gt; I also expose a simple builder for creating M/R jobs that have an Index Query 
&gt; as an input.
&gt; 
&gt; So, as much as possible, I have made it so the user just calls fetchIndex and 
&gt; the client takes care of the 'how'.
&gt; 
&gt; This test[1] illustrates it.
&gt; 
&gt; Cheers
&gt; 
&gt; Russell
&gt; 
&gt; [1] 
&gt; https://github.com/basho/riak-java-client/blob/cd67a3ffc1e2cede0a8957a015a697eac2c2b421/src/test/java/com/basho/riak/client/itest/ITestBucket.java#L298
&gt; 
&gt;&gt; ---
&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
&gt;&gt; Microsoft SQL Server MVP
&gt;&gt; 
&gt;&gt; On Sep 21, 2011, at 12:03 PM, Russell Brown wrote:
&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; On 21 Sep 2011, at 19:57, Jeremiah Peschka wrote:
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; So far, the documentation on querying secondary indexes is using the HTTP 
&gt;&gt;&gt;&gt; APIs (see http://blog.basho.com/2011/09/14/Secondary-Indexes-in-Riak/). 
&gt;&gt;&gt;&gt; The riakclient.proto doesn't show anything that's overwhelmingly obvious. 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Do secondary indexes currently require either using the HTTP API or 
&gt;&gt;&gt;&gt; writing an MR job?
&gt;&gt;&gt; 
&gt;&gt;&gt; Yes.
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; ---
&gt;&gt;&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
&gt;&gt;&gt;&gt; Microsoft SQL Server MVP
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

