---
title: "Re: Monitoring protobuffs and CPU usage on a Riak KV cluster"
description: ""
project: community
lastmod: 2015-08-06T05:20:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16369"
mailinglist_parent_id: "msg16365"
author_name: "Matthew Von-Maszewski"
project_section: "mailinglistitem"
sent_date: 2015-08-06T05:20:08-07:00
---


Two ideas about lots of cpu with nothing happening:

- is Riak entropy setting "active". Weekly it will rebuild hash trees

- does this activity occur after a handoff? Sometimes leveldb needs time to 
catch up afterward in current releases (fix coming soon). 

Matthew

Sent from my iPad

&gt; On Aug 5, 2015, at 7:16 PM, Matthew Brender  wrote:
&gt; 
&gt; Hey all, I'm practicing what I preach and asking a question to others
&gt; here. A community member pinged me with a couple questions:
&gt; 
&gt; "I'm looking into an issue with Riak on our test environment (we
&gt; basically let devs spin up a copy of our prod stack on a giant box in
&gt; ec2).
&gt; 
&gt; We've gotten some complaints that riak seems to be using a lot of CPU,
&gt; even when "nothing" is happening (something is always happening with
&gt; the # of apps and services on the box, even when no one is poking it).
&gt; 
&gt; Is there a way to turn on an "access" log, so I could see what
&gt; requests are being made against riak, to try and correlate with? It
&gt; would have to be able to tell me about pbuffs usage, not just http."
&gt; 
&gt; Could anyone help with these questions. I see a couple separate ones:
&gt; 
&gt; 1. How to monitor what is causing higher CPU usage on a Riak cluster
&gt; 2. How to view an access log of protobuff and http requests, or just
&gt; the \*most helpful\* counters for them
&gt; 
&gt; I know a ton of statistics are visible [1] through riak-admin, but I'd
&gt; like to hear what others recommend in particular.
&gt; 
&gt; [1] http://docs.basho.com/riak/latest/ops/running/stats-and-monitoring/
&gt; 
&gt; Thanks,
&gt; 
&gt; Matt Brender | Developer Advocacy Lead
&gt; Basho Technologies
&gt; t: @mjbrender
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

