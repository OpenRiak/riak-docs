---
title: "Re: Ripple one Association Troubles"
description: ""
project: community
lastmod: 2011-02-08T11:54:38-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02223"
mailinglist_parent_id: "msg02222"
author_name: "Stephen Allred"
project_section: "mailinglistitem"
sent_date: 2011-02-08T11:54:38-08:00
---


I've tried commenting out the devise stuff and added the properties that came 
from devise:

--- user.rb ---
require 'ripple'
#require 'digest'

class User
 include Ripple::Document
 
 #devise :registerable, :confirmable, :database\_authenticatable, :recoverable, 
:validatable

 property :email, String, :presence =&gt; true
 property :password, String
 property :password\_confirmation, String
 property :encrypted\_password, String
 property :password\_salt, String
 property :reset\_password\_token, String
 property :confirmation\_token, String
 property :confirmed\_at, String
 property :confirmation\_sent\_at, String
 timestamps!
 
 key\_on :email
 
 def key
 email
 end

 def id
 email
 end
end
---

I'm still getting the same "(Object doesn't support #inspect)" when I call 
journal\_entry.user (nil class).

Cheers,
Steve


On 8 Feb 2011, at 7:01 PM, Sean Cribbs wrote:

&gt; I haven't played with ripple-devise. Try commenting those parts out first and 
&gt; see what happens.
&gt; 
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 
&gt; On Feb 8, 2011, at 1:53 PM, Stephen Allred wrote:
&gt; 
&gt;&gt; Sean,
&gt;&gt; 
&gt;&gt; Yeah, I fetched it in using User.first before trying to assign it.
&gt;&gt; 
&gt;&gt; Could this have something to do with using ripple-devise (the User document 
&gt;&gt; is a ripple-devise user)?
&gt;&gt; 
&gt;&gt; Thanks,
&gt;&gt; Steve
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On 8 Feb 2011, at 6:47 PM, Sean Cribbs wrote:
&gt;&gt; 
&gt;&gt;&gt; Stephen,
&gt;&gt;&gt; 
&gt;&gt;&gt; Was your User object saved before you added it the journal entry?
&gt;&gt;&gt; 
&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt; 
&gt;&gt;&gt; On Feb 8, 2011, at 1:46 PM, Stephen Allred wrote:
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Sean,
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; $ puts journal\_entry.robject.links.inspect
&gt;&gt;&gt;&gt; #; 
&gt;&gt;&gt;&gt; riaktag="user", ; riaktag="up"}&gt;
&gt;&gt;&gt;&gt; =&gt; nil 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; $ journal\_entry
&gt;&gt;&gt;&gt; =&gt; &gt;&gt;&gt; created\_at=2011-02-07 22:47:17 UTC updated\_at=2011-02-08 18:08:47 UTC&gt;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; $ journal\_entry.user
&gt;&gt;&gt;&gt; (Object doesn't support #inspect)
&gt;&gt;&gt;&gt; =&gt;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; $ journal\_entry.user.inspect
&gt;&gt;&gt;&gt; NoMethodError: undefined method `key' for nil:NilClass
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/activesupport-3.0.3/lib/active\_support/whiny\_nil.rb:48:in
&gt;&gt;&gt;&gt; `method\_missing'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:122:in
&gt;&gt;&gt;&gt; `block in instantiate'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
&gt;&gt;&gt;&gt; `tap'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
&gt;&gt;&gt;&gt; `instantiate'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/one\_linked\_proxy.rb:25:in
&gt;&gt;&gt;&gt; `find\_target'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:113:in
&gt;&gt;&gt;&gt; `load\_target'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:41:in
&gt;&gt;&gt;&gt; `inspect'
&gt;&gt;&gt;&gt; from (irb):17
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:44:in
&gt;&gt;&gt;&gt; `start'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:8:in
&gt;&gt;&gt;&gt; `start'
&gt;&gt;&gt;&gt; from 
&gt;&gt;&gt;&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands.rb:23:in
&gt;&gt;&gt;&gt; `'
&gt;&gt;&gt;&gt; from script/rails:6:in `require'
&gt;&gt;&gt;&gt; from script/rails:6:in `'
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Hopefully those are useful,
&gt;&gt;&gt;&gt; Thanks for the quick response!
&gt;&gt;&gt;&gt; Steve
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On 8 Feb 2011, at 6:37 PM, Sean Cribbs wrote:
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Stephen,
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Sounds like you've either found a bug. When you have saved the journal 
&gt;&gt;&gt;&gt;&gt; entry in irb, what is the output of this command?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; puts journal\_entry.robject.links.inspect
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; On Feb 8, 2011, at 1:23 PM, Stephen Allred wrote:
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Hi all,
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; I'm having trouble setting up a one association in a ripple document. 
&gt;&gt;&gt;&gt;&gt;&gt; I'm trying to setup an association between a user and a journal entry, 
&gt;&gt;&gt;&gt;&gt;&gt; such that the journal has one user, that the user created.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; My JournalEntry document:
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; --- journal\_entry.rb ---
&gt;&gt;&gt;&gt;&gt;&gt; require 'ripple'
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; class JournalEntry
&gt;&gt;&gt;&gt;&gt;&gt; include Ripple::Document
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; property :short\_title, String, :presence =&gt; true
&gt;&gt;&gt;&gt;&gt;&gt; property :title, String, :presence =&gt; true
&gt;&gt;&gt;&gt;&gt;&gt; property :entry, String, :presence =&gt; true
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; timestamps!
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; one :user
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; key\_on :short\_title
&gt;&gt;&gt;&gt;&gt;&gt; end
&gt;&gt;&gt;&gt;&gt;&gt; ---
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; My User document:
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; --- user.rb ---
&gt;&gt;&gt;&gt;&gt;&gt; require 'ripple'
&gt;&gt;&gt;&gt;&gt;&gt; require 'digest'
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; class User
&gt;&gt;&gt;&gt;&gt;&gt; include Ripple::Document
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; devise :registerable, :confirmable, :database\_authenticatable, 
&gt;&gt;&gt;&gt;&gt;&gt; :recoverable, :validatable
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; property :email, String, :presence =&gt; true
&gt;&gt;&gt;&gt;&gt;&gt; property :password, String
&gt;&gt;&gt;&gt;&gt;&gt; property :password\_confirmation, String
&gt;&gt;&gt;&gt;&gt;&gt; timestamps!
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; key\_on :email
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; def key
&gt;&gt;&gt;&gt;&gt;&gt; email
&gt;&gt;&gt;&gt;&gt;&gt; end
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; def id
&gt;&gt;&gt;&gt;&gt;&gt; email
&gt;&gt;&gt;&gt;&gt;&gt; end
&gt;&gt;&gt;&gt;&gt;&gt; end
&gt;&gt;&gt;&gt;&gt;&gt; ---
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; I've tried in the rails console to associate a user with journal\_entry 
&gt;&gt;&gt;&gt;&gt;&gt; (journal\_entry.user = user), save it and reload it. The resulting 
&gt;&gt;&gt;&gt;&gt;&gt; reloaded journal\_entry does not have a user (calling journal\_entry.user 
&gt;&gt;&gt;&gt;&gt;&gt; prints "(Object doesn't support #inspect)").
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; My journal entry in riak loaded via the browser looks like:
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; {"short\_title":"test","title":"test","entry":"test","created\_at":"Mon, 
&gt;&gt;&gt;&gt;&gt;&gt; 07 Feb 2011 22:47:17 -0000","updated\_at":"Tue, 08 Feb 2011 18:08:47 
&gt;&gt;&gt;&gt;&gt;&gt; -0000","\_type":"JournalEntry"}
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Does anyone know what I'm doing wrong?
&gt;&gt;&gt;&gt;&gt;&gt; Cheers!
&gt;&gt;&gt;&gt;&gt;&gt; Steve
&gt;&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt; 
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

