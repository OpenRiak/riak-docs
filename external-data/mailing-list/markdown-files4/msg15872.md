---
title: "Re: RiakCS large file uploads fail with 403/AccessDenied and	400/InvalidDigest"
description: ""
project: community
lastmod: 2015-03-10T22:39:37-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15872"
mailinglist_parent_id: "msg15870"
author_name: "Niels O"
project_section: "mailinglistitem"
sent_date: 2015-03-10T22:39:37-07:00
---


Hi!

I used the command below to make this http://we.tl/ijfcnmJqlS pcap

 tcpdump 'host 172.16.3.21' -s 65535 -i eth0 &gt; /opt/dump.pcap




On Wed, Mar 11, 2015 at 3:13 AM, Shunichi Shinohara  wrote:

&gt; ngrep does not show some bytes. tcpdump can dump network data in pcap
&gt; format.
&gt;
&gt; ex: sudo tcpdump -s 65535 -w /tmp/out.pcap -i eth0 'port 8080'
&gt; --
&gt; Shunichi Shinohara
&gt; Basho Japan KK
&gt;
&gt;
&gt; On Tue, Mar 10, 2015 at 7:30 PM, Niels O  wrote:
&gt; &gt; Hello Shino,
&gt; &gt;
&gt; &gt; I was uploading the attached file to riakCS so the correct MD5 digest
&gt; should
&gt; &gt; be calculatable
&gt; &gt;
&gt; &gt; I don't know how to generate a pcap formatted file from linux, but I
&gt; made an
&gt; &gt; ngrep which might also do the job? ...
&gt; &gt;
&gt; &gt; the ngrep below:
&gt; &gt;
&gt; &gt; interface: eth0 (172.16.0.0/255.255.248.0)
&gt; &gt; filter: (ip or ip6) and ( host 172.16.3.21 )
&gt; &gt; ####
&gt; &gt; T 172.16.2.99:35151 -&gt; 172.16.3.21:8080 [AP]
&gt; &gt; PUT http://testje.s3.amazonaws.com:443/4096k HTTP/1.1..User-Agent:
&gt; &gt; aws-sdk-nodejs/2.1.8 linux/v0.10.20..Content-Type:
&gt; &gt; application/octet-stream..Content-MD5:
&gt; &gt; 0BsQLab2tMEzr8IWoS2m5w==..Content-Length: 4194304..Host: testje.s3.
&gt; &gt; amazonaws.com..Expect: 100-continue..X-Amz-Date: Tue, 10 Mar 2015
&gt; 10:16:36
&gt; &gt; GMT..Authorization: AWS
&gt; &gt; GHSEZVCH4NYD359IZUEX:E2Ur8OR+po687h1c6/PUBx6gYzQ=..Connection: close....
&gt; &gt; ##
&gt; &gt; T 172.16.2.99:35151 -&gt; 172.16.3.21:8080 [AP]
&gt; &gt; PUT http://testje.s3.amazonaws.com:443/4096k HTTP/1.1..User-Agent:
&gt; &gt; aws-sdk-nodejs/2.1.8 linux/v0.10.20..Content-Type:
&gt; &gt; application/octet-stream..Content-MD5:
&gt; &gt; 0BsQLab2tMEzr8IWoS2m5w==..Content-Length: 4194304..Host: testje.s3.
&gt; &gt; amazonaws.com..Expect: 100-continue..X-Amz-Date: Tue, 10 Mar 2015
&gt; 10:16:36
&gt; &gt; GMT..Authorization: AWS
&gt; &gt; GHSEZVCH4NYD359IZUEX:E2Ur8OR+po687h1c6/PUBx6gYzQ=..Connection: close....
&gt; &gt; ##
&gt; &gt; T 172.16.3.21:8080 -&gt; 172.16.2.99:35151 [AP]
&gt; &gt; HTTP/1.1 100 Continue....
&gt; &gt; ##
&gt; &gt; T 172.16.2.99:35151 -&gt; 172.16.3.21:8080 [A]
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt; ##
&gt; &gt; T 172.16.2.99:35151 -&gt; 172.16.3.21:8080 [AP]
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt; ##
&gt; &gt;
&gt; &gt;
&gt; &gt; 
&gt; &gt;
&gt; &gt;
&gt; &gt; T 172.16.2.99:35151 -&gt; 172.16.3.21:8080 [A]
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt;
&gt; &gt;
&gt; 2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.2.
&gt; &gt; #####
&gt; &gt; T 172.16.3.21:8080 -&gt; 172.16.2.99:35151 [AP]
&gt; &gt; HTTP/1.1 400 Bad Request..Server: Riak CS..Date: Tue, 10 Mar 2015
&gt; 10:16:37
&gt; &gt; GMT..Content-Type: application/xml..Content-Length: 215....
&gt; &gt; #
&gt; &gt; T 172.16.3.21:8080 -&gt; 172.16.2.99:35151 [AP]
&gt; &gt; xml version="1.0"
 &gt; encoding="UTF-8"?&gt;`InvalidDigest`The
&gt; Content-MD5
&gt; &gt; you specified was
&gt; &gt;
&gt; invalid.0BsQLab2tMEzr8IWoS2m5w==host-id
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; On Tue, Mar 10, 2015 at 4:15 AM, Shunichi Shinohara 
&gt; wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Hi Niels,
&gt; &gt;&gt;
&gt; &gt;&gt; Thank you for your interest on Riak CS.
&gt; &gt;&gt;
&gt; &gt;&gt; Some questions about 400 - InvalidDigest:
&gt; &gt;&gt;
&gt; &gt;&gt; - Can you confirm which MD5 was correct for the log
&gt; &gt;&gt; 2015-02-11 16:34:17.854 [debug]
&gt; &gt;&gt; &lt;0.23568.18&gt;@riak\_cs\_put\_fsm:is\_digest\_valid:326
&gt; &gt;&gt; Calculated = &lt;&lt;"pIFX5fpeo7+sPPNjtSBWBg=="&gt;&gt;,
&gt; &gt;&gt; Reported = "0BsQLab2tMEzr8IWoS2m5w=="
&gt; &gt;&gt; - What was the transfer-encoding? I want to confirm chunked encoding
&gt; &gt;&gt; was NOT used.
&gt; &gt;&gt; - Hopefully, packet capture (e.g. by pcap format) will be helpful to
&gt; debug
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks,
&gt; &gt;&gt; Shino
&gt; &gt;&gt;
&gt; &gt;&gt; On Tue, Mar 10, 2015 at 10:25 AM, Kota Uenishi  wrote:
&gt; &gt;&gt; &gt; Sorry, being late. I thought I've replied to you, but it was a very
&gt; &gt;&gt; &gt; close one where I think you're hitting the same problem as this:
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2015-February/016845.html
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Riak CS often includes `=' in uploadId of multipart uploads while S3
&gt; &gt;&gt; &gt; doesn't (where no specs described in official documents).
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; On Thu, Feb 12, 2015 at 12:41 AM, Niels O  wrote:
&gt; &gt;&gt; &gt;&gt; Hello everyone,
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; I have just installed riakcs and have the s3cmd and nodejs (the
&gt; &gt;&gt; &gt;&gt; official
&gt; &gt;&gt; &gt;&gt; amazon) plugin working.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; with the same credentials (accesskey&secret) I CAN upload big files
&gt; &gt;&gt; &gt;&gt; with
&gt; &gt;&gt; &gt;&gt; S3CMD but I CANNOT with the AWS/S3 nodejs plugin? (downloading very
&gt; big
&gt; &gt;&gt; &gt;&gt; files is no problem b.t.w.)
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; with the nodejs plugin
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; - until 992k, (I tested with 32 KiB increases) everything works
&gt; &gt;&gt; &gt;&gt; - starting at 1024 KiB I get [400 InvalidDigest: The Content-MD5 you
&gt; &gt;&gt; &gt;&gt; specified was invalid.]
&gt; &gt;&gt; &gt;&gt; - from 8192 KiB and beyond I get [403 AccessDenied] back from riakcs.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; this while -again- with s3cmd I am able to upload files of over 1 GiB
&gt; &gt;&gt; &gt;&gt; size
&gt; &gt;&gt; &gt;&gt; easily .. same machine, same creds
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; any ideas?
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; (below some riakcs debug logging from both the 400 and 403) ...
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; 400 - InvalidDigest:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:34:16.911 [debug]
&gt; &gt;&gt; &gt;&gt; &lt;0.17889.18&gt;@riak\_cs\_s3\_auth:calculate\_signature:129 STS:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; ["PUT","\n","0BsQLab2tMEzr8IWoS2m5w==","\n","application/octet-stream","\n","\n",[["x-amz-date",":",&lt;&lt;"Wed,
&gt; &gt;&gt; &gt;&gt; 11 Feb 2015 15:34:16 GMT"&gt;&gt;,"\n"]],["/testje/4096k",[]]]
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:34:17.854 [debug]
&gt; &gt;&gt; &gt;&gt; &lt;0.23568.18&gt;@riak\_cs\_put\_fsm:is\_digest\_valid:326 Calculated =
&gt; &gt;&gt; &gt;&gt; &lt;&lt;"pIFX5fpeo7+sPPNjtSBWBg=="&gt;&gt;, Reported = "0BsQLab2tMEzr8IWoS2m5w=="
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:34:17.860 [debug] &lt;0.23568.18&gt;@riak\_cs\_put\_fsm:done:303
&gt; &gt;&gt; &gt;&gt; Invalid digest in the PUT FSM
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; 403 - AccessDenied
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:36:00.448 [debug]
&gt; &gt;&gt; &gt;&gt; &lt;0.22889.18&gt;@riak\_cs\_s3\_auth:calculate\_signature:129 STS:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; ["POST","\n",[],"\n","application/octet-stream","\n","\n",[["x-amz-date",":",&lt;&lt;"Wed,
&gt; &gt;&gt; &gt;&gt; 11 Feb 2015 15:36:00 GMT"&gt;&gt;,"\n"]],["/testje/8192k","?uploads"]]
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:36:00.484 [debug]
&gt; &gt;&gt; &gt;&gt; &lt;0.23539.18&gt;@riak\_cs\_s3\_auth:calculate\_signature:129 STS:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; ["PUT","\n","sq5d2PIhC7I1xxT8Rp9cVg==","\n","application/octet-stream","\n","\n",[["x-amz-date",":",&lt;&lt;"Wed,
&gt; &gt;&gt; &gt;&gt; 11 Feb 2015 15:36:00
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; GMT"&gt;&gt;,"\n"]],["/testje/8192k","?partNumber=1&uploadId=TXR2AuCeRDWwc2bviLPcOg=="]]
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:36:00.484 [debug]
&gt; &gt;&gt; &gt;&gt; &lt;0.23539.18&gt;@riak\_cs\_wm\_common:post\_authentication:471 bad\_auth
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:36:00.494 [debug]
&gt; &gt;&gt; &gt;&gt; &lt;0.23543.18&gt;@riak\_cs\_s3\_auth:calculate\_signature:129 STS:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; ["DELETE","\n",[],"\n","application/octet-stream","\n","\n",[["x-amz-date",":",&lt;&lt;"Wed,
&gt; &gt;&gt; &gt;&gt; 11 Feb 2015 15:36:00
&gt; &gt;&gt; &gt;&gt; GMT"&gt;&gt;,"\n"]],["/testje/8192k","?uploadId=TXR2AuCeRDWwc2bviLPcOg=="]]
&gt; &gt;&gt; &gt;&gt; 2015-02-11 16:36:00.494 [debug]
&gt; &gt;&gt; &gt;&gt; &lt;0.23543.18&gt;@riak\_cs\_wm\_common:post\_authentication:471 bad\_auth
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt;&gt; &gt;&gt; riak-users mailing list
&gt; &gt;&gt; &gt;&gt; riak-users@lists.basho.com
&gt; &gt;&gt; &gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; --
&gt; &gt;&gt; &gt; Kota UENISHI / @kuenishi
&gt; &gt;&gt; &gt; Basho Japan KK
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt;&gt; &gt; riak-users mailing list
&gt; &gt;&gt; &gt; riak-users@lists.basho.com
&gt; &gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt; &gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

