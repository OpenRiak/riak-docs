---
title: "Re: Bitcask with sync_strategy o_sync seem to have no effect"
description: ""
project: community
lastmod: 2011-09-05T06:00:03-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04575"
mailinglist_parent_id: "msg04531"
author_name: "David Smith"
project_section: "mailinglistitem"
sent_date: 2011-09-05T06:00:03-07:00
---


On Tue, Aug 30, 2011 at 8:57 PM, Tatsuya Kawano  wrote:

&gt; My colleague checked Bitcask implementation and found that it uses "fcntl 
&gt; (2)" system call to set O\_SYNC flag to the file descriptor. Unfortunately, 
&gt; O\_SYNC being set by this way will be ignored by kernel and has no effect. To 
&gt; make it work, Betcask should call "open" system call with O\_SYNC option.

Here's the rub -- we use the Erlang VM to open the file and it doesn't
understand the O\_SYNC option (and arguably shouldn't). We'll have to
patch the VM in order to get it to do the right thing on Linux.

In the interim, we will probably just generate a warning message when
using this option on Linux. Thanks for pointing it out!

D.

-- 
Dave Smith
Director, Engineering
Basho Technologies, Inc.
diz...@basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

