---
title: "Re: Have Riak servers in separate cluster behind a load balancer,	or  on same machines as web server?"
description: ""
project: community
lastmod: 2011-10-04T20:37:37-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05044"
mailinglist_parent_id: "msg05043"
author_name: "Aphyr"
project_section: "mailinglistitem"
sent_date: 2011-10-04T20:37:37-07:00
---


Internode times in our datacenter at SL are indistinguishible from 
loopback; TCP/IP processing dominates. HTTP, on the other hand, involves 
either in-depth connection management/multiplexing, or TCP/IP 
setup/teardown latency at either end of a request. In read-write heavy 
apps, protobufs outperforms HTTP in throughput by 2x or more, against 
objects of 500-4000 bytes. That's with the ruby client; ymmv.


--Kyle

On 10/04/2011 07:18 PM, Greg Stein wrote:


On Oct 4, 2011 7:01 PM, "Mike Oxford" &gt; wrote:
 &gt;
 &gt; You'll want to run protobufs if you're looking to optimize your
 &gt; response time; HTTP sockets (even to localhost) will require much more
 &gt; overhead and time.

Hmm? The protocol seems moot, compared to inter-node comms when r &gt; 1
Protocol parsing just doesn't seem like much of a factor. On my laptop,
I was seeing a 3ms response time against one node. I can't imagine that
parsing was more than a few percent, no matter the protocol.

(and no, I have no specific numbers to confirm/deny my thought
experiment here)

 &gt; Even better would be unix sockets if they're available, and you can
 &gt; bypass the whole TCP stack.

What? Is that even an option for Riak? I haven't seen anything about that.

 &gt;...

Cheers,
-g



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

