---
title: "Re: Is it possible/wise to modify riak search index objects?"
description: ""
project: community
lastmod: 2012-07-21T02:22:03-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08011"
mailinglist_parent_id: "msg08010"
author_name: "Metin Akat"
project_section: "mailinglistitem"
sent_date: 2012-07-21T02:22:03-07:00
---


Wow, didn't know about that. Thank you!

On Sat, Jul 21, 2012 at 11:29 AM, Alexander Sicular wrote:

&gt; Na. It should index via the standard analyzer which splits on spaces,
&gt; among other things (check riak handbook - great resource). The "guid:val"
&gt; would index as a string so guid:100 should show up in a search for
&gt; [guid:050 TO guid:250]. Try it out.
&gt;
&gt;
&gt;
&gt; @siculars
&gt; http://siculars.posterous.com
&gt;
&gt; Sent from my iRotaryPhone
&gt;
&gt; On Jul 21, 2012, at 4:17, Metin Akat  wrote:
&gt;
&gt; Yes, but that would require me to write a custom search analyzer to parse
&gt; this, upload erlang code to riak etc, right? Or is there something I don't
&gt; know? Please, elaborate
&gt;
&gt; On Sat, Jul 21, 2012 at 11:06 AM, Alexander Sicular wrote:
&gt;
&gt;&gt; The overhead would be in parsing. But you could skip all that if you
&gt;&gt; prepended constant length data to your text. Something like :
&gt;&gt;
&gt;&gt; Field:Val field:Val text
&gt;&gt;
&gt;&gt; Where field and Val length are constant.
&gt;&gt;
&gt;&gt; Maybe like a guid:100
&gt;&gt;
&gt;&gt; Where that guid is known to you to be the file size.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; @siculars
&gt;&gt; http://siculars.posterous.com
&gt;&gt;
&gt;&gt; Sent from my iRotaryPhone
&gt;&gt;
&gt;&gt; On Jul 21, 2012, at 2:16, Metin Akat  wrote:
&gt;&gt;
&gt;&gt; I was thinking about this too, but as I said, these text files are
&gt;&gt; sometimes quite big. Sometimes megabytes. Rarely - tens of megabytes. They
&gt;&gt; are all "write once, read quite a lot". So having them as JSON is probably
&gt;&gt; going to put quite a lot of load onto riak and my application (deserialize
&gt;&gt; a big chunk of JSON on every read). Of course, I might be wrong, I'll have
&gt;&gt; to benchmark it probably, but I don't really feel very comfortable about
&gt;&gt; it. Besides of potentially being a performance issue, it also feels quite
&gt;&gt; ugly to me. Have you done this? How big files? How's the performance?
&gt;&gt;
&gt;&gt; On Sat, Jul 21, 2012 at 7:52 AM, Alexander Sicular wrote:
&gt;&gt;
&gt;&gt;&gt; Turn your text into a json obj. Maybe something like this:
&gt;&gt;&gt;
&gt;&gt;&gt; { size: 100
&gt;&gt;&gt; Name: bla
&gt;&gt;&gt; Date: 1/1/2012
&gt;&gt;&gt; Raw\_txt: txt
&gt;&gt;&gt; }
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; @siculars
&gt;&gt;&gt; http://siculars.posterous.com
&gt;&gt;&gt;
&gt;&gt;&gt; Sent from my iRotaryPhone
&gt;&gt;&gt;
&gt;&gt;&gt; On Jul 20, 2012, at 17:49, Metin Akat  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; &gt; Hi,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; I am using riak to store (relatively large) text files. I store them
&gt;&gt;&gt; as normal riak objects where the value is the text of the file. Now I want
&gt;&gt;&gt; to index and search them. All is fine, I just enabled the "standard" search
&gt;&gt;&gt; pre-commit hook for that bucket and they get indexed nicely. But, there is
&gt;&gt;&gt; one tricky requirement. I need to be able to index and search some metadata
&gt;&gt;&gt; about these files. For example date of submission, size of file, type
&gt;&gt;&gt; (internal business logic) of file etc.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; I have been thinking quite a lot about this recently. Asked several
&gt;&gt;&gt; times on #riak. I got one answer suggesting that I create a second
&gt;&gt;&gt; "metadata" riak object for each file, link it to the "file object" and
&gt;&gt;&gt; index it separately. That's not really what I want, because I need to be
&gt;&gt;&gt; able to execute "combined" queries, like value: AND date:&gt;&gt; date&gt;.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; So, here is the ideal solution that I'm thinking about.... It would be
&gt;&gt;&gt; great if it's possible to modify the riak search index object. After the
&gt;&gt;&gt; file is submitted, and after it's indexed, I could just fetch the index and
&gt;&gt;&gt; just add some more fields to it.
&gt;&gt;&gt; &gt; I see there is a bucket with the search index objects that's
&gt;&gt;&gt; automatically created by riak search. So I guess it is indeed possible,
&gt;&gt;&gt; though I don't know what to expect. Is it a good idea? If not, what else
&gt;&gt;&gt; could I do in order to solve the problem?
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Regards,
&gt;&gt;&gt; &gt; Metin
&gt;&gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; &gt; riak-users mailing list
&gt;&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

