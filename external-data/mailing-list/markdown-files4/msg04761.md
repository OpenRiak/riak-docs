---
title: "Re: Problem running riak-1.0.0pre2 list_buckets"
description: ""
project: community
lastmod: 2011-09-16T09:16:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04761"
mailinglist_parent_id: "msg04760"
author_name: "Kelly McLaughlin"
project_section: "mailinglistitem"
sent_date: 2011-09-16T09:16:21-07:00
---


Antoine,

I've been able to reproduce this problem and I've created a bugzilla ticket to 
fix the issue: https://issues.basho.com/show\_bug.cgi?id=1202. Thanks for the 
report and we'll get it fixed asap.

Kelly


On Sep 16, 2011, at 9:29 AM, Antoine wrote:

&gt; Kelly,
&gt; 
&gt; I tried checking out the pre3 tag and with a subset of the data I used 
&gt; before. If I try to add a few keys (simple empty objects) it's ok I can list 
&gt; the buckets. The error arise for example after the following objects have 
&gt; been saved:
&gt; 
&gt; curl -v 
&gt; http://localhost:8098/riak/internal:schemas:schemas/loaded:1316018615776810
&gt; \* About to connect() to localhost port 8098 (#0)
&gt; \* Trying 127.0.0.1... connected
&gt; \* Connected to localhost (127.0.0.1) port 8098 (#0)
&gt; &gt; GET /riak/internal:schemas:schemas/loaded:1316018615776810 HTTP/1.1
&gt; &gt; User-Agent: curl/7.21.3 (x86\_64-pc-linux-gnu) libcurl/7.21.3 OpenSSL/0.9.8o 
&gt; &gt; zlib/1.2.3.4 libidn/1.18
&gt; &gt; Host: localhost:8098
&gt; &gt; Accept: \*/\*
&gt; &gt; 
&gt; &lt; HTTP/1.1 200 OK
&gt; &lt; X-Riak-Vclock: a85hYGBgzGDKBVIcypz/fvoVp8/OYEpkzGNlUH3y/DhfFgA=
&gt; &lt; X-Riak-Meta-user\_id: idmog
&gt; &lt; X-Riak-Meta-source: asusci7-loader
&gt; &lt; X-Riak-Meta-occured\_at: 1316018615776810
&gt; &lt; X-Riak-Meta-noticed\_at: 1316018615776812
&gt; &lt; X-Riak-Meta-mogbox\_id: asusci7
&gt; &lt; X-Riak-Meta-event\_type\_id: loaded
&gt; &lt; X-Riak-Meta-event\_type\_cat: internal
&gt; &lt; X-Riak-Meta-client\_ip: 192.168.0.10
&gt; &lt; X-Riak-Meta-aggr\_schema\_id: schemas
&gt; &lt; X-Riak-Meta-aggr\_id: schemas
&gt; &lt; x-riak-index-occured\_at\_int: 1316018615776810
&gt; &lt; x-riak-index-noticed\_at\_int: 1316018615776812
&gt; &lt; x-riak-index-mogbox\_id\_bin: asusci7
&gt; &lt; x-riak-index-event\_type\_id\_bin: loaded
&gt; &lt; x-riak-index-event\_type\_cat\_bin: internal
&gt; &lt; x-riak-index-aggr\_schema\_id\_bin: schemas
&gt; &lt; x-riak-index-aggr\_id\_bin: schemas
&gt; &lt; Vary: Accept-Encoding
&gt; &lt; Server: MochiWeb/1.1 WebMachine/1.9.0 (participate in the frantic)
&gt; &lt; Link: ; riaktag="aggregate", 
&gt; ; rel="up"
&gt; &lt; Last-Modified: Fri, 16 Sep 2011 15:15:49 GMT
&gt; &lt; ETag: "51h3q7RjTNaHWYpO4P0MJj"
&gt; &lt; Date: Fri, 16 Sep 2011 15:20:17 GMT
&gt; &lt; Content-Type: application/x-erlang-term
&gt; &lt; Content-Length: 353
&gt; 
&gt; and 
&gt; 
&gt; curl -v http://localhost:8098/riak/schemas/schemas
&gt; \* About to connect() to localhost port 8098 (#0)
&gt; \* Trying 127.0.0.1... connected
&gt; \* Connected to localhost (127.0.0.1) port 8098 (#0)
&gt; &gt; GET /riak/schemas/schemas HTTP/1.1
&gt; &gt; User-Agent: curl/7.21.3 (x86\_64-pc-linux-gnu) libcurl/7.21.3 OpenSSL/0.9.8o 
&gt; &gt; zlib/1.2.3.4 libidn/1.18
&gt; &gt; Host: localhost:8098
&gt; &gt; Accept: \*/\*
&gt; &gt; 
&gt; &lt; HTTP/1.1 200 OK
&gt; &lt; X-Riak-Vclock: a85hYGBgzGDKBVIcypz/fvoVp8/IYEpkzGNlUHny/DhfFgA=
&gt; &lt; X-Riak-Meta-$rev: AUEOhgAHc9MSA2MHOvC-M4uLIDc=
&gt; &lt; Vary: Accept-Encoding
&gt; &lt; Server: MochiWeb/1.1 WebMachine/1.9.0 (participate in the frantic)
&gt; &lt; Link: ; rel="up"
&gt; &lt; Last-Modified: Fri, 16 Sep 2011 15:15:48 GMT
&gt; &lt; ETag: "51h3q7RjTNaHWYpO4P0MJj"
&gt; &lt; Date: Fri, 16 Sep 2011 15:22:07 GMT
&gt; &lt; Content-Type: application/json
&gt; &lt; Content-Length: 629
&gt; 
&gt; It was working fine some time ago on master but I cannot remember exactly at 
&gt; which commit.
&gt; I suspect I try to put objects with some badly formatted/configured headers? 
&gt; However I still manage to put and get the objects.
&gt; 
&gt; Regards,
&gt; Antoine
&gt; 
&gt; On 16 September 2011 16:45, Kelly McLaughlin  wrote:
&gt; Antoine,
&gt; 
&gt; I don't have 1.0.0pre2 installed anywhere handy at the moment, but I do have 
&gt; pre3 installed and I tested with eleveldb and it works fine for me. Could you 
&gt; download pre3 and see if that resolves the issue for you? Thanks.
&gt; 
&gt; Kelly
&gt; 
&gt; 
&gt; On Sep 16, 2011, at 8:08 AM, t3h wrote:
&gt; 
&gt; &gt; Hello all,
&gt; &gt;
&gt; &gt; I got these errors after having upgraded to riak-1.0.0pre2 when using list 
&gt; &gt; buckets:
&gt; &gt;
&gt; &gt; {ok, C} = riak:local\_client().
&gt; &gt; C:list\_buckets().
&gt; &gt;
&gt; &gt; gives:
&gt; &gt;
&gt; &gt; 2011-09-16 15:01:32.613 [error] &lt;0.971.0&gt; gen\_server &lt;0.971.0&gt; terminated 
&gt; &gt; with reason: bad return value: {break,{buffer,[ ...part of my list of 
&gt; &gt; buckets... ],#Fun,999,4}}
&gt; &gt; 2011-09-16 15:01:32.711 [error] &lt;0.971.0&gt; CRASH REPORT Process [] with 0 
&gt; &gt; neighbours crashed with reason: bad return value: {break,{buffer,[...other 
&gt; &gt; part of my list of buckets... ],#Fun,999,4}}
&gt; &gt; 2011-09-16 15:01:32.767 [error] &lt;0.427.0&gt; gen\_server &lt;0.427.0&gt; terminated 
&gt; &gt; with reason: bad return value: {break,{buffer,[...other part of my list of 
&gt; &gt; buckets... ],#Fun,999,10}}
&gt; &gt; 2011-09-16 15:01:32.842 [error] &lt;0.427.0&gt; CRASH REPORT Process [] with 0 
&gt; &gt; neighbours crashed with reason: bad return value: {break,{buffer,[...other 
&gt; &gt; part of my list of buckets... ],#Fun,999,10}}
&gt; &gt; 2011-09-16 15:01:32.937 [error] &lt;0.426.0&gt; Supervisor poolboy\_sup had child 
&gt; &gt; riak\_core\_vnode\_worker started with 
&gt; &gt; {riak\_core\_vnode\_worker,start\_link,undefined} at &lt;0.427.0&gt; exit with reason 
&gt; &gt; bad return value: {break,{buffer,[...other part of my list of buckets... 
&gt; &gt; ],#Fun,999,10}} in context child\_terminated
&gt; &gt;
&gt; &gt; and so on for each poolboy supervisor...
&gt; &gt;
&gt; &gt; I tested it against a new empty cluster to be sure not to mix legacy key 
&gt; &gt; listing with new key listing.
&gt; &gt; I use the eleveldb\_backend and objects stored have indexes.
&gt; &gt; I can list the keys in a bucket without any issue.
&gt; &gt; Am I missing something I should have changed upgrading to 1.0.0?
&gt; &gt;
&gt; &gt; As well, riak objects used to have x-riak-index-$bucket and 
&gt; &gt; x-riak-index-$key indexes when I first attempted to use secondary indexes. 
&gt; &gt; I do not see this anymore. What is the reason for this change and should I 
&gt; &gt; be careful not to override any "built-in" indexes when writting my index 
&gt; &gt; headers (using the PBC api)?
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Antoine
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

