---
title: "Re: RiakCS node crash +90% disk i/o"
description: ""
project: community
lastmod: 2014-12-03T06:33:12-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15310"
mailinglist_parent_id: "msg15309"
author_name: "Jon Meredith"
project_section: "mailinglistitem"
sent_date: 2014-12-03T06:33:12-08:00
---


Hi Alex. 

It looks like you exceeded the files ulimit. Information on how to fix is here 

http://docs.basho.com/riak/latest/ops/tuning/open-files-limit/#Changing-the-limit

Jon

&gt; On Dec 3, 2014, at 7:15 AM, Alex Millar  wrote:
&gt; 
&gt; Good morning Riak-Users
&gt; 
&gt; Last night one of the nodes in my 5 node RiakCS cluster went haywire and shot 
&gt; up to +90% disk i/o utilization seemingly out of the blue.
&gt; 
&gt; Looking at the riak error.log I saw the following being continuously written.
&gt; 
&gt; 2014-12-02 21:57:13.220 [error] &lt;0.29210.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29210.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/570899077082383952423314387779798054553098649600/CURRENT:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.226 [error] &lt;0.29211.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29211.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/776422744832042175295707567380525354192214163456/LOCK:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.226 [error] &lt;0.29212.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29212.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/570899077082383952423314387779798054553098649600/CURRENT:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.226 [error] &lt;0.29213.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29213.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/776422744832042175295707567380525354192214163456/CURRENT:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.286 [error] &lt;0.29215.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29215.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/776422744832042175295707567380525354192214163456/LOCK:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.286 [error] &lt;0.29214.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29214.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/570899077082383952423314387779798054553098649600/LOCK:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.286 [error] &lt;0.29217.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29217.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/570899077082383952423314387779798054553098649600/LOCK:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.287 [error] &lt;0.29216.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29216.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/776422744832042175295707567380525354192214163456/LOCK:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:13.312 [error] &lt;0.29219.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29219.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/570899077082383952423314387779798054553098649600/LOCK:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 2014-12-02 21:57:15.634 [error] &lt;0.29218.3089&gt; CRASH REPORT Process 
&gt; &lt;0.29218.3089&gt; with 0 neighbours exited with reason: no match of right hand 
&gt; value {error,{db\_open,"IO error: 
&gt; /var/lib/riak/anti\_entropy/776422744832042175295707567380525354192214163456/CURRENT:
&gt; Too many open files"}} in hashtree:new\_segment\_store/2 line 505 in 
&gt; gen\_server:init\_it/6 line 328
&gt; 
&gt; Leading up to this there didnâ€™t appear to be any significant load on our 
&gt; cluster. 
&gt; 
&gt; I simply restarted the node and the issue went away but I wanted to reach out 
&gt; to get some help as to why / how this arose in the first place.
&gt; 
&gt; Regards,
&gt; 
&gt; Alex Millar, CTO 
&gt; Office: 1-800-354-8010 ext. 704 
&gt; Mobile: 519-729-2539 
&gt; GoBonfire.com
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

