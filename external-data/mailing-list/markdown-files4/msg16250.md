---
title: "Understand when Riak is 'dropping internal caching structures'?"
description: ""
project: community
lastmod: 2015-06-16T13:34:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16250"
author_name: "Sam Tavakoli"
project_section: "mailinglistitem"
sent_date: 2015-06-16T13:34:55-07:00
---



-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

I've gone through the great post[1] by Meltwater and a couple of things
caught my eye.

One of which is "The only thing we noticed inside Riak, that correlated
to the elevated load, was that it dropped its internal caching
structures, the ETS tables. This was pointing to a memory issue"

They don't mention what backend they're using but I'm guessing it's
LevelDB. As far as I know Bitcask relies on file system caches[2] and
'memory' backend which is basically ETS tables isn't such a great idea
for persistence.

Since levelDB does indeed do caching[3] it's kind of clear that it's all
about it. I've mostly used Riak with Bitcask backend so I'm not familiar
with LevelDB inner plumbings.

What I would like to know is how they figured out that Riak is dropping
the levelDB backend caching. Was it simply monitoring ETS heap size[4]
or is there a metric available that I have overlooked?

Thanks,
Sam

[1]
http://underthehood.meltwater.com/blog/2015/04/14/riak-elasticsearch-and-numad-walk-into-a-red-hat/
[2] "Bitcask depends on filesystem caches"
http://docs.basho.com/riak/latest/ops/advanced/backends/bitcask/
[3] leveldb.maximum\_memory.percent
http://docs.basho.com/riak/latest/ops/advanced/backends/leveldb/#Installing-eLevelDB
[4] memory\_ets
http://docs.basho.com/riak/latest/ops/running/nodes/inspecting/
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVgIgYAAoJEO4RrVgri0dn4aUQAJgKV/WVzlailww8u+5Zb/0H
KRETcobF3GB0OUIC9N3LxThbB8CuEFk3Ii+dCz79iq5Kt2esY3m5ekKwq1No2NvS
ONNAB56Me23XidHP12B46FffpYRgMuVuF7j/Vwj3M+B/bo11mrl5vK+mcMLkp5oD
sveMIOpGvtZTryeYLXDYCIAvy0zzq2NlXq6SIkzlkywblVC97X9HNf7htBYv0xm4
kfMowENGMSF4XifhN4gnk8C+r555DkOHHEk6ld2gNcf+werMDhHgD+r4mATISwCX
t4ilmYI9yaRZyS/Y7BaT6/uT+h1lZBsHHsivvLeS8Baws+C9uotaty46U5oQKMWL
LeUgj8RVm5hh8IByiVhLrFA3HV1UtNURi3+/LzJvMJgM7L4kAhyRDHy6JC3Cc62X
fytsgBTtk7qbOgYYeuwZZVN+60fCQfA++ADq+aLQSb5dLqI8gJI3cTguAru7fSga
mGnUqQsHlFf0AS7SJ6Uc3FnfWaB56rjMJak3FN95hJVZ3QY4D1cj4/l7PcKTBxOO
YXW/1FAYxdQEzQ7X6WtYNVdFnAlVHROgC8ymKbuobko51XnnVHq/VihcMpqUskjF
7g2/jO6MJz2fdka7e43Yeahi2oBjkdkf7kK2P7hb1C69Br9Dqy7NnKRrqfNhz3sE
eIXucnJLZvs4CJJ4WpCr
=gte+
-----END PGP SIGNATURE-----



0x2B8B4767.asc
Description: application/pgp-keys
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

