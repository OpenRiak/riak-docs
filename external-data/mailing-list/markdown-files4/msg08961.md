---
title: "Re: Is Riak suitable for s small-record write-intensive	billion-records application?"
description: ""
project: community
lastmod: 2012-10-18T07:17:41-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08961"
mailinglist_parent_id: "msg08960"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2012-10-18T07:17:41-07:00
---


TL;DR version: Riak works, storage overhead will be more than you think.

Good point, Alex, it was easy to forget about overhead.

I did some quick digging and the best info I can find is a delightful
exchange between Alex and I around April of last year [1] and this awesome
email from Nico Meyer back in May of 2011[2]. Another option is to use the
magical Bitcask capacity sizing page in the documentation[3]. Yes, it's for
Bitcask. No, I couldn't find something for LevelDB.

Based on Alex's recollection and Nico's math, you can expect between ~120
and ~380 bytes of overhead per object when you're using bitcask. LevelDB
should be similar, but compression may help out here if you're storing
repetitive values or if integer compression kicks in.

However, if you have any likelihood of updates in your application, you can
see additional growth in the object headers - vector clocks may grow and
there's always a possibility of siblings if writes come in fast (object
overhead goes up again with siblings being stored alongside the object).

[1]:
http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2011-August/005178.html
[2]:
http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2011-May/004292.html
[3]:
http://docs.basho.com/riak/latest/references/appendices/Bitcask-Capacity-Planning/

---
Jeremiah Peschka
Managing Director, Brent Ozar PLF, LLC


On Thu, Oct 18, 2012 at 6:53 AM, Alexander Sicular wrote:

&gt; I've read the other replies and I'm gonna be the downer at this party.
&gt; Imho, Riak is not well suited to small value applications due to on disk
&gt; overhead. Last time this came up on the list, I recall there being a ~450
&gt; byte overhead per key. If that still holds, and I believe it does, you need
&gt; to factor it into your disk space calculations.
&gt;
&gt; Otherwise, your criteria are well within the capabilities of Riak. Use the
&gt; leveldb backend and in your client code run a get before a put and you'll
&gt; be fine. Of course, if you're writing a single key in rapid succession you
&gt; need to consider the eventual consistency nature of Riak and factor that
&gt; into your design.
&gt;
&gt; Keep us posted,
&gt; Alexander
&gt;
&gt;
&gt; @siculars
&gt; http://siculars.posterous.com
&gt;
&gt; Sent from my iRotaryPhone
&gt;
&gt; On Oct 18, 2012, at 7:42, Yassen Damyanov  wrote:
&gt;
&gt; &gt; Hi everyone,
&gt; &gt;
&gt; &gt; Absolutely new (and ignorant) to NoSQL solutions and to Riak (my
&gt; &gt; apologies; but extensive experience with SQL RDBMS).
&gt; &gt;
&gt; &gt; We consider a NoSQL DB deployment for a mission-critical application
&gt; &gt; where we need to store several hundreds of MILLIONS of data records,
&gt; &gt; each record consisting of about 6 string fields, record total length
&gt; &gt; is 160 bytes. There is a unique key in each record that seems suitable
&gt; &gt; for hashing (20+ bytes string, e.g. "cle01\_tpls01\_2105328884").
&gt; &gt;
&gt; &gt; The application should be able to write several hundreds of new
&gt; &gt; records per second, but first check if the unique key already exists.
&gt; &gt; Writing is to be done only if it is not there. If it is, the app needs
&gt; &gt; to retrieve the whole record and return it to the client and no
&gt; &gt; writing is done in this case.
&gt; &gt;
&gt; &gt; I need to know if Riak would be suitable for such application. Please,
&gt; &gt; advice, thanks!
&gt; &gt;
&gt; &gt; (Again, apologies for my ignorance. If we choose Riak, I promise to
&gt; &gt; get educated ;)
&gt; &gt;
&gt; &gt; Yassen
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

