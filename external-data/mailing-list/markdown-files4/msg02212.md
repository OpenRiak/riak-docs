---
title: "Re: Riak Cluster Setup on EC2"
description: ""
project: community
lastmod: 2011-02-07T04:50:24-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02212"
mailinglist_parent_id: "msg02176"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-02-07T04:50:24-08:00
---


This has been there all along (albeit not named "EC2" specifically):

http://wiki.basho.com/Network-Security-and-Firewall-Configurations.html

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Feb 7, 2011, at 6:28 AM, Abhishek Kona wrote:

&gt; Thanks a lot for the help folks.
&gt; And sorry for the late reply. 
&gt; 
&gt; I could set the ports up after including 
&gt; {kernel, [
&gt; {inet\_dist\_listen\_min, 8000},
&gt; {inet\_dist\_listen\_max, 8088}
&gt; ]}
&gt; 
&gt; in my app.config. 
&gt; 
&gt; It would be great if there could be a page to guide ec2 setup of riak on the 
&gt; wiki.
&gt; 
&gt; Thanks 
&gt; Abhishek Kona
&gt; 
&gt; On 03/02/11 1:51 AM, John D. Rowell wrote:
&gt;&gt; 
&gt;&gt; You need to open the extra erlang ports in your security group. We do the 
&gt;&gt; following:
&gt;&gt; 
&gt;&gt; In the security group, open up TCP port 4369 to 10.0.0.0/8, and ports 
&gt;&gt; 8000-8089 (or other range) to 10.0.0.0/8 also. This would allow any instance 
&gt;&gt; (even those that are not yours) to access those ports, so we block those 
&gt;&gt; outside of our cluster in our firewall script:
&gt;&gt; 
&gt;&gt; # epmd from other replicas
&gt;&gt; allow\_tcp\_in\_from 4369 "$CLUSTER"
&gt;&gt; allow\_tcp\_in\_from "8000:8089" "$CLUSTER"
&gt;&gt; 
&gt;&gt; Then in app.config we redefine the erlang ports:
&gt;&gt; 
&gt;&gt; {kernel, [
&gt;&gt; {inet\_dist\_listen\_min, 8000},
&gt;&gt; {inet\_dist\_listen\_max, 8088}
&gt;&gt; ]}
&gt;&gt; 
&gt;&gt; You need to make sure that all machines in your cluster have these same 
&gt;&gt; settings (firewall and app.config).
&gt;&gt; 
&gt;&gt; Hope this helps.
&gt;&gt; 
&gt;&gt; -jd
&gt;&gt; 
&gt;&gt; 2011/2/2 Abhishek Kona 
&gt;&gt; Hey,
&gt;&gt; 
&gt;&gt; epmd -name gives the following on the nodes.
&gt;&gt; 
&gt;&gt; #node1
&gt;&gt; ubuntu@node2:~$ sudo epmd -names
&gt;&gt; epmd: up and running on port 4369 with data:
&gt;&gt; name riak at port 34358
&gt;&gt; #node2
&gt;&gt; ubuntu@node1:~$ sudo epmd -names
&gt;&gt; epmd: up and running on port 4369 with data:
&gt;&gt; name riak at port 42643
&gt;&gt; 
&gt;&gt; I can telnet to the 4369 port on both the machines (from each other). 
&gt;&gt; 
&gt;&gt; Any ideas.
&gt;&gt; 
&gt;&gt; Thanks
&gt;&gt; -Abhishek Kona
&gt;&gt; 
&gt;&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

