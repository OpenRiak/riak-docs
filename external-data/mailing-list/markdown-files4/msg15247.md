---
title: "Re: How to update existed schema"
description: ""
project: community
lastmod: 2014-11-25T10:00:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15247"
mailinglist_parent_id: "msg15243"
author_name: "Eric Redmond"
project_section: "mailinglistitem"
sent_date: 2014-11-25T10:00:06-08:00
---


Did you reload the index as Geoff wrote?



On Nov 25, 2014, at 9:54 AM, Yang Zhenguo  wrote:

&gt; Hi Alexander,
&gt; 
&gt; As I understood, If I dont re-write each key, I can not search the old 
&gt; objects. But I did the following steps:
&gt; 1. insert a new data;
&gt; 2. search the new data with new field. (doesn't work)
&gt; 
&gt; Any idea?
&gt; 
&gt; Regards,
&gt; Zhenguo
&gt; 
&gt; 2014-11-26 1:35 GMT+08:00 Alexander Sicular :
&gt; You basically need to read and re-write each key as Geoff says. Hopefully 
&gt; this gets automated in the future in some fashion. 
&gt; 
&gt; -Alexander 
&gt; 
&gt; @siculars
&gt; http://siculars.posthaven.com
&gt; 
&gt; Sent from my iRotaryPhone
&gt; 
&gt; On Nov 25, 2014, at 12:31, Geoff Garbers  wrote:
&gt; 
&gt;&gt; Hey Zhenguo.
&gt;&gt; 
&gt;&gt; I've actually just gone through something similar myself recently.​ ​I found 
&gt;&gt; that the most reliable way to do this is as follows:
&gt;&gt; 
&gt;&gt; 1. Update the schema (as you have shown)
&gt;&gt; 2. Attach to the Erlang console on each node, and run 
&gt;&gt; rp(yz\_index:reload(&lt;&lt;"index\_name"&gt;&gt;)).
&gt;&gt; ​3. List all keys in the buckets with your bucket type, and pull and put 
&gt;&gt; each of the objects in those buckets.
&gt;&gt; 
&gt;&gt; It's not the most ideal way, but it's the most effective (from what I've 
&gt;&gt; found) until the new sear​ch administration functionality becomes available.
&gt;&gt; 
&gt;&gt; Regards,
&gt;&gt; Geoff
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Geoffrey Garbers
&gt;&gt; Senior Developer
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Cell: +27 (0)766 476 920
&gt;&gt; Skype: geoff.garbers
&gt;&gt; ge...@totalsend.com
&gt;&gt; www.totalsend.com
&gt;&gt; 
&gt;&gt; +1 347-431-0494
&gt;&gt; +44 (0)203 519 1082
&gt;&gt; +61 (0)3 9111 5760
&gt;&gt; +27 (0)21 200 6981
&gt;&gt; 
&gt;&gt; On Tue, Nov 25, 2014 at 6:46 PM, Yang Zhenguo  wrote:
&gt;&gt; Any other options? :)
&gt;&gt; 
&gt;&gt; 2014-11-26 0:42 GMT+08:00 Eric Redmond :
&gt;&gt; Yes, that is one of the options.
&gt;&gt; 
&gt;&gt; Eric
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Nov 25, 2014, at 8:40 AM, Yang Zhenguo  wrote:
&gt;&gt; 
&gt;&gt;&gt; Hi Eric,
&gt;&gt;&gt; 
&gt;&gt;&gt; Any suggestion for my requirement? create a new search index?
&gt;&gt;&gt; 
&gt;&gt;&gt; Regards,
&gt;&gt;&gt; Zhenguo
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 2014-11-26 0:24 GMT+08:00 Eric Redmond :
&gt;&gt;&gt; Automatic updating of indexes due to schema changes doesn't exist yet. 
&gt;&gt;&gt; It'll be added soon:
&gt;&gt;&gt; 
&gt;&gt;&gt; https://github.com/basho/yokozuna/pull/427
&gt;&gt;&gt; 
&gt;&gt;&gt; Eric
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; On Nov 25, 2014, at 8:21 AM, Yang Zhenguo  wrote:
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I have an existed schema and I want to add one column in it, such as 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; What's the steps to update it?
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Since there is the search\_index related to the schema and a bucket type 
&gt;&gt;&gt;&gt; related to the search\_index.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I tried to update the schema by the following commands:
&gt;&gt;&gt;&gt; {ok, SchemaData} = file:read\_file("cartoons.xml"),
&gt;&gt;&gt;&gt; riakc\_pb\_socket:create\_search\_schema(Pid, &lt;&lt;"cartoons"&gt;&gt;, SchemaData).
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; However, I can not search the object with new field.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Thanks in advance.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Regards,
&gt;&gt;&gt;&gt; -- 
&gt;&gt;&gt;&gt; Zhenguo Yang
&gt;&gt;&gt;&gt; www.prinbit.com
&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; -- 
&gt;&gt;&gt; Zhenguo Yang
&gt;&gt;&gt; MSN: zgyang...@hotmail.com
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -- 
&gt;&gt; Zhenguo Yang
&gt;&gt; MSN: zgyang...@hotmail.com
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Zhenguo Yang
&gt; MSN: zgyang...@hotmail.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

