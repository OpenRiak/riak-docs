---
title: "Re: Throughput issue contd. On Joyend Riak Smartmachine"
description: ""
project: community
lastmod: 2012-06-27T04:09:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07809"
mailinglist_parent_id: "msg07808"
author_name: "Yousuf Fauzan"
project_section: "mailinglistitem"
sent_date: 2012-06-27T04:09:29-07:00
---


I used examples/riakc\_pb.config

{mode, max}.

{duration, 10}.

{concurrent, 1}.

{driver, basho\_bench\_driver\_riakc\_pb}.

{key\_generator, {int\_to\_bin, {uniform\_int, 10000}}}.

{value\_generator, {fixed\_bin, 10000}}.

{riakc\_pb\_ips, [{}]}.

{riakc\_pb\_replies, 1}.

{operations, [{get, 1}, {update, 1}]}.


On Wed, Jun 27, 2012 at 4:37 PM, Russell Brown wrote:

&gt;
&gt; On 27 Jun 2012, at 12:05, Yousuf Fauzan wrote:
&gt;
&gt; I did use basho bench on my clusters. It should throughput of around 150
&gt;
&gt;
&gt; Could you share the config you used, please?
&gt;
&gt;
&gt; On Wed, Jun 27, 2012 at 4:24 PM, Russell Brown wrote:
&gt;
&gt;&gt;
&gt;&gt; On 27 Jun 2012, at 11:50, Yousuf Fauzan wrote:
&gt;&gt;
&gt;&gt; Its not about the difference in throughput in the two approaches I took.
&gt;&gt; Rather, the issue is that even 200 writes/sec is a bit on the lower side.
&gt;&gt; I could be doing something wrong with the configuration because people
&gt;&gt; are reporting throughputs of 2-3k ops/sec
&gt;&gt;
&gt;&gt; If anyone here could guide me in setting up a cluster which would give
&gt;&gt; such kind of throughput.
&gt;&gt;
&gt;&gt;
&gt;&gt; To get the kind of throughput I use multiple threads / workers. Have you
&gt;&gt; looked at basho\_bench[1], it is a simple, reliable tool to benchmark Riak
&gt;&gt; clusters?
&gt;&gt;
&gt;&gt; Cheers
&gt;&gt;
&gt;&gt; Russell
&gt;&gt;
&gt;&gt; [1] Basho Bench - https://github.com/basho/basho\_bench and
&gt;&gt; http://wiki.basho.com/Benchmarking.html
&gt;&gt;
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Yousuf
&gt;&gt;
&gt;&gt; On Wed, Jun 27, 2012 at 4:02 PM, Eric Anderson wrote:
&gt;&gt;
&gt;&gt;&gt; On Jun 27, 2012, at 5:13 AM, Yousuf Fauzan 
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;
&gt;&gt;&gt; I setup a 3 machine riak SM cluster. Each machine used 4GB Ram and riak
&gt;&gt;&gt; OpenSource SmartMachine Image.
&gt;&gt;&gt;
&gt;&gt;&gt; Afterwards I tried loading data by following two methods
&gt;&gt;&gt; 1. Bash script
&gt;&gt;&gt; #!/bin/bash
&gt;&gt;&gt; echo $(date)
&gt;&gt;&gt; for (( c=1; c&lt;=1000; c++ ))
&gt;&gt;&gt; do
&gt;&gt;&gt; curl -s -d 'this is a test' -H "Content-Type: text/plain"
&gt;&gt;&gt; http://127.0.0.1:8098/buckets/test/keys
&gt;&gt;&gt; done
&gt;&gt;&gt; echo $(date)
&gt;&gt;&gt;
&gt;&gt;&gt; 2. Python Riak Client
&gt;&gt;&gt; c=riak.RiakClient("10.112.2.185")
&gt;&gt;&gt; b=c.bucket("test")
&gt;&gt;&gt; for i in xrange(10000):o=b.new(str(i), str(i)).store()
&gt;&gt;&gt;
&gt;&gt;&gt; For case 1, throughput was 25 writes/sec
&gt;&gt;&gt; For case 2, throughput was 200 writes/sec
&gt;&gt;&gt;
&gt;&gt;&gt; Maybe I am making a fundamental mistake somewhere. I tried the above two
&gt;&gt;&gt; scripts on EC2 clusters too and still got the same performance.
&gt;&gt;&gt;
&gt;&gt;&gt; Please, someone help
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; The major difference between these two is the first is executing a
&gt;&gt;&gt; binary, which has to basically create everything (connection, payload, etc)
&gt;&gt;&gt; every time through the loop. The second does not - it creates the client
&gt;&gt;&gt; once, then iterates over it keeping the same client and presumably the same
&gt;&gt;&gt; connection as well. That makes a huge difference.
&gt;&gt;&gt;
&gt;&gt;&gt; I would not use curl to do performance testing. What you probably want
&gt;&gt;&gt; is something like your python script that will work on many
&gt;&gt;&gt; threads/processes at once (or fire them up many times).
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Eric Anderson
&gt;&gt;&gt; Co-Founder
&gt;&gt;&gt; CopperEgg
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

