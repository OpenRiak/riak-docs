---
title: "Re: 1. Riak Crashing on Data Load from CSV and 2. How to get	Ripple to load js functions"
description: ""
project: community
lastmod: 2012-05-22T06:35:43-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07499"
mailinglist_parent_id: "msg07479"
author_name: "Dave Smith"
project_section: "mailinglistitem"
sent_date: 2012-05-22T06:35:43-07:00
---


Hi Gustav, 

Can you share the logs or any other information from the server that crashes 
\_first\_? It might be good to also include app.config, just so we can 
double-check that no other settings have changed.

Thanks,

D. 

--
Dave Smith
VP, Engineering
Basho Technologies, Inc.
diz...@basho.com



On Friday, May 18, 2012 at 10:03 AM, Gustav Gennrich wrote:

&gt; Hi,
&gt; 
&gt; Below is our setup to better diagnose:
&gt; 
&gt; Ring creation size: 128
&gt; Backend: LevelDB
&gt; 
&gt; All other settings in app.config are using the default values
&gt; 
&gt; We have 3 servers (nodes) each of which have 8GB of ram.
&gt; 
&gt; Question 1: We are attempting to load data into Riak using CSVs that we 
&gt; generated from data previously stored is our MySQL database. We are using 
&gt; Ripple to create the documents and associations (links). The problem we are 
&gt; having is Riak continue to grow in memory consumption until it finally 
&gt; crashed while loading this data. We are only able to add around a couple 
&gt; hundred thousand rows from the CSV's before this happens. Riak then responds 
&gt; with 500 errors and eventually all of the nodes crash and the nodes need to 
&gt; be restarted. 
&gt; 
&gt; Question 2 (unrelated): I am attempting to use some of the already defined js 
&gt; functions in ripple.js in a mapreduce, however, I keep getting the following 
&gt; error:
&gt; 
&gt; Riak::MapReduceError: 
&gt; {"phase":0,"error":"[{&lt;&lt;\"lineno\"&gt;&gt;,1},{&lt;&lt;\"message\"&gt;&gt;,&lt;&lt;\"ReferenceError: 
&gt; Ripple is not defined\"&gt;&gt;},{&lt;&lt;\"source\"&gt;&gt;,&lt;&lt;\"unknown\"&gt;&gt;}]" 
&gt; 
&gt; In ripple.yml I have the following (\*\*\*\*\* represent hidden values):
&gt; 
&gt; # Configure Riak connections for the Ripple library. 
&gt; development:
&gt; # http\_port: 8091
&gt; # pb\_port: 8087
&gt; # host: 127.0.0.1
&gt; basic\_auth: \*\*\*\*\*
&gt; http\_port: 80
&gt; pb\_port: 8087
&gt; host: \*\*\*\*\*
&gt; http\_backend: Excon
&gt; solr: "/solr"
&gt; js\_source\_dir: &lt;%= Rails.root + "app/mapreduce" %&gt;
&gt; 
&gt; # The test environment has additional keys for configuring the
&gt; # Riak::TestServer for your test/spec suite:
&gt; #
&gt; # \* bin\_dir specifies the path to the "riak" script that you use to
&gt; # start Riak (just the directory)
&gt; # \* js\_source\_dir specifies where your custom Javascript functions for
&gt; # MapReduce should be loaded from. Usually app/mapreduce.
&gt; test:
&gt; http\_port: 9000
&gt; pb\_port: 9002
&gt; host: localhost
&gt; 
&gt; source: /usr/local/bin # Default for Homebrew.
&gt; js\_source\_dir: &lt;%= Rails.root + "/app/mapreduce" %&gt;
&gt; 
&gt; production:
&gt; nodes:
&gt; - host: \*\*\*\*\*
&gt; http\_port: 8098
&gt; pb\_port: 8087
&gt; - host: \*\*\*\*\*
&gt; http\_port: 8098
&gt; pb\_port: 8087
&gt; - host: \*\*\*\*\*
&gt; http\_port: 8098
&gt; pb\_port: 8087
&gt; http\_backend: Excon
&gt; solr: "/solr"
&gt; js\_source\_dir: &lt;%= Rails.root + "app/mapreduce" %&gt;
&gt; 
&gt; 
&gt; I don't see why I am getting this error when I have defined where the 
&gt; js\_source\_dir is.
&gt; 
&gt; Any help would be greatly appreciated!
&gt; 
&gt; Thanks,
&gt; 
&gt; Gustav 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com




\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

