---
title: "Re: Search sort error in 2.0.0beta1"
description: ""
project: community
lastmod: 2014-05-01T14:24:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14167"
mailinglist_parent_id: "msg14161"
author_name: "Troy Melhase"
project_section: "mailinglistitem"
sent_date: 2014-05-01T14:24:21-07:00
---


Hello again!

I've narrowed this down to the interaction between the sort parameter and
the field list ("fl") parameter. It seems that if "fl" is supplied with
"sort", the field list must contain the value "score". I'm not certain if
that's a bug or not, but the work-around is plain enough: add "score" to
the list of fields if there's a sort and the field list isn't empty.

Whew!


troy



On Wed, Apr 30, 2014 at 10:09 PM, Troy Melhase  wrote:

&gt; Hello!
&gt;
&gt; I'm getting an error when I include a sort parameter in
&gt; a RpbSearchQueryReq message. I'm using Riak 2.0.0beta1. Source build and
&gt; macos binaries show the same behavior.
&gt;
&gt; The error doesn't happen at all if I don't specify a search parameter.
&gt; For the parameter value, I'm using "field direction" (e.g., "name asc").
&gt; Leaving off the direction, or encoding the space as "+" or "%20" produces
&gt; a Solr error.
&gt;
&gt; I've tried Golang and Python clients to see if it was a client issue. Both
&gt; clients produce the exact same error; that error text is at the end of this
&gt; message.
&gt;
&gt; Is this a known bug? I searched Github and couldn't find any issues that
&gt; look like this one. Is there a work-around? Or better yet, am I doing
&gt; something wrong?
&gt;
&gt; Thanks!
&gt;
&gt;
&gt; troy
&gt;
&gt;
&gt; Error text:
&gt;
&gt; RiakError: 'Error processing incoming message:
&gt; error:badarg:[{protobuffs,encode\_internal,
&gt; [2,[],float],
&gt;
&gt; [{file,"src/protobuffs.erl"},
&gt; {line,167}]},
&gt; {riak\_search\_pb,iolist,2,
&gt; [{file,
&gt;
&gt; "src/riak\_search\_pb.erl"},
&gt; {line,63}]},
&gt; {riak\_search\_pb,encode,2,
&gt; [{file,
&gt;
&gt; "src/riak\_search\_pb.erl"},
&gt; {line,48}]},
&gt; {riak\_pb\_codec,encode,1,
&gt; [{file,
&gt;
&gt; "src/riak\_pb\_codec.erl"},
&gt; {line,77}]},
&gt; {yz\_pb\_search,encode,1,
&gt; [{file,
&gt;
&gt; "src/yz\_pb\_search.erl"},
&gt; {line,60}]},
&gt; {riak\_api\_pb\_server,
&gt;
&gt; send\_encoded\_message\_or\_error,
&gt; 3,
&gt; [{file,
&gt;
&gt; "src/riak\_api\_pb\_server.erl"},
&gt; {line,498}]},
&gt; {riak\_api\_pb\_server,
&gt; process\_message,4,
&gt; [{file,
&gt;
&gt; "src/riak\_api\_pb\_server.erl"},
&gt; {line,430}]},
&gt; {riak\_api\_pb\_server,
&gt; connected,2,
&gt; [{file,
&gt;
&gt; "src/riak\_api\_pb\_server.erl"},
&gt; {line,262}]}]'
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

