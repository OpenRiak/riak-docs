---
title: "Re: badrecord during transfer"
description: ""
project: community
lastmod: 2013-12-02T15:12:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13135"
mailinglist_parent_id: "msg13101"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2013-12-02T15:12:06-08:00
---


Ivan,

What makes you think the index is damaged? From what I can see this is a
bug in the code assuming that a #ho\_acc record is always returned but in
fact an error tuple could also be returned. That error tuple could be
caused by index corruption but there is nothing in your email to say for
sure. Do you see any other errors in the log?

-Z


On Tue, Nov 26, 2013 at 7:55 PM, Ivan Skytte JÃ¸rgensen wrote:

&gt; I have a three-node cluster (version 1.4.2)
&gt;
&gt; One node is trying to send a partition to another node but encounters this
&gt; error every time:
&gt;
&gt; 2013-11-27 00:48:15.468 [error]
&gt; &lt;0.29095.34&gt;@riak\_core\_handoff\_sender:start\_fold:269 ownership\_transfer
&gt; transfer of riak\_search\_vnode from 'riak@10.197.0.55'
&gt; 1118962191081472546749696200048404186924073353216 to 'riak@10.196.50.172'
&gt; 1118962191081472546749696200048404186924073353216 failed because of
&gt; error:{badrecord,ho\_acc}
&gt; [{riak\_core\_handoff\_sender,start\_fold,5,[{file,"src/riak\_core\_handoff\_sender.erl"},{line,193}]}]
&gt;
&gt; I have tried attaching to riak with riak attach and doing a repair, but:
&gt;
&gt; (riak@10.197.0.55)1&gt;
&gt; riak\_kv\_vnode:repair(1118962191081472546749696200048404186924073353216).
&gt; ownership\_change\_in\_progress
&gt;
&gt; How do I get out of this sticky situation? The transfer never completes
&gt; because the index is damaged and I cannot repair it because it is scheduled
&gt; for handoff.
&gt;
&gt; Would a force-remove allow me to repair the partition and then rejoin the
&gt; cluster?
&gt;
&gt; /isj
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

