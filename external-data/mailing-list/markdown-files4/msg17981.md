---
title: "Re: Object not found after successful PUT on S3 API"
description: ""
project: community
lastmod: 2017-02-14T09:02:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17981"
mailinglist_parent_id: "msg17949"
author_name: "Daniel Miller"
project_section: "mailinglistitem"
sent_date: 2017-02-14T09:02:11-08:00
---


Hi Luke,

Sorry for the late response and thanks for following up. I haven't seen it
happen since. At this point I'm going to wait and see if it happens again
and hopefully get more details about what might be causing it.

Daniel

On Thu, Feb 9, 2017 at 1:02 PM, Luke Bakken  wrote:

&gt; Hi Daniel -
&gt;
&gt; I don't have any ideas at this point. Has this scenario happened again?
&gt;
&gt; --
&gt; Luke Bakken
&gt; Engineer
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Wed, Jan 25, 2017 at 2:11 PM, Daniel Miller  wrote:
&gt; &gt; Thanks for the quick response, Luke.
&gt; &gt;
&gt; &gt; There is nothing unusual about the keys. The format is a name + UUID +
&gt; some
&gt; &gt; other random URL-encoded charaters, like most other keys in our cluster.
&gt; &gt;
&gt; &gt; There are no errors near the time of the incident in any of the logs (the
&gt; &gt; last [error] is from over a month before). I see lots of messages like
&gt; this
&gt; &gt; in console.log:
&gt; &gt;
&gt; &gt; /var/log/riak/console.log
&gt; &gt; 2017-01-20 15:38:10.184 [info]
&gt; &gt; &lt;0.22902.1193&gt;@riak\_kv\_exchange\_fsm:key\_exchange:263 Repaired 2 keys
&gt; during
&gt; &gt; active anti-entropy exchange of
&gt; &gt; {776422744832042175295707567380525354192214163456,3} between
&gt; &gt; {776422744832042175295707567380525354192214163456,'riak-
&gt; fa...@fake3.fake.com'}
&gt; &gt; and
&gt; &gt; {822094670998632891489572718402909198556462055424,'riak-
&gt; fa...@fake9.fake.com'}
&gt; &gt; 2017-01-20 15:40:39.640 [info]
&gt; &gt; &lt;0.21789.1193&gt;@riak\_kv\_exchange\_fsm:key\_exchange:263 Repaired 1 keys
&gt; during
&gt; &gt; active anti-entropy exchange of
&gt; &gt; {936274486415109681974235595958868809467081785344,3} between
&gt; &gt; {959110449498405040071168171470060731649205731328,'riak-
&gt; fa...@fake3.fake.com'}
&gt; &gt; and
&gt; &gt; {981946412581700398168100746981252653831329677312,'riak-
&gt; fa...@fake5.fake.com'}
&gt; &gt; 2017-01-20 15:46:40.918 [info]
&gt; &gt; &lt;0.13986.1193&gt;@riak\_kv\_exchange\_fsm:key\_exchange:263 Repaired 2 keys
&gt; during
&gt; &gt; active anti-entropy exchange of
&gt; &gt; {662242929415565384811044689824565743281594433536,3} between
&gt; &gt; {685078892498860742907977265335757665463718379520,'riak-
&gt; fa...@fake3.fake.com'}
&gt; &gt; and
&gt; &gt; {707914855582156101004909840846949587645842325504,'riak-
&gt; fa...@fake6.fake.com'}
&gt; &gt; 2017-01-20 15:48:25.597 [info]
&gt; &gt; &lt;0.29943.1193&gt;@riak\_kv\_exchange\_fsm:key\_exchange:263 Repaired 2 keys
&gt; during
&gt; &gt; active anti-entropy exchange of
&gt; &gt; {776422744832042175295707567380525354192214163456,3} between
&gt; &gt; {776422744832042175295707567380525354192214163456,'riak-
&gt; fa...@fake3.fake.com'}
&gt; &gt; and
&gt; &gt; {799258707915337533392640142891717276374338109440,'riak-
&gt; fa...@fake0.fake.com'}
&gt; &gt;
&gt; &gt; Thanks!
&gt; &gt; Daniel
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; On Wed, Jan 25, 2017 at 9:45 AM, Luke Bakken  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Hi Daniel -
&gt; &gt;&gt;
&gt; &gt;&gt; This is a strange scenario. I recommend looking at all of the log
&gt; &gt;&gt; files for "[error]" or other entries at about the same time as these
&gt; &gt;&gt; PUTs or 404 responses.
&gt; &gt;&gt;
&gt; &gt;&gt; Is there anything unusual about the key being used?
&gt; &gt;&gt; --
&gt; &gt;&gt; Luke Bakken
&gt; &gt;&gt; Engineer
&gt; &gt;&gt; lbak...@basho.com
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; On Wed, Jan 25, 2017 at 6:40 AM, Daniel Miller 
&gt; wrote:
&gt; &gt;&gt; &gt; I have a 9-node Riak CS cluster that has been working flawlessly for
&gt; &gt;&gt; &gt; about 3
&gt; &gt;&gt; &gt; months. The cluster configuration, including backend and bucket
&gt; &gt;&gt; &gt; parameters
&gt; &gt;&gt; &gt; such as N-value are using default settings. I'm using the S3 API to
&gt; &gt;&gt; &gt; communicate with the cluster.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Within the past week I had an issue where two objects were PUT
&gt; resulting
&gt; &gt;&gt; &gt; in
&gt; &gt;&gt; &gt; a 200 (success) response, but all subsequent GET requests for those
&gt; two
&gt; &gt;&gt; &gt; keys
&gt; &gt;&gt; &gt; return status of 404 (not found). Other than the fact that they are
&gt; now
&gt; &gt;&gt; &gt; missing, there was nothing out of the ordinary with these particular
&gt; to
&gt; &gt;&gt; &gt; PUTs. Maybe I'm missing something, but this seems like a scenario that
&gt; &gt;&gt; &gt; should never happen. All information included here about PUTs and GETs
&gt; &gt;&gt; &gt; comes
&gt; &gt;&gt; &gt; from reviewing the CS access logs. Both objects were PUT on the same
&gt; &gt;&gt; &gt; node,
&gt; &gt;&gt; &gt; however GET requests returning 404 have been observed on all nodes.
&gt; &gt;&gt; &gt; There is
&gt; &gt;&gt; &gt; plenty of other traffic on the cluster involving GETs and PUTs that
&gt; are
&gt; &gt;&gt; &gt; not
&gt; &gt;&gt; &gt; failing. I'm unsure of how to troubleshoot further to find out what
&gt; may
&gt; &gt;&gt; &gt; have
&gt; &gt;&gt; &gt; happened to those objects and why they are now missing. What is the
&gt; best
&gt; &gt;&gt; &gt; approach to figure out why an object that was successfully PUT seems
&gt; to
&gt; &gt;&gt; &gt; be
&gt; &gt;&gt; &gt; missing?
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Thanks!
&gt; &gt;&gt; &gt; Daniel Miller
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt;&gt; &gt; riak-users mailing list
&gt; &gt;&gt; &gt; riak-users@lists.basho.com
&gt; &gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

