---
title: "Re: Riak pool connection"
description: ""
project: community
lastmod: 2014-02-08T14:35:10-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13621"
mailinglist_parent_id: "msg13619"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2014-02-08T14:35:10-08:00
---


Hi Matt,

I'm not positive of the implementation details, but I know for certain that
the "new" (unreleased) Java client allows you to provide a load-balancing
strategy yourself. This documentation should be a good start:
http://basho.github.io/riak-java-client/2.0.0-SNAPSHOT/com/basho/riak/client/core/DefaultNodeManager.html

I'm sure Brian Roach and Dave Rusek, who maintain the Java client, would
also be happy to discuss it more with you.


On Sat, Feb 8, 2014 at 11:23 PM, Matthew MacClary &lt;
maccl...@lifetime.oregonstate.edu&gt; wrote:

&gt; I have the same use case as Massimiliano. We are using the java client and
&gt; our app runs on the same servers as the Riak cluster. We have found that
&gt; connecting to the Riak instance running on local host provides the best
&gt; performance. It would be nice if the cluster client could be told to prefer
&gt; one node, and fall back to other nodes if needed kind of like secondary DNS
&gt; servers.
&gt;
&gt; -Matt
&gt;
&gt; Message: 5
&gt;&gt; Date: Sat, 8 Feb 2014 15:07:36 +0100
&gt;&gt; From: Massimiliano Ciancio 
&gt;&gt; To: Sean Cribbs 
&gt;&gt; Cc: riak-users 
&gt;&gt; Subject: Re: Riak pool connection
&gt;&gt; Message-ID:
&gt;&gt; &gt; 0psf2\_azhpwnrvezkccj\_vph6ad...@mail.gmail.com&gt;
&gt;&gt; Content-Type: text/plain; charset=ISO-8859-1
&gt;&gt;
&gt;&gt;
&gt;&gt; Hi Sean,
&gt;&gt; thanks for your answer!
&gt;&gt;
&gt;&gt; &gt; I believe it may still be possible for the node to be selected if no
&gt;&gt; other
&gt;&gt; &gt; connections are available in the pool, because the logic used to
&gt;&gt; establish a
&gt;&gt; &gt; new connection might not use the filter.
&gt;&gt;
&gt;&gt; My problem is not to avoid that a node will be selected again after a
&gt;&gt; fail (well, if this can be avoided by sure it's better...) but to set
&gt;&gt; an order in the nodes: I want to connect first to the node on which my
&gt;&gt; app is running and only in case of fail to the other nodes. The reason
&gt;&gt; is to avoid network traffic: every instance of my app have to connect
&gt;&gt; to the node on the same machine where it resides.
&gt;&gt; How can I suggest a "preferred node" to RiakClient?
&gt;&gt; My first idea was to use a connection with only the preferred node
&gt;&gt; and, using a try/except, use an "emergency connection" with the list
&gt;&gt; of all nodes to be used only in case of fail. But it's not so
&gt;&gt; elegant....
&gt;&gt; Massimiliano
&gt;&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

