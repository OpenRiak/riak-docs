---
title: "Re: setting ACL in a put request, riak cs 1.3.1-1"
description: ""
project: community
lastmod: 2013-07-30T19:17:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11827"
mailinglist_parent_id: "msg11825"
author_name: "Hector Castro"
project_section: "mailinglistitem"
sent_date: 2013-07-30T19:17:15-07:00
---


Hey Eugene,

I believe I reproduced the issue you are seeing. I went ahead and
created an issue for the Riak CS team to review. [0]

--
Hector

[0] https://github.com/basho/riak\_cs/issues/631

On Tue, Jul 30, 2013 at 9:41 PM, Kota Uenishi  wrote:
&gt; Eugene,
&gt;
&gt; Congratulations, and thank you! You have found a bug X'(
&gt; Could you open an issue on github issues[1] ? Your report is very nice
&gt; and sufficient so just copy and pasting your mail will work. We will
&gt; be working on that.
&gt;
&gt; [1] https://github.com/basho/riak\_cs
&gt;
&gt; Cheers,
&gt; Kota
&gt;
&gt; On Mon, Jul 29, 2013 at 11:47 AM, Eugene Doudine  wrote:
&gt;&gt; Greetings,
&gt;&gt;
&gt;&gt; I'm trying to set object ACL in the put request using the
&gt;&gt; x-amz-grant-\* headers as described in the docs:
&gt;&gt; http://docs.basho.com/riakcs/latest/references/apis/storage/RiakCS-PUT-Object/
&gt;&gt;
&gt;&gt; The server creates objects, but neither sets the ACL nor
&gt;&gt; returns any warnings or errors.
&gt;&gt;
&gt;&gt; Setting same ACL in a separate request (PUT /test1.txt?acl=) works as
&gt;&gt; expected.
&gt;&gt;
&gt;&gt; Is this a bug, or not yet implemented or I simply miss something?
&gt;&gt; I'm pretty new to Riak-CS and the cloud API's.
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt;
&gt;&gt; Here is dump of the put request and server's responce :
&gt;&gt;
&gt;&gt; PUT /test1.txt HTTP/1.1
&gt;&gt; Host: bucketsys1.localhost.localhost:8080
&gt;&gt; x-amz-grant-full-control: emailAddress="sys1@localhost"
&gt;&gt; x-amz-meta-testkey1: testvar1
&gt;&gt; Authorization: AWS \_BZLP5L3UTR\_UYZRDZY6:xNSHzb7VUlHothQx+e1dTYjN0HU=
&gt;&gt; Date: Mon, 29 Jul 2013 02:30:49 GMT
&gt;&gt; Content-MD5: 65wr8Otj86e8DqN+8YrrpQ==
&gt;&gt; User-Agent: aws-sdk-java/1.4.5 Linux/3.2.0-48-generic
&gt;&gt; Java\_HotSpot(TM)\_Server\_VM/19.1-b02
&gt;&gt; x-amz-grant-write: emailAddress="sys3@localhost"
&gt;&gt; x-amz-meta-test-key2: testval2
&gt;&gt; Content-Type: application/json
&gt;&gt; x-amz-grant-read: emailAddress="sys2@localhost"
&gt;&gt; Content-Length: 13
&gt;&gt; Connection: Keep-Alive
&gt;&gt; Expect: 100-continue
&gt;&gt;
&gt;&gt; HTTP/1.1 100 Continue
&gt;&gt;
&gt;&gt; some content
&gt;&gt; HTTP/1.1 200 OK
&gt;&gt; Server: Riak CS
&gt;&gt; ETag: "eb9c2bf0eb63f3a7bc0ea37ef18aeba5"
&gt;&gt; Date: Mon, 29 Jul 2013 02:30:50 GMT
&gt;&gt; Content-Type: text/plain
&gt;&gt; Content-Length: 0
&gt;&gt;
&gt;&gt;
&gt;&gt; Here is info on the created object as given by s3cmd, only
&gt;&gt; owners has the requested rights:
&gt;&gt;
&gt;&gt; s3://bucketsys1.localhost/test1.txt (object):
&gt;&gt; File size: 13
&gt;&gt; Last mod: Mon, 29 Jul 2013 02:30:50 GMT
&gt;&gt; MIME type: application/json
&gt;&gt; MD5 sum: eb9c2bf0eb63f3a7bc0ea37ef18aeba5
&gt;&gt; policy: none
&gt;&gt; ACL: sys1: FULL\_CONTROL
&gt;&gt;
&gt;&gt;
&gt;&gt; Here is the separate acl modification request which works as expected:
&gt;&gt;
&gt;&gt;
&gt;&gt; PUT /test1.txt?acl= HTTP/1.1
&gt;&gt; Host: bucketsys1.localhost.localhost:8080
&gt;&gt; Authorization: AWS \_BZLP5L3UTR\_UYZRDZY6:aLXe+A5bQFIft2ELJLLWob0AAAE=
&gt;&gt; Date: Mon, 29 Jul 2013 02:33:27 GMT
&gt;&gt; User-Agent: aws-sdk-java/1.4.5 Linux/3.2.0-48-generic
&gt;&gt; Java\_HotSpot(TM)\_Server\_VM/19.1-b02
&gt;&gt; Content-Type: text/plain
&gt;&gt; Content-Length: 793
&gt;&gt; Connection: Keep-Alive
&gt;&gt; Expect: 100-continue
&gt;&gt;
&gt;&gt; HTTP/1.1 100 Continue
&gt;&gt;
&gt;&gt; &gt; xmlns="http://s3.amazonaws.com/doc/2006-03-01/"&gt;\_BZLP5L3UTR\_UYZRDZY6sys1&gt; xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
&gt;&gt; xsi:type="AmazonCustomerByEmail"&gt;sys1@localhostFULL\_CONTROL&gt; xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
&gt;&gt; xsi:type="AmazonCustomerByEmail"&gt;sys3@localhostWRITE&gt; xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
&gt;&gt; xsi:type="AmazonCustomerByEmail"&gt;sys2@localhostREAD
&gt;&gt;
&gt;&gt; HTTP/1.1 200 OK
&gt;&gt; Server: Riak CS
&gt;&gt; Date: Mon, 29 Jul 2013 02:33:27 GMT
&gt;&gt; Content-Type: text/plain
&gt;&gt; Content-Length: 0
&gt;&gt;
&gt;&gt; Now the object has the requested ACL:
&gt;&gt;
&gt;&gt; s3://bucketsys1.localhost/test1.txt (object):
&gt;&gt; File size: 13
&gt;&gt; Last mod: Mon, 29 Jul 2013 02:30:50 GMT
&gt;&gt; MIME type: application/json
&gt;&gt; MD5 sum: eb9c2bf0eb63f3a7bc0ea37ef18aeba5
&gt;&gt; policy: none
&gt;&gt; ACL: sys1: FULL\_CONTROL
&gt;&gt; ACL: sys3: WRITE
&gt;&gt; ACL: sys2: READ
&gt;&gt;
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Eugene
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Kota UENISHI / @kuenishi
&gt; Basho Japan KK
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

