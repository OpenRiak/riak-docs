---
title: "Re: 500 response listing a bucket with 2 keys"
description: ""
project: community
lastmod: 2014-08-18T14:01:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14710"
mailinglist_parent_id: "msg14709"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2014-08-18T14:01:57-07:00
---


The problem is term\_to\_binary. I suspect that &lt;&lt;131, 100, 0, ...&gt;&gt; is
not a valid UTF-8 sequence. Can you use atom\_to\_binary(Node, utf8)
instead?

On Mon, Aug 18, 2014 at 3:29 PM, Bryan  wrote:
&gt; Hi Everyone,
&gt;
&gt; Getting a very interesting 500 error from the Riak HTTP API. I am using Riak
&gt; 1.4.2:
&gt;
&gt; curl http://localhost:8098/buckets/nodes/keys?keys=true
&gt;
&gt; 500 Internal Server
&gt; ErrorInternal Server Error
=====================

The server
&gt; encountered an error while processing this
&gt; request:  

```
{error,{exit,{ucs,{bad_utf8_character_code}},
&gt;              [{xmerl_ucs,from_utf8,1,[{file,"xmerl_ucs.erl"},{line,185}]},
&gt;               {mochijson2,json_encode_string,2,
&gt;                           [{file,"src/mochijson2.erl"},{line,186}]},
&gt;               {mochijson2,'-json_encode_array/2-fun-0-',3,
&gt;                           [{file,"src/mochijson2.erl"},{line,157}]},
&gt;               {lists,foldl,3,[{file,"lists.erl"},{line,1197}]},
&gt;               {mochijson2,json_encode_array,2,
&gt;                           [{file,"src/mochijson2.erl"},{line,159}]},
&gt;               {mochijson2,'-json_encode_proplist/2-fun-0-',3,
&gt;                           [{file,"src/mochijson2.erl"},{line,167}]},
&gt;               {lists,foldl,3,[{file,"lists.erl"},{line,1197}]},
&gt;               {mochijson2,json_encode_proplist,2,
&gt;
&gt; [{file,"src/mochijson2.erl"},{line,170}]}]}}
```


---

mochiweb+webmachine
&gt; web server


&gt;
&gt; We use the protocol buffer client to get data in. The data in question is a
&gt; binary string of the nodes name:
&gt;
&gt; term\_to\_binary(node())
&gt;
&gt; I am able to get them out via the erlang riak client:
&gt;
&gt; riakc\_pb\_socket:list\_keys(S#state.riak\_socketpid, &lt;&lt;“nodes”&gt;&gt;)
&gt;
&gt; gives me:
&gt;
&gt; {ok,[&lt;&lt;131,100,0,19,110,117,99,108,101,117,115,45,50,64,
&gt; 49,50,55,46,48,46,48,46,49&gt;&gt;,
&gt; &lt;&lt;131,100,0,17,110,117,99,108,101,117,115,64,49,50,55,
&gt; 46,48,46,48,46,49&gt;&gt;]}
&gt;
&gt; (nucleus@127.0.0.1)2&gt;
&gt; binary\_to\_term(&lt;&lt;131,100,0,19,110,117,99,108,101,117,115,45,50,64,
&gt; (nucleus@127.0.0.1)2&gt; 49,50,55,46,48,46,48,46,49&gt;&gt;).
&gt; 'nucleus-2@127.0.0.1'
&gt;
&gt; I am looking through the console.log, but there is nothing but some bitbask
&gt; merge messages.
&gt;
&gt; Cheers,
&gt; Bryan
&gt;
&gt;
&gt; ----
&gt;
&gt; Bryan Hughes
&gt; Go Factory
&gt;
&gt; http://www.go-factory.net
&gt;
&gt; Connecting the Internet of Things
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;



-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

