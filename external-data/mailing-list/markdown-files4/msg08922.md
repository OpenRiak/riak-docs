---
title: "Re: Scoring in riak-search"
description: ""
project: community
lastmod: 2012-10-15T09:37:37-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08922"
mailinglist_parent_id: "msg08868"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2012-10-15T09:37:37-07:00
---


Niklas,

On Wed, Oct 10, 2012 at 9:44 AM, Niklas Saers  wrote:
&gt;
&gt;
&gt; When I do a search, I receive a responseHeader that has a maxScore. That's
&gt; great, but the score for the individual documents doesn't show. How do I
&gt; get the score for the individual documents listed in my search? I want to
&gt; use this to display to my users 1-5 stars of how well they matched.
&gt;

This is a bug in the Solr-like interface to Riak Search. It discards the
score when building the response.


&gt;
&gt; Secondly, if I add a postfix \* to any of my search terms, it searches
&gt; fine, but maxScore says 0.00000e+0. Why is this?
&gt;

This is because a single prefix query, e.g. motor\*, will use a range op. A
range op doesn't affect scoring [1]. Since no non-suffix query was given
along with it there is no scoring information and it defaults to 0.


&gt;
&gt; And finally, if I add a weight after my postfix \*, i.e. ^5, I get "Unable
&gt; to parse request: {badmatch, {error, { lucene\_parse, "syntax error before:
&gt; 5.0" } } } Why is this? As far as I can understand from the docs, a query
&gt; such as "title:listening\*^5" should be fine?
&gt;

The parser doesn't understand this query. Even if it did it wouldn't
matter because the range op doesn't respect boosting.

For the last few months I've been working on a new search solution for Riak
that uses Solr directly [2]. That is, unlike Riak Search which pretends to
look like Solr it actually is Solr underneath. Queries like the above,
plus many more, are supported. I know that doesn't help your current
situation but if you want to learn more feel free to contact me on a
backchannel.

-Z

[1]:
https://github.com/basho/riak\_search/blob/1.2.1/src/riak\_search\_op\_range\_sized.erl#L20


[2]: https://github.com/rzezeski/yokozuna
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

