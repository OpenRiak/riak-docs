---
title: "Re: Map reduce error on large bucket"
description: ""
project: community
lastmod: 2010-09-13T11:39:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01071"
mailinglist_parent_id: "msg01070"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-09-13T11:39:13-07:00
---


There have been many improvements to MapReduce on the "tip" version, largely 
thanks to some customers who want to crunch large datasets. In some test runs, 
we have processed over 400K keys, so we know it's possible. Expect these 
improvements in the 0.13 release (which will be pretty soon, if you're not 
brave enough to run on "tip").

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Sep 13, 2010, at 1:11 PM, Alexander Sicular wrote:

&gt; Hmm... sounds to me like your'e getting close to a magic comp sci number. 
&gt; 2^16 or 65536. If this isn't a timeout thing, which it could be [1], it could 
&gt; be a bug.
&gt; 
&gt; -Alexander
&gt; 
&gt; [1] https://issues.basho.com/show\_bug.cgi?id=367
&gt; 
&gt; On Sep 13, 2010, at 2:05 PM, SKester wrote:
&gt; 
&gt;&gt; I am trying to run a map-reduce job against all keys in a bucket. The job 
&gt;&gt; is working fine on buckets with ~60,000 or less entries. However on buckets 
&gt;&gt; with &gt; 63,000 keys I get the following error every time:
&gt;&gt; 
&gt;&gt; Input:
&gt;&gt; 
&gt;&gt; curl -X POST -H "content-type: application/json" 
&gt;&gt; http://testdw0b01.be.weather.com:8098/mapred?chunked=true --data @-
&gt;&gt; {"inputs":"profile\_63000","query":[{"map":{"language":"javascript","source":"function(v)
&gt;&gt; {var data = Riak.mapValuesJson(v)[0]; var r=[];for(var i in 
&gt;&gt; data.locations){ var 
&gt;&gt; o = {}; o[data.locations[i]] = 1; r.push(o); } return r; 
&gt;&gt; }"}},{"reduce":{"language":"javascript","source":"function(v) { var r = {}; 
&gt;&gt; for (var i in v) { for(var w in v[i])
&gt;&gt; { if (w in r) r[w] += v[i][w]; else r[w] = v[i][w]; } } return 
&gt;&gt; [r];}"}}],"timeout": 600000}
&gt;&gt; 
&gt;&gt; Output:
&gt;&gt; 
&gt;&gt; {"error":"map\_reduce\_error"}
&gt;&gt; 
&gt;&gt; Any ideas? I am running on a 4 box Centos cluster with Riak installed via 
&gt;&gt; 64bit RPMâ€™s, and default settings.
&gt;&gt; 
&gt;&gt; Thanks,
&gt;&gt; Scott
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

