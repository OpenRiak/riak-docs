---
title: "Re: Using $bucket index for listing keys"
description: ""
project: community
lastmod: 2016-03-11T04:57:08-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17142"
mailinglist_parent_id: "msg17138"
author_name: "Magnus Kessler"
project_section: "mailinglistitem"
sent_date: 2016-03-11T04:57:08-08:00
---


Hi Oleksiy,

How are you performing your 2i-based key listing? Querying with pagination
as shown in the documentation[0] should work.

As an example here is the HTTP invocation:

curl "
https://localhost:8098/types/default/buckets/test/index/\$bucket/\_?max\_results=10&continuation=g20AAAACNTM=
"

Once the end of the key list is reached, the server returns an empty keys
list and no further continuation value.

Please let me know if this works for you.

Kind Regards,

Magnus


[0]: http://docs.basho.com/riak/latest/dev/using/2i/#Querying

On 11 March 2016 at 10:06, Oleksiy Krivoshey  wrote:

&gt; Anyone?
&gt;
&gt; On 4 March 2016 at 19:11, Oleksiy Krivoshey  wrote:
&gt;
&gt;&gt; I have a bucket with ~200 keys in it and I wanted to iterate them with
&gt;&gt; the help of $bucket index and 2i request, however I'm facing the recursive
&gt;&gt; behaviour, for example I send the following 2i request:
&gt;&gt;
&gt;&gt; {
&gt;&gt; bucket: 'BUCKET\_NAME',
&gt;&gt; type: 'BUCKET\_TYPE',
&gt;&gt; index: '$bucket',
&gt;&gt; key: 'BUCKET\_NAME',
&gt;&gt; qtype: 0,
&gt;&gt; max\_results: 10,
&gt;&gt; continuation: 'AAAA'
&gt;&gt; }
&gt;&gt;
&gt;&gt; I receive 10 keys and continuation 'BBBB', I then repeat the request with
&gt;&gt; continuation 'BBBB' and at this point I can receive a reply with
&gt;&gt; continuation 'CCCC' or 'AAAA' or even 'BBBB' and its going in never ending
&gt;&gt; recursion.
&gt;&gt;
&gt;&gt; I'm running this on a 5 node 2.1.3 cluster.
&gt;&gt;
&gt;&gt; What I'm doing wrong? Or is this not supported at all?
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;


-- 
Magnus Kessler
Client Services Engineer
Basho Technologies Limited

Registered Office - 8 Lincolnâ€™s Inn Fields London WC2A 3BP Reg 07970431
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

