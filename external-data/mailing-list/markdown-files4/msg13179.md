---
title: "Re: Timeout on Streaming all keys"
description: ""
project: community
lastmod: 2013-12-09T06:22:39-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13179"
mailinglist_parent_id: "msg13178"
author_name: "Guido Medina"
project_section: "mailinglistitem"
sent_date: 2013-12-09T06:22:39-08:00
---



Hi Shimon,

Did you try streaming the 2i bucket index and then doing your job per 
key basis? I sent you a code snippet the other day.


It should work fine regardless of how many keys you have in your bucket, 
it is equivalent to the section:


http://docs.basho.com/riak/latest/dev/using/2i/ - Look for "Retrieve all 
Bucket Keys via $bucket Index"


Except that the code I sent you uses streaming API.

Guido.

On 09/12/13 14:10, Luke Bakken wrote:

Hi Shimon,

There is a tech preview of 2.0.0 available here that includes
Yokozuna: http://docs.basho.com/riak/2.0.0pre5/downloads/

However, since then there have been updates to Yokozuna. You can build
from the latest sources using the instructions here:

https://github.com/basho/yokozuna/blob/develop/docs/INSTALL.md#source-package

You will find related YZ docs in that "docs" directory as well.

--
Luke Bakken
CSE
lbak...@basho.com


On Mon, Dec 9, 2013 at 4:11 AM, Shimon Benattar  wrote:

Hi Luke, I'd love to have your insights on our problem.

About setting the timeout, we are anyway considering to upgrade to version 2.0 
so maybe I'll try that. is there an official release data?
Does the basic installation already include installation of Yokozuna? is there 
some guide on how to work woth Yokozuna?

Thanks,

Shimon


On 5 December 2013 19:48, Luke Bakken  wrote:

Hi Shimon,

I spoke with a member of the Java client team and the timeout is set to 60 
seconds. In the 2.0 version of the client this will be user-settable.

To make sure there's not a crash or other issue causing the long list keys, feel free to 
run "riak-debug" on nodes in your cluster and provide the generated archives. 
We can discuss that off-list.

--
Luke Bakken
CSE
lbak...@basho.com


On Wed, Dec 4, 2013 at 12:43 AM, Shimon Benattar  wrote:

Hi Luke,
We're using v1.4

On Dec 3, 2013 6:19 PM, "Luke Bakken"  wrote:

Hi Shimon,

What version of Riak and the Java client are you using?

Thanks
--
Luke Bakken
CSE
lbak...@basho.com


On Thu, Nov 28, 2013 at 4:00 AM, Shimon Benattar  wrote:

Hi Riak users,



Unfortunately for me I need to implement the get all keys method in our system 
(I know it is not recommended)



I am developing classes with the Java Api and using the streaming option as 
following



StreamingOperation keys = riakBucket.keys();

while (keys.hasNext()) {

final String next = keys.next();

out.write(next);

out.newLine();

}

riakBucket.keys().cancel();



My problem here is that for a simple class I inserted in Riak, after ~4.7 
million keys I am getting a timeout from Riak.

Is there any way to configure the read operation timeout or to somehow catch 
the timeout and continue to receive the next keys (Can I somehow bulk read the 
keys)?



Thanks,



Shimon




\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

