---
title: "Re: RiakSearch with java-client"
description: ""
project: community
lastmod: 2014-12-17T08:29:13-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15379"
mailinglist_parent_id: "msg15378"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2014-12-17T08:29:13-08:00
---


Santi,

The code you provided looks correct which is why I'm hoping that you
can get an error message out of a log file.

Another test would be to use HTTP to upload your schema and create the
index. We may get more information that way.

Uploading a schema via HTTP:
http://docs.basho.com/riak/latest/dev/advanced/search-schema/
Creating an index via HTTP:
http://docs.basho.com/riak/latest/dev/using/search/#Simple-Setup
--
Luke Bakken
Engineer / CSE
lbak...@basho.com


On Wed, Dec 17, 2014 at 8:17 AM, Santi Kumar  wrote:
&gt; Hi Luke,
&gt; Yes I couldn't capture it. Looks like the message that was sent to Riak has
&gt; wrong format, so it's relate to Message. I am not able to recollect now. It
&gt; displayed the complete message.
&gt;
&gt; If you can help me out with the the right way of using the Java Client api
&gt; that would be great. When I use StoreSchema with the schema content as the
&gt; string, this is happening. Is there any elegant way?
&gt;
&gt; Appreciate your help Luke
&gt;
&gt; Thanks
&gt; Santi
&gt;
&gt; On Wed, Dec 17, 2014 at 8:37 PM, Luke Bakken  wrote:
&gt;&gt;
&gt;&gt; Hi Santi,
&gt;&gt;
&gt;&gt; Do you have any error in your Riak log files? They'll be located in
&gt;&gt; /var/log/riak or dev\*/log (if you're using a devrel). In particular,
&gt;&gt; look in the solr.log file.
&gt;&gt; --
&gt;&gt; Luke Bakken
&gt;&gt; Engineer / CSE
&gt;&gt; lbak...@basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; On Mon, Dec 15, 2014 at 2:08 AM, Santi Kumar  wrote:
&gt;&gt; &gt; Hi
&gt;&gt; &gt; I'm tying to use Riak Search 2.0 with java client. Couldn't find any
&gt;&gt; &gt; good
&gt;&gt; &gt; documentation around that so I'm trying on my own. I've created my own
&gt;&gt; &gt; custom schema and want to setup this to my index. While executing the
&gt;&gt; &gt; StoreSchema command, was getting below error with some message bits.
&gt;&gt; &gt;
&gt;&gt; &gt; com.basho.riak.client.core.netty.RiakResponseException: Error processing
&gt;&gt; &gt; incoming message: error:function\_clause:xxxxxxx
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; Here is how I'm adding the Custom schema and adding index. Let me know
&gt;&gt; &gt; If
&gt;&gt; &gt; I'm doing something wrong
&gt;&gt; &gt;
&gt;&gt; &gt; public static void buildSearchIndex(String bucketName,String indexName)
&gt;&gt; &gt; throws Exception{
&gt;&gt; &gt;
&gt;&gt; &gt; InputStream systemResourceAsStream =
&gt;&gt; &gt; ClassLoader.getSystemResourceAsStream("./veradocs-solr-schema.xml");
&gt;&gt; &gt;
&gt;&gt; &gt; String schema = IOUtils.toString(systemResourceAsStream,"UTF-8");
&gt;&gt; &gt;
&gt;&gt; &gt; RiakClient client = RiakClientUtil.getClient();
&gt;&gt; &gt;
&gt;&gt; &gt; YokozunaSchema yschema = new YokozunaSchema("veradocs-rs", schema);
&gt;&gt; &gt;
&gt;&gt; &gt; StoreSchema storeSchemaOp = new
&gt;&gt; &gt; StoreSchema.Builder(yschema).build();
&gt;&gt; &gt;
&gt;&gt; &gt; client.execute(storeSchemaOp);
&gt;&gt; &gt;
&gt;&gt; &gt; YokozunaIndex vdIndex = new YokozunaIndex(indexName,schema);
&gt;&gt; &gt;
&gt;&gt; &gt; StoreIndex storeIndex =
&gt;&gt; &gt;
&gt;&gt; &gt; new StoreIndex.Builder(vdIndex).build();
&gt;&gt; &gt;
&gt;&gt; &gt; client.execute(storeIndex);
&gt;&gt; &gt;
&gt;&gt; &gt; Namespace catsBucket = new Namespace(bucketName);
&gt;&gt; &gt;
&gt;&gt; &gt; StoreBucketProperties storeBucketProps = new
&gt;&gt; &gt; StoreBucketProperties.Builder(catsBucket)
&gt;&gt; &gt;
&gt;&gt; &gt; .withSearchIndex(indexName)
&gt;&gt; &gt;
&gt;&gt; &gt; .build();
&gt;&gt; &gt;
&gt;&gt; &gt; RiakFuture executeAsync =
&gt;&gt; &gt; client.executeAsync(storeBucketProps);
&gt;&gt; &gt;
&gt;&gt; &gt; executeAsync.get();
&gt;&gt; &gt;
&gt;&gt; &gt; }
&gt;&gt; &gt;
&gt;&gt; &gt; Thanks
&gt;&gt; &gt; Santi
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt; &gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

