---
title: "Re: riak-cs fails to start after reimporting Docker container"
description: ""
project: community
lastmod: 2017-03-08T06:25:27-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18072"
mailinglist_parent_id: "msg18057"
author_name: "Jean-Marc Le Roux"
project_section: "mailinglistitem"
sent_date: 2017-03-08T06:25:27-08:00
---


Hello,

I finally found the problem : the riak and riak-cs config files where
stored in my app container, not in my persistent data container (where the
riak data is).
Whenever I upgraded the app container to a newly generated one, the conf
files and especially the admin user credentials did not match.

Yet, two things are rather surprising :

 - AFAIK all the provided riak + Docker examples did not bother to
 properly store those conf files in a Docker volume, so they suffer from the
 same problem and cannot be used as is ;
 - IMHO the riak-cs error is completely misleading and useless :
 "notfound" should be "admin\_user\_not\_found" or "invalid\_admin\_user".

Please feel free to ask me any question so that I can help understanding
this and fix this misleading and - quite frankly completely useless -
"notfound" error message.

I hope this helps.

Regards,

2017-03-08 15:04 GMT+01:00 Luca Favatella &lt;
luca.favate...@erlang-solutions.com&gt;:

&gt; On 6 March 2017 at 03:49, Toby Corkindale  wrote:
&gt; &gt;
&gt; &gt; I tried quite hard to get Riak to work reliably in a Docker container,
&gt; in a long-term-use kind of way.
&gt; &gt; Riak would never shutdown cleanly, though, and so at startup there would
&gt; always be lots of lock files left around that had to be deleted first.
&gt; &gt;
&gt; &gt; Riak is not well-behaved after a rough shutdown -- whether in a Docker
&gt; container, or running on bare metal. Tends to require sysadmin intervention
&gt; to clean things up.
&gt; &gt;
&gt; &gt; If you're running it in a Docker container, you need to figure out a way
&gt; to capture the incoming SIGTERM and then use that to shutdown Riak cleanly.
&gt; I never got that far.
&gt;
&gt; Hi,
&gt;
&gt; FYI
&gt;
&gt; I opened a ticket for tracking wish to use SIGTERM for stopping Riak KV:
&gt; https://github.com/basho/riak/issues/899
&gt;
&gt;
&gt; Thanks for sharing your experiences.
&gt;
&gt; Regards
&gt; Luca
&gt;



-- 
\*Jean-Marc Le Roux\*


Founder and CEO of Aerys (http://aerys.in)

Blog: http://blogs.aerys.in/jeanmarc-leroux
Cell: (+33)6 20 56 45 78
Phone: (+33)9 72 40 17 58
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

