---
title: "Re: List keys and multiple buckets"
description: ""
project: community
lastmod: 2011-11-15T09:34:30-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05585"
mailinglist_parent_id: "msg05584"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2011-11-15T09:34:30-08:00
---


Refresh my memory, does leveldb open new files for each bucket? I'm thinking 
there may be some file descriptor penalty for this many buckets. 

Otherwise you could set your default bucket properties to what you would want 
for these user buckets and then change properties if need be for a handful of 
other buckets you may need in your application.

Cheers, 

 
Alexander Sicular
@siculars
http://sicuars.posterous.com


On Tuesday, November 15, 2011 at 12:17 PM, Kresten Krab Thorup wrote:

&gt; 
&gt; On Nov 15, 2011, at 5:07 PM, Izhar Ravid wrote:
&gt; 
&gt; Assuming I wish to store user information for some 200M users, and create a 
&gt; bucket per user. Each user bucket will contain several dozen objects.
&gt; - Will list-keys on such a user bucket be a reasonable action?
&gt; 
&gt; When using leveldb as the backend, list-keys is isolated to a bucket. As far 
&gt; as I can see, list\_keys is a "blocking operation" meaning that a vnode doing 
&gt; list\_keys can not respond to other requests while it is processing. So; in 
&gt; this case ... using leveldb and ~dozens of keys per bucket it does sound 
&gt; reasonable.
&gt; 
&gt; - Is list-keys isolated to a bucket?
&gt; - Is it reasonable to expect Riak to hold 200M buckets?
&gt; 
&gt; I'd say that it depends on your need to configure bucket properties.
&gt; 
&gt; Riak stores bucket properties in "the ring", which is a riak cluster's 
&gt; distributed state management.
&gt; 
&gt; The ring is not designed to have 200M entries as far as I know; and if you 
&gt; need to set bucket properties then the ring needs to hold those values (if 
&gt; you use the default properties it requires no state).
&gt; 
&gt; So, ... the answer is probably no in this case; 200M buckets is not 
&gt; reasonable, because you will likely eventually want to define properties for 
&gt; these buckets.
&gt; 
&gt; Kresten
&gt; 
&gt; 
&gt; Kind regards,
&gt; Izhar.
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

