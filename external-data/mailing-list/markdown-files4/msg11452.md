---
title: "Re: Upgrade path 1.4.0"
description: ""
project: community
lastmod: 2013-07-10T06:16:19-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11452"
mailinglist_parent_id: "msg11449"
author_name: "Jared Morrow"
project_section: "mailinglistitem"
sent_date: 2013-07-10T06:16:19-07:00
---


We try to post the packages to all the right places before we make
the announcement so I'd highly recommend you don't just auto-update Riak
packages when they hit apt/yum.

I'm glad you eventually got all your nodes upgraded.

-Jared


On Wed, Jul 10, 2013 at 5:42 AM, Toby Corkindale &lt;
toby.corkind...@strategicdata.com.au&gt; wrote:

&gt; Yeah, I didn't think 1.4.0 was into final release yet either -- yet it
&gt; came through on the Debian and Ubuntu apt repositories automatically this
&gt; evening.
&gt;
&gt; ----- Original Message -----
&gt; From: "Guido Medina" 
&gt; To: "riak-users" 
&gt; Sent: Wednesday, 10 July, 2013 9:39:02 PM
&gt; Subject: Re: Upgrade path 1.4.0
&gt;
&gt; Hi Toby,
&gt;
&gt; I'm sure someone from Basho will answer soon, I just pointed you to the
&gt; "release notes" direction. I have only overlooked the release notes
&gt; until we decide to migrate to 1.4.0 when is final (Right now on rc1)
&gt;
&gt; HTH,
&gt;
&gt; Guido.
&gt;
&gt; On 10/07/13 12:29, Toby Corkindale wrote:
&gt; &gt; Thanks Guido.
&gt; &gt;
&gt; &gt; Looks like we've upgraded to 1.4.0 completely now and the cluster is
&gt; back up.
&gt; &gt;
&gt; &gt; I'm not sure of the exact root cause, but what we were seeing was that
&gt; too many nodes went down for the ring to be healthy, and then when nodes
&gt; were restarted they waited for the ring to appear for a while, and then
&gt; exited (or crashed) automatically.
&gt; &gt;
&gt; &gt; I \*think\* this is because after the package was upgraded, the Riak
&gt; service didn't restart after the upgrade -- and our automated system to
&gt; catch that and restart them wasn't kicking in quickly enough compared to
&gt; the rate at which the servers were being upgraded.
&gt; &gt;
&gt; &gt; You mention in the release notes that the init scripts have been
&gt; adjusted - maybe that has something to do with it?
&gt; &gt;
&gt; &gt; Cheers,
&gt; &gt; Toby
&gt; &gt;
&gt; &gt; ----- Original Message -----
&gt; &gt; From: "Guido Medina" 
&gt; &gt; To: "riak-users" 
&gt; &gt; Sent: Wednesday, 10 July, 2013 9:05:16 PM
&gt; &gt; Subject: Re: Upgrade path 1.4.0
&gt; &gt;
&gt; &gt; Release notes: https://github.com/basho/riak/blob/1.4/RELEASE-NOTES.md
&gt; &gt;
&gt; &gt; Maybe related to this?
&gt; &gt; Known Issues
&gt; &gt; leveldb 1.3 to 1.4 conversion
&gt; &gt;
&gt; &gt;
&gt; &gt; The first execution of 1.4.0 leveldb using a 1.3.x or 1.2.x dataset will
&gt; initiate an automatic conversion that could pause the startup of each node
&gt; by 3 to 7 minutes. The leveldb data in "level #1" is being adjusted such
&gt; that "level #1" can operate as an overlapped data level instead of as a
&gt; sorted data level. The conversion is simply the reduction of the number of
&gt; files in "level #1" to being less than eight via normal compaction of data
&gt; from "level #1" into "level #2". This is a one time conversion.
&gt; &gt; HTH,
&gt; &gt;
&gt; &gt; Guido.
&gt; &gt;
&gt; &gt; On 10/07/13 11:57, Toby Corkindale wrote:
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Hi,
&gt; &gt; some of our nodes upgraded to Riak 1.4.0, and are now refusing to start
&gt; and join the cluster.
&gt; &gt; Is there documentation on the upgrade path from 1.3.2 to 1.4.0? It
&gt; appears we have accidentally begun this journey, and I don't know if it's
&gt; easier to go back or forwards now..
&gt; &gt;
&gt; &gt; PS. It would have been pleasant to receive a warning about the new
&gt; version on the mailing list!
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Toby
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

