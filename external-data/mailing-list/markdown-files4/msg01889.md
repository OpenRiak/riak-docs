---
title: "precommit_fail - missing_field"
description: ""
project: community
lastmod: 2011-01-05T07:27:35-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01889"
author_name: "bogdan"
project_section: "mailinglistitem"
sent_date: 2011-01-05T07:27:35-08:00
---



Hello,

I have three-node riak search cluster, with buckets enabled for indexing and
the apropriate schema for the index

Using riak http client the document is inserted with success.

But using riak protocol buffer client the following error occurs:
{error,&lt;&lt;"{precommit\_fail,{error,missing\_field,&lt;&lt;\"value\"&gt;&gt;}}"&gt;&gt;}

when trying to insert the document like this:

365&gt; {ok, Pid1} = riakc\_pb\_socket:start\_link(Server, 8087).
366&gt; f(Obj),Obj = riakc\_obj:new(&lt;&lt;"noi"&gt;&gt;, &lt;&lt;"0000314855"&gt;&gt;,
term\_to\_binary(Data), list\_to\_binary("application/x-erlang-term")).
{riakc\_obj,&lt;&lt;"noi"&gt;&gt;,&lt;&lt;"0000314855"&gt;&gt;,undefined,[],
 {dict,1,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],...},
 
{{[],[],[],[],[],[],[],[],[],[],[[&lt;&lt;...&gt;&gt;|...]],[],[],...}}},
 &lt;&lt;131,108,0,0,0,113,97,123,107,0,11,34,100,111,109,97,
 105,110,95,105,100,34,...&gt;&gt;}
367&gt; riakc\_pb\_socket:put(Pid1, Obj).
{error,&lt;&lt;"{precommit\_fail,{error,missing\_field,&lt;&lt;\"value\"&gt;&gt;}}"&gt;&gt;}
368&gt;

The schema defines all fields in the document with their type correctly.

I don't know what causing this problem.

If I insert the same Object into a bucket with index hook disabled,
everything works fine.

What stopping the pb\_socket erlang client to insert a document into an
index-enabled bucket?

Thank you in advanced


-- 
View this message in context: 
http://riak-users.197444.n3.nabble.com/precommit-fail-missing-field-tp2199170p2199170.html
Sent from the Riak Users mailing list archive at Nabble.com.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

