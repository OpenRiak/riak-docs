---
title: "Re: support for 'multi_get'?"
description: ""
project: community
lastmod: 2010-04-12T12:06:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00009"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-04-12T12:06:14-07:00
---


Gareth,

Sorry for the delayed reply. No, it will not open 1k local sockets in the 
cluster - all requests within the cluster are done via Erlang messaging, which 
is abstracted away from the application and managed by the Erlang VM.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Apr 7, 2010, at 8:21 PM, Gareth Stokes wrote:

&gt; Hrrm, Im finding a need for this feature as well. 
&gt; Thinking the MapReduce solution is probably the safest bet seeing as I can't 
&gt; really limit my users to a N gets of under 20 or so. 
&gt; 
&gt; In the hypothetical world, if I perform a MapReduce over say 1k different 
&gt; keys, are you saying that would open 1k local sockets on my riak cluster?
&gt; 
&gt; On 31 March 2010 03:13, TuX RaceR  wrote:
&gt; Thanks John, for the link to your ruby code.
&gt; To get a faster answer probably an native (erlang) solution would beat a HTTP 
&gt; solution.
&gt; If you request 100 keys, then you'll need to open 100 HTTP sockets and then 
&gt; 100 erlang sockets (or maybe there is a ruse of connections).
&gt; Also I am wondering how this scales.
&gt; The optimistic me would say that doing N gets in parallel would take just as 
&gt; long as doing 1 get. ;)
&gt; This may be true for N low (say 10 or 20) but probably false for larger 
&gt; values of N (e.g. 100) ;)
&gt; 
&gt; Thanks
&gt; TuX
&gt; 
&gt; 
&gt; John Lynch wrote:
&gt; TuX,
&gt; 
&gt; You can also issue multiple concurrent HTTP requests yourself, I have an 
&gt; example of doing this with Ruby/Typhoeus here: http://bit.ly/9h1eF9
&gt; 
&gt; 
&gt; Regards,
&gt; 
&gt; John Lynch, CTO
&gt; Rigel Group, LLC
&gt; j...@rigelgroupllc.com 
&gt; 
&gt; 
&gt; 
&gt; On Tue, Mar 30, 2010 at 8:47 AM, Grant Schofield  &gt; wrote:
&gt; 
&gt; 
&gt; On Mar 30, 2010, at 4:50 AM, TuX RaceR wrote:
&gt; 
&gt; &gt; Hello Riak Users,
&gt; &gt;
&gt; &gt; This is another newbie question:
&gt; &gt; I am reading the doc at
&gt; &gt; http://riak.basho.com/edoc/riak\_client.html
&gt; &gt; and was wondering if there was support for a multiget function,
&gt; i,.e. having a list of (bucket\_i,key\_i) (or
&gt; (bucket,(key\_1,key\_2,key\_3...)) do concurrently a get on each
&gt; (bucket,key).
&gt; &gt; As erlang is presented as a 'concurrency oriented' programming
&gt; language, I'd guess it should be rather easy to do.
&gt; &gt; Or is such a use case not recommended as being too slow? What
&gt; would be the limiting speed factor in such a case: disk speed
&gt; (random access) or network speed?
&gt; &gt;
&gt; 
&gt; There currently isn't a multiget function, but there aren't any
&gt; major limitations preventing us from adding it. The one concern
&gt; might be error reporting (IE you request 100 keys and 1 fails),
&gt; but that shouldn't be too hard to work around. I have opened a
&gt; bug (http://issues.basho.com/show\_bug.cgi?id=96) to track this
&gt; feature request.
&gt; 
&gt; One way to work around the lack of multiget would be to pass the
&gt; keys you want as input to a map/reduce query and return the
&gt; result, but you wouldn't have the ability to change the R value
&gt; like you do with a standard get request.
&gt; 
&gt; &gt; Also I am wondering about how links walking (or mapred)
&gt; internally works. Does riak do concurrent multi gets based on link
&gt; keys, wait for all the answers, and then present the whole result ?
&gt; 
&gt; Multiget isn't done for map/reduce and links. A get is performed
&gt; for each of the objects sent to the map phase, but those gets and
&gt; the map code are done on the local node on which the key exists.
&gt; 
&gt; Thanks for the feature request.
&gt; 
&gt; Grant Schofield
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com 
&gt; 
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

