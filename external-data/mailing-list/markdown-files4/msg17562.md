---
title: "Re: Detecting Hinted Handoff"
description: ""
project: community
lastmod: 2016-07-25T03:40:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17562"
mailinglist_parent_id: "msg17561"
author_name: "DeadZen"
project_section: "mailinglistitem"
sent_date: 2016-07-25T03:40:35-07:00
---


Agreed rolling your own 2i is likely your best bet here, I too am wondering
what purpose it would serve you.


On Monday, July 25, 2016, Russell Brown  wrote:

&gt; But I still don’t understand \_why\_? What is the aim, ‘cos I’m not sure
&gt; it’s possible.
&gt;
&gt; For quorum reads on indexes then Sargun’s “roll your own” idea is the
&gt; better answer at the moment.
&gt;
&gt; On 25 Jul 2016, at 11:25, DeadZen &gt;
&gt; wrote:
&gt;
&gt; &gt; Hinted handoff from adding a node, removing a node or failing a node?
&gt; Could probably get some idea from a ring handler, hinted handoff could
&gt; likely very well trigger its own event as well without a large modification
&gt; to riak\_core
&gt; &gt;
&gt; &gt;
&gt; &gt; On Sunday, July 24, 2016, Sargun Dhillon  &gt; wrote:
&gt; &gt; It might also make a lot of sense to roll your own secondary indices.
&gt; That is, have a CRDT set represent the primary key of the rows which meet
&gt; the 2i condition. In that, you can query the CRDT set, and ensure some
&gt; level of consistency. There are further tricks to be played here if
&gt; interested.
&gt; &gt;
&gt; &gt; I'm curious, what is your data model?
&gt; &gt;
&gt; &gt; On Fri, Jul 22, 2016 at 11:01 AM, Alexander Sicular  &gt; wrote:
&gt; &gt; Take a look at the "pw" and "pr" tunable consistency options for gets
&gt; and puts. The base level of abstraction in Riak is the virtual node - not
&gt; the physical machine. When data is replicated it is replicated to a replica
&gt; set of virtual nodes. Those virtual nodes have primary and secondary (due
&gt; to failures) allocations to physical machines. When using "pr" and "pw"
&gt; options you instruct Riak to only service the request from virtual nodes
&gt; that are residing on their primarily allocated physical machines. In short,
&gt; by abusing pr/pw you can infer the state of your cluster from your
&gt; application.
&gt; &gt;
&gt; &gt; Obviously, this is not foolproof. There may also be additional 2i
&gt; specific issues to consider. Nevertheless, I always liked this trick.
&gt; &gt;
&gt; &gt; Also, review this four part series on tunable consistency :
&gt; &gt;
&gt; &gt;
&gt; http://basho.com/posts/technical/understanding-riaks-configurable-behaviors-part-1/
&gt; &gt; http://basho.com/posts/technical/riaks-config-behaviors-part-2/
&gt; &gt; http://basho.com/posts/technical/riaks-config-behaviors-part-3/
&gt; &gt; http://basho.com/posts/technical/riaks-config-behaviors-part-4/
&gt; &gt;
&gt; &gt; -Alexander
&gt; &gt;
&gt; &gt;
&gt; &gt; @siculars
&gt; &gt; http://siculars.posthaven.com
&gt; &gt;
&gt; &gt; Sent from my iRotaryPhone
&gt; &gt;
&gt; &gt; On Jul 22, 2016, at 12:28, Hawk Newton  &gt; wrote:
&gt; &gt;
&gt; &gt;&gt; I've got a use case in which I'd like to use a secondary index but can't
&gt; &gt;&gt; tolerate partial result sets caused by hinted handoffs. I'm not
&gt; currently
&gt; &gt;&gt; running riak search and, as this is a fringe case, would prefer not add
&gt; the
&gt; &gt;&gt; additional overhead and complexity if I can help it.
&gt; &gt;&gt;
&gt; &gt;&gt; I'd like to detect a hinted handoff operation and throw a 503, if
&gt; possible.
&gt; &gt;&gt;
&gt; &gt;&gt; Does anyone know of a way I can programatically detect if a hinted
&gt; handoff
&gt; &gt;&gt; is underway without having to shell out to riak-admin (yuck!) and parse
&gt; the
&gt; &gt;&gt; results? I'm running riak 2.0.5 at the moment.
&gt; &gt;&gt;
&gt; &gt;&gt; Thank you in advance.
&gt; &gt;&gt;
&gt; &gt;&gt; -- Hawk
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; --
&gt; &gt;&gt; View this message in context:
&gt; http://riak-users.197444.n3.nabble.com/Detecting-Hinted-Handoff-tp4034489.html
&gt; &gt;&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt; &gt;&gt;
&gt; &gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt;&gt; riak-users mailing list
&gt; &gt;&gt; riak-users@lists.basho.com 
&gt; &gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com 
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com 
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

