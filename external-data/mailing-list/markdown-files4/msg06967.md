---
title: "Re: riak-python-client2, a rewrite of the official client"
description: ""
project: community
lastmod: 2012-03-15T08:13:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06967"
mailinglist_parent_id: "msg06966"
author_name: "Shuhao Wu"
project_section: "mailinglistitem"
sent_date: 2012-03-15T08:13:31-07:00
---


I'm looked into just modifying and contributing to the existing library, and
found several issues with it. Here's my main motivation for a rewrite:

  1. The current structure riak-python-client is somewhat messy. Everything
 depends on each other. Just look at things like RiakLink and
RiakIndexEntry.
 They're unnecessary and overcomplicates the code. Furthermore, if you look
 the transports, it's very much dependent on things like RiakObject, and
 RiakObject is pretty much nothing without the transport. It's almost like a
 circular dependency. So instead, I redesigned the transports to operate
 independently from things like RiakObject. To do this, simply modifying
 is not feasible and it will result in an almost complete rewrite anyway due
 to the dependencies problems I described.
 2. There's a lot of "bloat" in the current riak-python-client. A simple
 example would be get\_ and set\_, as well as things like RiakLink and
 RiakIndexEntry. To get rid of those would pretty much require a rewrite as
 well.
 3. Basho currently do not have a dedicated python developer working on this.
 I don't know this for sure but I think their resources, in terms
of clients,
 go mainly to java, ruby and javascript, though that's just my observations.

My primary goal of having a rewrite is hopefully simplify the code base as well
as improve some aspects of the python client (such as not using deprecated
functions such as apply) and (hopefully) increase the speed of the client.
After examining the code (which I had to do while rewriting), I don't think
simply modifying the current codebase could fix its issues (there are more
issues then what I've stated), and I don't think it will take as long as people
think. The current code base has about 4k lines of python and 0.5k lines of
Erlang. In my client, a chunk of the code actually comes from the original
client as they work with a few adaptations.

As far as road map goes, I'm currently just rewriting all the functionalities
provided by the current python client, and here's a list of things that Sean
would like to see accomplished, which I will work on once I have all the
functionalities of the current client complete:

 https://gist.github.com/1959278

I hope I've answered all the questions. If there is any more questions/comments,
feel free to shoot it my way.

Shuhao


On Thu, Mar 15, 2012 at 5:30 AM, Andrey V. Martyanov  wrote:
&gt;
&gt; Hi Shuhao,
&gt;
&gt; What is the reason to create a fork? What is your primary goal? Do you have 
&gt; any particular plans or roadmap? It would be very helpful.
&gt;
&gt; Best regards,
&gt; Andrey Mart
&gt;
&gt; On Thu, Mar 15, 2012 at 5:30 AM, Shuhao Wu  wrote:
&gt;&gt;
&gt;&gt; That would be most appreciated.
&gt;&gt;
&gt;&gt; I just completed a very bare minimum higher level API that's similar to the 
&gt;&gt; current Python client. However, there's still a lot of work to be done. Once 
&gt;&gt; again, I'm just one lone student working in my spare time and I can't 
&gt;&gt; possibly think of everything. If we want to bring Python up to speed with 
&gt;&gt; the rest of the clients, I'll need more people helping me!
&gt;&gt;
&gt;&gt; Also, I have a general plan of bringing riakkit to riak-python-client2 as 
&gt;&gt; well.
&gt;&gt;
&gt;&gt; Shuhao
&gt;&gt;
&gt;&gt;
&gt;&gt; On Mon, Mar 12, 2012 at 12:50 AM, Jim Adler  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; I'll certainly take a look at your repo and help where I can.
&gt;&gt;&gt;
&gt;&gt;&gt; Jim
&gt;&gt;&gt;
&gt;&gt;&gt; Sent from my phone. Please forgive the typos.
&gt;&gt;&gt;
&gt;&gt;&gt; On Mar 11, 2012, at 11:25 PM, Shuhao Wu  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I'm not too familiar with PBC . I'm looking for individuals to help me as 
&gt;&gt;&gt; I'm just a student and only working on it in my spare time.
&gt;&gt;&gt;
&gt;&gt;&gt; Shuhao
&gt;&gt;&gt;
&gt;&gt;&gt; On Mar 11, 2012 10:43 PM, "Jim Adler"  wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This is great Shuhao!
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I've had problems using the python client using multiple threads with 
&gt;&gt;&gt;&gt; protocol buffers. The exact same multithreaded code works fine with http 
&gt;&gt;&gt;&gt; protocol. So, any attention you can give to the pbc transport would be 
&gt;&gt;&gt;&gt; hugely appreciated.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Good luck! Can't wait to give your new client a test drive.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Jim
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Sent from my phone. Please forgive the typos.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Mar 11, 2012, at 12:31 PM, Shuhao Wu  wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hey guys,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I've been working with riak and python for the past couple of months, and 
&gt;&gt;&gt;&gt; I'm at the point where I'm ready to completely reimplement 
&gt;&gt;&gt;&gt; riak-python-client. So.. I did/started. The project is hosted on github 
&gt;&gt;&gt;&gt; and under the same apache 2 license as the original client.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; https://github.com/ultimatebuster/riak-python-client2
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Couple of key highlights right now:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;  1. 2 layers of API, a very basic layer (Transports), which handles 
&gt;&gt;&gt;&gt; communicating with the server, and a high level API, which consists of 
&gt;&gt;&gt;&gt; Bucket, Object, and so on.
&gt;&gt;&gt;&gt;  2. Eliminated things like `set\_` and `get\_`. Made them just variables 
&gt;&gt;&gt;&gt; where possible
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I'm still taking suggestions for how to reimplement RiakObject (now called 
&gt;&gt;&gt;&gt; RObject). Any feedback will be appreciated.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Cheers,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Shuhao
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

