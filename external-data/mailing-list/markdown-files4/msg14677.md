---
title: "Re: Python library: Error with counters"
description: ""
project: community
lastmod: 2014-08-17T10:14:10-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14677"
mailinglist_parent_id: "msg14671"
author_name: "Alex De la rosa"
project_section: "mailinglistitem"
sent_date: 2014-08-17T10:14:10-07:00
---


Hi Sean,

I tried to install version 2.1.0rc1 as you suggested, but "pip" gives a
compilation error and doesn't install it, here you have the log:

# pip install riak==2.1.0rc1
Downloading/unpacking riak==2.1.0rc1
 Downloading riak-2.1.0rc1.tar.gz (135kB): 135kB downloaded
 Running setup.py (path:/tmp/pip\_build\_root/riak/setup.py) egg\_info for
package riak

Downloading/unpacking riak-pb&gt;=2.0.0 (from riak==2.1.0rc1)
 Downloading riak\_pb-2.0.0.16.tar.gz
 Running setup.py (path:/tmp/pip\_build\_root/riak-pb/setup.py) egg\_info for
package riak-pb

Downloading/unpacking pyOpenSSL&gt;=0.14 (from riak==2.1.0rc1)
 Downloading pyOpenSSL-0.14.tar.gz (128kB): 128kB downloaded
 Running setup.py (path:/tmp/pip\_build\_root/pyOpenSSL/setup.py) egg\_info
for package pyOpenSSL

 warning: no previously-included files matching '\*.pyc' found anywhere
in distribution
 no previously-included directories found matching 'doc/\_build'
Requirement already satisfied (use --upgrade to upgrade):
protobuf&gt;=2.4.1,&lt;2.6.0 in /usr/local/lib/python2.7/dist-packages (from
riak-pb&gt;=2.0.0-&gt;riak==2.1.0rc1)
Downloading/unpacking cryptography&gt;=0.2.1 (from
pyOpenSSL&gt;=0.14-&gt;riak==2.1.0rc1)
 Downloading cryptography-0.5.3.tar.gz (319kB): 319kB downloaded
 Running setup.py (path:/tmp/pip\_build\_root/cryptography/setup.py)
egg\_info for package cryptography
 c/\_cffi\_backend.c:2:20: fatal error: Python.h: No such file or directory
 #include 
 ^
 compilation terminated.
 Traceback (most recent call last):
 File "", line 17, in 
 File "/tmp/pip\_build\_root/cryptography/setup.py", line 174, in

 "test": PyTest,
 File "/usr/lib/python2.7/distutils/core.py", line 111, in setup
 \_setup\_distribution = dist = klass(attrs)
 File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 239,
in \_\_init\_\_
 self.fetch\_build\_eggs(attrs.pop('setup\_requires'))
 File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 264,
in fetch\_build\_eggs
 replace\_conflicting=True
 File "/usr/lib/python2.7/dist-packages/pkg\_resources.py", line 620,
in resolve
 dist = best[req.key] = env.best\_match(req, ws, installer)
 File "/usr/lib/python2.7/dist-packages/pkg\_resources.py", line 858,
in best\_match
 return self.obtain(req, installer) # try and download/install
 File "/usr/lib/python2.7/dist-packages/pkg\_resources.py", line 870,
in obtain
 return installer(requirement)
 File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 314,
in fetch\_build\_egg
 return cmd.easy\_install(req)
 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
616, in easy\_install
 return self.install\_item(spec, dist.location, tmpdir, deps)
 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
646, in install\_item
 dists = self.install\_eggs(spec, download, tmpdir)
 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
834, in install\_eggs
 return self.build\_and\_install(setup\_script, setup\_base)
 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
1040, in build\_and\_install
 self.run\_setup(setup\_script, setup\_base, args)
 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
1028, in run\_setup
 raise DistutilsError("Setup script exited with %s" % (v.args[0],))
 distutils.errors.DistutilsError: Setup script exited with error:
command 'x86\_64-linux-gnu-gcc' failed with exit status 1
 Complete output from command python setup.py egg\_info:
 c/\_cffi\_backend.c:2:20: fatal error: Python.h: No such file or directory

 #include 

 ^

compilation terminated.

Traceback (most recent call last):

 File "", line 17, in 

 File "/tmp/pip\_build\_root/cryptography/setup.py", line 174, in 

 "test": PyTest,

 File "/usr/lib/python2.7/distutils/core.py", line 111, in setup

 \_setup\_distribution = dist = klass(attrs)

 File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 239, in
\_\_init\_\_

 self.fetch\_build\_eggs(attrs.pop('setup\_requires'))

 File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 264, in
fetch\_build\_eggs

 replace\_conflicting=True

 File "/usr/lib/python2.7/dist-packages/pkg\_resources.py", line 620, in
resolve

 dist = best[req.key] = env.best\_match(req, ws, installer)

 File "/usr/lib/python2.7/dist-packages/pkg\_resources.py", line 858, in
best\_match

 return self.obtain(req, installer) # try and download/install

 File "/usr/lib/python2.7/dist-packages/pkg\_resources.py", line 870, in
obtain

 return installer(requirement)

 File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 314, in
fetch\_build\_egg

 return cmd.easy\_install(req)

 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
616, in easy\_install

 return self.install\_item(spec, dist.location, tmpdir, deps)

 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
646, in install\_item

 dists = self.install\_eggs(spec, download, tmpdir)

 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
834, in install\_eggs

 return self.build\_and\_install(setup\_script, setup\_base)

 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
1040, in build\_and\_install

 self.run\_setup(setup\_script, setup\_base, args)

 File
"/usr/lib/python2.7/dist-packages/setuptools/command/easy\_install.py", line
1028, in run\_setup

 raise DistutilsError("Setup script exited with %s" % (v.args[0],))

distutils.errors.DistutilsError: Setup script exited with error: command
'x86\_64-linux-gnu-gcc' failed with exit status 1

----------------------------------------
Cleaning up...
Command python setup.py egg\_info failed with error code 1 in
/tmp/pip\_build\_root/cryptography
Storing debug log for failure in /root/.pip/pip.log

Thanks,
Alex


On Fri, Aug 15, 2014 at 7:07 PM, Sean Cribbs  wrote:

&gt; Hi Alex,
&gt;
&gt; The published version is not a final release, so it won't be
&gt; automatically installed by pip. Try this: pip install riak==2.1.0rc1
&gt;
&gt; Also, did you activate your bucket-type using riak-admin? It won't be
&gt; usable until it's activated.
&gt;
&gt; On Fri, Aug 15, 2014 at 12:02 PM, Alex De la rosa
&gt;  wrote:
&gt; &gt; Hi, thanks for your suggestion, but I would prefer to use the official
&gt; &gt; packages, and for what I saw on the list some days ago, the new version
&gt; was
&gt; &gt; published, so I wonder why is not yet working.
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Alex
&gt; &gt;
&gt; &gt;
&gt; &gt; On Fri, Aug 15, 2014 at 6:20 PM, tele  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Hi Alex,
&gt; &gt;&gt;
&gt; &gt;&gt; Use the version from git and see if you get the same error:
&gt; &gt;&gt;
&gt; &gt;&gt; git clone https://github.com/basho/riak-python-client.git
&gt; &gt;&gt; cd riak-python-client
&gt; &gt;&gt; python setup.py install
&gt; &gt;&gt;
&gt; &gt;&gt; :tele
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; On Fri, 15 Aug 2014 18:12:09 +0200
&gt; &gt;&gt; Alex De la rosa  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; &gt; Hi there,
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I created a "counter" bucket called "likes" with the following shell
&gt; &gt;&gt; &gt; script:
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; riak-admin bucket-type create likes '{"props":{"datatype":"counter"}}'
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; When I try to follow the guide [
&gt; &gt;&gt; &gt; http://docs.basho.com/riak/2.0.0/dev/using/data-types ] to use this
&gt; &gt;&gt; &gt; bucket with Python, I found the following issue:
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Traceback (most recent call last):
&gt; &gt;&gt; &gt; File "x.py", line 17, in 
&gt; &gt;&gt; &gt; bucket = client.bucket\_type('counter\_bucket').bucket('likes')
&gt; &gt;&gt; &gt; AttributeError: 'RiakClient' object has no attribute 'bucket\_type'
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Something wrong? Is a fresh install from "pip" so I thought the Python
&gt; &gt;&gt; &gt; library would be in its last updated version?
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Thanks!
&gt; &gt;&gt; &gt; Alex
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Sean Cribbs 
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

