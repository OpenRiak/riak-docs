---
title: "Re: riak-erlang-client: riakc_pb_socket.erl:72: type ctx() > undefined"
description: ""
project: community
lastmod: 2010-09-08T11:11:41-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01056"
author_name: "matteo.redae...@libero.it"
project_section: "mailinglistitem"
sent_date: 2010-09-08T11:11:41-07:00
---


Hello 

My PC is a stable ubuntu linux that contains

 Erlang R13B03 (erts-5.7.4)

regards

&gt;----Messaggio originale----
&gt;Da: riak-users-requ...@lists.basho.com
&gt;Data: 08/09/2010 18.00
&gt;A: 
&gt;Ogg: riak-users Digest, Vol 14, Issue 11
&gt;
&gt;Send riak-users mailing list submissions to
&gt; riak-users@lists.basho.com
&gt;
&gt;To subscribe or unsubscribe via the World Wide Web, visit
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;or, via email, send a message with subject or body 'help' to
&gt; riak-users-requ...@lists.basho.com
&gt;
&gt;You can reach the person managing the list at
&gt; riak-users-ow...@lists.basho.com
&gt;
&gt;When replying, please edit your Subject line so it is more specific
&gt;than "Re: Contents of riak-users digest..."
&gt;
&gt;
&gt;Today's Topics:
&gt;
&gt; 1. Is there difference between "MapReduce" and "MapReduce in
&gt; RIAK"? (Ken Matsumoto)
&gt; 2. sane way to edit json map reduce functions? (Bryan Berry)
&gt; 3. Re: Is there difference between "MapReduce" and "MapReduce in
&gt; RIAK"? (Kevin Smith)
&gt; 4. Re: sane way to edit json map reduce functions? (Sean Cribbs)
&gt; 5. riak-erlang-client: riakc\_pb\_socket.erl:72: type ctx()
&gt; undefined (matteo.redae...@libero.it)
&gt; 6. Re: riak-erlang-client: riakc\_pb\_socket.erl:72: type ctx()
&gt; undefined (Jon Meredith)
&gt; 7. Re: Is there difference between "MapReduce" and "MapReduce in
&gt; RIAK"? (Les Mikesell)
&gt;
&gt;
&gt;----------------------------------------------------------------------
&gt;
&gt;Message: 1
&gt;Date: Tue, 07 Sep 2010 19:52:08 -0700
&gt;From: Ken Matsumoto 
&gt;To: riak-users@lists.basho.com
&gt;Subject: Is there difference between "MapReduce" and "MapReduce in
&gt; RIAK"?
&gt;Message-ID: &lt;4c86fa58.4020...@nri.com&gt;
&gt;Content-Type: text/plain; charset=UTF-8; format=flowed
&gt;
&gt;Hi all,
&gt;
&gt;Is there difference between "MapReduce in Hadoop" and "MapReduce in RIAK"?
&gt;I tested these performances and there were difference even in the same 
&gt;machine, same data.
&gt;I'd like to know the difference like:
&gt;
&gt;- Version? Which is newer or branched?
&gt;- Does RIAK build in on source level or binary?
&gt;- Number of performance tuning parameters?
&gt;- What else?
&gt;
&gt;Regards,
&gt;
&gt;Ken.
&gt;
&gt;-- 
&gt;Ken Matsumoto
&gt;VP / Research & Development
&gt;Nomura Research Institute America, Inc.
&gt;NRI Pacific
&gt;1400 Fashion Island Blvd., Suite 1010
&gt;San Mateo, CA 94404, U.S.A.
&gt;
&gt;PLEASE READ?This e-mail is confidential and intended for the named 
&gt;recipient only. If you are not an intended recipient, please notify the 
&gt;sender and delete this e-mail.
&gt;
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 2
&gt;Date: Wed, 8 Sep 2010 10:44:06 +0200
&gt;From: Bryan Berry 
&gt;To: riak-users@lists.basho.com
&gt;Subject: sane way to edit json map reduce functions?
&gt;Message-ID:
&gt; 
&gt;Content-Type: text/plain; charset="iso-8859-1"
&gt;
&gt;hey riak buddies, I find that I have to write my mapreduce functions in one
&gt;single line w/out tabs or line breaks.
&gt;Is there an easier way to do it? This makes my code pretty unreadable.
&gt;
&gt;I am using emacs btw, w/ js2-mode
&gt;-------------- next part --------------
&gt;An HTML attachment was scrubbed...
&gt;URL: 
&gt;
&gt;------------------------------
&gt;
&gt;Message: 3
&gt;Date: Wed, 8 Sep 2010 07:58:43 -0400
&gt;From: Kevin Smith 
&gt;To: Ken Matsumoto 
&gt;Cc: riak-users@lists.basho.com
&gt;Subject: Re: Is there difference between "MapReduce" and "MapReduce in
&gt; RIAK"?
&gt;Message-ID: &lt;0b5183b4-d532-425f-afc7-d383dce80...@basho.com&gt;
&gt;Content-Type: text/plain; charset=utf-8
&gt;
&gt;Ken - 
&gt;
&gt;Riak contains its own implementation of a MapReduce API. This API is written 
in Erlang and C and shares no code with Hadoop. We have, on occasion, described 
our API as "Hadoop like" to help people understand the differences between our 
implementation and others. For example:
&gt;
&gt;\* CouchDB's MapReduce incrementally builds a BTree thru the execution of 
views. Riak doesn't cache or store MapReduce results. Each job executes "from 
scratch" and returns results to caller. It is up to the caller to cache or 
store these results if needed.
&gt;
&gt;\* Hadoop MapReduce jobs use HDFS or HDFS-adapted resources. Riak MapReduce 
jobs use data stored in a Riak cluster.
&gt;
&gt;\* Riak MapReduce jobs take advantage of their execution environment. Map 
functions exploit data locality. This means map functions are sent to the node 
hosting the required data rather than streaming the data to a central 
coordinating node. The most recent version of Riak also includes improvements 
which has significantly boosted the efficiency of mapping over entire buckets 
of data.
&gt;
&gt;\* Riak supports writing MapReduce functions in two languages: Erlang and 
Javascript. Erlang is the absolute fastest, in terms of raw speed, but 
Javascript runs a close second and is easier for most people to use.
&gt;
&gt;Depending on what your jobs are doing and which language, Erlang or 
Javascript, there are a few tunable parameters we can tweak to improve 
performance. More information about what your job is doing, how your cluster is 
set up, and the kinds of performance you're seeing would help us debug the 
situation.
&gt;
&gt;--Kevin
&gt;On Sep 7, 2010, at 10:52 PM, Ken Matsumoto wrote:
&gt;
&gt;&gt; Hi all,
&gt;&gt; 
&gt;&gt; Is there difference between "MapReduce in Hadoop" and "MapReduce in RIAK"?
&gt;&gt; I tested these performances and there were difference even in the same 
machine, same data.
&gt;&gt; I'd like to know the difference like:
&gt;&gt; 
&gt;&gt; - Version? Which is newer or branched?
&gt;&gt; - Does RIAK build in on source level or binary?
&gt;&gt; - Number of performance tuning parameters?
&gt;&gt; - What else?
&gt;&gt; 
&gt;&gt; Regards,
&gt;&gt; 
&gt;&gt; Ken.
&gt;&gt; 
&gt;&gt; -- 
&gt;&gt; Ken Matsumoto
&gt;&gt; VP / Research & Development
&gt;&gt; Nomura Research Institute America, Inc.
&gt;&gt; NRI Pacific
&gt;&gt; 1400 Fashion Island Blvd., Suite 1010
&gt;&gt; San Mateo, CA 94404, U.S.A.
&gt;&gt; 
&gt;&gt; PLEASE READ?This e-mail is confidential and intended for the named 
recipient only. If you are not an intended recipient, please notify the sender 
and delete this e-mail.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 4
&gt;Date: Wed, 8 Sep 2010 08:23:19 -0400
&gt;From: Sean Cribbs 
&gt;To: Bryan Berry 
&gt;Cc: riak-users@lists.basho.com
&gt;Subject: Re: sane way to edit json map reduce functions?
&gt;Message-ID: 
&gt;Content-Type: text/plain; charset=us-ascii
&gt;
&gt;Bryan,
&gt;
&gt;That should only be an issue if you are putting the source of the function 
directly in your query. Instead, try saving the function in a bucket/key and 
refer to it that way. Here's what a phase using bucket/key instead of source 
would look like:
&gt;
&gt;{"map":{"language":"javascript","bucket":"customMR","key":"
extractSomeFields","keep":false}}
&gt;
&gt;You can use curl or any one of the the language-specific clients to store the 
function, just specify "application/javascript" as the content-type.
&gt;
&gt;I use this technique in the "yakriak" demo app: http://github.
com/seancribbs/yakriak
&gt;
&gt;Sean Cribbs 
&gt;Developer Advocate
&gt;Basho Technologies, Inc.
&gt;http://basho.com/
&gt;
&gt;On Sep 8, 2010, at 4:44 AM, Bryan Berry wrote:
&gt;
&gt;&gt; hey riak buddies, I find that I have to write my mapreduce functions in one 
single line w/out tabs or line breaks. 
&gt;&gt; Is there an easier way to do it? This makes my code pretty unreadable.
&gt;&gt; 
&gt;&gt; I am using emacs btw, w/ js2-mode
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 5
&gt;Date: Wed, 8 Sep 2010 15:53:22 +0200 (CEST)
&gt;From: "matteo.redae...@libero.it" 
&gt;To: riak-users@lists.basho.com
&gt;Subject: riak-erlang-client: riakc\_pb\_socket.erl:72: type ctx()
&gt; undefined
&gt;Message-ID:
&gt; &lt;29648517.662641283954002450.javamail.defaultu...@defaulthost&gt;
&gt;Content-Type: text/plain;charset="UTF-8"
&gt;
&gt;HEllo to all,
&gt;
&gt;I'm using riak for my erlang web crawler ebot (http://www.redaelli.
org/matteo-
&gt;blog/projects/ebot/)
&gt;In these latest weeks I cannot compile riak-erlang-client
&gt;
&gt;Below my logs. Any suggestions?
&gt;
&gt;Thanks in advance
&gt;
&gt;Matteo
&gt;http://www.redaelli.org/matteo
&gt;
&gt;
&gt;
&gt;mat...@nowar:/opt$ hg clone http://hg.basho.com/riak-erlang-client -u
&gt;riakc-1.0.0
&gt;destination directory: riak-erlang-client
&gt;requesting all changes
&gt;adding changesets
&gt;adding manifests
&gt;adding file changes
&gt;added 98 changesets with 124 changes to 15 files
&gt;updating to branch default
&gt;15 files updated, 0 files merged, 0 files removed, 0 files unresolved
&gt;
&gt;mat...@nowar:/opt$ cd riak-erlang-client/
&gt;
&gt;mat...@nowar:/opt/riak-erlang-client$ make
&gt;./rebar get-deps
&gt;==&gt; riak-erlang-client (get-deps)
&gt;Pulling protobuffs from {hg,"http://bitbucket.org/basho/protobuffs",
&gt; "protobuffs-0.5.0"}
&gt;requesting all changes
&gt;adding changesets
&gt;adding manifests
&gt;adding file changes
&gt;added 91 changesets with 243 changes to 93 files (+2 heads)
&gt;29 files updated, 0 files merged, 0 files removed, 0 files unresolved
&gt;==&gt; protobuffs (get-deps)
&gt;./rebar compile
&gt;==&gt; protobuffs (compile)
&gt;Compiled src/pokemon\_pb.erl
&gt;Compiled src/protobuffs\_parser.erl
&gt;Compiled src/protobuffs\_compile.erl
&gt;Compiled src/protobuffs.erl
&gt;==&gt; riak-erlang-client (compile)
&gt;Compiling src/riakclient.proto
&gt;src/riakc\_pb\_socket.erl:72: type ctx() undefined
&gt;src/riakc\_pb\_socket.erl:72: type rpb\_req() undefined
&gt;src/riakc\_pb\_socket.erl:77: type option() undefined
&gt;src/riakc\_pb\_socket.erl:78: Warning: type option() is unused
&gt;src/riakc\_pb\_socket.erl:86: Warning: type rpb\_req() is unused
&gt;src/riakc\_pb\_socket.erl:87: Warning: type ctx() is unused
&gt;make: \*\*\* [compile] Error 1
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 6
&gt;Date: Wed, 08 Sep 2010 08:11:02 -0600
&gt;From: Jon Meredith 
&gt;To: riak-users@lists.basho.com
&gt;Subject: Re: riak-erlang-client: riakc\_pb\_socket.erl:72: type ctx()
&gt; undefined
&gt;Message-ID: &lt;4c879976.9050...@basho.com&gt;
&gt;Content-Type: text/plain; charset=ISO-8859-1; format=flowed
&gt;
&gt; Hi Matteo,
&gt;
&gt;The tip (fd76e53acac2) compiles for me under R13B04 - what version of 
&gt;erlang are you using so I can investigate?
&gt;
&gt;Jon
&gt;
&gt;On 9/8/10 7:53 AM, matteo.redae...@libero.it wrote:
&gt;&gt; HEllo to all,
&gt;&gt;
&gt;&gt; I'm using riak for my erlang web crawler ebot (http://www.redaelli.
org/matteo-
&gt;&gt; blog/projects/ebot/)
&gt;&gt; In these latest weeks I cannot compile riak-erlang-client
&gt;&gt;
&gt;&gt; Below my logs. Any suggestions?
&gt;&gt;
&gt;&gt; Thanks in advance
&gt;&gt;
&gt;&gt; Matteo
&gt;&gt; http://www.redaelli.org/matteo
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; mat...@nowar:/opt$ hg clone http://hg.basho.com/riak-erlang-client -u
&gt;&gt; riakc-1.0.0
&gt;&gt; destination directory: riak-erlang-client
&gt;&gt; requesting all changes
&gt;&gt; adding changesets
&gt;&gt; adding manifests
&gt;&gt; adding file changes
&gt;&gt; added 98 changesets with 124 changes to 15 files
&gt;&gt; updating to branch default
&gt;&gt; 15 files updated, 0 files merged, 0 files removed, 0 files unresolved
&gt;&gt;
&gt;&gt; mat...@nowar:/opt$ cd riak-erlang-client/
&gt;&gt;
&gt;&gt; mat...@nowar:/opt/riak-erlang-client$ make
&gt;&gt; ./rebar get-deps
&gt;&gt; ==&gt; riak-erlang-client (get-deps)
&gt;&gt; Pulling protobuffs from {hg,"http://bitbucket.org/basho/protobuffs",
&gt;&gt; "protobuffs-0.5.0"}
&gt;&gt; requesting all changes
&gt;&gt; adding changesets
&gt;&gt; adding manifests
&gt;&gt; adding file changes
&gt;&gt; added 91 changesets with 243 changes to 93 files (+2 heads)
&gt;&gt; 29 files updated, 0 files merged, 0 files removed, 0 files unresolved
&gt;&gt; ==&gt; protobuffs (get-deps)
&gt;&gt; ./rebar compile
&gt;&gt; ==&gt; protobuffs (compile)
&gt;&gt; Compiled src/pokemon\_pb.erl
&gt;&gt; Compiled src/protobuffs\_parser.erl
&gt;&gt; Compiled src/protobuffs\_compile.erl
&gt;&gt; Compiled src/protobuffs.erl
&gt;&gt; ==&gt; riak-erlang-client (compile)
&gt;&gt; Compiling src/riakclient.proto
&gt;&gt; src/riakc\_pb\_socket.erl:72: type ctx() undefined
&gt;&gt; src/riakc\_pb\_socket.erl:72: type rpb\_req() undefined
&gt;&gt; src/riakc\_pb\_socket.erl:77: type option() undefined
&gt;&gt; src/riakc\_pb\_socket.erl:78: Warning: type option() is unused
&gt;&gt; src/riakc\_pb\_socket.erl:86: Warning: type rpb\_req() is unused
&gt;&gt; src/riakc\_pb\_socket.erl:87: Warning: type ctx() is unused
&gt;&gt; make: \*\*\* [compile] Error 1
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 7
&gt;Date: Wed, 08 Sep 2010 10:07:47 -0500
&gt;From: Les Mikesell 
&gt;To: riak-users@lists.basho.com
&gt;Subject: Re: Is there difference between "MapReduce" and "MapReduce in
&gt; RIAK"?
&gt;Message-ID: &lt;4c87a6c3.60...@gmail.com&gt;
&gt;Content-Type: text/plain; charset=UTF-8; format=flowed
&gt;
&gt;On 9/8/2010 6:58 AM, Kevin Smith wrote:
&gt;&gt; Ken -
&gt;&gt;
&gt;&gt; Riak contains its own implementation of a MapReduce API. This API is 
written in Erlang and C and shares no code with Hadoop. We have, on occasion, 
described our API as "Hadoop like" to help people understand the differences 
between our implementation and others. For example:
&gt;&gt;
&gt;&gt; \* CouchDB's MapReduce incrementally builds a BTree thru the execution of 
views. Riak doesn't cache or store MapReduce results. Each job executes "from 
scratch" and returns results to caller. It is up to the caller to cache or 
store these results if needed.
&gt;&gt;
&gt;&gt; \* Hadoop MapReduce jobs use HDFS or HDFS-adapted resources. Riak MapReduce 
jobs use data stored in a Riak cluster.
&gt;&gt;
&gt;&gt; \* Riak MapReduce jobs take advantage of their execution environment. Map 
functions exploit data locality. This means map functions are sent to the node 
hosting the required data rather than streaming the data to a central 
coordinating node. The most recent version of Riak also includes improvements 
which has significantly boosted the efficiency of mapping over entire buckets 
of data.
&gt;&gt;
&gt;&gt; \* Riak supports writing MapReduce functions in two languages: Erlang and 
Javascript. Erlang is the absolute fastest, in terms of raw speed, but 
Javascript runs a close second and is easier for most people to use.
&gt;&gt;
&gt;&gt; Depending on what your jobs are doing and which language, Erlang or 
Javascript, there are a few tunable parameters we can tweak to improve 
performance. More information about what your job is doing, how your cluster is 
set up, and the kinds of performance you're seeing would help us debug the 
situation.
&gt;
&gt;Are there any 'high level' tools to integrate riak data into other 
&gt;systems like the hive jdbc driver for hadoop and pentaho's project to do 
&gt;reporting on top of that?
&gt;
&gt;-- 
&gt; Les Mikesell
&gt; lesmikes...@gmail.com
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;riak-users mailing list
&gt;riak-users@lists.basho.com
&gt;http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;End of riak-users Digest, Vol 14, Issue 11
&gt;\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
&gt;



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

