---
title: "Re: How to call riak_core_ring:remove_member/3 from erlang shell?"
description: ""
project: community
lastmod: 2014-08-20T14:44:59-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14764"
mailinglist_parent_id: "msg14745"
author_name: "bryan hunt"
project_section: "mailinglistitem"
sent_date: 2014-08-20T14:44:59-07:00
---


Hi Sebastian,

Wow that’s a really old version, I know with modern versions the ring file can 
be nuked at the expense of a ton of transfer activity when you join the nodes 
back into a single cluster, shouldn’t lose data though. Anyone want to chime in 
with an opinion on this version ? 

Bryan

On 20 Aug 2014, at 20:28, Sebastian Wittenkamp  wrote:

&gt; Hi Bryan, thanks for getting back to me.
&gt; 
&gt; We are running riak as a service on CentOS.
&gt; 
&gt; We are running individual VMs with a riak node on each VM. 
&gt; 
&gt; We are running version 1.0.0 (yeah, I know...).
&gt; 
&gt; Regarding the -name parameter, it may be helpful to understand what happened 
&gt; here:
&gt; 
&gt; One of our customer cloned 3 VMs running a riak cluster. He accidentally 
&gt; booted up the three new VMs with the network interfaces hot before he had a 
&gt; chance to re-ip them. The nodes joined themselves to the existing cluster and 
&gt; things went south. He changed the -name parameter to be something distinct 
&gt; for each node it may have been done after the nodes were already joined to 
&gt; the cluster.
&gt; 
&gt; When we did a 'riak member\_status' we see output that looks like this:
&gt; 
&gt; ================================= Membership 
&gt; ==================================
&gt; Status Ring Pending Node
&gt; -------------------------------------------------------------------------------
&gt; valid 25.0% 25.0% 'riak@192.168.0.19'
&gt; valid 25.0% 25.0% 'riak@192.168.0.20'
&gt; valid 25.0% 25.0% 'riak@192.168.0.21'
&gt; valid 25.0% 25.0% 'riak@192.168.0.22'
&gt; valid 25.0% 25.0% 'riak@192.168.0.22'
&gt; valid 25.0% 25.0% 'riak@192.168.0.22'
&gt; 
&gt; I looked at the docs you sent me and I think the version we are running is 
&gt; too old to have the 'riak-admin cluster replace' command. 
&gt; 
&gt; I'm wondering - if we nuke the ring metadata on all the nodes that shouldn't 
&gt; cause any data loss, correct?
&gt; 
&gt; Thanks so much! Let me know if there is any other information I can provide.
&gt; 
&gt; From: Bryan Hunt 
&gt; Sent: Wednesday, August 20, 2014 1:08 AM
&gt; To: Sebastian Wittenkamp
&gt; Subject: Re: How to call riak\_core\_ring:remove\_member/3 from erlang shell?
&gt; 
&gt; How are you running Riak?
&gt; Are you running individual vm's, using 'make devrel', or other?
&gt; What version are you running?
&gt; Have you set the -name parameter in vm.args to a different value for each 
&gt; node in your cluster?
&gt; This page gives information about ring manipulation and should provide you 
&gt; with what you need to get back up and running:
&gt; http://docs.basho.com/riak/latest/ops/building/basic-cluster-setup/
&gt; On 19 Aug 2014 22:54, "Sebastian Wittenkamp"  wrote:
&gt; Hello all, riak shell newbie here. I have a cluster running Riak 1.0.0 which 
&gt; is showing duplicate entries in its ring\_member list. 
&gt; 
&gt; E.g. I have 'riak@192.168.10.22' listed multiple times when I do 'riak-admin 
&gt; member\_status'. If I tell the node to leave or force-remove it, only one 
&gt; entry is removed from the list.
&gt; 
&gt; From looking at the docs it appears that there's a function 
&gt; http://basho.github.io/riak\_core/riak\_core\_ring.html#remove\_member-3 which 
&gt; can be used to remove a member from the ring. I'm wondering how to call that 
&gt; from an erlang shell and also if that's the best/only option? 
&gt; 
&gt; Basically, I just want to forcibly remove the node through any means 
&gt; necessary. Please let me know if more information is needed. Thanks in 
&gt; advance.
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

