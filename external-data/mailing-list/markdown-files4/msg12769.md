---
title: "Re: Could not get response from python riak"
description: ""
project: community
lastmod: 2013-10-26T20:51:38-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12769"
mailinglist_parent_id: "msg12768"
author_name: "Naveen Tamanam"
project_section: "mailinglistitem"
sent_date: 2013-10-26T20:51:38-07:00
---


Here in my testing environment there are only 2 to 3 users so I don't
think this much traffic requires the very high ulimit.

So what would be the cause of getting error(exception) "Could not get
response" in python-riak.


On Sun, Oct 27, 2013 at 3:25 AM, Naveen Tamanam wrote:

&gt; Thanks for your valuable time.
&gt;
&gt; We may consider the ulimit under large load but here in my testing
&gt; there are only two to three uses.
&gt;
&gt; I don't think low ulimit causes the "Could not get reponse " problem.
&gt;
&gt; I would like to know what is the reason behind this error.
&gt;
&gt;
&gt;
&gt;
&gt; On Sun, Oct 27, 2013 at 1:00 AM, Sean Cribbs  wrote:
&gt;
&gt;&gt; Resending to list...
&gt;&gt;
&gt;&gt; That is also definitely possible. Ensure that ulimit -n is high enough
&gt;&gt; for Riak, and that the Riak node is still running after you start it.
&gt;&gt; `riak-admin ping` will tell you if it's still running.
&gt;&gt;
&gt;&gt;
&gt;&gt; On Sat, Oct 26, 2013 at 7:23 PM, Naveen Tamanam 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Do you suspect the ulimit it is configured to very low for my testing
&gt;&gt;&gt; environment.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Sun, Oct 27, 2013 at 12:24 AM, Sean Cribbs  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Python riak-2.0.x will work with older clusters, yes, but you might get
&gt;&gt;&gt;&gt; NotImplementedError raised when the server does not support specific
&gt;&gt;&gt;&gt; functionality.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; The retry logic in riak-1.5.x was very flakey, I don't trust it. My
&gt;&gt;&gt;&gt; guess is that something is wrong with the configuration of either the
&gt;&gt;&gt;&gt; client or the cluster. I would check the hosts/ports to be sure.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Sat, Oct 26, 2013 at 6:27 PM, Naveen Tamanam &lt;
&gt;&gt;&gt;&gt; naveen32in...@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I am using \*Python riak-1.5.2.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \*
&gt;&gt;&gt;&gt;&gt; \*Any idea about error that I have mentioned.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \*
&gt;&gt;&gt;&gt;&gt; \*Is that python riak 2.0 has backward compatibility?
&gt;&gt;&gt;&gt;&gt; \*
&gt;&gt;&gt;&gt;&gt; \*\*
&gt;&gt;&gt;&gt;&gt; \*
&gt;&gt;&gt;&gt;&gt; \*
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On Sat, Oct 26, 2013 at 10:07 PM, Sean Cribbs  wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Naveen,
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; If you are using Riak 1.4, please upgrade to the 2.0.x package of the
&gt;&gt;&gt;&gt;&gt;&gt; client. Maintenance on the 1.5.x series has ceased.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On Fri, Oct 25, 2013 at 10:29 PM, Naveen Tamanam &lt;
&gt;&gt;&gt;&gt;&gt;&gt; naveen32in...@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi All,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I am using the riak with python/django.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sometimes I am getting the error "Could not get response"
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I am using Djang\*o 1.5
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Python riak-1.5.2
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The error description is as follows;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; \*
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Django Version: 1.5
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Python Version: 2.6.6
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Installed Applications:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ('django.contrib.auth',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.contenttypes',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.sessions',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.sites',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.messages',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.staticfiles',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; )
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Installed Middleware:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ('django.middleware.common.CommonMiddleware',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.sessions.middleware.SessionMiddleware',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.auth.middleware.AuthenticationMiddleware',
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'django.contrib.messages.middleware.MessageMiddleware')
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Traceback:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File
&gt;&gt;&gt;&gt;&gt;&gt;&gt; "/usr/lib/python2.6/site-packages/Django-1.5-py2.6.egg/django/core/handlers/base.py"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; in get\_response
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 115. response = callback(request, \*callback\_args, \*\*callback\_kwargs)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File "/opt/backend/mobichat/userapp/edit\_views.py" in editCamp
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 100. campinfo = helpers.getCampinfoForTemplating(request, url=key)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File "/opt/backend/mobichat/userapp/helpers.py" in
&gt;&gt;&gt;&gt;&gt;&gt;&gt; getCampinfoForTemplating
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 213. campinfo['logo\_url'], campinfo['logo\_name'] =
&gt;&gt;&gt;&gt;&gt;&gt;&gt; CampaignLogoPath.get(url)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File "/opt/backend/mobichat/common/riak\_backend/riak\_backend.py" in
&gt;&gt;&gt;&gt;&gt;&gt;&gt; get
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1806. obj = cls.bucket.get(camp\_uid)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File
&gt;&gt;&gt;&gt;&gt;&gt;&gt; "/usr/lib/python2.6/site-packages/riak-1.5.2-py2.6.egg/riak/bucket.py" 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; in
&gt;&gt;&gt;&gt;&gt;&gt;&gt; get
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 326. return obj.reload(r=r, pr=pr)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File
&gt;&gt;&gt;&gt;&gt;&gt;&gt; "/usr/lib/python2.6/site-packages/riak-1.5.2-py2.6.egg/riak/riak\_object.py"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; in reload
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 459. Result = t.get(self, r=r, pr=pr, vtag=vtag)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File
&gt;&gt;&gt;&gt;&gt;&gt;&gt; "/usr/lib/python2.6/site-packages/riak-1.5.2-py2.6.egg/riak/transports/http.py"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; in get
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 152. response = self.http\_request('GET', url)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; File
&gt;&gt;&gt;&gt;&gt;&gt;&gt; "/usr/lib/python2.6/site-packages/riak-1.5.2-py2.6.egg/riak/transports/http.py"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; in http\_request
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 626. raise RiakError("could not get a response")
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Exception Type: RiakError at
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /manager/camp-edit/EHbo24hFYDZGsg8ujpY9itDtM2a
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Exception Value: 'could not get a response'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Any body please help me out to fix the above issue.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I see the riak source code
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Moudle is at riak-1.5.2-py2.6.egg/riak/transports/http.py
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The function where that is coming is as follows
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; def http\_request(self, method, uri, headers=None, body=''):
&gt;&gt;&gt;&gt;&gt;&gt;&gt; """
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Given a Method, URL, Headers, and Body, perform and HTTP
&gt;&gt;&gt;&gt;&gt;&gt;&gt; request,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; and return a 2-tuple containing a dictionary of response
&gt;&gt;&gt;&gt;&gt;&gt;&gt; headers
&gt;&gt;&gt;&gt;&gt;&gt;&gt; and the response body.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; """
&gt;&gt;&gt;&gt;&gt;&gt;&gt; if headers is None:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; headers = {}
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Run the request...
&gt;&gt;&gt;&gt;&gt;&gt;&gt; for retry in range(self.RETRY\_COUNT):
&gt;&gt;&gt;&gt;&gt;&gt;&gt; with self.\_conns.withconn() as conn:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ### should probably build this try/except into a
&gt;&gt;&gt;&gt;&gt;&gt;&gt; custom
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ### contextmanager for the connection.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; try:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; conn.request(method, uri, body, headers)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; response = conn.getresponse()
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; try:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Get the response headers...
&gt;&gt;&gt;&gt;&gt;&gt;&gt; response\_headers = {'http\_code':
&gt;&gt;&gt;&gt;&gt;&gt;&gt; response.status}
&gt;&gt;&gt;&gt;&gt;&gt;&gt; for (key, value) in response.getheaders():
&gt;&gt;&gt;&gt;&gt;&gt;&gt; response\_headers[key.lower()] = value
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Get the body...
&gt;&gt;&gt;&gt;&gt;&gt;&gt; response\_body = response.read()
&gt;&gt;&gt;&gt;&gt;&gt;&gt; finally:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; response.close()
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; return response\_headers, response\_body
&gt;&gt;&gt;&gt;&gt;&gt;&gt; except socket.error, e:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; conn.close()
&gt;&gt;&gt;&gt;&gt;&gt;&gt; if e[0] == errno.ECONNRESET:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Grab another connection and try again.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; continue
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Don't know how to handle this.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; raise
&gt;&gt;&gt;&gt;&gt;&gt;&gt; except httplib.HTTPException:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Just close the connection and try again.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; conn.close()
&gt;&gt;&gt;&gt;&gt;&gt;&gt; continue
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # No luck, even with retrying.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; raise RiakError("could not get a response")
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; At line number 626 in riak/transport/http.py
&gt;&gt;&gt;&gt;&gt;&gt;&gt; where http\_requst is at http.RiakHttpTransport.http\_request
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; This is error is coming very often. For what reason it is coming
&gt;&gt;&gt;&gt;&gt;&gt;&gt; and how to get permanent solution for this error .
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks & Regards,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Naveen Tamanam
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt;&gt;&gt;&gt; Software Engineer
&gt;&gt;&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt; Thanks & Regards,
&gt;&gt;&gt;&gt;&gt; Naveen Tamanam
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt;&gt; Software Engineer
&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Thanks & Regards,
&gt;&gt;&gt; Naveen Tamanam
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sean Cribbs 
&gt;&gt; Software Engineer
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Thanks & Regards,
&gt; Naveen Tamanam
&gt;



-- 
Thanks & Regards,
Naveen Tamanam
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

