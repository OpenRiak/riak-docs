---
title: "Re: Ruby Riak client -- threadsafe?"
description: ""
project: community
lastmod: 2012-11-13T07:37:15-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09299"
mailinglist_parent_id: "msg09294"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-11-13T07:37:15-08:00
---


Scott,

It is generally safe to use the Ruby client from multiple threads. A
few items that are infrequently touched (memoized buckets and their
properties) are not, but normal requests are all handled by a
thread-safe connection pool. Ripple historically kept a client in the
thread-locals in order to have a sort of globally-referrable Client
instance; similar to how ActiveRecord's connections work, but not as
sophisticated. This could be improved in the future, perhaps
instantiating it in the Railtie instead to be used by all threads.

On Mon, Nov 12, 2012 at 5:01 PM, Scott Hyndman  wrote:
&gt; Hi there,
&gt;
&gt; I noticed this post from a bit over a year ago
&gt; (http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2011-June/004592.html),
&gt; and wondered whether this was still the case. I've noticed one detail
&gt; suggesting that it may be (the fact that Ripple creates a client per
&gt; thread), and one that contradicts (the existence of HTTP and PB connection
&gt; pools on the client).
&gt;
&gt; Can anyone shed some insight?
&gt;
&gt; Scott
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;



-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

