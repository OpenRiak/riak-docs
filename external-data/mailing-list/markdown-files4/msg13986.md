---
title: "Re: very slow write speed to riak-cs"
description: ""
project: community
lastmod: 2014-04-03T07:53:43-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13986"
mailinglist_parent_id: "msg13985"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2014-04-03T07:53:43-07:00
---


Anton,

You'd be connecting clients to Riak CS directly for the purposes of
testing. We believe that your load balancer is terminating connections
prematurely, so removing it from your environment is the best way to
determine if it is causing this issue.

I am suggesting to lower pb\_backlog - 256 should be sufficient. On further
investigation this error is not caused by your default pb\_backlog setting
(which is 5), but a higher value is generally necessary in Riak CS
installations.

--
Luke Bakken
CSE
lbak...@basho.com


On Thu, Apr 3, 2014 at 7:32 AM, Anton Khalikov  wrote:

&gt; Hi Luke
&gt;
&gt; Is it safe to allow clients to connect directly to Riak CS as your
&gt; suggestion is kinda against official docs (
&gt; http://docs.basho.com/riakcs/latest/cookbooks/configuration/Load-Balancing-and-Proxy-Configuration/
&gt; )?
&gt;
&gt; I also think our problem might be caused by ring\_creation\_size 256 while
&gt; we have only 8 nodes up currently (the cluster is planned to grow twice in
&gt; the future). Yes I am Stanislav's colleague :)
&gt;
&gt; pb\_backlog is set to 512 at the moment. Are you suggesting to lower it?
&gt;
&gt; Luke Bakken 
&gt; 3 Apr 2014 20:18
&gt; Hi Stanislav,
&gt;
&gt; Could you configure your clients to connect directly to Riak CS instead of
&gt; through your proxy? A colleague of mine suggested that the {error,closed}and 
&gt; 104 error code in s3cmd appear to be caused by the connection between
&gt; the client and Riak CS being closed or terminated unexpectedly.
&gt;
&gt; I would still recommend keeping {pb\_backlog, 256} as that will allow for
&gt; more simultaneous connections to be handled going forward.
&gt;
&gt; --
&gt; Luke Bakken
&gt; CSE
&gt; lbak...@basho.com
&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt; --
&gt; Best regards
&gt; Anton Khalikov
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&lt;&gt;\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

