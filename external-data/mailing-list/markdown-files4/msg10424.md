---
title: "Re: Error interpretation"
description: ""
project: community
lastmod: 2013-03-13T18:38:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10424"
mailinglist_parent_id: "msg10419"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2013-03-13T18:38:45-07:00
---


---
Jeremiah Peschka - Founder, Brent Ozar Unlimited
MCITP: SQL Server 2008, MVP
Cloudera Certified Developer for Apache Hadoop


On Wed, Mar 13, 2013 at 6:27 PM, Kevin Burton wrote:

&gt; So the only change you made was to enable search for the bucket. And since
&gt; I am not using search (just trying to store the object) you could remove
&gt; that also. Why did you feel that it was needed?
&gt;

Because your initial error message was {precommit\_fail,{hook\_crashed,{\*
riak\_search\_kv\_hook\*,precommit,error,badarg}}}


&gt; \*\*\*\*
&gt;
&gt; \*\* \*\*
&gt;
&gt; This brings us back to the original question though. What does the error
&gt; tell me about the configuration? The test that everything works on the
&gt; Basho site is to save a binary image to the cluster and retrieve it. If
&gt; this is successful then the cluster seems healthy. I did this and there was
&gt; no errors. It seems that I get this error only when I try JSON data which
&gt; is the data I want to store. So what could be specifically wrong about my
&gt; configuration data that allows binary image data but throws an error when
&gt; saving JSON data?
&gt;
If you're saving to a different bucket, which your curl commands indicate,
my guess is that the cluster is healthy something is busted within your
bucket configuration for the buyseasons-orders bucket. Once you perform a
rolling update to 1.3 (or create a new cluster) you can reset the bucket
properties[1]. Or, if you want to be lazy, you could try saving to a random
bucket like "buyseasons-orders-asdf1234" or "CC5DF49B-D8D3-4B2D-ABBD-1
B63A4F10FFF".

Either way, my suspicion remains that there is something nasty going on
with your bucket properties that's causing you some grief on this bucket.
Could you take a look at the bucket properties [2] and post them on list or
in a gist?

[1]:
http://docs.basho.com/riak/latest/references/apis/http/HTTP-Reset-Bucket-Properties/

[2]:
http://docs.basho.com/riak/latest/references/apis/http/HTTP-Get-Bucket-Properties/

&gt; \*\*\*\*
&gt;
&gt; \*\* \*\*
&gt;
&gt; \*From:\* Jeremiah Peschka [mailto:jeremiah.pesc...@gmail.com]
&gt; \*Sent:\* Wednesday, March 13, 2013 8:10 PM
&gt;
&gt; \*To:\* Kevin Burton
&gt; \*Cc:\* riak-users
&gt; \*Subject:\* Re: Error interpretation\*\*\*\*
&gt;
&gt; \*\* \*\*
&gt;
&gt; Try now, this appears to fall into the "Jeremiah can't work anything that
&gt; requires security" category.\*\*\*\*
&gt;
&gt;
&gt; \*\*\*\*
&gt;
&gt; ---\*\*\*\*
&gt;
&gt; Jeremiah Peschka - Founder, Brent Ozar Unlimited\*\*\*\*
&gt;
&gt; MCITP: SQL Server 2008, MVP\*\*\*\*
&gt;
&gt; Cloudera Certified Developer for Apache Hadoop\*\*\*\*
&gt;
&gt; \*\* \*\*
&gt;
&gt; On Wed, Mar 13, 2013 at 6:06 PM, Kevin Burton 
&gt; wrote:\*\*\*\*
&gt;
&gt; Thank you. I was not trying to search I was just trying to store the value.
&gt; \*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; When I try to open the file I get\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; The website declined to show this webpage\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; So I am not sure what changes you made.\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*From:\* Jeremiah Peschka [mailto:jeremiah.pesc...@gmail.com]
&gt; \*Sent:\* Wednesday, March 13, 2013 7:41 PM
&gt; \*To:\* Kevin Burton
&gt; \*Cc:\* riak-users
&gt; \*Subject:\* Re: Error interpretation\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; I ran the sample code you sent over on my local machine and it ran without
&gt; error. I did have to enable riak search on an individual bucket by setting
&gt; bucket properties, but you can see the changes I made here:
&gt; http://clientresources.brentozar.com.s3.amazonaws.com/CITest.zip\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; You may not get the search results that you want from your JSON document
&gt; because it doesn't conform to the default Riak Search schema -
&gt; http://docs.basho.com/riak/latest/cookbooks/Riak-Search---Schema/#The-Default-Schema
&gt; \*\*\*\*
&gt;
&gt;
&gt; \*\*\*\*
&gt;
&gt; ---\*\*\*\*
&gt;
&gt; Jeremiah Peschka - Founder, Brent Ozar Unlimited\*\*\*\*
&gt;
&gt; MCITP: SQL Server 2008, MVP\*\*\*\*
&gt;
&gt; Cloudera Certified Developer for Apache Hadoop\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; On Wed, Mar 13, 2013 at 5:32 PM, Kevin Burton 
&gt; wrote:\*\*\*\*
&gt;
&gt; Instead of using a binary file I tried a file that contains serialized
&gt; JSON data. I am getting pretty much the same error:\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; 500 Internal Server
&gt; ErrorInternal Se\*\*\*\*
&gt;
&gt; rver Error
==================================

The server encountered an error while processing this
&gt; request:
&gt; &gt;
```
{error,****
&gt;
&gt;     {error,badarg,****
&gt;
&gt;         [{erlang,iolist_to_binary,****
&gt;
&gt;              [{hook_crashed,{riak_search_kv_hook,precommit,error,badarg}}],
&gt; ****
&gt;
&gt;              []},****
&gt;
&gt;          {wrq,append_to_response_body,2,[{file,"src/wrq.erl"},{line,205}]},
&gt; ****
&gt;
&gt;          {riak_kv_wm_object,handle_common_error,3,****
&gt;
&gt;              [{file,"src/riak_kv_wm_object.erl"},{line,998}]},****
&gt;
&gt;          {webmachine_resource,resource_call,3,****
&gt;
&gt;              [{file,"src/webmachine_resource.erl"},{line,183}]},****
&gt;
&gt;          {webmachine_resource,do,3,****
&gt;
&gt;              [{file,"src/webmachine_resource.erl"},{line,141}]},****
&gt;
&gt;          {webmachine_decision_core,resource_call,1,****
&gt;
&gt;              [{file,"src/webmachine_decision_core.erl"},{line,48}]},****
&gt;
&gt;          {webmachine_decision_core,accept_helper,0,****
&gt;
&gt;              [{file,"src/webmachine_decision_core.erl"},{line,606}]},****
&gt;
&gt;          {webmachine_decision_core,decision,1,****
&gt;
&gt;
&gt; [{file,"src/webmachine_decision_core.erl"},{line,577}]}]}}
```
\*\*\*\*
&gt;
&gt; 

---

mochiweb+webmachine web server

\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; From\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; curl -XPUT http://devUBuntu01:8098/riak/buyseasons-orders/1 -H
&gt; "Content-type:application/json" --data-binary @test.json\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; So given this error any suggestions as to the meaning?\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; I can put the JSON file on dropbox or someother media if it is needed. \*\*\*
&gt; \*
&gt;
&gt; \*\*\*\*
&gt;
&gt; Thank you.\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*From:\* Kevin Burton [mailto:rkevinbur...@charter.net]
&gt; \*Sent:\* Wednesday, March 13, 2013 9:28 AM
&gt; \*To:\* 'Jeremiah Peschka'; 'riak-users'
&gt; \*Subject:\* RE: Error interpretation\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; So the question remains in my mind why\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; curl -XPUT http://devUbuntu01:8098/riak/images/1.jpg -H "Content-type:
&gt; image/jpeg" --data-binary @test.jpg\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; and the corresponding read\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; curl -v http://devUbuntu01:8098/riak/images/1.jpg &gt;test-read.jpg\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; work without error but the CI call to put fails? How are these different?\*
&gt; \*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*From:\* riak-users 
&gt; [mailto:riak-users-boun...@lists.basho.com]
&gt; \*On Behalf Of \*Jeremiah Peschka
&gt; \*Sent:\* Tuesday, March 12, 2013 8:35 PM\*\*\*\*
&gt;
&gt;
&gt; \*To:\* riak-users
&gt; \*Subject:\* Re: Error interpretation\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; Default leveldb config is (when built using `make devrel`): \*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; %% eLevelDB Config\*\*\*\*
&gt;
&gt; {eleveldb, [\*\*\*\*
&gt;
&gt; {data\_root, "./data/leveldb"}\*\*\*\*
&gt;
&gt; ]},\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; Drop everything but the data\_root. Also: simplify your set up. You're
&gt; running into timeout errors in a networked environment. Test your
&gt; functionality on a local cluster (either 1 node or a devrel setup with 4
&gt; nodes). Validate your logic and functionality there.\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; I wish I could promise that I can help out at all, but I just got back
&gt; from 12 days out of the country and I'm booked solid for the next two
&gt; weeks. In short - my responses will be hit or miss at best.\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; Good luck and godspeed.\*\*\*\*
&gt;
&gt;
&gt; \*\*\*\*
&gt;
&gt; ---\*\*\*\*
&gt;
&gt; Jeremiah Peschka - Founder, Brent Ozar Unlimited\*\*\*\*
&gt;
&gt; MCITP: SQL Server 2008, MVP\*\*\*\*
&gt;
&gt; Cloudera Certified Developer for Apache Hadoop\*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*\*\*\*
&gt;
&gt; \*\* \*\*
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

