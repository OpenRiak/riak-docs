---
title: "Re: setting n_val"
description: ""
project: community
lastmod: 2013-06-10T09:25:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11241"
mailinglist_parent_id: "msg11240"
author_name: "John Daily"
project_section: "mailinglistitem"
sent_date: 2013-06-10T09:25:22-07:00
---


Two important points:

First, n\_val determines how many partitions (or virtual nodes) the data will be 
distributed to. The ring size determines how many partitions exist, and should 
be a much larger number than the number of servers your cluster will run on.

Riak's default ring size is 64, so defining an n\_val of 3 should be perfectly 
fine for your cluster.

Having said that, Riak is not designed to run on one server, and you will find 
performance to be very poor. It can be tuned for one server, but its purpose in 
life is to run a distributed, highly available database, which doesn't map well 
to a single server. Running a ring size of 64 on one server is like having 64 
different databases fighting for your disk I/O.

We recommend no fewer than 5 servers in a production cluster.

-John

On Jun 10, 2013, at 12:01 PM, Alexander Ilyin  wrote:

&gt; Hi all,
&gt; 
&gt; I have a question regarding setting the n\_val.
&gt; In the documentation 
&gt; (http://docs.basho.com/riak/latest/tutorials/fast-track/Tunable-CAP-Controls-in-Riak/)
&gt; it is stated that:
&gt; 
&gt; n\_val must be greater than 0 and less than or equal to the number of actual 
&gt; nodes in your cluster to get all the benefits of replication. 
&gt; And, we advise against modifying the n\_val of a bucket after its initial 
&gt; creation as this may result in failed reads because the new 
&gt; value may not be replicated to all the appropriate partitions.
&gt; 
&gt; But this seems contradictory to me. Which value I have to set if I'm setting 
&gt; up one node right now but planning to add second one later?
&gt; Setting n\_val=2 means this value will be greater than actual number of nodes. 
&gt; But setting n\_val=1 is also not advisable since
&gt; I will have to change it later to n\_val=2 (I'm planning to have two replicas 
&gt; in the end).
&gt; 
&gt; I'm also concerned about the performance in case of one node and n\_val=2. 
&gt; Will it degrade since both replicas are stored on the same server?
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

