---
title: "Re: HTTP API DOC ?"
description: ""
project: community
lastmod: 2010-07-07T01:45:53-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00684"
mailinglist_parent_id: "msg00664"
author_name: "Ted Karmel"
project_section: "mailinglistitem"
sent_date: 2010-07-07T01:45:53-07:00
---


Hi Dan,

Thanks for your reply. The backward slash worked and was exactly what
was needed.

I really appreciate your always helpful suggestions, both here and on
the webmachine mailing list.

Once again thanks,

Ted

On Tue, Jun 29, 2010 at 8:48 PM, Dan Reverri  wrote:
&gt; Hi Ted,
&gt; The ibrowse application is expecting the body of the request to be a string,
&gt; binary or function.
&gt; http://wiki.github.com/cmullaparthi/ibrowse/ibrowse-api#type-body
&gt; In your code sample you are passing a list which contains a tuple which
&gt; contains an atom. In Erlang single quotes signify an atom,
&gt; so '{"vvfe":"fegtg"}' is an atom. You should instead pass a string:
&gt; ibrowse:send\_req("http://127.0.0.1:8098/riak/test/doc?returnbody=true",[{"Content-Type",
&gt; "application/json"}], put, "{\"vvfe\":\"fegtg\"").
&gt; Let me know if that works for you.
&gt; Thanks,
&gt; Dan
&gt; Daniel Reverri
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; d...@basho.com
&gt;
&gt;
&gt; On Tue, Jun 29, 2010 at 1:38 PM, Ted Karmel  wrote:
&gt;&gt;
&gt;&gt; Hi Dan,
&gt;&gt;
&gt;&gt; Thanks for your reply.
&gt;&gt;
&gt;&gt; The REST API link was exactly what I was looking for.
&gt;&gt;
&gt;&gt; By converting the command to HTTP headers, what I meant was seeing all
&gt;&gt; of the request and response headers.  I realize now that  the v
&gt;&gt; parameter does the trick in curl.
&gt;&gt;
&gt;&gt; The curl requests were all successful.  It was the http client request
&gt;&gt; from within erlang that was the problem.  And hence the desire to look
&gt;&gt; at the http headers more closely (as I perhaps misunderstood how to
&gt;&gt; formulate them).
&gt;&gt;
&gt;&gt; Alas, the http client requests still do not work.  I use ibrowse.  I
&gt;&gt; try the following in ibrowse for the put request:
&gt;&gt;
&gt;&gt; 4&gt; ibrowse:send\_req("http://127.0.0.1:8091/riak/test/doc?returnbody=true",
&gt;&gt; [{"Content-Type", "application/json"}], put, [{'{"vvfe":"fegtg"}'}]).
&gt;&gt;
&gt;&gt;
&gt;&gt; And I get the following error:
&gt;&gt;
&gt;&gt; {error,{'EXIT',{badarg,[{erlang,list\_to\_binary,
&gt;&gt;                                 [[{'{"vvfe":"fegtg"}'}]]},
&gt;&gt;                         {ibrowse,ensure\_bin,1},
&gt;&gt;                         {ibrowse,do\_send\_req,7},
&gt;&gt;                         {erl\_eval,do\_apply,5},
&gt;&gt;                         {shell,exprs,7},
&gt;&gt;                         {shell,eval\_exprs,7},
&gt;&gt;                         {shell,eval\_loop,3}]}}}
&gt;&gt;
&gt;&gt; Any suggestions?
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On Tue, Jun 22, 2010 at 10:02 PM, Dan Reverri  wrote:
&gt;&gt; &gt; Hi Ted,
&gt;&gt; &gt; A few observations about your original message:
&gt;&gt; &gt; The curl command you provided looks correct, however, there are new line
&gt;&gt; &gt; characters after each header (Content-Type, Riak-X-Vclock). I am not
&gt;&gt; &gt; sure
&gt;&gt; &gt; whether or not those were added by the email client. The presence of new
&gt;&gt; &gt; line characters in the headers would cause the request to fail. The
&gt;&gt; &gt; request
&gt;&gt; &gt; should work without the new line characters:
&gt;&gt; &gt; curl -v -X PUT -d '{"bar":"baz"}' -H "Content-Type: application/json" -H
&gt;&gt; &gt; "X-Riak-Vclock:a85hYGBgzGDKBVIszMk55zKYEhnzWBlKIniO8mUBAA=="
&gt;&gt; &gt; http://127.0.0.1:8091/riak/test/doc?returnbody=true
&gt;&gt; &gt;
&gt;&gt; &gt; I am not sure what you mean by converting the command to HTTP headers.
&gt;&gt; &gt; The
&gt;&gt; &gt; raw request looks as follows:
&gt;&gt; &gt; PUT /riak/test/doc?returnbody=true HTTP/1.1
&gt;&gt; &gt; Content-Type: application/json
&gt;&gt; &gt; X-Riak-Vclock: a85hYGBgzGDKBVIszMk55zKYEhnzWBlKIniO8mUBAA==
&gt;&gt; &gt; {"bar":"baz"}
&gt;&gt; &gt;
&gt;&gt; &gt; Regarding your last attempt, option "c", it's important to note that URL
&gt;&gt; &gt; parameters are not included in the body of the request when processed by
&gt;&gt; &gt; Riak. Riak will store the data included in the body of the request and
&gt;&gt; &gt; ignore unrecognized URL parameters.
&gt;&gt; &gt; Thanks,
&gt;&gt; &gt; Dan
&gt;&gt; &gt; Daniel Reverri
&gt;&gt; &gt; Developer Advocate
&gt;&gt; &gt; Basho Technologies, Inc.
&gt;&gt; &gt; d...@basho.com
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; On Tue, Jun 22, 2010 at 2:27 PM, Dan Reverri  wrote:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Hi Ted,
&gt;&gt; &gt;&gt; Documentation for the REST API can be found here:
&gt;&gt; &gt;&gt; https://wiki.basho.com/display/RIAK/REST+API
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Regarding the failed requests, can you show us the various requests you
&gt;&gt; &gt;&gt; are making via curl along with the responses?
&gt;&gt; &gt;&gt; Thanks,
&gt;&gt; &gt;&gt; Dan
&gt;&gt; &gt;&gt; Daniel Reverri
&gt;&gt; &gt;&gt; Developer Advocate
&gt;&gt; &gt;&gt; Basho Technologies, Inc.
&gt;&gt; &gt;&gt; d...@basho.com
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; On Tue, Jun 22, 2010 at 1:24 PM, Ted Karmel 
&gt;&gt; &gt;&gt; wrote:
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Does Riak have an HTTP API doc ( similar to the CouchDB one found
&gt;&gt; &gt;&gt;&gt; here:  http://wiki.apache.org/couchdb/HTTP\_Document\_API )?
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; The closest thing I can find is the Riak Fast Track (
&gt;&gt; &gt;&gt;&gt; https://wiki.basho.com/display/RIAK/The+Riak+Fast+Track ).  But that
&gt;&gt; &gt;&gt;&gt; is in curl only rather than explicit HTTP headers.
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; In particular, I have a problem with the PUT request  in the following
&gt;&gt; &gt;&gt;&gt; curl command
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; $ curl -v -X PUT -d '{"bar":"baz"}' -H "Content-Type:
&gt;&gt; &gt;&gt;&gt; application/json" -H "X-Riak-Vclock:
&gt;&gt; &gt;&gt;&gt; a85hYGBgzGDKBVIszMk55zKYEhnzWBlKIniO8mUBAA=="
&gt;&gt; &gt;&gt;&gt; http://127.0.0.1:8091/riak/test/doc?returnbody=true
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; I try to convert the command into HTTP headers but the request fails
&gt;&gt; &gt;&gt;&gt; when the followin is attempted :
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; a)  include {"bar":"baz"} in the body and set the Content-Type header
&gt;&gt; &gt;&gt;&gt; to application/json
&gt;&gt; &gt;&gt;&gt; b)  same as a) but add another Content-Type header value - this time
&gt;&gt; &gt;&gt;&gt; of application/x-www-form-urlencoded   ( inspired by the info on the
&gt;&gt; &gt;&gt;&gt; -d command found in the following curl manual
&gt;&gt; &gt;&gt;&gt; http://curl.haxx.se/docs/manpage.html )
&gt;&gt; &gt;&gt;&gt; c)  same as b) but instead of placing {"bar":"baz"} in the body, add
&gt;&gt; &gt;&gt;&gt; ampersand in the url and bar=baz
&gt;&gt; &gt;&gt;&gt; http://127.0.0.1:8091/riak/test/doc?returnbody=true&bar=baz
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; I tried looking for an equivalent to the Live HTTP Headers extension
&gt;&gt; &gt;&gt;&gt; on Firefox but which would capture activity from curl commands.  Then,
&gt;&gt; &gt;&gt;&gt; I could get a better idea of how to formulate the HTTP headers.
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Please Help...
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; if there is an HTTP API doc with explicity header request info
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; how to formulate this particular PUT request with the HTTP headers
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; good ubuntu linux utility for capturing http activity even if not from
&gt;&gt; &gt;&gt;&gt; browser application
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; &gt;&gt;&gt; riak-users mailing list
&gt;&gt; &gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt; &gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

