---
title: "Re: Designing Your Buckets"
description: ""
project: community
lastmod: 2010-10-15T14:02:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01310"
mailinglist_parent_id: "msg01307"
author_name: "Cagdas Tulek"
project_section: "mailinglistitem"
sent_date: 2010-10-15T14:02:08-07:00
---


Thanks for the replies, I'll read the blogs.

On Fri, Oct 15, 2010 at 6:31 AM, Alexander Sicular wrote:

&gt; Another thing to keep in mind is that an individual document has higher
&gt; overhead than a row in a table. If you think about all the metadata that
&gt; accompanies a document in riak you will notice that the ratio of overhead to
&gt; value is higher the smaller your value is, like say two character state
&gt; codes or 5 character zip codes.
&gt;
&gt; -Alexander
&gt;
&gt; @siculars on twitter
&gt; http://siculars.posterous.com
&gt;
&gt; Sent from my iPhone
&gt;
&gt; On Oct 15, 2010, at 9:20, Jeremiah Peschka 
&gt; wrote:
&gt;
&gt; And here are the posts in question, which I clearly need to re-read (thanks
&gt; for the gentle reminder, Alexander
&gt;
&gt; 
&gt; http://blog.basho.com/2010/03/19/schema-design-in-riak---introduction/
&gt; 
&gt; http://blog.basho.com/2010/03/25/schema-design-in-riak---relationships/
&gt; 
&gt; http://blog.basho.com/2010/07/09/webinar-recap---schema-design-for-riak/
&gt;
&gt; And this video covers a tiny bit of schema design: 
&gt; http://vimeo.com/14275191
&gt;
&gt; I know what I'm doing with my afternoon.
&gt;
&gt; Jeremiah Peschka
&gt; Microsoft SQL Server MVP
&gt; MCITP: Database Developer, DBA
&gt; 614.515.0727
&gt;
&gt;
&gt; On Fri, Oct 15, 2010 at 8:58 AM, Alexander Sicular &lt; 
&gt; sicul...@gmail.com&gt; wrote:
&gt;
&gt;&gt; State &gt; zip &gt; person with links in between seems very normalized to
&gt;&gt; me. Ya, you can do it, but I wouldn't. You in flat space now.
&gt;&gt; Denormalize ftw.
&gt;&gt;
&gt;&gt; Sean Cribbs had a blog post on m/r'ing over some people and I have a
&gt;&gt; post on using m/r to sort by date. Google will find em.
&gt;&gt;
&gt;&gt; -Alexander
&gt;&gt;
&gt;&gt; On 2010-10-15, Jeremiah Peschka &lt; 
&gt;&gt; jeremiah.pesc...@gmail.com&gt; wrote:
&gt;&gt; &gt; Based on my experience, you're on the right track.
&gt;&gt; &gt;
&gt;&gt; &gt; In addition to your main 'entity' buckets, you'll want to create index
&gt;&gt; &gt; buckets that you use to speed lookups and create links back to the
&gt;&gt; entity
&gt;&gt; &gt; buckets.
&gt;&gt; &gt;
&gt;&gt; &gt; e.g. If you have a People bucket that is a nested record for a person
&gt;&gt; with a
&gt;&gt; &gt; mailing address, you might want to create some kind of States bucket
&gt;&gt; with
&gt;&gt; &gt; links to a ZipCodes bucket with further links to the People bucket. This
&gt;&gt; way
&gt;&gt; &gt; you can do link traversal from a state -&gt; zip code -&gt; person.
&gt;&gt; &gt;
&gt;&gt; &gt; To perform aggregations, you can use MapReduce. Using buckets and link
&gt;&gt; &gt; walking can make it very easy to perform operations that closely mimic
&gt;&gt; index
&gt;&gt; &gt; seeks.
&gt;&gt; &gt;
&gt;&gt; &gt; Someone correct me if I've gone completely off the deep end on this one
&gt;&gt; :)
&gt;&gt; &gt;
&gt;&gt; &gt; Jeremiah Peschka
&gt;&gt; &gt; Microsoft SQL Server MVP
&gt;&gt; &gt; MCITP: Database Developer, DBA
&gt;&gt; &gt; 614.515.0727
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; On Fri, Oct 15, 2010 at 1:49 AM, Cagdas Tulek &lt; 
&gt;&gt; ctu...@gmail.com&gt; wrote:
&gt;&gt; &gt;
&gt;&gt; &gt;&gt; Hi,
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I'm a newbie to Riak (and riak like databases) and unfortunately I am a
&gt;&gt; &gt;&gt; long time RDB user. So, my mind is very biased but I try to think
&gt;&gt; &gt;&gt; differently and this will take some time.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; What I understand is that you try to avoid range queries and
&gt;&gt; map/reduce
&gt;&gt; &gt;&gt; operations for live traffic. This part, I guess I understand better.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; However, one thing that I don't understand is the needs on admin side.
&gt;&gt; &gt;&gt; Although on frontend you can play smart to limit the objects that a
&gt;&gt; user
&gt;&gt; &gt;&gt; should interact, on the admin side you usually want to list all records
&gt;&gt; &gt;&gt; and
&gt;&gt; &gt;&gt; usually you want them to be sorted by id or creation time. These are
&gt;&gt; also
&gt;&gt; &gt;&gt; true for your stats etc.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; How do you design your buckets in Riak to solve this problem? Or do you
&gt;&gt; &gt;&gt; use
&gt;&gt; &gt;&gt; different approaches on admin side.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; One (maybe dirty) solution with my RDB biased mind is to have auxiliary
&gt;&gt; &gt;&gt; buckets to list items:
&gt;&gt; &gt;&gt; books/book1..n
&gt;&gt; &gt;&gt; lists/list1..n
&gt;&gt; &gt;&gt; where list-i is an array of x keys (where x is a small number like 10,
&gt;&gt; &gt;&gt; 20).
&gt;&gt; &gt;&gt; This way we can have features like pagination. Same thing maybe for
&gt;&gt; days:
&gt;&gt; &gt;&gt; days/20101014
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I try to find slides/documents about these topics but usually the
&gt;&gt; &gt;&gt; information I find is about dealing with individual items and their
&gt;&gt; &gt;&gt; relations, not a list of these items.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I would appreciate any resources addressing these problems.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Best,
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Cagdas
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; &gt;&gt; riak-users mailing list
&gt;&gt; &gt;&gt; riak-users@lists.basho.com
&gt;&gt; &gt;&gt; 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sent from my mobile device
&gt;&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

