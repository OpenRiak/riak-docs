---
title: "Re: High Memory Utilization"
description: ""
project: community
lastmod: 2012-07-31T07:20:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08130"
mailinglist_parent_id: "msg08124"
author_name: "Reid Draper"
project_section: "mailinglistitem"
sent_date: 2012-07-31T07:20:54-07:00
---


It sounds like the cache\_size hasn't changed at all, if you just
explicitly set it to the default. I would try lowering it to something
like 1, 2 or 4MB.

Reid


On Jul 30, 2012, at 11:03 AM, Antonio Ye wrote:

&gt; So I set cache\_size to 8388608 or 8 MB which according to the
&gt; documentation is the default but Riak still uses 4.1 GB of RAM. I
&gt; loaded 20 million records this time instead of the original 10
&gt; million. Does anyone know if replicas are also cached in elevelDB?
&gt; 
&gt; 
&gt; On Mon, Jul 30, 2012 at 7:49 AM, Reid Draper  wrote:
&gt;&gt; I'd recommend lowering some of the leveldb configuration
&gt;&gt; defaults [1]. I'd start with the cache size. You'll notice that
&gt;&gt; most of these settings are \_per\_ \_vnode\_, which means
&gt;&gt; for your single-node cluster with 64 partitions (vnodes),
&gt;&gt; the defaults are likely a bit high for 10MM values.
&gt;&gt; 
&gt;&gt; It's also worth mentioning that Riak is not intended to be run
&gt;&gt; on a single node.
&gt;&gt; 
&gt;&gt; Reid
&gt;&gt; 
&gt;&gt; On Jul 29, 2012, at 2:01 PM, Antonio Ye wrote:
&gt;&gt; 
&gt;&gt;&gt; this is on a single node and my ring\_creation\_size is 64.
&gt;&gt;&gt; 
&gt;&gt;&gt; ring\_num\_partitions : 64
&gt;&gt;&gt; ring\_ownership : &lt;&lt;"[{'riak@127.0.0.1',64}]"&gt;&gt;
&gt;&gt;&gt; ring\_creation\_size : 64
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Tony
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; On Sun, Jul 29, 2012 at 9:12 AM, Reid Draper  wrote:
&gt;&gt;&gt;&gt; Hi Antonio,
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; How many nodes do you have in your cluster? What is
&gt;&gt;&gt;&gt; the ring size ({ring\_creation\_size, N} in app.config)?
&gt;&gt;&gt;&gt; Are you seeing 3.6GB of memory used \_per\_ machine,
&gt;&gt;&gt;&gt; or total across the cluster?
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Reid
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On Jul 29, 2012, at 2:37 AM, Antonio Ye wrote:
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; I am using Riak as the persistence data store for a distributed data
&gt;&gt;&gt;&gt;&gt; grid so I really do not care to use Riak's or in my case eLevelDb's
&gt;&gt;&gt;&gt;&gt; cache. The problem I have is that when I load 10 million keys into
&gt;&gt;&gt;&gt;&gt; Riak it is taking 3.6g of memory. I have not set any of the eLevelDb
&gt;&gt;&gt;&gt;&gt; backend configuration parameters therefore I expect Riak to use the
&gt;&gt;&gt;&gt;&gt; defaults specified in the documentation. My bucket name is 7
&gt;&gt;&gt;&gt;&gt; characters and my keys are 7 characters. Any ideas on how to make
&gt;&gt;&gt;&gt;&gt; Riak/eLevelDb use as little memory as possible?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt; 
&gt;&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

