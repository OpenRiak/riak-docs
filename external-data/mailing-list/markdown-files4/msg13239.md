---
title: "Re: Mapreduce zero out counters"
description: ""
project: community
lastmod: 2013-12-13T15:27:45-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13239"
mailinglist_parent_id: "msg13238"
author_name: "Sam Elliott"
project_section: "mailinglistitem"
sent_date: 2013-12-13T15:27:45-08:00
---


Bryce, 

You have two options.

The first is just to delete the keys. As long as they are deleted at every 
replica and there are no concurrent increments, then no counters will make a 
return and change what you're counting. Counters are initialised to zero. 

The other option is to decrement/increment the counter back to zero. Here's 
some code that should do so (using the 1.4 counters API) [1]. Please test it 
out before running it in production. This of course keeps updates around, and 
will also be affected by concurrent updates (the zeroing will decrement by 
however much it observes the counter to be). The code provided won't work with 
2.0, but i can talk you through re-writing it.

Sam

[1] https://gist.github.com/lenary/334978ac1df0c21c4cc2 

-- 
Sam Elliott
Engineer
sam.elli...@basho.com
--


On Friday, 13 December 2013 at 4:45PM, Bryce Verdier wrote:

&gt; Hey all,
&gt; 
&gt; Is there a way to use the mapreduce (with erlang code), to zero out all 
&gt; the counters within a bucket?
&gt; Thanks in advance,
&gt; 
&gt; Bryce
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com




\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

