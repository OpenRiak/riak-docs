---
title: "Re: bitcask 42?"
description: ""
project: community
lastmod: 2010-10-01T09:24:24-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01175"
mailinglist_parent_id: "msg01168"
author_name: "Dan Reverri"
project_section: "mailinglistitem"
sent_date: 2010-10-01T09:24:24-07:00
---


Hi Mojito,

At the moment, changing the ring\_creation\_size parameter is not an easy
process. It's important to choose a number that is large enough that you
will not need to change it for a really long time. Projects will typically
define an upper bound for a cluster's size based on available datacenter
space, available power, cost, etc. Choosing a ring\_creation\_size value based
on this upper bound will allow you to start small and grow into your
cluster.

Changing the ring\_creation\_size, right now, requires building a new cluster
with the new ring\_creation\_size value and migrating data from the old
cluster (backup and restore).

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Thu, Sep 30, 2010 at 5:01 PM, Mojito Sorbet  wrote:

&gt; What if your DB continues to grow beyond the original design size and
&gt; you need to add a lot more nodes?
&gt;
&gt; On Thu, 2010-09-30 at 16:34 -0700, Dan Reverri wrote:
&gt; &gt; Yes, that is true.
&gt; &gt;
&gt; &gt; Daniel Reverri
&gt; &gt; Developer Advocate
&gt; &gt; Basho Technologies, Inc.
&gt; &gt; d...@basho.com
&gt; &gt;
&gt; &gt;
&gt; &gt; On Thu, Sep 30, 2010 at 4:27 PM, Alexander Sicular
&gt; &gt;  wrote:
&gt; &gt; Dan,
&gt; &gt; Is it true that "ring\_creation\_size" should only be altered at
&gt; &gt; the creation of a cluster? Once you already have physical
&gt; &gt; nodes in a cluster you shouldn't adjust the
&gt; &gt; "ring\_creation\_size". True?
&gt; &gt;
&gt; &gt;
&gt; &gt; Thanks, Alexander.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; @siculars on twitter
&gt; &gt; http://siculars.posterous.com
&gt; &gt;
&gt; &gt;
&gt; &gt; Sent from my iPhone
&gt; &gt;
&gt; &gt;
&gt; &gt; On Sep 30, 2010, at 19:16, Dan Reverri  wrote:
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; &gt; Hi Michael,
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; There is no hard coded limit to the number of nodes that can
&gt; &gt; &gt; belong to a cluster. Depending on how quickly you are adding
&gt; &gt; &gt; nodes to the cluster you may be running into an issue with
&gt; &gt; &gt; the ring not converging on a single state.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Can you try using the "riak-admin ringready" command between
&gt; &gt; &gt; each join of a node? This command will return TRUE if the
&gt; &gt; &gt; nodes all agree on a particular ring state. You should run
&gt; &gt; &gt; this command until it returns TRUE after each join.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Also, Alexander is correct; you should deploy your nodes
&gt; &gt; &gt; with an increased value for the "ring\_creation\_size"
&gt; &gt; &gt; parameter in app.config. The typical recommendation is to
&gt; &gt; &gt; have a minimum of 10 partitions per node and the value
&gt; &gt; &gt; should be a power of 2 (64, 128, 256, 512, 1024). For a 63
&gt; &gt; &gt; node cluster a value of 1024 would work well.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Thanks,
&gt; &gt; &gt; Dan
&gt; &gt; &gt;
&gt; &gt; &gt; Daniel Reverri
&gt; &gt; &gt; Developer Advocate
&gt; &gt; &gt; Basho Technologies, Inc.
&gt; &gt; &gt; d...@basho.com
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; On Thu, Sep 30, 2010 at 12:02 PM, Alexander Sicular
&gt; &gt; &gt;  wrote:
&gt; &gt; &gt; The default vnode number is 64. If you are
&gt; &gt; &gt; connecting 63 physical nodes togeter in one riak
&gt; &gt; &gt; cluster than you really want to increase the number
&gt; &gt; &gt; of vnodes. There is some recommended metric for
&gt; &gt; &gt; physical nodes to vnodes. I think it's like a
&gt; &gt; &gt; minimum of 4 vnodes per physical node. But I could
&gt; &gt; &gt; be totally making that up.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; -Alexander.
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; @siculars on twitter
&gt; &gt; &gt; http://siculars.posterous.com
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Sent from my iPhone
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; On Sep 30, 2010, at 14:26, Michael Colussi
&gt; &gt; &gt;  wrote:
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; &gt; Hey guys,
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; My team was trying to launch a 63 node Riak
&gt; &gt; &gt; &gt; cluster yesterday, using version 0.13rc3 and the
&gt; &gt; &gt; &gt; bitcask backend.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; All 63 nodes agreed that the ring consisted of
&gt; &gt; &gt; &gt; nodes 1-42 only.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Any ideas? Is there a hardcoded limit to the
&gt; &gt; &gt; &gt; number of nodes allowed?
&gt; &gt; &gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; &gt; riak-users@lists.basho.com
&gt; &gt; &gt; &gt;
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com
&gt; &gt; &gt;
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com
&gt; &gt; &gt;
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

