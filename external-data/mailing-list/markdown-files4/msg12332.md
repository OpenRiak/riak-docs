---
title: "Re: Riak cluster all nodes down"
description: ""
project: community
lastmod: 2013-09-20T07:45:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12332"
mailinglist_parent_id: "msg12334"
author_name: "Edgar Veiga"
project_section: "mailinglistitem"
sent_date: 2013-09-20T07:45:08-07:00
---


Yes I did, via CURL command:

curl -v -XPUT http://dat7:8098/riak/visitors -H "Content-Type:
application/json" -d '{"props":{"n\_val":"3"}}'

How can I update the n\_val of an already existing bucket, while the
instance is down?


On 20 September 2013 15:32, Jon Meredith  wrote:

&gt; Looks like the nval is set to a binary &lt;&lt;"3"&gt;&gt; rather than an integer.
&gt; Have you changed it recently and how?
&gt;
&gt; On Sep 20, 2013, at 8:25 AM, Edgar Veiga  wrote:
&gt;
&gt; Hello everyone,
&gt;
&gt; Please lend me a hand here... I'm running a riak cluster of 6 machines
&gt; (version 1.4.1).
&gt;
&gt; Suddenly all the nodes in the cluster went down and they are refusing to
&gt; go up again. It keeps crashing all the the time, this is just a sample of
&gt; what I get when starting a node:
&gt;
&gt; 2013-09-20 15:16:14.016 [info] &lt;0.7.0&gt; Application lager started on node '
&gt; riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.024 [info] &lt;0.7.0&gt; Application sasl started on node '
&gt; riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.026 [info] &lt;0.7.0&gt; Application crypto started on node '
&gt; riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.026 [info] &lt;0.7.0&gt; Application public\_key started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.029 [info] &lt;0.7.0&gt; Application ssl started on node '
&gt; riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.031 [info] &lt;0.7.0&gt; Application riak\_sysmon started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.036 [info] &lt;0.7.0&gt; Application os\_mon started on node '
&gt; riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.044 [info] &lt;0.7.0&gt; Application runtime\_tools started
&gt; on node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.047 [info] &lt;0.7.0&gt; Application erlang\_js started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.058 [info] &lt;0.7.0&gt; Application inets started on node '
&gt; riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.059 [info] &lt;0.7.0&gt; Application mochiweb started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.063 [info] &lt;0.7.0&gt; Application webmachine started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.064 [info] &lt;0.7.0&gt; Application basho\_stats started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.067 [info] &lt;0.7.0&gt; Application bitcask started on node
&gt; 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.152 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_core,vnode\_routing} = proxy
&gt; 2013-09-20 15:16:14.160 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_core,staged\_joins} = true
&gt; 2013-09-20 15:16:14.166 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_core,resizable\_ring} = true
&gt; 2013-09-20 15:16:14.172 [info] &lt;0.7.0&gt; Application riak\_core started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:14.177 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_pipe,trace\_format} = ordsets
&gt; 2013-09-20 15:16:14.270 [info] &lt;0.522.0&gt;@riak\_kv\_env:doc\_env:42
&gt; Environment and OS variables:
&gt; 2013-09-20 15:16:14.446 [notice] &lt;0.41.0&gt;@lager\_app:119 Deprecated
&gt; lager\_file\_backend config detected, please consider updating it
&gt; 2013-09-20 15:16:14.786 [info] &lt;0.573.0&gt;@riak\_core:wait\_for\_service:470
&gt; Waiting for service riak\_kv to start (0 seconds)
&gt; 2013-09-20 15:16:14.821 [info] &lt;0.590.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.590.0&gt;)
&gt; 2013-09-20 15:16:14.823 [info] &lt;0.591.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.591.0&gt;)
&gt; 2013-09-20 15:16:14.825 [info] &lt;0.592.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.592.0&gt;)
&gt; 2013-09-20 15:16:14.826 [info] &lt;0.593.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.593.0&gt;)
&gt; 2013-09-20 15:16:14.827 [info] &lt;0.594.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.594.0&gt;)
&gt; 2013-09-20 15:16:14.829 [info] &lt;0.595.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.595.0&gt;)
&gt; 2013-09-20 15:16:14.831 [info] &lt;0.596.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.596.0&gt;)
&gt; 2013-09-20 15:16:14.833 [info] &lt;0.597.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_map)
&gt; host starting (&lt;0.597.0&gt;)
&gt; 2013-09-20 15:16:14.837 [info] &lt;0.600.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool:
&gt; riak\_kv\_js\_reduce) host starting (&lt;0.600.0&gt;)
&gt; 2013-09-20 15:16:14.841 [info] &lt;0.601.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool:
&gt; riak\_kv\_js\_reduce) host starting (&lt;0.601.0&gt;)
&gt; 2013-09-20 15:16:14.845 [info] &lt;0.602.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool:
&gt; riak\_kv\_js\_reduce) host starting (&lt;0.602.0&gt;)
&gt; 2013-09-20 15:16:14.848 [info] &lt;0.603.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool:
&gt; riak\_kv\_js\_reduce) host starting (&lt;0.603.0&gt;)
&gt; 2013-09-20 15:16:14.850 [info] &lt;0.605.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool:
&gt; riak\_kv\_js\_reduce) host starting (&lt;0.605.0&gt;)
&gt; 2013-09-20 15:16:14.852 [info] &lt;0.606.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool:
&gt; riak\_kv\_js\_reduce) host starting (&lt;0.606.0&gt;)
&gt; 2013-09-20 15:16:14.853 [info] &lt;0.608.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_hook)
&gt; host starting (&lt;0.608.0&gt;)
&gt; 2013-09-20 15:16:14.855 [info] &lt;0.609.0&gt;@riak\_kv\_js\_vm:init:76
&gt; Spidermonkey VM (thread stack: 16MB, max heap: 8MB, pool: riak\_kv\_js\_hook)
&gt; host starting (&lt;0.609.0&gt;)
&gt; 2013-09-20 15:16:14.855 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,vnode\_vclocks} = true
&gt; 2013-09-20 15:16:14.867 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,legacy\_keylisting} = false
&gt; 2013-09-20 15:16:14.873 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,listkeys\_backpressure} = true
&gt; 2013-09-20 15:16:14.884 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,index\_backpressure} = true
&gt; 2013-09-20 15:16:14.889 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,mapred\_system} = pipe
&gt; 2013-09-20 15:16:14.900 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,mapred\_2i\_pipe} = true
&gt; 2013-09-20 15:16:14.905 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,anti\_entropy} = enabled\_v1
&gt; 2013-09-20 15:16:14.911 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,handoff\_data\_encoding} = encode\_raw
&gt; 2013-09-20 15:16:14.917 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,object\_format} = v1
&gt; 2013-09-20 15:16:14.927 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,secondary\_index\_version} = v2
&gt; 2013-09-20 15:16:14.943 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,vclock\_data\_encoding} = encode\_zlib
&gt; 2013-09-20 15:16:14.953 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_kv,crdt} = [pncounter]
&gt; 2013-09-20 15:16:15.011 [warning] &lt;0.6.0&gt; lager\_error\_logger\_h dropped 17
&gt; messages in the last second that exceeded the limit of 100 messages/sec
&gt; 2013-09-20 15:16:15.012 [info]
&gt; &lt;0.162.0&gt;@riak\_core\_capability:process\_capability\_changes:530 New
&gt; capability: {riak\_control,member\_info\_version} = v1
&gt; 2013-09-20 15:16:15.022 [info] &lt;0.7.0&gt; Application riak\_control started on
&gt; node 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:15.022 [info] &lt;0.7.0&gt; Application erlydtl started on node
&gt; 'riak@192.168.20.107'
&gt; 2013-09-20 15:16:16.013 [error] &lt;0.1209.0&gt; gen\_fsm &lt;0.1209.0&gt; in state
&gt; started terminated with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[376793390874373408599387495934666716005045108736,371084400103549569075154352056868735459514122240,...]],...},...]},
&gt; undefined) line 851
&gt; 2013-09-20 15:16:16.013 [error] &lt;0.1209.0&gt; CRASH REPORT Process &lt;0.1209.0&gt;
&gt; with 0 neighbours exited with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[376793390874373408599387495934666716005045108736,371084400103549569075154352056868735459514122240,...]],...},...]},
&gt; undefined) line 851 in gen\_fsm:terminate/7 line 589
&gt; 2013-09-20 15:16:16.014 [error] &lt;0.140.0&gt; Supervisor riak\_core\_vnode\_sup
&gt; had child undefined started with {riak\_core\_vnode,start\_link,undefined} at
&gt; &lt;0.1209.0&gt; exit with reason no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[376793390874373408599387495934666716005045108736,371084400103549569075154352056868735459514122240,...]],...},...]},
&gt; undefined) line 851 in context child\_terminated
&gt; 2013-09-20 15:16:16.014 [error] &lt;0.739.0&gt; CRASH REPORT Process
&gt; proxy\_riak\_kv\_vnode\_376793390874373408599387495934666716005045108736 with 0
&gt; neighbours exited with reason:
&gt; {{{function\_clause,[{riak\_kv\_vnode,terminate,[{badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[376793390874373408599387495934666716005045108736,371084400103549569075154352056868735459514122240,365375409332725729550921208179070754913983135744,359666418561901890026688064301272774368452149248,353957427791078050502454920423474793822921162752,348248437020254210978221776545676813277390176256,342539446249430371453988632667878832731859189760,336830455478606531929755488790080852186328203264,331121464707782692405522344912282871640797216768,...]],...},...]},...],...},...]},...},...}
&gt; in gen\_server:call/3 line 188
&gt; 2013-09-20 15:16:16.014 [error] &lt;0.146.0&gt; Supervisor
&gt; riak\_core\_vnode\_proxy\_sup had child
&gt; {riak\_kv\_vnode,376793390874373408599387495934666716005045108736} started
&gt; with riak\_core\_vnode\_proxy:start\_link(riak\_kv\_vnode,
&gt; 376793390874373408599387495934666716005045108736) at &lt;0.739.0&gt; exit with
&gt; reason
&gt; {{{function\_clause,[{riak\_kv\_vnode,terminate,[{badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[376793390874373408599387495934666716005045108736,371084400103549569075154352056868735459514122240,365375409332725729550921208179070754913983135744,359666418561901890026688064301272774368452149248,353957427791078050502454920423474793822921162752,348248437020254210978221776545676813277390176256,342539446249430371453988632667878832731859189760,336830455478606531929755488790080852186328203264,331121464707782692405522344912282871640797216768,...]],...},...]},...],...},...]},...},...}
&gt; in context child\_terminated
&gt; 2013-09-20 15:16:16.015 [error] &lt;0.138.0&gt; Supervisor riak\_core\_sup had
&gt; child riak\_core\_vnode\_manager started with
&gt; riak\_core\_vnode\_manager:start\_link() at &lt;0.161.0&gt; exit with reason
&gt; {{function\_clause,[{riak\_kv\_vnode,terminate,[{badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[376793390874373408599387495934666716005045108736,371084400103549569075154352056868735459514122240,365375409332725729550921208179070754913983135744,359666418561901890026688064301272774368452149248,353957427791078050502454920423474793822921162752,348248437020254210978221776545676813277390176256,342539446249430371453988632667878832731859189760,336830455478606531929755488790080852186328203264,331121464707782692405522344912282871640797216768,...]],...},...]},...],...},...]},...}
&gt; in context child\_terminated
&gt; 2013-09-20 15:16:24.147 [error] &lt;0.2034.0&gt; gen\_fsm &lt;0.2034.0&gt; in state
&gt; started terminated with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[445301280124259482890185222468242482551416946688,439592289353435643365952078590444502005885960192,...]],...},...]},
&gt; undefined) line 851
&gt; 2013-09-20 15:16:24.147 [error] &lt;0.2034.0&gt; CRASH REPORT Process &lt;0.2034.0&gt;
&gt; with 0 neighbours exited with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[445301280124259482890185222468242482551416946688,439592289353435643365952078590444502005885960192,...]],...},...]},
&gt; undefined) line 851 in gen\_fsm:terminate/7 line 589
&gt; 2013-09-20 15:16:24.147 [error] &lt;0.2019.0&gt; gen\_fsm &lt;0.2019.0&gt; in state
&gt; started terminated with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[34253944624943037145398863266787883273185918976,28544953854119197621165719388989902727654932480,...]],...},...]},
&gt; undefined) line 851
&gt; 2013-09-20 15:16:24.147 [error] &lt;0.2019.0&gt; CRASH REPORT Process &lt;0.2019.0&gt;
&gt; with 0 neighbours exited with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[34253944624943037145398863266787883273185918976,28544953854119197621165719388989902727654932480,...]],...},...]},
&gt; undefined) line 851 in gen\_fsm:terminate/7 line 589
&gt; 2013-09-20 15:16:24.153 [error] &lt;0.2029.0&gt; gen\_fsm &lt;0.2029.0&gt; in state
&gt; started terminated with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[308285501624487334308589769401090949458673270784,302576510853663494784356625523292968913142284288,...]],...},...]},
&gt; undefined) line 851
&gt; 2013-09-20 15:16:24.153 [error] &lt;0.2029.0&gt; CRASH REPORT Process &lt;0.2029.0&gt;
&gt; with 0 neighbours exited with reason: no function clause matching
&gt; riak\_kv\_vnode:terminate({badarg,[{lists,split,[&lt;&lt;"3"&gt;&gt;,[308285501624487334308589769401090949458673270784,302576510853663494784356625523292968913142284288,...]],...},...]},
&gt; undefined) line 851 in gen\_fsm:terminate/7 line 589
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

