---
title: "Re: How should I avoid words that are effectively stopwords in Riak	Search?"
description: ""
project: community
lastmod: 2013-03-29T10:31:00-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10621"
mailinglist_parent_id: "msg10565"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2013-03-29T10:31:00-07:00
---


Rob,

Riak Search doesn't have a traditional term-frequency count. It has
something similar but it's an estimate and it is much more expensive than a
simple table lookup. Even if it did have term-frequency it doesn't really
expose it to the outside world. Not only that, but the standard analyzer
provides no way to specify additional stop words. You'd have to keep track
of this data externally and do some pre-processing to remove stopwords
before.

For the last 9 months I've been working on a project called Yokozuna with
the goal to replace Riak Search [1]. It's like Riak Search except much
better because the underlying engine is actually Solr/Lucene, not an
inferior clone written in Erlang. In that case you could add new
stopwords, exploit query caching, and use newer features like LUCENE-4628
[2] to help combat high frequency terms. You'd also have an easy way to
get frequency count for a given term to determine if you should make it a
stopword.

[1] https://github.com/basho/yokozuna

[2] https://issues.apache.org/jira/browse/LUCENE-4628


On Fri, Mar 22, 2013 at 2:21 PM, Rob Speer  wrote:

&gt; My company is starting to use Riak for document storage. I'm pretty happy
&gt; about how it has been working so far, but I see the messages of foreboding
&gt; and doom out there about Riak Search and I've encountered a problem myself.
&gt;
&gt; I can't really avoid using Riak Search, as full text indexing is a key
&gt; feature we need to provide. If Riak Search is suboptimal, so is basically
&gt; every other text index out there. We've just been burned by ElasticSearch's
&gt; ineffective load balancing (who would have guessed, consistent hashing is
&gt; kind of important).
&gt;
&gt; I know that performing searches in Riak Search that return many thousands
&gt; of documents is discouraged for performance reasons, and the developers
&gt; encourage removing stopwords to help with this. There's additionally, I
&gt; have seen, a hard limit on the number of documents that can be examined by
&gt; a search query; if any term matches more than 100,000 documents, the query
&gt; will return a too\_many\_results error (and, incidentally, things will get so
&gt; confused that, in the Python client, the \*next\* query will also fail with
&gt; an HTTP error 400).
&gt;
&gt; The question is, what should I actually do to avoid this case? I've
&gt; already removed the usual stopwords, but any particular set of documents
&gt; might have its own personal stopwords. For example, in a database of
&gt; millions of hotel reviews, the word 'hotel' could easily appear in more
&gt; than 100,000 documents.
&gt;
&gt; If we need to search for '5-star hotel', it's wasteful and probably
&gt; crash-prone to retrieve all the 'hotel' results. What I'd really like to do
&gt; is just search for '5-star', which because of IDF scoring will have about
&gt; the same effect. That requires knowing somehow that the word 'hotel'
&gt; appears in too many documents.
&gt;

&gt; Is there a way to determine, via Riak, which terms are overused so I can
&gt; remove them from search queries? Or do I need to keep track of this
&gt; entirely on the client end so I can avoid searching for those terms?
&gt;
&gt; Thanks,
&gt; -- Rob Speer
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

