---
title: "Re: Riak does not work on ec2"
description: ""
project: community
lastmod: 2013-06-20T22:21:50-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11318"
mailinglist_parent_id: "msg11317"
author_name: "Tom Santero"
project_section: "mailinglistitem"
sent_date: 2013-06-20T22:21:50-07:00
---


Hi David,

Sorry to hear you're having difficulties. From what I can tell, you're
simply looking to spin up a new cluster, correct? If so, riak-admin cluster
replace is not the command you want.

If you're attempting to rename your riak nodes and bind them to an AWS EIP,
you can follow these instructions [0] from the docs.

Cheers,
Tom

[0]
http://docs.basho.com/riak/latest/cookbooks/Performance-Tuning-AWS/#Dealing-with-IP-addresses


On Fri, Jun 21, 2013 at 4:55 AM, David Montgomery  wrote:

&gt; Hi,
&gt;
&gt; I am trying to get riak to work on ubuntu 12.04 and is proving not to be a
&gt; friendly install on ec2.
&gt;
&gt;
&gt; 1) I am using riak\_1.3.1-1\_amd64.deb and have libssl0.9.8 installed
&gt;
&gt; 2) I stop riak then run
&gt;
&gt; riak-admin cluster replace riak@127.0.0.1 r...@xxx.xxx.xxx.xxx
&gt; riak-admin cluster plan
&gt; riak-admin cluster commit
&gt; Attempting to restart script through sudo -H -u riak
&gt; Node is not running!
&gt;
&gt; At the very bottom are the config files. I change all of 127.0.0.1 to the
&gt; public ip addres of the machine on ec2. Kinda hard to mess up there I am
&gt; using chef. node[:ec2][:public\_ipv4]
&gt;
&gt; 3) The logs are not being very helpful. What does the below mean in
&gt; english?
&gt;
&gt; root@domU-12-31-39-0C-59-1D:/home/ubuntu# riak console
&gt; Attempting to restart script through sudo -H -u riak
&gt; Exec: /usr/lib/riak/erts-5.9.1/bin/erlexec -boot
&gt; /usr/lib/riak/releases/1.3.1/riak -embedded -config
&gt; /etc/riak/app.config -pa
&gt; /usr/lib/riak/lib/basho-patches -args\_file /etc/riak/vm.args --
&gt; console
&gt; Root: /usr/lib/riak
&gt; Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:1:1] [async-threads:64]
&gt; [kernel-poll:true]
&gt;
&gt; /usr/lib/riak/lib/os\_mon-2.2.9/priv/bin/memsup: Erlang has closed.
&gt; Erlang
&gt; has closed
&gt;
&gt; {"Kernel pid
&gt; terminated",application\_controller,"{application\_start\_failure,riak\_core,{shutdown,{riak\_core\_app,start,[normal,[]]}}}"}
&gt;
&gt; Crash dump was written to: /var/log/riak/erl\_crash.dump
&gt; Kernel pid terminated (application\_controller)
&gt; ({application\_start\_failure,riak\_core,{shutdown,{riak\_core\_app,start,[normal,[]]}}})
&gt;
&gt;
&gt;
&gt;
&gt; So..what could the issue be? Is there a missing manual? What did I miss
&gt; from the documentation on
&gt; http://docs.basho.com/riak/latest/cookbooks/Basic-Cluster-Setup/
&gt;
&gt;
&gt;
&gt; %% Riak Client APIs config
&gt; {riak\_api, [
&gt; %% pb\_backlog is the maximum length to which the queue of
&gt; pending
&gt; %% connections may grow. If set, it must be an integer &gt;= 0.
&gt; %% By default the value is 5. If you anticipate a huge number
&gt; of
&gt; %% connections being initialised \*simultaneously\*, set this
&gt; number
&gt; %% higher.
&gt; %% {pb\_backlog, 64},
&gt;
&gt; %% pb\_ip is the IP address that the Riak Protocol Buffers
&gt; interface
&gt; %% will bind to. If this is undefined, the interface will not
&gt; run.
&gt; {pb\_ip, "xxx.xxx.xxx.xxx" },
&gt;
&gt; %% pb\_port is the TCP port that the Riak Protocol Buffers
&gt; interface
&gt; %% will bind to
&gt; {pb\_port, 8087 }
&gt; ]},
&gt;
&gt; %% Riak Core config
&gt; {riak\_core, [
&gt; %% Default location of ringstate
&gt; {ring\_state\_dir, "/var/lib/riak/ring"},
&gt;
&gt; %% Default ring creation size. Make sure it is a power of 2,
&gt; %% e.g. 16, 32, 64, 128, 256, 512 etc
&gt; %{ring\_creation\_size, 64},
&gt;
&gt; %% http is a list of IP addresses and TCP ports that the Riak
&gt; %% HTTP interface will bind.
&gt; {http, [ {"xxx.xxx.xxx.xxx", 8098 } ]},
&gt;
&gt; %% https is a list of IP addresses and TCP ports that the
&gt; Riak
&gt; %% HTTPS interface will bind.
&gt; %{https, [{ "xxx.xxx.xxx.xxx", 8098 }]},
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; ## Name of the riak node
&gt; -name r...@xxx.xxx.xxx.xxx
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

