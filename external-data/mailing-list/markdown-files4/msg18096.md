---
title: "Re: anti_entropy and solr taking up suspiciously large amounts of	space"
description: ""
project: community
lastmod: 2017-03-22T07:57:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18096"
mailinglist_parent_id: "msg18094"
author_name: "Matthew Von-Maszewski"
project_section: "mailinglistitem"
sent_date: 2017-03-22T07:57:55-07:00
---


Rohit,

Would you please run “riak-debug” on one server from the command line and send 
the tar.gz file it creates directly to me. Do not copy the email list.

Notes on its usage are here: 
http://docs.basho.com/riak/kv/2.2.1/using/cluster-operations/inspecting-node/#riak-debug
 


The resulting debug package will give me and others at Basho a better picture 
of the problem. The alternative is a about twenty rounds of “what about this, 
oh, then what about that”.

Thanks,
Matthew



&gt; On Mar 21, 2017, at 9:53 PM, Rohit Sanbhadti  
&gt; wrote:
&gt; 
&gt; Matthew,
&gt; 
&gt; To clarify, this happens on all nodes in our cluster (10+ nodes) although the 
&gt; exact size varies by 10s of GB. I’ve rolling restarted the cluster the last 
&gt; time this happened (last week) with no significant change in size, although 
&gt; the output from riak-admin aae-status and riak-admin search aae-status shows 
&gt; empty after the restart. 
&gt; 
&gt; -- 
&gt; Rohit S.
&gt; 
&gt; On 3/21/17, 5:25 PM, "Matthew Von-Maszewski"  wrote:
&gt; 
&gt; Rohit,
&gt; 
&gt; If you restart the node does the elevated anti\_entropy size decline after 
&gt; the restart?
&gt; 
&gt; Matthew
&gt; 
&gt; 
&gt;&gt; On Mar 21, 2017, at 8:00 PM, Rohit Sanbhadti  
&gt;&gt; wrote:
&gt;&gt; 
&gt;&gt; Running Riak 2.2.0 on Ubuntu 16.04.1, we’ve noticed that anti\_entropy is 
&gt;&gt; taking up way too much space on all of our nodes. We use multi\_backend with 
&gt;&gt; mostly bitcask backends (relevant part of config pasted below). Has anyone 
&gt;&gt; seen this before, or does anyone have an idea what might be causing this? 
&gt;&gt; 
&gt;&gt; storage\_backend = multi
&gt;&gt; multi\_backend.bitcask\_1day.storage\_backend = bitcask
&gt;&gt; multi\_backend.bitcask\_1day.bitcask.data\_root = /var/lib/riak/bitcask\_1day
&gt;&gt; multi\_backend.bitcask\_1day.bitcask.expiry = 1d
&gt;&gt; multi\_backend.bitcask\_1day.bitcask.expiry.grace\_time = 1h
&gt;&gt; multi\_backend.bitcask\_2day.storage\_backend = bitcask
&gt;&gt; multi\_backend.bitcask\_2day.bitcask.data\_root = /var/lib/riak/bitcask\_2day
&gt;&gt; multi\_backend.bitcask\_2day.bitcask.expiry = 2d
&gt;&gt; multi\_backend.bitcask\_2day.bitcask.expiry.grace\_time = 1h
&gt;&gt; multi\_backend.bitcask\_4day.storage\_backend = bitcask
&gt;&gt; multi\_backend.bitcask\_4day.bitcask.data\_root = /var/lib/riak/bitcask\_4day
&gt;&gt; multi\_backend.bitcask\_4day.bitcask.expiry = 4d
&gt;&gt; multi\_backend.bitcask\_4day.bitcask.expiry.grace\_time = 1h
&gt;&gt; multi\_backend.bitcask\_8day.storage\_backend = bitcask
&gt;&gt; multi\_backend.bitcask\_8day.bitcask.data\_root = /var/lib/riak/bitcask\_8day
&gt;&gt; multi\_backend.bitcask\_8day.bitcask.expiry = 8d
&gt;&gt; multi\_backend.bitcask\_8day.bitcask.expiry.grace\_time = 1h
&gt;&gt; multi\_backend.leveldb\_mult.storage\_backend = leveldb
&gt;&gt; multi\_backend.leveldb\_mult.leveldb.maximum\_memory.percent = 30
&gt;&gt; multi\_backend.leveldb\_mult.leveldb.data\_root = /var/lib/riak/leveldb\_mult
&gt;&gt; multi\_backend.bitcask\_mult.storage\_backend = bitcask
&gt;&gt; multi\_backend.bitcask\_mult.bitcask.data\_root = /var/lib/riak/bitcask\_mult
&gt;&gt; multi\_backend.default = leveldb\_mult
&gt;&gt; 
&gt;&gt; $ du –h –d 1 /var/lib/riak
&gt;&gt; 
&gt;&gt; 4.0K /var/lib/riak/riak\_kv\_exchange\_fsm
&gt;&gt; 52K /var/lib/riak/generated.configs
&gt;&gt; 224K /var/lib/riak/cluster\_meta
&gt;&gt; 424K /var/lib/riak/ring
&gt;&gt; 1.1M /var/lib/riak/kv\_vnode
&gt;&gt; 2.1M /var/lib/riak/bitcask\_1day
&gt;&gt; 3.6M /var/lib/riak/bitcask\_4day
&gt;&gt; 33M /var/lib/riak/yz\_temp
&gt;&gt; 1.1G /var/lib/riak/bitcask\_2day
&gt;&gt; 5.9G /var/lib/riak/yz\_anti\_entropy
&gt;&gt; 20G /var/lib/riak/yz
&gt;&gt; 24G /var/lib/riak/leveldb\_mult
&gt;&gt; 25G /var/lib/riak/bitcask\_mult
&gt;&gt; 27G /var/lib/riak/bitcask\_8day
&gt;&gt; 139G /var/lib/riak/anti\_entropy
&gt;&gt; 240G /var/lib/riak
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -- 
&gt;&gt; Rohit S.
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_lists.basho.com\_mailman\_listinfo\_riak-2Dusers-5Flists.basho.com&d=DwIFaQ&c=uilaK90D4TOVoH58JNXRgQ&r=qO7g3ZLnCDJ2Kp8qz13HpzC2NAX5qNCtEhoWeGshuEI&m=zcfqvyFJVK17vAft30Cv9abkK5P\_f2JtRonrl0CRYnM&s=wSNoX28DcQ-CCfWp9vRUA-70z3LeWFNGHG3-LPKzAtQ&e=
&gt;&gt; 
&gt; 
&gt; 
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

