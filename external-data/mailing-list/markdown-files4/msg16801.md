---
title: "Memory Errors when using RiakCS"
description: ""
project: community
lastmod: 2015-11-24T07:44:34-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16801"
author_name: "Ben Rudolph"
project_section: "mailinglistitem"
sent_date: 2015-11-24T07:44:34-08:00
---


Hi,

We've been trying to setup RiakCS for storing files on our website,
http://commcarehq.org/. It's been difficult for us to deploy because we've
been having issues with our servers not being able to start Riak due to
memory errors. Here's what a traceback looks like when I try and start Riak
with `riak-console`:

config is OK
&gt; -config /var/lib/riak-cs/generated.configs/app.2015.11.23.18.11.17.config
&gt; -args\_file /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
&gt; -vm\_args /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
&gt; Exec: /usr/lib/riak-cs/erts-5.10.3/bin/erlexec -boot
&gt; /usr/lib/riak-cs/releases/2.0.1/riak-cs -config
&gt; /var/lib/riak-cs/generated.configs/app.2015.11.23.18.11.17.config
&gt; -args\_file /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
&gt; -vm\_args /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
&gt; -pa /usr/lib/riak-cs/lib/basho-patches -- console
&gt; Root: /usr/lib/riak-cs
&gt; Erlang R16B02\_basho8 (erts-5.10.3) [source] [64-bit] [smp:8:8]
&gt; [async-threads:64] [kernel-poll:true] [frame-pointer]
&gt;
&gt; =INFO REPORT==== 23-Nov-2015::18:11:18 ===
&gt; alarm\_handler: {set,{system\_memory\_high\_watermark,[]}}
&gt; =INFO REPORT==== 23-Nov-2015::18:11:18 ===
&gt; opening log file: "/var/log/riak-cs/access.log.2015\_11\_23\_18"
&gt; Eshell V5.10.3 (abort with ^G)
&gt; (\*\*)1&gt; [os\_mon] memory supervisor port (memsup): Erlang has closed



The machines we are trying to deploy to have 8GB of RAM and also running a
few other services, but have 3-4GB of RAM available. Are there any
configuration params we can use so it consumes less memory? I've taken a
look at the `system\_memory\_high\_watermark` which is the error we see (
http://docs.basho.com/riak/latest/ops/running/recovery/errors/). Our
configs can be found here in case that's useful:

https://github.com/dimagi/commcarehq-ansible/tree/riak/ansible/roles/riakcs/templates

Any insight would be useful! Thank you!

Ben
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

