---
title: "500 response listing a bucket with 2 keys"
description: ""
project: community
lastmod: 2014-08-18T13:30:12-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14709"
author_name: "Bryan"
project_section: "mailinglistitem"
sent_date: 2014-08-18T13:30:12-07:00
---


Hi Everyone,

Getting a very interesting 500 error from the Riak HTTP API. I am using Riak 
1.4.2:

curl http://localhost:8098/buckets/nodes/keys?keys=true

500 Internal Server ErrorInternal 
Server Error
======================

The server encountered an error while processing this 
request:  

```
{error,{exit,{ucs,{bad_utf8_character_code}},
             [{xmerl_ucs,from_utf8,1,[{file,"xmerl_ucs.erl"},{line,185}]},
              {mochijson2,json_encode_string,2,
                          [{file,"src/mochijson2.erl"},{line,186}]},
              {mochijson2,'-json_encode_array/2-fun-0-',3,
                          [{file,"src/mochijson2.erl"},{line,157}]},
              {lists,foldl,3,[{file,"lists.erl"},{line,1197}]},
              {mochijson2,json_encode_array,2,
                          [{file,"src/mochijson2.erl"},{line,159}]},
              {mochijson2,'-json_encode_proplist/2-fun-0-',3,
                          [{file,"src/mochijson2.erl"},{line,167}]},
              {lists,foldl,3,[{file,"lists.erl"},{line,1197}]},
              {mochijson2,json_encode_proplist,2,
                          
[{file,"src/mochijson2.erl"},{line,170}]}]}}
```


---

mochiweb+webmachine
 web server



We use the protocol buffer client to get data in. The data in question is a 
binary string of the nodes name:

term\_to\_binary(node())

I am able to get them out via the erlang riak client:

riakc\_pb\_socket:list\_keys(S#state.riak\_socketpid, &lt;&lt;“nodes”&gt;&gt;)

gives me:

{ok,[&lt;&lt;131,100,0,19,110,117,99,108,101,117,115,45,50,64,
 49,50,55,46,48,46,48,46,49&gt;&gt;,
 &lt;&lt;131,100,0,17,110,117,99,108,101,117,115,64,49,50,55,
 46,48,46,48,46,49&gt;&gt;]}

(nucleus@127.0.0.1)2&gt; 
binary\_to\_term(&lt;&lt;131,100,0,19,110,117,99,108,101,117,115,45,50,64,
(nucleus@127.0.0.1)2&gt; 49,50,55,46,48,46,48,46,49&gt;&gt;).
'nucleus-2@127.0.0.1'

I am looking through the console.log, but there is nothing but some bitbask 
merge messages.

Cheers,
Bryan


----

Bryan Hughes
Go Factory

http://www.go-factory.net

Connecting the Internet of Things

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

