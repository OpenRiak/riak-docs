---
title: "Re: Possibility of a CAS API"
description: ""
project: community
lastmod: 2012-02-24T17:36:53-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06737"
mailinglist_parent_id: "msg06733"
author_name: "Ian Plosker"
project_section: "mailinglistitem"
sent_date: 2012-02-24T17:36:53-08:00
---


Armon, 

The feature you are describing is very similar to the conditional header, 
`If-Unmodified-Since`, provided by the client APIs 
(http://wiki.basho.com/HTTP-Store-Object.html & 
http://wiki.basho.com/PBC-Store-Object.html).

Is this similar to what you're describing or am I missing something? 

-- 
Ian Plosker 
Developer Advocate
Basho Technologies


On Saturday, February 25, 2012 at 9:41 AM, Armon Dadgar wrote:

&gt; As part of a new feature we are working on, we've run into
&gt; a situation where it would be incredibly convenient to have a 
&gt; check-and-set (CAS) API for Riak KV. In short, we are trying to build
&gt; a unique index of a bucket, using a second bucket which acts as a 
&gt; reverse index.
&gt; 
&gt; The CAS API would operate in the same manner as a PUT, except it
&gt; should take a "last vclock". The new value + last vclock are submitted
&gt; to the responsible vnodes. The vnodes respond if the last vclock
&gt; for the key matches the specified last value. If we get "r" nodes responding
&gt; that the last value matches, then we should commit the write. This method
&gt; is basically a two-phase commit.
&gt; 
&gt; It would also be great if no-value sentinel could be specified to indicate
&gt; the CAS should only succeed if there is not already a key. We need this
&gt; to make sure uniqueness constraints are not violated.
&gt; 
&gt; I wanted to gauge the interest from the community in something like this,
&gt; and see if I could get thoughts from the Basho team on if this could be
&gt; implemented.
&gt; 
&gt; Best Regards,
&gt; 
&gt; Armon Dadgar
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

