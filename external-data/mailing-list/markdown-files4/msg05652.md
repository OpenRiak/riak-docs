---
title: "Re: Riak crash on node restarts"
description: ""
project: community
lastmod: 2011-11-18T03:49:09-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05652"
mailinglist_parent_id: "msg05586"
author_name: "Jeremy Raymond"
project_section: "mailinglistitem"
sent_date: 2011-11-18T03:49:09-08:00
---


Hello,

I'll setup my deploy script to capture this information and send you the info 
off-list (probably sometime next week).

--
Jeremy

On 2011-11-15, at 1:16 PM, Jon Meredith wrote:

&gt; Hi Joel,
&gt; 
&gt; That's not a message I'd expect to see on a clean restart. We'll need some 
&gt; more information to diagnose it. Next time it crashes, could you provide the 
&gt; contents of your ring file (you can just grab the most recent one out of 
&gt; /var/lib/riak/ring - location may vary depending on your platform) and it 
&gt; would be very helpful if you could modify your deploy script to capture the 
&gt; file list for the leveldb directory on \*all\* of your nodes immediately before 
&gt; you bounce riak to do the update. When it crashes, the console.log from all 
&gt; the nodes would also be useful. If any of those files contain sensitive 
&gt; information, please contact me off list.
&gt; 
&gt; BR, Jon
&gt; 
&gt; On Tue, Nov 15, 2011 at 6:48 AM, Jeremy Raymond  wrote:
&gt; I'm using Riak 1.0.1 and I have a script that deploys updates to each of my 3 
&gt; nodes to update the Erlang mapred modules. What I do is stop a node, deploy 
&gt; the new mapred modues, restart the node, wait for the riak\_kv service to 
&gt; start, then move onto the next node. Sometimes when I do this one of the 
&gt; nodes that is not the current one being updated will go down. Each time this 
&gt; has happened thus far it's been the same node that will go down (the last 
&gt; one). I see this error in the logs:
&gt; 
&gt; [error] Failed to start riak\_kv\_eleveldb\_backend Reason: {db\_open,"IO error: 
&gt; /var/lib/riak/leveldb/913438523331814323877303020447676887284957839360/MANIFEST-000002:
&gt; No such file or directory"}
&gt; 
&gt; If I manually restart the node, things go back to normal. Any ideas on what's 
&gt; going on? I've attached the error log.
&gt; 
&gt; --
&gt; Jeremy
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Jon Meredith
&gt; Platform Engineering Manager
&gt; Basho Technologies, Inc.
&gt; jmered...@basho.com
&gt; 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

