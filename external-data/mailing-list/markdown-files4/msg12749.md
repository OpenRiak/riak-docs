---
title: "Re: Missing primary partitions"
description: ""
project: community
lastmod: 2013-10-24T01:26:43-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12749"
mailinglist_parent_id: "msg12740"
author_name: "fenix . serega"
project_section: "mailinglistitem"
sent_date: 2013-10-24T01:26:43-07:00
---


Hi Mark,

Thank you very much, you are right. It was wrong hosts/ip in /etc/hosts. As
result - connection timeout to these hosts.

Best regards,
Sergey


2013/10/23 Mark Phillips 

&gt; Hi Sergey,
&gt;
&gt; This looks like the initial tcp connection is timing out when riak@de5
&gt; and riak@de6 are first trying to talk to the handoff/ip port for
&gt; riak@de2 (which would be configured by in riak@de2's app.config).
&gt;
&gt; You may have already gotten to the bottom of why that's happening, but
&gt; the first thing to try would be to set the cluster handoff\_concurrency
&gt; limit to "0" and then back to the default to interrupt and restart any
&gt; in-progress transfers and then watch the network traffic on the
&gt; handoff ports. You can do this with "riak-admin transfer-limit" [1].
&gt; If you don't specify a "node" (as shown in the docs) it will set it
&gt; for the whole cluster (which is what you want to do).
&gt;
&gt; Hope that helps. Keep us posted.
&gt;
&gt; Mark
&gt;
&gt; [1]
&gt; http://docs.basho.com/riak/latest/ops/running/tools/riak-admin/#transfer-limit
&gt;
&gt;
&gt;
&gt;
&gt; On Tue, Oct 22, 2013 at 2:27 AM,  wrote:
&gt; &gt; Hi all
&gt; &gt;
&gt; &gt; What to do in case of loss of the primary partitions !?
&gt; &gt;
&gt; &gt; 6 node cluster, leveldb, 1.3.2
&gt; &gt;
&gt; &gt; 5-6 nodes always waiting to handoff 46 partitions
&gt; &gt;
&gt; &gt; 'riak@de6' waiting to handoff 46 partitions
&gt; &gt; 'riak@de5' waiting to handoff 46 partitions
&gt; &gt;
&gt; &gt; Active Transfers:
&gt; &gt;
&gt; &gt; transfer type: hinted\_handoff
&gt; &gt; vnode type: riak\_kv\_vnode
&gt; &gt; partition: 919147514102638163401536164325474867830488825856
&gt; &gt; started: 2013-10-22 08:18:35 [-131940361.00 us ago]
&gt; &gt; last update: no updates seen
&gt; &gt; objects transferred: unknown
&gt; &gt;
&gt; &gt; unknown
&gt; &gt; riak@de5 =======================&gt; riak@de2
&gt; &gt; unknown
&gt; &gt;
&gt; &gt; transfer type: hinted\_handoff
&gt; &gt; vnode type: riak\_kv\_vnode
&gt; &gt; partition: 667951920186389224335277833702363723827125420032
&gt; &gt; started: 2013-10-22 08:18:40 [-136954679.00 us ago]
&gt; &gt; last update: no updates seen
&gt; &gt; objects transferred: unknown
&gt; &gt;
&gt; &gt; unknown
&gt; &gt; riak@de6 =======================&gt; riak@de2
&gt; &gt; unknown
&gt; &gt;
&gt; &gt; .......
&gt; &gt;
&gt; &gt;
&gt; &gt; How to fix/disable these handoffs and errors:
&gt; &gt;
&gt; &gt; 2013-10-21 23:59:56.894 [error]
&gt; &gt; &lt;0.9317.693&gt;@riak\_core\_handoff\_sender:start\_fold:226 hinted\_handoff
&gt; transfer
&gt; &gt; of riak\_kv\_vnode from 'riak@de5'
&gt; &gt; 987655403352524237692333890859050634376860663808 to 'riak@de2'
&gt; &gt; 987655403352524237692333890859050634376860663808 failed because of
&gt; &gt; error:{badmatch,{error,timeout}}
&gt; &gt;
&gt; [{riak\_core\_handoff\_sender,start\_fold,5,[{file,"src/riak\_core\_handoff\_sender.erl"},{line,101}]}]
&gt; &gt; ....
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Sergey
&gt; &gt;
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; &gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

