---
title: "Unable to run riak map reduce"
description: ""
project: community
lastmod: 2014-11-04T04:17:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15115"
author_name: "Dinesh Rajpoot"
project_section: "mailinglistitem"
sent_date: 2014-11-04T04:17:11-08:00
---


Hi,

I am storing JSON data in riak in formate shown below:
{
 'event\_name' : 'add\_to\_cart',
 'app\_id' : 245
 'device\_id' : ggre11
}

Map reduce I ran:
+++++++++++++++++++++++++++++++++++

import riakclient = riak.RiakClient()query =
client.add('data')query.map("function(v) { var data =
JSON.parse(v.values[0].data); if(data.app\_id == 245) { return [[v.key,
data]]; } return []; }")for result in query.run():
 \*print \*result

++++++++++++++++++++++++++++++++++++++++++

Above code does not result into any output and getting error shown below:

riak.RiakError: 'Error running MapReduce operation. Headers:
 Body:
\'{"phase":0,"error":"{{timeout,{gen\_server,call,[&lt;13322.456.0&gt;,{checkout\_to,&lt;13322.9238.26&gt;},1000]}},{gen\_server,call,[riak\_kv\_js\_map,{reserve\_vm,&lt;13322.22407.26&gt;},infinity]}}","input":"{ok,{r\_object,&lt;&lt;\\\\"data\\\\"&gt;&gt;,&lt;&lt;\\\\"1UhtcNM7ycm5zbHn0ulq0ELPFFt\\\\"&gt;&gt;,[{r\_content,{dict,6,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[[&lt;&lt;\\\\"Links\\\\"&gt;&gt;]],[],[],[],[],[],[],[],[[&lt;&lt;\\\\"content-type\\\\"&gt;&gt;,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110],[&lt;&lt;\\\\"X-Riak-VTag\\\\"&gt;&gt;,55,88,115,111,98,76,88,112,97,77,56,101,80,111,69,90,81,55,77,78,67,49]],[[&lt;&lt;\\\\"index\\\\"&gt;&gt;]],[],[[&lt;&lt;\\\\"X-Riak-Last-Modified\\\\"&gt;&gt;|{1414,659851,836816}]],[],[[&lt;&lt;\\\\"X-Riak-Meta\\\\"&gt;&gt;]]}}},&lt;&lt;\\\\"{\\\\\\\\\\\\"goal\_short\_name\\\\\\\\\\\\":
\\\\\\\\\\\\"zipcheck\\\\\\\\\\\\",
\\\\\\\\\\\\"...\\\\"&gt;&gt;}],...},...}","type":"exit","stack":"[{gen\_server,call,3,[{file,\\\\"gen\_server.erl\\\\"},{line,188}]},{riak\_kv\_js\_manager,blocking\_dispatch,4,[{file,\\\\"src/riak\_kv\_js\_manager.erl\\\\"},{line,242}]},{riak\_kv\_mrc\_map,map\_js,3,[{file,\\\\"src/riak\_kv\_mrc\_map.erl\\\\"},{line,196}]},{riak\_kv\_mrc\_map,process,3,[{file,\\\\"src/riak\_kv\_mrc\_map.erl\\\\"},{line,144}]},{riak\_pipe\_vnode\_worker,process\_input,3,[{file,\\\\"src/riak\_pipe\_vnode\_worker.erl\\\\"},{line,446}]},{riak\_pipe\_vnode\_worker,wait\_for\_input,2,[{file,\\\\"src/riak\_pipe\_vnode\_worker.erl\\\\"},{line,378}]},{gen\_fsm,handle\_msg,...},...]"}\''

Setup:

2 Machines with 8 GB RAM each, 5 Nodes on each machine and total 20GB
of data with replication factor of 3

Regards,

Dinesh
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

