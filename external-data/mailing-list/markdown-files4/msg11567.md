---
title: "Re: Does Riak support Range Queries over binary safe strings?"
description: ""
project: community
lastmod: 2013-07-17T05:50:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11567"
mailinglist_parent_id: "msg11564"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2013-07-17T05:50:45-07:00
---


On Wed, Jul 17, 2013 at 5:31 AM, gbrits  wrote:

&gt; Sounds good to me. Just to confirm: the value which I want to get a slice
&gt; from can be a bytearray encoded as a string? (base 255)?
&gt;
&gt;
Bytes are bytes to Riak. Your value is completely opaque.


&gt; Oh and almost forgot, I DO need to be able to parameterize the m/r (with
&gt; param startSliceAt, endSliceAt + some other parameters that manage how
&gt; aggregation of values is performed) .
&gt; Being an absolute noob to m/r is this possible?
&gt;
&gt;
Each phase of a MapReduce job can receive arbitrary additional arguments. I
highly suggest you check out our tutorials on the matter:
http://docs.basho.com/riak/latest/tutorials/querying/MapReduce/


&gt;
&gt;
&gt; 2013/7/17 Alexander Sicular [via Riak Users] &lt;[hidden 
&gt; email]
&gt; &gt;
&gt;
&gt;&gt; To the extent you limit your sliced data via an m/r you will reap those
&gt;&gt; savings on the wire when transferring back to the client
&gt;&gt;
&gt;&gt; You can feed an m/r from riak search, 2i or enumerated keys thereby
&gt;&gt; skipping a costly bucket scan.
&gt;&gt;
&gt;&gt;
&gt;&gt; @siculars
&gt;&gt; http://siculars.posthaven.com
&gt;&gt;
&gt;&gt; Sent from my iRotaryPhone
&gt;&gt;
&gt;&gt; On Jul 16, 2013, at 19:46, Jeremiah Peschka &lt;[hidden 
&gt;&gt; email]&gt;
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt; Not a problem.
&gt;&gt;
&gt;&gt; MapReduce across an entire keyspace is slow.
&gt;&gt;
&gt;&gt; MapReduce when provided with a few bucket/key pairs is the same as a
&gt;&gt; multi-get + processing.
&gt;&gt;
&gt;&gt; You can combine 2i + MR to get quick processing of data. Although, at
&gt;&gt; that point, you might as well just process your data on the client side.
&gt;&gt; Especially if you're just pulling out a slice of bytes.
&gt;&gt;
&gt;&gt; ---
&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar Unlimited
&gt;&gt; MCITP: SQL Server 2008, MVP
&gt;&gt; Cloudera Certified Developer for Apache Hadoop
&gt;&gt;
&gt;&gt;
&gt;&gt; On Tue, Jul 16, 2013 at 4:13 PM, gbrits &lt;[hidden 
&gt;&gt; email]
&gt;&gt; &gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Wow, high speed on this list!
&gt;&gt;&gt;
&gt;&gt;&gt; I wanted it for near realtime anyway so Map/reduce is out of the
&gt;&gt;&gt; question. Thought somehow it could be done through Riak Search or directly
&gt;&gt;&gt; on secondary indices instead of map/reduce.
&gt;&gt;&gt; Guess not. Oh well, can't have it all.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; 2013/7/17 Jeremiah Peschka [via Riak Users] &lt;[hidden 
&gt;&gt;&gt; email]
&gt;&gt;&gt; &gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Following up on Alex's comments -
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; If you know which bytes you need to slice, you can store this in a
&gt;&gt;&gt;&gt; secondary index. You can perform range queries across secondary indices (as
&gt;&gt;&gt;&gt; well as keys).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; As long as you're storing your data in a way that allows it to be read
&gt;&gt;&gt;&gt; by either Erlang or JavaScript, you should be able to query over it in
&gt;&gt;&gt;&gt; MapReduce. This is typically regarded as a Bad Ideaâ„¢ since an MR query will
&gt;&gt;&gt;&gt; need to scan all keys in a bucket (which effectively means scanning the
&gt;&gt;&gt;&gt; entire cluster) and is best done as an infrequent activity to transform
&gt;&gt;&gt;&gt; data.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ---
&gt;&gt;&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar Unlimited
&gt;&gt;&gt;&gt; MCITP: SQL Server 2008, MVP
&gt;&gt;&gt;&gt; Cloudera Certified Developer for Apache Hadoop
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Tue, Jul 16, 2013 at 3:45 PM, Alexander Sicular &lt;[hidden 
&gt;&gt;&gt;&gt; email]
&gt;&gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I would say no. Riak is generally oblivious as to the content of your
&gt;&gt;&gt;&gt;&gt; data. Any ranges or other method you would use to query needs to be
&gt;&gt;&gt;&gt;&gt; explicitly indexed via riak search or secondary indexes. Once you have
&gt;&gt;&gt;&gt;&gt; found your data you could operate over that data in a map reduce, but I
&gt;&gt;&gt;&gt;&gt; can't speak to "binary safe" blob operations in either erlang or 
&gt;&gt;&gt;&gt;&gt; JavaScript
&gt;&gt;&gt;&gt;&gt; although I'm inclined to say yes, you would be able to operate over it in
&gt;&gt;&gt;&gt;&gt; m/r.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; So searching for keys with certain data in the binblob is probably not
&gt;&gt;&gt;&gt;&gt; gonna happen but once you have a key to feed an m/r you could get a slice
&gt;&gt;&gt;&gt;&gt; of that value.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Make sense?
&gt;&gt;&gt;&gt;&gt; -Alexander
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; @siculars
&gt;&gt;&gt;&gt;&gt; http://siculars.posthaven.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Sent from my iRotaryPhone
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On Jul 16, 2013, at 18:17, gbrits &lt;[hidden 
&gt;&gt;&gt;&gt;&gt; email]&gt;
&gt;&gt;&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; &gt; First, hello all!
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt; Coming from Redis, I love that you can just put any binary blob in
&gt;&gt;&gt;&gt;&gt; Redis
&gt;&gt;&gt;&gt;&gt; &gt; which is just treated as a string. This is possible because Redis
&gt;&gt;&gt;&gt;&gt; strings
&gt;&gt;&gt;&gt;&gt; &gt; are what they call 'binary safe'. This makes it possible to return
&gt;&gt;&gt;&gt;&gt; slices of
&gt;&gt;&gt;&gt;&gt; &gt; string-encoded binary data, which is super useful for
&gt;&gt;&gt;&gt;&gt; bitset-operations,
&gt;&gt;&gt;&gt;&gt; &gt; etc.
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt; I'm investigating Riak and I like it a lot so far. Riak seems to
&gt;&gt;&gt;&gt;&gt; have range
&gt;&gt;&gt;&gt;&gt; &gt; queries (on values, as it seems I must make that distinction with
&gt;&gt;&gt;&gt;&gt; &gt; column-stores), but I'm not sure if strings in Riak are "Binary
&gt;&gt;&gt;&gt;&gt; safe" in the
&gt;&gt;&gt;&gt;&gt; &gt; above sense. If not, is there another way to store binary data in
&gt;&gt;&gt;&gt;&gt; Riak and
&gt;&gt;&gt;&gt;&gt; &gt; still do range queries over them quickly?
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt; To be exact: I want to do multi-key lookups in Riak, where each
&gt;&gt;&gt;&gt;&gt; returned
&gt;&gt;&gt;&gt;&gt; &gt; result should be of format: 
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt; Thanks,
&gt;&gt;&gt;&gt;&gt; &gt; Geert-Jan
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt; --
&gt;&gt;&gt;&gt;&gt; &gt; View this message in context:
&gt;&gt;&gt;&gt;&gt; http://riak-users.197444.n3.nabble.com/Does-Riak-support-Range-Queries-over-binary-safe-strings-tp4028356.html
&gt;&gt;&gt;&gt;&gt; &gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt; &gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt; &gt; [hidden email]
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt; [hidden email] 
&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; [hidden email] 
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ------------------------------
&gt;&gt;&gt;&gt; If you reply to this email, your message will be added to the
&gt;&gt;&gt;&gt; discussion below:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; http://riak-users.197444.n3.nabble.com/Does-Riak-support-Range-Queries-over-binary-safe-strings-tp4028356p4028359.html
&gt;&gt;&gt;&gt; To unsubscribe from Does Riak support Range Queries over binary safe
&gt;&gt;&gt;&gt; strings?, click here.
&gt;&gt;&gt;&gt; NAML
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; ------------------------------
&gt;&gt;&gt; View this message in context: Re: Does Riak support Range Queries over
&gt;&gt;&gt; binary safe 
&gt;&gt;&gt; strings?
&gt;&gt;&gt;
&gt;&gt;&gt; Sent from the Riak Users mailing list 
&gt;&gt;&gt; archiveat
&gt;&gt;&gt; Nabble.com.
&gt;&gt;&gt;
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; [hidden email] 
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; [hidden email] 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; [hidden email] 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------
&gt;&gt; If you reply to this email, your message will be added to the
&gt;&gt; discussion below:
&gt;&gt;
&gt;&gt; http://riak-users.197444.n3.nabble.com/Does-Riak-support-Range-Queries-over-binary-safe-strings-tp4028356p4028365.html
&gt;&gt; To unsubscribe from Does Riak support Range Queries over binary safe
&gt;&gt; strings?, click here.
&gt;&gt; NAML
&gt;&gt;
&gt;
&gt;
&gt; ------------------------------
&gt; View this message in context: Re: Does Riak support Range Queries over
&gt; binary safe 
&gt; strings?
&gt; Sent from the Riak Users mailing list 
&gt; archiveat Nabble.com.
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

