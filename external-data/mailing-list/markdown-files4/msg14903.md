---
title: "Re: Yokozuna Scale"
description: ""
project: community
lastmod: 2014-09-16T22:45:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14903"
mailinglist_parent_id: "msg14902"
author_name: "Eric Redmond"
project_section: "mailinglistitem"
sent_date: 2014-09-16T22:45:13-07:00
---



On Sep 16, 2014, at 9:37 PM, anandm  wrote:

&gt; I started checking out Riak as an alternative for one my projects. We are
&gt; currently using SolrCloud 4.8 (36 Shards + 3 Replica each) - and all stored
&gt; fields (64 fields per doc + each doc at about 6kb on average)
&gt; I want to get this thing migrated - so push all data out of Solr and store
&gt; it in a KV - like Riak, but keep the indexes going in Solr (as I have a lot
&gt; of code written already around Solr)
&gt; 
&gt; Came across Yokozuna today and sounds like thats going to be a perfect match
&gt; for my requirement...
&gt; 
&gt; Just a couple of questions I have - I tried searching online for answers
&gt; (but couldn't find references to large Scale Yokozuna deployments)

That's because it's only been released for about 2 weeks. Give it some time :)

&gt; 1. I have over 250M documents indexed & stored (thats very bad) in current
&gt; SolrCloud deployment - with the replication factor of 3 - total Solr Index +
&gt; Data Size is about 4.5TB spread across 6 Servers (12 core (24 threads) +
&gt; 96GB)

&gt; Index Search performance and write performance is good enough with 36
&gt; Shards and Composite Id routing - I want to migrate this straight to Riak
&gt; with Yokozuna enabled.
&gt; I'll be deploying a 5-6 node Riak Cluster - that would mean roughly
&gt; about 50M docs will be stored on each node - and Yokozuna will index it
&gt; locally on each node's Solr too (only indexed fields) -

Riak also replicates data to maintain high availability. By default, this 
replication value
(n\_val) is 3. So if you have 250M values, you'll end up with 750M documents by 
default,
or 150M per node if you stick with 6. If you reduce the n\_val, you'll reduce 
both the
object count, as well as reduce availability.

&gt; a. Will this Solr instance have just one core to index the data?
&gt; (As of now I just plan to have one bucket)

If you only create one index, yes.. There's one node per Riak node. You can, 
however,
run more than one Riak node per physical server, thus increasing the solr core 
count.

&gt; b. Would it be able to handle the load of searching through 50M
&gt; docs with just one core? I think RAM wont be an issue - but I have not seen
&gt; a single Solr instance serving 50M docs so a bit worried about that.

We've tested up to 10M per node, so you may require more nodes. But it's worth
running a small test to be sure.

&gt; 2. Every time I query the Solr instance via Riak - /search hander - The
&gt; actual search query will run in a distributed manner on Solr nodes in the
&gt; cluster - but will Yokozuna also fetch the Stored fields for the docs or the
&gt; entire docs from the underlying Riak instances too and return that to the
&gt; search request? Or would my client app need to query the Riak docs in a
&gt; separate query?

Riak will fetch whatever you've configured the schema/query to fetch. If you're
simply trying to get a full object, you may be better off performing the search 
query,
and then using the resulting document's key value (\_yz\_kv) to get the full
object from Riak KV.

&gt; 3. Anybody with a large scale Yokozuna deployment and if you could make a
&gt; quick comment on the deployment size, the hardware and overall throughput -
&gt; that will help. 

You may be deploying the first Yokozuna deployment of that size. I'm interested
in your results. If this is a fixed set of documents, you may get away with a 
lower
n\_val such as 2. Furthermore, you can try increasing the node count.


&gt; Thanks.
&gt; 
&gt; 
&gt; 
&gt; 
&gt; --
&gt; View this message in context: 
&gt; http://riak-users.197444.n3.nabble.com/Yokozuna-Scale-tp4031808.html
&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

