---
title: "Re: Riak search on an index limited to only 1 bucket"
description: ""
project: community
lastmod: 2016-05-13T12:29:23-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17350"
mailinglist_parent_id: "msg17348"
author_name: "Drew Kerrigan"
project_section: "mailinglistitem"
sent_date: 2016-05-13T12:29:23-07:00
---


@Alex please kindly take a look at the default solr schema for Riak Search.
You should have based your custom schema on this (if you've created a
custom schema):
https://docs.basho.com/riak/kv/2.1.4/developing/usage/search-schemas/ -&gt;
https://raw.githubusercontent.com/basho/yokozuna/develop/priv/default\_schema.xml

Specifically take a look at these lines:
https://github.com/basho/yokozuna/blob/develop/priv/default\_schema.xml#L124-L131
(This
is where the \_yz\_rt/rb/rk are defined to be indexed)

And these:
https://github.com/basho/yokozuna/blob/develop/priv/default\_schema.xml#L101-L104
-
These dynamic fields catch all Riak DTs because the solr field names of
data types automatically get their type name appended to the end (as you
noticed with your reference to "\*likes\_counter" \*in your own index).

As you can see in the default schema, all sets are automatically indexed as
multivalued.

Hopefully this info takes away some of the magic for you ;-)

Drew

On Fri, May 13, 2016 at 12:16 PM Vitaly &lt;13vitam...@gmail.com&gt; wrote:

&gt; In general, Riak/Solr is capable of indexing multi-valued properties (i.g.
&gt; lists). You're right thinking that multiValued = "true" should be used for
&gt; it. That said, check if it works with your client library (it's Python,
&gt; isn't it?). I believe it does.
&gt;
&gt; Regards,
&gt; Vitaly
&gt;
&gt; On Fri, May 13, 2016 at 9:59 PM, Alex De la rosa 
&gt; wrote:
&gt;
&gt;&gt; Another question... if I have a set of tags for the elements... like
&gt;&gt; photo.set['tags'] with things like: ["holidays", "Hawaii", "2016"]... will
&gt;&gt; it be indexed like this?
&gt;&gt;
&gt;&gt; &gt; multiValued="true" /&gt;
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Alex
&gt;&gt;
&gt;&gt; On Fri, May 13, 2016 at 10:52 PM, Alex De la rosa &lt;
&gt;&gt; alex.rosa....@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Oh!! silly me... \*\_yz\_rb\* and \*\_yz\_rt\*... how didn't I think of that?...
&gt;&gt;&gt;
&gt;&gt;&gt; thanks also for the "\*:\*" tip ; )
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt; Alex
&gt;&gt;&gt;
&gt;&gt;&gt; On Fri, May 13, 2016 at 10:50 PM, Vitaly &lt;13vitam...@gmail.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi Alex,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 'likes\_counter:[100 TO \*] AND \_yz\_rb:photos' will limit query results
&gt;&gt;&gt;&gt; to the photos bucket only. Similarly, "\_yz\_rt" is for a bucket type.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Searching for anything in an index can be done with "\*:\*" (any field,
&gt;&gt;&gt;&gt; any value).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Regards,
&gt;&gt;&gt;&gt; Vitaly
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Fri, May 13, 2016 at 9:40 PM, Alex De la rosa &lt;
&gt;&gt;&gt;&gt; alex.rosa....@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hi all,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Imaging I have an index called "\*posts\*" where I index the following
&gt;&gt;&gt;&gt;&gt; fields
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt; stored="false" /&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; and I reuse the index in 3 buckets: "status", "photos" and "videos"...
&gt;&gt;&gt;&gt;&gt; then I do the following:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \*results = client.fulltext\_search('posts', 'likes\_counter:[100 TO \*]',
&gt;&gt;&gt;&gt;&gt; sort='likes\_counter desc', rows=10)\*
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; This query would give me the top10 most liked items (can be statuses,
&gt;&gt;&gt;&gt;&gt; photos or videos) with at least 100 likes. But how could I limit the
&gt;&gt;&gt;&gt;&gt; resultset to only the "photos" bucket?? The goal is to get the Top10 liked
&gt;&gt;&gt;&gt;&gt; photos without creating an index for itself... as is good to also be able
&gt;&gt;&gt;&gt;&gt; to query the top10 items in general. Any way to do it?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; In another hand... does somebody know how to do the same query but
&gt;&gt;&gt;&gt;&gt; without the [100 TO \*]?? I leave it empty?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \*results = client.fulltext\_search('\*\*posts\*\*', '',
&gt;&gt;&gt;&gt;&gt; sort='likes\_counter desc', rows=10)\*
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt; Alex
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

