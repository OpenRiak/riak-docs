---
title: "Re: Dangling keys/objects after a batch of sequential inserts (for	going on 3 days)"
description: ""
project: community
lastmod: 2013-07-21T11:58:27-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11661"
mailinglist_parent_id: "msg11660"
author_name: "Siraaj Khandkar"
project_section: "mailinglistitem"
sent_date: 2013-07-21T11:58:27-07:00
---



On 07/21/2013 02:42 PM, Siraaj Khandkar wrote:

On 07/21/2013 02:20 PM, Siraaj Khandkar wrote:

On 07/21/2013 07:24 AM, Russell Brown wrote:&gt; Hi,
 &gt;
 &gt; On 21 Jul 2013, at 02:09, Siraaj Khandkar  wrote:





This is how I am testing it:

 Compare = fun(PID, Bucket) -&gt;
 B = Bucket,
 L1 = riakc\_pb\_socket:get\_index(PID, B, {binary\_index,
"bucket"}, B),
 L2 = riakc\_pb\_socket:get\_index(PID, B, {binary\_index,
"bucket"}, B),


Err. Copy-n-paste error. This should, of course, be:

I = "bucket",
{ok, {keys, L1}}=riakc\_pb\_socket:get\_index(PID, B, {binary\_index, I}, B)
{ok, {keys, L2}}=riakc\_pb\_socket:get\_index(PID, B, {binary\_index, I}, B)

In the real code I'm actually calling a wrapper function that matches on 
{ok, {keys, Keys}}.






 io:format("L1: ~b, L2: ~b~n",[length(L1), length(L2)]),
 Diff\_L1\_L2 = L1 -- L2,
 Diff\_L2\_L1 = L2 -- L1,
 io:format("=== L1 -- L2 ===~n~p~n~n", [Diff\_L1\_L2]),
 io:format("=== L2 -- L1 ===~n~p~n~n", [Diff\_L2\_L1]),
 Fetch = fun(Key) -&gt;
 case riakc\_pb\_socket:get(PID, B, Key) of
 {ok, \_} -&gt; io:format("FOUND: ~p~n", [Key]);
 {error, \_} -&gt; io:format("NOT FOUND: ~p~n", [Key])
 end
 end,
 io:format("=== L1 -- L2 ===~n"),
 lists:foreach(Fetch, Diff\_L1\_L2),
 io:format("=== L2 -- L1 ===~n"),
 lists:foreach(Fetch, Diff\_L2\_L1)
 end.=


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

