---
title: "Re: \"Bad message code\" error from Java ProtoBuf client?"
description: ""
project: community
lastmod: 2012-12-14T14:43:05-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09589"
mailinglist_parent_id: "msg09588"
author_name: "Brian Roach"
project_section: "mailinglistitem"
sent_date: 2012-12-14T14:43:05-08:00
---


Sorry - dyslexia acting up:

That should read that you received a "list keys" response when
expecting a "get" response.

- Roach

On Fri, Dec 14, 2012 at 3:40 PM, Brian Roach  wrote:
&gt; Tim -
&gt;
&gt; That error is generated when the original, underlying protocol buffers
&gt; Riak client gets the wrong protobuf message from the socket - as in,
&gt; not the one it's expecting.
&gt;
&gt; The codes are here:
&gt; http://docs.basho.com/riak/latest/references/apis/protocol-buffers/
&gt;
&gt; The code numbers you list basically say that you got a "get" response
&gt; message when expecting a "list keys" response method.
&gt;
&gt; I'm digging into this to see how that would happen (I have an idea)
&gt; but by any chance are you listing keys and then not iterating through
&gt; the entire set?
&gt;
&gt; Thanks,
&gt; Brian Roach
&gt;
&gt; On Fri, Dec 14, 2012 at 2:55 PM, Tim W  wrote:
&gt;&gt; I'm seeing the following message emitted from a query to Riak:
&gt;&gt;
&gt;&gt; com.basho.riak.client.RiakRetryFailedException: java.io.IOException: bad
&gt;&gt; message code. Expected: 10 actual: 18
&gt;&gt; at
&gt;&gt; com.basho.riak.client.cap.DefaultRetrier.attempt(DefaultRetrier.java:79)
&gt;&gt; at
&gt;&gt; com.basho.riak.client.cap.DefaultRetrier.attempt(DefaultRetrier.java:81)
&gt;&gt; at
&gt;&gt; com.basho.riak.client.cap.DefaultRetrier.attempt(DefaultRetrier.java:81)
&gt;&gt; at
&gt;&gt; com.basho.riak.client.cap.DefaultRetrier.attempt(DefaultRetrier.java:81)
&gt;&gt;
&gt;&gt; I'm also seeing this a bit further down in the log:
&gt;&gt;
&gt;&gt; Caused by: java.io.IOException: bad message code. Expected: 10 actual: 18
&gt;&gt; at com.basho.riak.pbc.RiakConnection.receive(RiakConnection.java:126)
&gt;&gt; at com.basho.riak.pbc.RiakClient.processFetchReply(RiakClient.java:278)
&gt;&gt; at com.basho.riak.pbc.RiakClient.fetch(RiakClient.java:252)
&gt;&gt; at com.basho.riak.pbc.RiakClient.fetch(RiakClient.java:241)
&gt;&gt; at
&gt;&gt; com.basho.riak.client.raw.pbc.PBClientAdapter.fetch(PBClientAdapter.java:156)
&gt;&gt; at
&gt;&gt; com.basho.riak.client.operations.FetchObject$1.call(FetchObject.java:102)
&gt;&gt; at
&gt;&gt; com.basho.riak.client.operations.FetchObject$1.call(FetchObject.java:100)
&gt;&gt; at
&gt;&gt; com.basho.riak.client.cap.DefaultRetrier.attempt(DefaultRetrier.java:72)
&gt;&gt;
&gt;&gt;
&gt;&gt; This crops up periodically, during different operations, and disappears just
&gt;&gt; as mysteriously.
&gt;&gt;
&gt;&gt; Any hint as to what this really means? (For example, is there somewhere I
&gt;&gt; can look up these error codes?)
&gt;&gt;
&gt;&gt; For the record, I'm running Riak 1.1.4 with Java client 1.0.5.
&gt;&gt;
&gt;&gt; Thanks in advance!
&gt;&gt; - Tim
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

