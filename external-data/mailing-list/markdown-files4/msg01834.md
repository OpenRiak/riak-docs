---
title: "Re: Storing Sets in a new backend"
description: ""
project: community
lastmod: 2010-12-21T17:02:52-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01834"
author_name: "Anthony Molinaro"
project_section: "mailinglistitem"
sent_date: 2010-12-21T17:02:52-08:00
---


Hi,

Just wondering if anyone had an opinions on this idea?

Thanks,

-Anthony

On Fri, Dec 17, 2010 at 03:20:58PM -0800, Anthony Molinaro wrote:
&gt; Hi,
&gt; 
&gt; I have a situation where I need to store sets of integers as efficiently
&gt; as possible. In order to do so I was going to implement a custom backend
&gt; and alter the semantics of get/put/delete, such that
&gt; 
&gt; put (K, [{i,V}]) - insert one or more V into list at K
&gt; put (K, [{d,V}]) - delete one or more V from list at K
&gt; get (K) - returns list at K
&gt; delete (K) - delete entire list
&gt; 
&gt; I'll probably keep the lists in sorted order via insertion sort so that
&gt; a quorum read can easily determine equality.
&gt; 
&gt; My backend would probably be a linked in driver which mmaps a file so
&gt; I can keep this stuff as tightly packed in memory as possible.
&gt; 
&gt; We did something similar using just riak\_core for a different system,
&gt; but for that system we had a custom thrift frontend and didn't adhere
&gt; to the riak\_kv api.
&gt; 
&gt; So I was wondering, what sort of issues might I see with this sort of
&gt; use of riak? Is there another way I'm missing which would allow me
&gt; to efficiently do this?
&gt; 
&gt; I expect in the end to have approximately 500 million lists of integers
&gt; with most in the ~10 integer range with a few up to the ~200 integer
&gt; range. Also, I'll probably have a timestamp associated with each
&gt; integer and want to use map-reduce to expire entries which are too old.
&gt; 
&gt; Anway, I realize this might be an odd usage, and I can always fallback
&gt; to what we did before which was a thrift server on top up riak\_core with
&gt; a custom datastore, but I figured if I could use the same API as riak\_kv
&gt; with a custom backend it might save me a little time.
&gt; 
&gt; -Anthony
&gt; 
&gt; -- 
&gt; ------------------------------------------------------------------------
&gt; Anthony Molinaro 

-- 
------------------------------------------------------------------------
Anthony Molinaro 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

