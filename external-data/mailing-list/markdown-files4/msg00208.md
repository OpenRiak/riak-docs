---
title: "Re: 2nd try: How to model this data layout in Riak?"
description: ""
project: community
lastmod: 2010-04-29T11:14:02-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00208"
mailinglist_parent_id: "msg00207"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2010-04-29T11:14:02-07:00
---


Beyond keys not being adjacent due to chashing, you can not retrieve
partial keys like userid:\* and you can not do range queries. None of
the internal data saved is exposed to riak or sorted in any way.

All your indexing has to be add-on.

On 2010-04-29, Mark Jones  wrote:
&gt; If I wanted to build an e-mail system for millions of users, how would I go
&gt; about doing it in Riak?
&gt;
&gt;
&gt;
&gt; Let's say each e-mail has the following characteristics, to, sender, header,
&gt; body, when, attachments. Every user is identified by a userid, and to is not
&gt; necessarily the same thing as userid.
&gt;
&gt;
&gt;
&gt; In addition to the above characteristics, the user would be allowed to place
&gt; tags and flags on various e-mails in a user interface.
&gt;
&gt;
&gt;
&gt; In Cassandra could model this in two ways, one using super columns, which
&gt; I've been advised against, and another using the order preserving
&gt; partitioner where the key is made up something like: userid:convo-id:when.
&gt; Then I can get a range to bring all of those messages up at one time.
&gt;
&gt;
&gt;
&gt; The idea of a convo-id is similar to gmails conversation grouping of emails.
&gt;
&gt;
&gt;
&gt; With distributed key structure of riak, I'm not sure how to pull this off.
&gt; Since the keys are all consistently hashed, the users information never be
&gt; adjacent to each other and pulling up a group of messages will result in
&gt; lots of seeks.
&gt;
&gt;

-- 
Sent from my mobile device

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

