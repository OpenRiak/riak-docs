---
title: "Re: get and put operations are slow on Riak KV cluster"
description: ""
project: community
lastmod: 2016-06-14T10:55:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17473"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2016-06-14T10:55:22-07:00
---


Hello Abhinav,

Have you followed all of our suggested tuning in this document?

http://docs.basho.com/riak/kv/2.1.4/using/performance/

Specifically, these settings may help a lot in your environment:

http://docs.basho.com/riak/kv/2.1.4/using/performance/#optional-i-o-settings


--
Luke Bakken
Engineer
lbak...@basho.com


On Mon, Jun 13, 2016 at 12:00 AM, Abhinav Tripathi
 wrote:
&gt; Hi,
&gt; I am seeing quite slow get and put operations on our Riak KV cluster. We are
&gt; new to Riak and have tried to follow the instructions in the documentation.
&gt; It would be great if you could take a look and let us know what are we doing
&gt; wrong.
&gt;
&gt; We are using Riak as a distributed cache for our application. The 95th
&gt; percentile (and above) get operations are &gt;10ms. Similarly, 99th and above
&gt; percentile for put operations is getting close to 10ms. Ideally, we want the
&gt; 99% gets to stay around 1ms and 99% puts to stay &lt;5ms.
&gt;
&gt; I have attached the configurations for all 3 nodes in our cluster. Also,
&gt; attached are recent console.log files. I have attached a recent one-minute
&gt; stats file as well from which the below values are.
&gt;
&gt; GETs
&gt; "node\_get\_fsm\_time\_100": 71429,
&gt; "node\_get\_fsm\_time\_95": 16551,
&gt; "node\_get\_fsm\_time\_99": 27513,
&gt; "node\_get\_fsm\_time\_mean": 4393,
&gt; "node\_get\_fsm\_time\_median": 989
&gt;
&gt; PUTs
&gt; "node\_put\_fsm\_time\_100": 10785,
&gt; "node\_put\_fsm\_time\_95": 2679,
&gt; "node\_put\_fsm\_time\_99": 7800,
&gt; "node\_put\_fsm\_time\_mean": 1752,
&gt; "node\_put\_fsm\_time\_median": 1608
&gt;
&gt; I have recorded many one-minute stats for our cluster. Most of them for the
&gt; past couple of days show high values like these.
&gt;
&gt; All three Riak nodes are 4-core, 16GB RAM, 128 GB SSD machines ... basically
&gt; m3.xlarge AWS instances.
&gt;
&gt; Also, I can see many such lines in the console.log,
&gt;
&gt; 2016-06-13 00:03:32.545 [info] &lt;0.23701.3269&gt; Merged
&gt; {["/apps/riak/lib/bitcask/502391187832497878132516661246222288006726811648/75.bitcask.data","/apps/riak/lib/bitcask/502391187832497878132516661246222288006726811648/76.bitcask.data","/apps/riak/lib/bitcask/502391187832497878132516661246222288006726811648/77.bitcask.data","/apps/riak/lib/bitcask/502391187832497878132516661246222288006726811648/78.bitcask.data"],[]}
&gt; in 596.530484 seconds.
&gt;
&gt; These merge operations are usually taking close to 600 seconds. Could that
&gt; be a problem as well?
&gt;
&gt; Thanks,
&gt; Abhinav.
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

