---
title: "Re: riak 2.0 erlang client issue"
description: ""
project: community
lastmod: 2014-03-21T13:14:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13868"
mailinglist_parent_id: "msg13864"
author_name: "Buri Arslon"
project_section: "mailinglistitem"
sent_date: 2014-03-21T13:14:45-07:00
---


Thanks, Sean!

It was because riak\_pb wasn't installed correctly. My server is a vanilla
Ubuntu 12.04. I had to install these packages to build riak\_bf:

protobuf &gt; 2.5.0
python-setuptools
maven2

After building it, riak started working.

One note: even riak\_pb says BUILD SUCCESSFUL, it ended with error. I'm not
sure if it is only my server related or not:

[INFO] Installing
com/basho/riak/protobuf/riak-pb/2.0.0.12-SNAPSHOT/riak-pb-2.0.0.12-SNAPSHOT.jar

[INFO] Writing OBR metadata

[INFO]
------------------------------------------------------------------------

[INFO] BUILD SUCCESSFUL

[INFO]
------------------------------------------------------------------------

[INFO] Total time: 56 seconds

[INFO] Finished at: Fri Mar 21 19:56:41 UTC 2014

[INFO] Final Memory: 37M/96M

[INFO]
------------------------------------------------------------------------

==&gt; C (compile)

make: \*\*\* [PROTOC-exists] Error 1







On Fri, Mar 21, 2014 at 8:58 AM, Sean Cribbs  wrote:

&gt; Buri,
&gt;
&gt; riak\_pb\_messages is a module generated by rebar at build time. Do you have
&gt; the latest riak\_pb dependency? How did you build the client?
&gt;
&gt;
&gt; On Fri, Mar 21, 2014 at 9:44 AM, Buri Arslon  wrote:
&gt;
&gt;&gt; Hi guys!
&gt;&gt;
&gt;&gt; I'm playing with Riak 2.0 pre15. I also updated riakc-erlang-client to
&gt;&gt; the latest. I'm getting an error. Any hints? Thanks!
&gt;&gt;
&gt;&gt;
&gt;&gt; ERROR:
&gt;&gt;
&gt;&gt; -------------------------------------------
&gt;&gt;
&gt;&gt; (main@abc)5&gt; {ok, Pid} = riakc\_pb\_socket:start\_link("127.0.0.1", 8087).
&gt;&gt;
&gt;&gt; {ok,&lt;0.255.0&gt;}
&gt;&gt;
&gt;&gt; (main@abc)6&gt; riakc\_pb\_socket:ping(Pid).
&gt;&gt;
&gt;&gt;
&gt;&gt; =ERROR REPORT==== 21-Mar-2014::14:37:40 ===
&gt;&gt;
&gt;&gt; \*\* Generic server &lt;0.255.0&gt; terminating
&gt;&gt;
&gt;&gt; \*\* Last message in was {req,rpbpingreq,60000}
&gt;&gt;
&gt;&gt; \*\* When Server state == {state,"127.0.0.1",8087,false,false,#Port&lt;0.7205&gt;,
&gt;&gt;
&gt;&gt; false,gen\_tcp,undefined,
&gt;&gt;
&gt;&gt; {[],[]},
&gt;&gt;
&gt;&gt;
&gt;&gt; 1,[],infinity,undefined,undefined,undefined,
&gt;&gt;
&gt;&gt; undefined,[],100}
&gt;&gt;
&gt;&gt; \*\* Reason for termination ==
&gt;&gt;
&gt;&gt; \*\* {'module could not be loaded',
&gt;&gt;
&gt;&gt; [{riak\_pb\_messages,msg\_code,[rpbpingreq],[]},
&gt;&gt;
&gt;&gt;
&gt;&gt; {riak\_pb\_codec,encode,1,[{file,"src/riak\_pb\_codec.erl"},{line,73}]},
&gt;&gt;
&gt;&gt; {riakc\_pb\_socket,encode\_request\_message,1,
&gt;&gt;
&gt;&gt; [{file,"src/riakc\_pb\_socket.erl"},{line,2094}]},
&gt;&gt;
&gt;&gt; {riakc\_pb\_socket,send\_request,2,
&gt;&gt;
&gt;&gt; [{file,"src/riakc\_pb\_socket.erl"},{line,2077}]},
&gt;&gt;
&gt;&gt; {riakc\_pb\_socket,handle\_call,3,
&gt;&gt;
&gt;&gt; [{file,"src/riakc\_pb\_socket.erl"},{line,1258}]},
&gt;&gt;
&gt;&gt; {gen\_server,handle\_msg,5,[{file,"gen\_server.erl"},{line,585}]},
&gt;&gt;
&gt;&gt; {proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
&gt;&gt;
&gt;&gt;
&gt;&gt; =CRASH REPORT==== 21-Mar-2014::14:37:40 ===
&gt;&gt;
&gt;&gt; crasher:
&gt;&gt;
&gt;&gt; initial call: riakc\_pb\_socket:init/1
&gt;&gt;
&gt;&gt; pid: &lt;0.255.0&gt;
&gt;&gt;
&gt;&gt; registered\_name: []
&gt;&gt;
&gt;&gt; exception exit: {undef,
&gt;&gt;
&gt;&gt; [{riak\_pb\_messages,msg\_code,[rpbpingreq],[]},
&gt;&gt;
&gt;&gt; {riak\_pb\_codec,encode,1,
&gt;&gt;
&gt;&gt; [{file,"src/riak\_pb\_codec.erl"},{line,73}]},
&gt;&gt;
&gt;&gt; {riakc\_pb\_socket,encode\_request\_message,1,
&gt;&gt;
&gt;&gt;
&gt;&gt; [{file,"src/riakc\_pb\_socket.erl"},{line,2094}]},
&gt;&gt;
&gt;&gt; {riakc\_pb\_socket,send\_request,2,
&gt;&gt;
&gt;&gt;
&gt;&gt; [{file,"src/riakc\_pb\_socket.erl"},{line,2077}]},
&gt;&gt;
&gt;&gt; {riakc\_pb\_socket,handle\_call,3,
&gt;&gt;
&gt;&gt;
&gt;&gt; [{file,"src/riakc\_pb\_socket.erl"},{line,1258}]},
&gt;&gt;
&gt;&gt; {gen\_server,handle\_msg,5,
&gt;&gt;
&gt;&gt; [{file,"gen\_server.erl"},{line,585}]},
&gt;&gt;
&gt;&gt; {proc\_lib,init\_p\_do\_apply,3,
&gt;&gt;
&gt;&gt; [{file,"proc\_lib.erl"},{line,239}]}]}
&gt;&gt;
&gt;&gt; in function gen\_server:terminate/6 (gen\_server.erl, line 744)
&gt;&gt;
&gt;&gt; ancestors: [&lt;0.252.0&gt;]
&gt;&gt;
&gt;&gt; messages: []
&gt;&gt;
&gt;&gt; links: [&lt;0.252.0&gt;,#Port&lt;0.7205&gt;]
&gt;&gt;
&gt;&gt; dictionary: []
&gt;&gt;
&gt;&gt; trap\_exit: false
&gt;&gt;
&gt;&gt; status: running
&gt;&gt;
&gt;&gt; heap\_size: 987
&gt;&gt;
&gt;&gt; stack\_size: 27
&gt;&gt;
&gt;&gt; reductions: 540
&gt;&gt;
&gt;&gt; neighbours:
&gt;&gt;
&gt;&gt; neighbour: [{pid,&lt;0.252.0&gt;},
&gt;&gt;
&gt;&gt; {registered\_name,[]},
&gt;&gt;
&gt;&gt; {initial\_call,{erlang,apply,2}},
&gt;&gt;
&gt;&gt; {current\_function,{gen,do\_call,4}},
&gt;&gt;
&gt;&gt; {ancestors,[]},
&gt;&gt;
&gt;&gt; {messages,[]},
&gt;&gt;
&gt;&gt; {links,[&lt;0.33.0&gt;,&lt;0.255.0&gt;]},
&gt;&gt;
&gt;&gt; {dictionary,[]},
&gt;&gt;
&gt;&gt; {trap\_exit,false},
&gt;&gt;
&gt;&gt; {status,waiting},
&gt;&gt;
&gt;&gt; {heap\_size,233},
&gt;&gt;
&gt;&gt; {stack\_size,36},
&gt;&gt;
&gt;&gt; {reductions,1895}]
&gt;&gt;
&gt;&gt; \*\* exception exit: undef
&gt;&gt;
&gt;&gt; in function riak\_pb\_messages:msg\_code/1
&gt;&gt;
&gt;&gt; called as riak\_pb\_messages:msg\_code(rpbpingreq)
&gt;&gt;
&gt;&gt; in call from riak\_pb\_codec:encode/1 (src/riak\_pb\_codec.erl, line 73)
&gt;&gt;
&gt;&gt; in call from riakc\_pb\_socket:encode\_request\_message/1
&gt;&gt; (src/riakc\_pb\_socket.erl, line 2094)
&gt;&gt;
&gt;&gt; in call from riakc\_pb\_socket:send\_request/2
&gt;&gt; (src/riakc\_pb\_socket.erl, line 2077)
&gt;&gt;
&gt;&gt; in call from riakc\_pb\_socket:handle\_call/3 (src/riakc\_pb\_socket.erl,
&gt;&gt; line 1258)
&gt;&gt;
&gt;&gt; in call from gen\_server:handle\_msg/5 (gen\_server.erl, line 585)
&gt;&gt;
&gt;&gt; in call from proc\_lib:init\_p\_do\_apply/3 (proc\_lib.erl, line 239)
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; Sean Cribbs 
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

