---
title: "Re: riak-2.0.0 preview refuses to start when nodename is changed to	the ip or hostname of the machine"
description: ""
project: community
lastmod: 2014-01-16T15:25:22-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13396"
mailinglist_parent_id: "msg13395"
author_name: "Hector Castro"
project_section: "mailinglistitem"
sent_date: 2014-01-16T15:25:22-08:00
---


Hi John,

Did you start this Riak instance successfully with `riak@127.0.0.1`
before changing `nodename`? If you did, changing the `nodename` can
cause a failure similar to what you're seeing.

&gt;From here your options are:

1. Discard the existing ring metadata by removing the contents of the
ring directory. This will require rejoining all nodes into a cluster
again.
2. Rename the node using the riak-admin cluster replace command. This
will not work if you have previously only started riak with a single
node.

More details on this (although it references the &lt; 2.0 configuration
file format) can be found here:

http://docs.basho.com/riak/latest/ops/building/basic-cluster-setup/

--
Hector


On Thu, Jan 16, 2014 at 3:11 PM, John Shen  wrote:
&gt; i downloaded riak-2.0.0pre5-1.el6.x86\_64.rpm
&gt; riak node starts fine with
&gt;
&gt; ## Name of the riak node
&gt; # this fails
&gt; #nodename = riak@myhost.mydomain
&gt; #this works
&gt; #nodename = riak@127.0.0.1
&gt; #this also fails
&gt; nodename = riak@10.10.10.10
&gt;
&gt; the riak processes seem to start still despite the FAILED message, but
&gt; riak-admin says node is not running.
&gt;
&gt; this is RHEL 6
&gt;
&gt; thanks for any hint as how to debug
&gt;
&gt; Starting riak: riak failed to start within 15 seconds,
&gt; see the output of 'riak console' for more information.
&gt; If you want to wait longer, set the environment variable
&gt; WAIT\_FOR\_ERLANG to the number of seconds to wait.
&gt; [FAILED]
&gt;
&gt; # ps -ef | grep ria[k]
&gt; riak 28771 1 0 11:53 ? 00:00:00
&gt; /usr/lib64/riak/erts-5.10.3/bin/epmd -daemon
&gt; riak 28779 1 0 11:53 ? 00:00:00
&gt; /usr/lib64/riak/erts-5.10.3/bin/run\_erl -daemon /var/run/riak//
&gt; /var/log/riak exec /usr/sbin/riak console
&gt; riak 28782 28779 2 11:53 pts/1 00:01:36
&gt; /usr/lib64/riak/erts-5.10.3/bin/beam.smp -W w -K true -A 64 -P 256000 --
&gt; -root /usr/lib64/riak -progname riak -- -home /var/lib/riak -- -boot
&gt; /usr/lib64/riak/releases/2.0.0pre5/riak -config
&gt; /var/lib/riak/generated.configs/app.2014.01.16.11.53.05.config -smp enable
&gt; -name riak@10.10.10.10 -setcookie riak -vm\_args
&gt; /var/lib/riak/generated.configs/vm.2014.01.16.11.53.05.args -pa
&gt; /usr/lib64/riak/lib/basho-patches -- console
&gt; riak 28999 28782 0 11:53 ? 00:00:00 sh -s disksup
&gt; riak 29001 28782 0 11:53 ? 00:00:00
&gt; /usr/lib64/riak/lib/os\_mon-2.2.13/priv/bin/memsup
&gt; riak 29002 28782 0 11:53 ? 00:00:00
&gt; /usr/lib64/riak/lib/os\_mon-2.2.13/priv/bin/cpu\_sup
&gt;
&gt; # riak console
&gt; 13:10:15.193 [info] Application lager started on node nonode@nohost
&gt; 13:10:15.193 [info] Checking /etc/riak/app.config exists... false
&gt; 13:10:15.193 [info] Checking /etc/riak/vm.args exists... false
&gt; 13:10:15.193 [info] No app.config or vm.args detected in /etc/riak,
&gt; activating cuttlefish
&gt; 13:10:15.385 [info] Adding Defaults
&gt; 13:10:15.387 [info] Applying Datatypes
&gt; 13:10:15.404 [info] Validation
&gt; 13:10:15.407 [info] Applied 1:1 Mappings
&gt; 13:10:15.408 [info] Applied Translations
&gt; config is OK
&gt; -config /var/lib/riak/generated.configs/app.2014.01.16.13.10.15.config
&gt; -args\_file /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args
&gt; -vm\_args /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args
&gt; Exec: /usr/lib64/riak/erts-5.10.3/bin/erlexec -boot
&gt; /usr/lib64/riak/releases/2.0.0pre5/riak -config
&gt; /var/lib/riak/generated.configs/app.2014.01.16.13.10.15.config -args\_file
&gt; /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args -vm\_args
&gt; /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args -pa
&gt; /usr/lib64/riak/lib/basho-patches -- console
&gt; Root: /usr/lib64/riak
&gt; Erlang R16B02-basho3 (erts-5.10.3) [source] [64-bit] [smp:2:2]
&gt; [async-threads:64] [kernel-poll:true]
&gt;
&gt; Eshell V5.10.3 (abort with ^G)
&gt; (riak@10.10.10.10)1&gt;
&gt;
&gt; not sure how to proceed at this point.
&gt;
&gt; Thanks!
&gt;
&gt; John Shen
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

