---
title: "Re: riak-python-client2, a rewrite of the official client"
description: ""
project: community
lastmod: 2012-03-15T11:08:20-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06970"
mailinglist_parent_id: "msg06936"
author_name: "Armon Dadgar"
project_section: "mailinglistitem"
sent_date: 2012-03-15T11:08:20-07:00
---


&gt; Message: 4
&gt; Date: Thu, 15 Mar 2012 11:13:03 -0400
&gt; From: Shuhao Wu 
&gt; To: "Andrey V. Martyanov" 
&gt; Cc: riak-users@lists.basho.com
&gt; Subject: Re: riak-python-client2, a rewrite of the official client
&gt; Message-ID:
&gt; 
&gt; Content-Type: text/plain; charset=ISO-8859-1
&gt; 
&gt; I'm looked into just modifying and contributing to the existing library, and
&gt; found several issues with it. Here's my main motivation for a rewrite:
&gt; 
&gt; ? 1. The current structure riak-python-client is somewhat messy. Everything
&gt; depends on each other. Just look at things like RiakLink and
&gt; RiakIndexEntry.
&gt; They're unnecessary and overcomplicates the code. Furthermore, if you look
&gt; the transports, it's very much dependent on things like RiakObject, and
&gt; RiakObject is pretty much nothing without the transport. It's almost like 
&gt; a
&gt; circular dependency. So instead, I redesigned the transports to operate
&gt; independently from things like RiakObject. To do this, simply modifying
&gt; is not feasible and it will result in an almost complete rewrite anyway 
&gt; due
&gt; to the dependencies problems I described.
&gt; 2. There's a lot of "bloat" in the current riak-python-client. A simple
&gt; example would be get\_ and set\_, as well as things like RiakLink and
&gt; RiakIndexEntry. To get rid of those would pretty much require a rewrite as
&gt; well.
&gt; 3. Basho currently do not have a dedicated python developer working on this.
&gt; I don't know this for sure but I think their resources, in terms
&gt; of clients,
&gt; go mainly to java, ruby and javascript, though that's just my 
&gt; observations.
&gt; 
&gt; My primary goal of having a rewrite is hopefully simplify the code base as 
&gt; well
&gt; as improve some aspects of the python client (such as not using deprecated
&gt; functions such as apply) and (hopefully) increase the speed of the client.
&gt; After examining the code (which I had to do while rewriting), I don't think
&gt; simply modifying the current codebase could fix its issues (there are more
&gt; issues then what I've stated), and I don't think it will take as long as 
&gt; people
&gt; think. The current code base has about 4k lines of python and 0.5k lines of
&gt; Erlang. In my client, a chunk of the code actually comes from the original
&gt; client as they work with a few adaptations.
&gt; 
&gt; As far as road map goes, I'm currently just rewriting all the functionalities
&gt; provided by the current python client, and here's a list of things that Sean
&gt; would like to see accomplished, which I will work on once I have all the
&gt; functionalities of the current client complete:
&gt; 
&gt; https://gist.github.com/1959278
&gt; 
&gt; I hope I've answered all the questions. If there is any more 
&gt; questions/comments,
&gt; feel free to shoot it my way.
&gt; 
&gt; Shuhao
&gt; 

I agree that the Python client does need some work to clean it up,
and make it more idiomatic Python, but I'm not sure that a total rewrite
is necessary.

Most of the abstractions are good, but they just need a bit of cleanup.
I think there is always a tendency to assume things are unnecessarily messy,
but once you get to rewriting it you end up running into the pain points that
drove those design decisions.

If there is interest, we could just formulate a roadmap for the a set of 
breaking
changes to the existing client, and release it as a new version of the same 
project.

Things I would like to see:
 \* Cleanup the transport interface
 \* RiakObject needs to be simplified
 \* Support a RiakJSONObject subclass which has the encoding logic that is 
inside RiakObject now
 \* Indexes need to be cleaned up
 \* MapReduce interfaces feel a bit dirty
 \* Much improved exception hierarchy
 \* RiakClient / RiakBucket interface needs to cleaned up

Best Regards,

Armon Dadgar





\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

