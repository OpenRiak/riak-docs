---
title: "Re: cannot query bucket when a node is down"
description: ""
project: community
lastmod: 2010-06-01T11:05:36-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00479"
mailinglist_parent_id: "msg00478"
author_name: "Justin Sheehy"
project_section: "mailinglistitem"
sent_date: 2010-06-01T11:05:36-07:00
---


On Tue, Jun 1, 2010 at 1:56 PM, Sam Tingleff  wrote:

&gt; With no single point of failure there is no single index of keys. So
&gt; the only way to get an exhaustive list of keys in a given bucket is to
&gt; ask all nodes (I do not know if this is what riak is actually doing).

Sam is exactly right that Riak doesn't centralize anything and so
there is no collected index of keys.

However, you don't quite have to ask every node; you have to ask
enough nodes to know that you hit at least one replica of every
object. This is what listing keys (GET /bucket) does. There was a
bug that just recently got fixed that could in some cases cause the
whole listing to hang up due to a single misbehaving or down node,
depending on timing. This fix was placed in tip this morning and the
fix will go out in the next release.

As long as you have enough nodes around that you could get every
object in the cluster using R=1, you should be able to list the keys
in a bucket.

-Justin

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

