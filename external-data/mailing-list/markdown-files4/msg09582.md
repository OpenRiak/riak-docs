---
title: "I can't show a pdf from webmachine"
description: ""
project: community
lastmod: 2012-12-14T11:47:30-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09582"
author_name: "Julio Cesar RÃ­os Gutierrez"
project_section: "mailinglistitem"
sent_date: 2012-12-14T11:47:30-08:00
---


My source do not show a pdf in my page everything else is fine,

This is the source code:

==============================================================
-module(rptPedidos\_resource).

-export([init/1, allowed\_methods/2, process\_post/2]).
-export([content\_types\_provided/2]).
-export([to\_json/2, json\_body/1]).

-include\_lib("webmachine/include/webmachine.hrl").

%%init([]) -&gt; {ok, undefined}.
init(Config)-&gt;
{{trace, "/tmp"}, Config}.

allowed\_methods ( RD, Ctx )-&gt;
{['POST','GET','HEAD'], RD, Ctx}.

%%content\_types\_provided ( RD, Ctx )-&gt;
%% {[{"application/json",to\_json}],RD,Ctx}.

content\_types\_provided ( RD, Ctx )-&gt;
{[{"application/pdf",to\_pdf}], RD, Ctx }.

to\_pdf(ReqData, Context)-&gt;
Body = "/root/sicap-rpt/reports/javascript.pdf",
{Body, ReqData, Context}.

to\_json ( RD, Ctx )-&gt;
{json\_body (wrq:req\_qs(RD)), RD, Ctx}.

process\_post ( RD, Ctx )-&gt;
Data = mochiweb\_util:parse\_qs ( wrq:req\_body ( RD ) ),
Struct = mochijson2:decode ( proplists:get\_value ( "json", Data ) ),
Struct2 = proplists:get\_value ( "json", Data ),
{struct, [{&lt;&lt;"nombre"&gt;&gt;, Nombre }]} = Struct,
RD1 = wrq:set\_resp\_header("Content-Type","application/pdf", RD ),
Ans = "attachment;filename=/root/sicap-rpt/reports/javascript.pdf",
RD2 = wrq:append\_to\_resp\_body ( Ans, RD1 ),
{true, RD2,Ctx}.

json\_body ( QS )-&gt;
mochijson:encode ( { struct, QS } ).


===============================================================

any ideas why is wrong?

-- 
JCesar
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

