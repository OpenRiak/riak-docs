---
title: "riak crash"
description: ""
project: community
lastmod: 2016-02-22T02:14:39-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17040"
author_name: "Raviraj Vaishampayan"
project_section: "mailinglistitem"
sent_date: 2016-02-22T02:14:39-08:00
---


Hi,

We have been using riak to gather our test data and analyze results after test 
completes.
Recently we have observed riak crash in riak console logs.
This causes our tests failing to record data to riak and bailing out :-(

The crash logs are as follow:
2016-02-19 16:25:26.255 [error] &lt;0.2160.0&gt; gen\_fsm &lt;0.2160.0&gt; in state active 
terminated with reason: no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195

2016-02-19 16:25:26.260 [error] &lt;0.2160.0&gt; CRASH REPORT Process &lt;0.2160.0&gt; with 
2 neighbours exited with reason: no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195 in gen\_fsm:terminate/7 line 622

2016-02-19 16:25:26.260 [error] &lt;0.172.0&gt; Supervisor riak\_core\_vnode\_sup had 
child undefined started with {riak\_core\_vnode,start\_link,undefined} at 
&lt;0.2160.0&gt; exit with reason no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195 in context child\_terminated

2016-02-19 16:25:26.261 [error] &lt;0.4319.0&gt; gen\_fsm &lt;0.4319.0&gt; in state ready 
terminated with reason: no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195

2016-02-19 16:25:26.275 [error] &lt;0.4319.0&gt; CRASH REPORT Process &lt;0.4319.0&gt; with 
10 neighbours exited with reason: no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195 in gen\_fsm:terminate/7 line 622

2016-02-19 16:25:26.278 [error] &lt;0.4320.0&gt; Supervisor {&lt;0.4320.0&gt;,poolboy\_sup} 
had child riak\_core\_vnode\_worker started with 
riak\_core\_vnode\_worker:start\_link([{worker\_module,riak\_core\_vnode\_worker},{worker\_args,[268322566228720457638957762256505085639956365312,...]},...])
 at undefined exit with reason no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195 in context shutdown\_error

2016-02-19 16:25:26.278 [error] &lt;0.4320.0&gt; gen\_server &lt;0.4320.0&gt; terminated 
with reason: no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195

2016-02-19 16:25:26.278 [error] &lt;0.4320.0&gt; CRASH REPORT Process &lt;0.4320.0&gt; with 
0 neighbours exited with reason: no function clause matching 
riak\_kv\_vnode:handle\_info({#Ref&lt;0.0.482.161540&gt;,{ok,&lt;0.11042.842&gt;}}, 
{state,268322566228720457638957762256505085639956365312,riak\_kv\_eleveldb\_backend,true,{state,&lt;&lt;&gt;&gt;,...},...})
 line 1195 in gen\_server:terminate/6 line 744

2016-02-19 16:25:26.806 [error] &lt;0.2157.0&gt; gen\_fsm &lt;0.2157.0&gt; in state active 
terminated with reason: {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}}

2016-02-19 16:25:26.808 [error] &lt;0.2157.0&gt; CRASH REPORT Process &lt;0.2157.0&gt; with 
2 neighbours exited with reason: {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}} 
in gen\_fsm:terminate/7 line 600

2016-02-19 16:25:26.809 [error] &lt;0.5450.0&gt; gen\_fsm &lt;0.5450.0&gt; in state ready 
terminated with reason: {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}}

2016-02-19 16:25:26.809 [error] &lt;0.172.0&gt; Supervisor riak\_core\_vnode\_sup had 
child undefined started with {riak\_core\_vnode,start\_link,undefined} at 
&lt;0.2157.0&gt; exit with reason {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}} in 
context child\_terminated

2016-02-19 16:25:26.809 [error] &lt;0.5450.0&gt; CRASH REPORT Process &lt;0.5450.0&gt; with 
10 neighbours exited with reason: {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}} 
in gen\_fsm:terminate/7 line 622

2016-02-19 16:25:26.809 [error] &lt;0.5451.0&gt; Supervisor {&lt;0.5451.0&gt;,poolboy\_sup} 
had child riak\_core\_vnode\_worker started with 
riak\_core\_vnode\_worker:start\_link([{worker\_module,riak\_core\_vnode\_worker},{worker\_args,[211232658520482062396626323478525280184646500352,...]},...])
 at undefined exit with reason {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}} in 
context shutdown\_error

2016-02-19 16:25:26.809 [error] &lt;0.5451.0&gt; gen\_server &lt;0.5451.0&gt; terminated 
with reason: {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}}

2016-02-19 16:25:26.809 [error] &lt;0.5451.0&gt; CRASH REPORT Process &lt;0.5451.0&gt; with 
0 neighbours exited with reason: {timeout,{gen\_server,call,[&lt;0.5141.0&gt;,stop]}} 
in gen\_server:terminate/6 line 744

Our setup is as follow:
We have a riak cluster with 10 nodes, configuration of each node is as follow:
RAM: 48GB
Disk:
 80GB (/)
 504GB (separate riak partition)
Riak Version: 2.1.3-1 (2.1.3)
Data in riak: After observing crash, total data in riak partition was ~50GB

Riak config is as follow:
riak.conf
[Attached with this email]

advanced.config:

[

 {riak\_kv, [{add\_paths, ["/usr/local/lib/scale\_riak/ebin"]}]},

 {webmachine, [{backlog, 511}, {nodelay, true}]},

 {yokozuna, [{solr\_request\_timeout, 120000}]}

].

We have observed this a few times now, and after this crash we observed latency 
increases and our application starts timing out.
We would really like to understand what might be causing this crash and if it 
is something due to missing config on our nodes we would like to fix it.

Thanks for your help in advanced :-)

Regards,
Raviraj


riak.conf
Description: riak.conf
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

