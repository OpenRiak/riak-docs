---
title: "Re: does cluster replace actually replace reip command?"
description: ""
project: community
lastmod: 2012-11-28T08:35:14-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09402"
mailinglist_parent_id: "msg09401"
author_name: "Brian Sparrow"
project_section: "mailinglistitem"
sent_date: 2012-11-28T08:35:14-08:00
---


Hi Eric, 

Reip was deprecated because it had a lot of issues. For reip to work as 
expected you need to take the entire cluster down and run the riak-admin reip 
command on all nodes to reassign the node name in all the ring files. This is 
obviously not what users want.

The 'riak-admin cluster replace' command was added for this reason. The 
procedure to replace one node with another is as follows:

1. Turn on new node, start riak
2. riak-admin cluster join 
3. riak-admin cluster replace  
4. riak-admin cluster plan
5. Confirm pending changes are as expected
6. riak-admin cluster commit
7. The old node will shut down once it has transferred all data to the new node

Aside: The rate of transfer can be tuned via 'riak-admin transfer-limit'

Thanks! 

-- 
Brian Sparrow
Developer Advocate
Basho Technologies

Sent with Sparrow (http://www.sparrowmailapp.com/?sig)


On Wednesday, November 28, 2012 at 11:15 AM, Eric Abbott wrote:

&gt; the riak-admin reip command would appear to allow one to shut down a server, 
&gt; copy all data to a new server, and run riak-admin reip to bring that nodes 
&gt; data back into the cluster on a new server.
&gt; 
&gt; Does that work I just described actually work, and if so, is that 
&gt; functionality supported by riak-admin cluster replace? 
&gt; 
&gt; Thanks,
&gt; 
&gt; Eric 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

