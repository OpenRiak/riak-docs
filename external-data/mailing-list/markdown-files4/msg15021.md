---
title: "Re: serving files from riak-cs to public via url"
description: ""
project: community
lastmod: 2014-10-13T13:20:23-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15021"
mailinglist_parent_id: "msg15020"
author_name: "Michael Grauer"
project_section: "mailinglistitem"
sent_date: 2014-10-13T13:20:23-07:00
---


Thanks Ali.

I now am having a permissions issue it seems in accessing the objects.

I try to curl the object

http://10.x.x.x/test-bucket/pointclouds/4f55ed40ca08aeb57bf19257aa6601e85436ff0684aa2/static/metadata.ini

and I get

xml version="1.0"
encoding="UTF-8"?`AccessDenied`Access
Denied/test-bucket/pointclouds/4f55ed40ca08aeb57bf19257aa6601e85436ff0684aa2/static/metadata.ini


When I request the ACL for this bucket from boto I get:



I would like to not have to set ACLs on each object in my bucket, as I
expect a large number of objects. I tried to set a bucket policy like this:

{
 "Version":"2008-10-17",
 "Statement":[{
 "Sid":"AllowPublicRead",
 "Effect":"Allow",
 "Principal": {
 "AWS": "\*"
 },
 "Action":["s3:GetObject"],
 "Resource":["arn:aws:s3:::test-bucket/\*"
 ]
 }
 ]
}



But this was not accepted by boto or s3cmd . boto told
me boto.exception.S3ResponseError: S3ResponseError: 415 Unsupported Media
Type , but there weren't any errors that I could see in the riak-cs logs.

Can anyone point the way?


Thanks again










On Mon, Oct 13, 2014 at 2:53 PM, Ali Nikkhah 
wrote:

&gt; Hi Mike,
&gt;
&gt; You are trying to resolve a domain name 'test-bucket.10.x.x.x,' which is
&gt; invalid. This is the part that is incorrect. There are a couple options:
&gt;
&gt; 0) You should be able to access the bucket by using
&gt; http://ip/bucket-name, like:
&gt;
&gt; http://10.x.x.x/test-bucket/my\_key\_path
&gt;
&gt; 1) For easier public access, you can then set up a resolvable domain
&gt; name in your DNS configuration for the bucket, i.e. add a dns entry
&gt; like:
&gt;
&gt; test-bucket..com
&gt;
&gt; pointing to the riak-cs proxy ip. As long as your proxy is set up
&gt; properly, you should then be able to access the object using:
&gt;
&gt; http://test-bucket..com/my\_key\_path
&gt;
&gt;
&gt;
&gt; -Ali
&gt;
&gt;
&gt; On Mon, 2014-10-13 at 14:11 -0400, Michael Grauer wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt;
&gt; &gt; I'm very new to Riak-CS, and am investigating using it as a standin
&gt; &gt; for S3. I'd like to have a url that allows an anonymous
&gt; &gt; (unauthenticated) user to download an object from a bucket.
&gt; &gt;
&gt; &gt;
&gt; &gt; Riak 2.0.0-1
&gt; &gt; Riak CS 1.5.0-1
&gt; &gt; Stanchion 1.5.0-1
&gt; &gt; Ubuntu 14.04
&gt; &gt;
&gt; &gt;
&gt; &gt; I have test-bucket set up, and can connect to it, and upload and
&gt; &gt; download a file there all using an authenticated user that owns the
&gt; &gt; bucket, via boto.
&gt; &gt;
&gt; &gt;
&gt; &gt; My Riak CS is running as 10.x.x.x , the internal IP of my AWS
&gt; &gt; instance, and proxied behind nginx.
&gt; &gt;
&gt; &gt;
&gt; &gt; When I try to curl
&gt; &gt;
&gt; &gt;
&gt; &gt; curl -v http://test-bucket.10.x.x.x/my\_key\_path
&gt; &gt;
&gt; &gt;
&gt; &gt; I'm getting "could not resolve host: test-bucket.10.x.x.x"
&gt; &gt;
&gt; &gt;
&gt; &gt; My configuration is incorrect, but I'm uncertain of how to fix it.
&gt; &gt;
&gt; &gt;
&gt; &gt; Any help is appreciated!
&gt; &gt;
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Mike
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

