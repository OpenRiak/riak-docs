---
title: "Re: Read Before Writes on Distributed Counters"
description: ""
project: community
lastmod: 2013-10-17T07:42:27-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12658"
mailinglist_parent_id: "msg12657"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2013-10-17T07:42:27-07:00
---


I have some from a while back, if I can find my graphs I'll put them up 
somewhere.

Cheers

Russell

On 17 Oct 2013, at 16:35, Weston Jossey  wrote:

&gt; Great everyone, thank you. 
&gt; 
&gt; @Russell: I specifically work with either Go 
&gt; (https://github.com/tpjg/goriakpbc) or Ruby (basho client). I haven't tested 
&gt; the ruby client, but I'd assume it will perform the write without the read 
&gt; (based on my reading of the code). The Go library, on the other hand, 
&gt; currently always performs a read prior to the write. It's an easy patch that 
&gt; I've already applied locally for benchmarking, I just didn't want to submit 
&gt; the PR till I was sure this was the correct behavior.
&gt; 
&gt; Somewhat off topic, but I dont' want to open up another thread if it's 
&gt; unnecessary. This questions arose because I've been doing extensive 
&gt; benchmarking around distributed counters. Are there pre-existing benchmarks 
&gt; out there that I can measure myself against? I haven't stumbled across many 
&gt; at this point, probably because of how new it is.
&gt; 
&gt; Cheers,
&gt; Wes
&gt; 
&gt; 
&gt; On Thu, Oct 17, 2013 at 10:21 AM, Russell Brown  wrote:
&gt; Hi Wes,
&gt; 
&gt; The client application does not need to perform a read before a write, the 
&gt; riak server must read from disk before updating the counter. Or at least it 
&gt; must with our current implementation.
&gt; 
&gt; What PRs did you have in mind? I'm curious.
&gt; 
&gt; Oh, it looks like Sam beat me to itâ€¦to elaborate on his "not idempotent" 
&gt; line, that means when riak tells you "error" for some counter increment, it 
&gt; may only be a partial failure, and re-running the operation may lead to over 
&gt; counting.
&gt; 
&gt; Cheers
&gt; 
&gt; Russell
&gt; 
&gt; On 17 Oct 2013, at 16:03, Weston Jossey  wrote:
&gt; 
&gt; &gt; In the context of using distributed counters (introduced in 1.4), is it 
&gt; &gt; strictly necessary to perform a read prior to issue a write for a given 
&gt; &gt; key? A la, if I want to blindly increment a value by 1, regardless of what 
&gt; &gt; its current value is, is it sufficient to issue the write without 
&gt; &gt; previously having read the object?
&gt; &gt;
&gt; &gt; I ask because looking at some of the implementations for counters in the 
&gt; &gt; open source community, it's common to perform a read before a write, which 
&gt; &gt; impacts performance ceilings on clusters with high volume reads / writes. 
&gt; &gt; I want to verify before issuing some PRs that this is in fact safe behavior.
&gt; &gt;
&gt; &gt; Thank you!
&gt; &gt; -Wes Jossey
&gt; &gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt; 
&gt; 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

