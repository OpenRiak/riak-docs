---
title: "riak cluster suddenly became unresponsive"
description: ""
project: community
lastmod: 2013-03-15T03:09:12-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10456"
author_name: "Ingo Rockel"
project_section: "mailinglistitem"
sent_date: 2013-03-15T03:09:12-07:00
---



Hi,

we have a 12 nodes cluster running riak 1.2.1 which went live a week 
ago. Yesterday, suddenly from one minute to another the put\_fsm\_time\_95 
and the get\_fsm\_time\_95 raised from something below 100ms up to several 
seconds. This went on for about 25 min and than went away.


Checking the riak-logs of the nodes, I find a lot of these:

2013-03-14 17:48:06.388 [info] 
&lt;0.62.0&gt;@riak\_core\_sysmon\_handler:handle\_event:89 Monitor got 
{suppressed,port\_events,1}
2013-03-14 17:48:06.889 [info] 
&lt;0.62.0&gt;@riak\_core\_sysmon\_handler:handle\_event:85 monitor busy\_dist\_port 
&lt;0.7156.1&gt; 
[{initial\_call,{riak\_core\_vnode,init,1}},{almost\_current\_function,{erlang,bif\_return\_trap,1}},{message\_queue\_len,1}] 
{#Port&lt;0.9083226&gt;,'riak@172.22.3.22'}


This messages are logged all day, but only once every few minutes but in 
the problematic time frame between 17:45 and 18:17 it gets logged 
several times every second. The node ip differs though, but it seems 
only three nodes were involved.


Except of these three nodes the cpu utilisation drops by half during 
this on all other nodes. On the three nodes there's only a slight drop.


We are using leveldb as storage backend. I also checked some of the LOG 
files of leveldb and there are compactions logged, but these are logged 
all the day every few hours.


In this time our software was quite unresponsive too so I would like to 
know what was causing this and what I might do to stop. Any ideas, hints?


I found this:

https://groups.google.com/forum/?fromgroups=#!topic/nosql-databases/GqbaeiKCSYE

where Jon Meredith suggests to raise the buffer size to get rid of the 
busy buffers by adding +zdbbl 16384 to the vm.args file. Might this help?


Regards,

 Ingo
--
Software Architect

Blue Lion mobile GmbH
Tel. +49 (0) 221 788 797 14
Fax. +49 (0) 221 788 797 19
Mob. +49 (0) 176 24 87 30 89

ingo.roc...@bluelionmobile.com
&gt;&gt;&gt; qeep: Hefferwolf

www.bluelionmobile.com
www.qeep.net

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

