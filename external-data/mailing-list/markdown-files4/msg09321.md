---
title: "MapReduce queries fail while node is starting"
description: ""
project: community
lastmod: 2012-11-14T09:04:54-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09321"
author_name: "Nico Meyer"
project_section: "mailinglistitem"
sent_date: 2012-11-14T09:04:54-08:00
---



Hi,

since we upgraded our riak cluster from 0.14 to 1.2, we see MapReduce 
queries failing while any of the nodes is starting but not yet ready 
(that is while the 'Waiting for service riak\_kv' message still appears 
in the logs).
This is quite problematic, since it takes almost 50 minutes for the node 
to read the bitcask keydir:

 [info] Wait complete for service riak\_kv (3117 seconds)

The following errors appear in the log of the node that handles the 
MapReduce query:


2012-11-14 17:49:57.660 [error] emulator Error in process &lt;0.32658.1777&gt; 
on node 'riak@172.20.1.11' with exit value: 
{{badmatch,{'EXIT',timeout}},[{riak\_core\_vnode\_proxy,call,2,[{file,"src/riak\_core\_vnode\_proxy.erl"},{line,52}]},{riak\_pipe\_vnode,queue\_work\_send,4,[{file,"src/riak\_pipe\_vnode.erl"},{line,331}]},{riak\_pipe\_vnode,queue\_work\_erracc... 

2012-11-14 17:49:57.798 [error] &lt;0.258.0&gt; Supervisor 
riak\_pipe\_builder\_sup had child undefined started with 
{riak\_pipe\_builder,start\_link,undefined} at &lt;0.32653.1777&gt; exit with 
reason no match of right hand value {'EXIT',timeout} in 
riak\_core\_vnode\_proxy:call/2 line 52 in context child\_terminated



and this error appears in the log of the node that is still starting up:

[error] Pipe worker startup failed:fitting was gone before startup


Is this a known issue or something we are doing wrong?

Thanks for your help!

Cheers,
Nico


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

