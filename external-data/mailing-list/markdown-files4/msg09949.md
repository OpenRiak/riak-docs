---
title: "Re: Ripple queries illuminated?"
description: ""
project: community
lastmod: 2013-01-31T10:41:44-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09949"
mailinglist_parent_id: "msg09944"
author_name: "John Daily"
project_section: "mailinglistitem"
sent_date: 2013-01-31T10:41:44-08:00
---


Can you clarify: are you referring to link walking or key retrievals?

In either case, if you have a bucket and key that you believe is tied to bad 
data on one of your nodes, you could do something like the following.

First, run riak-admin to generate a full set of cluster details:

$ riak-admin cluster-info /tmp/my-cluster.txt

Then, sift through the resulting data set for all of the HTTP endpoints. The 
following one-liner might work, depending on the vagaries of regex support in 
your tools.

Replace  and  with the relevant data. The output, if this works, 
is a shell script which you can run to query each vnode for that bucket/key 
combination.

$ egrep '^\s\*{http,' /tmp/my-cluster.txt | sed -E 's/ +//g' | sort | uniq | sed 
's/.\*{//' | sed 's/}.\*//' | sed 's/"//g' | awk 'BEGIN { FS="," } { print "curl 
-v http://" $1 ":" $2 "/riak//" }' &gt; /tmp/runme.sh

The goal is to pick out all occurrences of "{http," from the cluster 
information file and run:

curl -v http://:/riak//

-John Daily
Technical Evangelist
Basho


On Jan 31, 2013, at 12:16 PM, Martin Streicher 
 wrote:

&gt; How can I find the queries that Ripple generates? I need to track down an 
&gt; issue in production -- at least one machine is producing bad results. I need 
&gt; to be able to run the query(ies) that Ripple generates directly on each node 
&gt; to narrow. 
&gt; 
&gt; Martin
&gt; 
&gt; 
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

