---
title: "Re: documentation for allow_mult=false"
description: ""
project: community
lastmod: 2011-11-03T17:57:28-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05440"
mailinglist_parent_id: "msg05424"
author_name: "Mark Phillips"
project_section: "mailinglistitem"
sent_date: 2011-11-03T17:57:28-07:00
---


On Wed, Nov 2, 2011 at 11:58 AM, Jeremiah Peschka
 wrote:
&gt; Please add this explanation to the wiki. I'd do it, but i'm working with an 
&gt; RDBMS right now and I am neither distributed nor eventually consistent.
&gt; ---

Opened a new issue to make sure this content finds its way there.

https://github.com/basho/riak\_wiki/issues/212

Mark

&gt; Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
&gt; Microsoft SQL Server MVP
&gt;
&gt; On Nov 2, 2011, at 8:18 AM, Ryan Zezeski wrote:
&gt;
&gt;&gt; On Tue, Nov 1, 2011 at 5:51 PM, Justin Karneges  wrote:
&gt;&gt; Are you saying that allow\_mult=false + last\_write\_win=false is the same as
&gt;&gt; allow\_mult=false + last\_write\_win=true ?
&gt;&gt;
&gt;&gt; False/false may be the default behavior, but I want to know what that 
&gt;&gt; behavior
&gt;&gt; is. :)
&gt;&gt;
&gt;&gt;
&gt;&gt; Justin,
&gt;&gt;
&gt;&gt; No, last\_write\_wins=true doesn't care about the value of allow\_mult.  Only 
&gt;&gt; one should be true at the same time, and the default is to have both set to 
&gt;&gt; false.  Perhaps making an imaginary setting to displace these two would 
&gt;&gt; help.  Lets call this imaginary setting "conflict\_resolution\_method" which 
&gt;&gt; can take on the three mutually exclusive values "stomp", "most\_recent" and 
&gt;&gt; "siblings".
&gt;&gt;
&gt;&gt; stomp - overwrite the current value with the new value regardless of vector 
&gt;&gt; clocks, just mutate the value with no regard, thus "stomp"
&gt;&gt;
&gt;&gt; most\_recent - use vclocks to monitor for conflicts, create siblings, and 
&gt;&gt; pick the most recent write when a conflict does occur (i.e. let Riak handle 
&gt;&gt; the conflict for you based on time)
&gt;&gt;
&gt;&gt; siblings - use vclocks to monitor for conflicts, create siblings, and return 
&gt;&gt; the siblings to the client when a conflict occurs for it to be resolved by 
&gt;&gt; some application dependent logic
&gt;&gt;
&gt;&gt; Now lets map my imaginary field to the actual fields
&gt;&gt;
&gt;&gt; stomp = last\_write\_wins=true + allow\_mult=false
&gt;&gt;
&gt;&gt; most\_recent = last\_write\_wins=false + allow\_mult=false
&gt;&gt;
&gt;&gt; siblings = last\_write\_wins=false + allow\_mult=true
&gt;&gt;
&gt;&gt; Notice that setting both to true has undefined semantics as they are 
&gt;&gt; necessarily mutually exclusive.
&gt;&gt;
&gt;&gt; Also notice that stomp and most\_recent might seem like the same thing on the 
&gt;&gt; surface but they may have different outcomes in different situations.  For 
&gt;&gt; example, stomp would prove to be non-deterministic during the healing of a 
&gt;&gt; split-brain because it will depend on the order of the hinted handoff 
&gt;&gt; transfers.  Honestly, you're best avoiding last\_write\_wins at this point 
&gt;&gt; because it can cause non-obvious behavior and there is potential it may be 
&gt;&gt; removed in the future.
&gt;&gt;
&gt;&gt; HTH,
&gt;&gt; -Ryan
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

