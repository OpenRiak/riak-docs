---
title: "Re: Querying multiple 2i via Intersections"
description: ""
project: community
lastmod: 2013-07-27T08:53:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11792"
mailinglist_parent_id: "msg11791"
author_name: "Antonio Rohman Fernandez"
project_section: "mailinglistitem"
sent_date: 2013-07-27T08:53:16-07:00
---


 

Can you provide a real example on how to do that with Riak Search?


Thanks,
Rohman 

On 27.07.2013 17:44, Guido Medina wrote: 

&gt; Are you
saying that you can join two 2i indexes? Let's say you have a 2i named
"date" and another named "category" so you could get a list of modified
objects on a date and for a specific category with Riak Search?
&gt; 
&gt;
Guido.
&gt; 
&gt; On 27/07/13 16:32, Jeremiah Peschka wrote: 
&gt; 
&gt;&gt; Both Riak
Search (currently) and Yokozuna (future) provide the ability to perform
joins of multiple indices on the same bucket objects. 
&gt;&gt; 
&gt;&gt; I find it
best to think of 2i as an extension of what Riak KV already does well -
fast key based lookups. 
&gt;&gt; 
&gt;&gt; Search and Yokozuna provide complex
query semantics. 
&gt;&gt; 
&gt;&gt; --- 
&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar
Unlimited 
&gt;&gt; MCITP: SQL Server 2008, MVP 
&gt;&gt; Cloudera Certified
Developer for Apache Hadoop 
&gt;&gt; 
&gt;&gt; On Sat, Jul 27, 2013 at 11:16 AM,
Guido Medina  wrote:
&gt;&gt; 
&gt;&gt;&gt; Rohman,
&gt;&gt;&gt; 
&gt;&gt;&gt;
I think the reason for this is that the cluster will have to do the
whole intersection in memory, 2i only provides queries for 1 single
index and then return that result to either the client streaming or not,
intersection indeed will require a MapReduce job to get a hold of both
lists and intersect it, honestly, I wish that was possible, I think
that's why I'm learning Erlang at the moment, we all wanted "join" like
functionality with 2i to be honest but I don't think that is going to
happen before version 1.5 if ever.
&gt;&gt;&gt; 
&gt;&gt;&gt; If you noticed, Riak 1.4
added 2i streaming which IMHO is like moving farer away from handling
results in memory, if you get the point of what I mean. Join 2i queries
in Riak will be an issue for a long time.
&gt;&gt;&gt; 
&gt;&gt;&gt; HTH,
&gt;&gt;&gt; 
&gt;&gt;&gt; Guido.

&gt;&gt;&gt; 
&gt;&gt;&gt; On 27/07/13 14:20, Antonio Rohman Fernandez wrote:
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;
Hi there,
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I didn't fully check the new release notes yet, but
I guess that Riak 1.4 doesn't have the ability to query multiple 2i at
the same time... how difficult may be to implement a multiple 2i query
via their intersecting items in their arrays? Maybe we could have this
in future versions?
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I normally do this with scripts before
doing a MapReduce, if the data I want to look for is having 2 indexes
conditions, I get the array of items of each 2i query, then get only the
items found on both arrays and use it as a MapReduce input list.
&gt;&gt;&gt;&gt;

&gt;&gt;&gt;&gt; However, done in my app's side is a bit costly as Riak needs to
give me the full items arrays and then I need to process them to find
repeated keys.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; I really wish for Riak to be able to query
multiple 2i soon as it will help a lot.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Merci,
&gt;&gt;&gt;&gt;
Rohman
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Sent from my iPhone
&gt;&gt;&gt;&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt; riak-users mailing
list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
[1]
&gt;&gt;&gt; 
&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;
riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
[1]
&gt;&gt; 
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt; riak-users
mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt;
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com [1]
&gt;

&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing
list
&gt; riak-users@lists.basho.com
&gt;
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
[1]

-- 

 [2]

 ANTONIO ROHMAN FERNANDEZ
CEO, Founder & Lead
Engineer
roh...@mahalostudio.com 
 PROJECTS
MaruBatsu.es
[3]
PupCloud.com [4]
Wedding Album [5] 

 

Links:
------
[1]
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
[2]
http://mahalostudio.com
[3] http://marubatsu.es
[4]
http://pupcloud.com
[5] http://wedding.mahalostudio.com
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

