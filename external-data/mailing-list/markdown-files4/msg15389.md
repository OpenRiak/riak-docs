---
title: "Re: Can't delete objects being on an indexed bucket_type"
description: ""
project: community
lastmod: 2014-12-18T23:35:17-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15389"
mailinglist_parent_id: "msg15188"
author_name: "Alex De la rosa"
project_section: "mailinglistitem"
sent_date: 2014-12-18T23:35:17-08:00
---


Awesome! Thank you so much :)

Alex

On Friday, December 19, 2014, Brett Hazen  wrote:

&gt; Alex â€”
&gt;
&gt; The new version was released today, including this feature. Announcement
&gt; to follow.
&gt;
&gt; Brett
&gt;
&gt; On December 18, 2014 at 4:43:10 AM, Alex De la rosa (
&gt; alex.rosa....@gmail.com
&gt; ) wrote:
&gt;
&gt; Hi Sean,
&gt;
&gt; I wonder how the Python client progress goes? I didn't see any news about
&gt; it and PIP seems to not have a new version... when will the delete bug
&gt; fixed?
&gt;
&gt; Thanks,
&gt; Alex
&gt;
&gt; On Mon, Nov 17, 2014 at 4:53 PM, Alex De la rosa  &gt; wrote:
&gt;&gt;
&gt;&gt; Awesome, thanks :)
&gt;&gt;
&gt;&gt; On Mon, Nov 17, 2014 at 4:52 PM, Sean Cribbs &gt; &gt; wrote:
&gt;&gt;
&gt;&gt;&gt; I'll confer with Brett, who is wrapping up some Python 3 compatibility,
&gt;&gt;&gt; another release is needed soon.
&gt;&gt;&gt;
&gt;&gt;&gt; On Mon, Nov 17, 2014 at 1:12 AM, Alex De la rosa &lt;
&gt;&gt;&gt; alex.rosa....@gmail.com
&gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Yeah! this time worked :) thanks! Any ideas when a new release for the
&gt;&gt;&gt;&gt; Python client coming with that bug fixed?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt; Alex
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Mon, Nov 17, 2014 at 2:02 AM, Sean Cribbs &gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Sorry, I made a mistake in the example. Try this:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; RiakObject(bucket.\_client, bucket, 'testkey').delete()
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On Sun, Nov 16, 2014 at 3:15 PM, Alex De la rosa &lt;
&gt;&gt;&gt;&gt;&gt; alex.rosa....@gmail.com
&gt;&gt;&gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Hi Sean,
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Seams that the workaround suggested hits the same error:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;&gt;&gt;&gt; File "x.py", line 9, in 
&gt;&gt;&gt;&gt;&gt;&gt; RiakObject(bucket, 'testkey').delete()
&gt;&gt;&gt;&gt;&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/riak\_object.py",
&gt;&gt;&gt;&gt;&gt;&gt; line 335, in delete
&gt;&gt;&gt;&gt;&gt;&gt; timeout=timeout)
&gt;&gt;&gt;&gt;&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/bucket.py", line
&gt;&gt;&gt;&gt;&gt;&gt; 539, in delete
&gt;&gt;&gt;&gt;&gt;&gt; return self.new(key).delete(\*\*kwargs)
&gt;&gt;&gt;&gt;&gt;&gt; AttributeError: 'Map' object has no attribute 'delete'
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt;&gt; Alex
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On Sun, Nov 16, 2014 at 8:02 PM, Sean Cribbs &gt;&gt;&gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi Alex,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; That's a bug in the Python client. There's an existing issue on the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; repo for it: https://github.com/basho/riak-python-client/issues/365
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; In the meantime, here's a workaround:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; from riak.riak\_object import RiakObject
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; RiakObject(bucket, 'testkey').delete()
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sorry for the inconvenience.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Sat, Nov 15, 2014 at 5:54 PM, Alex De la rosa &lt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; alex.rosa....@gmail.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi there,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I created an index and a MAP bucket-type in the following way:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; curl -XPUT "http://x.x.x.x:8098/search/index/ix\_users"
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-admin bucket-type create tp\_users '{"props":
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; {"allow\_mult":true,"search\_index":"ix\_users","datatype":"map"}}'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-admin bucket-type activate tp\_users
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Then I saved some data and is working fine; but when I try to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; delete a key, I get a nasty error; what am I doing wrong?:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; import riak
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; client = riak.RiakClient(protocol = 'pbc', nodes = [{'host':
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 'x.x.x.x', 'http\_port': 8098, 'pb\_port': 8087}])
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; bucket = client.bucket\_type('tp\_users').bucket('users')
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; bucket.delete('testkey')
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Output of the script:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; File "x.py", line 6, in 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; bucket.delete('testkey')
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/bucket.py",
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; line 539, in delete
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; return self.new(key).delete(\*\*kwargs)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; AttributeError: 'Map' object has no attribute 'delete'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; This are my riak and python client versions:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ~ # pip show riak
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ---
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Name: riak
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Version: 2.1.0
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Location: /usr/local/lib/python2.7/dist-packages
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Requires: riak-pb, pyOpenSSL
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ~ # riak version
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 2.0.2
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Alex
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sean Cribbs &gt;&gt;&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sr. Software Engineer
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt; Sean Cribbs &gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt;&gt; Sr. Software Engineer
&gt;&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Sean Cribbs &gt;&gt; &gt;
&gt;&gt;&gt; Sr. Software Engineer
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; 
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

