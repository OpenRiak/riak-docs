---
title: "Re: Faceted Queries via Solr Interface"
description: ""
project: community
lastmod: 2011-12-28T11:48:33-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06087"
mailinglist_parent_id: "msg06086"
author_name: "Simeon F. Willbanks"
project_section: "mailinglistitem"
sent_date: 2011-12-28T11:48:33-08:00
---


After poking around, I've found a presentation by John Muellerleile at
Boundary's meetup on October 6, 2011. He addresses Riak, Solr and
other technologies in use at showyou.com.

http://blog.boundary.com/2011/10/11/Boundary-Tech-Talk-1.html
http://thinkdifferent.ly/stuff/scaling-at-showyou-jmm.pdf
http://twitter.com/jrecursive

Around 11:10 in the video, he addresses the Pre/Post Commit Hook
question. He uses a Post Commit Hook for the reason Ryan outlined
above... he doesn't want a write to be blocked. :)

Hope this helps others.

Thanks,
Simeon

On Wed, Dec 28, 2011 at 11:13 AM, Simeon F. Willbanks
 wrote:
&gt; Ryan,
&gt;
&gt; I really appreciate the detailed answer and breakdown of Pre/Post
&gt; Commit Hook options.
&gt;
&gt; Thanks,
&gt; Simeon
&gt;
&gt; On Wed, Dec 28, 2011 at 10:42 AM, Ryan Zezeski  wrote:
&gt;&gt; Simeon,
&gt;&gt;
&gt;&gt; I think the assumption is that if it's a precommit hook you "know" that if
&gt;&gt; an object was written then it has also been indexed.  Whereas if it's a
&gt;&gt; postcommit the object may be written but the indexing fails.  I think the
&gt;&gt; guiding decision would probably be what you favor, 1) that for any object
&gt;&gt; it's index will exist first, therefore your query results are "consistent"
&gt;&gt; with your data or 2) that data persistence is the foremost priority and
&gt;&gt; inconsistent or eventually consistent query results are acceptable (because
&gt;&gt; maybe objects are constantly updated and eventually they will get indexed).
&gt;&gt;  The thing to keep in mind is that the precommit will block the write, and
&gt;&gt; if you're using a persistent backend like bitcask or level you may not want
&gt;&gt; your data sitting in memory waiting for the indexing to finish.  Another
&gt;&gt; thing to think about is using a postcommit that fires off into a queue that
&gt;&gt; is indexed thus reducing latency on your clients writes to Riak.  My point
&gt;&gt; is that there are many factors and if you are going to go down the Riak/Solr
&gt;&gt; route you should take your applications requirements into consideration.
&gt;&gt;
&gt;&gt; HTH,
&gt;&gt; -Ryan
&gt;&gt;
&gt;&gt;
&gt;&gt; On Wed, Dec 28, 2011 at 12:56 PM, Simeon F. Willbanks
&gt;&gt;  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Ryan,
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks for the timely answer.
&gt;&gt;&gt;
&gt;&gt;&gt; Yea, faceting in code doesn't sound like the right solution. :)
&gt;&gt;&gt;
&gt;&gt;&gt; In the talk 'Riak Search Explained,' Daniel Reverri described how Riak
&gt;&gt;&gt; Search integrates with Riak KV via a Pre-Commit Hook. If you were to
&gt;&gt;&gt; roll your own search (Solr Cluster), is the recommendation to initiate
&gt;&gt;&gt; a indexing process from a Pre-Commit Hook as opposed to a Post-Commit
&gt;&gt;&gt; Hook?
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks again,
&gt;&gt;&gt; Simeon
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Wed, Dec 28, 2011 at 8:04 AM, Ryan Zezeski  wrote:
&gt;&gt;&gt; &gt; Simeon,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; There are currently no plans to implement faceted queries.  The first
&gt;&gt;&gt; &gt; thought is that you pull back all results and do the faceting yourself,
&gt;&gt;&gt; &gt; but
&gt;&gt;&gt; &gt; what's the point of that, right?  I think other than that some Erlang
&gt;&gt;&gt; &gt; would
&gt;&gt;&gt; &gt; need to be written for Search to properly support faceting.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; -Ryan
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; On Tue, Dec 27, 2011 at 4:54 PM, Simeon F. Willbanks
&gt;&gt;&gt; &gt;  wrote:
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Are there plans to implement Faceted Queries?
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; "Facet querying through the Solr interface is not yet supported."
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; http://wiki.basho.com/Riak-Search---Querying.html#Faceted-Queries-via-the-Solr-Interface
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; In the meantime, is there a recommended alternative way to build
&gt;&gt;&gt; &gt;&gt; facets with Riak-Search?
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Thanks,
&gt;&gt;&gt; &gt;&gt; Simeon
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt;&gt;&gt; &gt;&gt; riak-users mailing list
&gt;&gt;&gt; &gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; &gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt;
&gt;&gt;
&gt;&gt;

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

