---
title: "Re: why leaving riak cluster so slowly and how to accelerate the speed"
description: ""
project: community
lastmod: 2015-08-06T07:49:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16375"
mailinglist_parent_id: "msg16346"
author_name: "Dmitri Zagidulin"
project_section: "mailinglistitem"
sent_date: 2015-08-06T07:49:56-07:00
---


Hi Amao,

Can you explain a bit more which steps you've taken, and what the problem
is?

Which nodes have been added, and which nodes are leaving the cluster?

On Tue, Jul 28, 2015 at 11:03 PM, Changmao.Wang 
wrote:

&gt; Hi Raik user group,
&gt;
&gt; I'm using riak and riak-cs 1.4.2. Last weekend, I added four nodes to
&gt; cluster with 5 nodes. However, it's failed with one of disks 100% full.
&gt; As you know bitcask storage engine can not support multifolders.
&gt;
&gt; After that, I restarted the "riak" and leave the cluster with the command
&gt; "riak-admin cluster leave" and "riak-admin cluster plan", and the commit.
&gt; However, riak is always doing KV balance after my submit leaving command.
&gt; I guess that it's doing join cluster progress.
&gt;
&gt; Could you show us how to accelerate the leaving progress? I have tuned the
&gt; "transfer-limit" parameters on 9 nodes.
&gt;
&gt; below is some commands output:
&gt; riak-admin member-status
&gt; ================================= Membership
&gt; ==================================
&gt; Status Ring Pending Node
&gt;
&gt; -------------------------------------------------------------------------------
&gt; leaving 6.3% 10.9% 'riak@10.21.136.91'
&gt; leaving 9.4% 10.9% 'riak@10.21.136.92'
&gt; leaving 6.3% 10.9% 'riak@10.21.136.93'
&gt; leaving 6.3% 10.9% 'riak@10.21.136.94'
&gt; valid 10.9% 10.9% 'riak@10.21.136.66'
&gt; valid 12.5% 10.9% 'riak@10.21.136.71'
&gt; valid 18.8% 10.9% 'riak@10.21.136.76'
&gt; valid 18.8% 12.5% 'riak@10.21.136.81'
&gt; valid 10.9% 10.9% 'riak@10.21.136.86'
&gt;
&gt; riak-admin transfer\_limit
&gt; =============================== Transfer Limit
&gt; ================================
&gt; Limit Node
&gt;
&gt; -------------------------------------------------------------------------------
&gt; 200 'riak@10.21.136.66'
&gt; 200 'riak@10.21.136.71'
&gt; 100 'riak@10.21.136.76'
&gt; 100 'riak@10.21.136.81'
&gt; 200 'riak@10.21.136.86'
&gt; 500 'riak@10.21.136.91'
&gt; 500 'riak@10.21.136.92'
&gt; 500 'riak@10.21.136.93'
&gt; 500 'riak@10.21.136.94'
&gt;
&gt; Any more details for your diagnosing the problem?
&gt;
&gt; Amao
&gt;
&gt; \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
&gt;
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

