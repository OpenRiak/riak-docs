---
title: "Re: Put failure: too many siblings"
description: ""
project: community
lastmod: 2017-05-25T06:25:04-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18241"
mailinglist_parent_id: "msg18232"
author_name: "Magnus Kessler"
project_section: "mailinglistitem"
sent_date: 2017-05-25T06:25:04-07:00
---


On 25 May 2017 at 09:39, Vladyslav Zakhozhai 
wrote:

&gt; Hi,
&gt;
&gt; I've been trying to change dvv\_enabled for default bucket type. But this
&gt; is impossible with riak-admin:
&gt;
&gt; riak-admin bucket-type update default '{"props":{"dvv\_enabled":true}}'
&gt; Error updating bucket type default:
&gt; no\_default\_update
&gt;
&gt; I think that workaround for this is changing default props in riak config:
&gt;
&gt; {riak\_core, [
&gt;
&gt; {default\_bucket\_props, [
&gt; {allow\_mult, true},
&gt; {dvv\_enabled, true}
&gt; ]},
&gt; ...
&gt;
&gt; (yes, I still use old-style configs)
&gt;
&gt; And then I need to restart all riak nodes. Here is two questions:
&gt; 1. Is this approach correct?
&gt; 2. Is it ok to have different default\_bucket\_props value on different
&gt; nodes of the same cluster (in short period of time)?
&gt;
&gt; I have to restart 27 riak nodes. There is several billions of keys in riak
&gt; and each node starts wery slow (20-30-60 min; bitcask backend). So I can't
&gt; change default\_bucket\_props simultaneously in a such way.
&gt;
&gt; I also can change this parameter in riak console, i.e.
&gt;
&gt; application:set\_env(riak\_core, default\_bucket\_props, [{dvv\_enabled, true},
&gt; ......]). But what I need to do for applying this changes?
&gt;
&gt;
Hi Vladyslav,

The recommended approach for changing the default bucket type's properties
is to change the settings in `riak.conf` or `advanced.config`. However, I
just checked that any settings changed through a set\_env call also seem to
be reflected in the runtime configuration.

If you'd like to try this, I recommend making the change on a test cluster
first, as I have not verified if this causes issues on a production CS
cluster. The set\_env call should pass in the complete set of bucket type
properties, not just the changes. You can try the following (with default
default bucket-type properties):

riak\_core\_util:rpc\_every\_member\_ann(application, set\_env, [riak\_core,
default\_bucket\_props,
[{allow\_mult,false},{big\_vclock,50},{chash\_keyfun,{riak\_core\_util,chash\_std\_keyfun}},{dvv\_enabled,
false},{dw,quorum},{last\_write\_wins,false},{linkfun,{modfun,riak\_kv\_wm\_link\_walker,mapreduce\_linkfun}},{n\_val,3},{notfound\_ok,true},{old\_vclock,86400},{postcommit,[]},{pr,0},{precommit,[]},{pw,0},{r,quorum},{repl,true},{rw,quorum},{small\_vclock,50},{w,quorum},{write\_once,false},{young\_vclock,20}]],
5000).


If you go down this route, please don't forget to also make changes to the
configuration files, in order to these settings to persist across a restart.

Kind Regards,

Magnus

-- 
Magnus Kessler
Client Services Engineer
Basho Technologies Limited

Registered Office - 8 Lincolnâ€™s Inn Fields London WC2A 3BP Reg 07970431
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

