---
title: "Re: innostore performance tuning"
description: ""
project: community
lastmod: 2011-08-30T09:30:51-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04509"
mailinglist_parent_id: "msg04508"
author_name: "Kresten Krab Thorup"
project_section: "mailinglistitem"
sent_date: 2011-08-30T09:30:51-07:00
---


If you can do the inserts in sorted (ascending) key order, then innostore will 
be significantly faster.

Kresten


Mobile: + 45 2343 4626 | Skype: krestenkrabthorup | Twitter: @drkrab
Trifork A/S | Margrethepladsen 4 | DK- 8000 Aarhus C | Phone : +45 8732 
8787 | www.trifork.com
 
Trifork organizes the world class conference on software development: GOTO 
Aarhus - check it out!
 


On Aug 30, 2011, at 6:14 PM, David Koblas wrote:

&gt; I'm currently working on importing a very large dataset (800M) into Riak and 
&gt; running into some serious performance problems. Hopefully this is just 
&gt; configuration issues and nothing deeper...
&gt; 
&gt; Hardware -
&gt; \\* 8 proc box
&gt; \\* 32 Gb ram 
&gt; \\* 5TB disk - RAID10
&gt; 
&gt; Have a cluster of 4 for these boxes all running riak - riak configuration 
&gt; options that are different from stock:
&gt; 
&gt; \\* Listening on all IP address "0.0.0.0"
&gt; \\* {storage\\_backend, riak\\_kv\\_innostore\\_backend},
&gt; \\* innostore section - {buffer\\_pool\\_size, 17179869184}, %% 16GB
&gt; \\* innostore section - {flush\\_method, "O\\_DIRECT"}
&gt; 
&gt; What I see is that the performance of my import script runs at about 
&gt; 200...300 keys per/second for keys that it's seen recently (e.g. re-runs) 
&gt; then drops to 20ish keys per/sec for new keys.
&gt; STATS: 1000 keys handled in 3 seconds 250.75 keys/sec
&gt; STATS: 1000 keys handled in 3 seconds 258.20 keys/sec
&gt; STATS: 1000 keys handled in 4 seconds 240.11 keys/sec
&gt; STATS: 1000 keys handled in 5 seconds 177.63 keys/sec
&gt; STATS: 1000 keys handled in 4 seconds 246.26 keys/sec
&gt; STATS: 1000 keys handled in 5 seconds 184.79 keys/sec
&gt; STATS: 1000 keys handled in 5 seconds 195.95 keys/sec
&gt; STATS: 1000 keys handled in 47 seconds 21.02 keys/sec
&gt; STATS: 1000 keys handled in 44 seconds 22.63 keys/sec
&gt; STATS: 1000 keys handled in 42 seconds 23.64 keys/sec
&gt; STATS: 1000 keys handled in 43 seconds 22.88 keys/sec
&gt; STATS: 1000 keys handled in 45 seconds 22.12 keys/sec
&gt; STATS: 1000 keys handled in 43 seconds 22.83 keys/sec
&gt; STATS: 1000 keys handled in 43 seconds 23.11 keys/sec
&gt; Of course with 800M records to import a performance of 20 keys/sec is not 
&gt; useful, plus as time goes on having an insert rate at that level is going to 
&gt; be problematic.
&gt; 
&gt; Questions -
&gt; Is there additional things to change for imports and datasets on this scale?
&gt; Is there a way to get additional debugging to see where the performance 
&gt; issues are?
&gt; 
&gt; Thanks,
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

