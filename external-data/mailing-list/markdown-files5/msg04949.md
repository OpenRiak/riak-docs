---
title: "Problem with Reduce Phase Sorting (Javascript)"
description: ""
project: community
lastmod: 2011-09-30T13:12:50-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04949"
author_name: "Barron Logan"
project_section: "mailinglistitem"
sent_date: 2011-09-30T13:12:50-07:00
---


hello all,

we are having issues sorting in Reduce. this is from within a java app.

we are passing in an anonymous js function, but the values are not being sorted.

here is the data structure:

[{"score":77.88765180825125,"key":"{\\"@class\\"[cid:A1AB6387-083F-41D4-8F63-89D3A73EA8C6@sharecare.local]"name1\\"},
 
{"score":167.33742092903964,"key":"{\\"@class\\"[cid:A1AB6387-083F-41D4-8F63-89D3A73EA8C6@sharecare.local]"name2\\"
 }]

so it is an array of maps, with two keys ('score' & 'key').. the 'score' key is 
an integer that we would like to sort on. the 'key' key is a json object that 
we have removed from this example.

here is the java code, that executes, but does not sort:

builder = builder.reduce(JavascriptFunction.anon("" +



 "function(values){" +
 "var flattened = values.reduce(function(a,b){" +
 "return a.concat(b);" +
 "},[]);" +
 "return flattened.sort(function(a,b){ " +



 "return b[\\"score\\"] -a[\\"score\\"]" +
 "});" +
 "}"),true);



MapReduceResponse response = builder.submit();


advTHANKSanced,

barron
&lt;&gt;\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

