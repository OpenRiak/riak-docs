---
title: "Re: riak cluster suddenly became unresponsive"
description: ""
project: community
lastmod: 2013-03-19T07:05:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10475"
mailinglist_parent_id: "msg10456"
author_name: "Mark Phillips"
project_section: "mailinglistitem"
sent_date: 2013-03-19T07:05:18-07:00
---


Hi Ingo,

Sorry for the delay in getting back to you.

This looks symptomatic of some of the scheduler issues we fixed of 1.3. A
few of the eleveldb issues in the release notes [1] can provide precise
details. Is upgrading a possibility?

Tweaking your zdbbl in vm.args should alleviate some of the issues with
busy buffers but upgrading is probably your best path here.

Hope that helps. Keep us posted.

Mark

[1] https://github.com/basho/riak/blob/master/RELEASE-NOTES.md

On Friday, March 15, 2013, Ingo Rockel wrote:

&gt; Hi,
&gt;
&gt; we have a 12 nodes cluster running riak 1.2.1 which went live a week ago.
&gt; Yesterday, suddenly from one minute to another the put\\_fsm\\_time\\_95 and the
&gt; get\\_fsm\\_time\\_95 raised from something below 100ms up to several seconds.
&gt; This went on for about 25 min and than went away.
&gt;
&gt; Checking the riak-logs of the nodes, I find a lot of these:
&gt;
&gt; 2013-03-14 17:48:06.388 [info] 
&gt; &lt;0.62.0&gt;@riak\\_core\\_sysmon\\_\\*\\*handler:handle\\_event:89
&gt; Monitor got {suppressed,port\\_events,1}
&gt; 2013-03-14 17:48:06.889 [info] 
&gt; &lt;0.62.0&gt;@riak\\_core\\_sysmon\\_\\*\\*handler:handle\\_event:85
&gt; monitor busy\\_dist\\_port &lt;0.7156.1&gt; [{initial\\_call,{riak\\_core\\_\\*\\*
&gt; vnode,init,1}},{almost\\_\\*\\*current\\_function,{erlang,bif\\_\\*\\*
&gt; return\\_trap,1}},{message\\_\\*\\*queue\\_len,1}] {#Port&lt;0.9083226&gt;,'
&gt; riak@172.22.3.22'}
&gt;
&gt; This messages are logged all day, but only once every few minutes but in
&gt; the problematic time frame between 17:45 and 18:17 it gets logged several
&gt; times every second. The node ip differs though, but it seems only three
&gt; nodes were involved.
&gt;
&gt; Except of these three nodes the cpu utilisation drops by half during this
&gt; on all other nodes. On the three nodes there's only a slight drop.
&gt;
&gt; We are using leveldb as storage backend. I also checked some of the LOG
&gt; files of leveldb and there are compactions logged, but these are logged all
&gt; the day every few hours.
&gt;
&gt; In this time our software was quite unresponsive too so I would like to
&gt; know what was causing this and what I might do to stop. Any ideas, hints?
&gt;
&gt; I found this:
&gt;
&gt; https://groups.google.com/\\*\\*forum/?fromgroups=#!topic/\\*\\*
&gt; nosql-databases/GqbaeiKCSYE
&gt;
&gt; where Jon Meredith suggests to raise the buffer size to get rid of the
&gt; busy buffers by adding +zdbbl 16384 to the vm.args file. Might this help?
&gt;
&gt; Regards,
&gt;
&gt; Ingo
&gt; --
&gt; Software Architect
&gt;
&gt; Blue Lion mobile GmbH
&gt; Tel. +49 (0) 221 788 797 14
&gt; Fax. +49 (0) 221 788 797 19
&gt; Mob. +49 (0) 176 24 87 30 89
&gt;
&gt; ingo.roc...@bluelionmobile.com
&gt; &gt;&gt;&gt; qeep: Hefferwolf
&gt;
&gt; www.bluelionmobile.com
&gt; www.qeep.net
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\*\\*\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/\\*\\*mailman/listinfo/riak-users\\_\\*\\*lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

