---
title: "Memory backend doesn't work (with multi backend)?"
description: ""
project: community
lastmod: 2016-06-23T01:18:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17491"
author_name: "Nagy, Attila"
project_section: "mailinglistitem"
sent_date: 2016-06-23T01:18:08-07:00
---



Hi,

Trying to use the memory backend via multi.

What I did:
in riak.conf:
storage\\_backend = multi

Then creating a bucket type:
riak-admin bucket-type create os\\_cache '{"props": {"write\\_once": 
true,"backend":"memory","n\\_val":2,"r":1,"w":1,"dw":1}}'

riak-admin bucket-type activate os\\_cache

Then I PUT an object:
curl -v -XPUT -H "Content-Type: application/octet-stream" 
'http://localhost:8098/types/os\\_cache/buckets/os\\_cache/keys/test1' -d 'test'


Mext, I shut down all of the servers at once, leaving nothing in the 
cluster, then restarting them.

And a new get for the above URL returns "test".

When I set storage\\_backend to memory, it works as expected, after a full 
cluster stop, the bucket is empty.


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

