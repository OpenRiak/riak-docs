---
title: "Problem getting Riak multi-backend working"
description: ""
project: community
lastmod: 2012-09-26T10:30:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08706"
author_name: "Lei Gu"
project_section: "mailinglistitem"
sent_date: 2012-09-26T10:30:44-07:00
---



We want to explore Riak multi backend support for the following scenario, 
configuration data stored in Level DB, while some transit data will be stored 
in memory and expires after a certain time. Unfortunately I have the toughest 
time getting multi-backend support to work, every time I tried to access my 
non-default backend.
Here is the configuration around multi-backend,

{riak\\_kv, [
 %% Storage\\_backend specifies the Erlang module defining the storage
 %% mechanism that will be used on this node.
 %%{storage\\_backend, riak\\_kv\\_bitcask\\_backend},
 %%{storage\\_backend, riak\\_kv\\_eleveldb\\_backend},
 %%{storage\\_backend, riak\\_kv\\_memory\\_backend},
 {storage\\_backend, riak\\_kv\\_multi\\_backend},
 {multi\\_backend\\_default, "memory\\_mult"},
 {multi\\_backend, [
 %% Here's where you set the individual multiplexed backends
 {"eleveldb\\_mult", riak\\_kv\\_eleveldb\\_backend,[]
 },
 {"memory\\_mult", riak\\_kv\\_memory\\_backend,
 [
 {ttl, 10},
 {max\\_memory, 512}
 ]
 }
 ]},


When I tried to access "eleveldb\\_mult, I am seeing the following exception in 
the log file,

2012-09-26 10:27:54.041 [error] &lt;0.892.0&gt; gen\\_fsm &lt;0.892.0&gt; in state active 
terminated with reason: bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;}
2012-09-26 10:27:54.044 [error] &lt;0.892.0&gt; CRASH REPORT Process &lt;0.892.0&gt; with 0 
neighbours crashed with reason: bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;}
2012-09-26 10:27:54.045 [error] &lt;0.877.0&gt; gen\\_fsm &lt;0.877.0&gt; in state active 
terminated with reason: bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;}
2012-09-26 10:27:54.046 [error] &lt;0.94.0&gt; Supervisor riak\\_core\\_vnode\\_sup had 
child undefined started with {riak\\_core\\_vnode,start\\_link,undefined} at 
&lt;0.892.0&gt; exit with reason bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;} in context 
child\\_terminated
2012-09-26 10:27:54.048 [error] &lt;0.907.0&gt; gen\\_fsm &lt;0.907.0&gt; in state active 
terminated with reason: bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;}
2012-09-26 10:27:54.049 [error] &lt;0.877.0&gt; CRASH REPORT Process &lt;0.877.0&gt; with 0 
neighbours crashed with reason: bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;}
2012-09-26 10:27:54.050 [error] &lt;0.907.0&gt; CRASH REPORT Process &lt;0.907.0&gt; with 0 
neighbours crashed with reason: bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;}
2012-09-26 10:27:54.051 [error] &lt;0.94.0&gt; Supervisor riak\\_core\\_vnode\\_sup had 
child undefined started with {riak\\_core\\_vnode,start\\_link,undefined} at 
&lt;0.877.0&gt; exit with reason bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;} in context 
child\\_terminated
2012-09-26 10:27:54.052 [error] &lt;0.94.0&gt; Supervisor riak\\_core\\_vnode\\_sup had 
child undefined started with {riak\\_core\\_vnode,start\\_link,undefined} at 
&lt;0.907.0&gt; exit with reason bad return value: 
{riak\\_kv\\_multi\\_backend,undefined\\_backend,&lt;&lt;"eleveldb\\_mult"&gt;&gt;} in context 
child\\_terminated

Any insights will be greatly appreciated.
Thanks.
-- Lei


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
The information contained in this electronic mail transmission is intended only 
for the use of the individual or entity named in this transmission. If you are 
not the intended recipient of this transmission, you are hereby notified that 
any disclosure, copying or distribution of the contents of this transmission is 
strictly prohibited and that you should delete the contents of this 
transmission from your system immediately. Any comments or statements contained 
in this transmission do not necessarily reflect the views or position of GSI 
Commerce, Inc. or its subsidiaries and/or affiliates.

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

