---
title: "Re: Can't delete objects from Riak KV"
description: ""
project: community
lastmod: 2016-04-14T07:06:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17219"
mailinglist_parent_id: "msg17218"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2016-04-14T07:06:15-07:00
---


Hi Alex,

Thanks for running that. This proves that it is not a Python client
issue. You can see the transcript of storing, fetching and deleting an
object successfully here:
https://gist.github.com/lukebakken/f1f3cbc96c2762eabb2f124b42797fda

At this point, I suggest checking the error.log files on each Riak
node for information. Or, if you run "riak-debug" on your cluster and
provide the archives somewhere (private access), I could take a look.

--
Luke Bakken
Engineer
lbak...@basho.com


On Thu, Apr 14, 2016 at 6:57 AM, Alex De la rosa
 wrote:
&gt; Hi Luke, I tried and get this and didn't work:
&gt;
&gt; ~ # curl -4vvv -XDELETE http://xx.xx.xx.xx:8098/buckets/test/keys/something
&gt; \\* Hostname was NOT found in DNS cache
&gt; \\* Trying xx.xx.xx.xx...
&gt; \\* Connected to xx.xx.xx.xx (xx.xx.xx.xx) port 8098 (#0)
&gt;&gt; DELETE /buckets/test/keys/something HTTP/1.1
&gt;&gt; User-Agent: curl/7.35.0
&gt;&gt; Host: xx.xx.xx.xx:8098
&gt;&gt; Accept: \\*/\\*
&gt;&gt;
&gt; \\* Empty reply from server
&gt; \\* Connection #0 to host xx.xx.xx.xx left intact
&gt; curl: (52) Empty reply from server
&gt;
&gt; Thanks,
&gt; Alex
&gt;
&gt; On Thu, Apr 14, 2016 at 5:50 PM, Alex De la rosa 
&gt; wrote:
&gt;&gt;
&gt;&gt; I can try that, but I would like to do it via the python client itself...
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Rohman
&gt;&gt;
&gt;&gt; On Thu, Apr 14, 2016 at 5:47 PM, Luke Bakken  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hi Alex,
&gt;&gt;&gt;
&gt;&gt;&gt; Can you use the HTTP API to delete an object? Something like:
&gt;&gt;&gt;
&gt;&gt;&gt; curl -4vvv -XDELETE riak-host:8098/buckets/test/keys/something
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Luke Bakken
&gt;&gt;&gt; Engineer
&gt;&gt;&gt; lbak...@basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Thu, Apr 14, 2016 at 2:05 AM, Alex De la rosa
&gt;&gt;&gt;  wrote:
&gt;&gt;&gt; &gt; I upgraded the Python library to the latest and is still failing... I'm
&gt;&gt;&gt; &gt; unable to delete any objects at all.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; ~ # pip show riak
&gt;&gt;&gt; &gt; ---
&gt;&gt;&gt; &gt; Name: riak
&gt;&gt;&gt; &gt; Version: 2.4.2
&gt;&gt;&gt; &gt; Location: /usr/local/lib/python2.7/dist-packages
&gt;&gt;&gt; &gt; Requires: six, pyOpenSSL, protobuf
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Everything else seems fine, just timeouts when deleting :(
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Thanks,
&gt;&gt;&gt; &gt; Alex
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; On Thu, Apr 14, 2016 at 8:53 AM, Alex De la rosa
&gt;&gt;&gt; &gt; 
&gt;&gt;&gt; &gt; wrote:
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Hi there,
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; I'm trying to delete objects from riak with the python library and is
&gt;&gt;&gt; &gt;&gt; timing out, any ideas? (this example is from a simple object, but also
&gt;&gt;&gt; &gt;&gt; have
&gt;&gt;&gt; &gt;&gt; issues with bucket types with map objects, etc...)... Just I seem to
&gt;&gt;&gt; &gt;&gt; unable
&gt;&gt;&gt; &gt;&gt; to delete anything, just times out.
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; &gt;&gt;&gt; import riak
&gt;&gt;&gt; &gt;&gt; &gt;&gt;&gt; RIAK = riak.RiakClient(protocol = 'pbc', nodes = [{'host':
&gt;&gt;&gt; &gt;&gt; &gt;&gt;&gt; '--------',
&gt;&gt;&gt; &gt;&gt; &gt;&gt;&gt; 'http\\_port': 8098, 'pb\\_port': 8087}])
&gt;&gt;&gt; &gt;&gt; &gt;&gt;&gt; x = RIAK.bucket('test').get('something')
&gt;&gt;&gt; &gt;&gt; &gt;&gt;&gt; print x.data
&gt;&gt;&gt; &gt;&gt; {"something":"here"}
&gt;&gt;&gt; &gt;&gt; &gt;&gt;&gt; x.delete()
&gt;&gt;&gt; &gt;&gt; Traceback (most recent call last):
&gt;&gt;&gt; &gt;&gt; File "", line 1, in 
&gt;&gt;&gt; &gt;&gt; File "/usr/local/lib/python2.7/dist-packages/riak/riak\\_object.py",
&gt;&gt;&gt; &gt;&gt; line
&gt;&gt;&gt; &gt;&gt; 329, in delete
&gt;&gt;&gt; &gt;&gt; timeout=timeout)
&gt;&gt;&gt; &gt;&gt; File
&gt;&gt;&gt; &gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/client/transport.py",
&gt;&gt;&gt; &gt;&gt; line 196, in wrapper
&gt;&gt;&gt; &gt;&gt; return self.\\_with\\_retries(pool, thunk)
&gt;&gt;&gt; &gt;&gt; File
&gt;&gt;&gt; &gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/client/transport.py",
&gt;&gt;&gt; &gt;&gt; line 138, in \\_with\\_retries
&gt;&gt;&gt; &gt;&gt; return fn(transport)
&gt;&gt;&gt; &gt;&gt; File
&gt;&gt;&gt; &gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/client/transport.py",
&gt;&gt;&gt; &gt;&gt; line 194, in thunk
&gt;&gt;&gt; &gt;&gt; return fn(self, transport, \\*args, \\*\\*kwargs)
&gt;&gt;&gt; &gt;&gt; File
&gt;&gt;&gt; &gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/client/operations.py",
&gt;&gt;&gt; &gt;&gt; line 744, in delete
&gt;&gt;&gt; &gt;&gt; pw=pw, timeout=timeout)
&gt;&gt;&gt; &gt;&gt; File
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/transports/pbc/transport.py",
&gt;&gt;&gt; &gt;&gt; line 283, in delete
&gt;&gt;&gt; &gt;&gt; riak.pb.messages.MSG\\_CODE\\_DEL\\_RESP)
&gt;&gt;&gt; &gt;&gt; File
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/transports/pbc/connection.py",
&gt;&gt;&gt; &gt;&gt; line 34, in \\_request
&gt;&gt;&gt; &gt;&gt; return self.\\_recv\\_msg(expect)
&gt;&gt;&gt; &gt;&gt; File
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; "/usr/local/lib/python2.7/dist-packages/riak/transports/pbc/connection.py",
&gt;&gt;&gt; &gt;&gt; line 165, in \\_recv\\_msg
&gt;&gt;&gt; &gt;&gt; raise RiakError(bytes\\_to\\_str(err.errmsg))
&gt;&gt;&gt; &gt;&gt; riak.riak\\_error.RiakError: 'timeout'
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; My Riak version is 2.1.4
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; My Python library is (installed via pip):
&gt;&gt;&gt; &gt;&gt; Name: riak
&gt;&gt;&gt; &gt;&gt; Version: 2.2.0
&gt;&gt;&gt; &gt;&gt; Location: /usr/local/lib/python2.7/dist-packages
&gt;&gt;&gt; &gt;&gt; Requires: six, pyOpenSSL, riak-pb
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Thanks,
&gt;&gt;&gt; &gt;&gt; Alex
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; &gt; riak-users mailing list
&gt;&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt; &gt;
&gt;&gt;
&gt;&gt;
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

