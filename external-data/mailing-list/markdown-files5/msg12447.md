---
title: "Re: Using /etc/hosts entry and not ip in configuration files .."
description: ""
project: community
lastmod: 2013-10-01T19:40:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12447"
mailinglist_parent_id: "msg12342"
author_name: "Seth Thomas"
project_section: "mailinglistitem"
sent_date: 2013-10-01T19:40:18-07:00
---


Mike,

Based on the Chef line you have there, the issue is that you aren't
providing a FQDN. If the name is just "-int" then it isn't a
fully qualified domain name and therefore Erlang complains.

Hopefully that clears up the confusion.


On Sat, Sep 21, 2013 at 8:12 PM, Mike Nathe  wrote:

&gt; Hi Alex.
&gt;
&gt; thanks a bunch for the info and the link to the white paper.
&gt;
&gt; Unfortunately we still haven't been able to use a domain name in the
&gt; vm.args successfully.
&gt;
&gt; We use Chef scripts to build our EC2 instances (OpsWorks).
&gt; The only difference in the scripts is:
&gt;
&gt; # use domain name
&gt; node.set['riak']['args']['-name'] = "riak@#{node['hostname']}-int"
&gt; # use ip
&gt; node.set['riak']['args']['-name'] = "riak@#{node['ipaddress']}"
&gt;
&gt; The deployment with the ipaddress works great.
&gt; The deployment with the hostname does start the server but the tools do
&gt; not work ( returns "Node is not running").
&gt; We checked /var/log/riak and the console.log and error.log looked clean,
&gt; though there was an erlang dump.
&gt;
&gt; Any insight into this would be greatly appreciated.
&gt; Thanks again.
&gt;
&gt; Cheers,
&gt; Michael
&gt;
&gt;
&gt;
&gt; The result of a simple test for hostname deployment:
&gt;
&gt; ubuntu@riaknode1:~$ sudo /usr/local/riak/bin/riak-admin ringready
&gt; Node is not running!
&gt;
&gt;
&gt; The result of a simple test for ipaddress deployment:
&gt;
&gt; ubuntu@riaknode1:~$ sudo /usr/local/riak/bin/riak-admin ringready
&gt; TRUE All nodes agree on the ring ['riak@172.31.44.73']
&gt;
&gt;
&gt;
&gt;
&gt; On 19 September 2013 16:58, Alex Moore  wrote:
&gt;
&gt;&gt; Hey Mike,
&gt;&gt;
&gt;&gt; Another option for your app.config would be to bind everything to
&gt;&gt; "0.0.0.0", which will make Riak listen on all interfaces. This combined
&gt;&gt; with using a domain name in the vm.args should prevent you from having to
&gt;&gt; do renames/changing ips in the config files.
&gt;&gt; If you do this, please consider using a VPC to limit access to the
&gt;&gt; machines.
&gt;&gt;
&gt;&gt; A good resource to read over is Amazon's Riak Whitepaper:
&gt;&gt; http://media.amazonwebservices.com/AWS\\_NoSQL\\_Riak.pdf, as it goes
&gt;&gt; through some operation considerations and tuning points that might be
&gt;&gt; useful to you.
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Alex
&gt;&gt;
&gt;&gt; On September 19, 2013 at 6:52:29 PM, Mike Nathe (mna...@fathom-i.com)
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt; hi.
&gt;&gt;
&gt;&gt; we are trying to run Riak in the Amazon cloud (using OpsWorks).
&gt;&gt; With every restart of the servers the ip addresses change so using an
&gt;&gt; entry in the /etc/hosts instead of an IP looks like a great idea.
&gt;&gt;
&gt;&gt; Google's answer is:
&gt;&gt;
&gt;&gt; http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2011-December/006912.html
&gt;&gt;
&gt;&gt; Just to make sure: Riak only supports IP addresses and not DNS names in
&gt;&gt; the config files.
&gt;&gt; Though in your docs it still says:
&gt;&gt; "Riak identifies other machines in the ring using Erlang identifiers
&gt;&gt; (, ex: riak@10.9.8.7)."
&gt;&gt;
&gt;&gt;
&gt;&gt; The error logged when changing our config from something
&gt;&gt; like 172.31.41.138 to riaknode2-ext is:
&gt;&gt;
&gt;&gt; 2013-09-19 21:49:53.383 [error] &lt;0.113.0&gt; Supervisor riak\\_core\\_sup had
&gt;&gt; child "http\\_riaknode2-ext:8098" started with
&gt;&gt; webmachine\\_mochiweb:start([{name,"http\\_riaknode2-ext:8098"},{ip,"riaknode2-ext"},{port,8098},{nodelay,true},{log\\_dir,"log"},...])
&gt;&gt; at undefined exit with reason
&gt;&gt; {'EXIT',{{badmatch,{error,einval}},[{mochiweb\\_socket\\_server,parse\\_options,2},{mochiweb\\_socket\\_server,start,1},{supervisor,do\\_start\\_child,2},{supervisor,start\\_children,3},{supervisor,init\\_children,2},{gen\\_server,init\\_it,6},{proc\\_lib,init\\_p\\_do\\_apply,3}]}}
&gt;&gt; in context start\\_error
&gt;&gt;
&gt;&gt; Thanks a bunch.
&gt;&gt;
&gt;&gt; Have a great day.
&gt;&gt; Michael
&gt;&gt;
&gt;&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

