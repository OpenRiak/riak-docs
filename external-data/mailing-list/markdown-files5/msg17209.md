---
title: "Re: Solr error message"
description: ""
project: community
lastmod: 2016-04-11T13:34:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17209"
mailinglist_parent_id: "msg17208"
author_name: "Fred Dushin"
project_section: "mailinglistitem"
sent_date: 2016-04-11T13:34:55-07:00
---


Hi Jim,

Interesting problem.

That error is occurring here:

https://github.com/basho/yokozuna/blob/2.1.2/src/yz\\_cover.erl#L275

because length(Mapping) and length(UniqNodes) are unequal:

https://github.com/basho/yokozuna/blob/2.1.2/src/yz\\_cover.erl#L262

This might be because you are getting timeouts trying to query the port on 
remote nodes:

https://github.com/basho/yokozuna/blob/2.1.2/src/yz\\_solr.erl#L324

As you can see, there is a hard-wired 1-second timeout on that RPC call, which 
could account for why you are seeing this failure into a load run.

You might try to rebuild a version of this module with an increased timeout, to 
see if that gets you over the hump, or consider making a configurable timeout.

Riak 2.1.3 ships with yokozuna 2.1.2, who's GIT SHA 
3520d11ec21ee08b7c18478fbbe1b61d7e3d8e0f, so you'd want to branch off that 
point of the tree, if you care to experiment.

If you rebuild the module, you can place the generated beam file in the 
lib/basho-patches directory of each of your riak installs, and restart Riak (or 
manually re-load the module on each node via the Riak console, if you need to 
keep your riak nodes up and running)

Let us know what you find or if you need more assistance.

-Fred

&gt; On Apr 11, 2016, at 4:11 PM, Jim Raney  wrote:
&gt; 
&gt; Failed to determine Solr port for all nodes in search plan

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

