---
title: "Re: Pass json as argument to mapreduce"
description: ""
project: community
lastmod: 2012-07-05T08:37:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07866"
mailinglist_parent_id: "msg07865"
author_name: "Mathias Meyer"
project_section: "mailinglistitem"
sent_date: 2012-07-05T08:37:55-07:00
---


Venki,

The parameter name is arg not args. Also, you were talking about some sort of 
error you're getting, but I couldn't see one in the listing below.

Cheers, Mathias
http://riakhandbook.com





On Thursday, 5. July 2012 at 16:29, Venki Yedidha wrote:

&gt; Thanks,
&gt; I tried the format you sent me earlier but when I tried to access the args 
&gt; parameter inside the function, it is showing me the error:
&gt; 
&gt; {"inputs":['.$k.'],"query":[{"map":{"language":"javascript","source":"function(value,keydata,"arguments"){
&gt; var data = Riak.mapValuesJson(value)[0];
&gt; var obj = {};
&gt; obj[value.key] = {};
&gt; for(var i=1;i&lt;3;i++)
&gt; {
&gt; var gender = \\"G\\"+ i;
&gt; obj[value.key][gender] = {};
&gt; for(var j=1;j&lt;=6;j++)
&gt; {
&gt; var agegroup = \\"A\\" + j;
&gt; obj[value.key][gender][agegroup] = {};
&gt; obj[value.key][gender][agegroup][\\"cpc\\_median\\"] = 
&gt; data[gender][j][agegroup][\\"bid\\_estimations\\"][0][\\"cpc\\_median\\"];
&gt; obj[value.key][gender][agegroup][\\"users\\"] = 
&gt; data[gender][j][agegroup][\\"users\\"];
&gt; 
&gt; }
&gt; }
&gt; return [obj];
&gt; }","args":{"gender":"G0,G1","agegroups":"A0,A2","metrics":"users,cpc\\_median","groupby":"country"},"keep":true}}]}';
&gt; 
&gt; 
&gt; Please help me on the above.
&gt; 
&gt; To clarify my requirement, I would like to access the args parameter (before 
&gt; keep parameter) inside javascript function and if possible I would also like 
&gt; to know the flow that what is the need for args param after js function. 
&gt; 
&gt; Thanks,
&gt; Venkatesh.Y
&gt; 
&gt; On Wed, Jul 4, 2012 at 2:11 PM, Mathias Meyer  (mailto:me...@paperplanes.de)&gt; wrote:
&gt; &gt; Venki,
&gt; &gt; 
&gt; &gt; You don't have to serialize the argument as a JSON string, it can simply be 
&gt; &gt; specified as a normal JSON data structure, just like the other data in the 
&gt; &gt; MapReduce request:
&gt; &gt; 
&gt; &gt; curl -v -d '{"inputs":[["artists", "Beatles"]], 
&gt; &gt; "query":[{"map":{"language":"javascript","source":"function(v, k, a) 
&gt; &gt; {return [a];}","arg":{"paul": true}}}]}' -H "Content-Type: 
&gt; &gt; application/json" http://127.0.0.1:8098/mapred
&gt; &gt; 
&gt; &gt; Cheers, Mathias
&gt; &gt; http://riakhandbook.com
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On Wednesday, 4. July 2012 at 07:26, Venki Yedidha wrote:
&gt; &gt; 
&gt; &gt; &gt; Hi all,
&gt; &gt; &gt; I don't know why, I can't pass a json argument to map function.
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; "inputs":"[b1,k1],[b2,k2],[b3,k3]"
&gt; &gt; &gt; "query":[{map":{"language":"javascript","source":"function(value,keydata,args){}"
&gt; &gt; &gt; 
&gt; &gt; &gt; for the args parameter I need to pass json of the form:
&gt; &gt; &gt; {\\"name\\":\\"venkatesh\\",\\"age\\":24}
&gt; &gt; &gt; (escaped " for json)
&gt; &gt; &gt; but it showing missing variable name..
&gt; &gt; &gt; On the other, If I am passing an array, it is not showing the error...
&gt; &gt; &gt; Please help me on the above.
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks,
&gt; &gt; &gt; Venkatesh
&gt; &gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com) 
&gt; &gt; &gt; (mailto:riak-users@lists.basho.com)
&gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt; 
&gt; 




\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

