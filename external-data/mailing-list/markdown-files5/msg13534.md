---
title: "Re: Basho Product Alert: Active Anti-Entropy in Riak 1.4.4 - 1.4.7"
description: ""
project: community
lastmod: 2014-01-29T09:54:33-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13534"
mailinglist_parent_id: "msg13533"
author_name: "Tom Santero"
project_section: "mailinglistitem"
sent_date: 2014-01-29T09:54:33-08:00
---


Hi Dave,

This bug only affects 1.4.4 thru 1.4.8. The pre-releases of Riak 2.0 are
not affected. That said, remember that Riak 2.0-pre5 and pre11 are not
recommended for production use, and have only been released as a technical
preview.

Thanks,
Tom


On Wed, Jan 29, 2014 at 12:47 PM, Dave Martorana  wrote:

&gt; While nowhere near as important, does this bug also exist in the current
&gt; 2.0 pre-releases?
&gt;
&gt; Thanks,
&gt;
&gt; Dave
&gt;
&gt;
&gt; On Wed, Jan 29, 2014 at 11:38 AM, Tom Santero  wrote:
&gt;
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; Basho Engineering has uncovered a bug in the Active Anti-Entropy (AAE)
&gt;&gt; code in Riak versions 1.4.4 through 1.4.7, inclusive. This code incorrectly
&gt;&gt; generates hashes resulting in AAE failing to repair data. Data will
&gt;&gt; continue to be repaired via the standard read repair mechanisms. As the
&gt;&gt; incorrect hash generation will utilize system resources with no useful
&gt;&gt; result, our official recommendation is that you should not use AAE until a
&gt;&gt; fix is released in 1.4.8.
&gt;&gt;
&gt;&gt; To disable AAE on a running cluster, perform a `riak attach`, then:
&gt;&gt;
&gt;&gt; a.
&gt;&gt; rpc:multicall(riak\\_kv\\_entropy\\_manager, disable, []).
&gt;&gt; rpc:multicall(riak\\_kv\\_entropy\\_manager, cancel\\_exchanges, []).
&gt;&gt; z.
&gt;&gt;
&gt;&gt;
&gt;&gt; then Press Ctrl-c a, then Enter to quit.
&gt;&gt;
&gt;&gt; Next, you'll want to disable AAE on restart. Adjust your the app.config
&gt;&gt; file on all nodes in the cluster in the following manner:
&gt;&gt;
&gt;&gt; % Before
&gt;&gt; {anti\\_entropy, {on, []}}
&gt;&gt;
&gt;&gt; % After
&gt;&gt; {anti\\_entropy, {off, []}}
&gt;&gt;
&gt;&gt;
&gt;&gt; Once again, this issue only affects Riak versions 1.4.4, 1.4.5, 1.4.6,
&gt;&gt; and 1.4.7. There is no need to make changes to your cluster due to this bug
&gt;&gt; if you are not running one of those versions, or if you are not using AAE.
&gt;&gt; A forthcoming Riak 1.4.8 release will address this problem and be released
&gt;&gt; in the next few days.
&gt;&gt;
&gt;&gt;
&gt;&gt; Thank you,
&gt;&gt; Basho
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

