---
title: "Re: No more disk space on a node of my Riak cluster"
description: ""
project: community
lastmod: 2013-03-22T12:16:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10567"
author_name: "Evan Vigil-McClanahan"
project_section: "mailinglistitem"
sent_date: 2013-03-22T12:16:57-07:00
---


Glad to have been able to help.

On Fri, Mar 22, 2013 at 12:11 PM, Godefroy de Compreignac
 wrote:
&gt; Thank you a lot for your help!
&gt;
&gt; I guess I forgot to restart one node after the configuration of a new memory
&gt; backend.
&gt; Anyway, I upgraded all my nodes to Riak 1.3.1, and everything seems to be
&gt; working great!
&gt;
&gt; Godefroy
&gt;
&gt;
&gt; 2013/3/22 Evan Vigil-McClanahan 
&gt;&gt;
&gt;&gt; OK, so there's a lot going on there.
&gt;&gt;
&gt;&gt; &gt; 2013-03-22 12:02:18.719 [error] &lt;0.16959.2526&gt; gen\\_server &lt;0.16959.2526&gt;
&gt;&gt; &gt; terminated with reason: no function clause matching
&gt;&gt; &gt; riak\\_core\\_pb:encode({ts,{1363,205559,674898}},
&gt;&gt; &gt;
&gt;&gt; &gt; {{ts,{1363,205559,674898}},&lt;&lt;131,104,7,100,0,8,114,95,111,98,106,101,99,116,109,0,0,0,14,101,...&gt;&gt;})
&gt;&gt; &gt; line 40
&gt;&gt;
&gt;&gt; This one is usually because you have different settings on the memory
&gt;&gt; backend on two nodes (one with a ttl, the other without). Typically
&gt;&gt; the solution here is to make sure that the settings are the same
&gt;&gt; across the cluster and then do a rolling restart of the cluster.
&gt;&gt;
&gt;&gt;
&gt;&gt; &gt; 2013-03-22 11:28:53.379 [error] &lt;0.28559.1189&gt; gen\\_fsm &lt;0.28559.1189&gt; in
&gt;&gt; &gt; state active terminated with reason: no case clause matching
&gt;&gt; &gt;
&gt;&gt; &gt; {error,bad\\_crc,{state,[{&lt;&lt;"cache"&gt;&gt;,riak\\_kv\\_memory\\_backend,{state,57458783,57450590,57442397,10737418240,31415183,43200}},{&lt;&lt;"storage-kazeo"&gt;&gt;,riak\\_kv\\_bitcask\\_backend,{state,#Ref&lt;0.0.461.178788&gt;,"79925870791533753339264014289171727637433810944",[{data\\_root,"/data/riak/bitcask/storage-kazeo"},{read\\_write,true}],79925870791533753339264014289171727637433810944,"/data/riak/bitcask/storage-kazeo"}},{&lt;&lt;"storage-laprovence"&gt;&gt;,riak\\_kv\\_bitcask\\_backend,{state,#Ref&lt;0.0.461.178779&gt;,"79925870791533753339...",...}},...],...}}
&gt;&gt; &gt; in riak\\_kv\\_vnode:do\\_diffobj\\_put/3 line 1059
&gt;&gt; &gt; 2013-03-22 11:28:53.379 [error]
&gt;&gt; &gt; &lt;0.15853.1198&gt;@riak\\_core\\_handoff\\_receiver:handle\\_info:80 Handoff
&gt;&gt; &gt; receiver
&gt;&gt; &gt; for partition 79925870791533753339264014289171727637433810944 exited
&gt;&gt; &gt; abnormally after processing 5337 objects:
&gt;&gt; &gt;
&gt;&gt; &gt; {{{case\\_clause,{error,bad\\_crc,{state,[{&lt;&lt;"cache"&gt;&gt;,riak\\_kv\\_memory\\_backend,{
&gt;&gt;
&gt;&gt; This one looks like it might be because of some bad data left over
&gt;&gt; from your filling up of the disk. It's possible that upgrading to 1.3
&gt;&gt; will help here, it has better handling of corrupted data in bitcask.
&gt;&gt;
&gt;&gt; If that isn't an option right now, let me know, there may be some
&gt;&gt; other ways to get the corrupted values out of the cluster.
&gt;
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

