---
title: "Re: Riak 2.0.0pre20 Set bucket type problem"
description: ""
project: community
lastmod: 2014-04-14T10:48:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14077"
mailinglist_parent_id: "msg14075"
author_name: "Evan Vigil-McClanahan"
project_section: "mailinglistitem"
sent_date: 2014-04-14T10:48:15-07:00
---


Hi Michael,

the issue there is that the version that we're shipping with in our
official packages is R16B02+patches. It's likely that you've built
with R15B01. The solution here is to use our packages
(http://docs.basho.com/riak/2.0.0pre20/downloads/), or to rebuild
R16B02 or R16B03-1 (we haven't tested the latter extensively, but it
should work).

We'll look into the backwards compatibility issue.

Thanks for the bug report,
Evan.

On Mon, Apr 14, 2014 at 10:29 AM, Michael Duergner
 wrote:
&gt; Hi there,
&gt;
&gt; I tried getting the Riak 2.0.0pre20 example to run.
&gt;
&gt; I'm running on Mac OS X, downloaded the source package, did a make rel and 
&gt; started Riak with all default values.
&gt;
&gt; After set, I created the new bucket-type: riak-admin bucket-type create 
&gt; set\\_bucket '{"props":{"datatype":"set"}}'
&gt;
&gt; and activated it: riak-admin bucket-type activate set\\_bucket
&gt;
&gt; Running riak-admin bucket-type status set\\_bucket results in:
&gt;
&gt; set\\_bucket is active
&gt;
&gt; young\\_vclock: 20
&gt; w: quorum
&gt; small\\_vclock: 50
&gt; rw: quorum
&gt; r: quorum
&gt; pw: 0
&gt; precommit: []
&gt; pr: 0
&gt; postcommit: []
&gt; old\\_vclock: 86400
&gt; notfound\\_ok: true
&gt; n\\_val: 3
&gt; linkfun: {modfun,riak\\_kv\\_wm\\_link\\_walker,mapreduce\\_linkfun}
&gt; last\\_write\\_wins: false
&gt; dw: quorum
&gt; chash\\_keyfun: {riak\\_core\\_util,chash\\_std\\_keyfun}
&gt; big\\_vclock: 50
&gt; basic\\_quorum: false
&gt; allow\\_mult: true
&gt; datatype: set
&gt; active: true
&gt; claimant: 'riak@127.0.0.1'
&gt;
&gt; But when I try to insert data with:
&gt;
&gt; curl -XPOST \\
&gt;&gt; -H "Content-Type: application/json" \\
&gt;&gt; -d '{"add\\_all":["Toronto", "Montreal"]}' \\
&gt;&gt; http://localhost:8098/types/set\\_bucket/buckets/travel/datatypes/cities
&gt;
&gt; I get the following error back:
&gt;
&gt; 500 Internal Server ErrorInternal 
&gt; Server Error
========================

The server encountered an error while processing this 
&gt; request:  

```
{error,
&gt;     {error,undef,
&gt;         [{application,get_env,[riak_dt,binary_compression,true],[]},
&gt;          {riak_dt_orswot,to_binary,1,
&gt;              [{file,"src/riak_dt_orswot.erl"},{line,331}]},
&gt;          
&gt; {riak_kv_crdt,to_binary,1,[{file,"src/riak_kv_crdt.erl"},{line,400}]},
&gt;          {riak_kv_crdt,new,3,[{file,"src/riak_kv_crdt.erl"},{line,390}]},
&gt;          {riak_kv_wm_crdt,process_post,2,
&gt;              [{file,"src/riak_kv_wm_crdt.erl"},{line,367}]},
&gt;          {webmachine_resource,resource_call,3,
&gt;              [{file,"src/webmachine_resource.erl"},{line,186}]},
&gt;          {webmachine_resource,do,3,
&gt;              [{file,"src/webmachine_resource.erl"},{line,142}]},
&gt;          {webmachine_decision_core,resource_call,1,
&gt;              
&gt; [{file,"src/webmachine_decision_core.erl"},{line,48}]}]}}
```


---

mochiweb+webmachine
&gt; web server


&gt;
&gt; Any hints what I'm missing?
&gt;
&gt; Thanks
&gt; Michael
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

