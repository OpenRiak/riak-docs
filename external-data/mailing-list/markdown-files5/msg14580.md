---
title: "Re: repair-2i stops with \"bad argument in call to	eleveldb:async_write\""
description: ""
project: community
lastmod: 2014-07-29T20:52:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14580"
mailinglist_parent_id: "msg14570"
author_name: "bryan hunt"
project_section: "mailinglistitem"
sent_date: 2014-07-29T20:52:15-07:00
---


Hi Simon,

Does the problem persist if you run it again? 

Does it happen if you run it against any other partition?

Best Regards,

Bryan



Bryan Hunt - Client Services Engineer - Basho Technologies Limited - Registered 
Office - 8 Lincolnâ€™s Inn Fields London WC2A 3BP Reg 07970431

On 29 Jul 2014, at 09:35, Effenberg, Simon  wrote:

&gt; Hi,
&gt; 
&gt; we have some issues with 2i queries like that:
&gt; 
&gt; seffenberg@kriak46-1:~$ while :; do curl -s 
&gt; localhost:8098/buckets/conversation/index/createdat\\_int/0/23182680 | ruby 
&gt; -rjson -e "o = JSON.parse(STDIN.read); puts o['keys'].size"; sleep 1; done
&gt; 
&gt; 13853
&gt; 13853
&gt; 0
&gt; 557
&gt; 557
&gt; 557
&gt; 13853
&gt; 0
&gt; 
&gt; 
&gt; ...
&gt; 
&gt; So I tried to start a repair-2i first on one vnode/partition on one node
&gt; (which is quiet new in the cluster.. 2 weeks or so).
&gt; 
&gt; The command is failing with the following log entries:
&gt; 
&gt; seffenberg@kriak46-7:~$ sudo riak-admin repair-2i 
&gt; 22835963083295358096932575511191922182123945984
&gt; Will repair 2i on these partitions:
&gt; 22835963083295358096932575511191922182123945984
&gt; Watch the logs for 2i repair progress reports
&gt; seffenberg@kriak46-7:~$ 2014-07-29 08:20:22.729 UTC [info] 
&gt; &lt;0.5929.1061&gt;@riak\\_kv\\_2i\\_aae:init:139 Starting 2i repair at speed 100 for 
&gt; partitions [22835963083295358096932575511191922182123945984]
&gt; 2014-07-29 08:20:22.729 UTC [info] 
&gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:repair\\_partition:257 Acquired lock on partition 
&gt; 22835963083295358096932575511191922182123945984
&gt; 2014-07-29 08:20:22.729 UTC [info] 
&gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:repair\\_partition:259 Repairing indexes in 
&gt; partition 22835963083295358096932575511191922182123945984
&gt; 2014-07-29 08:20:22.740 UTC [info] 
&gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:create\\_index\\_data\\_db:324 Creating temporary 
&gt; database of 2i data in /var/lib/riak/anti\\_entropy/2i/tmp\\_db
&gt; 2014-07-29 08:20:22.751 UTC [info] 
&gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:create\\_index\\_data\\_db:361 Grabbing all index data 
&gt; for partition 22835963083295358096932575511191922182123945984
&gt; 2014-07-29 08:25:22.752 UTC [info] 
&gt; &lt;0.5929.1061&gt;@riak\\_kv\\_2i\\_aae:next\\_partition:160 Finished 2i repair:
&gt; Total partitions: 1
&gt; Finished partitions: 1
&gt; Speed: 100
&gt; Total 2i items scanned: 0
&gt; Total tree objects: 0
&gt; Total objects fixed: 0
&gt; With errors:
&gt; Partition: 22835963083295358096932575511191922182123945984
&gt; Error: index\\_scan\\_timeout
&gt; 
&gt; 
&gt; 2014-07-29 08:25:22.752 UTC [error] &lt;0.4711.1061&gt; gen\\_server &lt;0.4711.1061&gt; 
&gt; terminated with reason: bad argument in call to 
&gt; eleveldb:async\\_write(#Ref&lt;0.0.10120.211816&gt;, &lt;&lt;&gt;&gt;, 
&gt; [{put,&lt;&lt;131,104,2,109,0,0,0,20,99,111,110,118,101,114,115,97,116,105,111,110,95,115,101,99,114,...&gt;&gt;,...}],
&gt; []) in eleveldb:write/3 line 155
&gt; 2014-07-29 08:25:22.753 UTC [error] &lt;0.4711.1061&gt; CRASH REPORT Process 
&gt; &lt;0.4711.1061&gt; with 0 neighbours exited with reason: bad argument in call to 
&gt; eleveldb:async\\_write(#Ref&lt;0.0.10120.211816&gt;, &lt;&lt;&gt;&gt;, 
&gt; [{put,&lt;&lt;131,104,2,109,0,0,0,20,99,111,110,118,101,114,115,97,116,105,111,110,95,115,101,99,114,...&gt;&gt;,...}],
&gt; []) in eleveldb:write/3 line 155 in gen\\_server:terminate/6 line 747
&gt; 2014-07-29 08:25:22.753 UTC [error] &lt;0.1031.0&gt; Supervisor 
&gt; {&lt;0.1031.0&gt;,poolboy\\_sup} had child riak\\_core\\_vnode\\_worker started with 
&gt; {riak\\_core\\_vnode\\_worker,start\\_link,undefined} at &lt;0.4711.1061&gt; exit with 
&gt; reason bad argument in call to eleveldb:async\\_write(#Ref&lt;0.0.10120.211816&gt;, 
&gt; &lt;&lt;&gt;&gt;, 
&gt; [{put,&lt;&lt;131,104,2,109,0,0,0,20,99,111,110,118,101,114,115,97,116,105,111,110,95,115,101,99,114,...&gt;&gt;,...}],
&gt; []) in eleveldb:write/3 line 155 in context child\\_terminated
&gt; 
&gt; 
&gt; Anything I can do about that? What's the issue here?
&gt; 
&gt; I'm using Riak 1.4.8 (.deb package).
&gt; 
&gt; Cheers
&gt; Simon
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

