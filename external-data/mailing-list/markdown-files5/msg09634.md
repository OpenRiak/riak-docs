---
title: "Re: Riak MR returns JSON Object on occasion"
description: ""
project: community
lastmod: 2012-12-19T11:36:36-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09634"
mailinglist_parent_id: "msg09591"
author_name: "Elias Levy"
project_section: "mailinglistitem"
sent_date: 2012-12-19T11:36:36-08:00
---


Resending as I did not get a response from Basho folks.

Is this expected behavior?



On Fri, Dec 14, 2012 at 5:08 PM, Elias Levy wrote:

&gt; It appears that the Riak MR API can on occasions return a JSON Object,
&gt; rather than an Array. This blows up the Ruby client, and I am guessing
&gt; probably some other ones. I've opened an issue for the Ruby client. See
&gt; https://github.com/basho/riak-ruby-client/issues/67.
&gt;
&gt; I came across the issue while writing an Erlang map phase function to bulk
&gt; fetch values while returning their key. The function is:
&gt;
&gt; map\\_object\\_key\\_value({error, notfound}, \\_, \\_) -&gt; [];
&gt; map\\_object\\_key\\_value(RiakObject, \\_, \\_) -&gt;
&gt; [{ riak\\_object:key(RiakObject), riak\\_object:get\\_value(RiakObject) }].
&gt;
&gt; It appears that Riak (or mochijson2?) will convert an array of 2 tuples
&gt; into a JSON hash when returning the data.
&gt;
&gt; This is actually quite nice, at least for this application, as its exactly
&gt; what I want, but it seems is either undocumented or a bug, since clients do
&gt; not respond well to it.
&gt;
&gt; Thoughts?
&gt;
&gt; Elias Levy
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

