---
title: "Re: Cluster restarted and doesn’t respond to queries"
description: ""
project: community
lastmod: 2013-12-23T11:28:46-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13329"
mailinglist_parent_id: "msg13328"
author_name: "Justin Lambert"
project_section: "mailinglistitem"
sent_date: 2013-12-23T11:28:46-08:00
---


Brian - thanks for that explanation, yep my config is wrong there. We
aren’t using bit cask at all so I can actually clean up the multi backend.
 I’ll get a ticket made for you guys as well.

This config has been out here (and restarted many times) for about 4 or 5
months now. Any idea why the http interface is never returning on queries?
 PB seems to be working fine though after more testing.


On Mon, Dec 23, 2013 at 11:41 AM, Brian Sparrow  wrote:

&gt; Just jumping in:
&gt; The issue is here: {&lt;&lt;"bitcask\\_mult"&gt;&gt;, riak\\_kv\\_bitcask\\_backend, [
&gt;
&gt; {data\\_root, "./data/leveldb”}
&gt;
&gt; The reason riak-admin test works is it uses the default backend in the
&gt; case of multi-backend. Based on your config this is the eleveldb backend
&gt; which already owns these directories and had no issue starting up. This
&gt; should probably be checked during riak start as backend should \\*never\\*
&gt; share a data\\_root.
&gt;
&gt; If you wouldn’t mind making an issue against the riak repo with the
&gt; details of your problem we can work out the best way to check this on
&gt; startup.
&gt;
&gt; The mitigation is to shut the node down, change the bitcask\\_mult data\\_root
&gt; to the correct entry and restart.
&gt;
&gt; Thanks!
&gt;
&gt; --
&gt; Brian Sparrow
&gt; Developer Advocate
&gt; Basho Technologies
&gt;
&gt; Sent with Sparrow 
&gt;
&gt; On Monday, December 23, 2013 at 1:37 PM, Justin Lambert wrote:
&gt;
&gt; Attached is my app.config. It is managed by puppet so I don’t think it
&gt; changed at all. Again, this was just a Centos 6.4 -&gt; CentOS 6.5 upgrade -
&gt; the riak package wasn’t touched at all.
&gt;
&gt; Any thought as to why riak-admin test works but just getting a key with
&gt; curl never returns?
&gt;
&gt;
&gt; On Mon, Dec 23, 2013 at 10:44 AM, Ryan Zezeski  wrote:
&gt;
&gt;
&gt; On Mon, Dec 23, 2013 at 12:35 PM, Justin Lambert 
&gt; wrote:
&gt;
&gt;
&gt; I do see some errors in the error.log, but the referenced directories
&gt; don’t appear to exist:
&gt; 2013-12-23 16:52:33.290 [error]
&gt; &lt;0.1721.0&gt;@riak\\_kv\\_bitcask\\_backend:move\\_unused\\_dirs:607 Failed to move
&gt; unused data directory
&gt; "./data/leveldb/388211372416021087647853783690262677096107081728". Reason:
&gt; eexist
&gt;
&gt;
&gt; This error is interesting. It is coming from the bitcask backend but
&gt; trying to read a leveldb directory. My guess is something happened with
&gt; your configuration when you upgraded. What does your app.config look like?
&gt;
&gt; -Z
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt; Attachments:
&gt; - app.config
&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

