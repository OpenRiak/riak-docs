---
title: "Re: \"consistent\" map/reduce"
description: ""
project: community
lastmod: 2011-11-30T05:37:38-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05800"
mailinglist_parent_id: "msg05750"
author_name: "Kresten Krab Thorup"
project_section: "mailinglistitem"
sent_date: 2011-11-30T05:37:38-08:00
---


Hi Bryan, 

now I've implemented the bulk of this, and obviously have some follow-up 
questions:

1. How do I create the initial inputs? i.e. the list of all {Index, Node} pairs 
that go into the riak\\_kv\\_pipe\\_listkeys fitting. Does this fitting need a 
special chashfun to send it to the right vnode?

2. Given such a pipeline-based thingie installed as .beam files with Riak, is 
there a way to "invoke" it via the HTTP M/R API? It would be great if I don't 
have to poke a new whole through tcp/ip to exploit pipe.

3. Does riak\\_pipe run a fitting instance per node, or per vnode?

FYI, ... I'm considering doing a disk-based version of riak\\_pipe\\_w\\_reduce, 
which keeps the intermediate results in a local K/V store, in order to support 
large keysets. This could just be a bitcask w/merge disabled. 
Re-implementing the reducer would also allow us to evaluate the N&gt;R condition 
in the reducer, and emit results as early as possible.


Kresten

Mobile: + 45 2343 4626 | Skype: krestenkrabthorup | Twitter: @drkrab
Trifork A/S | Margrethepladsen 4 | DK- 8000 Aarhus C | Phone : +45 8732 
8787 | www.trifork.com
 


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

