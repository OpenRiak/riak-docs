---
title: "Re: repair-2i stops with \"bad argument in call	to	eleveldb:async_write\""
description: ""
project: community
lastmod: 2014-07-30T01:52:06-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14583"
mailinglist_parent_id: "msg14582"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2014-07-30T01:52:06-07:00
---


Hi Simon, 
So the earlier “this is on wheezy, rest are on squeeze” thing is no longer a 
factor?

Any and all 2i repair you do ends with the same error?

Cheers

Russell

On 30 Jul 2014, at 07:29, Effenberg, Simon  wrote:

&gt; I tried it now with one partition on 6 different machines and everywhere the 
&gt; same result: index\\_scan\\_timeout and the info: bad argument in call to 
&gt; eleveldb:async\\_get (2x) or async\\_write (4x).
&gt; 
&gt; 
&gt; Von Samsung Mobile gesendet
&gt; 
&gt; 
&gt; -------- Ursprüngliche Nachricht --------
&gt; Von: "Effenberg, Simon"
&gt; Datum:30.07.2014 07:49 (GMT+01:00)
&gt; An: bryan hunt
&gt; Cc: riak-users@lists.basho.com
&gt; Betreff: AW: repair-2i stops with "bad argument in call to 
&gt; eleveldb:async\\_write"
&gt; 
&gt; Hi,
&gt; 
&gt; I tried it on two different nodes with one partition each. Both multiple 
&gt; times before the upgrade and after the upgrade.
&gt; 
&gt; I will try it on other machines in a minute but because I tried it already on 
&gt; two different nodes and one of them is 2 weeks old and stored on a HP 3par I 
&gt; bet that this is not a disk corruption issue..
&gt; 
&gt; Simon
&gt; 
&gt; 
&gt; Von Samsung Mobile gesendet
&gt; 
&gt; 
&gt; -------- Ursprüngliche Nachricht --------
&gt; Von: bryan hunt
&gt; Datum:29.07.2014 18:21 (GMT+01:00)
&gt; An: "Effenberg, Simon"
&gt; Cc: riak-users@lists.basho.com
&gt; Betreff: Re: repair-2i stops with "bad argument in call to 
&gt; eleveldb:async\\_write"
&gt; 
&gt; Hi Simon,
&gt; 
&gt; Does the problem persist if you run it again? 
&gt; 
&gt; Does it happen if you run it against any other partition?
&gt; 
&gt; Best Regards,
&gt; 
&gt; Bryan
&gt; 
&gt; 
&gt; 
&gt; Bryan Hunt - Client Services Engineer - Basho Technologies Limited - 
&gt; Registered Office - 8 Lincoln’s Inn Fields London WC2A 3BP Reg 07970431
&gt; 
&gt; On 29 Jul 2014, at 09:35, Effenberg, Simon  wrote:
&gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; we have some issues with 2i queries like that:
&gt; &gt; 
&gt; &gt; seffenberg@kriak46-1:~$ while :; do curl -s 
&gt; &gt; localhost:8098/buckets/conversation/index/createdat\\_int/0/23182680 | ruby 
&gt; &gt; -rjson -e "o = JSON.parse(STDIN.read); puts o['keys'].size"; sleep 1; done
&gt; &gt; 
&gt; &gt; 13853
&gt; &gt; 13853
&gt; &gt; 0
&gt; &gt; 557
&gt; &gt; 557
&gt; &gt; 557
&gt; &gt; 13853
&gt; &gt; 0
&gt; &gt; 
&gt; &gt; 
&gt; &gt; ...
&gt; &gt; 
&gt; &gt; So I tried to start a repair-2i first on one vnode/partition on one node
&gt; &gt; (which is quiet new in the cluster.. 2 weeks or so).
&gt; &gt; 
&gt; &gt; The command is failing with the following log entries:
&gt; &gt; 
&gt; &gt; seffenberg@kriak46-7:~$ sudo riak-admin repair-2i 
&gt; &gt; 22835963083295358096932575511191922182123945984
&gt; &gt; Will repair 2i on these partitions:
&gt; &gt; 22835963083295358096932575511191922182123945984
&gt; &gt; Watch the logs for 2i repair progress reports
&gt; &gt; seffenberg@kriak46-7:~$ 2014-07-29 08:20:22.729 UTC [info] 
&gt; &gt; &lt;0.5929.1061&gt;@riak\\_kv\\_2i\\_aae:init:139 Starting 2i repair at speed 100 for 
&gt; &gt; partitions [22835963083295358096932575511191922182123945984]
&gt; &gt; 2014-07-29 08:20:22.729 UTC [info] 
&gt; &gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:repair\\_partition:257 Acquired lock on 
&gt; &gt; partition 22835963083295358096932575511191922182123945984
&gt; &gt; 2014-07-29 08:20:22.729 UTC [info] 
&gt; &gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:repair\\_partition:259 Repairing indexes in 
&gt; &gt; partition 22835963083295358096932575511191922182123945984
&gt; &gt; 2014-07-29 08:20:22.740 UTC [info] 
&gt; &gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:create\\_index\\_data\\_db:324 Creating temporary 
&gt; &gt; database of 2i data in /var/lib/riak/anti\\_entropy/2i/tmp\\_db
&gt; &gt; 2014-07-29 08:20:22.751 UTC [info] 
&gt; &gt; &lt;0.5930.1061&gt;@riak\\_kv\\_2i\\_aae:create\\_index\\_data\\_db:361 Grabbing all index 
&gt; &gt; data for partition 22835963083295358096932575511191922182123945984
&gt; &gt; 2014-07-29 08:25:22.752 UTC [info] 
&gt; &gt; &lt;0.5929.1061&gt;@riak\\_kv\\_2i\\_aae:next\\_partition:160 Finished 2i repair:
&gt; &gt; Total partitions: 1
&gt; &gt; Finished partitions: 1
&gt; &gt; Speed: 100
&gt; &gt; Total 2i items scanned: 0
&gt; &gt; Total tree objects: 0
&gt; &gt; Total objects fixed: 0
&gt; &gt; With errors:
&gt; &gt; Partition: 22835963083295358096932575511191922182123945984
&gt; &gt; Error: index\\_scan\\_timeout
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 2014-07-29 08:25:22.752 UTC [error] &lt;0.4711.1061&gt; gen\\_server &lt;0.4711.1061&gt; 
&gt; &gt; terminated with reason: bad argument in call to 
&gt; &gt; eleveldb:async\\_write(#Ref&lt;0.0.10120.211816&gt;, &lt;&lt;&gt;&gt;, 
&gt; &gt; [{put,&lt;&lt;131,104,2,109,0,0,0,20,99,111,110,118,101,114,115,97,116,105,111,110,95,115,101,99,114,...&gt;&gt;,...}],
&gt; &gt; []) in eleveldb:write/3 line 155
&gt; &gt; 2014-07-29 08:25:22.753 UTC [error] &lt;0.4711.1061&gt; CRASH REPORT Process 
&gt; &gt; &lt;0.4711.1061&gt; with 0 neighbours exited with reason: bad argument in call to 
&gt; &gt; eleveldb:async\\_write(#Ref&lt;0.0.10120.211816&gt;, &lt;&lt;&gt;&gt;, 
&gt; &gt; [{put,&lt;&lt;131,104,2,109,0,0,0,20,99,111,110,118,101,114,115,97,116,105,111,110,95,115,101,99,114,...&gt;&gt;,...}],
&gt; &gt; []) in eleveldb:write/3 line 155 in gen\\_server:terminate/6 line 747
&gt; &gt; 2014-07-29 08:25:22.753 UTC [error] &lt;0.1031.0&gt; Supervisor 
&gt; &gt; {&lt;0.1031.0&gt;,poolboy\\_sup} had child riak\\_core\\_vnode\\_worker started with 
&gt; &gt; {riak\\_core\\_vnode\\_worker,start\\_link,undefined} at &lt;0.4711.1061&gt; exit with 
&gt; &gt; reason bad argument in call to eleveldb:async\\_write(#Ref&lt;0.0.10120.211816&gt;, 
&gt; &gt; &lt;&lt;&gt;&gt;, 
&gt; &gt; [{put,&lt;&lt;131,104,2,109,0,0,0,20,99,111,110,118,101,114,115,97,116,105,111,110,95,115,101,99,114,...&gt;&gt;,...}],
&gt; &gt; []) in eleveldb:write/3 line 155 in context child\\_terminated
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Anything I can do about that? What's the issue here?
&gt; &gt; 
&gt; &gt; I'm using Riak 1.4.8 (.deb package).
&gt; &gt; 
&gt; &gt; Cheers
&gt; &gt; Simon
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

