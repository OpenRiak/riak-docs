---
title: "RE: Riak 1.3.1 install from source on closed network"
description: ""
project: community
lastmod: 2013-04-16T02:03:32-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10896"
mailinglist_parent_id: "msg10894"
author_name: "HARLOW Peter"
project_section: "mailinglistitem"
sent_date: 2013-04-16T02:03:32-07:00
---


&gt; -----Original Message-----
&gt; From: Hector Castro [mailto:hec...@basho.com]
&gt; Sent: Monday, April 15, 2013 11:40 PM
&gt; To: HARLOW Peter
&gt; Cc: Jared Morrow; riak-users@lists.basho.com
&gt; Subject: Re: Riak 1.3.1 install from source on closed network
&gt; 
&gt; Hi Peter,
&gt; 
&gt; Despite the fact that the instructions assume you're working with Riak
&gt; 1.3.0, please follow the "Installation on Closed Networks" section on
&gt; the installing Riak from source page [0]. The steps there, combined
&gt; with Jared's instructions to alter line 79 of Makefile [1] so that it
&gt; reads:
&gt; 
&gt; dev% : riaknostic
&gt; 
&gt; instead of:
&gt; 
&gt; dev% : all riaknostic
&gt; 
&gt; should allow you to successfully complete an installation without a
&gt; network connection (after downloading the 1.3.0 zipball for LevelDB).
&gt; 
&gt; Please let us know if you encounter further issues.

Hello Hector,

That nearly worked, except that there was no riaknostic/deps directory to 
receive the copies of lager/getopt/meck.
So, adding that directory, the procedure I get is:

tar -zxvf riak-1.3.1.tar.gz
mv basho-leveldb-1.3.0-0-gdbb3e19.zip riak-1.3.1/deps/eleveldb/c\\_src/leveldb.zip
cd riak-1.3.1/deps/eleveldb/c\\_src/
unzip leveldb.zip
mv basho-leveldb-\\* leveldb
cd ../../
mkdir riaknostic/deps
cp -R lager riaknostic/deps
cp -R getopt riaknostic/deps
cp -R meck riaknostic/deps
cd ../
# edit line 79 of makefile 'all riaknostic' -&gt; 'riaknostic'
make rel
make devrel

which compiles!

Thanks for your help,

Peter Harlow
Systems Engineer
Thales Communications & Security S.A
T&S-Billetique/Projets & Systemes/I&A
Rue de la Mare aux Joncs
91229 Bretigny sur Orge Cedex
Tel: +33 (0) 1 69 88 59 41
Fax: +33 (0)1 69 88 57 35
Email :   peter.har...@thalesgroup.com

&gt; On Mon, Apr 15, 2013 at 9:28 AM, HARLOW Peter
&gt;  wrote:
&gt; &gt; From: Jared Morrow [mailto:ja...@basho.com]
&gt; &gt; Sent: Monday, April 15, 2013 2:10 PM
&gt; &gt;
&gt; &gt;
&gt; &gt; To: HARLOW Peter
&gt; &gt; Cc: riak-users@lists.basho.com
&gt; &gt; Subject: Re: Riak 1.3.1 install from source on closed network
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Peter,
&gt; &gt;
&gt; &gt; I see where you hit your problem. In the 'make devrel' step it did
&gt; try to go
&gt; &gt; out to the network to re-clone all of the dependencies. To fix this,
&gt; simply
&gt; &gt; change this line in the Makefile:
&gt; &gt; https://github.com/basho/riak/blob/riak-1.3.1/Makefile#L79 from
&gt; &gt;
&gt; &gt; dev% : all riaknostic
&gt; &gt;
&gt; &gt; to
&gt; &gt;
&gt; &gt; dev% : riaknostic
&gt; &gt;
&gt; &gt; Remove the 'dev' directory to make sure everything is clean and try
&gt; to run
&gt; &gt; 'make devrel' again.
&gt; &gt;
&gt; &gt; Let me know how that goes.
&gt; &gt;
&gt; &gt; A devrel directory didn't seem to get generated - but I unpacked a
&gt; new
&gt; &gt; source tree to be sure.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Unfortunately there was no change.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Make all completed, but make devrel produced the same errors as
&gt; before.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Regards,
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Peter Harlow
&gt; &gt;
&gt; &gt; Systems Engineer
&gt; &gt;
&gt; &gt; Thales Communications & Security S.A
&gt; &gt;
&gt; &gt; T&S-Billetique/Projets & Systemes/I&A
&gt; &gt;
&gt; &gt; Rue de la Mare aux Joncs
&gt; &gt;
&gt; &gt; 91229 Bretigny sur Orge Cedex
&gt; &gt;
&gt; &gt; Tel: +33 (0) 1 69 88 59 41
&gt; &gt;
&gt; &gt; Fax: +33 (0)1 69 88 57 35
&gt; &gt;
&gt; &gt; Email : peter.har...@thalesgroup.com
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; From: Jared Morrow [mailto:ja...@basho.com]
&gt; &gt; Sent: Monday, April 15, 2013 2:10 PM
&gt; &gt;
&gt; &gt;
&gt; &gt; To: HARLOW Peter
&gt; &gt; Cc: riak-users@lists.basho.com
&gt; &gt; Subject: Re: Riak 1.3.1 install from source on closed network
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Peter,
&gt; &gt;
&gt; &gt; I see where you hit your problem. In the 'make devrel' step it did
&gt; try to go
&gt; &gt; out to the network to re-clone all of the dependencies. To fix this,
&gt; simply
&gt; &gt; change this line in the Makefile:
&gt; &gt; https://github.com/basho/riak/blob/riak-1.3.1/Makefile#L79 from
&gt; &gt;
&gt; &gt; dev% : all riaknostic
&gt; &gt;
&gt; &gt; to
&gt; &gt;
&gt; &gt; dev% : riaknostic
&gt; &gt;
&gt; &gt; Remove the 'dev' directory to make sure everything is clean and try
&gt; to run
&gt; &gt; 'make devrel' again.
&gt; &gt;
&gt; &gt; Let me know how that goes.
&gt; &gt;
&gt; &gt; Sorry for the troubles,
&gt; &gt; Jared
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; On Mon, Apr 15, 2013 at 3:25 AM, HARLOW Peter
&gt; 
&gt; &gt; wrote:
&gt; &gt;
&gt; &gt; From: Jared Morrow [mailto:ja...@basho.com]
&gt; &gt; Sent: Friday, April 12, 2013 3:23 PM
&gt; &gt; To: HARLOW Peter
&gt; &gt; Cc: riak-users@lists.basho.com
&gt; &gt; Subject: Re: Riak 1.3.1 install from source on closed network
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;&gt;Peter,
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;&gt;For 1.3.0 & 1.3.1 of Riak, you use the "1.3.0" version of leveldb.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Thanks, Jared.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Unfortunately I am not getting very far with this. I can't find the
&gt; &gt; instructions I used with version 1.2.1, but copying the procedure
&gt; from that
&gt; &gt; machine:
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; tar -zxvf riak-1.3.1.tar.gz
&gt; &gt;
&gt; &gt; mv basho-leveldb-1.3.0-0-gdbb3e19.zip
&gt; &gt; riak-1.3.1/deps/eleveldb/c\\_src/leveldb.zip
&gt; &gt;
&gt; &gt; cd riak-1.3.1/deps/eleveldb/c\\_src/
&gt; &gt;
&gt; &gt; unzip leveldb.zip
&gt; &gt;
&gt; &gt; mv basho-leveldb-\\* leveldb
&gt; &gt;
&gt; &gt; cd ../../../
&gt; &gt;
&gt; &gt; make all
&gt; &gt;
&gt; &gt; make devrel
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; …make all seems to run but make devrel finishes with the errors:
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; make[1]: Entering directory `/home/riak/riak/riak-
&gt; 1.3.1/deps/riaknostic'
&gt; &gt;
&gt; &gt; ./rebar get-deps
&gt; &gt;
&gt; &gt; ==&gt; riaknostic (get-deps)
&gt; &gt;
&gt; &gt; Pulling lager from {git,"git://github.com/basho/lager",{tag,"1.2.2"}}
&gt; &gt;
&gt; &gt; fatal: Unable to look up github.com (port 9418) (Temporary failure in
&gt; name
&gt; &gt; resolution)
&gt; &gt;
&gt; &gt; Initialized empty Git repository in
&gt; &gt; /home/riak/riak/riak-1.3.1/deps/riaknostic/deps/lager/.git/
&gt; &gt;
&gt; &gt; ERROR: git clone -n git://github.com/basho/lager lager failed with
&gt; error:
&gt; &gt; 128 and output:
&gt; &gt;
&gt; &gt; fatal: Unable to look up github.com (port 9418) (Temporary failure in
&gt; name
&gt; &gt; resolution)
&gt; &gt;
&gt; &gt; Initialized empty Git repository in
&gt; &gt; /home/riak/riak/riak-1.3.1/deps/riaknostic/deps/lager/.git/
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; make[1]: \\*\\*\\* [deps] Error 1
&gt; &gt;
&gt; &gt; make[1]: Leaving directory `/home/riak/riak/riak-
&gt; 1.3.1/deps/riaknostic'
&gt; &gt;
&gt; &gt; make: \\*\\*\\* [riaknostic] Error 2
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; OS: CentOS 6.4 64-bit
&gt; &gt;
&gt; &gt; Erlang: R15B01
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Regards,
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Peter Harlow
&gt; &gt;
&gt; &gt; Systems Engineer
&gt; &gt;
&gt; &gt; Thales Communications & Security S.A
&gt; &gt;
&gt; &gt; T&S-Billetique/Projets & Systemes/I&A
&gt; &gt;
&gt; &gt; Rue de la Mare aux Joncs
&gt; &gt;
&gt; &gt; 91229 Bretigny sur Orge Cedex
&gt; &gt;
&gt; &gt; Tel: +33 (0) 1 69 88 59 41
&gt; &gt;
&gt; &gt; Fax: +33 (0)1 69 88 57 35
&gt; &gt;
&gt; &gt; Email : peter.har...@thalesgroup.com
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

