---
title: "Re: restarted node tells me about to handoff partitions (changing	format to v1)"
description: ""
project: community
lastmod: 2013-12-16T06:09:40-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13255"
mailinglist_parent_id: "msg13252"
author_name: "Shane McEwan"
project_section: "mailinglistitem"
sent_date: 2013-12-16T06:09:40-08:00
---



On 16/12/13 09:56, Simon Effenberg wrote:

after an upgrade from 1.3.1 to 1.4.2 I changed the object format from
v0 to v1 and began a rolling restart. But restarting the first node
shows me some weird outputs:

'riak@10.46.109.201' waiting to handoff 132 partitions

this is the "restarted" node and the partitions is switching between
121 and 132 .. after some time it decreases to something between 110
and 120.. and after some more time it is now decreasing slowly.

My question is: why/how can it be that the restarted node has stuff to
handover? Shouldn't it be the other way around (there were no handovers
in the "riak-admin transfers" before the restart).


I've seen this behaviour before, even in earlier versions. I assume that 
when a Riak node starts up it needs to check each of its partitions 
against the copies on the other nodes in order to determine if it needs 
to send or receive updates. So the message should really say something 
like: "waiting to check 132 partions."


The corresponding messages in the log are slightly clearer:

hinted\\_handoff transfer of riak\\_kv\\_vnode from 'riak@10.2.1.1' 
485264215520026359559817229612828346370133852160 to 'riak@10.2.1.2' 
485264215520026359559817229612828346370133852160 completed: sent 0 
objects in 0.04 seconds


The fact that it sent 0 objects tells me that it didn't actually need to 
repair anything.


Shane.


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

