---
title: "Re: Cluster aware clients"
description: ""
project: community
lastmod: 2014-08-15T09:48:07-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14669"
mailinglist_parent_id: "msg14662"
author_name: "Tom Santero"
project_section: "mailinglistitem"
sent_date: 2014-08-15T09:48:07-07:00
---


My preference is for each client application node to connect to an instance
of haproxy on the localhost, that way cluster changes only requires
updating and reloading the haproxy config--which is cleaner and safer for
production services.

An example haxproxy config can be found on the Riak docs:
http://docs.basho.com/riak/latest/ops/advanced/configs/load-balancing-proxy/#HAProxy


On Fri, Aug 15, 2014 at 11:32 AM, Daniel Simms 
wrote:

&gt; &lt; 2.0 the java cluster client was actively unhelpful (in that it didn't
&gt; track node health, so if one node was down, the client would regularly try
&gt; it still, IIRC), and a client-local haproxy (or such) is the way to go.
&gt;
&gt; &gt;= 2.0 the java cluster client looks like it's smarter about tracking node
&gt; health (but I'm not using it in anger and therefore don't know if it's
&gt; otherwise suitable and would be curious if anyone is happily using it
&gt; without haproxy)
&gt;
&gt;
&gt; On Fri, Aug 15, 2014 at 6:18 AM, Paul Barry 
&gt; wrote:
&gt;
&gt;&gt; We’ve been using Riak with Java client for more than two years in
&gt;&gt; production, and best solution is ha-proxy.
&gt;&gt; Your Java client connects to one ha-proxy, configured for round-robin to
&gt;&gt; all the nodes. We run ha-proxy on our front-ends, so clients always connect
&gt;&gt; to localhost.
&gt;&gt;
&gt;&gt; If you’re planning to add or remove a node, just reconfigure ha-proxy and
&gt;&gt; reload it (instant with no down-time).
&gt;&gt; ha-proxy also gives you much better control over how unexpected failures
&gt;&gt; are dealt with automatically.
&gt;&gt;
&gt;&gt; pb
&gt;&gt;
&gt;&gt; On 15 Aug 2014, at 13:19, Simon Hartley 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; So I’m writing a Java client app. I’m running a 5 node Riak cluster and I
&gt;&gt; want my client to know about all the nodes to avoid single points of
&gt;&gt; failure.
&gt;&gt;
&gt;&gt; Is there a best practice for automatically updating clients when new
&gt;&gt; nodes are added to a cluster?
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

