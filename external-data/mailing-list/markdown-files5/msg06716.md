---
title: "Re: \"forward_preflist\" timeout error after 1.1 upgrade"
description: ""
project: community
lastmod: 2012-02-23T13:18:34-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06716"
mailinglist_parent_id: "msg06682"
author_name: "Bryan Fink"
project_section: "mailinglistitem"
sent_date: 2012-02-23T13:18:34-08:00
---


On Wed, Feb 22, 2012 at 11:26 AM, Matthew A. Brown
 wrote:
&gt; Hi all,
&gt;
&gt; We're seeing a new timeout error after upgrading our cluster to Riak
&gt; 1.1. The error message:
&gt;
&gt; {"phase":0,"error":"[timeout]","input":"{{&lt;&lt;\\"service\\_profiles\\"&gt;&gt;,&lt;&lt;\\"8fh/2\\"&gt;&gt;},{struct,[{&lt;&lt;\\"key\\"&gt;&gt;,&lt;&lt;\\"s-10925\\"&gt;&gt;}]}}","type":"forward\\_preflist","stack":"[]"}

Hi, Matthew. This is, indeed, a bit of a bug. I've filed an issue:
https://github.com/basho/riak\\_kv/issues/290

The general problem is that the inputs to the fetch half of your map
phase are outrunning the rate at which it can pump outputs to the
processing half. This means that the queues for the fetchers get
backed up, and that leaves no place for retry requests to go when
fetchers run into not-founds and the like. It ends up causing errors
(which are internal timeouts of a sort, unrelated to the timeout
you've set), which causes the MapReduce endpoint to kill the query.

If you're willing to recompile riak, you can modify the `q\\_limit`
fields in the pipe spec I mentioned in `riak\\_kv\\_mrc\\_pipe`. Otherwise,
the most likely fix (until we resolve the issue) is to make the map
function (and anything else downstream) as fast as possible so it will
keep up.

Hope that helps,
Bryan

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

