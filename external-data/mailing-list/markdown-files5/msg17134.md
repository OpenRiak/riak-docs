---
title: "Re: Riak_ensemble implementation"
description: ""
project: community
lastmod: 2016-03-08T18:47:09-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17134"
mailinglist_parent_id: "msg17137"
author_name: "Sargun Dhillon"
project_section: "mailinglistitem"
sent_date: 2016-03-08T18:47:09-08:00
---


Riak\\_kv sits atop riak\\_ensemble, which is a multipaxos implementation.

On Tue, Mar 8, 2016 at 6:41 PM, Agung Laksono  wrote:
&gt; Thank you for answering the question.
&gt;
&gt; @Sargun: Right now, I'm interested in testing Riak-ensemble
&gt; with a distributed model checker like SAMC. In the cluster membership
&gt; in the documentation, I found steps to activate a cluster, add a node,
&gt; create an ensemble. However, is there any example to implement those
&gt; processes?
&gt;
&gt; And one more question: Does Riak-kv implement multi-paxos or paxos-like
&gt; protocols?
&gt;
&gt; Actually, my target is so simple, I just need to be able to put some
&gt; key-value by
&gt; executing the multi-paxos.
&gt;
&gt; On Tue, Mar 8, 2016 at 11:39 PM, Sargun Dhillon  wrote:
&gt;&gt;
&gt;&gt; If you want to learn to use riak\\_ensemble the library, the
&gt;&gt; documentation that Joe put together (and others)
&gt;&gt; https://github.com/basho/riak\\_ensemble/blob/develop/doc/Readme.md
&gt;&gt;
&gt;&gt; There's real world usage of the code here:
&gt;&gt; -https://github.com/basho/riak\\_kv/blob/develop/src/riak\\_kv\\_ensembles.erl
&gt;&gt;
&gt;&gt; Basically as a user, you have to create the root ensemble, add all
&gt;&gt; your nodes to it, and then create your individual, "sub-ensembles".
&gt;&gt;
&gt;&gt; You need to implement a backend, and this is a rough sketch of one:
&gt;&gt;
&gt;&gt; https://github.com/basho/riak\\_ensemble/blob/develop/src/riak\\_ensemble\\_basic\\_backend.erl
&gt;&gt;
&gt;&gt; Due the design of Riak ensemble, and the fact that's it's effectively
&gt;&gt; a bunch of individual vertical Paxos group in conjunction with its
&gt;&gt; usage of single decree, over multi-decree paxos it has some
&gt;&gt; interesting fault-recovery semantics. An example of this is the
&gt;&gt; adjustable paranoia level -- it has some strong failure-recovery
&gt;&gt; semantics, so in the highest paranoia mode, if you have 5 nodes, and
&gt;&gt; one fails. When that node comes back, it will have to sync with 3/5 of
&gt;&gt; the other nodes to be considered good to go.
&gt;&gt;
&gt;&gt; Even with this, riak ensemble is a pretty easy, fun library to use.
&gt;&gt; The fact that it's a composition of single decree paxos groups it
&gt;&gt; makes it much simpler to understand, and you can implement SMR atop
&gt;&gt; it, like so: https://github.com/sargun/riak\\_ensemble/commits/sargun/redis
&gt;&gt; (see the few extra commits)
&gt;&gt;
&gt;&gt; On Tue, Mar 8, 2016 at 8:19 AM, Carlos González Florido
&gt;&gt;  wrote:
&gt;&gt; &gt; You may have a look at nkbase[1] that includes riak\\_ensemble as one of
&gt;&gt; &gt; it
&gt;&gt; &gt; working models.
&gt;&gt; &gt;
&gt;&gt; &gt; [1]
&gt;&gt; &gt;
&gt;&gt; &gt; https://github.com/NetComposer/nkbase/blob/master/doc/strong\\_consistency.md
&gt;&gt; &gt;
&gt;&gt; &gt; Carlos González
&gt;&gt; &gt; NetComposer
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; On Mon, Mar 7, 2016 at 4:48 AM, Agung Laksono
&gt;&gt; &gt; 
&gt;&gt; &gt; wrote:
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Hi Basho developer,
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; I've seen the video that you guys present about rian\\_ensemble. I am
&gt;&gt; &gt;&gt; interesting to implement riak\\_ensemble in the production environment in
&gt;&gt; &gt;&gt; the
&gt;&gt; &gt;&gt; future. After reading the
&gt;&gt; &gt;&gt; documentation(https://github.com/basho/riak\\_ensemble/tree/develop/doc),
&gt;&gt; &gt;&gt; I
&gt;&gt; &gt;&gt; still couldn't understand how it's work and implement it. Could you
&gt;&gt; &gt;&gt; tell me
&gt;&gt; &gt;&gt; in a simple way to implement it in the single node to simulate multiple
&gt;&gt; &gt;&gt; nodes or 3 real nodes?
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; So far, I can compile riak\\_ensemble via rebar and run
&gt;&gt; &gt;&gt; application:ensure\\_all\\_started(riak\\_ensemble). But I don't know what
&gt;&gt; &gt;&gt; should
&gt;&gt; &gt;&gt; I do after that(sent K/V, communicate to other nodes, etc)
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Thank you in advance.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; --
&gt;&gt; &gt;&gt; Warm Regards,
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Agung Laksono
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; &gt;&gt; riak-users mailing list
&gt;&gt; &gt;&gt; riak-users@lists.basho.com
&gt;&gt; &gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;
&gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; &gt;
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Warm Regards,
&gt;
&gt; Agung Laksono

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

