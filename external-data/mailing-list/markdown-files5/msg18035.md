---
title: "Re: Yokozuna's inconsistent query problem"
description: ""
project: community
lastmod: 2017-02-27T01:25:39-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18035"
mailinglist_parent_id: "msg18026"
author_name: "Witeman Zheng"
project_section: "mailinglistitem"
sent_date: 2017-02-27T01:25:39-08:00
---


Curious enough, when I leaved 5 of 10 nodes, everything goes well again.

No index missed.

But when I had 10 nodes, the read repair cannot help to find back the index.

I found RiakTS is still in very beginning stage, I nearly try to shift from 
RiakKV + YZ to RiakTS.


Best regards,
Witeman
&gt; On 24 Feb 2017, at 3:26 PM, Witeman Zheng  &gt; wrote:
&gt; 
&gt; Hello Fred,
&gt; 
&gt; riak-admin aae-status:
&gt; ================================== Exchanges 
&gt; ==================================
&gt; Index Last (ago) All (ago) 
&gt; -------------------------------------------------------------------------------
&gt; 0 12.9 min 14.2 min 
&gt; 57089907708238395242331438777979805455309864960 9.1 min 30.6 min 
&gt; 114179815416476790484662877555959610910619729920 7.6 min 29.1 min 
&gt; 171269723124715185726994316333939416365929594880 6.1 min 27.6 min 
&gt; 228359630832953580969325755111919221821239459840 4.6 min 26.1 min 
&gt; 285449538541191976211657193889899027276549324800 3.1 min 24.6 min 
&gt; 342539446249430371453988632667878832731859189760 1.6 min 23.1 min 
&gt; 399629353957668766696320071445858638187169054720 6.4 s 21.6 min 
&gt; 456719261665907161938651510223838443642478919680 56.5 s 36.4 min 
&gt; 513809169374145557180982949001818249097788784640 18.6 min 38.9 min 
&gt; 570899077082383952423314387779798054553098649600 17.1 min 37.4 min 
&gt; 627988984790622347665645826557777860008408514560 15.6 min 35.9 min 
&gt; 685078892498860742907977265335757665463718379520 14.1 min 34.4 min 
&gt; 742168800207099138150308704113737470919028244480 12.6 min 32.9 min 
&gt; 799258707915337533392640142891717276374338109440 11.1 min 31.4 min 
&gt; 856348615623575928634971581669697081829647974400 9.6 min 29.9 min 
&gt; 913438523331814323877303020447676887284957839360 8.1 min 28.4 min 
&gt; 970528431040052719119634459225656692740267704320 6.6 min 26.9 min 
&gt; 1027618338748291114361965898003636498195577569280 5.1 min 25.4 min 
&gt; 1084708246456529509604297336781616303650887434240 3.6 min 23.9 min 
&gt; 1141798154164767904846628775559596109106197299200 2.1 min 22.4 min 
&gt; 1198888061873006300088960214337575914561507164160 33.2 s 20.9 min 
&gt; 1255977969581244695331291653115555720016817029120 15.1 min 36.6 min 
&gt; 1313067877289483090573623091893535525472126894080 13.6 min 35.1 min 
&gt; 1370157784997721485815954530671515330927436759040 12.1 min 33.6 min 
&gt; 1427247692705959881058285969449495136382746624000 10.6 min 32.1 min 
&gt; 
&gt; ================================ Entropy Trees 
&gt; ================================
&gt; Index Built (ago)
&gt; -------------------------------------------------------------------------------
&gt; 0 6.8 d
&gt; 57089907708238395242331438777979805455309864960 14.5 hr
&gt; 114179815416476790484662877555959610910619729920 2.5 hr
&gt; 171269723124715185726994316333939416365929594880 6.5 hr
&gt; 228359630832953580969325755111919221821239459840 5.5 hr
&gt; 285449538541191976211657193889899027276549324800 7.0 d
&gt; 342539446249430371453988632667878832731859189760 1.4 d
&gt; 399629353957668766696320071445858638187169054720 6.6 d
&gt; 456719261665907161938651510223838443642478919680 1.5 hr
&gt; 513809169374145557180982949001818249097788784640 4.5 hr
&gt; 570899077082383952423314387779798054553098649600 1.4 d
&gt; 627988984790622347665645826557777860008408514560 1.4 d
&gt; 685078892498860742907977265335757665463718379520 6.7 d
&gt; 742168800207099138150308704113737470919028244480 6.8 d
&gt; 799258707915337533392640142891717276374338109440 6.9 d
&gt; 856348615623575928634971581669697081829647974400 1.3 d
&gt; 913438523331814323877303020447676887284957839360 3.5 hr
&gt; 970528431040052719119634459225656692740267704320 6.9 d
&gt; 1027618338748291114361965898003636498195577569280 7.5 hr
&gt; 1084708246456529509604297336781616303650887434240 6.9 d
&gt; 1141798154164767904846628775559596109106197299200 6.7 d
&gt; 1198888061873006300088960214337575914561507164160 1.4 d
&gt; 1255977969581244695331291653115555720016817029120 13.5 hr
&gt; 1313067877289483090573623091893535525472126894080 30.0 min
&gt; 1370157784997721485815954530671515330927436759040 1.3 d
&gt; 1427247692705959881058285969449495136382746624000 1.2 d
&gt; 
&gt; ================================ Keys Repaired 
&gt; ================================
&gt; Index Last Mean Max 
&gt; 
&gt; -------------------------------------------------------------------------------
&gt; 0 0 0 0 
&gt; 
&gt; 57089907708238395242331438777979805455309864960 0 0 0 
&gt; 
&gt; 114179815416476790484662877555959610910619729920 0 0 0 
&gt; 
&gt; 171269723124715185726994316333939416365929594880 0 0 0 
&gt; 
&gt; 228359630832953580969325755111919221821239459840 0 0 0 
&gt; 
&gt; 285449538541191976211657193889899027276549324800 0 0 0 
&gt; 
&gt; 342539446249430371453988632667878832731859189760 0 0 1 
&gt; 
&gt; 399629353957668766696320071445858638187169054720 0 0 0 
&gt; 
&gt; 456719261665907161938651510223838443642478919680 0 0 1 
&gt; 
&gt; 513809169374145557180982949001818249097788784640 0 0 0 
&gt; 
&gt; 570899077082383952423314387779798054553098649600 0 0 0 
&gt; 
&gt; 627988984790622347665645826557777860008408514560 0 0 0 
&gt; 
&gt; 685078892498860742907977265335757665463718379520 0 0 0 
&gt; 
&gt; 742168800207099138150308704113737470919028244480 0 0 0 
&gt; 
&gt; 799258707915337533392640142891717276374338109440 0 0 0 
&gt; 
&gt; 856348615623575928634971581669697081829647974400 0 0 0 
&gt; 
&gt; 913438523331814323877303020447676887284957839360 0 0 0 
&gt; 
&gt; 970528431040052719119634459225656692740267704320 0 0 0 
&gt; 
&gt; 1027618338748291114361965898003636498195577569280 0 0 0 
&gt; 
&gt; 1084708246456529509604297336781616303650887434240 0 0 0 
&gt; 
&gt; 1141798154164767904846628775559596109106197299200 0 0 0 
&gt; 
&gt; 1198888061873006300088960214337575914561507164160 0 0 0 
&gt; 
&gt; 1255977969581244695331291653115555720016817029120 0 0 0 
&gt; 
&gt; 1313067877289483090573623091893535525472126894080 0 0 0 
&gt; 
&gt; 1370157784997721485815954530671515330927436759040 0 0 0 
&gt; 
&gt; 1427247692705959881058285969449495136382746624000 0 0 0 
&gt; 
&gt; riak-admin search aae-status
&gt; 
&gt; ================================== Exchanges 
&gt; ==================================
&gt; Index Last (ago) All (ago) 
&gt; -------------------------------------------------------------------------------
&gt; 0 5.1 min 5.6 min 
&gt; 57089907708238395242331438777979805455309864960 4.4 min 4.9 min 
&gt; 114179815416476790484662877555959610910619729920 3.6 min 4.1 min 
&gt; 171269723124715185726994316333939416365929594880 2.9 min 3.4 min 
&gt; 228359630832953580969325755111919221821239459840 2.1 min 2.6 min 
&gt; 285449538541191976211657193889899027276549324800 1.4 min 1.9 min 
&gt; 342539446249430371453988632667878832731859189760 36.5 s 1.1 min 
&gt; 399629353957668766696320071445858638187169054720 6.5 s 19.4 min 
&gt; 456719261665907161938651510223838443642478919680 18.6 min 19.1 min 
&gt; 513809169374145557180982949001818249097788784640 17.9 min 18.4 min 
&gt; 570899077082383952423314387779798054553098649600 17.1 min 17.6 min 
&gt; 627988984790622347665645826557777860008408514560 16.4 min 16.9 min 
&gt; 685078892498860742907977265335757665463718379520 15.6 min 16.1 min 
&gt; 742168800207099138150308704113737470919028244480 14.9 min 15.4 min 
&gt; 799258707915337533392640142891717276374338109440 14.1 min 14.6 min 
&gt; 856348615623575928634971581669697081829647974400 13.4 min 13.9 min 
&gt; 913438523331814323877303020447676887284957839360 12.6 min 13.1 min 
&gt; 970528431040052719119634459225656692740267704320 11.9 min 12.4 min 
&gt; 1027618338748291114361965898003636498195577569280 11.1 min 11.6 min 
&gt; 1084708246456529509604297336781616303650887434240 10.4 min 10.9 min 
&gt; 1141798154164767904846628775559596109106197299200 9.6 min 10.1 min 
&gt; 1198888061873006300088960214337575914561507164160 8.9 min 9.4 min 
&gt; 1255977969581244695331291653115555720016817029120 8.1 min 8.6 min 
&gt; 1313067877289483090573623091893535525472126894080 7.4 min 7.9 min 
&gt; 1370157784997721485815954530671515330927436759040 6.6 min 7.1 min 
&gt; 1427247692705959881058285969449495136382746624000 5.9 min 6.4 min 
&gt; 
&gt; ================================ Entropy Trees 
&gt; ================================
&gt; Index Built (ago)
&gt; -------------------------------------------------------------------------------
&gt; 0 1.5 d
&gt; 57089907708238395242331438777979805455309864960 1.2 d
&gt; 114179815416476790484662877555959610910619729920 20.5 hr
&gt; 171269723124715185726994316333939416365929594880 1.4 d
&gt; 228359630832953580969325755111919221821239459840 22.5 hr
&gt; 285449538541191976211657193889899027276549324800 19.5 hr
&gt; 342539446249430371453988632667878832731859189760 1.6 d
&gt; 399629353957668766696320071445858638187169054720 1.1 d
&gt; 456719261665907161938651510223838443642478919680 1.2 d
&gt; 513809169374145557180982949001818249097788784640 16.5 hr
&gt; 570899077082383952423314387779798054553098649600 15.5 hr
&gt; 627988984790622347665645826557777860008408514560 1.5 d
&gt; 685078892498860742907977265335757665463718379520 1.4 d
&gt; 742168800207099138150308704113737470919028244480 21.5 hr
&gt; 799258707915337533392640142891717276374338109440 18.5 hr
&gt; 856348615623575928634971581669697081829647974400 1.6 d
&gt; 913438523331814323877303020447676887284957839360 1.3 d
&gt; 970528431040052719119634459225656692740267704320 1.1 d
&gt; 1027618338748291114361965898003636498195577569280 14.5 hr
&gt; 1084708246456529509604297336781616303650887434240 1.3 d
&gt; 1141798154164767904846628775559596109106197299200 1.4 d
&gt; 1198888061873006300088960214337575914561507164160 13.5 hr
&gt; 1255977969581244695331291653115555720016817029120 1.0 d
&gt; 1313067877289483090573623091893535525472126894080 23.5 hr
&gt; 1370157784997721485815954530671515330927436759040 1.1 d
&gt; 1427247692705959881058285969449495136382746624000 17.5 hr
&gt; 
&gt; ================================ Keys Repaired 
&gt; ================================
&gt; Index Last Mean Max 
&gt; 
&gt; -------------------------------------------------------------------------------
&gt; 0 0 0 0 
&gt; 
&gt; 57089907708238395242331438777979805455309864960 0 0 0 
&gt; 
&gt; 114179815416476790484662877555959610910619729920 0 0 0 
&gt; 
&gt; 171269723124715185726994316333939416365929594880 0 0 0 
&gt; 
&gt; 228359630832953580969325755111919221821239459840 0 0 0 
&gt; 
&gt; 285449538541191976211657193889899027276549324800 0 0 0 
&gt; 
&gt; 342539446249430371453988632667878832731859189760 0 0 0 
&gt; 
&gt; 399629353957668766696320071445858638187169054720 0 0 1 
&gt; 
&gt; 456719261665907161938651510223838443642478919680 0 0 0 
&gt; 
&gt; 513809169374145557180982949001818249097788784640 0 0 0 
&gt; 
&gt; 570899077082383952423314387779798054553098649600 0 0 0 
&gt; 
&gt; 627988984790622347665645826557777860008408514560 0 0 0 
&gt; 
&gt; 685078892498860742907977265335757665463718379520 0 0 0 
&gt; 
&gt; 742168800207099138150308704113737470919028244480 0 0 0 
&gt; 
&gt; 799258707915337533392640142891717276374338109440 0 0 0 
&gt; 
&gt; 856348615623575928634971581669697081829647974400 0 0 0 
&gt; 
&gt; 913438523331814323877303020447676887284957839360 0 0 0 
&gt; 
&gt; 970528431040052719119634459225656692740267704320 0 0 0 
&gt; 
&gt; 1027618338748291114361965898003636498195577569280 0 0 0 
&gt; 
&gt; 1084708246456529509604297336781616303650887434240 0 0 1 
&gt; 
&gt; 1141798154164767904846628775559596109106197299200 1 0 1 
&gt; 
&gt; 1198888061873006300088960214337575914561507164160 0 0 0 
&gt; 
&gt; 1255977969581244695331291653115555720016817029120 0 0 0 
&gt; 
&gt; 1313067877289483090573623091893535525472126894080 0 0 0 
&gt; 
&gt; 1370157784997721485815954530671515330927436759040 0 0 0 
&gt; 
&gt; 1427247692705959881058285969449495136382746624000 0 0 0
&gt; 
&gt; 
&gt; I have tried to read the data from RiakKV with r=3, it successfully retrieves 
&gt; the data of this entry(read repair maybe fail).
&gt; 
&gt; But to use Riak Search Query again, it still returns results in discrepancy.
&gt; 
&gt; I am curious that why just map to all nodes then once the data in the range 
&gt; got, then return and reduce. I found that this entry in solr via 
&gt; solr-webapp, it is located in 2 nodes of 10. While some other entry located 
&gt; in 3 nodes of 10.
&gt; 
&gt; Best regards,
&gt; Witeman
&gt; 
&gt;&gt; On 24 Feb 2017, at 11:43 AM, Fred Dushin &gt; &gt; wrote:
&gt;&gt; 
&gt;&gt; Hello Witeman,
&gt;&gt; 
&gt;&gt; What you are seeing with your two queries is the result of two different 
&gt;&gt; coverage plans, querying different parts of the cluster. Riak Search 
&gt;&gt; translates coverage plans to Solr sharded queries, and will periodically 
&gt;&gt; change the coverage plan, so as to more evenly distribute queries across the 
&gt;&gt; cluster. So what you are seeing is effectively two different sharded 
&gt;&gt; queries, hitting different solr instances in your cluster. You are seeing 
&gt;&gt; inconsistent search results, which suggests there is a discrepancy between 
&gt;&gt; what is stored in Solr and what is stored in Riak. Generally speaking, AAE 
&gt;&gt; should detect these repairs and correct them over time.
&gt;&gt; 
&gt;&gt; Can you please send the output of the following two commands:
&gt;&gt; 
&gt;&gt; riak-admin aae-status
&gt;&gt; riak-admin search aae-status
&gt;&gt; 
&gt;&gt; That will tell you something about the behavior of the underlying KV and 
&gt;&gt; Yokozuna AAE subsystems.
&gt;&gt; 
&gt;&gt; Out of curiosity, can you you read the "2772439" key in the "data\\_201702" 
&gt;&gt; bucket in Riak with quorum equal to all? If you do that read, does that 
&gt;&gt; affect the behavior of your query you posted? (I am wondering if you 
&gt;&gt; trigger read repair that will repair the entry in Solr)
&gt;&gt; 
&gt;&gt; Thanks,
&gt;&gt; -Fred
&gt;&gt; 
&gt;&gt;&gt; On Feb 23, 2017, at 10:11 PM, Witeman Zheng &gt;&gt; &gt; wrote:
&gt;&gt;&gt; 
&gt;&gt;&gt; Hi,
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; I am having a 10 nodes of RiakKV 2.2.0, and turn on Riak Search(Yokozuna). 
&gt;&gt;&gt; Having about 3million records in one bucket with index, every record has 
&gt;&gt;&gt; about 1k size.
&gt;&gt;&gt; 
&gt;&gt;&gt; Then when it is triggered a Yokozuna query for one specific id, sometimes 
&gt;&gt;&gt; return the record, sometimes return NOT FOUND, it is very weird.
&gt;&gt;&gt; 
&gt;&gt;&gt; FOUND case:
&gt;&gt;&gt; wt=json&q=\\*:\\*&rows=1000&start=0&sort=collect\\_id\\_l%20asc&fq=agent\\_uid\\_i:1191&fq=id\\_l:2772439&indent=true"
&gt;&gt;&gt; {
&gt;&gt;&gt; "responseHeader":{
&gt;&gt;&gt; "status":0,
&gt;&gt;&gt; "QTime":57,
&gt;&gt;&gt; "params":{
&gt;&gt;&gt; "10.100.205.80:8093":"\\_yz\\_pn:230 OR \\_yz\\_pn:200 OR \\_yz\\_pn:170 OR 
&gt;&gt;&gt; \\_yz\\_pn:140 OR \\_yz\\_pn:110 OR \\_yz\\_pn:80 OR \\_yz\\_pn:50 OR \\_yz\\_pn:20",
&gt;&gt;&gt; "10.100.205.79:8093":"\\_yz\\_pn:239 OR \\_yz\\_pn:209 OR \\_yz\\_pn:179 OR 
&gt;&gt;&gt; \\_yz\\_pn:149 OR \\_yz\\_pn:119 OR \\_yz\\_pn:89 OR \\_yz\\_pn:59 OR \\_yz\\_pn:29",
&gt;&gt;&gt; "indent":"true",
&gt;&gt;&gt; "10.100.205.73:8093":"\\_yz\\_pn:233 OR \\_yz\\_pn:203 OR \\_yz\\_pn:173 OR 
&gt;&gt;&gt; \\_yz\\_pn:143 OR \\_yz\\_pn:113 OR \\_yz\\_pn:83 OR \\_yz\\_pn:53 OR \\_yz\\_pn:23",
&gt;&gt;&gt; "start":"0",
&gt;&gt;&gt; "sort":"collect\\_id\\_l asc",
&gt;&gt;&gt; "fq":["agent\\_uid\\_i:1191",
&gt;&gt;&gt; "id\\_l:2772439"],
&gt;&gt;&gt; "rows":"1000",
&gt;&gt;&gt; "10.100.205.76:8093":"\\_yz\\_pn:236 OR \\_yz\\_pn:206 OR \\_yz\\_pn:176 OR 
&gt;&gt;&gt; \\_yz\\_pn:146 OR \\_yz\\_pn:116 OR \\_yz\\_pn:86 OR \\_yz\\_pn:56 OR \\_yz\\_pn:26",
&gt;&gt;&gt; "q":"\\*:\\*",
&gt;&gt;&gt; 
&gt;&gt;&gt; "shards":"10.100.205.71:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.72:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.73:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.74:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.75:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.76:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.77:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.78:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.79:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.80:8093/internal\\_solr/game\\_data\\_records\\_index",
&gt;&gt;&gt; "10.100.205.71:8093":"\\_yz\\_pn:251 OR \\_yz\\_pn:221 OR \\_yz\\_pn:191 OR 
&gt;&gt;&gt; \\_yz\\_pn:161 OR \\_yz\\_pn:131 OR \\_yz\\_pn:101 OR \\_yz\\_pn:71 OR \\_yz\\_pn:41 OR 
&gt;&gt;&gt; \\_yz\\_pn:11",
&gt;&gt;&gt; "10.100.205.74:8093":"\\_yz\\_pn:224 OR \\_yz\\_pn:194 OR \\_yz\\_pn:164 OR 
&gt;&gt;&gt; \\_yz\\_pn:134 OR \\_yz\\_pn:104 OR \\_yz\\_pn:74 OR \\_yz\\_pn:44 OR \\_yz\\_pn:14",
&gt;&gt;&gt; "10.100.205.77:8093":"\\_yz\\_pn:227 OR \\_yz\\_pn:197 OR \\_yz\\_pn:167 OR 
&gt;&gt;&gt; \\_yz\\_pn:137 OR \\_yz\\_pn:107 OR \\_yz\\_pn:77 OR \\_yz\\_pn:47 OR \\_yz\\_pn:17",
&gt;&gt;&gt; "10.100.205.78:8093":"\\_yz\\_pn:248 OR \\_yz\\_pn:218 OR \\_yz\\_pn:188 OR 
&gt;&gt;&gt; \\_yz\\_pn:158 OR \\_yz\\_pn:128 OR \\_yz\\_pn:98 OR \\_yz\\_pn:68 OR \\_yz\\_pn:38 OR 
&gt;&gt;&gt; \\_yz\\_pn:8",
&gt;&gt;&gt; "10.100.205.75:8093":"\\_yz\\_pn:255 OR \\_yz\\_pn:245 OR \\_yz\\_pn:215 OR 
&gt;&gt;&gt; \\_yz\\_pn:185 OR \\_yz\\_pn:155 OR \\_yz\\_pn:125 OR \\_yz\\_pn:95 OR \\_yz\\_pn:65 OR 
&gt;&gt;&gt; \\_yz\\_pn:35 OR \\_yz\\_pn:5",
&gt;&gt;&gt; "wt":"json",
&gt;&gt;&gt; "10.100.205.72:8093":"(\\_yz\\_pn:252 AND (\\_yz\\_fpn:252)) OR \\_yz\\_pn:242 OR 
&gt;&gt;&gt; \\_yz\\_pn:212 OR \\_yz\\_pn:182 OR \\_yz\\_pn:152 OR \\_yz\\_pn:122 OR \\_yz\\_pn:92 OR 
&gt;&gt;&gt; \\_yz\\_pn:62 OR \\_yz\\_pn:32 OR \\_yz\\_pn:2"}},
&gt;&gt;&gt; "response":{"numFound":1,"start":0,"docs":[
&gt;&gt;&gt; {
&gt;&gt;&gt; “some\\_field\\_1\\_l":0,
&gt;&gt;&gt; "some\\_field\\_2\\_l":0,
&gt;&gt;&gt; "some\\_field\\_3\\_s":"[]",
&gt;&gt;&gt; "some\\_field\\_4\\_s":"[]",
&gt;&gt;&gt; "some\\_field\\_5\\_l":0,
&gt;&gt;&gt; "some\\_field\\_6\\_l":0,
&gt;&gt;&gt; "some\\_field\\_7\\_s":"[]",
&gt;&gt;&gt; 
&gt;&gt;&gt; "some\\_field\\_8\\_s":"[[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,0],[10,0],[11,0],[12,0],[13,0],[14,0],[15,0],[16,0],[17,0],[18,0],[19,0],[20,0]]",
&gt;&gt;&gt; "collect\\_id\\_l":2765608,
&gt;&gt;&gt; "some\\_field\\_9\\_i":1191,
&gt;&gt;&gt; "some\\_field\\_10\\_i":1191,
&gt;&gt;&gt; "some\\_field\\_11\\_i":1,
&gt;&gt;&gt; "some\\_field\\_12\\_l":0,
&gt;&gt;&gt; "some\\_field\\_13\\_l":2000,
&gt;&gt;&gt; "some\\_field\\_14\\_l":764846,
&gt;&gt;&gt; "some\\_field\\_15\\_l":766846,
&gt;&gt;&gt; "some\\_field\\_16\\_i":57,
&gt;&gt;&gt; "some\\_field\\_17\\_i":1,
&gt;&gt;&gt; "some\\_field\\_18\\_s":"UTC\\_-4",
&gt;&gt;&gt; "some\\_field\\_19\\_i":1487822270,
&gt;&gt;&gt; "some\\_field\\_20\\_s":"61.221.181.7",
&gt;&gt;&gt; "some\\_field\\_21\\_l":2869104,
&gt;&gt;&gt; "some\\_field\\_22\\_s":"[1,4,10,4,5,3,5,6,8,4,3,2,2,1,10]",
&gt;&gt;&gt; "some\\_field\\_23\\_i":20,
&gt;&gt;&gt; "some\\_field\\_24\\_i":1,
&gt;&gt;&gt; "some\\_field\\_25\\_i":1,
&gt;&gt;&gt; "agent\\_uid\\_i":1191,
&gt;&gt;&gt; "some\\_field\\_26\\_l":2772439,
&gt;&gt;&gt; "some\\_field\\_27\\_i":100,
&gt;&gt;&gt; "\\_yz\\_id":"1\\*default\\*data\\_201702\\*2772439\\*203",
&gt;&gt;&gt; "\\_yz\\_rk":"2772439",
&gt;&gt;&gt; "\\_yz\\_rt":"default",
&gt;&gt;&gt; "\\_yz\\_rb":"data\\_201702"}]
&gt;&gt;&gt; 
&gt;&gt;&gt; }}
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; NOTFOUND case:
&gt;&gt;&gt; 
&gt;&gt;&gt; wt=json&q=\\*:\\*&rows=1000&start=0&sort=collect\\_id\\_l%20asc&fq=agent\\_uid\\_i:1191&fq=id\\_l:2772439&indent=true"
&gt;&gt;&gt; {
&gt;&gt;&gt; "responseHeader":{
&gt;&gt;&gt; "status":0,
&gt;&gt;&gt; "QTime":62,
&gt;&gt;&gt; "params":{
&gt;&gt;&gt; "10.100.205.80:8093":"\\_yz\\_pn:240 OR \\_yz\\_pn:210 OR \\_yz\\_pn:180 OR 
&gt;&gt;&gt; \\_yz\\_pn:150 OR \\_yz\\_pn:120 OR \\_yz\\_pn:90 OR \\_yz\\_pn:60 OR \\_yz\\_pn:30",
&gt;&gt;&gt; "10.100.205.79:8093":"\\_yz\\_pn:249 OR \\_yz\\_pn:219 OR \\_yz\\_pn:189 OR 
&gt;&gt;&gt; \\_yz\\_pn:159 OR \\_yz\\_pn:129 OR \\_yz\\_pn:99 OR \\_yz\\_pn:69 OR \\_yz\\_pn:39 OR 
&gt;&gt;&gt; \\_yz\\_pn:9",
&gt;&gt;&gt; "indent":"true",
&gt;&gt;&gt; "10.100.205.73:8093":"(\\_yz\\_pn:253 AND (\\_yz\\_fpn:253)) OR \\_yz\\_pn:243 OR 
&gt;&gt;&gt; \\_yz\\_pn:213 OR \\_yz\\_pn:183 OR \\_yz\\_pn:153 OR \\_yz\\_pn:123 OR \\_yz\\_pn:93 OR 
&gt;&gt;&gt; \\_yz\\_pn:63 OR \\_yz\\_pn:33 OR \\_yz\\_pn:3",
&gt;&gt;&gt; "start":"0",
&gt;&gt;&gt; "sort":"collect\\_id\\_l asc",
&gt;&gt;&gt; "fq":["agent\\_uid\\_i:1191",
&gt;&gt;&gt; "id\\_l:2772439"],
&gt;&gt;&gt; "rows":"1000",
&gt;&gt;&gt; "10.100.205.76:8093":"\\_yz\\_pn:256 OR \\_yz\\_pn:246 OR \\_yz\\_pn:216 OR 
&gt;&gt;&gt; \\_yz\\_pn:186 OR \\_yz\\_pn:156 OR \\_yz\\_pn:126 OR \\_yz\\_pn:96 OR \\_yz\\_pn:66 OR 
&gt;&gt;&gt; \\_yz\\_pn:36 OR \\_yz\\_pn:6",
&gt;&gt;&gt; "q":"\\*:\\*",
&gt;&gt;&gt; 
&gt;&gt;&gt; "shards":"10.100.205.71:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.72:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.73:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.74:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.75:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.76:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.77:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.78:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.79:8093/internal\\_solr/game\\_data\\_records\\_index,10.100.205.80:8093/internal\\_solr/game\\_data\\_records\\_index",
&gt;&gt;&gt; "10.100.205.71:8093":"\\_yz\\_pn:231 OR \\_yz\\_pn:201 OR \\_yz\\_pn:171 OR 
&gt;&gt;&gt; \\_yz\\_pn:141 OR \\_yz\\_pn:111 OR \\_yz\\_pn:81 OR \\_yz\\_pn:51 OR \\_yz\\_pn:21",
&gt;&gt;&gt; "10.100.205.74:8093":"\\_yz\\_pn:234 OR \\_yz\\_pn:204 OR \\_yz\\_pn:174 OR 
&gt;&gt;&gt; \\_yz\\_pn:144 OR \\_yz\\_pn:114 OR \\_yz\\_pn:84 OR \\_yz\\_pn:54 OR \\_yz\\_pn:24",
&gt;&gt;&gt; "10.100.205.77:8093":"\\_yz\\_pn:237 OR \\_yz\\_pn:207 OR \\_yz\\_pn:177 OR 
&gt;&gt;&gt; \\_yz\\_pn:147 OR \\_yz\\_pn:117 OR \\_yz\\_pn:87 OR \\_yz\\_pn:57 OR \\_yz\\_pn:27",
&gt;&gt;&gt; "10.100.205.78:8093":"\\_yz\\_pn:228 OR \\_yz\\_pn:198 OR \\_yz\\_pn:168 OR 
&gt;&gt;&gt; \\_yz\\_pn:138 OR \\_yz\\_pn:108 OR \\_yz\\_pn:78 OR \\_yz\\_pn:48 OR \\_yz\\_pn:18",
&gt;&gt;&gt; "10.100.205.75:8093":"\\_yz\\_pn:225 OR \\_yz\\_pn:195 OR \\_yz\\_pn:165 OR 
&gt;&gt;&gt; \\_yz\\_pn:135 OR \\_yz\\_pn:105 OR \\_yz\\_pn:75 OR \\_yz\\_pn:45 OR \\_yz\\_pn:15",
&gt;&gt;&gt; "wt":"json",
&gt;&gt;&gt; "10.100.205.72:8093":"\\_yz\\_pn:252 OR \\_yz\\_pn:222 OR \\_yz\\_pn:192 OR 
&gt;&gt;&gt; \\_yz\\_pn:162 OR \\_yz\\_pn:132 OR \\_yz\\_pn:102 OR \\_yz\\_pn:72 OR \\_yz\\_pn:42 OR 
&gt;&gt;&gt; \\_yz\\_pn:12"}},
&gt;&gt;&gt; "response":{"numFound":0,"start":0,"docs":[]
&gt;&gt;&gt; }}
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; I can select this record from solr webapp from some of these 10 nodes. So 
&gt;&gt;&gt; this record should be indexed by solr. So I guessed the problem cause this 
&gt;&gt;&gt; is related with Yokozuna’s distributed shards, since one query would shard 
&gt;&gt;&gt; to every solr instance by Yokozuna, then Yokozuna would collect all the 
&gt;&gt;&gt; returns and reduce to a fix result, something like map-reduce mechanism.
&gt;&gt;&gt; 
&gt;&gt;&gt; So the problem here may underlay in map phase or reduce phase.
&gt;&gt;&gt; 
&gt;&gt;&gt; The default configuration of riak search applied in these 10 nodes.
&gt;&gt;&gt; 
&gt;&gt;&gt; Would anyone have some insight on how to fix this? By modified the 
&gt;&gt;&gt; configuration of search?
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; Best regards,
&gt;&gt;&gt; Witeman
&gt;&gt;&gt; 
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com 
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com 
&gt;&gt;&gt; 
&gt;&gt; 
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com 
&gt;&gt; 
&gt; 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

