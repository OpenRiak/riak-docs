---
title: "Re: consistency impact on performance"
description: ""
project: community
lastmod: 2014-01-23T07:05:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13459"
mailinglist_parent_id: "msg13437"
author_name: "Satoshi Yamada"
project_section: "mailinglistitem"
sent_date: 2014-01-23T07:05:06-08:00
---


Luke,

Yes, the load looks pretty small in our cluster and that explains what I
saw.
It is interesting to see the difference of the performance between NoSQL
with server-side sharding.

Anyway, thanks for your reply. I'm confident with the result now.

Satoshi



2014/1/22 Luke Bakken 

&gt; Satoshi,
&gt;
&gt; The difference in performance between w=1 and w=3 depends a lot on
&gt; your cluster setup and hardware, as well as cluster load.
&gt;
&gt; In your tests, your cluster is most likely under no load, and all
&gt; vnodes are ready to process incoming messages. In this case w=1 and
&gt; w=3 will have little difference in response time since vnodes will be
&gt; able to respond immediately to the write message.
&gt;
&gt; A better test would be to increase cluster load with a tool like
&gt; basho\\_bench and benchmark Riak and Cassandra using that tool.
&gt; --
&gt; Luke Bakken
&gt; CSE
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Sun, Jan 19, 2014 at 9:55 PM, Satoshi Yamada 
&gt; wrote:
&gt; &gt; Luke,
&gt; &gt;
&gt; &gt; Thanks for your reply.
&gt; &gt;
&gt; &gt; Actually, the size of the data we use for our product is as small as
&gt; &gt; hundreds bytes.
&gt; &gt; I use such data as 330MB because I thought the difference of performance
&gt; &gt; gets clearer by
&gt; &gt; storing big data. I did test similarly when the data size is 1MB and
&gt; 100B,
&gt; &gt; but did not
&gt; &gt; see much difference either.
&gt; &gt;
&gt; &gt; thanks,
&gt; &gt; Satoshi
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; 2014/1/20 Luke Bakken 
&gt; &gt;&gt;
&gt; &gt;&gt; Hi Satoshi,
&gt; &gt;&gt;
&gt; &gt;&gt; When using Riak, your object sizes should ideally be 1MB or less. A
&gt; &gt;&gt; 330MB object will never result in acceptable Riak performance.
&gt; &gt;&gt;
&gt; &gt;&gt; If you intend to store large objects like this I strongly recommend
&gt; &gt;&gt; using Riak CS, which will break up the object for you into chunks that
&gt; &gt;&gt; can be managed by Riak. It also provides an S3-compatible API.
&gt; &gt;&gt;
&gt; &gt;&gt; Please read more about Riak CS here:
&gt; http://docs.basho.com/riakcs/latest/
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks
&gt; &gt;&gt; --
&gt; &gt;&gt; Luke Bakken
&gt; &gt;&gt; CSE
&gt; &gt;&gt; lbak...@basho.com
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; On Sun, Jan 19, 2014 at 9:29 PM, Satoshi Yamada 
&gt; &gt;&gt; wrote:
&gt; &gt;&gt; &gt; Hi, i'm Satoshi, new to riak.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I would like to check how consistency changes impacts on the
&gt; performance
&gt; &gt;&gt; &gt; of
&gt; &gt;&gt; &gt; riak cluster. I used w=1 and w=3, and I expected at least two times
&gt; more
&gt; &gt;&gt; &gt; of
&gt; &gt;&gt; &gt; execution time, but there seems no significant change. I saw more
&gt; &gt;&gt; &gt; difference
&gt; &gt;&gt; &gt; in Cassandra, so I wonder if it's normal in riak or there is something
&gt; &gt;&gt; &gt; wrong
&gt; &gt;&gt; &gt; in my testing. Can anyone give me some advice on it?
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; I simply checked as shown below.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; w=1
&gt; &gt;&gt; &gt; $ time curl -v -XPUT
&gt; &gt;&gt; &gt; http://mycluster.com:8098/buckets/w1/keys/data.tar.gz?w=1 -H
&gt; &gt;&gt; &gt; "X-Riak-Vclock:
&gt; &gt;&gt; &gt; a85hYGB.........." -H "Content-Type: text/plain" --data-binary
&gt; &gt;&gt; &gt; @data.tar.gz
&gt; &gt;&gt; &gt; ...
&gt; &gt;&gt; &gt; ...
&gt; &gt;&gt; &gt; ...
&gt; &gt;&gt; &gt; real 0m27.501s
&gt; &gt;&gt; &gt; user 0m0.378s
&gt; &gt;&gt; &gt; sys 0m0.674s
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; w=3
&gt; &gt;&gt; &gt; $ time curl -v -XPUT
&gt; &gt;&gt; &gt; http://mycluster.com:8098/buckets/w3/keys/data.tar.gz?w=3 -H
&gt; &gt;&gt; &gt; "X-Riak-Vclock:
&gt; &gt;&gt; &gt; a85hYGB.........." -H "Content-Type: text/plain" --data-binary
&gt; &gt;&gt; &gt; @data.tar.gz
&gt; &gt;&gt; &gt; ...
&gt; &gt;&gt; &gt; ...
&gt; &gt;&gt; &gt; ...
&gt; &gt;&gt; &gt; real 0m29.278s
&gt; &gt;&gt; &gt; user 0m0.398s
&gt; &gt;&gt; &gt; sys 0m0.674s
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; My cluster consists of 40, all active and healthy machines and running
&gt; &gt;&gt; &gt; riak-1.4.1.
&gt; &gt;&gt; &gt; The data I use is 330MB.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Thanks in advance,
&gt; &gt;&gt; &gt; Satoshi
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt;&gt; &gt; riak-users mailing list
&gt; &gt;&gt; &gt; riak-users@lists.basho.com
&gt; &gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

