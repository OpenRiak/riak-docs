---
title: "Many-To-Many relationships"
description: ""
project: community
lastmod: 2013-08-04T11:45:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11881"
author_name: "Massimiliano Ciancio"
project_section: "mailinglistitem"
sent_date: 2013-08-04T11:45:54-07:00
---


Hi all,
I'm new to Riak and I'm evaluating its use in a project in which I've
to map some many-to-many relationship with millions of link.
That is, imagine you have objects of type X={x\\_0,x\\_1,...,x\\_n} and
objects of type Y={y\\_0,y\\_1,...,y\\_m} that are related. Xs are connected
to millions of Ys and viceversa.
If there wasn't a so high number I could put the relation inside the
objects X as a list of related Ys and viceversa.
But with this number I'll have a very big data field associated to each object.
I'm thinking that I can create a bucket "relation X-Y" in which I can
put objects with key "x\\_i-y\\_j" with value, i.e., "True" menaing that
x\\_i is related to y\\_j. In this way it will be simple to know if x\\_i is
related to y\\_j or viceversa: if the object with key "x\\_i-y\\_j" exists
then they are related. Ok. But now, how can I extract all the Ys
related to x\\_i or, viceversa, the Xs related to y\\_j?
Using map-reduce or similar will imply analizyng all the objects in the cluster.
I can use a secondary index on the objects of the bucket "relation
X-Y". But I imagine it could give performance problems because of the
hundreds of millions of items in it.
So I thought of the following use of 2i: when I write a new relation
"x\\_i-y\\_j" I can add it to two secondary indexes, one named "x\\_i-index"
with value y\\_j and the other "y\\_j-index" with value x\\_i. In this way
I'll not have one big index but many (millions!) of smaller indexes.
Suppose I want all the Ys related to x\\_i: I can ask Riak for the
elements in the index "x\\_i-index". In my mind this will be a not so
heavy query...
Now my questions are: is this approach viable? How many million of
"small" indexes impact on the riak's performances? Are there best
practices to do this?
Thanks in advance
Massimiliano

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

