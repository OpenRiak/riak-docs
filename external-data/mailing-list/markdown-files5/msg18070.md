---
title: "Re: Object not found after successful PUT on S3 API"
description: ""
project: community
lastmod: 2017-03-07T12:59:43-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18070"
mailinglist_parent_id: "msg18066"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2017-03-07T12:59:43-08:00
---


Hi Daniel,

Thanks for providing all of that information.

You are missing important configuration for riak\\_kv that can only be
provided in an /etc/riak/advanced.config file. Please see the following
document, especially the section to which I link here:

http://docs.basho.com/riak/cs/2.1.1/cookbooks/configuration/
riak-for-cs/#setting-up-the-proper-riak-backend

[
 {riak\\_kv, [
 \\*% NOTE: double-check this path for your environment:\\*
 {add\\_paths, ["/usr/lib/riak-cs/lib/riak\\_cs-2.1.1/ebin"]},
 {storage\\_backend, riak\\_cs\\_kv\\_multi\\_backend},
 {multi\\_backend\\_prefix\\_list, [{&lt;&lt;"0b:"&gt;&gt;, be\\_blocks}]},
 {multi\\_backend\\_default, be\\_default},
 {multi\\_backend, [
 {be\\_default, riak\\_kv\\_eleveldb\\_backend, [
 {data\\_root, "/opt/data/ecryptfs/riak"}
 ]},
 {be\\_blocks, riak\\_kv\\_eleveldb\\_backend, [
 {data\\_root, "/opt/data/ecryptfs/riak\\_blocks"}
 ]}
 ]}
 ]}
].

Your configuration will look like the above. The contents of this file are
merged with the contents of /etc/riak/riak.conf to produce the
configuration that Riak uses.

Notice that I chose riak\\_kv\\_eleveldb\\_backend twice because of the
discussion you had previously about RAM usage and bitcask (
http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2016-November/
018801.html)

In your current configuration, you are not using the expected prefix for
the block data. My guess is that on very rare occasions your data happens
to overwrite the manifest for a file. You may also have corrupted files at
this point without noticing it at all.

\\*IMPORTANT:\\* you can't switch from your current configuration to this new
one without re-saving all of your data.

--
Luke Bakken
Engineer
lbak...@basho.com

--
Luke Bakken
Engineer
lbak...@basho.com

On Tue, Mar 7, 2017 at 6:47 AM, Daniel Miller  wrote:

&gt; Responses inline.
&gt;
&gt; On Mon, Mar 6, 2017 at 3:04 PM, Luke Bakken  wrote:
&gt;
&gt;&gt; Hi Daniel,
&gt;&gt;
&gt;&gt; Two questions:
&gt;&gt;
&gt;&gt; \\* Do you happen to have an /etc/riak/app.config file present?
&gt;&gt;
&gt;
&gt; No.
&gt;
&gt; Not sure if relevant, but I did notice that /etc/riak-cs/advanced.config
&gt; does exist, which contradicts with what I said earlier. This is surprising
&gt; to me because I did not create this file. Maybe it was created by the riak
&gt; installer? Anyway, the content is:
&gt;
&gt; $ cat /etc/riak-cs/advanced.config
&gt; [
&gt; {riak\\_cs,
&gt; [
&gt; ]}
&gt; ].
&gt;
&gt;
&gt;&gt;
&gt;&gt; \\* On one of your Riak nodes, could you please execute the following
&gt;&gt; commands:
&gt;&gt;
&gt;&gt; riak attach
&gt;&gt; rp(application:get\\_all\\_env(riak\\_kv)).
&gt;&gt;
&gt;&gt; Copy the output of the previous command and attach as a separate file
&gt;&gt; to your response. Please note that the period is significant. Use
&gt;&gt; CTRL-C CTRL-C to exit the "riak attach" session.
&gt;&gt;
&gt;
&gt; Attached.
&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

