---
title: "Re: Riak Search: 'Failed to index docs' error when inserting a	document from tutorial"
description: ""
project: community
lastmod: 2014-11-12T11:57:19-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15156"
mailinglist_parent_id: "msg15153"
author_name: "Stanislav Nazarenko"
project_section: "mailinglistitem"
sent_date: 2014-11-12T11:57:19-08:00
---


Luke,

Thanks for your reply.

1) I'm using a fresh checkout from https://github.com/basho/riak-python-client. 
Maybe I should be using the latest official release, 2.1.0?

2) Here's what I got after running curl:

\\* Adding handle: conn: 0x7f9c03804400
\\* Adding handle: send: 0
\\* Adding handle: recv: 0
\\* Curl\\_addHandleToPipeline: length: 1
\\* - Conn 0 (0x7f9c03804400) send\\_pipe: 1, recv\\_pipe: 0
\\* About to connect() to localhost port 10018 (#0)
\\* Trying ::1...
\\* Trying 127.0.0.1...
\\* Connected to localhost (127.0.0.1) port 10018 (#0)
&gt; PUT /types/animals/buckets/cats/keys/liono HTTP/1.1
&gt; User-Agent: curl/7.30.0
&gt; Host: localhost:10018
&gt; Accept: \\*/\\*
&gt; Content-type: application/json
&gt; Content-Length: 46
&gt; 
\\* upload completely sent off: 46 out of 46 bytes
&lt; HTTP/1.1 204 No Content
&lt; Vary: Accept-Encoding
\\* Server MochiWeb/1.1 WebMachine/1.10.5 (jokes are better explained) is not 
blacklisted
&lt; Server: MochiWeb/1.1 WebMachine/1.10.5 (jokes are better explained)
&lt; Date: Wed, 12 Nov 2014 19:48:19 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 0
&lt; 
\\* Connection #0 to host localhost left intact

from console.log:

2014-11-12 19:48:19.459 [error] &lt;0.770.0&gt;@yz\\_kv:index:215 failed to index 
object {{&lt;&lt;"animals"&gt;&gt;,&lt;&lt;"cats"&gt;&gt;},&lt;&lt;"liono"&gt;&gt;} with error {"Failed to index 
docs",{ok,"500",[{"Content-Type","application/json; 
charset=UTF-8"},{"Transfer-Encoding","chunked"}],"{\\"responseHeader\\":{\\"status\\":500,\\"QTime\\":0},\\"error\\":{\\"msg\\":\\"Unexpected
 EOF: char=(EOF),position=13 
BEFORE=''\\",\\"trace\\":\\"org.noggit.JSONParser$ParseException: Unexpected EOF: 
char=(EOF),position=13 BEFORE=''\\\\n\\\\tat 
org.noggit.JSONParser.err(JSONParser.java:223)\\\\n\\\\tat 
org.noggit.JSONParser.getMore(JSONParser.java:183)\\\\n\\\\tat 
org.noggit.JSONParser.readStringChars2(JSONParser.java:495)\\\\n\\\\tat 
org.noggit.JSONParser.readStringChars(JSONParser.java:482)\\\\n\\\\tat 
org.noggit.JSONParser.getStringChars(JSONParser.java:758)\\\\n\\\\tat 
org.noggit.JSONParser.getString(JSONParser.java:746)\\\\n\\\\tat 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.handleDeleteMap(JsonLoader.java:251)\\\\n\\\\tat
 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.handleDeleteCommand(JsonLoader.java:193)\\\\n\\\\tat
 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.processUpdate(JsonLoader.java:146)\\\\n\\\\tat
 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.load(JsonLoader.java:101)\\\\n\\\\tat
 org.apache.solr.handler.loader.JsonLoader.load(JsonLoader.java:65)\\\\n\\\\tat 
org.apache.solr.handler.UpdateRequestHandler$1.load(UpdateRequestHandler.java:92)\\\\n\\\\tat
 
org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:74)\\\\n\\\\tat
 
org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)\\\\n\\\\tat
 org.apache.solr.core.SolrCore.execute(SolrCore.java:1916)\\\\n\\\\tat 
org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:780)\\\\n\\\\tat
 
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:427)\\\\n\\\\tat
 
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:217)\\\\n\\\\tat
 
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)\\\\n\\\\tat
 
org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)\\\\n..."}}
 because 
[{yz\\_solr,index,3,[{file,"src/yz\\_solr.erl"},{line,192}]},{yz\\_kv,index,7,[{file,"src/yz\\_kv.erl"},{line,267}]},{yz\\_kv,index,3,[{file,"src/yz\\_kv.erl"},{line,202}]},{riak\\_kv\\_vnode,actual\\_put,6,[{file,"src/riak\\_kv\\_vnode.erl"},{line,1418}]},{riak\\_kv\\_vnode,perform\\_put,3,[{file,"src/riak\\_kv\\_vnode.erl"},{line,1406}]},{riak\\_kv\\_vnode,do\\_put,7,[{file,"src/riak\\_kv\\_vnode.erl"},{line,1201}]},{riak\\_kv\\_vnode,handle\\_command,3,[{file,"src/riak\\_kv\\_vnode.erl"},{line,486}]},{riak\\_core\\_vnode,vnode\\_command,3,[{file,"src/riak\\_core\\_vnode.erl"},{line,345}]}]

from solr.log:

2014-11-12 19:48:19,455 [ERROR] @SolrException.java:109 
org.noggit.JSONParser$ParseException: Unexpected EOF: char=(EOF),position=13 
BEFORE=''
 at org.noggit.JSONParser.err(JSONParser.java:223)
 at org.noggit.JSONParser.getMore(JSONParser.java:183)
 at org.noggit.JSONParser.readStringChars2(JSONParser.java:495)
 at org.noggit.JSONParser.readStringChars(JSONParser.java:482)
 at org.noggit.JSONParser.getStringChars(JSONParser.java:758)
 at org.noggit.JSONParser.getString(JSONParser.java:746)
 at 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.handleDeleteMap(JsonLoader.java:251)
 at 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.handleDeleteCommand(JsonLoader.java:193)
 at 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.processUpdate(JsonLoader.java:146)
 at 
org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.load(JsonLoader.java:101)
 at org.apache.solr.handler.loader.JsonLoader.load(JsonLoader.java:65)
 at 
org.apache.solr.handler.UpdateRequestHandler$1.load(UpdateRequestHandler.java:92)
 at 
org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:74)
 at 
org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)
 at org.apache.solr.core.SolrCore.execute(SolrCore.java:1916)
 at 
org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:780)
 at 
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:427)
 at 
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:217)
 at 
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)
 at 
org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)
 at 
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)
 at 
org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)
 at 
org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)
 at 
org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)
 at 
org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)
 at 
org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)
 at 
org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)
 at 
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)
 at 
org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)
 at 
org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)
 at 
org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)
 at org.eclipse.jetty.server.Server.handle(Server.java:364)
 at 
org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)
 at 
org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)
 at 
org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953)
 at 
org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014)
 at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)
 at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)
 at 
org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)
 at 
org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)
 at 
org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)
 at 
org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)
 at java.lang.Thread.run(Thread.java:745)

Regards,
Stan


On 12 Nov 2014, at 17:33, Luke Bakken  wrote:

&gt; Hi Stanislav,
&gt; 
&gt; \\* Which version of the Python client are you using?
&gt; 
&gt; \\* Could you please attempt to insert the "liono" document using curl?
&gt; 
&gt; curl -vvv -H'Content-type: application/json' -XPUT
&gt; localhost:10018/types/animals/buckets/cats/keys/liono -d
&gt; '{"name\\_s":"Lion-o","age\\_i":30,"leader\\_b":true}'
&gt; 
&gt; --
&gt; Luke Bakken
&gt; Engineer / CSE
&gt; lbak...@basho.com
&gt; 
&gt; 
&gt; On Wed, Nov 12, 2014 at 4:45 AM, Stanislav Nazarenko
&gt;  wrote:
&gt;&gt; Hi All,
&gt;&gt; 
&gt;&gt; Apologies if you received this message twice - my submission through Nabble
&gt;&gt; seems to have failed.
&gt;&gt; 
&gt;&gt; I've been a moderate user of early versions of Riak and now I'm back to Riak
&gt;&gt; land to try version 2.0 and Riak Search with Solr (after seeing Eric Redmond
&gt;&gt; presenting in Dublin, this is exciting stuff!).
&gt;&gt; 
&gt;&gt; I was following the instructions in 'Using Search'
&gt;&gt; (http://docs.basho.com/riak/2.0.0/dev/using/search/) but was unable so far
&gt;&gt; to make Riak Search working. When I try to insert the first document
&gt;&gt; ("liono"), it gets inserted into Riak successfully, but I'm getting the
&gt;&gt; following error when it tries to index it:

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

