---
title: "multiple map phases"
description: ""
project: community
lastmod: 2010-06-10T16:13:25-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00549"
author_name: "Thomas Heller"
project_section: "mailinglistitem"
sent_date: 2010-06-10T16:13:25-07:00
---


Howdy folks,

still trying to wrap my head arround riak and map/reduce, so I decided
to follow the fast-track and play arround with some of the examples.
Its easy enough and the examples work just like advertised. However, I
seem to be missing a critical part of knowledge about the map reduce
phases since I cannot explain this error.

I loaded the goog.csv into riak and try to run this job:

{
 "inputs": [
 ["goog", "2008-10-10"]
 ],
 "query": [
 {"map":{"language":"javascript", "name":"Riak.mapValuesJson"}},
 {"map":{"language":"javascript", "name":"Riak.mapValuesJson"}}
 ]
}

I know its pointless, but afaict I should end up with
"[{"Date":"2008-10-10","Open":313.16,"High":341.89,"Low":310.3,"Close":332,"Volume":10597800,"Adj.
Close":332}]", which is what I get when I run with only ONE map phase.

However I get a 500 with:

The server encountered an error while processing this request:
{error,{error,{case\\_clause,{bad\\_return\\_value,{error,bad\\_input}}},
 [{riak\\_kv\\_wm\\_mapred,process\\_post,2},
 {webmachine\\_resource,resource\\_call,3},
 {webmachine\\_resource,do,3},
 {webmachine\\_decision\\_core,resource\\_call,1},
 {webmachine\\_decision\\_core,decision,1},
 {webmachine\\_decision\\_core,handle\\_request,2},
 {webmachine\\_mochiweb,loop,1},
 {mochiweb\\_http,headers,5}]}}

I thought I can chain multiple map phases together?

Cheers,
/thomas

PS: this is on the riak-0.11.0-osx-x86\\_64.tar.gz release binary btw

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

