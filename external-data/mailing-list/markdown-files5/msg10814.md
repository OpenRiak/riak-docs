---
title: "Re: \"expected_binaries\" error in search"
description: ""
project: community
lastmod: 2013-04-09T21:35:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10814"
mailinglist_parent_id: "msg10804"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2013-04-09T21:35:05-07:00
---


Rob,

That cryptic error is saying that it expected a binary value type for the
field 'ish' ("binary" is a data structure in Erlang) but instead got an
empty list. Do you by any chance have the exact data which is causing the
issue? If you can isolate the data causing the problems then attach to the
riak console and run the following.

 redbug:start("riak\\_solr\\_xml\\_xform:xform/1 -&gt; return").

Then in another window try to index the data. Copy the riak console output
and mail it to me. My guess is something is getting parsed incorrectly.

-Z


On Tue, Apr 9, 2013 at 12:49 PM, Rob Speer  wrote:

&gt; We're having problems where Riak nodes stop responding to requests,
&gt; sometimes while trying to add documents and sometimes while trying to
&gt; delete them.
&gt;
&gt; There are a lot of errors in the logs on all machines, and we're wondering
&gt; if this has something to do with it. A message like this appears every 1-12
&gt; minutes:
&gt;
&gt; 2013-04-09 11:47:52.955 [error]
&gt; &lt;0.29725.18&gt;@riak\\_solr\\_indexer\\_wm:malformed\\_request:37 Unable to parse
&gt; request: {expected\\_binaries,&lt;&lt;"lsh"&gt;&gt;,[]}
&gt;
&gt; "lsh" is a field on the data structures we're indexing (it contains
&gt; arbitrary tokens generated for locality-sensitive hashing). Here's an
&gt; example of what we might be telling Riak Search to index. (It's intentional
&gt; that we're using the whitespace analyzer on all fields.)
&gt;
&gt; {
&gt; 'id': 'uuid-1b34a5a7d5894e1f92874066d074ecec',
&gt; 'subsets': '\\_\\_all\\_\\_ subset1',
&gt; 'terms': 'example|en text|en',
&gt; 'lsh': 'ANRW BMkA CHyu DN60',
&gt; 'segments': '1 1b 1b3 1b34'
&gt; }
&gt;
&gt; This would get sent through self.riak.solr.add() in the Riak Python
&gt; client, of which we're using the latest version committed to master
&gt; (1a379dc1), via the Protocol Buffers transport.
&gt;
&gt; It is possible to store a document that is missing 'terms' or 'lsh'; is
&gt; Riak complaining about their absence when it throws an "expected\\_binaries"
&gt; error? Would this be causing Riak to stop responding to its client
&gt; connections?
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

