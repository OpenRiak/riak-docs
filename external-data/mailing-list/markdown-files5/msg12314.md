---
title: "Re: Invalid hintfiles (was: Riak CS 1.4.1 bug? InvalidAccessKeyId	reported for deletion calls)"
description: ""
project: community
lastmod: 2013-09-18T18:19:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12314"
mailinglist_parent_id: "msg12313"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2013-09-18T18:19:22-07:00
---


Hi Toby,

Invalid hint files won't cause Riak to fail requests - there must have
been something else happening. Hint files are used by Riak to speed
start time when loading a large key set.

You mentioned a "load-balancer pool" - are you using something like
HAProxy to load-balance requests to your Riak CS cluster?

The "error: disconnected" message is a good clue. If you can provide
log files that may point to the cause.

--
Luke Bakken
CSE
lbak...@basho.com


On Wed, Sep 18, 2013 at 4:29 PM, Toby Corkindale
 wrote:
&gt; I found one Riak server was reporting a lot of errors like
&gt; [error] &lt;0.808.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/68507889249886074290797726533575766546371837952/3.bitcask.hint'
&gt; invalid
&gt;
&gt; And the Riak CS logs contained a lot of messages about being unable to
&gt; retrieve s3 user details because "error: disconnected"
&gt;
&gt; I think I've blown away the bad hintfiles and have had them repaired from
&gt; other replicas now, and I haven't seen any more errors for a little while.
&gt;
&gt; I'm not sure what caused those to become invalid.
&gt; Just a thought, but would be good if Riak could automatically repair them
&gt; rather than failing requests.
&gt;
&gt; Cheer,s
&gt; Toby
&gt;
&gt; On 19/09/13 08:42, Toby Corkindale wrote:
&gt;&gt;
&gt;&gt; Ah, hold on.. have just discovered that rather than it being deletion
&gt;&gt; calls, it seems to just be every X calls of any sort.. sounds like one
&gt;&gt; of the servers in the load-balancer pool must be misconfigured somehow,
&gt;&gt; but the rest are OK.
&gt;&gt;
&gt;&gt; On 19/09/13 08:34, Toby Corkindale wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; I've just upgraded from Riak CS 1.3.1 to 1.4.1
&gt;&gt;&gt;
&gt;&gt;&gt; Using s3cmd to test a few things, I've found some odd behaviour.
&gt;&gt;&gt; Creating a bucket and putting a file works just fine, eg:
&gt;&gt;&gt;
&gt;&gt;&gt; s3cmd mb s3://test
&gt;&gt;&gt; s3cmd put README s3://test
&gt;&gt;&gt; s3cmd get s3://test/README
&gt;&gt;&gt;
&gt;&gt;&gt; However if I try to delete a file or bucket, it throws an error:
&gt;&gt;&gt;
&gt;&gt;&gt; s3cmd del s3://test/README
&gt;&gt;&gt; ERROR: S3 error: 403 (InvalidAccessKeyId): The AWS Access Key Id you
&gt;&gt;&gt; provided does not exist in our records.
&gt;&gt;&gt;
&gt;&gt;&gt; s3cmd rb s3://test
&gt;&gt;&gt; ERROR: S3 error: 403 (InvalidAccessKeyId): The AWS Access Key Id you
&gt;&gt;&gt; provided does not exist in our records.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Have I messed something up during the upgrade, or is this a bug in 1.4.1?
&gt;&gt;&gt;
&gt;&gt;&gt; ta
&gt;&gt;&gt; Toby
&gt;&gt;&gt;
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

