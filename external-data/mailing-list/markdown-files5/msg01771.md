---
title: "Re: Install question about riak-erlang-client"
description: ""
project: community
lastmod: 2010-12-10T23:42:35-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01771"
mailinglist_parent_id: "msg01770"
author_name: "Xiaopong Tran"
project_section: "mailinglistitem"
sent_date: 2010-12-10T23:42:35-08:00
---


I finally got it to work, the document is so misleading,
had to dig into the code to find out what is going on.

When starting erl, you have to add 

deps/protobuffs/ebin/

to the path too.

One whole day of frustration....

Xiaopong

On Sat, 2010-12-11 at 15:26 +0800, Xiaopong Tran wrote:
&gt; After upgrading R14B, I can now compile the client package, 
&gt; but I still get the same error when trying to write the object.
&gt; 
&gt; Could someone tell what's going on here?
&gt; 
&gt; Thanks
&gt; 
&gt; Xiaopong
&gt; 
&gt; On Fri, 2010-12-10 at 16:37 +0800, Xiaopong Tran wrote:
&gt; &gt; I have been working on MongoDB, and wanted to try out Riak as our
&gt; &gt; system is also in Erlang. But the first installation got me stuck
&gt; &gt; with an unusable client. 
&gt; &gt; 
&gt; &gt; The server is started and seems to run. So I grabbed the 
&gt; &gt; riakc-1.0.1 package, and it didn't even compile:
&gt; &gt; 
&gt; &gt; x...@shanghai:~/project-workspace/erlang/basho-riak-erlang-client-a1545e5$
&gt; &gt; make
&gt; &gt; ./rebar get-deps
&gt; &gt; ==&gt; basho-riak-erlang-client-a1545e5 (get-deps)
&gt; &gt; Pulling protobuffs from {hg,"http://bitbucket.org/basho/protobuffs",
&gt; &gt; "protobuffs-0.5.0"}
&gt; &gt; requesting all changes
&gt; &gt; adding changesets
&gt; &gt; adding manifests
&gt; &gt; adding file changes
&gt; &gt; added 91 changesets with 243 changes to 93 files (+2 heads)
&gt; &gt; 29 files updated, 0 files merged, 0 files removed, 0 files unresolved
&gt; &gt; ==&gt; protobuffs (get-deps)
&gt; &gt; ./rebar compile
&gt; &gt; ==&gt; protobuffs (compile)
&gt; &gt; Compiled src/pokemon\\_pb.erl
&gt; &gt; Compiled src/protobuffs.erl
&gt; &gt; Compiled src/protobuffs\\_parser.erl
&gt; &gt; Compiled src/protobuffs\\_compile.erl
&gt; &gt; ==&gt; basho-riak-erlang-client-a1545e5 (compile)
&gt; &gt; Compiling src/riakclient.proto
&gt; &gt; src/riakc\\_pb\\_socket.erl:73: type ctx() undefined
&gt; &gt; src/riakc\\_pb\\_socket.erl:73: type rpb\\_req() undefined
&gt; &gt; src/riakc\\_pb\\_socket.erl:78: type option() undefined
&gt; &gt; src/riakc\\_pb\\_socket.erl:79: Warning: type option() is unused
&gt; &gt; src/riakc\\_pb\\_socket.erl:87: Warning: type rpb\\_req() is unused
&gt; &gt; src/riakc\\_pb\\_socket.erl:88: Warning: type ctx() is unused
&gt; &gt; make: \\*\\*\\* [compile] Error 1
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; So I grabbed the repository with the command
&gt; &gt; 
&gt; &gt; hg clone http://bitbucket.org/basho/riak-erlang-client
&gt; &gt; 
&gt; &gt; and compiled it. Everything seemed to be ok, until I started
&gt; &gt; running a connection, and here's I got:
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; x...@shanghai:~/project-workspace/erlang/riak-erlang-client/ebin$ erl -pa
&gt; &gt; `pwd`
&gt; &gt; Erlang R13B03 (erts-5.7.4) [source] [64-bit] [smp:2:2] [rq:2]
&gt; &gt; [async-threads:0] [hipe] [kernel-poll:false]
&gt; &gt; 
&gt; &gt; Eshell V5.7.4 (abort with ^G)
&gt; &gt; 1&gt; code:which(riakc\\_pb\\_socket).
&gt; &gt; "/home/xp/project-workspace/erlang/riak-erlang-client/ebin/riakc\\_pb\\_socket.beam"
&gt; &gt; 2&gt; {ok, Pid} = riakc\\_pb\\_socket:start\\_link("127.0.0.1", 8087).
&gt; &gt; {ok,&lt;0.38.0&gt;}
&gt; &gt; 3&gt; riakc\\_pb\\_socket:ping(Pid).
&gt; &gt; pong
&gt; &gt; 4&gt; Object = riakc\\_obj:new(&lt;&lt;"groceries"&gt;&gt;, &lt;&lt;"mine"&gt;&gt;, &lt;&lt;"egg &
&gt; &gt; bacon"&gt;&gt;).
&gt; &gt; {riakc\\_obj,&lt;&lt;"groceries"&gt;&gt;,&lt;&lt;"mine"&gt;&gt;,undefined,[],
&gt; &gt; undefined,&lt;&lt;"egg & bacon"&gt;&gt;}
&gt; &gt; 5&gt; riakc\\_pb\\_socket:put(Pid, Object).
&gt; &gt; 
&gt; &gt; =ERROR REPORT==== 10-Dec-2010::15:45:55 ===
&gt; &gt; \\*\\* Generic server &lt;0.38.0&gt; terminating 
&gt; &gt; \\*\\* Last message in was {req,
&gt; &gt; 
&gt; &gt; {rpbputreq,&lt;&lt;"groceries"&gt;&gt;,&lt;&lt;"mine"&gt;&gt;,undefined,
&gt; &gt; {rpbcontent,&lt;&lt;"egg & bacon"&gt;&gt;,undefined,
&gt; &gt; 
&gt; &gt; undefined,undefined,undefined,undefined,
&gt; &gt; undefined,undefined,undefined},
&gt; &gt; undefined,undefined,undefined},
&gt; &gt; 60000}
&gt; &gt; \\*\\* When Server state ==
&gt; &gt; {state,"127.0.0.1",8087,false,false,#Port&lt;0.627&gt;,
&gt; &gt; undefined,
&gt; &gt; {[],[]},
&gt; &gt; 1,[],infinity,100}
&gt; &gt; \\*\\* Reason for termination == 
&gt; &gt; \\*\\* {'module could not be loaded',
&gt; &gt; [{protobuffs,encode,[1,&lt;&lt;"groceries"&gt;&gt;,bytes]},
&gt; &gt; {riakclient\\_pb,iolist,2},
&gt; &gt; {riakc\\_pb,encode,1},
&gt; &gt; {riakc\\_pb\\_socket,send\\_request,2},
&gt; &gt; {riakc\\_pb\\_socket,handle\\_call,3},
&gt; &gt; {gen\\_server,handle\\_msg,5},
&gt; &gt; {proc\\_lib,init\\_p\\_do\\_apply,3}]}
&gt; &gt; \\*\\* exception exit: undef
&gt; &gt; in function protobuffs:encode/3
&gt; &gt; called as protobuffs:encode(1,&lt;&lt;"groceries"&gt;&gt;,bytes)
&gt; &gt; in call from riakclient\\_pb:iolist/2
&gt; &gt; in call from riakc\\_pb:encode/1
&gt; &gt; in call from riakc\\_pb\\_socket:send\\_request/2
&gt; &gt; in call from riakc\\_pb\\_socket:handle\\_call/3
&gt; &gt; in call from gen\\_server:handle\\_msg/5
&gt; &gt; in call from proc\\_lib:init\\_p\\_do\\_apply/3
&gt; &gt; 6&gt; {ok, O} = riakc\\_pb\\_socket:get(Pid, &lt;&lt;"groceries"&gt;&gt;, &lt;&lt;"mine"&gt;&gt;).
&gt; &gt; \\*\\* exception exit: {noproc,
&gt; &gt; {gen\\_server,call,
&gt; &gt; [&lt;0.38.0&gt;,
&gt; &gt; 
&gt; &gt; {req,{rpbgetreq,&lt;&lt;"groceries"&gt;&gt;,&lt;&lt;"mine"&gt;&gt;,undefined},60000},
&gt; &gt; infinity]}}
&gt; &gt; in function gen\\_server:call/3
&gt; &gt; 7&gt; Object.
&gt; &gt; {riakc\\_obj,&lt;&lt;"groceries"&gt;&gt;,&lt;&lt;"mine"&gt;&gt;,undefined,[],
&gt; &gt; undefined,&lt;&lt;"egg & bacon"&gt;&gt;}
&gt; &gt; 8&gt; riakc\\_obj:get\\_value(Object).
&gt; &gt; \\*\\* exception throw: no\\_value
&gt; &gt; in function riakc\\_obj:get\\_value/1
&gt; &gt; 9&gt; riakc\\_obj:get\\_content\\_type(Object).
&gt; &gt; \\*\\* exception throw: no\\_metadata
&gt; &gt; in function riakc\\_obj:get\\_metadata/1
&gt; &gt; in call from riakc\\_obj:get\\_content\\_type/1
&gt; &gt; 10&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; So, connection to the server seemed to be fine, but then nothing
&gt; &gt; else worked.
&gt; &gt; 
&gt; &gt; What gives? I'm running Ubuntu 10.10.
&gt; &gt; 
&gt; &gt; Xiaopong
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; 



\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

