---
title: "Re: Problem running riak-1.0.0pre2 list_buckets"
description: ""
project: community
lastmod: 2011-09-16T08:29:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04760"
mailinglist_parent_id: "msg04759"
author_name: "Antoine"
project_section: "mailinglistitem"
sent_date: 2011-09-16T08:29:13-07:00
---


Kelly,

I tried checking out the pre3 tag and with a subset of the data I used
before. If I try to add a few keys (simple empty objects) it's ok I can list
the buckets. The error arise for example after the following objects have
been saved:

curl -v
http://localhost:8098/riak/internal:schemas:schemas/loaded:1316018615776810
\\* About to connect() to localhost port 8098 (#0)
\\* Trying 127.0.0.1... connected
\\* Connected to localhost (127.0.0.1) port 8098 (#0)
&gt; GET /riak/internal:schemas:schemas/loaded:1316018615776810 HTTP/1.1
&gt; User-Agent: curl/7.21.3 (x86\\_64-pc-linux-gnu) libcurl/7.21.3
OpenSSL/0.9.8o zlib/1.2.3.4 libidn/1.18
&gt; Host: localhost:8098
&gt; Accept: \\*/\\*
&gt;
&lt; HTTP/1.1 200 OK
&lt; X-Riak-Vclock: a85hYGBgzGDKBVIcypz/fvoVp8/OYEpkzGNlUH3y/DhfFgA=
&lt; X-Riak-Meta-user\\_id: idmog
&lt; X-Riak-Meta-source: asusci7-loader
&lt; X-Riak-Meta-occured\\_at: 1316018615776810
&lt; X-Riak-Meta-noticed\\_at: 1316018615776812
&lt; X-Riak-Meta-mogbox\\_id: asusci7
&lt; X-Riak-Meta-event\\_type\\_id: loaded
&lt; X-Riak-Meta-event\\_type\\_cat: internal
&lt; X-Riak-Meta-client\\_ip: 192.168.0.10
&lt; X-Riak-Meta-aggr\\_schema\\_id: schemas
&lt; X-Riak-Meta-aggr\\_id: schemas
&lt; x-riak-index-occured\\_at\\_int: 1316018615776810
&lt; x-riak-index-noticed\\_at\\_int: 1316018615776812
&lt; x-riak-index-mogbox\\_id\\_bin: asusci7
&lt; x-riak-index-event\\_type\\_id\\_bin: loaded
&lt; x-riak-index-event\\_type\\_cat\\_bin: internal
&lt; x-riak-index-aggr\\_schema\\_id\\_bin: schemas
&lt; x-riak-index-aggr\\_id\\_bin: schemas
&lt; Vary: Accept-Encoding
&lt; Server: MochiWeb/1.1 WebMachine/1.9.0 (participate in the frantic)
&lt; Link: ; riaktag="aggregate",
; rel="up"
&lt; Last-Modified: Fri, 16 Sep 2011 15:15:49 GMT
&lt; ETag: "51h3q7RjTNaHWYpO4P0MJj"
&lt; Date: Fri, 16 Sep 2011 15:20:17 GMT
&lt; Content-Type: application/x-erlang-term
&lt; Content-Length: 353

and

curl -v http://localhost:8098/riak/schemas/schemas
\\* About to connect() to localhost port 8098 (#0)
\\* Trying 127.0.0.1... connected
\\* Connected to localhost (127.0.0.1) port 8098 (#0)
&gt; GET /riak/schemas/schemas HTTP/1.1
&gt; User-Agent: curl/7.21.3 (x86\\_64-pc-linux-gnu) libcurl/7.21.3
OpenSSL/0.9.8o zlib/1.2.3.4 libidn/1.18
&gt; Host: localhost:8098
&gt; Accept: \\*/\\*
&gt;
&lt; HTTP/1.1 200 OK
&lt; X-Riak-Vclock: a85hYGBgzGDKBVIcypz/fvoVp8/IYEpkzGNlUHny/DhfFgA=
&lt; X-Riak-Meta-$rev: AUEOhgAHc9MSA2MHOvC-M4uLIDc=
&lt; Vary: Accept-Encoding
&lt; Server: MochiWeb/1.1 WebMachine/1.9.0 (participate in the frantic)
&lt; Link: ; rel="up"
&lt; Last-Modified: Fri, 16 Sep 2011 15:15:48 GMT
&lt; ETag: "51h3q7RjTNaHWYpO4P0MJj"
&lt; Date: Fri, 16 Sep 2011 15:22:07 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 629

It was working fine some time ago on master but I cannot remember exactly at
which commit.
I suspect I try to put objects with some badly formatted/configured headers?
However I still manage to put and get the objects.

Regards,
Antoine

On 16 September 2011 16:45, Kelly McLaughlin  wrote:

&gt; Antoine,
&gt;
&gt; I don't have 1.0.0pre2 installed anywhere handy at the moment, but I do
&gt; have pre3 installed and I tested with eleveldb and it works fine for me.
&gt; Could you download pre3 and see if that resolves the issue for you? Thanks.
&gt;
&gt; Kelly
&gt;
&gt;
&gt; On Sep 16, 2011, at 8:08 AM, t3h wrote:
&gt;
&gt; &gt; Hello all,
&gt; &gt;
&gt; &gt; I got these errors after having upgraded to riak-1.0.0pre2 when using
&gt; list buckets:
&gt; &gt;
&gt; &gt; {ok, C} = riak:local\\_client().
&gt; &gt; C:list\\_buckets().
&gt; &gt;
&gt; &gt; gives:
&gt; &gt;
&gt; &gt; 2011-09-16 15:01:32.613 [error] &lt;0.971.0&gt; gen\\_server &lt;0.971.0&gt; terminated
&gt; with reason: bad return value: {break,{buffer,[ ...part of my list of
&gt; buckets... ],#Fun,999,4}}
&gt; &gt; 2011-09-16 15:01:32.711 [error] &lt;0.971.0&gt; CRASH REPORT Process [] with 0
&gt; neighbours crashed with reason: bad return value: {break,{buffer,[...other
&gt; part of my list of buckets... ],#Fun,999,4}}
&gt; &gt; 2011-09-16 15:01:32.767 [error] &lt;0.427.0&gt; gen\\_server &lt;0.427.0&gt; terminated
&gt; with reason: bad return value: {break,{buffer,[...other part of my list of
&gt; buckets... ],#Fun,999,10}}
&gt; &gt; 2011-09-16 15:01:32.842 [error] &lt;0.427.0&gt; CRASH REPORT Process [] with 0
&gt; neighbours crashed with reason: bad return value: {break,{buffer,[...other
&gt; part of my list of buckets... ],#Fun,999,10}}
&gt; &gt; 2011-09-16 15:01:32.937 [error] &lt;0.426.0&gt; Supervisor poolboy\\_sup had
&gt; child riak\\_core\\_vnode\\_worker started with
&gt; {riak\\_core\\_vnode\\_worker,start\\_link,undefined} at &lt;0.427.0&gt; exit with reason
&gt; bad return value: {break,{buffer,[...other part of my list of buckets...
&gt; ],#Fun,999,10}} in context child\\_terminated
&gt; &gt;
&gt; &gt; and so on for each poolboy supervisor...
&gt; &gt;
&gt; &gt; I tested it against a new empty cluster to be sure not to mix legacy key
&gt; listing with new key listing.
&gt; &gt; I use the eleveldb\\_backend and objects stored have indexes.
&gt; &gt; I can list the keys in a bucket without any issue.
&gt; &gt; Am I missing something I should have changed upgrading to 1.0.0?
&gt; &gt;
&gt; &gt; As well, riak objects used to have x-riak-index-$bucket and
&gt; x-riak-index-$key indexes when I first attempted to use secondary indexes. I
&gt; do not see this anymore. What is the reason for this change and should I be
&gt; careful not to override any "built-in" indexes when writting my index
&gt; headers (using the PBC api)?
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Antoine
&gt; &gt;
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

