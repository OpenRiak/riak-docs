---
title: "Re: Different results to same queries"
description: ""
project: community
lastmod: 2015-05-05T05:06:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16108"
mailinglist_parent_id: "msg16101"
author_name: "Sadykov Rustem"
project_section: "mailinglistitem"
sent_date: 2015-05-05T05:06:08-07:00
---


Hi.
I've increased number of JS machines for map and reduce to 32 and now I don't 
get this strange behaviour (now on every query I get same results count), so it 
looks like the problem is solved on riak 1.4.10, but I still get different 
results when I try to use riak 2.1.0 (even if I increase number of JS machines 
there).
Looks like I have to stop using map-reduce in riak 2.1.0

On May 4, 2015, at 7:40 PM, Christopher Meiklejohn  
wrote:

&gt; 
&gt;&gt; On Apr 22, 2015, at 6:45 PM, Sadykov Rustem  wrote:
&gt;&gt; 
&gt;&gt; Hello.
&gt;&gt; I'm testing riak 1.4.10 on 2 node cluster (on different servers), but result 
&gt;&gt; is same on 3 nodes cluster and on single node also.
&gt;&gt; 
&gt;&gt; I try to count records in my bucket and always get 3-4 different results.
&gt;&gt; Query is:
&gt;&gt; 
&gt;&gt; curl -XPOST http://localhost:8098/mapred -H 'Content-Type: application/json' 
&gt;&gt; -d '{"inputs":"account", "query":[{"reduce":{"language":"erlang", 
&gt;&gt; "module":"riak\\_kv\\_mapreduce", "function":"reduce\\_count\\_inputs", 
&gt;&gt; "arg":{"reduce\\_phase\\_batch\\_size":1000} } }] }’
&gt; 
&gt; Hi Sadykov,
&gt; 
&gt; Map/Reduce chooses one replica for each value to execute the query on during 
&gt; a distributed Map/Reduce job. Given that, subsequent executions might occur 
&gt; on different replicas given the coverage plan chosen during that period.
&gt; 
&gt; That said, can you provide information on when you are writing the values you 
&gt; are running the job against? For example, are you writing to a quorum of 
&gt; nodes right before the query? It’s possible to see some staleness if you are 
&gt; using majority quorums and you are executing against replicas that are 
&gt; delayed due to network traffic.
&gt; 
&gt; - Chris
&gt; 
&gt; Christopher Meiklejohn
&gt; Senior Software Engineer
&gt; Basho Technologies, Inc.
&gt; cmeiklej...@basho.com
&gt; 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

