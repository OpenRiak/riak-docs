---
title: "Riak Search in python: how to extend into complex objects?"
description: ""
project: community
lastmod: 2011-09-13T09:10:38-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04683"
author_name: "Denis Papathanasiou"
project_section: "mailinglistitem"
sent_date: 2011-09-13T09:10:38-07:00
---


I'm using the latest version of riak (0.14.2-1) with the
riak-python-client (v. 1.3.0).

I want to run the Riak Search example shown in the documentation
(https://bitbucket.org/basho/riak-python-client), but the json docs
I've added to my bucket are more complex than the example.

I.e., instead of this:

{'first\\_name': 'Anna', 'last\\_name': 'Body', 'is\\_active': True}

my docs look like this:

{ firstName: "Mike", lastName: "Bloomberg", address: { city: "New
York", state: "NY" }, teams: [ 'Giants', 'Jets', 'Yankees', 'Mets' ] }

So how do I search for state = NY ?

I tried this:

search\\_query = client.search('formd', 'address.state:NY')

for result in search\\_query.run():
 # You get ``RiakLink`` objects back.
 person = result.get()
 person\\_data = person.get\\_data()
 print "%s %s" % (person\\_data['firstName'], user\\_data['lastName'])

but I got this stack trace:

Traceback (most recent call last):
 File "query\\_test.py", line 9, in 
 for result in search\\_query.run():
 File "build/bdist.linux-x86\\_64/egg/riak/mapreduce.py", line 211, in run
 File "build/bdist.linux-x86\\_64/egg/riak/transports/pbc.py", line
311, in mapred
 File "build/bdist.linux-x86\\_64/egg/riak/transports/pbc.py", line
365, in recv\\_msg
 File "build/bdist.linux-x86\\_64/egg/riak/transports/pbc.py", line
410, in recv\\_pkt
riak.RiakError: 'Socket returned short packet length - expected 4'

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

