---
title: "Re: M/R query with riak-defined keys"
description: ""
project: community
lastmod: 2012-09-11T10:06:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08495"
mailinglist_parent_id: "msg08487"
author_name: "Antoine"
project_section: "mailinglistitem"
sent_date: 2012-09-11T10:06:29-07:00
---



On 09/11/2012 07:47 AM, Mark Phillips wrote:
&gt; Hey Antoine,
&gt;
&gt; Sorry for the delay here. Just for the sake of completeness, can you
&gt; provide the MapReduce job that's not running?
&gt;
&gt; Mark

Hey,

Thanks for your answer ;)

It turns out I've managed to make it work, probably was an error in the 
Javascript MapReduce indeed (the thing is that the output isn't very 
chatty about what's actually wrong).


I've encountered another problem though.
I've decided to test both possibilities :
-working with user-defined keys and sorting them with key\\_filters
-working with riak-defined keys and filtering thanks to 
map/reduce+javascript.


This time, the riak-defined works, but not the solution with my keys.
My keys are formated like this : \\_YYYYMMDD\\_HHMM
I want to get all values where the key starts exactly with the specified 
word and where  &lt;= YYYYMMDD &lt;= maxDate


My problem lies in the combination of the two constraints.
I managed the one with the specified word, and the one with the dates. 
But not both simultaneously : I get the following error -&gt; 
{"error":"map\\_reduce\\_error"}



Here's the Json I send to /mapred : https://gist.github.com/3699779
I've also included in this gist the errors I got in Riak's crash.log.

At the end of the Gist are the two requests that do work. Can't seem to 
merge them into one with the [["and" ...]] tool.


If you have any clue where this crash can come from, feel free to tell me :)

Have a good day,

Antoine


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

