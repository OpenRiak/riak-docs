---
title: "Re: What's the maximum seconds to set index on bucket after creating	the index"
description: ""
project: community
lastmod: 2015-09-02T05:15:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16485"
mailinglist_parent_id: "msg16484"
author_name: "Fred Dushin"
project_section: "mailinglistitem"
sent_date: 2015-09-02T05:15:14-07:00
---


What is the return value you are getting from 
rick\\_pb\\_socket:create\\_search\\_index? If it's ok, then the Solr cores should 
have been created on all nodes. Otherwise, you should check the logs for 
timeout messages, e.g.,

https://github.com/basho/yokozuna/blob/2.1.1/src/yz\\_index.erl#L443 


If you are getting timeouts, instead of sleeping, you should probably query 
your cluster for the search index, along the lines of what is done in one of 
the riak tests, e.g.,

https://github.com/basho/yokozuna/blob/2.1.1/riak\\_test/yz\\_pb.erl#L100 


If necessary, you might want to fold over all nodes in your cluster, to ensure 
the index has been propagated to all nodes, and possibly use the wait\\_for 
patterns used in the tests.

Unfortunately, it looks like the internal timeout used to wait for propagation 
of indexes to all nodes is not configurable -- it defaults to 45 seconds:

https://github.com/basho/yokozuna/blob/2.1.1/include/yokozuna.hrl#L134

I hope that helps,

-Fred

&gt; On Sep 2, 2015, at 6:27 AM, Hao  wrote:
&gt; 
&gt; Hi,
&gt; 
&gt; What's the maximum seconds to wait after creating an search index and before 
&gt; setting it on the bucket?
&gt; 
&gt; On my local machine, I only need to wait 1 second, sometimes I feel I don't 
&gt; need to wait at all, but on a production server which is basically zero 
&gt; traffic, I have to wait about 10 seconds(definitely over 5s) before I can set 
&gt; the index on a bucket.
&gt; 
&gt; I am using riakc\\_pb\\_socket client. At first I thought something wrong with my 
&gt; function to "create" and "set" the index but then when I split the process, 
&gt; it's fine. So seems it's the interval in between that matters.
&gt; 
&gt; I need to know how long is the maximum because I need to restore a lot of 
&gt; buckets and set index on them via a script. I don't care how long it takes 
&gt; but I don't want it to miss any index not being set on the bucket.
&gt; 
&gt; The exact error on the console when I set the index on a bucket is
&gt; 
&gt; &lt;&lt;"Invalid bucket properties: [{search\\_index,\\n 
&gt; &lt;&lt;\\"application\\_test\\_player\\_idx does not exist\\"&gt;&gt;}]"&gt;&gt;
&gt; 
&gt; 
&gt; 
&gt; 
&gt; Thanks,
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Hao
&gt; 
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

