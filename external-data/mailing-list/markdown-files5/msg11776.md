---
title: "Re: Riak 1.4.0: *Massive* disk space saving with eLevelDB"
description: ""
project: community
lastmod: 2013-07-26T14:29:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11776"
mailinglist_parent_id: "msg11771"
author_name: "Pedram Nimreezi"
project_section: "mailinglistitem"
sent_date: 2013-07-26T14:29:31-07:00
---


A vacuum command would be most appropriate...


On Fri, Jul 26, 2013 at 11:16 AM, Jordan West  wrote:

&gt; To clarify a bit further:
&gt;
&gt; If you started with a fresh 1.4 cluster (or explicitly changed the
&gt; app.config setting) you are using a new on-disk format that applies to any
&gt; backend used by Riak, including LevelDB. There new format is more compact
&gt; but, like MvM said, the majority of savings here probably came from only
&gt; copying the most recent version of a key.
&gt;
&gt; Cheers,
&gt; Jordan
&gt;
&gt;
&gt; On Fri, Jul 26, 2013 at 7:31 AM, Matthew Von-Maszewski  &gt; wrote:
&gt;
&gt;&gt; Dave,
&gt;&gt;
&gt;&gt; Glad you are happy.
&gt;&gt;
&gt;&gt; The truth is that you gained space via the backup/restore process. The
&gt;&gt; data formats of 1.3.1 and 1.4 are the same.
&gt;&gt;
&gt;&gt; leveldb only removes dead / old key/values during its background
&gt;&gt; compaction. It could be days, even weeks in some cases, between when you
&gt;&gt; write fresh key/values and when their old version are discarded.
&gt;&gt;
&gt;&gt; Your restore process only put the fresh keys back into the database. The
&gt;&gt; old versions were never part of the backup.
&gt;&gt;
&gt;&gt; Matthew
&gt;&gt;
&gt;&gt;
&gt;&gt; On Jul 26, 2013, at 7:52 AM, Dave Brady  wrote:
&gt;&gt;
&gt;&gt; Thank you Basho for the new on-disk format changes to eLevelDB!
&gt;&gt;
&gt;&gt; We have just migrating from 1.3.1 to 1.4.0, and since we wanted to change
&gt;&gt; the ring size too, we used Dan Kerrigan's Data Migrator to backup/restore
&gt;&gt; our buckets.
&gt;&gt;
&gt;&gt; The space savings are very impressive! Each node went from using about
&gt;&gt; 410 GB to about 250 GB.
&gt;&gt;
&gt;&gt; Terrific!
&gt;&gt;
&gt;&gt; --
&gt;&gt; Dave Brady
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
/\\* Sincerely
--------------------------------------------------------------
Pedram Nimreezi - Chief Technology Officer \\*/

// The hardest part of design â€¦ is keeping features out. - Donald Norman
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

