---
title: "Re: Initializing a commit hook"
description: ""
project: community
lastmod: 2016-11-18T15:25:31-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17770"
mailinglist_parent_id: "msg17769"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2016-11-18T15:25:31-08:00
---


Thanks for correcting that. Everything looks set up correctly.

How are you saving objects? If you're using HTTP, what is the URL?

Can you associate your precommit hook with a bucket type
("test-bucket-type" below) that is \\*not\\* set up for the "map" data
type and see if your hook is called correctly?

This command should save an object and trigger the precommit hook
\\*with\\* a bucket and bucket type:

curl -4vvv -H 'Content-Type: text/plain'
localhost:8098/types/test-bucket-type/buckets/test-bucket/keys/test-key
-d "THIS IS THE DATA FOR TEST-KEY"

Luke

On Fri, Nov 18, 2016 at 3:03 PM, Mav erick  wrote:
&gt;
&gt; \\* Hostname was NOT found in DNS cache
&gt; \\* Trying 127.0.0.1...
&gt; \\* Connected to localhost (127.0.0.1) port 8098 (#0)
&gt;&gt; GET /types/maps/props HTTP/1.1
&gt;&gt; User-Agent: curl/7.35.0
&gt;&gt; Host: localhost:8098
&gt;&gt; Accept: \\*/\\*
&gt;&gt;
&gt; &lt; HTTP/1.1 200 OK
&gt; &lt; Vary: Accept-Encoding
&gt; \\* Server MochiWeb/1.1 WebMachine/1.10.6 (no drinks) is not blacklisted
&gt; &lt; Server: MochiWeb/1.1 WebMachine/1.10.6 (no drinks)
&gt; &lt; Date: Fri, 18 Nov 2016 22:27:56 GMT
&gt; &lt; Content-Type: application/json
&gt; &lt; Content-Length: 545
&gt; &lt;
&gt; \\* Connection #0 to host localhost left intact
&gt; {"props":{"active":true,"allow\\_mult":true,"basic\\_quorum":false,"big\\_vclock":50,"chash\\_keyfun":{"mod"
&gt; :"riak\\_core\\_util","fun":"chash\\_std\\_keyfun"},"claimant":"riak@10.243.44.165","datatype":"map","dvv\\_en
&gt; abled":true,"dw":"quorum","last\\_write\\_wins":false,"linkfun":{"mod":"riak\\_kv\\_wm\\_link\\_walker","fun":"m
&gt; apreduce\\_linkfun"},"n\\_val":3,"notfound\\_ok":true,"old\\_vclock":86400,"postcommit":[],"pr":0,"precommit
&gt; ":[{"mod":"commit\\_hooks","fun":"precommit\\_hook"}],"pw":0,"r":"quorum","rw":"quorum","smal
&gt; l\\_vclock":50,"w":"quorum","young\\_vclock":20}}
&gt;
&gt; $ curl -4vvv localhost:8098/types/maps/buckets/testbucket/props
&gt; \\* Hostname was NOT found in DNS cache
&gt; \\* Trying 127.0.0.1...
&gt; \\* Connected to localhost (127.0.0.1) port 8098 (#0)
&gt;&gt; GET /types/maps//buckets/testbucket/props HTTP/1.1
&gt;&gt; User-Agent: curl/7.35.0
&gt;&gt; Host: localhost:8098
&gt;&gt; Accept: \\*/\\*
&gt;&gt;
&gt; &lt; HTTP/1.1 200 OK
&gt; &lt; Vary: Accept-Encoding
&gt; \\* Server MochiWeb/1.1 WebMachine/1.10.6 (no drinks) is not blacklisted
&gt; &lt; Server: MochiWeb/1.1 WebMachine/1.10.6 (no drinks)
&gt; &lt; Date: Fri, 18 Nov 2016 22:59:22 GMT
&gt; &lt; Content-Type: application/json
&gt; &lt; Content-Length: 565
&gt; &lt;
&gt; \\* Connection #0 to host localhost left intact
&gt; {"props":{"name":"testbucket","active":true,"allow\\_mult":true,"basic\\_quorum":false,"big\\_vclock":
&gt; chash\\_keyfun":{"mod":"riak\\_core\\_util","fun":"chash\\_std\\_keyfun"},"claimant":"riak@10.243.44.165",
&gt; atype":"map","dvv\\_enabled":true,"dw":"quorum","last\\_write\\_wins":false,"linkfun":{"mod":"riak\\_kv\\_
&gt; ink\\_walker","fun":"mapreduce\\_linkfun"},"n\\_val":3,"notfound\\_ok":true,"old\\_vclock":86400,"postcomm
&gt; [],"pr":0,"precommit":[{"mod":"commit\\_hooks","fun":"precommit\\_hook"}],"pw":0,"r":"quo
&gt; ,"rw":"quorum","small\\_vclock":50,"w":"quorum","young\\_vclock":20}}$

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

