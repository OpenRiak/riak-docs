---
title: "Re: Listing keys in a bucket"
description: ""
project: community
lastmod: 2010-09-04T11:51:28-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01019"
mailinglist_parent_id: "msg01018"
author_name: "John Axel Eriksson"
project_section: "mailinglistitem"
sent_date: 2010-09-04T11:51:28-07:00
---


Yes, I've thought of this but as I understand it there is a bit of a problem 
attaching a large amount of links to a key which
would be necessary here am I right? If I had 10 000 files in riak that would 
mean 10 000 links attached to the "listing" key.

4 sep 2010 kl. 20.44 skrev Matthew Scott:

&gt; 
&gt; On Sat, Sep 4, 2010 at 11:31, John Axel Eriksson  wrote:
&gt; Listing keys in a bucket has been described as "bad" and something you use in 
&gt; development but
&gt; not in production. I'm just starting out on Riak so I'm a newbie...
&gt; 
&gt; I'm thinking of building an application using Riak as filestorage and 
&gt; possibly much more than that, but it would
&gt; at least store lots of files with, perhaps, metadata attached. How would I 
&gt; then list files for display in a webapp if
&gt; I don't use key listing?
&gt; 
&gt; I'm still very much a Riak newb myself, but I'll take a shot at answering 
&gt; this one by suggesting the use of links.
&gt; 
&gt; From what I understand, links some quantity limits when you attach a large 
&gt; number, but adding and removing them is an inexpensive operation. (Someone 
&gt; fact check me on that please :)
&gt; 
&gt; - Create a key called 'listing', perhaps even in its own bucket to prevent 
&gt; namespace collision.
&gt; 
&gt; - Create links from that 'listing' key to metadata keys. Remember that you 
&gt; can attach a tag to each link to differentiate different types of links, such 
&gt; as "metadata".
&gt; 
&gt; - The metadata keys' values would contain file metadata in JSON form, and in 
&gt; turn have a link to the file contents key, tagged "contents".
&gt; 
&gt; - Remember to attach the proper mime type to the key containing your file 
&gt; contents.
&gt; 
&gt; - To get a file listing, do a map/reduce starting at "listing", following its 
&gt; "metadata" links and grabbing those values, then reduce to sort by a key.
&gt; 
&gt; - To get file contents, follow the "contents" link from the metadata key.
&gt; 
&gt; --
&gt; Matthew Scott
&gt; ElevenCraft, Inc.
&gt; http://11craft.com/
&gt; +1 360 389-2512
&gt; 
&gt; 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

