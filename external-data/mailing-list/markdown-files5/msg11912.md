---
title: "Re: RiakNode class in Python client 2.0"
description: ""
project: community
lastmod: 2013-08-06T06:07:38-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11912"
mailinglist_parent_id: "msg11908"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2013-08-06T06:07:38-07:00
---


Hi Matt,

You are correct about the Decaying class, it is a wrapper for an
exponentially-decaying error rate. The idea is, you configure your client
to connect to multiple Riak nodes, and if one goes down or is restarted,
the possibility of its selection for new connections can be automatically
reduced by detecting network errors. Of course, this is moot when you are
connecting to the cluster via a load-balancer; at that point the
error-tracking logic can't help you.

If you are creating and throwing away RiakClient objects frequently,
neither the error-tracking nor the connection pool will help you much.
However, I urge you to consider keeping a single client around, in some
globally accessible place (module constant? config object?). Your
concurrent workers will get to take advantage of existing connections, and
your socket/file-handle usage will be less.


On Tue, Aug 6, 2013 at 1:07 AM, Matt Black wrote:

&gt; I've been looking through the changes to the RiakClient class - and have a
&gt; question about the nodes list and RiakNode/Decaying class.
&gt;
&gt; It seems that the Decaying class is used internally to track error\\_rates
&gt; (request failure\\_rate?) of nodes in the available pool.
&gt;
&gt; In the application I maintain, we're accessing Riak in many concurrent
&gt; celery workers - so my assumption would be that this internal error\\_rate
&gt; tracking wouldn't do much good. Have I got this right? Is the client's
&gt; internal "nodes" list only really useful in a long running application?
&gt; (ie, when I'm not instantiating RiakClient fresh for each query).
&gt;
&gt; We currently have a "pool" of Riak nodes in some configuration, from which
&gt; a random IP is chosen for each request.
&gt;
&gt; Thanks
&gt;
&gt;
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

