---
title: "Re: dealing with binary keys"
description: ""
project: community
lastmod: 2013-09-11T09:26:47-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12233"
mailinglist_parent_id: "msg12232"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2013-09-11T09:26:47-07:00
---


If this is a big show stopper for you, let me know and I can see what it
would take to put in a flag to bypass validations (it'd default to being
on, so you'd have to consciously make that decision).

Summary:
This happens because some clients still use HTTP and we need to play nice
with their degenerate behaviors.

Details:
When we threw that check into CorrugatedIron, we were imagining that people
might have multiple Riak clients in place, including some that are talking
over HTTP instead of Protocol Buffers (looking at you, node.js).

Internally, CorrugatedIron doesn't care about valid keys, it just converts
strings and buckets to byte arrays and sends the messages over to Riak.
I've considered creating some sort of "Should I care" flag that would allow
users to pass in whatever gibberish they want, but it's been on the back
burner.

With Riak 2.0, this behavior can go away since, officially, only protocol
buffers will be supported for clients. CorrugatedIron, though, still needs
to be able to talk to downlevel clients since you might have a cluster in
the middle of a migration from 1.4.x to 2.0.x and killing communications
isn't funny.

Typically, I just nuke the data in my Riak cluster after running Basho
bench, but my use case is slightly different and my cluster gets rebuilt
regularly anyway.



---
Jeremiah Peschka - Founder, Brent Ozar Unlimited
MCITP: SQL Server 2008, MVP
Cloudera Certified Developer for Apache Hadoop


On Wed, Sep 11, 2013 at 7:15 AM, Alex Rice  wrote:

&gt; Hi all, I was messing around with basho\\_bench and I think it created a
&gt; 'test' bucket with lots of binary keys, not string keys. Using the
&gt; .NET api (http://corrugatediron.org/) and it fails to delete these
&gt; keys. Any suggestions how I can get rid of this bucket, aside from
&gt; stopping all nodes and deleting the var/lib/riak directory?
&gt;
&gt; client.DeleteBucket() just seems to hang and
&gt; client.Delete(bucket, key) fails with an ErrorMessage like this
&gt;
&gt; deleting key ��
&gt; deleting key �w
&gt; deleting key 4�q
&gt; deleting key ��#
&gt; ...
&gt; deleting key Z�1
&gt; deleting key /MN
&gt;
&gt; Unhandled Exception:
&gt; System.Exception: Key cannot be blank or contain forward-slashes
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

