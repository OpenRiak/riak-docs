---
title: "Re: Search sort error in 2.0.0beta1"
description: ""
project: community
lastmod: 2014-05-09T07:50:41-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14205"
mailinglist_parent_id: "msg14167"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2014-05-09T07:50:41-07:00
---


This seems like a bug to me. I created an issue to track it.

https://github.com/basho/yokozuna/issues/372


On Thu, May 1, 2014 at 5:22 PM, Troy Melhase  wrote:

&gt; Hello again!
&gt;
&gt; I've narrowed this down to the interaction between the sort parameter and
&gt; the field list ("fl") parameter. It seems that if "fl" is supplied with
&gt; "sort", the field list must contain the value "score". I'm not certain if
&gt; that's a bug or not, but the work-around is plain enough: add "score" to
&gt; the list of fields if there's a sort and the field list isn't empty.
&gt;
&gt; Whew!
&gt;
&gt;
&gt; troy
&gt;
&gt;
&gt;
&gt; On Wed, Apr 30, 2014 at 10:09 PM, Troy Melhase  wrote:
&gt;
&gt;&gt; Hello!
&gt;&gt;
&gt;&gt; I'm getting an error when I include a sort parameter in
&gt;&gt; a RpbSearchQueryReq message. I'm using Riak 2.0.0beta1. Source build and
&gt;&gt; macos binaries show the same behavior.
&gt;&gt;
&gt;&gt; The error doesn't happen at all if I don't specify a search parameter.
&gt;&gt; For the parameter value, I'm using "field direction" (e.g., "name asc").
&gt;&gt; Leaving off the direction, or encoding the space as "+" or "%20" produces
&gt;&gt; a Solr error.
&gt;&gt;
&gt;&gt; I've tried Golang and Python clients to see if it was a client issue.
&gt;&gt; Both clients produce the exact same error; that error text is at the end of
&gt;&gt; this message.
&gt;&gt;
&gt;&gt; Is this a known bug? I searched Github and couldn't find any issues that
&gt;&gt; look like this one. Is there a work-around? Or better yet, am I doing
&gt;&gt; something wrong?
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt;
&gt;&gt;
&gt;&gt; troy
&gt;&gt;
&gt;&gt;
&gt;&gt; Error text:
&gt;&gt;
&gt;&gt; RiakError: 'Error processing incoming message:
&gt;&gt; error:badarg:[{protobuffs,encode\\_internal,
&gt;&gt; [2,[],float],
&gt;&gt;
&gt;&gt; [{file,"src/protobuffs.erl"},
&gt;&gt; {line,167}]},
&gt;&gt; {riak\\_search\\_pb,iolist,2,
&gt;&gt; [{file,
&gt;&gt;
&gt;&gt; "src/riak\\_search\\_pb.erl"},
&gt;&gt; {line,63}]},
&gt;&gt; {riak\\_search\\_pb,encode,2,
&gt;&gt; [{file,
&gt;&gt;
&gt;&gt; "src/riak\\_search\\_pb.erl"},
&gt;&gt; {line,48}]},
&gt;&gt; {riak\\_pb\\_codec,encode,1,
&gt;&gt; [{file,
&gt;&gt;
&gt;&gt; "src/riak\\_pb\\_codec.erl"},
&gt;&gt; {line,77}]},
&gt;&gt; {yz\\_pb\\_search,encode,1,
&gt;&gt; [{file,
&gt;&gt;
&gt;&gt; "src/yz\\_pb\\_search.erl"},
&gt;&gt; {line,60}]},
&gt;&gt; {riak\\_api\\_pb\\_server,
&gt;&gt;
&gt;&gt; send\\_encoded\\_message\\_or\\_error,
&gt;&gt; 3,
&gt;&gt; [{file,
&gt;&gt;
&gt;&gt; "src/riak\\_api\\_pb\\_server.erl"},
&gt;&gt; {line,498}]},
&gt;&gt; {riak\\_api\\_pb\\_server,
&gt;&gt; process\\_message,4,
&gt;&gt; [{file,
&gt;&gt;
&gt;&gt; "src/riak\\_api\\_pb\\_server.erl"},
&gt;&gt; {line,430}]},
&gt;&gt; {riak\\_api\\_pb\\_server,
&gt;&gt; connected,2,
&gt;&gt; [{file,
&gt;&gt;
&gt;&gt; "src/riak\\_api\\_pb\\_server.erl"},
&gt;&gt; {line,262}]}]'
&gt;&gt;
&gt;&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

