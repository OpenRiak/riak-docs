---
title: "Re: Key Filter Timeout"
description: ""
project: community
lastmod: 2011-10-23T12:11:32-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05249"
mailinglist_parent_id: "msg05231"
author_name: "Jim Adler"
project_section: "mailinglistitem"
sent_date: 2011-10-23T12:11:32-07:00
---


I will be loosening the key filter criterion after I get the basics working,
which I thought would be a simple equality check. 8M keys isn't really a
large data set, is it? I thought that keys were stored in memory and key
filters just operated on those memory keys and not data.

Jim

From: Ryan Caught 
Date: Sun, 23 Oct 2011 14:52:48 -0400
To: Jim Adler 
Cc: "riak-users@lists.basho.com" 
Subject: Re: Key Filter Timeout

If you are doing just a simple equality check in the key filter, then why
not skip key filters and lookup the key directly? Key filters are not
performant over large data sets.

On Sun, Oct 23, 2011 at 2:38 PM, Jim Adler  wrote:
&gt; I'm trying to run a very simplified key filter that's timing out. I've got
&gt; about 8M keys in a 3-node cluster, 15 GB memory, num\\_partitions=256, LevelDB
&gt; backend.
&gt; 
&gt; I'm thinking this should be pretty quick. What am I doing wrong?
&gt; 
&gt; Jim
&gt; 
&gt; Here's the query:
&gt; 
&gt; curl -v -d 
&gt; '{"inputs":{"bucket":"nodes","key\\_filters":[["eq","user\\_id-xxxxxxx-info"]]},"q
&gt; uery":[{"reduce":{"language":"erlang","module":"riak\\_kv\\_mapreduce","function":
&gt; "reduce\\_identity"}}]}' -H "Content-Type: application/json"
&gt; http://xx.xx.xx.xx:8098/mapred
&gt; 
&gt; Here's the log:
&gt; 
&gt; 18:25:08.892 [error] gen\\_fsm &lt;0.20795.0&gt; in state executing terminated with
&gt; reason: {error,flow\\_timeout}
&gt; 18:25:08.961 [error] CRASH REPORT Process &lt;0.20795.0&gt; with 2 neighbours
&gt; crashed with reason: {error,flow\\_timeout}
&gt; 18:25:08.963 [error] Supervisor luke\\_flow\\_sup had child undefined started with
&gt; {luke\\_flow,start\\_link,undefined} at &lt;0.20795.0&gt; exit with reason
&gt; {error,flow\\_timeout} in context child\\_terminated
&gt; 18:25:08.966 [error] gen\\_fsm &lt;0.20798.0&gt; in state waiting\\_kl terminated with
&gt; reason: {error,flow\\_timeout}
&gt; 18:25:08.971 [error] CRASH REPORT Process &lt;0.20798.0&gt; with 0 neighbours
&gt; crashed with reason: {error,flow\\_timeout}
&gt; 18:25:08.980 [error] Supervisor riak\\_kv\\_keys\\_fsm\\_legacy\\_sup had child
&gt; undefined started with {riak\\_kv\\_keys\\_fsm\\_legacy,start\\_link,undefined} at
&gt; &lt;0.20798.0&gt; exit with reason {error,flow\\_timeout} in context child\\_terminated
&gt; 18:25:08.983 [error] Supervisor luke\\_phase\\_sup had child undefined started
&gt; with {luke\\_phase,start\\_link,undefined} at &lt;0.20797.0&gt; exit with reason
&gt; {error,flow\\_timeout} in context child\\_terminated
&gt; 18:25:08.996 [error] Supervisor luke\\_phase\\_sup had child undefined started
&gt; with {luke\\_phase,start\\_link,undefined} at &lt;0.20796.0&gt; exit with reason
&gt; {error,flow\\_timeout} in context child\\_terminated
&gt; 
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 



\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

