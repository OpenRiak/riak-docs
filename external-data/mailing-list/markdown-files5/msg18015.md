---
title: "Riak: reliable object deletion"
description: ""
project: community
lastmod: 2017-02-23T05:21:24-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18015"
author_name: "al so"
project_section: "mailinglistitem"
sent_date: 2017-02-23T05:21:24-08:00
---


&gt;
&gt; Here is brief env:
&gt; Riak v 2.0.8 + Solr/ 5 node cluster/ MDC
&gt;
&gt; Problem:
&gt; Deleted object suddenly resurrected after few days. Solr search query(
&gt; "\\*:\\*") was executed around the time of reappearance.
&gt;
&gt; Bucket property for this reappeared object
&gt; {
&gt; "props": {
&gt; "name": "UsaHype",
&gt; "allow\\_mult": false,
&gt; "basic\\_quorum": false,
&gt; "big\\_vclock": 50,
&gt; "chash\\_keyfun": {
&gt; "mod": "riak\\_core\\_util",
&gt; "fun": "chash\\_std\\_keyfun"
&gt; },
&gt; "dvv\\_enabled": true,
&gt; "dw": "quorum",
&gt; "last\\_write\\_wins": false,
&gt; "linkfun": {
&gt; "mod": "riak\\_kv\\_wm\\_link\\_walker",
&gt; "fun": "mapreduce\\_linkfun"
&gt; },
&gt; "n\\_val": 3,
&gt; "notfound\\_ok": true,
&gt; "old\\_vclock": 86400,
&gt; "postcommit": [
&gt; {
&gt; "mod": "riak\\_repl\\_leader",
&gt; "fun": "postcommit"
&gt; },
&gt; {
&gt; "mod": "riak\\_repl2\\_rt",
&gt; "fun": "postcommit"
&gt; }
&gt; ],
&gt; "pr": 0,
&gt; "precommit": [
&gt;
&gt; ],
&gt; "pw": 0,
&gt; "r": "quorum",
&gt; "repl": true,
&gt; "rw": "quorum",
&gt; "small\\_vclock": 50,
&gt; "w": "quorum",
&gt; "young\\_vclock": 20
&gt; }
&gt; }
&gt;
&gt;
&gt; \\* delete\\_mode is not configured at all. Defaults to 3 sec? Do Tombstone still 
&gt; get created when no delete\\_mode at all in the config? Can we query 
&gt; metadata(\\*X-Riak-Deleted)\\* for this reappeared object.\\*
&gt;
&gt; How would one go about finding root cause. I do know the date when the
&gt; object was deleted from our app logs. I also seem to know when it
&gt; reappeared. Seems like a solr search ("\\*:\\*") in code was executed just
&gt; before this object reappeared? Look at AAE? Is there a way to find if Solr
&gt; and Riak backends are out-of-sync (AAE?).
&gt;
&gt; I understand tuning other params (allow\\_mult = true, ...) will have its
&gt; own implications.
&gt;
&gt; In summary:
&gt; How do I find root cause of this issue.
&gt; How to reliable delete an object.
&gt;
&gt; -Volk
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

