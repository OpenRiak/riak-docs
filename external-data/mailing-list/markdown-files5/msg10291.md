---
title: "Re: Wiping data directory break vnodes with read_block_error"
description: ""
project: community
lastmod: 2013-02-28T10:02:17-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10291"
mailinglist_parent_id: "msg10281"
author_name: "Brian Shumate"
project_section: "mailinglistitem"
sent_date: 2013-02-28T10:02:17-08:00
---


Hello Jonas,

I think the issue is that you actually wiped out too much by removing
the entire /var/lib/riak directory.

Typically when resetting the data directories on a Riak node, you'd remove
the contents of only those backend directories which correspond to the ones
defined in your app.config.

For example, if you are using the Bitcask backend, you'd want to only do
something like:

riak stop
sudo rm -rf /var/lib/riak/bitcask/\\*
riak start

This removes all Bitcask data but preserves the node's ring state.

If you wanted to reset \\_both\\_ the Bitcask data and the ring state you'd do:

riak stop
sudo rm -rf /var/lib/riak/bitcask/\\*
sudo rm -rf /var/lib/riak/ring/\\*
riak start

This would essentially reset the node back to a new state while retaining
any configuration changes you already specified in app.config or vm.args.

I hope this helps.

Regards,

Brian Shumate

On Feb 28, 2013, at 2:55 AM, Jonas Lindmark wrote:

&gt; Hi,
&gt; 
&gt; I'm looking for a way to manually wipe the data off of a single-node riak 
&gt; installation. I'm using riak (1.3.0 2013-02-19) Debian x86\\_64 with the 
&gt; riak\\_kv\\_eleveldb\\_backend.
&gt; 
&gt; What I'm currently doing is:
&gt; 
&gt; • riak stop
&gt; • rm -rf /var/lib/riak
&gt; • mkdir riak
&gt; • chown riak:riak riak
&gt; • start riak
&gt; Riak starts ok but a riak-admin vnode-status gives me:
&gt; 
&gt; Backend: riak\\_kv\\_eleveldb\\_backend
&gt; Status: 
&gt; [{stats,&lt;&lt;" Compactions\\nLevel Files Size(MB) 
&gt; Time(sec) Read(MB) 
&gt; Write(MB)\\n--------------------------------------------------\\n"&gt;&gt;},
&gt; {read\\_block\\_error,&lt;&lt;"0"&gt;&gt;}]
&gt; 
&gt; For each vnode.
&gt; 
&gt; It seems to me that there is something more I need to wipe for this to work 
&gt; but I can't find which files that would be.
&gt; 
&gt; /Jonas
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

