---
title: "Re: Riak 2.0.4 Search AAE"
description: ""
project: community
lastmod: 2015-02-18T11:18:47-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15736"
mailinglist_parent_id: "msg15735"
author_name: "Zeeshan Lakhani"
project_section: "mailinglistitem"
sent_date: 2015-02-18T11:18:47-08:00
---


Well, that means that it is storing AAE data. Are you have consistency issues 
between what’s in KV (the canonical source) and Search/Solr? 

You can remove the data on every node by using 
`riak\\_core\\_util:rpc\\_every\\_member\\_ann(yz\\_entropy\\_mgr, clear\\_trees, [], 
infinity)` as well and then try to initialize AAE again. As you can see in this 
part of Ryan’s vid, https://www.youtube.com/watch?v=ETJqu5SmwOc#t=2290 
 (and our constants in 
https://github.com/basho/yokozuna/blob/47214a66e07fdfd04bbaae6bdd18580f87693edf/include/yokozuna.hrl#L187
 
),
 you can, via `riak attach`, update the environment vars of entropy\\_expire, 
tick, and concurrency to speed up AAE in your testing of this bug.


Zeeshan Lakhani
programmer | 
software engineer at @basho | 
org. member/founder of @papers\\_we\\_love |
twitter =&gt; @zeeshanlakhani

&gt; On Feb 18, 2015, at 1:21 PM, Steve Garon  wrote:
&gt; 
&gt; Hey Zeeshan, 
&gt; 
&gt; There is tons of data in yz\\_anti\\_entropy. Should I delete it before running 
&gt; your command? 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; Steve
&gt; 
&gt; On 18 February 2015 at 09:49, Zeeshan Lakhani  &gt; wrote:
&gt; Hey Steve, I’ve run AAE manually by running `riak attach` on a running node 
&gt; and calling 
&gt; https://github.com/basho/yokozuna/blob/develop/src/yz\\_entropy\\_mgr.erl#L142 
&gt;  
&gt; (yz\\_entropy\\_mgr:init([])).
&gt; 
&gt; Nonetheless, to take a closer look, is there any data within search’s 
&gt; data-directory? You can find out by looking in ./data/yz\\_anti\\_entropy (on any 
&gt; of nodes). You can find more info in our docs, 
&gt; http://docs.basho.com/riak/latest/ops/advanced/configs/search/ 
&gt; , about 
&gt; search’s config settings.
&gt; 
&gt; Zeeshan Lakhani
&gt; programmer | 
&gt; software engineer at @basho | 
&gt; org. member/founder of @papers\\_we\\_love |
&gt; twitter =&gt; @zeeshanlakhani
&gt; 
&gt;&gt; On Feb 18, 2015, at 9:03 AM, Steve Garon &gt; &gt; wrote:
&gt;&gt; 
&gt;&gt; Hi all, 
&gt;&gt; 
&gt;&gt; I seem to have trouble with aae on riak 2.0.4. Specifically the search aae. 
&gt;&gt; When I run the command 'riak-admin aae-status' everything seems fine but if 
&gt;&gt; I run the same command for search (riak-admin search aae-status) it seem 
&gt;&gt; like the search entropy trees have never been built and never do. All I get 
&gt;&gt; on every field is --. 
&gt;&gt; 
&gt;&gt; Any command I can run to force the trees to be built so I get consistent 
&gt;&gt; search results? 
&gt;&gt; 
&gt;&gt; Steve
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com 
&gt;&gt; 
&gt; 
&gt; 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

