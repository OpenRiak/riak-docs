---
title: "Re: Wiping data directory break vnodes with read_block_error"
description: ""
project: community
lastmod: 2013-03-01T11:48:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10304"
mailinglist_parent_id: "msg10291"
author_name: "Jonas Lindmark"
project_section: "mailinglistitem"
sent_date: 2013-03-01T11:48:11-08:00
---


Thanks for the advice, I'll be sure to try it out soon and report back.

/jonas
On Feb 28, 2013 7:01 PM, "Brian Shumate"  wrote:

&gt; Hello Jonas,
&gt;
&gt; I think the issue is that you actually wiped out too much by removing
&gt; the entire /var/lib/riak directory.
&gt;
&gt; Typically when resetting the data directories on a Riak node, you'd remove
&gt; the contents of only those backend directories which correspond to the ones
&gt; defined in your app.config.
&gt;
&gt; For example, if you are using the Bitcask backend, you'd want to only do
&gt; something like:
&gt;
&gt; riak stop
&gt; sudo rm -rf /var/lib/riak/bitcask/\\*
&gt; riak start
&gt;
&gt; This removes all Bitcask data but preserves the node's ring state.
&gt;
&gt; If you wanted to reset \\_both\\_ the Bitcask data and the ring state you'd do:
&gt;
&gt; riak stop
&gt; sudo rm -rf /var/lib/riak/bitcask/\\*
&gt; sudo rm -rf /var/lib/riak/ring/\\*
&gt; riak start
&gt;
&gt; This would essentially reset the node back to a new state while retaining
&gt; any configuration changes you already specified in app.config or vm.args.
&gt;
&gt; I hope this helps.
&gt;
&gt; Regards,
&gt;
&gt; Brian Shumate
&gt;
&gt; On Feb 28, 2013, at 2:55 AM, Jonas Lindmark wrote:
&gt;
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I'm looking for a way to manually wipe the data off of a single-node
&gt; riak installation. I'm using riak (1.3.0 2013-02-19) Debian x86\\_64 with the
&gt; riak\\_kv\\_eleveldb\\_backend.
&gt; &gt;
&gt; &gt; What I'm currently doing is:
&gt; &gt;
&gt; &gt; • riak stop
&gt; &gt; • rm -rf /var/lib/riak
&gt; &gt; • mkdir riak
&gt; &gt; • chown riak:riak riak
&gt; &gt; • start riak
&gt; &gt; Riak starts ok but a riak-admin vnode-status gives me:
&gt; &gt;
&gt; &gt; Backend: riak\\_kv\\_eleveldb\\_backend
&gt; &gt; Status:
&gt; &gt; [{stats,&lt;&lt;" Compactions\\nLevel Files
&gt; Size(MB) Time(sec) Read(MB)
&gt; Write(MB)\\n--------------------------------------------------\\n"&gt;&gt;},
&gt; &gt; {read\\_block\\_error,&lt;&lt;"0"&gt;&gt;}]
&gt; &gt;
&gt; &gt; For each vnode.
&gt; &gt;
&gt; &gt; It seems to me that there is something more I need to wipe for this to
&gt; work but I can't find which files that would be.
&gt; &gt;
&gt; &gt; /Jonas
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

