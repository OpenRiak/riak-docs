---
title: "Re: Ripple & an attribute named 'key'"
description: ""
project: community
lastmod: 2011-02-12T19:59:07-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02301"
mailinglist_parent_id: "msg02309"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-02-12T19:59:07-08:00
---


For future reference:
https://github.com/seancribbs/ripple/blob/master/ripple/lib/ripple/document/key.rb

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Feb 12, 2011, at 10:56 PM, Mat Ellis wrote:

&gt; Lol. Ripple is wonderful, don't blame us for thinking it's magic ;-)
&gt; 
&gt; Thx this is very helpful.
&gt; 
&gt; M.
&gt; 
&gt; On Feb 12, 2011, at 7:55 PM, Sean Cribbs wrote:
&gt; 
&gt;&gt; Well, when it comes down to it, it's just a method. There's a lot less 
&gt;&gt; magic in Ripple than you'd think. Try this:
&gt;&gt; 
&gt;&gt; def key
&gt;&gt; @key ||= UUID.new # Replace with whatever you want, as long as it's a String
&gt;&gt; end
&gt;&gt; 
&gt;&gt; Sean Cribbs 
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;&gt; 
&gt;&gt; On Feb 12, 2011, at 10:53 PM, Mat Ellis wrote:
&gt;&gt; 
&gt;&gt;&gt; Yep, exactly. But it doesn't appear until I save right? I'd prefer not to 
&gt;&gt;&gt; have that dependency. Is there a way round?
&gt;&gt;&gt; 
&gt;&gt;&gt; M.
&gt;&gt;&gt; 
&gt;&gt;&gt; On Feb 12, 2011, at 7:51 PM, Sean Cribbs wrote:
&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; If you don't specify a key, Riak will choose one for you (base 62-encoded 
&gt;&gt;&gt;&gt; hash of something, last I checked). Is that not what you're trying to do?
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On Feb 12, 2011, at 10:50 PM, Mat Ellis wrote:
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; The point of the code is not to use a non-string ID but to generate a 
&gt;&gt;&gt;&gt;&gt; default. Is it 'failing' because we're attempting to override the type? 
&gt;&gt;&gt;&gt;&gt; The actual code in question (this is a simplification) is generating a 
&gt;&gt;&gt;&gt;&gt; GUID which can easily be stored as a string instead of an integer. 
&gt;&gt;&gt;&gt;&gt; Otherwise we'll just have to use some other term, your example is 
&gt;&gt;&gt;&gt;&gt; precisely what we're doing.
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Thx
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; On Feb 12, 2011, at 7:47 PM, Sean Cribbs wrote:
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; The choice of "key" as the method/attribute name corresponds to the Riak 
&gt;&gt;&gt;&gt;&gt;&gt; terminology for the same concept (and is analogous to "id" in 
&gt;&gt;&gt;&gt;&gt;&gt; ActiveRecord). If you want to use a non-String value for the key, 
&gt;&gt;&gt;&gt;&gt;&gt; create a property of some other name and then use the "key\\_on" method 
&gt;&gt;&gt;&gt;&gt;&gt; which makes a defined property act as the key.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; property :some\\_num, Integer, :presence =&gt; true, :default =&gt; 1234
&gt;&gt;&gt;&gt;&gt;&gt; key\\_on :some\\_num
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt;&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; On Feb 12, 2011, at 8:00 PM, Mat Ellis wrote:
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Why do these behave differently in Ripple?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Leaves key field blank
&gt;&gt;&gt;&gt;&gt;&gt;&gt; property :key, Integer, :presence =&gt; true, :default =&gt; 1234
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; # Populates key2 field with 1234
&gt;&gt;&gt;&gt;&gt;&gt;&gt; property :key2, Integer, :presence =&gt; true, :default =&gt; 1234
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; We'd like to use the key field as a standard (like the 'id' field is 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the default in ActiveRecord). Is this a bad idea and if so why?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; M.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt; 
&gt; 


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

