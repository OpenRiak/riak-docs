---
title: "Subject: 1022 error in RiakTS"
description: ""
project: community
lastmod: 2017-01-30T08:30:28-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17903"
author_name: "Andy Till"
project_section: "mailinglistitem"
sent_date: 2017-01-30T08:30:28-08:00
---


Hi

&gt; Hi All, I have a 3 node cluster hosting a Riak TS database. During a query
&gt; I run into a 1022 error. The characteristics of my data and other setup is
&gt; below. I am trying to understand
&gt;
&gt; 1) the error and remedy
&gt; 2) what are good conf setting for my case.
&gt;
&gt; Data:
&gt; 1 minute interval with 30 columns per minute. Indexed on time (quantum of
&gt; 1d) and two other columns.
&gt;
&gt; Query:
&gt; avg() where time &gt; t1 and time &lt; t2 and key1=
&gt; and key2 =
&gt;
&gt; Strangely enough, the query works when t2-t1 &lt;= 5 days; however, for any
&gt; duration longer than that I get a 1022 error (projected result of query is
&gt; too big). I am using RiakTS v1.5 and it seems in this version this setting
&gt; is controlled by riak\\_kv.query.timeseries.max\\_quanta\\_span (set to 5K/(1K
&gt; actual?) ); so, is the result purely a coincidence?
&gt;
&gt; It is hard to determine whether this is a coincidence without having the
actual dataset. The bug is fixed in
Riak TS 1.5.1, download here: http://docs.basho.com/riak/ts/1.5.1/downloads/

&gt; w.r.t 1022 error: Docs say that max\\_returned\\_data\\_size is the parameter I
&gt; can tune to fix this issue.
&gt; However, it seems this parameter controls the size of the result; so, Is
&gt; there any reason I get this error code on a avg calculation?
&gt;
&gt; I have not changed the max\\_returned\\_data\\_size setting to see if it will fix
&gt; the issue; just trying to understand whether this is the size of the data
&gt; scanned or size of the data returned
&gt;
&gt; Aggregate functions like AVG use the max\\_returned\\_data\\_size setting like a
non-aggregate query, though
the result is one row. Setting it high enough to hold the query results
should allow the query to complete.

&gt; Finally, I have 1m interval data for a year and in a production setting I
&gt; would like to go to 10s data for 3 years; Are there any recommended value
&gt; for quanta I should be using?
&gt;
&gt; I would really appreciate any insight/input into the issue and any
&gt; recommendation on how to configure the table.
&gt;
&gt; There is some advice in the docs on quantum size here.

http://docs.basho.com/riak/ts/1.5.0/learn-about/bestpractices/#quantum


&gt; Best,
&gt; C.S.N
&gt;
&gt; Cheers
Andy
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

