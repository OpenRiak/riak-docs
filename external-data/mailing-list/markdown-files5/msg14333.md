---
title: "Re: leveldb issues."
description: ""
project: community
lastmod: 2014-06-19T10:49:52-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14333"
mailinglist_parent_id: "msg14330"
author_name: "Theo Schlossnagle"
project_section: "mailinglistitem"
sent_date: 2014-06-19T10:49:52-07:00
---


To be clear, you're considering a13160da8adeca96d80388cc77cb88ad5301aeaa
the latest?


On Thu, Jun 19, 2014 at 12:36 PM, Matthew Von-Maszewski 
wrote:

&gt; Running repair now may have detected damage done to your data long ago.
&gt; Repair reads every file and tests the CRC on every block in the file.
&gt;
&gt; Two known issues might have caused the original corruption:
&gt;
&gt; https://github.com/basho/leveldb/wiki/mv-verify-compactions
&gt;
&gt; or
&gt;
&gt; https://github.com/basho/leveldb/wiki/mv-async-close
&gt;
&gt;
&gt; Also, there is a bug in the 532bb commit that can cause level-0 files to
&gt; be wrongly deleted. I suggest pulling the latest to get rid of that bug.
&gt;
&gt; Matthew
&gt;
&gt;
&gt; On Jun 19, 2014, at 12:24 PM, Theo Schlossnagle  wrote:
&gt;
&gt; I'm using basho/leveldb as of
&gt; commit: 532bb6351e7835e862c8508520780bfc9d0c2b78 (no snappy)
&gt;
&gt; I have an issue with some small sized database... they claim corruption,
&gt; but when running a repair I have a nonsensical amount of sst's moved into
&gt; "lost"
&gt;
&gt; Worse, the files moved to "lost" have very very old creation times (in
&gt; months). The system has been restarted successfully many times in the
&gt; interim, leading to more confusion.
&gt;
&gt; I'm looking for pointers to get to the bottom of this. It isn't critical
&gt; thatI recover this data, but it is critical that I don't see this manifest
&gt; when it does matter.
&gt;
&gt; Before repair:
&gt;
&gt; 40960 108441.log
&gt; 1 CURRENT
&gt; 0 LOCK
&gt; 3 LOG
&gt; 3 LOG.old
&gt; 92 MANIFEST-108439
&gt; 469 sst\\_0
&gt; 1 sst\\_1
&gt; 188185 sst\\_2
&gt; 4189331 sst\\_3
&gt; 6343660 sst\\_4
&gt; 1 sst\\_5
&gt; 1 sst\\_6
&gt;
&gt; After repair:
&gt;
&gt; 40960 108452.log
&gt; 1 CURRENT
&gt; 0 LOCK
&gt; 3 LOG
&gt; 3 LOG.old
&gt; 28 MANIFEST-108450
&gt; 8221971 lost
&gt; 2362 sst\\_0
&gt; 1 sst\\_1
&gt; 188185 sst\\_2
&gt; 2352071 sst\\_3
&gt; 1 sst\\_4
&gt; 1 sst\\_5
&gt; 1 sst\\_6
&gt;
&gt;
&gt;
&gt; --
&gt;
&gt; Theo Schlossnagle
&gt;
&gt; http://omniti.com/is/theo-schlossnagle
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
&gt;


-- 

Theo Schlossnagle

http://omniti.com/is/theo-schlossnagle
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

