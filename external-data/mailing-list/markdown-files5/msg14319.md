---
title: "Re: Understanding an intermittent mapreduce error"
description: ""
project: community
lastmod: 2014-06-16T22:18:25-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14319"
mailinglist_parent_id: "msg14318"
author_name: "Toby Corkindale"
project_section: "mailinglistitem"
sent_date: 2014-06-16T22:18:25-07:00
---


&gt; rp(rpc:multicall(riak\\_kv\\_mapred\\_json, module\\_info, [exports])).
{[[{parse\\_inputs,1},
 {parse\\_query,1},
 {dejsonify\\_not\\_found,1},
 {module\\_info,0},
 {module\\_info,1},
 {jsonify\\_not\\_found,1},
 {jsonify\\_bkeys,2},
 {parse\\_request,1},
 {jsonify\\_pipe\\_error,2}],
 {badrpc,{'EXIT',{undef,[{riak\\_kv\\_mapred\\_json,module\\_info,
 [exports],
 []},
 {rpc,'-handle\\_call\\_call/6-fun-0-',5,
 [{file,"rpc.erl"},{line,203}]}]}}},
 {badrpc,{'EXIT',{undef,[{riak\\_kv\\_mapred\\_json,module\\_info,
 [exports],
 []},
 {rpc,'-handle\\_call\\_call/6-fun-0-',5,
 [{file,"rpc.erl"},{line,203}]}]}}},
 [{parse\\_inputs,1},
 {parse\\_query,1},
 {dejsonify\\_not\\_found,1},
 {module\\_info,0},
 {module\\_info,1},
 {jsonify\\_not\\_found,1},
 {jsonify\\_bkeys,2},
 {parse\\_request,1},
 {jsonify\\_pipe\\_error,2}],
 [{parse\\_inputs,1},
 {parse\\_query,1},
 {dejsonify\\_not\\_found,1},
 {module\\_info,0},
 {module\\_info,1},
 {jsonify\\_not\\_found,1},
 {jsonify\\_bkeys,2},
 {parse\\_request,1},
 {jsonify\\_pipe\\_error,2}],
 [{parse\\_inputs,1},
 {parse\\_query,1},
 {module\\_info,0},
 {module\\_info,1},
 {jsonify\\_not\\_found,1},
 {dejsonify\\_not\\_found,1},
 {jsonify\\_bkeys,2},
 {parse\\_request,1},
 {jsonify\\_pipe\\_error,2}]],
 []}
ok


On 17 June 2014 11:19, Sean Cribbs  wrote:
&gt; Sorry for the typo, replace 'rr' with 'rp' on the front of that.
&gt;
&gt; Sean Cribbs
&gt;
&gt;&gt; On Jun 16, 2014, at 7:59 PM, Toby Corkindale  wrote:
&gt;&gt;
&gt;&gt; Hi Sean,
&gt;&gt; Thanks for your response -- sorry about the delay. I'm in a far away 
&gt;&gt; timezone.
&gt;&gt; The response I get is:
&gt;&gt; Eshell V5.9.1 (abort with ^G)
&gt;&gt; (riak@riak01.internal)1&gt; rr(rpc:multicall(riak\\_kv\\_mapred\\_json,
&gt;&gt; module\\_info, [exports])).
&gt;&gt; {error,invalid\\_filename}
&gt;&gt; (riak@riak01.internal)2&gt;
&gt;&gt;
&gt;&gt; -Toby
&gt;&gt;
&gt;&gt;&gt; On 16 June 2014 23:22, Sean Cribbs  wrote:
&gt;&gt;&gt; Toby,
&gt;&gt;&gt;
&gt;&gt;&gt; Could you try this?
&gt;&gt;&gt;
&gt;&gt;&gt; 1. Run `riak attach`
&gt;&gt;&gt; 2. Type into the console: rr(rpc:multicall(riak\\_kv\\_mapred\\_json, module\\_info,
&gt;&gt;&gt; [exports])).
&gt;&gt;&gt; 3. Paste back to me what the result is
&gt;&gt;&gt;
&gt;&gt;&gt; Cheers,
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Mon, Jun 16, 2014 at 3:31 AM, Toby Corkindale  wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt; I'm trying to understand why I'm getting an intermittent error on a
&gt;&gt;&gt;&gt; particular map-reduce call to Riak 1.4.9.
&gt;&gt;&gt;&gt; The query isn't particularly complicated, and filters mean it should
&gt;&gt;&gt;&gt; only be running over ~100 keys, and returning &lt;10 each time, so I
&gt;&gt;&gt;&gt; don't think I should be hitting any stack or memory limits in the JS
&gt;&gt;&gt;&gt; VMs.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; It fails frequently, but not every time. When pointing it at just a
&gt;&gt;&gt;&gt; single Riak server for debugging purposes, it fails around 30% of the
&gt;&gt;&gt;&gt; time.
&gt;&gt;&gt;&gt; The error returned is as follows:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; {
&gt;&gt;&gt;&gt; "input" : null,
&gt;&gt;&gt;&gt; "stack" : null,
&gt;&gt;&gt;&gt; "phase" : 1,
&gt;&gt;&gt;&gt; "error" :
&gt;&gt;&gt;&gt; "{undef,[{riak\\_kv\\_mapred\\_json,jsonify\\_not\\_found,[{struct,[{&lt;&lt;\\"email\\"&gt;&gt;,&lt;&lt;\\"u...@example.com\\"&gt;&gt;},{&lt;&lt;\\"attributes\\"&gt;&gt;,[&lt;&lt;\\"someattributes\\"&gt;&gt;,&lt;&lt;\\"somemoreattributes\\"&gt;&gt;,&lt;&lt;\\"w...\\"&gt;&gt;,...]},...]}],...},...]}",
&gt;&gt;&gt;&gt; "type" : null
&gt;&gt;&gt;&gt; }
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; There are no errors in the Riak server logs.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt; Toby
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt; Software Engineer
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; http://basho.com/
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Turning and turning in the widening gyre
&gt;&gt; The falcon cannot hear the falconer
&gt;&gt; Things fall apart; the center cannot hold
&gt;&gt; Mere anarchy is loosed upon the world



-- 
Turning and turning in the widening gyre
The falcon cannot hear the falconer
Things fall apart; the center cannot hold
Mere anarchy is loosed upon the world

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

