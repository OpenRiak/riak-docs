---
title: "Re: Riak Disk Usage"
description: ""
project: community
lastmod: 2012-04-17T07:06:47-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07214"
mailinglist_parent_id: "msg07212"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-04-17T07:06:47-07:00
---


Fabio,

If you are using Bitcask (the default storage engine), it won't compact its
data files until they reach the 2GB default max file size. Since your disk
space is constrained, I suggest you tune the max\\_file\\_size down (128-256MB
should be sufficient for your purposes) and merging threshold/triggers.
More info about those settings can be found on this page:
http://wiki.basho.com/Bitcask.html#Disk-Usage-and-Merging-Settings

Hope that helps!

On Tue, Apr 17, 2012 at 9:20 AM, Fábio Sato  wrote:

&gt; Hello all,
&gt;
&gt; I've started using Riak as a data store for images and documents and I'm
&gt; having trouble understanding its disk usage behaviour.
&gt;
&gt; We developed a web system and unfortunately it went into production
&gt; without the appropriate hardware infrastructure, and we are currently
&gt; running only one instance of Riak right now (I know this is dead wrong but
&gt; I'm waiting for more hardware).
&gt;
&gt; Currently we have like 100 keys and update their content every 5 minutes.
&gt; Every image has approximately 300kB so I would expect a disk usage around
&gt; 300MB-1GB and also that riak would keep it constant. But every 2 weeks we
&gt; get a full filesystem (10GB) and have to restart Riak (or temporally add
&gt; another instance) to make it release space.
&gt;
&gt; To me it seems like it is maintaining the previous values for each key
&gt; like a versioning system, but can't confirm that based on what I've read on
&gt; the documentation.
&gt;
&gt; Could someone give me a hint why the disk space grows even if I'm not
&gt; adding no new keys?
&gt;
&gt; Any feedback would be appreciated.
&gt;
&gt; Thanks!
&gt; --
&gt; Fábio Sato
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

