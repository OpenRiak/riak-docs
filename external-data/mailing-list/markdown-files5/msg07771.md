---
title: "Re: undefined method content_type"
description: ""
project: community
lastmod: 2012-06-25T01:18:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07771"
mailinglist_parent_id: "msg07767"
author_name: "Mathias Meyer"
project_section: "mailinglistitem"
sent_date: 2012-06-25T01:18:35-07:00
---


Anand,

I rewrote your script a little bit (you did some odd things in the initialize 
method which isn't expected to return anything), and this way it works:

require 'riak'

Riak::Serializers["text/html"] = Riak::Serializers::TextPlain

class RiakClient
def initialize
super
end

def client
@client ||= Riak::Client.new(:nodes =&gt; [{:http\\_port =&gt; 8091},{:http\\_port 
=&gt;8092},{:http\\_port=&gt;8093},{:http\\_port =&gt;8094}])
end

def get\\_me(bucket, key)
obj = client.bucket(bucket).get(key)
puts obj.data
end

def put\\_me(bucket, key, data, content\\_type)
obj = client.bucket(bucket).get\\_or\\_new(key)
obj.content\\_type = content\\_type
obj.raw\\_data=data
obj.store
end
end

if \\_\\_FILE\\_\\_ == $0
my\\_client = RiakClient.new
my\\_client.put\\_me("doc", "index.html", "some data goes here", "text/html")
hash = my\\_client.get\\_me("doc", "index.html")
end


Cheers, Mathias
http://riakhandbook.com





On Monday, 25. June 2012 at 07:52, Anand Hegde wrote:

&gt; require 'riak'
&gt; 
&gt; 
&gt; 
&gt; 
&gt; class RiakClient &lt; Riak::Client
&gt; #attr\\_accessor :bucket
&gt; 
&gt; def initialize(hosts="")
&gt; return Riak::Client.new(:nodes =&gt; [{:http\\_port =&gt; 8091},{:http\\_port 
&gt; =&gt;8092},{:http\\_port=&gt;8093},{:http\\_port =&gt;8094}])
&gt; end
&gt; 
&gt; def get\\_me(bucket, key)
&gt; obj = self.bucket(bucket).get(key)
&gt; puts obj.data
&gt; end
&gt; 
&gt; def put\\_me(bucket, key, data, content\\_type) 
&gt; obj=self.bucket(bucket).get\\_or\\_new(key)
&gt; puts obj.class
&gt; obj.content\\_type=content\\_type
&gt; obj.raw\\_data=data
&gt; obj.store
&gt; end
&gt; end
&gt; 
&gt; 
&gt; 
&gt; if \\_\\_FILE\\_\\_ == $0
&gt; my\\_client=RiakClient.new
&gt; my\\_client.put\\_me("doc", "index.html", "some data goes here", "text/html")
&gt; hash=my\\_client.get\\_me("doc", "index.html")
&gt; end
&gt; 
&gt; 
&gt; But I am getting the following errors - 
&gt; 
&gt; NilClass
&gt; riak\\_client.rb:32:in `put\\_me': undefined method `content\\_type=' for 
&gt; nil:NilClass (NoMethodError)
&gt; from riak\\_client.rb:42:in `'
&gt; 
&gt; 
&gt; Do I have to import the RiakObject and RiakClient classes and all? and how do 
&gt; i do this? 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com




\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

