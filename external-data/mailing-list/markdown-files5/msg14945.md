---
title: "Re: Many \"Unrecognized message\" errors in the logs while nodes are	leaving"
description: ""
project: community
lastmod: 2014-09-29T08:18:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14945"
mailinglist_parent_id: "msg14942"
author_name: "Chris Read"
project_section: "mailinglistitem"
sent_date: 2014-09-29T08:18:08-07:00
---


We were getting upto ~20 messages per second while nodes were leaving
the cluster. We went from 19 nodes down to 15. Ring size is 64, using
bitcask as the store.

Requests on this cluster were averaging around 10k/sec, spiking to
25k/sec occasionally. Request mix is 99% GET with a few PUT and DEL.
We don't use mr, search or list at all...

Chris



On Sat, Sep 27, 2014 at 8:39 AM, Sean Cribbs  wrote:
&gt; Hi Chris,
&gt;
&gt; Those log messages are mostly harmless -- they don't indicate any
&gt; specific thing going wrong. They only indicate that the process
&gt; handling the client connection decided to stop waiting for additional
&gt; internal protocol messages and replied to the client. Since the
&gt; protocol state machine is now outside of the request handler, it
&gt; doesn't recognize those internal responses any more.
&gt;
&gt; Those log messages were added so that we (Basho) could tell if we had
&gt; egregiously missed some message in an internal protocol, but again,
&gt; other than being a little spammy they are harmless.
&gt;
&gt; It would be nice to know what your request mix looks like, i.e. are
&gt; you doing list-keys, mapreduce, search, etc? How much of each? How
&gt; often do you get those log messages?
&gt;
&gt; On Fri, Sep 26, 2014 at 4:03 PM, Chris Read  wrote:
&gt;&gt; Greetings...
&gt;&gt;
&gt;&gt; I started removing a few nodes from a cluster today, and started to
&gt;&gt; get a lot of the following errors in the logs:
&gt;&gt;
&gt;&gt; @riak\\_api\\_pb\\_server:handle\\_info:331 Unrecognized message
&gt;&gt;
&gt;&gt; Message is either '{,ok}' or '{,{error,timeout}}'
&gt;&gt;
&gt;&gt; We're running Riak 2.0 on Erlang R16B02-basho5, both built from
&gt;&gt; source. A quick Google hinted that it may be a regression of
&gt;&gt; https://github.com/basho/riak\\_kv/pull/366
&gt;&gt;
&gt;&gt; Chris
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
&gt;
&gt; --
&gt; Sean Cribbs 
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; http://basho.com/

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

