---
title: "Re: riak doesn't start on new Macbook Pro Retina"
description: ""
project: community
lastmod: 2012-07-16T12:20:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07966"
mailinglist_parent_id: "msg07956"
author_name: "Steve Hull"
project_section: "mailinglistitem"
sent_date: 2012-07-16T12:20:16-07:00
---


So one thing that seems bizarre is that riak has created directory
structure under /tmp to mirror the directory structure from root to the
binary executable.

For example, after I tried to start riak using the binary installed by
brew, I noticed this directory structure that got added to /tmp:

! ls -alhrt /tmp/usr/local/Cellar/riak/1.1.2-x86\\_64/libexec/
total 0
drwxr-xr-x 3 shull wheel 102B Jul 13 13:56 ../
drwxr-xr-x 2 shull wheel 68B Jul 13 14:24 ./


And similarly for the local pre-packaged version, it created:

! ls -alhrt /tmp/Users/shull/Dev/prodar/riak-1.1.4/
total 0
drwxr-xr-x 3 shull wheel 102B Jul 13 14:08 ../
drwxr-xr-x 4 shull wheel 136B Jul 16 11:56 ./
prw------- 1 shull wheel 0B Jul 16 11:57 erlang.pipe.1.w|
prw------- 1 shull wheel 0B Jul 16 11:57 erlang.pipe.1.r|


I guess there's nothing really \\*wrong\\* with that, it just kind of worried
me at first to see that directory structure under /tmp.

Anyway if I read your email correctly, you wanted me to try to start riak
and then after it reports failure, try to attach to it:

[07-16 11:55] (master)~/Dev/prodar
! riak-1.1.4/bin/riak start
Riak failed to start within 15 seconds,
see the output of 'riak console' for more information.
If you want to wait longer, set the environment variable
WAIT\\_FOR\\_ERLANG to the number of seconds to wait.

[07-16 11:56] (master)~/Dev/prodar
! riak-1.1.4/bin/riak attach
Node is not running!


Not sure if any logs would be interesting to look at after this.
 Interestingly, riak does seem to be running, as basic REST stuff seems to
work OK (using Ruby + Ripple).

-S

On Mon, Jul 16, 2012 at 12:23 AM, Erik Søe Sørensen  wrote:

&gt; Well, from the logs it looks like a normal and successful startup...
&gt; consistent with the fact that a riak process continues to exists.
&gt; And the startup does not seem to be slow (which would cause a timeout for
&gt; the script waiting for the node to come up); from logging starts to the
&gt; node is ready takes just 2s.
&gt; It then remains to be determined why the start script reports timeout.
&gt;
&gt; Either it can't connect to the node, or the check it attempts to make
&gt; within the node (whether an Erlang process called 'riak\\_core\\_node\\_watcher'
&gt; is registered) never succeeds.
&gt; Have you tried attaching to the node, using "riak attach"? That would
&gt; check which of the two things fail.
&gt;
&gt; The pipe files are usually called things like
&gt; /tmp/riak/erlang.pipe.2.r
&gt; (they exist in pairs: one to and one from the node).
&gt;
&gt; /Erik
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; From: Steve Hull [st...@taskrabbit.com]
&gt; Sent: 16 July 2012 08:20
&gt; To: Erik Søe Sørensen
&gt; Cc: videlalv...@gmail.com; riak-users@lists.basho.com
&gt; Subject: Re: riak doesn't start on new Macbook Pro Retina
&gt;
&gt; Hi Erik!
&gt;
&gt; Thanks for the suggestions. I checked out /tmp but didn't see anything
&gt; that looked like a pipe for riak... perhaps could you tell me what the file
&gt; would be named?
&gt;
&gt; Not sure which logs would be most useful, but please find everything that
&gt; was generated attached.
&gt;
&gt; -S
&gt;
&gt; On Sat, Jul 14, 2012 at 9:40 AM, Erik Søe Sørensen  &gt; wrote:
&gt; If I remember correctly, this may be a symptom that the pipe file on /tmp
&gt; which Riak wants to use does already exists but is owned by another user.
&gt; This happens if Riak has previously been run by a different user.
&gt; If it's not that, I suggest you provide the logs from the failed "riak
&gt; start" attempt for further diagnosis...
&gt;



-- 
\\*Steve Hull \\*| \\*TaskRabbit \\*|Software Engineer
\\*P:\\* 510.928.4719
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

