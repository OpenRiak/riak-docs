---
title: "Re: python client - failing mapreduce on fulltext search"
description: ""
project: community
lastmod: 2016-05-02T15:19:30-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17280"
mailinglist_parent_id: "msg17163"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2016-05-02T15:19:30-07:00
---


Hello,

The "not\\_found" in the error indicates that the object was not found.
When performing map / reduce operations, you have to take this into
account.
--
Luke Bakken
Engineer
lbak...@basho.com


On Mon, Mar 14, 2016 at 11:37 AM, Bartłomiej Górny  wrote:
&gt; Hi
&gt;
&gt; I've been trying to do fulltext search and mapreduce on it, only to get
&gt; values, and I can't make it work. When I try the following code:
&gt;
&gt; query = riak.mapreduce.RiakMapReduce(c)
&gt; query = query.search(idx, sstr)
&gt; query = query.map\\_values()
&gt; query = query.reduce\\_limit(1)
&gt; res = query.run()
&gt;
&gt; it failes, and gives me this:
&gt;
&gt; File
&gt; "/usr/local/lib/python2.7/dist-packages/riak-2.4.2-py2.7.egg/riak/mapreduce.py",
&gt; line 322, in run
&gt; riak.riak\\_error.RiakError: 'Error processing stream message:
&gt; exit:{json\\_encode,
&gt; {bad\\_term,
&gt; {not\\_found,
&gt; {{&lt;&lt;"default"&gt;&gt;, &lt;&lt;"events"&gt;&gt;},
&gt; &lt;&lt;"1457605860\\_zeknmulfpt"&gt;&gt;},
&gt; {struct,[]}}}}:[{mochijson2,
&gt; json\\_encode,2 [{file,src/mochijson2.erl"}...
&gt;
&gt; where &lt;&lt;"1457605860\\_zeknmulfpt"&gt;&gt; is a key of an existing object in
&gt; &lt;&lt;"events"&gt;&gt; bucket, which can be fetched.
&gt;
&gt; The search itself works fine - when I do this:
&gt;
&gt; c.fulltext\\_search(idx, sstr, rows=10000)
&gt;
&gt; it works, and I can retrieve all found objects one by one. When I mapreduce
&gt; on a bucket:
&gt;
&gt; query = riak.mapreduce.RiakMapReduce(c)
&gt; query = query.add\\_bucket("track\\_here\\_events")
&gt; query = query.map\\_values()
&gt; query = query.reduce\\_limit(10)
&gt; res = query.run()
&gt;
&gt; it works too. Only combination of search and mapreduce works, though
&gt; according to documentation it should work. What may be wrong, then?
&gt;
&gt; Bartek
&gt;
&gt; --
&gt; Młodość jest straszna; to scena, gdzie na wysokich koturnach i w
&gt; najrozmaitszych kostiumach poruszają się dzieci i recytują wyuczone kwestie,
&gt; które rozumieją tylko w połowie, ale którym są fanatycznie oddane.
&gt;
&gt; (Milan Kundera, "Żart")
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

