---
title: "Re: Riak Search Field Aliases"
description: ""
project: community
lastmod: 2012-11-05T10:01:35-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09202"
mailinglist_parent_id: "msg09068"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2012-11-05T10:01:35-08:00
---


Brian,

First, our documentation is wrong. Sorry. The correct way to add aliases
looks like so:

 {field, [



 {name, "Name"},



 {analyzer\\_factory, {erlang, text\\_analyzers,
standard\\_analyzer\\_factory}},


 {alias, "LastName"},



 {alias,"FirstName"},



 {alias,"MiddleName"}



 ]},

Second, it looks like you want the semantics of a Solr copyField. That is,
index the first, middle, and last names individually but also copy their
contents into the field `Name` so that a user can easily search against the
entire name. Unfortunately Riak Search's alias mechanism doesn't provide
this semantic even if the documentation might give that impression. An
alias does 2 things:

1. If a field exist with the same name as the alias then index it under the
containing field name. E.g. if the field 'LastName' exists then index it
under 'Name'. Riak Search only indexes a field once. So either the alias
'FirstName' is found and indexed under 'Name' or 'FirstName' is found and
indexed under 'FirstName'. This means that if you declare both an alias
and a normal field with the same name the order in the schema will
determine which one wins. Both will not be used.

2. If there are multiple alises for a given field then concatenate the
values of every alias to form one field value. The order they are
concatenated is the same order as they are declared in the object being
indexed. Thus if you happened to index {M:Middle, F:Firrst, L:Last} then
the 'Name' field would have value 'Middle First Last'.

To achieve your goal you need to copy the field yourself. Declare the
'Name' field like the other fields. Don't use aliases. Index the object
as {"FirstName":"First", "MiddleName":"Middle", "LastName":"Last",
"Name":"First Middle Last"}.

-Z

P.S. The new search solution I've been working on, Yokozuna, integrates
Solr with Riak and thus supports copy fields.
http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2012-November/010042.html

On Sun, Oct 28, 2012 at 4:54 PM, Brian Hodgen wrote:

&gt; Can somebody explain in more detail how the aliases parameter on the
&gt; search schema definition works? The documentation says it lets me
&gt; index multiple fields into one, so I tried to setup some schemas to let me
&gt; search on Name, that is actually the combined data of FirstName, LastName,
&gt; & MiddleName. I've got the search working for the properties by themselves,
&gt; but I can't seem to make the aliases work, so I'm either doing something
&gt; wrong or I misunderstood how they are supposed to work.
&gt;
&gt;
&gt; Schema Example:
&gt;
&gt; I would really like this to work...but querying on Name never returns any
&gt; results.
&gt;
&gt; {
&gt; schema,
&gt; [
&gt; {version, "1.1"},
&gt; {n\\_val, 3},
&gt; {default\\_field, "Name"},
&gt; {analyzer\\_factory, {erlang, text\\_analyzers, noop\\_analyzer\\_factory}}
&gt; ],
&gt; [
&gt; {field, [
&gt; {name, "FirstName"},
&gt; {analyzer\\_factory, {erlang, text\\_analyzers, standard\\_analyzer\\_factory}}
&gt; ]},
&gt; {field, [
&gt; {name, "MiddleName"},
&gt; {analyzer\\_factory, {erlang, text\\_analyzers,
&gt; standard\\_analyzer\\_factory}}
&gt; ]},
&gt; {field, [
&gt; {name, "LastName"},
&gt; {analyzer\\_factory, {erlang, text\\_analyzers, standard\\_analyzer\\_factory}}
&gt; ]},
&gt; {field, [
&gt; {name, "Name"},
&gt; {analyzer\\_factory, {erlang, text\\_analyzers,
&gt; standard\\_analyzer\\_factory}},
&gt; {aliases, ["LastName","FirstName","MiddleName"]}
&gt; ]},
&gt; {dynamic\\_field, [
&gt; {name, "\\*"},
&gt; {skip, true}
&gt; ]}
&gt; ]
&gt; }.
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

