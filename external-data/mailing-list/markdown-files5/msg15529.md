---
title: "Re: Multiget java client performance"
description: ""
project: community
lastmod: 2015-01-20T09:14:19-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15529"
mailinglist_parent_id: "msg15524"
author_name: "Brian Roach"
project_section: "mailinglistitem"
sent_date: 2015-01-20T09:14:19-08:00
---


Santi -

The core of the 2.0 Java client uses Netty. There's a fixed number of
worker threads that process sockets using non-blocking IO ( w/
polling/select).

Due to the synchronous nature of the Riak API, each fetch operation
requires its own socket connection and we can't pipeline.

As noted in the Javadoc for MultiFetch
(http://basho.github.io/riak-java-client/2.0.0/com/basho/riak/client/api/commands/kv/MultiFetch.html)
there is a default of 10 simultaneous fetches in flight at once. This
is pretty conservative but ... that's what defaults are for :)

How does it scale? Depends on the hardware, network latency, etc. In
the end ... you've only got so many threads and you prob don't want
1000 sockets being created at once. Best suggestion is to adjust up
the number of simultaneous inflight and measure it.

Thanks,
- Roach



On Mon, Jan 19, 2015 at 6:43 PM, Santi Kumar  wrote:
&gt; Brain
&gt; I"m using Riak Client 2.0.0 and Riak 2.0.2.
&gt;
&gt;
&gt;
&gt; On Tue, Jan 20, 2015 at 1:54 AM, Brian Roach  wrote:
&gt;&gt;
&gt;&gt; Santi -
&gt;&gt;
&gt;&gt; Which version of the Java client?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; - Roach
&gt;&gt;
&gt;&gt; On Mon, Jan 19, 2015 at 7:36 AM, Santi Kumar  wrote:
&gt;&gt; &gt; Hi
&gt;&gt; &gt;
&gt;&gt; &gt; We are using java client for accessing Riak KV/Search. For some use
&gt;&gt; &gt; cases,
&gt;&gt; &gt; we go to search, get the keys and access the data from Riak. There might
&gt;&gt; &gt; be
&gt;&gt; &gt; a case where we might get 1000's of keys. So want to understand what is
&gt;&gt; &gt; the
&gt;&gt; &gt; impact of that on multiget and how does it scale.
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; We were using RDBMS and Elastic search earlier. Now we moved all the
&gt;&gt; &gt; data to
&gt;&gt; &gt; Riak KV and Search. We used to query all the audit entries from ES as we
&gt;&gt; &gt; used to store the complete data there. Applicaitons flows used to get
&gt;&gt; &gt; the
&gt;&gt; &gt; data from RDBMS. Now as we replaced everything with Riak KV and search,
&gt;&gt; &gt; We
&gt;&gt; &gt; need to go to Riak Search for auditing reports. If we store all the
&gt;&gt; &gt; objects
&gt;&gt; &gt; in Riak Search, how does it impact ?
&gt;&gt; &gt;
&gt;&gt; &gt; Thanks
&gt;&gt; &gt; Santi
&gt;&gt; &gt;
&gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; &gt;
&gt;
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

