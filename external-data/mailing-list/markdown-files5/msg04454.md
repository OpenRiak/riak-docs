---
title: "Re: Setting up a Riak + Mongrel2 Stack"
description: ""
project: community
lastmod: 2011-08-24T20:16:26-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04454"
mailinglist_parent_id: "msg04452"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-08-24T20:16:26-07:00
---


haproxy is a proxy server, nothing more. It would let your client libraries 
assume that there's only 1 Riak node. That makes life easier because you don't 
have to implement your own load balancing algorithm.

You'll have something like this awful ASCII art:

Application Programming Language
Web Server

HAProxy

Riak Riak Riak Riak Riak Riak â€¦ Riak
---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Aug 24, 2011, at 10:06 AM, trevor stanhope wrote:

&gt; In terms of haproxy, would you say that is that a good platform for web
&gt; service development (ie would I be able code a service site, like
&gt; github, on that platform in place of another webserver) or is that
&gt; purely to handle requests to and from the kvstore? From their
&gt; description it seems that HAProxy would feed connections either to the
&gt; datastore or the webserver (then back through to the datastore) but that
&gt; would mean I'd still be in need of some webserver to host the browser
&gt; based application.
&gt; 
&gt; Being able to easily put together a user service on top of a http
&gt; browser front end is an important (albeit secondary to the mobile
&gt; application) feature that I'd like to test out.
&gt; 
&gt; On Wed, 2011-08-24 at 09:49 -0700, Jeremiah Peschka wrote: 
&gt;&gt; Use whatever language on the server-side that you're comfortable working 
&gt;&gt; with. If you're into Ruby, Ripple is quite mature. The Java client is nice. 
&gt;&gt; I personally like the .NET client (of course I'm slightly biased on that 
&gt;&gt; front). I'd avoid exposing Riak to the open internet, even if it is through 
&gt;&gt; a proxy of some sort. Use a set of APIs so that you can abstract your data 
&gt;&gt; storage away from the calling application. A lot of people are reporting 
&gt;&gt; success with haproxy as the proxy for their Riak instances. 
&gt;&gt; 
&gt;&gt; OJ Reeves put together a bit of a tutorial on haproxy and Riak: 
&gt;&gt; http://buffered.io/2010/09/12/webmachine-erlydtl-and-riak-part-2/
&gt;&gt; 
&gt;&gt; You can drastically improve performance by avoiding the HTTP interface and 
&gt;&gt; using the Protocol Buffers interfaces to Riak, but that depends more on your 
&gt;&gt; language of choice than anything else (some libraries may not support the PB 
&gt;&gt; interface).
&gt;&gt; ---
&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
&gt;&gt; Microsoft SQL Server MVP
&gt;&gt; 
&gt;&gt; On Aug 24, 2011, at 9:43 AM, trevor stanhope wrote:
&gt;&gt; 
&gt;&gt;&gt; Beyond using Mongrel2 as a proxy, which webserver might be best suited
&gt;&gt;&gt; to work with Riak.
&gt;&gt;&gt; 
&gt;&gt;&gt; Also, let me give you a basic idea of the system I'm planning to test.
&gt;&gt;&gt; More or less I'm trying to set-up the proxy in front of the riak kvs and
&gt;&gt;&gt; will be making calls to the datastore from a mobile phone application,
&gt;&gt;&gt; that will be doing some basic JSON MPqueries on the system (I'm debating
&gt;&gt;&gt; the merit of link walking for new db information, though I hear that
&gt;&gt;&gt; riak get is faster for objects that are known to exists). These will be
&gt;&gt;&gt; either parsed and returned to the mobile app, or returned to the
&gt;&gt;&gt; webserver to view in an online application.
&gt;&gt;&gt; 
&gt;&gt;&gt; Otherwise, the webserver needs to make simple authenticated writes to
&gt;&gt;&gt; the kvs, mostly to add links to existing objects, which will ideally be
&gt;&gt;&gt; populated into the db via scripts built into the webserver front-end
&gt;&gt;&gt; (but for testing purposes I was planning to use bash scripts, or some
&gt;&gt;&gt; faster equivalent).
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; On Wed, 2011-08-24 at 11:38 -0400, Jonathan Langevin wrote:
&gt;&gt;&gt;&gt; I dunno about mongrel, but I know some of the guys at basho have
&gt;&gt;&gt;&gt; personally used a proxy in front of Riak (Matt Heitzenroder is one
&gt;&gt;&gt;&gt; that's mentioned it before, I've CC'd him).
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; My thought is that if you can find out the general configuration
&gt;&gt;&gt;&gt; method of how to set up a proxy in front of Riak (such as how it may
&gt;&gt;&gt;&gt; differ from a typical proxy, if there's any special headers you have
&gt;&gt;&gt;&gt; to pass, what settings to apply regarding caching, etc), you could
&gt;&gt;&gt;&gt; then take that info to the Mongrel community and get some specific
&gt;&gt;&gt;&gt; help there for implementing the proxy configuration with the general
&gt;&gt;&gt;&gt; information you've gleamed from the Basho guys.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Jonathan Langevin
&gt;&gt;&gt;&gt; Systems Administrator
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Loom Inc.
&gt;&gt;&gt;&gt; Wilmington, NC: (910) 241-0433
&gt;&gt;&gt;&gt; - jlange...@loomlearning.com - www.loomlearning.com - Skype: intel352
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On Tue, Aug 23, 2011 at 5:28 PM, trevor stanhope
&gt;&gt;&gt;&gt;  wrote:
&gt;&gt;&gt;&gt; exactly. I'm looking to setup mongrel2 as front-end to a Riak
&gt;&gt;&gt;&gt; kvs.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On Tue, 2011-08-23 at 14:25 -0400, Jonathan Langevin wrote:
&gt;&gt;&gt;&gt;&gt; Is your intention to use mongrel as a proxy for Riak?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Jonathan Langevin
&gt;&gt;&gt;&gt;&gt; Systems Administrator
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Loom Inc.
&gt;&gt;&gt;&gt;&gt; Wilmington, NC: (910) 241-0433
&gt;&gt;&gt;&gt;&gt; - jlange...@loomlearning.com - www.loomlearning.com - Skype:
&gt;&gt;&gt;&gt; intel352
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; On Thu, Aug 18, 2011 at 2:01 AM, trevor stanhope
&gt;&gt;&gt;&gt;&gt;  wrote:
&gt;&gt;&gt;&gt;&gt; Hey, I've been probing around for any existing
&gt;&gt;&gt;&gt; examples of a
&gt;&gt;&gt;&gt;&gt; Riak +
&gt;&gt;&gt;&gt;&gt; Mongrel2 stack being deployed and haven't had any
&gt;&gt;&gt;&gt; luck. I'm
&gt;&gt;&gt;&gt;&gt; not familiar
&gt;&gt;&gt;&gt;&gt; with Mongrel2 but it was recommended to me and I'm
&gt;&gt;&gt;&gt; very
&gt;&gt;&gt;&gt;&gt; interested in
&gt;&gt;&gt;&gt;&gt; deploying on that platform. What recommendations or
&gt;&gt;&gt;&gt; who would
&gt;&gt;&gt;&gt;&gt; be best to
&gt;&gt;&gt;&gt;&gt; speak with on that subject?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Best Regards,
&gt;&gt;&gt;&gt;&gt; Trev Stanhope
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; 
&gt; 
&gt; 


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

