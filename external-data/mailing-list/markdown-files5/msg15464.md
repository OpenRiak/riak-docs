---
title: "Re: Riak Search having issues with custom schema"
description: ""
project: community
lastmod: 2015-01-09T10:26:49-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15464"
mailinglist_parent_id: "msg15460"
author_name: "Santi Kumar"
project_section: "mailinglistitem"
sent_date: 2015-01-09T10:26:49-08:00
---


Cool I'll check that. Appreciate your timely help Luke
On Jan 9, 2015 11:53 PM, "Luke Bakken"  wrote:

&gt; Hi Santi,
&gt;
&gt; This means that the extractor is working. Your next step is to ensure
&gt; that the field names returned by the extractor match the field names
&gt; in your Solr schema. Also, please check to ensure that your schema has
&gt; all required \\_yz\\_\\* fields.
&gt; --
&gt; Luke Bakken
&gt; Engineer
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Fri, Jan 9, 2015 at 9:38 AM, Santi Kumar  wrote:
&gt; &gt; Sorry Luke, I pasted the content in a file and ran the command it worked
&gt; &gt; fine. I got the output from extract in json format with all the non null
&gt; &gt; fields. Does that mean custom schema is working?
&gt; &gt;
&gt; &gt; Thanks for timely help and pointing to right resources
&gt; &gt;
&gt; &gt; Santi
&gt; &gt;
&gt; &gt; On Fri, Jan 9, 2015 at 10:55 PM, Santi Kumar  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; I ran the command as shown below but I was getting wierd errors. In the
&gt; &gt;&gt; place of @object.json, I used the actual json content. Output was
&gt; &gt;&gt;
&gt; &gt;&gt; curl -XPUT http://localhost:8098/search/extract -H 'Content-Type:
&gt; &gt;&gt; application/json' --data-binary
&gt; &gt;&gt;
&gt; @{"id":null,"tenantId":"eb0a1917-9762-3dd3-a48f-a681d3061212","createdById":null,"createdBy":"SYSTEM","created":1420801439932,"lastUpdatedById":null,"lastUpdatedBy":"SYSTEM","lastUpdated":1420801439932,"policyId":"2d29e759-8e30-499a-8ecc-98eb09eeaa9f","searchId":"557134f2-3589-3fdb-927f-6a71e8098eee","name":"Collaborate","description":"Allow
&gt; &gt;&gt; editing of file
&gt; &gt;&gt;
&gt; content","isDefault":true,"enable\\_edit":true,"disable\\_auth\\_on\\_open":true,"enable\\_copy\\_paste":"DISALLOW","enable\\_printing":false,"enable\\_offline":true,"offline\\_timeout":null,"time\\_bomb\\_duration":null,"enable\\_save\\_as":false,"disable\\_watermark":true,"disable\\_spotlight":true,"enable\\_screen\\_capture":false,"disable\\_onetime\\_use":true}
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Output is like this
&gt; &gt;&gt;
&gt; &gt;&gt; 500 Internal Server
&gt; &gt;&gt; ErrorInternal Server Error
=====================

The server
&gt; &gt;&gt; encountered an error while processing this request:  

```
{error,
&gt; &gt;&gt;
&gt; &gt;&gt;     {error,
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt;  {case_clause,&lt;&lt;"tenantId:eb0a1917-9762-3dd3-a48f-a681d3061212"&gt;&gt;},
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt;  [{mochijson2,tokenize,2,[{file,"src/mochijson2.erl"},{line,529}]},
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; {mochijson2,decode1,2,[{file,"src/mochijson2.erl"},{line,312}]},
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; {mochijson2,json_decode,2,[{file,"src/mochijson2.erl"},{line,307}]},
&gt; &gt;&gt;
&gt; &gt;&gt;          {yz_json_extractor,extract_fields,2,
&gt; &gt;&gt;
&gt; &gt;&gt;              [{file,"src/yz_json_extractor.erl"},{line,63}]},
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; {yz_wm_extract,extract,2,[{file,"src/yz_wm_extract.erl"},{line,91}]},
&gt; &gt;&gt;
&gt; &gt;&gt;          {webmachine_resource,resource_call,3,
&gt; &gt;&gt;
&gt; &gt;&gt;              [{file,"src/webmachine_resource.erl"},{line,186}]},
&gt; &gt;&gt;
&gt; &gt;&gt;          {webmachine_resource,do,3,
&gt; &gt;&gt;
&gt; &gt;&gt;              [{file,"src/webmachine_resource.erl"},{line,142}]},
&gt; &gt;&gt;
&gt; &gt;&gt;          {webmachine_decision_core,resource_call,1,
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; [{file,"src/webmachine_decision_core.erl"},{line,48}]}]}}
```


---

mochiweb+webmachine
&gt; &gt;&gt; web server

curl: (6) Could not resolve host:
&gt; &gt;&gt; createdById
&gt; &gt;&gt;
&gt; &gt;&gt; curl: (6) Could not resolve host: createdBy
&gt; &gt;&gt;
&gt; &gt;&gt; curl: (3) Port number too large: 1420801439932
&gt; &gt;&gt;
&gt; &gt;&gt; curl: (6) Could not resolve host: lastUpdatedById
&gt; &gt;&gt;
&gt; &gt;&gt; curl: (6) Could not resolve host: lastUpdatedBy
&gt; &gt;&gt;
&gt; &gt;&gt; curl: (3) Port number too large: 1420801439932
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; On Fri, Jan 9, 2015 at 10:29 PM, Luke Bakken  wrote:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Please run your JSON document through the extractor to ensure that
&gt; &gt;&gt;&gt; it's being parsed correctly:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; http://docs.basho.com/riak/latest/dev/advanced/search/#Extractors
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; curl -XPUT http://localhost:8098/search/extract \\
&gt; &gt;&gt;&gt; -H 'Content-Type: application/json' \\
&gt; &gt;&gt;&gt; --data-binary @object.json
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; If that works correctly, your schema may not have all of the required
&gt; &gt;&gt;&gt; fields:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; http://docs.basho.com/riak/latest/dev/advanced/search-schema/
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; http://docs.basho.com/riak/latest/dev/advanced/search-schema/#Custom-Schemas
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; --
&gt; &gt;&gt;&gt; Luke Bakken
&gt; &gt;&gt;&gt; Engineer
&gt; &gt;&gt;&gt; lbak...@basho.com
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; On Fri, Jan 9, 2015 at 8:55 AM, Santi Kumar 
&gt; wrote:
&gt; &gt;&gt;&gt; &gt; Luke
&gt; &gt;&gt;&gt; &gt; It's application/json
&gt; &gt;&gt;&gt; &gt;
&gt; &gt;&gt;&gt; &gt; Here is the curl command and output dump with content-type in bold
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

