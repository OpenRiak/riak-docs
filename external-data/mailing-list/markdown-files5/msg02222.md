---
title: "Re: Ripple one Association Troubles"
description: ""
project: community
lastmod: 2011-02-08T10:48:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02222"
mailinglist_parent_id: "msg02221"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-02-08T10:48:11-08:00
---


Stephen,

Was your User object saved before you added it the journal entry?

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Feb 8, 2011, at 1:46 PM, Stephen Allred wrote:

&gt; Sean,
&gt; 
&gt; $ puts journal\\_entry.robject.links.inspect
&gt; #; riaktag="user", 
&gt; ; riaktag="up"}&gt;
&gt; =&gt; nil 
&gt; 
&gt; $ journal\\_entry
&gt; =&gt;  created\\_at=2011-02-07 22:47:17 UTC updated\\_at=2011-02-08 18:08:47 UTC&gt;
&gt; 
&gt; $ journal\\_entry.user
&gt; (Object doesn't support #inspect)
&gt; =&gt;
&gt; 
&gt; $ journal\\_entry.user.inspect
&gt; NoMethodError: undefined method `key' for nil:NilClass
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/activesupport-3.0.3/lib/active\\_support/whiny\\_nil.rb:48:in
&gt; `method\\_missing'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:122:in
&gt; `block in instantiate'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
&gt; `tap'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
&gt; `instantiate'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/one\\_linked\\_proxy.rb:25:in
&gt; `find\\_target'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:113:in
&gt; `load\\_target'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:41:in
&gt; `inspect'
&gt; from (irb):17
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:44:in
&gt; `start'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:8:in
&gt; `start'
&gt; from 
&gt; /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands.rb:23:in
&gt; `'
&gt; from script/rails:6:in `require'
&gt; from script/rails:6:in `'
&gt; 
&gt; Hopefully those are useful,
&gt; Thanks for the quick response!
&gt; Steve
&gt; 
&gt; On 8 Feb 2011, at 6:37 PM, Sean Cribbs wrote:
&gt; 
&gt;&gt; Stephen,
&gt;&gt; 
&gt;&gt; Sounds like you've either found a bug. When you have saved the journal 
&gt;&gt; entry in irb, what is the output of this command?
&gt;&gt; 
&gt;&gt; puts journal\\_entry.robject.links.inspect
&gt;&gt; 
&gt;&gt; Sean Cribbs 
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;&gt; 
&gt;&gt; On Feb 8, 2011, at 1:23 PM, Stephen Allred wrote:
&gt;&gt; 
&gt;&gt;&gt; Hi all,
&gt;&gt;&gt; 
&gt;&gt;&gt; I'm having trouble setting up a one association in a ripple document. I'm 
&gt;&gt;&gt; trying to setup an association between a user and a journal entry, such 
&gt;&gt;&gt; that the journal has one user, that the user created.
&gt;&gt;&gt; 
&gt;&gt;&gt; My JournalEntry document:
&gt;&gt;&gt; 
&gt;&gt;&gt; --- journal\\_entry.rb ---
&gt;&gt;&gt; require 'ripple'
&gt;&gt;&gt; 
&gt;&gt;&gt; class JournalEntry
&gt;&gt;&gt; include Ripple::Document
&gt;&gt;&gt; 
&gt;&gt;&gt; property :short\\_title, String, :presence =&gt; true
&gt;&gt;&gt; property :title, String, :presence =&gt; true
&gt;&gt;&gt; property :entry, String, :presence =&gt; true
&gt;&gt;&gt; 
&gt;&gt;&gt; timestamps!
&gt;&gt;&gt; 
&gt;&gt;&gt; one :user
&gt;&gt;&gt; 
&gt;&gt;&gt; key\\_on :short\\_title
&gt;&gt;&gt; end
&gt;&gt;&gt; ---
&gt;&gt;&gt; 
&gt;&gt;&gt; My User document:
&gt;&gt;&gt; 
&gt;&gt;&gt; --- user.rb ---
&gt;&gt;&gt; require 'ripple'
&gt;&gt;&gt; require 'digest'
&gt;&gt;&gt; 
&gt;&gt;&gt; class User
&gt;&gt;&gt; include Ripple::Document
&gt;&gt;&gt; 
&gt;&gt;&gt; devise :registerable, :confirmable, :database\\_authenticatable, 
&gt;&gt;&gt; :recoverable, :validatable
&gt;&gt;&gt; 
&gt;&gt;&gt; property :email, String, :presence =&gt; true
&gt;&gt;&gt; property :password, String
&gt;&gt;&gt; property :password\\_confirmation, String
&gt;&gt;&gt; timestamps!
&gt;&gt;&gt; 
&gt;&gt;&gt; key\\_on :email
&gt;&gt;&gt; 
&gt;&gt;&gt; def key
&gt;&gt;&gt; email
&gt;&gt;&gt; end
&gt;&gt;&gt; 
&gt;&gt;&gt; def id
&gt;&gt;&gt; email
&gt;&gt;&gt; end
&gt;&gt;&gt; end
&gt;&gt;&gt; ---
&gt;&gt;&gt; 
&gt;&gt;&gt; I've tried in the rails console to associate a user with journal\\_entry 
&gt;&gt;&gt; (journal\\_entry.user = user), save it and reload it. The resulting reloaded 
&gt;&gt;&gt; journal\\_entry does not have a user (calling journal\\_entry.user prints 
&gt;&gt;&gt; "(Object doesn't support #inspect)").
&gt;&gt;&gt; 
&gt;&gt;&gt; My journal entry in riak loaded via the browser looks like:
&gt;&gt;&gt; 
&gt;&gt;&gt; {"short\\_title":"test","title":"test","entry":"test","created\\_at":"Mon, 07 
&gt;&gt;&gt; Feb 2011 22:47:17 -0000","updated\\_at":"Tue, 08 Feb 2011 18:08:47 
&gt;&gt;&gt; -0000","\\_type":"JournalEntry"}
&gt;&gt;&gt; 
&gt;&gt;&gt; Does anyone know what I'm doing wrong?
&gt;&gt;&gt; Cheers!
&gt;&gt;&gt; Steve
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; 
&gt; 


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

