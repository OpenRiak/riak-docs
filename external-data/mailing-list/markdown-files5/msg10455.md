---
title: "errors after rolling upgrade to 1.3"
description: ""
project: community
lastmod: 2013-03-15T03:03:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10455"
author_name: "Mridul Kashatria"
project_section: "mailinglistitem"
sent_date: 2013-03-15T03:03:14-07:00
---



Hi

I'm upgrading nodes from 1.2.1 to 1.3 and also changing the backend to 
eleveldb to use secondary indexes.


I'm following the steps as;
1. on a node i run riak-admin cluster leave
2. after that node shuts down, I upgrade to 1.3 and update config files 
to eleveldb

3. after cleaning up the directories, I start riak again.
4. I run riak-admin cluster join

After joining, the cluster contains 3 nodes on 1.2 with bitcask and 1 
with 1.3 eleveldb. Riak search is enabled in all.


I'm seeing errors on the new nodes like below and riak search and 
mapreduce sometimes fails to return results.


2013-03-15 09:45:35.104 [error] &lt;0.4065.0&gt; gen\\_fsm &lt;0.4065.0&gt; in state 
wait\\_for\\_input terminated with reason: bad function 
#Fun in riak\\_kv\\_w\\_reduce:reduce/3 line 206


2013-03-15 09:45:35.110 [error] &lt;0.4065.0&gt; CRASH REPORT Process 
&lt;0.4065.0&gt; with 0 neighbours exited with reason: bad function 
#Fun in riak\\_kv\\_w\\_reduce:reduce/3 line 206 
in gen\\_fsm:terminate/7 line 611



2013-03-15 09:58:17.883 [error] &lt;0.8505.0&gt; gen\\_fsm &lt;0.8505.0&gt; in state 
wait\\_for\\_input terminated with reason: bad function 
#Fun in riak\\_kv\\_w\\_reduce:reduce/3 line 206


2013-03-15 09:58:17.886 [error] &lt;0.361.0&gt;@riak\\_pipe\\_vnode:new\\_worker:768 
Pipe worker startup failed:fitting was gone before startup


2013-03-15 09:58:17.890 [error] &lt;0.8505.0&gt; CRASH REPORT Process 
&lt;0.8505.0&gt; with 0 neighbours exited with reason: bad function 
#Fun in riak\\_kv\\_w\\_reduce:reduce/3 line 206 
in gen\\_fsm:terminate/7 line 611



Thanks

--
Mridul


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

