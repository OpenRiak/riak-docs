---
title: "Re: What do you do when Riak freezes?"
description: ""
project: community
lastmod: 2014-03-19T14:32:51-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13848"
mailinglist_parent_id: "msg13847"
author_name: "Michael Dillon"
project_section: "mailinglistitem"
sent_date: 2014-03-19T14:32:51-07:00
---


We are using AMazon EC2 m3.x2large nodes and while the freeze is occurring
free reports

 total used free shared buffers cached

Mem: 30623232 8818792 21804440 0 88092 4411832

-/+ buffers/cache: 4318868 26304364

Swap: 0 0 0

The Erlang processes seem to be unkillable because "shutdown -r now" is
also hanging. Right now these nodes are just being used for some testing,
but eventually we will go into production and I really need to have a plan
for how to detect and then deal with these Erlang freezes. Or better yet, a
way to avoid them even if it means detecting some condition in advance and
then rebooting the node.



On Wed, Mar 19, 2014 at 2:07 PM, Matthew Von-Maszewski
wrote:

&gt;
&gt; Any chance you are overflowing into swap? Or in the case of XEN have you
&gt; exceeded the guaranteed RAM for the VM memory and moved into the disk
&gt; backed portion of "ram"?
&gt;
&gt; What backend do you use within riak? Do you have memory statistics from
&gt; before and after the seizure/freeze?
&gt;
&gt; Matthew
&gt;
&gt;
&gt; On Mar 19, 2014, at 4:56 PM, Michael Dillon 
&gt; wrote:
&gt;
&gt; &gt; I've run into a problem with Riak freezing completely on one node
&gt; running on Ubuntu 12.04 LTS on a XEN VM (EC2). If I ssh into the node and
&gt; run "ps ax" that shell session also freezes. I also tried another ssh
&gt; session with "netstat -lnp" to see if I could find the process ID to kill,
&gt; but that also froze.
&gt; &gt;
&gt; &gt; I must admit that I have seen a similar problem with RabbitMQ running on
&gt; Ubuntu 10 LTS on a an OpenVPS VM a few years ago.
&gt; &gt;
&gt; &gt; I suppose this is an Erlang issue of some sort, but I would really like
&gt; some way to kill the Riak processes without a reboot if possible.
&gt; &gt;
&gt; &gt; --
&gt; &gt; PageFreezer.com
&gt; &gt; #200 - 311 Water Street
&gt; &gt; Vancouver, BC V6B 1B8
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
PageFreezer.com
#200 - 311 Water Street
Vancouver, BC V6B 1B8
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

