---
title: "Re: Re: badrecord during transfer"
description: ""
project: community
lastmod: 2013-12-03T06:39:42-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13139"
mailinglist_parent_id: "msg13135"
author_name: "Ivan Skytte JÃ¸rgensen"
project_section: "mailinglistitem"
sent_date: 2013-12-03T06:39:42-08:00
---


On Monday 02 December 2013 18:10:32 Ryan Zezeski wrote:
&gt; Ivan,
&gt; 
&gt; What makes you think the index is damaged? 

Only the mention of "badrec" which I would assume meant a damanged record.

&gt; From what I can see this is a
&gt; bug in the code assuming that a #ho\\_acc record is always returned but in
&gt; fact an error tuple could also be returned. That error tuple could be
&gt; caused by index corruption but there is nothing in your email to say for
&gt; sure. Do you see any other errors in the log?

Yes:

[root@ip-10-196-50-172 riak]# tail error.log

2013-12-03 14:29:45.167 [error] &lt;0.1833.0&gt;@mi\\_server:handle\\_info:524 
lookup/range failure: 
{{nocatch,{error,iterate2,timeout\\_waiting\\_for\\_continue}},[{mi\\_server,iterate2,5,[{file,"src/mi\\_server.erl"},{line,682}]}]}
2013-12-03 14:30:06.132 [error] 
&lt;0.1909.0&gt;@merge\\_index\\_backend:async\\_fold\\_fun:116 failed to iterate the index 
with reason 
{{nocatch,{error,iterate2,timeout\\_waiting\\_for\\_continue}},[{mi\\_server,iterate2,5,[{file,"src/mi\\_server.erl"},{line,682}]}]}
 and partial acc 
{{ho\\_acc,16,ok,#Fun,riak\\_search\\_vnode,&lt;0.1832.0&gt;,#Port&lt;0.616405&gt;,{502391187832497878132516661246222288006726811648,502391187832497878132516661246222288006726811648},{ho\\_stats,{1386,80925,839128},undefined,4637,1071941},gen\\_tcp,27777,43222372,[&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,51,49,90,108,0,0,0,2,104,3,109,0,0,0,25,55,48,52,52,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,51,49,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,5,51,187,167,205,231,4,104,3,109,0,0,0,25,54,49,49,50,59
 
,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,51,49,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,155,20,127,167,205,231,4,106&gt;&gt;,&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,57,90,108,0,0,0,2,104,3,109,0,0,0,25,55,48,48,53,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,57,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,151,149,213,169,205,231,4,104,3,109,0,0,0,25,54,57,52,52,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,57,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,198,232,168,169,205,231,4,106&gt;&gt;,&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,48,90,108,0
 
,0,0,2,104,3,109,0,0,0,25,54,57,56,55,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,48,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,121,143,181,165,205,231,4,104,3,109,0,0,0,25,54,50,48,57,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,48,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,68,222,165,165,205,231,4,106&gt;&gt;,&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,11,104,3,109,0,0,0,25,55,48,51,48,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,184,197,81,149,205,231,4,104,3,109,0,0,0,25,55,48,48,57,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,161,67,223,145,205,231,4,104,3,109,0,0,0,25,55,48,48,53,59,50,48,49,
 
51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,225,221,223,145,205,231,4,104,3,109,0,0,0,25,54,57,54,57,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,77,179,222,145,205,231,4,104,3,109,0,0,0,25,54,57,54,55,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,45,134,224,145,205,231,4,104,3,109,0,0,0,25,54,57,53,51,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,11,106,208,145,205,231,4,104,3,109,0,0,0,25,54,57,52,52,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,73,21,225,145,205,231,4,104,3,109,0,0,0,25,54,57,52,50,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,224,54,222,145,205,231,4,104,3,109,0,0,
 
0,25,54,57,50,50,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,...&gt;&gt;,...],...},...}
2013-12-03 14:30:06.132 [error] 
&lt;0.18468.37&gt;@riak\\_core\\_handoff\\_sender:start\\_fold:269 hinted\\_handoff transfer of 
riak\\_search\\_vnode from 'riak@10.196.50.172' 
502391187832497878132516661246222288006726811648 to 'riak@10.197.0.55' 
502391187832497878132516661246222288006726811648 failed because of 
error:{badrecord,ho\\_acc} 
[{riak\\_core\\_handoff\\_sender,start\\_fold,5,[{file,"src/riak\\_core\\_handoff\\_sender.erl"},{line,193}]}]
2013-12-03 14:35:32.546 [error] emulator Error in process &lt;0.20961.37&gt; on node 
'riak@10.196.50.172' with exit value: 
{{nocatch,{error,iterate2,timeout\\_waiting\\_for\\_continue}},[{mi\\_server,iterate2,5,[{file,"src/mi\\_server.erl"},{line,682}]}]}


2013-12-03 14:35:32.546 [error] &lt;0.1833.0&gt;@mi\\_server:handle\\_info:524 
lookup/range failure: 
{{nocatch,{error,iterate2,timeout\\_waiting\\_for\\_continue}},[{mi\\_server,iterate2,5,[{file,"src/mi\\_server.erl"},{line,682}]}]}
2013-12-03 14:35:45.454 [error] 
&lt;0.1908.0&gt;@merge\\_index\\_backend:async\\_fold\\_fun:116 failed to iterate the index 
with reason 
{{nocatch,{error,iterate2,timeout\\_waiting\\_for\\_continue}},[{mi\\_server,iterate2,5,[{file,"src/mi\\_server.erl"},{line,682}]}]}
 and partial acc 
{{ho\\_acc,16,ok,#Fun,riak\\_search\\_vnode,&lt;0.1832.0&gt;,#Port&lt;0.617641&gt;,{502391187832497878132516661246222288006726811648,502391187832497878132516661246222288006726811648},{ho\\_stats,{1386,81273,907256},undefined,4637,1071941},gen\\_tcp,27777,43222372,[&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,51,49,90,108,0,0,0,2,104,3,109,0,0,0,25,55,48,52,52,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,51,49,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,5,51,187,167,205,231,4,104,3,109,0,0,0,25,54,49,49,50,59
 
,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,51,49,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,155,20,127,167,205,231,4,106&gt;&gt;,&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,57,90,108,0,0,0,2,104,3,109,0,0,0,25,55,48,48,53,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,57,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,151,149,213,169,205,231,4,104,3,109,0,0,0,25,54,57,52,52,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,57,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,198,232,168,169,205,231,4,106&gt;&gt;,&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,48,90,108,0
 
,0,0,2,104,3,109,0,0,0,25,54,57,56,55,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,48,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,121,143,181,165,205,231,4,104,3,109,0,0,0,25,54,50,48,57,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,57,58,48,48,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,68,222,165,165,205,231,4,106&gt;&gt;,&lt;&lt;1,131,104,4,109,0,0,0,5,117,115,97,103,101,109,0,0,0,30,111,114,105,103,105,110,97,108,95,100,97,116,97,95,99,111,111,114,100,105,110,97,116,111,114,95,116,105,109,101,109,0,0,0,20,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,11,104,3,109,0,0,0,25,55,48,51,48,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,184,197,81,149,205,231,4,104,3,109,0,0,0,25,55,48,48,57,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,161,67,223,145,205,231,4,104,3,109,0,0,0,25,55,48,48,53,59,50,48,49,
 
51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,225,221,223,145,205,231,4,104,3,109,0,0,0,25,54,57,54,57,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,77,179,222,145,205,231,4,104,3,109,0,0,0,25,54,57,54,55,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,45,134,224,145,205,231,4,104,3,109,0,0,0,25,54,57,53,51,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,11,106,208,145,205,231,4,104,3,109,0,0,0,25,54,57,52,52,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,73,21,225,145,205,231,4,104,3,109,0,0,0,25,54,57,52,50,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,7,0,224,54,222,145,205,231,4,104,3,109,0,0,
 
0,25,54,57,50,50,59,50,48,49,51,45,49,48,45,48,51,84,48,51,58,49,51,58,50,55,90,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,110,...&gt;&gt;,...],...},...}
2013-12-03 14:35:45.454 [error] 
&lt;0.20959.37&gt;@riak\\_core\\_handoff\\_sender:start\\_fold:269 hinted\\_handoff transfer of 
riak\\_search\\_vnode from 'riak@10.196.50.172' 
502391187832497878132516661246222288006726811648 to 'riak@10.197.0.55' 
502391187832497878132516661246222288006726811648 failed because of 
error:{badrecord,ho\\_acc} 
[{riak\\_core\\_handoff\\_sender,start\\_fold,5,[{file,"src/riak\\_core\\_handoff\\_sender.erl"},{line,193}]}]


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

