---
title: "Re: Dangling keys/objects after a batch of sequential inserts (for	going on 3 days)"
description: ""
project: community
lastmod: 2013-07-21T13:57:33-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11662"
mailinglist_parent_id: "msg11661"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2013-07-21T13:57:33-07:00
---


No idea what the problem is but it's been mentioned a few times here that when 
running these sorts of tests you should always change the bucket name to keep 
things fresh. 

-Alexander 


@siculars
http://siculars.posthaven.com

Sent from my iRotaryPhone

On Jul 21, 2013, at 14:56, Siraaj Khandkar  wrote:

&gt; On 07/21/2013 02:42 PM, Siraaj Khandkar wrote:
&gt;&gt; On 07/21/2013 02:20 PM, Siraaj Khandkar wrote:
&gt;&gt;&gt; On 07/21/2013 07:24 AM, Russell Brown wrote:&gt; Hi,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; On 21 Jul 2013, at 02:09, Siraaj Khandkar  wrote:
&gt; 
&gt; 
&gt; 
&gt;&gt;&gt; This is how I am testing it:
&gt;&gt;&gt; 
&gt;&gt;&gt; Compare = fun(PID, Bucket) -&gt;
&gt;&gt;&gt; B = Bucket,
&gt;&gt;&gt; L1 = riakc\\_pb\\_socket:get\\_index(PID, B, {binary\\_index,
&gt;&gt;&gt; "bucket"}, B),
&gt;&gt;&gt; L2 = riakc\\_pb\\_socket:get\\_index(PID, B, {binary\\_index,
&gt;&gt;&gt; "bucket"}, B),
&gt; 
&gt; Err. Copy-n-paste error. This should, of course, be:
&gt; 
&gt; I = "bucket",
&gt; {ok, {keys, L1}}=riakc\\_pb\\_socket:get\\_index(PID, B, {binary\\_index, I}, B)
&gt; {ok, {keys, L2}}=riakc\\_pb\\_socket:get\\_index(PID, B, {binary\\_index, I}, B)
&gt; 
&gt; In the real code I'm actually calling a wrapper function that matches on {ok, 
&gt; {keys, Keys}}.
&gt; 
&gt; 
&gt; 
&gt; 
&gt;&gt;&gt; io:format("L1: ~b, L2: ~b~n",[length(L1), length(L2)]),
&gt;&gt;&gt; Diff\\_L1\\_L2 = L1 -- L2,
&gt;&gt;&gt; Diff\\_L2\\_L1 = L2 -- L1,
&gt;&gt;&gt; io:format("=== L1 -- L2 ===~n~p~n~n", [Diff\\_L1\\_L2]),
&gt;&gt;&gt; io:format("=== L2 -- L1 ===~n~p~n~n", [Diff\\_L2\\_L1]),
&gt;&gt;&gt; Fetch = fun(Key) -&gt;
&gt;&gt;&gt; case riakc\\_pb\\_socket:get(PID, B, Key) of
&gt;&gt;&gt; {ok, \\_} -&gt; io:format("FOUND: ~p~n", [Key]);
&gt;&gt;&gt; {error, \\_} -&gt; io:format("NOT FOUND: ~p~n", [Key])
&gt;&gt;&gt; end
&gt;&gt;&gt; end,
&gt;&gt;&gt; io:format("=== L1 -- L2 ===~n"),
&gt;&gt;&gt; lists:foreach(Fetch, Diff\\_L1\\_L2),
&gt;&gt;&gt; io:format("=== L2 -- L1 ===~n"),
&gt;&gt;&gt; lists:foreach(Fetch, Diff\\_L2\\_L1)
&gt;&gt;&gt; end.=
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

