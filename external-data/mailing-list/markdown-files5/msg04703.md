---
title: "Re: Ideal Backend for keys that frequently get overwritten"
description: ""
project: community
lastmod: 2011-09-14T08:49:58-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04703"
mailinglist_parent_id: "msg04700"
author_name: "Jeremy Raymond"
project_section: "mailinglistitem"
sent_date: 2011-09-14T08:49:58-07:00
---


If I'm reading the docs correctly, only files smaller
than small\\_file\\_threshold will be included in a merge. So
if small\\_file\\_threshold must be bigger than max\\_file\\_size for a merge to
happen?

- Jeremy


On Wed, Sep 14, 2011 at 10:23 AM, Jeremy Raymond wrote:

&gt; Maybe I just need to tweak the Bitcask parameters to merge more often?
&gt;
&gt; I have approx 17000 keys which get overwritten once an hour. After each
&gt; updated the /var/lib/riak/bitcask folder grows by 20 MB (so about 1200 bytes
&gt; per key). With the default frag\\_merge\\_trigger at 60 I should get a merge
&gt; every 3 hours as I would have &gt; 60% of the keys being dead? This would also
&gt; meet the default frag\\_threshold of 40 since &gt; 40% of the keys are dead? I'm
&gt; not seeing the merging happening.
&gt;
&gt; - Jeremy
&gt;
&gt;
&gt;
&gt; On Wed, Sep 14, 2011 at 9:28 AM, Jeremiah Peschka &lt;
&gt; jeremiah.pesc...@gmail.com&gt; wrote:
&gt;
&gt;&gt; I would think that the InnoDB backend would be a better backend for the
&gt;&gt; use case you're describing.
&gt;&gt; ---
&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
&gt;&gt; Microsoft SQL Server MVP
&gt;&gt;
&gt;&gt; On Sep 14, 2011, at 8:09 AM, Jeremy Raymond wrote:
&gt;&gt;
&gt;&gt; &gt; Hi,
&gt;&gt; &gt;
&gt;&gt; &gt; I store data in Riak whose keys constantly get overwritten with new
&gt;&gt; data. I'm currently using Bitcask as the back-end and recently noticed the
&gt;&gt; Bitcask data folder grow to 24GB. After restarting the nodes, which I think
&gt;&gt; triggered Bitcask merge, the data went down to 96MB. Today the data dirs are
&gt;&gt; back up to around 500MB. Would an alternate backend better suit this type of
&gt;&gt; use case where keys are constantly being overwritten?
&gt;&gt; &gt;
&gt;&gt; &gt; - Jeremy
&gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

