---
title: "Re: Pagination with Ripple"
description: ""
project: community
lastmod: 2012-07-19T09:07:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07998"
mailinglist_parent_id: "msg07997"
author_name: "Catherine Jung"
project_section: "mailinglistitem"
sent_date: 2012-07-19T09:07:22-07:00
---


We're pairing Redis and Riak too - Riak for the 'proper' persistence, and
Redis for a cache of what's in use right now - Redis has all sorts of handy
bits which play really nicely for this purpose.

Catherine

On Thu, Jul 19, 2012 at 4:59 PM, Alexander Sicular wrote:

&gt; I have always paired Riak with Redis for exactly this issue. Redis
&gt; provides the data structures that Riak lacks. Pagination schemes via Redis
&gt; are fairly trivial. To obviate the SPOF issue you should replicate Redis
&gt; but what I do in addition is persist Redis keys to Riak on some frequency.
&gt; Of course, YMMV based on your own specific needs.
&gt;
&gt; -Alexander Sicular
&gt;
&gt; @siculars
&gt;
&gt; On Jul 19, 2012, at 10:33 AM, Alex Thompson wrote:
&gt;
&gt; &gt; I agree, but sometimes you make sacrifices. ;)
&gt; &gt;
&gt; &gt; Alternatively, you could use something like redis or memcache to hold
&gt; keylists, either populated dynamically with key lists, or loaded with data
&gt; on startup. You might even be able to get away with just some reasonably
&gt; complex send-current-and-refresh style page caching and a script to warm
&gt; your caches from a cold start.
&gt; &gt;
&gt; &gt; Riak is a wonderful, scalable database, but unless you're holding lots
&gt; data in ram \\_somewhere\\_, your service is never really going to run at
&gt; interactive speeds. This is true of all data systems, not just riak,
&gt; consider highly random access to a traditional RDBMS with data &gt; ram and no
&gt; indexes.
&gt; &gt;
&gt; &gt; - Alex
&gt; &gt;
&gt; &gt; ----- Original Message -----
&gt; &gt; From: "Martin Stabenfeldt" 
&gt; &gt; To: riak-users@lists.basho.com
&gt; &gt; Sent: Thursday, July 19, 2012 3:15:25 AM
&gt; &gt; Subject: Re: Pagination with Ripple
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt;
&gt; &gt; We´re also in the hundreds of thousands scale. So loading everything is
&gt; unfortunately not possible.
&gt; &gt; Would be nice if one could settle for one database, instead of mixing
&gt; different types. Nice to only care about scaling and providing redundancy
&gt; for Riak, instead of Riak and PostgreSQL :-)
&gt; &gt;
&gt; &gt;
&gt; &gt; If anyone has implemented pagination using Ripple or other solutions
&gt; with Ruby, I´d love to see it!
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Cheers,
&gt; &gt;
&gt; &gt;
&gt; &gt; Martin Stabenfeldt
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; On Wednesday, 18 July 2012 at 16:24, Alex Thompson wrote:
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; My 2c:
&gt; &gt;
&gt; &gt;
&gt; &gt; 1000s of subscribers per list isn't a problem. Just have a data object
&gt; which represents the subscriber list, store a list of subscriber ids in the
&gt; subscriber list object. Load the whole list every time, and sort/paginate
&gt; in your app code.
&gt; &gt;
&gt; &gt;
&gt; &gt; Unless you're planning on shuffling the lists a lot, that will be the
&gt; most direct way to implement it.
&gt; &gt;
&gt; &gt;
&gt; &gt; Caveats:
&gt; &gt; Unless you're planning on running into the object size limit with
&gt; subscriber ids or planning on being able to handle thousands of
&gt; simultaneous subscriptions to the same list, but don't want to handle
&gt; conflict resolution.
&gt; &gt;
&gt; &gt;
&gt; &gt; My solution:
&gt; &gt; I ran into this same problem with my app, but with hundreds of thousands
&gt; to millions of uuids per list. I tried a couple of Riak based solutions
&gt; with different data formats, but I wasn't really satisfied with any of
&gt; them. I ended up just having a uuid to uuid lookup table in a postgres
&gt; database to handle internal item to item relations using the uuid datatype
&gt; for efficient indexing.
&gt; &gt;
&gt; &gt;
&gt; &gt; I'm not sure if there are any good support libraries for handling
&gt; polyglot consistency in ruby, or if you could blend database ActiveRecord
&gt; and ripple models in the same app (I mean, you probably can, right? You'd
&gt; just have objects inherit from different base classes? There are probably
&gt; some unhandled relation-chaining edge cases though... although ActiveRecord
&gt; can be magic sometimes.)
&gt; &gt;
&gt; &gt;
&gt; &gt; - Alex
&gt; &gt;
&gt; &gt;
&gt; &gt; ----- Original Message -----
&gt; &gt; From: "Martin Stabenfeldt" &lt; mar...@stabenfeldt.net &gt;
&gt; &gt; To: riak-users@lists.basho.com
&gt; &gt; Sent: Wednesday, July 18, 2012 2:54:35 AM
&gt; &gt; Subject: Pagination with Ripple
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Dear List,
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; I´m planning to use Riak as my primary DB for my Rails app.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; The first issue I´ve encountered is pagination.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; I got a SubscriberList which may contain 1000´s of Subscribers. Any
&gt; suggestion on how I can implement pagination? My plan was to use
&gt; will\\_paginate .
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; class Subscriber
&gt; &gt; include Ripple :: Document
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; # Belongs to a SubscriberList
&gt; &gt; one :subscriber\\_list
&gt; &gt; property :subscriber\\_list\\_key , String
&gt; &gt; property :email , String
&gt; &gt; property :referer , String
&gt; &gt; timestamps!
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; validates\\_presence\\_of :email
&gt; &gt; end
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; class SubscriberList
&gt; &gt; include Ripple :: Document
&gt; &gt; one :user
&gt; &gt; property :user\\_key , String
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; # Has\\_many Subscribers
&gt; &gt; many :subscribers , :using =&gt; :reference
&gt; &gt; # Used by User to find which SubscriberList he has
&gt; &gt; property :subscriber\\_key , String
&gt; &gt; property :title , String
&gt; &gt; property :deleted , Boolean
&gt; &gt; timestamps!
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; validates\\_presence\\_of :user
&gt; &gt; end
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Martin Stabenfeldt
&gt; &gt; Tlf: +47 93441707
&gt; &gt;
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

