---
title: "Re: multi datacenter replication"
description: ""
project: community
lastmod: 2013-05-15T12:17:23-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11079"
mailinglist_parent_id: "msg11064"
author_name: "Adron Hall"
project_section: "mailinglistitem"
sent_date: 2013-05-15T12:17:23-07:00
---


Currently, as the replication exists today I don't believe the replication
service would do exactly that. (anyone else on list, plz correct me if I'm
wrong here). However in the coming months we have that capability in the
road map.

However I'm just a little hesitant to suggest committing an entire Riak
Cluster at each remote point solely for replication. There's also the
licensing that comes into play with the multi-data center replication also.
Ideally we'd have PS (Professional Services) or your team work together to
build clients to connect to a main Riak Cluster.

Being that each cluster should have a minimal of 5 nodes, having a cluster
of 5 nodes at each remote point would seem like overkill - however it would
replicate, it would just be that a lot of nodes & a lot of clusters is a
lot for the volume of data. A client could be dramatically more
minimalistic, it wouldn't require 5 nodes for each remote cluster, and
could prospectively be dramatically cheaper & more efficient in the end.

I'll loop you in with some others that could elaborate on this architecture
and see which direction to aim for.

Cheers,
-Adron


On Mon, May 13, 2013 at 5:20 PM, Patrick Christopher &lt;
pat.christop...@gmail.com&gt; wrote:

&gt; Hi Adron,
&gt; Thanks for the reply!
&gt;
&gt; The architectural thought that you pose is the idea I'm going for but
&gt; having riak do all of the replication, not a new client. The model would
&gt; be:
&gt; - single riak cluster
&gt; - bucket a replicates to data center remoteA
&gt; - bucket b replicates to data center remoteB
&gt; - remoteB will never access data from a
&gt; - remoteA will never access data from b
&gt;
&gt; Does riak support that? I've not seen any database that supports that
&gt; model on its own.
&gt;
&gt; Pat
&gt;
&gt;
&gt; On Mon, May 13, 2013 at 12:42 PM, Adron Hall  wrote:
&gt;
&gt;&gt; Hey Pat,
&gt;&gt;
&gt;&gt; A few answers, thoughts and questions.
&gt;&gt;
&gt;&gt; 1. Each bucket allows (if after v1.1/1.2) replication. In 1.1 and above
&gt;&gt; there is a repl value that accepts a true or false value. True turns on
&gt;&gt; realtime and fullsync abilities. In 1.2 above has additional boolean
&gt;&gt; parameters of realtime, fullsync, or both. Enabling the property via
&gt;&gt; command line:
&gt;&gt;
&gt;&gt; curl -v -XPUT -H "Content-Type: application/json" \\
&gt;&gt; -d '{"props":{"repl":true}}' \\
&gt;&gt; http://127.0.0.1:8091/riak/my\\_bucket
&gt;&gt;
&gt;&gt; 2. Running both styles of replication should be fine. They're on by
&gt;&gt; default to start. In the particular situation you describe - using realtime
&gt;&gt; on all the time should work well and then only using the fullsync when the
&gt;&gt; ship docks and connects at a higher speed - using something to trigger that.
&gt;&gt;
&gt;&gt; A few additional questions:
&gt;&gt;
&gt;&gt; - I recall we spoke about data sizes of 3-5k per ship, but then there
&gt;&gt; was all of the data that would go along with each client, could you 
&gt;&gt; provide
&gt;&gt; more elaboration around what count, sizes, connections to other elements
&gt;&gt; and related information data? Why type/pieces would need to go to each
&gt;&gt; ship, etc.
&gt;&gt; - For the connections to each ship during satellite link what does
&gt;&gt; the bandwidth, latency and other characteristics look like? Latency times
&gt;&gt; of 800, 1500, 6000 or possibly higher 8000, 10000?
&gt;&gt;
&gt;&gt; Another Architectural Thought:
&gt;&gt;
&gt;&gt; - One idea that stands out would be to use Riak as the primary
&gt;&gt; cluster but to implement a client that does replication itself 
&gt;&gt; specifically
&gt;&gt; for a bucket (or buckets). It seems like, from my understanding so far,
&gt;&gt; that the client might be the key mechanism to control any type of
&gt;&gt; replication - with or without MDC being used. Basically following a
&gt;&gt; standard hub-and-spoke server & client model.
&gt;&gt;
&gt;&gt; Hope that helps, cheers!
&gt;&gt;
&gt;&gt; -Adron
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On Fri, May 10, 2013 at 9:45 AM, Patrick Christopher &lt;
&gt;&gt; pat.christop...@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Hi,
&gt;&gt;&gt; Iâ€™m working on an application that will be spread across many (150-200)
&gt;&gt;&gt; data centers. I had a great chat with Adron at the Seattle Riak Office
&gt;&gt;&gt; Hours and I think that Riak can provide the backbone of the solution.
&gt;&gt;&gt; Adron is a great help but I have come away with (or have come up with) two
&gt;&gt;&gt; more questions.
&gt;&gt;&gt;
&gt;&gt;&gt; 1. Does riak support specifying bucket level multi data center
&gt;&gt;&gt; replication? There is a single master data center that has all of the data,
&gt;&gt;&gt; and that central cluster replicates a single different bucket to each of
&gt;&gt;&gt; the remote data centers. Its a hub/spoke model where something at the hub
&gt;&gt;&gt; has a view of the full data set and something at a spoke end only has a
&gt;&gt;&gt; view of a single, unique bucket.
&gt;&gt;&gt;
&gt;&gt;&gt; 2. What would be the best way to setup a priority replication
&gt;&gt;&gt; strategy? There is always a link between the main dc and the spoke
&gt;&gt;&gt; dcs, but sometimes its a big fast link and we'd want to do a full
&gt;&gt;&gt; replication and sometimes its the equivalent of a 56k modem and we only
&gt;&gt;&gt; want to replicate time critical data. I think riak can handle this by
&gt;&gt;&gt; using the real-time sync for critical data and the full-sync for a full
&gt;&gt;&gt; sync. Will that work or is that asking for trouble running both styles?
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; And there was a small note in the 
&gt;&gt;&gt; docs
&gt;&gt;&gt; that
&gt;&gt;&gt; says, " ...there are two primary modes of operation..." are there
&gt;&gt;&gt; other, secondary modes of replication or is this me over-parsing the docs?
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Thank you,
&gt;&gt;&gt;
&gt;&gt;&gt; Pat
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; \\*Adron B Hall\\*
&gt;&gt; Blog , Adron.Me , 
&gt;&gt; @adron
&gt;&gt; with Basho  @Basho 
&gt;&gt;
&gt;
&gt;


-- 
\\*Adron B Hall\\*
Blog , Adron.Me ,
@adron
with Basho  @Basho 
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

