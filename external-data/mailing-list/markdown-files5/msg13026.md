---
title: "Re: Hard time with Riak 2.0.0pre5 features"
description: ""
project: community
lastmod: 2013-11-19T15:08:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13026"
mailinglist_parent_id: "msg13023"
author_name: "Valter Balegas"
project_section: "mailinglistitem"
sent_date: 2013-11-19T15:08:06-08:00
---


I can’t create the bucket type:

RPC to 'riak@127.0.0.1' failed: {'EXIT',
 {badarg,
 [{erlang,list\\_to\\_existing\\_atom,
 ["consistent"],
 []},
 {riak\\_kv\\_wm\\_utils,erlify\\_bucket\\_prop,1,
 [{file,"src/riak\\_kv\\_wm\\_utils.erl"},
 {line,393}]},
 {riak\\_kv\\_console,
 '-bucket\\_type\\_create/2-lc$^0/1-0-',1,
 [{file,"src/riak\\_kv\\_console.erl"},
 {line,483}]},
 {riak\\_kv\\_console,bucket\\_type\\_create,2,
 [{file,"src/riak\\_kv\\_console.erl"},
 {line,483}]},
 {rpc,'-handle\\_call\\_call/6-fun-0-',5,
 [{file,"rpc.erl"},{line,203}]}]}}

I activated the consensus in riak.conf in the etc dir (find command seems not 
to find the pattern anywhere else).
Is there any other way to create the bucket?

Valter

No dia 19/11/2013, às 18:10, Jordan West  escreveu:

&gt; On Tue, Nov 19, 2013 at 7:33 AM, Valter Balegas  wrote:
&gt; 
&gt; Strong consistency:
&gt; How does one activate this? As i understand, either the pb or the http 
&gt; clients do not accept the consistent property.
&gt; 
&gt; 
&gt; Using strong consistency in the Tech Preview is a two-step process. First, 
&gt; turn on the feature in your riak.conf (the following command assumes you are 
&gt; using a devrel):
&gt; 
&gt; for d in dev/dev\\*; do sed -e 's/## enable\\_consensus = true/enable\\_consensus = 
&gt; true/' -i $d/etc/riak.conf; done
&gt; 
&gt; Then re(start) the cluster.
&gt; 
&gt; With the enable\\_consensus=true un-commented and the cluster running create a 
&gt; strongly consistent bucket type:
&gt; 
&gt; riak-admin bucket-type create  '{"props": {"consistent": true}}'
&gt; riak-admin bucket-type activate 
&gt; 
&gt; You can create and activate the bucket type without having 
&gt; enabled\\_consensus=true but both must be done to work with strongly 
&gt; consistent data.
&gt; 
&gt; Once that is done you can make requests, just like you would to eventually 
&gt; consistent data in Riak, but the semantics will be different. For example, if 
&gt; you make two PUT requests to the same key, w/ no vector clock\\*, the second 
&gt; request will fail because the data already exists. More details on semantics 
&gt; of strongly consistent requests can be found in this PR: 
&gt; https://github.com/basho/riak\\_kv/pull/710
&gt; 
&gt; Hope that helps get you started,
&gt; 
&gt; Jordan
&gt; 
&gt; \\* in strong consistency, the "vector clock" is not really a vector clock. its 
&gt; called such for familiarity, but like any real vector clock exposed to the 
&gt; client, should be treated like an opaque context.
&gt; 
&gt; Details about my environment:
&gt; -I’m running Mac OSX 10.9
&gt; -Erlang R15B01
&gt; -Compiling riak “develop” branch, from basho github
&gt; -Compiling riak-erlang-client “master” branch, from basho github.
&gt; -recompiled the latest versions of the branches just before writing this 
&gt; email.
&gt; 
&gt; 
&gt; Thank you for your help,
&gt; Valter
&gt; 
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

