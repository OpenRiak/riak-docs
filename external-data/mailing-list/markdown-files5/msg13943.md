---
title: "Re: Lowlevel Access to RiakCS objects?"
description: ""
project: community
lastmod: 2014-03-28T05:51:03-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13943"
mailinglist_parent_id: "msg13940"
author_name: "Tom Santero"
project_section: "mailinglistitem"
sent_date: 2014-03-28T05:51:03-07:00
---


Hi Martin,

The short answer is no, Riak CS does not expose lower level access to the
blocks that are replicated to Riak.

That said, I'm curious, is anything preventing you from segmenting your
videos and writing a playlist + the segements to Riak CS? This would allow
you to seed varnish, while at the same time reducing the cost of a cache
miss to something reasonable for users.

Regards,
Tom

On Thu, Mar 27, 2014 at 3:05 PM, Martin Alpers  wrote:

&gt; Hi all,
&gt;
&gt; is there a canonical way to access RiakCS objects on a lower level? If I
&gt; remember correctly, RiakCS basically distributes larger objects into chunks
&gt; of one megabye each, and mapreduces them together on retrieval.
&gt; I would like to read those chunks for caching purposes.
&gt;
&gt; For those interested in why I would wnat that:
&gt; A Riak/RiakCS cluster is the heart of our yet-to-be-implemented video
&gt; delivery cluster. A video management system will enable registered user to
&gt; upload their videos and the public can watch them.
&gt; In order to reduce intra-cluster traffic, we intent to cache the videos,
&gt; preferably in RAM.
&gt; We do not have any numbers on how often users would skip parts of the
&gt; video and generate range requests. If that case is really common, we would
&gt; prefer to serve them from cache as well, at least with Varnish and Squid,
&gt; some users would experience unacceptably long delays.
&gt; We looked out for a cache that could pipe through any request on an URL on
&gt; which caching is in progress and serve from cache afterwards.
&gt;
&gt; The problem with both Varnish and Squid (and I suppose most caches,
&gt; because this behaviour seems reasonable in most cases) boils down to
&gt; treating a caching in progress as a cache hit.
&gt; My colleague started to write his own caching proxy in NodeJS, but using
&gt; asynchronous callbacks to check if a file exists, and to create it if it
&gt; does not, strikes me as somewhat couragous for production.
&gt;
&gt; Now while we cannot risk to let some users wait for hundreds of megabytes
&gt; to be cached before delivery begins, and while we want at least to be
&gt; prepared to face many more range requests than the average "wget was
&gt; interrupted" case, it occurred to me thata few megabytes are not an issue
&gt; at multi-fast-ethernet speed.
&gt; So if we can split our files into objects small enough, we could code a
&gt; proxy that translates a range request into one or more normal requests for
&gt; those chunks, cuts off a certain offset of the first chunk if the range of
&gt; the orignal request began somewhere off the boundary, and reconcatenates
&gt; those chunks in correct order for delivery.
&gt; So the cache would never have to be bypassed, and the whole headache of
&gt; telling a complete hit from one "in progress" would be gone.
&gt;
&gt; Since RiakCS has already split our files into small pieces, and somehow
&gt; tracks them, so could we possibly piggyback on that?
&gt;
&gt; And by the way, I just came across the memory backend. I assume it is
&gt; distributed like the persistent ones, so it will not help me redice
&gt; internal traffic, right?
&gt;
&gt; Any input is highly appreciated.
&gt;
&gt; Best Regards
&gt; Martin
&gt;
&gt; --
&gt; Greetings, Martin Alpers
&gt;
&gt; martin-alp...@web.de; Public Key ID: 10216CFB
&gt; Tel: +49 431/90885691; Mobile: +49 176/66185173
&gt; JID: martin.alp...@jabber.org
&gt; FYI: http://apps.opendatacity.de/stasi-vs-nsa/
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

