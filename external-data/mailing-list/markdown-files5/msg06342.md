---
title: "Connection Pooling with the python-riak-client"
description: ""
project: community
lastmod: 2012-01-20T12:54:07-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06342"
author_name: "Michael Clemmons"
project_section: "mailinglistitem"
sent_date: 2012-01-20T12:54:07-08:00
---


Hey All,
FIrst time on the list, so go easy. I've been working with the
python-riak-client for a while and one of the biggest blockers has been its
lack of connection pooling. Until recently the fork maintained at
https://github.com/bretthoerner/riak-python-client has been sufficient for
my needs. I'd been merging it in with the master branch privately up until
December.
I've decided to go back and cleanup that approach and reapply it to the
current master branch. To my surprise I found that the ConnectionManager
supports multiple connections and has the tools to add and remove them.
Looking at the simple case of the RiakHttpTransport layer and the
http\\_request method it looks like it should grab a new connection(or an old
one) and try it and if it fails move on to the next putting the host port
pair at the bottom of the list.
So it looked like all I needed to do was update the client code to accept a
list of hostport pairs and it would just work, which sounded too easy to be
true. I tested it anyways and if I use one hostport that is a working riak
node it connects and everything works. If I include 2 nodes one working
and one a random port it fails no matter the order. So its not just trying
to connect to the first and failing its connecting to them all and failing
if any fail.
Anyone have any idea of why its built this way and what other solutions
people have worked out on their own? My intent is to do this so it merges
cleanly with the current master, and doesn't introduce unnecessary change,
to increase the likelyhood of a successful pull request.
-Michael
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

