---
title: "Re: occasional timeout when deleting key on multi-node Riak 1.4"
description: ""
project: community
lastmod: 2014-10-02T09:22:46-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14974"
mailinglist_parent_id: "msg14973"
author_name: "Dmitri Zagidulin"
project_section: "mailinglistitem"
sent_date: 2014-10-02T09:22:46-07:00
---


Thanks. Are there entries in any of the other logs? (like the crash dump).

Can you also provide more info on the nodes themselves. What size AWS
instances are you running? Is the delete timeout happening while load
testing?

On Thu, Oct 2, 2014 at 12:11 PM, Igor Senderovich &lt;
isenderov...@esperdyne.com&gt; wrote:

&gt; Thanks for your help, Dmitri,
&gt;
&gt; I get the following in error.log:
&gt; 2014-10-02 12:05:45.037 [error] &lt;0.6359.19&gt; Webmachine error at path
&gt; "/buckets/imc/keys/5134a18660494ea5553d2c90ef9eea2f" : "Service Unavailable"
&gt;
&gt; And no, there is no load balancer on our cluster.
&gt; Thank you
&gt;
&gt;
&gt; On Thu, Oct 2, 2014 at 11:52 AM, Dmitri Zagidulin 
&gt; wrote:
&gt;
&gt;&gt; One other question - are you using a load balancer for your cluster (like
&gt;&gt; HAProxy or the like). In which case, take a look at its logs, also.
&gt;&gt;
&gt;&gt; On Thu, Oct 2, 2014 at 11:51 AM, Dmitri Zagidulin 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Igor,
&gt;&gt;&gt; Can you look in the riak log directory, in the error.log (and console
&gt;&gt;&gt; log and crash dump file) to see if there's any entries, around the time of
&gt;&gt;&gt; the delete operation? And post them here?
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Thu, Oct 2, 2014 at 11:45 AM, Igor Senderovich &lt;
&gt;&gt;&gt; isenderov...@esperdyne.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I get a timeout when deleting a key, reproducible in about 1 in 10
&gt;&gt;&gt;&gt; times:
&gt;&gt;&gt;&gt; $ curl -i -vvv
&gt;&gt;&gt;&gt; http://myhost:8098/buckets/imc/keys/5134a18660494ea5553d2c90ef9eea2f
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \\* About to connect() to dp1.prod6.ec2.cmg.net port 8098
&gt;&gt;&gt;&gt; \\* Trying 10.12.239.90... connected
&gt;&gt;&gt;&gt; \\* Connected to dp1.prod6.ec2.cmg.net (10.12.239.90) port 8098
&gt;&gt;&gt;&gt; &gt; DELETE /buckets/imc/keys/5134a18660494ea5553d2c90ef9eea2f HTTP/1.1
&gt;&gt;&gt;&gt; &gt; User-Agent: curl/7.15.5 (x86\\_64-redhat-linux-gnu) libcurl/7.15.5
&gt;&gt;&gt;&gt; OpenSSL/0.9.8b zlib/1.2.3 libidn/0.6.5
&gt;&gt;&gt;&gt; &gt; Host: dp1.prod6.ec2.cmg.net:8098
&gt;&gt;&gt;&gt; &gt; Accept: \\*/\\*
&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt; &lt; HTTP/1.1 503 Service Unavailable
&gt;&gt;&gt;&gt; HTTP/1.1 503 Service Unavailable
&gt;&gt;&gt;&gt; &lt; Server: MochiWeb/1.1 WebMachine/1.10.0 (never breaks eye contact)
&gt;&gt;&gt;&gt; Server: MochiWeb/1.1 WebMachine/1.10.0 (never breaks eye contact)
&gt;&gt;&gt;&gt; &lt; Date: Wed, 01 Oct 2014 16:11:41 GMT
&gt;&gt;&gt;&gt; Date: Wed, 01 Oct 2014 16:11:41 GMT
&gt;&gt;&gt;&gt; &lt; Content-Type: text/plain
&gt;&gt;&gt;&gt; Content-Type: text/plain
&gt;&gt;&gt;&gt; &lt; Content-Length: 18
&gt;&gt;&gt;&gt; Content-Length: 18
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; request timed out
&gt;&gt;&gt;&gt; \\* Connection #0 to host dp1.prod6.ec2.cmg.net left intact
&gt;&gt;&gt;&gt; \\* Closing connection #0
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This is on Riak 1.4 on a 5 node cluster with an n-value of 3.
&gt;&gt;&gt;&gt; Thank you for your help
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

