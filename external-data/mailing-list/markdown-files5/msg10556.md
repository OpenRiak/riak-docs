---
title: "Re: Need help with moving to Riak"
description: ""
project: community
lastmod: 2013-03-22T01:12:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10556"
mailinglist_parent_id: "msg10551"
author_name: "Daniil Churikov"
project_section: "mailinglistitem"
sent_date: 2013-03-22T01:12:13-07:00
---


One possible scheme:

To optimize reads, I advice such scheme:
Bucket &lt;&lt;"clients"&gt;&gt;, by client\\_id you store client info and all his users
in one object.
Bucket &lt;&lt;"servers"&gt;&gt;, by client\\_id you store all his servers in one object.

Move user statistics into separate object:
Bucket &lt;&lt;"usage\\_stats"&gt;&gt;, by client\\_id you store something like this:
[{user\\_id(), stat()}]
But note, as there will be a lot of simultaneously updates, thereof there
will be a lot of conflicts. Consider to write code which solves it or
possibly use something like statebox for this.

So to execute "give me all sub-users of this client" you will have to make 2
queries: to &lt;&lt;"clients"&gt;&gt; bucket and to &lt;&lt;"usage\\_stats"&gt;&gt; bucket.
"give me all servers of this client" will require one query.



--
View this message in context: 
http://riak-users.197444.n3.nabble.com/Need-help-with-moving-to-Riak-tp4027331p4027336.html
Sent from the Riak Users mailing list archive at Nabble.com.

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

