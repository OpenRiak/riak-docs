---
title: "Re: How to update existed schema"
description: ""
project: community
lastmod: 2014-11-27T09:25:18-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15266"
mailinglist_parent_id: "msg15260"
author_name: "Yang Zhenguo"
project_section: "mailinglistitem"
sent_date: 2014-11-27T09:25:18-08:00
---


Since I am still in progress of developing, I want to re-install riak to
resolve it.

However, when I run the following commands, another problem comes up:
1. sudo apt-get remove riak
2. sudo dpkg -i riak\\_2.0.0rc1-1\\_amd64.deb

The old bucket-type and buckets are not clear, it is not an empty riak what
I want

Thanks in advance

Thanks & Regards,
Zhenguo

2014-11-27 23:26 GMT+08:00 Yang Zhenguo :

&gt; Yes, I did replace
&gt;
&gt; 2014-11-27 11:45 GMT+08:00 Geoff Garbers :
&gt;
&gt;&gt; Hi Zhenghuo.
&gt;&gt;
&gt;&gt; Did you replace "index\\_name" with actual name of your index? If not,
&gt;&gt; that's probably the issue.
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt; Geoff
&gt;&gt;
&gt;&gt;
&gt;&gt; Yang Zhenguo  wrote:
&gt;&gt;
&gt;&gt; Hi Geoff,
&gt;&gt;
&gt;&gt; When I run rp(yz\\_index:reload(&lt;&lt;"index\\_name"&gt;&gt;)).
&gt;&gt;
&gt;&gt; The result is "exception error: undefined function yz\\_index:reload/1"
&gt;&gt;
&gt;&gt; Not very clear how to reload the index, I tried to restart riak, still
&gt;&gt; doesn't work.
&gt;&gt;
&gt;&gt; Thanks & Regards,
&gt;&gt; Zhenguo
&gt;&gt;
&gt;&gt;
&gt;&gt; 2014-11-26 1:31 GMT+08:00 Geoff Garbers :
&gt;&gt;
&gt;&gt;&gt; Hey Zhenguo.
&gt;&gt;&gt;
&gt;&gt;&gt; I've actually just gone through something similar myself recently.
&gt;&gt;&gt; ​ ​
&gt;&gt;&gt; I found that the most reliable way to do this is as follows:
&gt;&gt;&gt;
&gt;&gt;&gt; 1. Update the schema (as you have shown)
&gt;&gt;&gt; 2. Attach to the Erlang console on each node, and run
&gt;&gt;&gt; rp(yz\\_index:reload(&lt;&lt;"index\\_name"&gt;&gt;)).
&gt;&gt;&gt; ​3. List all keys in the buckets with your bucket type, and pull and put
&gt;&gt;&gt; each of the objects in those buckets.
&gt;&gt;&gt;
&gt;&gt;&gt; It's not the most ideal way, but it's the most effective (from what I've
&gt;&gt;&gt; found) until the new sear​ch administration functionality becomes available.
&gt;&gt;&gt;
&gt;&gt;&gt; Regards,
&gt;&gt;&gt; Geoff
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Geoffrey Garbers
&gt;&gt;&gt; Senior Developer
&gt;&gt;&gt;
&gt;&gt;&gt; [image: Total Send] 
&gt;&gt;&gt;
&gt;&gt;&gt; Cell: +27 (0)766 476 920
&gt;&gt;&gt; Skype: geoff.garbers
&gt;&gt;&gt; ge...@totalsend.com
&gt;&gt;&gt; www.totalsend.com
&gt;&gt;&gt;
&gt;&gt;&gt; +1 347-431-0494 
&gt;&gt;&gt; +44 (0)203 519 1082 
&gt;&gt;&gt; +61 (0)3 9111 5760 
&gt;&gt;&gt; +27 (0)21 200 6981 
&gt;&gt;&gt;
&gt;&gt;&gt; On Tue, Nov 25, 2014 at 6:46 PM, Yang Zhenguo 
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Any other options? :)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2014-11-26 0:42 GMT+08:00 Eric Redmond :
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Yes, that is one of the options.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Eric
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On Nov 25, 2014, at 8:40 AM, Yang Zhenguo 
&gt;&gt;&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hi Eric,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Any suggestion for my requirement? create a new search index?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Regards,
&gt;&gt;&gt;&gt;&gt; Zhenguo
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; 2014-11-26 0:24 GMT+08:00 Eric Redmond :
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Automatic updating of indexes due to schema changes doesn't exist
&gt;&gt;&gt;&gt;&gt;&gt; yet. It'll be added soon:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; https://github.com/basho/yokozuna/pull/427
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Eric
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On Nov 25, 2014, at 8:21 AM, Yang Zhenguo 
&gt;&gt;&gt;&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; I have an existed schema and I want to add one column in it, such as
&gt;&gt;&gt;&gt;&gt;&gt; &gt;&gt;&gt;&gt;&gt; stored="true" /&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; What's the steps to update it?
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Since there is the search\\_index related to the schema and a bucket
&gt;&gt;&gt;&gt;&gt;&gt; type related to the search\\_index.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; I tried to update the schema by the following commands:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; {ok, SchemaData} = file:read\\_file("cartoons.xml"),
&gt;&gt;&gt;&gt;&gt;&gt; riakc\\_pb\\_socket:create\\_search\\_schema(Pid, &lt;&lt;"cartoons"&gt;&gt;, SchemaData).
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; However, I can not search the object with new field.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Thanks in advance.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Regards,
&gt;&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt;&gt; Zhenguo Yang
&gt;&gt;&gt;&gt;&gt;&gt; www.prinbit.com
&gt;&gt;&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt; Zhenguo Yang
&gt;&gt;&gt;&gt;&gt; MSN: zgyang...@hotmail.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt; Zhenguo Yang
&gt;&gt;&gt;&gt; MSN: zgyang...@hotmail.com
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Zhenguo Yang
&gt;&gt; MSN: zgyang...@hotmail.com
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Zhenguo Yang
&gt; MSN: zgyang...@hotmail.com
&gt;



-- 
Zhenguo Yang
MSN: zgyang...@hotmail.com
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

