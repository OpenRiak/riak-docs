---
title: "Re: leveldb issues."
description: ""
project: community
lastmod: 2014-06-19T11:19:41-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14334"
mailinglist_parent_id: "msg14333"
author_name: "Matthew Von-Maszewski"
project_section: "mailinglistitem"
sent_date: 2014-06-19T11:19:41-07:00
---


Yes.

On Jun 19, 2014, at 1:47 PM, Theo Schlossnagle  wrote:

&gt; To be clear, you're considering a13160da8adeca96d80388cc77cb88ad5301aeaa the 
&gt; latest?
&gt; 
&gt; 
&gt; On Thu, Jun 19, 2014 at 12:36 PM, Matthew Von-Maszewski  
&gt; wrote:
&gt; Running repair now may have detected damage done to your data long ago. 
&gt; Repair reads every file and tests the CRC on every block in the file.
&gt; 
&gt; Two known issues might have caused the original corruption:
&gt; 
&gt; https://github.com/basho/leveldb/wiki/mv-verify-compactions 
&gt; 
&gt; or 
&gt; 
&gt; https://github.com/basho/leveldb/wiki/mv-async-close
&gt; 
&gt; 
&gt; Also, there is a bug in the 532bb commit that can cause level-0 files to be 
&gt; wrongly deleted. I suggest pulling the latest to get rid of that bug.
&gt; 
&gt; Matthew
&gt; 
&gt; 
&gt; On Jun 19, 2014, at 12:24 PM, Theo Schlossnagle  wrote:
&gt; 
&gt;&gt; I'm using basho/leveldb as of commit: 
&gt;&gt; 532bb6351e7835e862c8508520780bfc9d0c2b78 (no snappy)
&gt;&gt; 
&gt;&gt; I have an issue with some small sized database... they claim corruption, but 
&gt;&gt; when running a repair I have a nonsensical amount of sst's moved into "lost"
&gt;&gt; 
&gt;&gt; Worse, the files moved to "lost" have very very old creation times (in 
&gt;&gt; months). The system has been restarted successfully many times in the 
&gt;&gt; interim, leading to more confusion.
&gt;&gt; 
&gt;&gt; I'm looking for pointers to get to the bottom of this. It isn't critical 
&gt;&gt; thatI recover this data, but it is critical that I don't see this manifest 
&gt;&gt; when it does matter.
&gt;&gt; 
&gt;&gt; Before repair:
&gt;&gt; 
&gt;&gt; 40960 108441.log
&gt;&gt; 1 CURRENT
&gt;&gt; 0 LOCK
&gt;&gt; 3 LOG
&gt;&gt; 3 LOG.old
&gt;&gt; 92 MANIFEST-108439
&gt;&gt; 469 sst\\_0
&gt;&gt; 1 sst\\_1
&gt;&gt; 188185 sst\\_2
&gt;&gt; 4189331 sst\\_3
&gt;&gt; 6343660 sst\\_4
&gt;&gt; 1 sst\\_5
&gt;&gt; 1 sst\\_6
&gt;&gt; 
&gt;&gt; After repair:
&gt;&gt; 
&gt;&gt; 40960 108452.log
&gt;&gt; 1 CURRENT
&gt;&gt; 0 LOCK
&gt;&gt; 3 LOG
&gt;&gt; 3 LOG.old
&gt;&gt; 28 MANIFEST-108450
&gt;&gt; 8221971 lost
&gt;&gt; 2362 sst\\_0
&gt;&gt; 1 sst\\_1
&gt;&gt; 188185 sst\\_2
&gt;&gt; 2352071 sst\\_3
&gt;&gt; 1 sst\\_4
&gt;&gt; 1 sst\\_5
&gt;&gt; 1 sst\\_6
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -- 
&gt;&gt; Theo Schlossnagle
&gt;&gt; 
&gt;&gt; http://omniti.com/is/theo-schlossnagle
&gt;&gt; 
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Theo Schlossnagle
&gt; 
&gt; http://omniti.com/is/theo-schlossnagle
&gt; 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

