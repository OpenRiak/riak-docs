---
title: "Re: Newbie question 3/3"
description: ""
project: community
lastmod: 2012-01-09T14:54:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06190"
mailinglist_parent_id: "msg06173"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2012-01-09T14:54:11-08:00
---


John,

As you already seem to understand, Riak doesn't provide a way to make
multiple ops atomic. Part of the reason is because Riak's main focus thus
far has been availability. Distributed transactions would work, but at the
cost of availability. I think a flaw with the redo log approach is that
you need to serialize all operations to A & B through \\_one\\_ client to keep
from reading an inconsistent state.

A much simpler option, if you can bend your data, is to combine A and B
into one object.

-Ryan

On Mon, Jan 9, 2012 at 12:33 AM, John DeTreville wrote:

&gt; (An earlier post seems not to have gone through. My apologies in the
&gt; eventual case of a duplicate.)
&gt;
&gt; I'm thinking of using Riak to replace a large Oracle system, and I'm
&gt; trying to understand its guarantees. I have a few introductory questions;
&gt; this is the third of three.
&gt;
&gt; I would like to do two updates atomically, but of course I cannot. I
&gt; imagine I could construct my own redo log, and perform a sequence of
&gt; operations something like:
&gt;
&gt; write redo log entry (timestamp, A's update, B's update) to redo log
&gt; update A
&gt; update B
&gt; delete redo log entry from redo log
&gt;
&gt; Asynchronously, I could read dangling entries from the redo log and repeat
&gt; them, deleting them upon success. (Let's imagine for simplicity that the
&gt; updates are idempotent and commutative.) This seems doable, but it's not
&gt; pretty. Is this the best I can do? Or should I think about the problem
&gt; differently?
&gt;
&gt; (BTW, I believe that secondary indexes won't help me.)
&gt;
&gt; Cheers,
&gt; John
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

