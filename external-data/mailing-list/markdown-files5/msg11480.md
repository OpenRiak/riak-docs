---
title: "RE: CorrugatedIron & Idle Connection"
description: ""
project: community
lastmod: 2013-07-11T07:48:38-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11480"
mailinglist_parent_id: "msg11479"
author_name: "Amir Halatzi"
project_section: "mailinglistitem"
sent_date: 2013-07-11T07:48:38-07:00
---


We've tried that. The result was 3K open connections per Riak node, and as you 
can guess - this is not an improvement.

Do you have other recommendations?

Thanks,
Amir


From: OJ Reeves [mailto:o...@buffered.io]
Sent: 11 July 2013 17:31
To: Amir Halatzi
Cc: Jeremiah Peschka; riak-users@lists.basho.com
Subject: Re: CorrugatedIron & Idle Connection

This is a discussion we really need to have. Thanks for opening the Github 
issue.

In the short term, you can "turn off" pooling by setting the pool size to zero. 
This will mean all the connections are done "on the fly".

On Fri, Jul 12, 2013 at 12:26 AM, Amir Halatzi 
&gt; wrote:
Just did: https://github.com/DistributedNonsense/CorrugatedIron/issues/153

Still, if we'd like to manage it ourselves - how would you recommend going 
about it? Should we interfere with the way you handle the connection, or just 
retry the action on 'network failure'?

BR,
Amir

From: Jeremiah Peschka 
[mailto:jeremiah.pesc...@gmail.com]
Sent: 11 July 2013 17:11
To: Amir Halatzi
Cc: riak-users@lists.basho.com
Subject: Re: CorrugatedIron & Idle Connection

We're in the process of figuring out how to best handle killing off idle 
connections inside of CorrugatedIron. If you can head over to 
https://github.com/DistributedNonsense/CorrugatedIron/issues and file a new bug 
report, that would be fantastic.

We've avoided killing off connections until now because we don't want to 
introduce locking into our connection management. Truthfully, we haven't run 
into a bug report where the network team was killing off connections.

So, anyway, if you can submit a bug report we'll get on it. It won't make it 
out for the 1.4.0 release, but we can put that in a point release.

---
Jeremiah Peschka - Founder, Brent Ozar Unlimited
MCITP: SQL Server 2008, MVP
Cloudera Certified Developer for Apache Hadoop

On Thu, Jul 11, 2013 at 6:59 AM, Amir Halatzi 
&gt; wrote:
Hi all,

Trying to optimize our application connection pool, we encountered and issue 
with Corrugated Iron and identifying idle/reset connections. Namely, if our 
network infrastructure (firewall/proxy/etc) closes an idle connection - we're 
getting a 'cluster is offline' error code.

I saw that this is a feature in the making (for the past 8 months), but I was 
wondering if any of you found a way around it?

Thank you,
Amir Halatzi,
ooVoo


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com



--

OJ Reeves
+61 431 952 586
http://buffered.io/
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

