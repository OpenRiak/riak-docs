---
title: "Re: CRDT on Riak 2.0"
description: ""
project: community
lastmod: 2014-03-04T08:29:34-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13747"
mailinglist_parent_id: "msg13761"
author_name: "Sam Elliott"
project_section: "mailinglistitem"
sent_date: 2014-03-04T08:29:34-08:00
---


Yes, batch your updates, it'll be much more efficient that way.

Do not try to decode the `context` object. Use it as an opaque value, as the 
data it holds could change without warning.

Sam 

-- 
Sam Elliott
Engineer
sam.elli...@basho.com
--


On Tuesday, 4 March 2014 at 10:22AM, EmiNarcissus wrote:

&gt; 
&gt; 
&gt; Hi Sean,
&gt; 
&gt; 
&gt; 
&gt; Thanks very much, that’s very helpful. Anyways, I’ve noticed in update\\_dt 
&gt; function they are preferred to apply a context dict, which in the mail list 
&gt; described as a encoded version of original object(dict,set, so to say on a 
&gt; single update action, each time a new record is being added/removed it will 
&gt; apply the full original object to the server?), so for frequently operations, 
&gt; how much performance difference is between batch/single actions?
&gt; 
&gt; 
&gt; 
&gt; I’m only thinking about the possibilities on large dataset, but really in 
&gt; fact the dataset I’m planning to use at most contains 1-2k records is already 
&gt; big enough. currently I’m working on a project which using Riak Link to hold 
&gt; the identical items,also need to update the object data itself a lot(inside 
&gt; have a few counters(but indeed currently is just a number,didn’t put it into 
&gt; a separated counter yet), so is very non-efficient to update when new record 
&gt; is being inserted, don’t know if CRDT will provide more efficiency on that.
&gt; 
&gt; 
&gt; On 2014年3月4日 at 下午11:12:03, Sam Elliott (sam.elli...@basho.com 
&gt; (mailto:sam.elli...@basho.com)) wrote:
&gt; &gt; To answer another thing brought up in your message:
&gt; &gt; 
&gt; &gt; When you say "big enough" set sizes of 10k, be very careful. Riak Data 
&gt; &gt; Types should not 
&gt; &gt; be larger than you would make a normal Riak Object. There's more guidance 
&gt; &gt; in this thread: 
&gt; &gt; http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2014-February/014722.html
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Sam
&gt; &gt; 
&gt; &gt; --
&gt; &gt; Sam Elliott
&gt; &gt; Engineer
&gt; &gt; sam.elli...@basho.com (mailto:sam.elli...@basho.com)
&gt; &gt; --
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On Tuesday, 4 March 2014 at 10:02AM, Sean Cribbs wrote:
&gt; &gt; 
&gt; &gt; &gt; Hi Tim,
&gt; &gt; &gt; 
&gt; &gt; &gt; We punted on sub-type queries for 2.0. We intend to address them in 2.1, 
&gt; &gt; &gt; so yes you must 
&gt; &gt; fetch the entire set or map in order to find out things like membership and 
&gt; &gt; cardinality. 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; On Tue, Mar 4, 2014 at 8:01 AM, EmiNarcissus 
&gt; &gt; wrote:
&gt; &gt; &gt; &gt; Hi,
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I’m now porting the riak 2.0 driver for twisted, it works beautifully 
&gt; &gt; &gt; &gt; now with what 
&gt; &gt; Yokozuna provides, also have a great back-port ability,really appreciate 
&gt; &gt; everything 
&gt; &gt; what this team have brought us XD. But because it still in lacks of 
&gt; &gt; document, I must read 
&gt; &gt; the implementation both from ruby and riakc-erl repo to get it 
&gt; &gt; started(erlang is okay 
&gt; &gt; for me, but I’m not quite familiar with ruby,sadly looks like only ruby’s 
&gt; &gt; client implementation 
&gt; &gt; is throughly right now).
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; So here is my question on the datatype implementation on CRDT system.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; From the code I can tell , fetch\\_dt/update\\_dt/modify\\_dt is what have 
&gt; &gt; &gt; &gt; been exposed 
&gt; &gt; from the pbc interface. Now I’m more focused on Set object, so each time 
&gt; &gt; client will fetch 
&gt; &gt; the whole set(fetch\\_dt) from the server and build the set on the local end, 
&gt; &gt; and maintain 
&gt; &gt; a add/remove operation list to send to the server when user does a 
&gt; &gt; update/add/remove 
&gt; &gt; action.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; But I’m a little bit confused here, like what redis provides, a set 
&gt; &gt; &gt; &gt; have a ismember function 
&gt; &gt; is being done on the server instead of fetch/test manner. Does this 
&gt; &gt; available for Riak 
&gt; &gt; 2.0 Set datatype(just like what Riak1.4 Counter object provided, it will do 
&gt; &gt; the operation 
&gt; &gt; on the server side,MISMEMBER a b, it will either return True/False). 
&gt; &gt; Currently I only 
&gt; &gt; can see add/update/delete operation on pbc proto file, and don’t have 
&gt; &gt; something alike, 
&gt; &gt; is that in a Todo list ? or will not implement at all(I will reconsider how 
&gt; &gt; the data should 
&gt; &gt; be structured if so). This feature will be really helpful when the dataset 
&gt; &gt; is big enough(like 
&gt; &gt; more than 10k values in it.)
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Best,
&gt; &gt; &gt; &gt; Tim Lee
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; &gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; --
&gt; &gt; &gt; Sean Cribbs 
&gt; &gt; &gt; Software Engineer
&gt; &gt; &gt; Basho Technologies, Inc.
&gt; &gt; &gt; http://basho.com/
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt; 
&gt; 
&gt; @basho.com&gt;@me.com&gt;




\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

