---
title: "Generic server memsup terminating Mountain Lion"
description: ""
project: community
lastmod: 2014-09-09T14:33:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14881"
author_name: "Spiro N"
project_section: "mailinglistitem"
sent_date: 2014-09-09T14:33:13-07:00
---


S
\\*orry, I am sure you have posted in regards to this topic before but I am
at a stand still. It just started after doing a "get"\\*
\\*the video was about 20 MB. The beam.smp spikes at 100 and riak crashes. I
have done everything the Docs ask for and I provided all that I feel may be
relevant below. However I don't know what I don't know and could use some
help. Mountain Lion does not let you set the ulmit to unlimited.\\*

\\*Thanks in advance for anything at all that may help.\\*

\\*Spiro\\*


\\*This is my limit, I am running Mountain Lion 10.8.5\\*

server:riak gvs$ launchctl limit
 cpu unlimited unlimited
 filesize unlimited unlimited
 data unlimited unlimited
 stack 8388608 67104768
 core 0 unlimited
 rss unlimited unlimited
 memlock unlimited unlimited
 maxproc 709 1064
 \\*maxfiles 65336 1000000 \\*
----------------------------------------------------------

\\*This is my Bitcask content\\*
server:lib gvs$ cd /usr/local/var/lib/riak/
server:riak gvs$ ls bitcask/\\*/\\* |wc -l
 206
--------------------------------------------------------------
\\*This is the crash.log message\\*


2014-09-09 14:34:51 =ERROR REPORT====
\\*\\* Generic server memsup terminating
\\*\\* Last message in was
{'EXIT',&lt;0.20807.0&gt;,{emfile,[{erlang,open\\_port,[{spawn,"/bin/sh -s unix:cmd
2&gt;&1"},[stream]],[]},{os,start\\_port\\_srv\\_handle,1,[{file,"os.erl"},{line,254}]},{os,start\\_port\\_srv\\_loop,0,[{file,"os.erl"},{line,270}]}]}}
\\*\\* When Server state ==
{state,{unix,darwin},false,undefined,undefined,false,60000,30000,0.8,0.05,&lt;0.20807.0&gt;,#Ref&lt;0.0.0.120573&gt;,undefined,[reg],[]}
\\*\\* Reason for termination ==
\\*\\* {emfile,[{erlang,open\\_port,[{spawn,"/bin/sh -s unix:cmd
2&gt;&1"},[stream]],[]},{os,start\\_port\\_srv\\_handle,1,[{file,"os.erl"},{line,254}]},{os,start\\_port\\_srv\\_loop,0,[{file,"os.erl"},{line,270}]}]}
2014-09-09 14:34:51 =CRASH REPORT====
 crasher:
 initial call: memsup:init/1
 pid: &lt;0.20806.0&gt;
 registered\\_name: memsup
 exception exit: {{emfile,[{erlang,open\\_port,[{spawn,"/bin/sh -s
unix:cmd
2&gt;&1"},[stream]],[]},{os,start\\_port\\_srv\\_handle,1,[{file,"os.erl"},{line,254}]},{os,start\\_port\\_srv\\_loop,0,[{file,"os.erl"},{line,270}]}]},[{gen\\_server,terminate,6,[{file,"gen\\_server.erl"},{line,747}]},{proc\\_lib,init\\_p\\_do\\_apply,3,[{file,"proc\\_lib.erl"},{line,227}]}]}
 ancestors: [os\\_mon\\_sup,&lt;0.96.0&gt;]
 messages: []
 links: [&lt;0.97.0&gt;]
 dictionary: []
 trap\\_exit: true
 status: running
 heap\\_size: 377
 stack\\_size: 24
 reductions: 204
 neighbours:
2014-09-09 14:34:51 =SUPERVISOR REPORT====
 Supervisor: {local,os\\_mon\\_sup}
 Context: child\\_terminated
 Reason: {emfile,[{erlang,open\\_port,[{spawn,"/bin/sh -s unix:cmd
2&gt;&1"},[stream]],[]},{os,start\\_port\\_srv\\_handle,1,[{file,"os.erl"},{line,254}]},{os,start\\_port\\_srv\\_loop,0,[{file,"os.erl"},{line,270}]}]}
 Offender:
[{pid,&lt;0.20806.0&gt;},{name,memsup},{mfargs,{memsup,start\\_link,[]}},{restart\\_type,permanent},{shutdown,2000},{child\\_type,worker}]

2014-09-09 14:34:51 =SUPERVISOR REPORT====
 Supervisor: {local,os\\_mon\\_sup}
 Context: shutdown
 Reason: reached\\_max\\_restart\\_intensity
 Offender: [{pid,&lt;0.20806.0&gt;},{name,memsup},{mfargs,{memsup,st
------------------------------------------------------------------------------------------------
\\*This is the error.log message\\*

server:riak gvs$ tail error.log
2014-09-09 17:00:25.907 [error] &lt;0.439.1&gt; gen\\_server memsup terminated with
reason: maximum number of file descriptors exhausted, check ulimit -n
2014-09-09 17:00:25.908 [error] &lt;0.439.1&gt; CRASH REPORT Process memsup with
0 neighbours exited with reason: maximum number of file descriptors
exhausted, check ulimit -n in gen\\_server:terminate/6 line 747
2014-09-09 17:00:25.908 [error] &lt;0.97.0&gt; Supervisor os\\_mon\\_sup had child
memsup started with memsup:start\\_link() at &lt;0.439.1&gt; exit with reason
maximum number of file descriptors exhausted, check ulimit -n in context
child\\_terminated
2014-09-09 17:00:25.908 [error] &lt;0.442.1&gt; gen\\_server memsup terminated with
reason: maximum number of file descriptors exhausted, check ulimit -n
2014-09-09 17:00:25.908 [error] &lt;0.442.1&gt; CRASH REPORT Process memsup with
0 neighbours exited with reason: maximum number of file descriptors
exhausted, check ulimit -n in gen\\_server:terminate/6 line 747
2014-09-09 17:00:25.909 [error] &lt;0.97.0&gt; Supervisor os\\_mon\\_sup had child
memsup started with memsup:start\\_link() at &lt;0.442.1&gt; exit with reason
maximum number of file descriptors exhausted, check ulimit -n in context
child\\_terminated
2014-09-09 17:00:25.909 [error] &lt;0.445.1&gt; gen\\_server memsup terminated with
reason: maximum number of file descriptors exhausted, check ulimit -n
2014-09-09 17:00:25.909 [error] &lt;0.445.1&gt; CRASH REPORT Process memsup with
0 neighbours exited with reason: maximum number of file descriptors
exhausted, check ulimit -n in gen\\_server:terminate/6 line 747
2014-09-09 17:00:25.909 [error] &lt;0.97.0&gt; Supervisor os\\_mon\\_sup had child
memsup started with memsup:start\\_link() at &lt;0.445.1&gt; exit with reason
maximum number of file descriptors exhausted, check ulimit -n in context
child\\_terminated
2014-09-09 17:00:25.910 [error] &lt;0.97.0&gt; Supervisor os\\_mon\\_sup had child
memsup started with memsup:start\\_link() at &lt;0.445.1&gt; exit with reason
reached\\_max\\_restart\\_intensity in context shutdown
--------------------------------------------------------------------------------------------------
\\*This is the erlang.log\\*

server:riak gvs$ tail erlang.log.1
Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:4:4] [async-threads:64]
[kernel-poll:true]

Eshell V5.9.1 (abort with ^G)
(riak@172.16.205.254)1&gt;
===== ALIVE Tue Sep 9 16:29:28 EDT 2014

===== ALIVE Tue Sep 9 16:44:28 EDT 2014

===== ALIVE Tue Sep 9 16:59:28 EDT 2014
{"Kernel pid
terminated",application\\_controller,"{application\\_terminated,os\\_mon,shutdown}"}
server:riak gvs$

 This message and any attachments are intended only for the use of the
addressee and may contain information that is privileged and confidential.
If the reader of the message is not the intended recipient or an authorized
representative of the intended recipient, you are hereby notified that any
dissemination of this communication is strictly prohibited. If you have
received this communication in error, notify the sender immediately by
return email and delete the message and any attachments from your system.
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

