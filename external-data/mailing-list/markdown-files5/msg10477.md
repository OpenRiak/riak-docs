---
title: "Re: Re: riak cluster suddenly became unresponsive"
description: ""
project: community
lastmod: 2013-03-19T09:11:48-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10477"
mailinglist_parent_id: "msg10476"
author_name: "Evan Vigil-McClanahan"
project_section: "mailinglistitem"
sent_date: 2013-03-19T09:11:48-07:00
---


Also, in the mean time, adding +swt very\\_low to your vm.args can help
lessen the incidence of this issue.

On Tue, Mar 19, 2013 at 7:41 AM, Ingo Rockel
 wrote:
&gt; and the riak-users mailer-daemon should really set a "reply-to"...
&gt;
&gt; -------- Original-Nachricht --------
&gt; Betreff: Re: riak cluster suddenly became unresponsive
&gt; Datum: Tue, 19 Mar 2013 15:40:12 +0100
&gt; Von: Ingo Rockel 
&gt; An: Mark Phillips 
&gt;
&gt; Hi Mark,
&gt;
&gt; thanks!
&gt;
&gt; The 1.3 update is already planned.
&gt;
&gt; But we will add the zdbbl first as we ran into the same issue yesterday
&gt; again.
&gt;
&gt; Ingo
&gt;
&gt; Am 19.03.2013 15:04, schrieb Mark Phillips:
&gt;&gt;
&gt;&gt; Hi Ingo,
&gt;&gt;
&gt;&gt; Sorry for the delay in getting back to you.
&gt;&gt;
&gt;&gt; This looks symptomatic of some of the scheduler issues we fixed of 1.3.
&gt;&gt; A few of the eleveldb issues in the release notes [1] can provide
&gt;&gt; precise details. Is upgrading a possibility?
&gt;&gt;
&gt;&gt; Tweaking your zdbbl in vm.args should alleviate some of the issues with
&gt;&gt; busy buffers but upgrading is probably your best path here.
&gt;&gt;
&gt;&gt; Hope that helps. Keep us posted.
&gt;&gt;
&gt;&gt; Mark
&gt;&gt;
&gt;&gt; [1] https://github.com/basho/riak/blob/master/RELEASE-NOTES.md
&gt;&gt;
&gt;&gt; On Friday, March 15, 2013, Ingo Rockel wrote:
&gt;&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; we have a 12 nodes cluster running riak 1.2.1 which went live a week
&gt;&gt; ago. Yesterday, suddenly from one minute to another the
&gt;&gt; put\\_fsm\\_time\\_95 and the get\\_fsm\\_time\\_95 raised from something below
&gt;&gt; 100ms up to several seconds. This went on for about 25 min and than
&gt;&gt; went away.
&gt;&gt;
&gt;&gt; Checking the riak-logs of the nodes, I find a lot of these:
&gt;&gt;
&gt;&gt; 2013-03-14 17:48:06.388 [info]
&gt;&gt; &lt;0.62.0&gt;@riak\\_core\\_sysmon\\_\\_\\_handler:handle\\_event:89 Monitor got
&gt;&gt;
&gt;&gt; {suppressed,port\\_events,1}
&gt;&gt; 2013-03-14 17:48:06.889 [info]
&gt;&gt; &lt;0.62.0&gt;@riak\\_core\\_sysmon\\_\\_\\_handler:handle\\_event:85 monitor
&gt;&gt; busy\\_dist\\_port &lt;0.7156.1&gt;
&gt;&gt;
&gt;&gt; [{initial\\_call,{riak\\_core\\_\\_\\_vnode,init,1}},{almost\\_\\_\\_current\\_function,{erlang,bif\\_\\_\\_return\\_trap,1}},{message\\_\\_\\_queue\\_len,1}]
&gt;&gt;
&gt;&gt; {#Port&lt;0.9083226&gt;,'riak@172.22.3.22'}
&gt;&gt;
&gt;&gt; This messages are logged all day, but only once every few minutes
&gt;&gt; but in the problematic time frame between 17:45 and 18:17 it gets
&gt;&gt; logged several times every second. The node ip differs though, but
&gt;&gt; it seems only three nodes were involved.
&gt;&gt;
&gt;&gt; Except of these three nodes the cpu utilisation drops by half during
&gt;&gt; this on all other nodes. On the three nodes there's only a slight
&gt;&gt; drop.
&gt;&gt;
&gt;&gt; We are using leveldb as storage backend. I also checked some of the
&gt;&gt; LOG files of leveldb and there are compactions logged, but these are
&gt;&gt; logged all the day every few hours.
&gt;&gt;
&gt;&gt; In this time our software was quite unresponsive too so I would like
&gt;&gt; to know what was causing this and what I might do to stop. Any
&gt;&gt; ideas, hints?
&gt;&gt;
&gt;&gt; I found this:
&gt;&gt;
&gt;&gt;
&gt;&gt; https://groups.google.com/\\_\\_forum/?fromgroups=#!topic/\\_\\_nosql-databases/GqbaeiKCSYE
&gt;&gt;
&gt;&gt;
&gt;&gt; 
&gt;&gt;
&gt;&gt; where Jon Meredith suggests to raise the buffer size to get rid of
&gt;&gt; the busy buffers by adding +zdbbl 16384 to the vm.args file. Might
&gt;&gt; this help?
&gt;&gt;
&gt;&gt; Regards,
&gt;&gt;
&gt;&gt; Ingo
&gt;&gt; --
&gt;&gt; Software Architect
&gt;&gt;
&gt;&gt; Blue Lion mobile GmbH
&gt;&gt; Tel. +49 (0) 221 788 797 14
&gt;&gt; Fax. +49 (0) 221 788 797 19
&gt;&gt; Mob. +49 (0) 176 24 87 30 89
&gt;&gt;
&gt;&gt; ingo.roc...@bluelionmobile.com
&gt;&gt; &gt;&gt;&gt; qeep: Hefferwolf
&gt;&gt;
&gt;&gt; www.bluelionmobile.com 
&gt;&gt; www.qeep.net 
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/\\_\\_mailman/listinfo/riak-users\\_\\_\\_lists.basho.com
&gt;&gt; 
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; Software Architect
&gt;
&gt; Blue Lion mobile GmbH
&gt; Tel. +49 (0) 221 788 797 14
&gt; Fax. +49 (0) 221 788 797 19
&gt; Mob. +49 (0) 176 24 87 30 89
&gt;
&gt; ingo.roc...@bluelionmobile.com
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; qeep: Hefferwolf
&gt;
&gt;
&gt; www.bluelionmobile.com
&gt; www.qeep.net
&gt;
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

