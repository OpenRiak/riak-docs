---
title: "Re: Detecting Hinted Handoff"
description: ""
project: community
lastmod: 2016-07-25T03:26:58-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17560"
mailinglist_parent_id: "msg17559"
author_name: "DeadZen"
project_section: "mailinglistitem"
sent_date: 2016-07-25T03:26:58-07:00
---


Hinted handoff from adding a node, removing a node or failing a node? Could
probably get some idea from a ring handler, hinted handoff could likely
very well trigger its own event as well without a large modification to
riak\\_core


On Sunday, July 24, 2016, Sargun Dhillon  wrote:

&gt; It might also make a lot of sense to roll your own secondary indices. That
&gt; is, have a CRDT set represent the primary key of the rows which meet the 2i
&gt; condition. In that, you can query the CRDT set, and ensure some level of
&gt; consistency. There are further tricks to be played here if interested.
&gt;
&gt; I'm curious, what is your data model?
&gt;
&gt; On Fri, Jul 22, 2016 at 11:01 AM, Alexander Sicular  &gt; wrote:
&gt;
&gt;&gt; Take a look at the "pw" and "pr" tunable consistency options for gets and
&gt;&gt; puts. The base level of abstraction in Riak is the virtual node - not the
&gt;&gt; physical machine. When data is replicated it is replicated to a replica set
&gt;&gt; of virtual nodes. Those virtual nodes have primary and secondary (due to
&gt;&gt; failures) allocations to physical machines. When using "pr" and "pw"
&gt;&gt; options you instruct Riak to only service the request from virtual nodes
&gt;&gt; that are residing on their primarily allocated physical machines. In short,
&gt;&gt; by abusing pr/pw you can infer the state of your cluster from your
&gt;&gt; application.
&gt;&gt;
&gt;&gt; Obviously, this is not foolproof. There may also be additional 2i
&gt;&gt; specific issues to consider. Nevertheless, I always liked this trick.
&gt;&gt;
&gt;&gt; Also, review this four part series on tunable consistency :
&gt;&gt;
&gt;&gt;
&gt;&gt; http://basho.com/posts/technical/understanding-riaks-configurable-behaviors-part-1/
&gt;&gt; http://basho.com/posts/technical/riaks-config-behaviors-part-2/
&gt;&gt; http://basho.com/posts/technical/riaks-config-behaviors-part-3/
&gt;&gt; http://basho.com/posts/technical/riaks-config-behaviors-part-4/
&gt;&gt;
&gt;&gt; -Alexander
&gt;&gt;
&gt;&gt;
&gt;&gt; @siculars
&gt;&gt; http://siculars.posthaven.com
&gt;&gt;
&gt;&gt; Sent from my iRotaryPhone
&gt;&gt;
&gt;&gt; On Jul 22, 2016, at 12:28, Hawk Newton &gt; &gt; wrote:
&gt;&gt;
&gt;&gt; I've got a use case in which I'd like to use a secondary index but can't
&gt;&gt; tolerate partial result sets caused by hinted handoffs. I'm not currently
&gt;&gt; running riak search and, as this is a fringe case, would prefer not add
&gt;&gt; the
&gt;&gt; additional overhead and complexity if I can help it.
&gt;&gt;
&gt;&gt; I'd like to detect a hinted handoff operation and throw a 503, if
&gt;&gt; possible.
&gt;&gt;
&gt;&gt; Does anyone know of a way I can programatically detect if a hinted handoff
&gt;&gt; is underway without having to shell out to riak-admin (yuck!) and parse
&gt;&gt; the
&gt;&gt; results? I'm running riak 2.0.5 at the moment.
&gt;&gt;
&gt;&gt; Thank you in advance.
&gt;&gt;
&gt;&gt; -- Hawk
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; View this message in context:
&gt;&gt; http://riak-users.197444.n3.nabble.com/Detecting-Hinted-Handoff-tp4034489.html
&gt;&gt; Sent from the Riak Users mailing list archive at Nabble.com
&gt;&gt; .
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; 
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

