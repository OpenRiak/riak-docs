---
title: "Re: Loading links after a map phase in a map reduce query"
description: ""
project: community
lastmod: 2010-10-07T06:09:17-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01219"
mailinglist_parent_id: "msg01217"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-10-07T06:09:17-07:00
---


Jan,

It is possible to do a link phase after a map phase, if your map phase outputs 
lists of [bucket,key] pairs. However, the semantics of the link phase will be 
to load those specified objects and follow \\*their\\* links. If you just want to 
extract the links from the body of your first object and follow them, do so in 
the preceding map phase, and then your next map phase will be over the target 
of the links.

Regarding the size of the Link header, if it's possible to modify your client, 
make it emit multiple Link headers that are less than 8KB in length (which has 
the same semantics as a single Link header with items separated by commas). 
The Ruby client does this:

http://github.com/seancribbs/ripple/blob/master/riak-client/lib/riak/util/headers.rb#L22

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Oct 7, 2010, at 8:50 AM, Jan Metzner wrote:

&gt; Hi folks,
&gt; 
&gt; i am experimenting with riak and have a problem with too many links in a riak 
&gt; object.
&gt; If i store the object the server send 400 Bad Request. This is caused from 
&gt; the link header which is too long.
&gt; As workaround i thought about storing the links inside the riak object and 
&gt; fetch them in a map reduce query.
&gt; Is it possible to do a link phase after a map phase in riak and if so has 
&gt; somebody an example for this?
&gt; 
&gt; Thanks and regards
&gt; Jan
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

