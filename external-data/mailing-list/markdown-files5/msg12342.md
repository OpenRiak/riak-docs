---
title: "Re: Using /etc/hosts entry and not ip in configuration files .."
description: ""
project: community
lastmod: 2013-09-21T18:14:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12342"
mailinglist_parent_id: "msg12330"
author_name: "Mike Nathe"
project_section: "mailinglistitem"
sent_date: 2013-09-21T18:14:29-07:00
---


Hi Alex.

thanks a bunch for the info and the link to the white paper.

Unfortunately we still haven't been able to use a domain name in the
vm.args successfully.

We use Chef scripts to build our EC2 instances (OpsWorks).
The only difference in the scripts is:

# use domain name
node.set['riak']['args']['-name'] = "riak@#{node['hostname']}-int"
# use ip
node.set['riak']['args']['-name'] = "riak@#{node['ipaddress']}"

The deployment with the ipaddress works great.
The deployment with the hostname does start the server but the tools do not
work ( returns "Node is not running").
We checked /var/log/riak and the console.log and error.log looked clean,
though there was an erlang dump.

Any insight into this would be greatly appreciated.
Thanks again.

Cheers,
Michael



The result of a simple test for hostname deployment:

ubuntu@riaknode1:~$ sudo /usr/local/riak/bin/riak-admin ringready
Node is not running!


The result of a simple test for ipaddress deployment:

ubuntu@riaknode1:~$ sudo /usr/local/riak/bin/riak-admin ringready
TRUE All nodes agree on the ring ['riak@172.31.44.73']




On 19 September 2013 16:58, Alex Moore  wrote:

&gt; Hey Mike,
&gt;
&gt; Another option for your app.config would be to bind everything to
&gt; "0.0.0.0", which will make Riak listen on all interfaces. This combined
&gt; with using a domain name in the vm.args should prevent you from having to
&gt; do renames/changing ips in the config files.
&gt; If you do this, please consider using a VPC to limit access to the
&gt; machines.
&gt;
&gt; A good resource to read over is Amazon's Riak Whitepaper:
&gt; http://media.amazonwebservices.com/AWS\\_NoSQL\\_Riak.pdf, as it goes through
&gt; some operation considerations and tuning points that might be useful to you.
&gt;
&gt; Thanks,
&gt; Alex
&gt;
&gt; On September 19, 2013 at 6:52:29 PM, Mike Nathe (mna...@fathom-i.com)
&gt; wrote:
&gt;
&gt; hi.
&gt;
&gt; we are trying to run Riak in the Amazon cloud (using OpsWorks).
&gt; With every restart of the servers the ip addresses change so using an
&gt; entry in the /etc/hosts instead of an IP looks like a great idea.
&gt;
&gt; Google's answer is:
&gt;
&gt; http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2011-December/006912.html
&gt;
&gt; Just to make sure: Riak only supports IP addresses and not DNS names in
&gt; the config files.
&gt; Though in your docs it still says:
&gt; "Riak identifies other machines in the ring using Erlang identifiers
&gt; (, ex: riak@10.9.8.7)."
&gt;
&gt;
&gt; The error logged when changing our config from something
&gt; like 172.31.41.138 to riaknode2-ext is:
&gt;
&gt; 2013-09-19 21:49:53.383 [error] &lt;0.113.0&gt; Supervisor riak\\_core\\_sup had
&gt; child "http\\_riaknode2-ext:8098" started with
&gt; webmachine\\_mochiweb:start([{name,"http\\_riaknode2-ext:8098"},{ip,"riaknode2-ext"},{port,8098},{nodelay,true},{log\\_dir,"log"},...])
&gt; at undefined exit with reason
&gt; {'EXIT',{{badmatch,{error,einval}},[{mochiweb\\_socket\\_server,parse\\_options,2},{mochiweb\\_socket\\_server,start,1},{supervisor,do\\_start\\_child,2},{supervisor,start\\_children,3},{supervisor,init\\_children,2},{gen\\_server,init\\_it,6},{proc\\_lib,init\\_p\\_do\\_apply,3}]}}
&gt; in context start\\_error
&gt;
&gt; Thanks a bunch.
&gt;
&gt; Have a great day.
&gt; Michael
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

