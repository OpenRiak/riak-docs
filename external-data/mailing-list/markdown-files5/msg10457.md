---
title: "Re: errors after rolling upgrade to 1.3"
description: ""
project: community
lastmod: 2013-03-15T05:29:51-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10457"
mailinglist_parent_id: "msg10455"
author_name: "Kresten Krab Thorup"
project_section: "mailinglistitem"
sent_date: 2013-03-15T05:29:51-07:00
---


Looks like you're running a JS map-reduce job. Scanning the code of 
riak\\_kv\\_w\\_reduce, it looks like the culprit could be line 270, â€¦ something in 
the middle of running a JS map/reduce job with an Erlang Fun object which is 
incompatible across releases.

It looks like with the present 1.3.0 codebase, JS M/R will likely not work 
until all the nodes have been upgraded. Some background here: 
http://www.javalimit.com/2010/05/passing-funs-to-other-erlang-nodes.html

The fix going forward should be to have js\\_runner/1 return a symbolic 
(external) fun object. But that may not be the answer you're looking for.

Kresten


On Mar 15, 2013, at 11:03 AM, Mridul Kashatria 
&gt; wrote:

2013-03-15 09:45:35.104 [error] &lt;0.4065.0&gt; gen\\_fsm &lt;0.4065.0&gt; in state
wait\\_for\\_input terminated with reason: bad function
#Fun in riak\\_kv\\_w\\_reduce:reduce/3 line 206


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

