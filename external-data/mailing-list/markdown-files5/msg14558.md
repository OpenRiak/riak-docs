---
title: "Re: Issues with high node load and very slow response"
description: ""
project: community
lastmod: 2014-07-28T07:20:11-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14558"
mailinglist_parent_id: "msg14557"
author_name: "Jordan West"
project_section: "mailinglistitem"
sent_date: 2014-07-28T07:20:11-07:00
---


I apologize, I typoed the arguments to the last command. Please replace '
riak@10.127.137.185' with the correct hostname in:

yz\\_kv:is\\_metadata\\_consistent('riak@10.128.137.185 ').

Also, can you confirm these log messages are still being written.

Jordan


On Sun, Jul 27, 2014 at 10:54 PM, Chaim Solomon 
wrote:

&gt; Hi,
&gt;
&gt;
&gt; Responses inline
&gt;
&gt; On Mon, Jul 28, 2014 at 5:30 AM, Jordan West  wrote:
&gt;
&gt;&gt; Unfortunately, there are several conditions that could cause this. To
&gt;&gt; rule out the obvious ones can you verify that `riak@10.128.137.185` has
&gt;&gt; search enabled. If it is the case that search is enabled we can try a few
&gt;&gt; different things to debug further.
&gt;&gt;
&gt;&gt;
&gt; All nodes have search=on in the riak.conf and I see the Java process.
&gt;
&gt; Attaching to 'riak@10.128.138.25' (via "riak attach") and using the
&gt;&gt; shell, if you could provide the output of:
&gt;&gt;
&gt;&gt; ```
&gt;&gt; rpc:multicall([node() | nodes()], app\\_helper, get\\_env, [yokozuna,
&gt;&gt; enabled, false], 5000).
&gt;&gt; ```
&gt;&gt;
&gt;&gt; Eshell V5.10.3 (abort with ^G)
&gt; (riak@10.128.138.25)1&gt; rpc:multicall([node() | nodes()], app\\_helper,
&gt; get\\_env, [yokozuna, enabled, false], 5000).
&gt; {[true,true,true,true,true,true,true],[]}
&gt;
&gt; As well as:
&gt;&gt;
&gt;&gt; ```
&gt;&gt; [riak\\_core\\_node\\_watcher:services(N) || N &lt;- [node() | nodes()]].
&gt;&gt; ```
&gt;&gt;
&gt;&gt; (riak@10.128.138.25)2&gt; [riak\\_core\\_node\\_watcher:services(N) || N &lt;-
&gt; [node() | nodes()]].
&gt; [[yokozuna,riak\\_pipe,riak\\_kv],
&gt; [yokozuna,riak\\_pipe,riak\\_kv],
&gt; [yokozuna,riak\\_pipe,riak\\_kv],
&gt; [yokozuna,riak\\_pipe,riak\\_kv],
&gt; [yokozuna,riak\\_pipe,riak\\_kv],
&gt; [yokozuna,riak\\_pipe,riak\\_kv],
&gt; [yokozuna,riak\\_pipe,riak\\_kv]]
&gt;
&gt; And finally:
&gt;&gt;
&gt;&gt; ```
&gt;&gt; yz\\_kv:is\\_metadata\\_consistent('riak@10.127.137.185').
&gt;&gt; ```
&gt;&gt;
&gt;&gt; (riak@10.128.138.25)3&gt; yz\\_kv:is\\_metadata\\_consistent('riak@10.127.137.185
&gt; ').
&gt; \\*\\* exception exit: {{nodedown,'riak@10.127.137.185'},
&gt; {gen\\_server,call,
&gt; [{riak\\_core\\_metadata\\_hashtree,
&gt; 'riak@10.127.137.185'},
&gt; {prefix\\_hash,{core,bucket\\_types}},
&gt; 1000]}}
&gt; in function gen\\_server:call/3 (gen\\_server.erl, line 188)
&gt; in call from yz\\_kv:is\\_metadata\\_consistent/1 (src/yz\\_kv.erl, line 433)
&gt;
&gt; Based on the output of those we can debug further.
&gt;&gt;
&gt;&gt; Additionally, its entirely possible that when we get rid of that error it
&gt;&gt; will not resolve the primary issue (CPU usage/request slowness). However,
&gt;&gt; the check that is the source of that log message can block in the request
&gt;&gt; path, so something funky could certainly be going on.
&gt;&gt;
&gt;
&gt;
&gt; Chaim Solomon
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

