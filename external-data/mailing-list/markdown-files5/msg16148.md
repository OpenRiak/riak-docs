---
title: "Re: Riak 1.4.12 high I/O while almost idle"
description: ""
project: community
lastmod: 2015-05-22T08:34:50-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16148"
mailinglist_parent_id: "msg16147"
author_name: "Engel Sanchez"
project_section: "mailinglistitem"
sent_date: 2015-05-22T08:34:50-07:00
---


Hi Timo. Did you check if there is active anti-entropy activity? [1] That
could generate a lot of I/O in the background while building the trees with
the data needed for automatic repair or running exchanges to verify
replicas are up to date.

[1] http://docs.basho.com/riak/latest/ops/advanced/aae/#Monitoring-AAE

On Fri, May 22, 2015 at 10:54 AM, Doug Rohrer  wrote:

&gt; Timo:
&gt;
&gt; The general layout of the information is pretty similar to Top (and
&gt; described on the etop docs http://www.erlang.org/doc/man/etop.html and
&gt; http://www.erlang.org/doc/apps/observer/etop\\_ug.html) - the one downside
&gt; is that it doesn't profile which function is using the most CPU (the "Reds"
&gt; column is Reductions, which is Erlang's measure of work being done by a
&gt; process). If you run it for a while longer, with a shorter -interval
&gt; setting, you may be able to "catch" what function is being run most
&gt; frequently other than the gen\\_server:loop and gen\\_event:loop functions
&gt; you're seeing, as they are generic OTP functions and not very useful for
&gt; diagnostics.
&gt;
&gt; Doug
&gt;
&gt; On May 22, 2015, at 9:58 AM, Timo Gatsonides  wrote:
&gt;
&gt; Try running `riak-admin top` on the node to see what's going on:
&gt;
&gt; http://docs.basho.com/riak/1.4.12/ops/running/tools/riak-admin/#top
&gt;
&gt; This may give you some insight into what that node is doing.
&gt;
&gt;
&gt; Thanks for the quick response. I had already done that, however I don’t
&gt; understand the output …
&gt;
&gt; It is below.
&gt;
&gt; -Timo
&gt;
&gt;
&gt;
&gt; ===============================================================================================================================
&gt; '' 13:56:31
&gt; Load: cpu 0 Memory: total 69336 binary
&gt; 2717
&gt; procs 664 processes 8439 code
&gt; 10720
&gt; runq 0 atom 501 ets
&gt; 6227
&gt;
&gt; Pid Name or Initial Func Time Reds
&gt; Memory MsgQ Current Function
&gt;
&gt; -------------------------------------------------------------------------------------------------------------------------------
&gt; &lt;6206.105.0&gt; erlang:apply/2 '-' 5091705
&gt; 2600 0 cpu\\_sup:measurement\\_server\\_loop/1
&gt; &lt;6206.181.0&gt; riak\\_core\\_vnode\\_manager '-' 3064188
&gt; 231536 0 gen\\_server:loop/6
&gt; &lt;6206.580.0&gt; proc\\_lib:init\\_p/5 '-' 2805797
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.715.0&gt; proc\\_lib:init\\_p/5 '-' 2485959
&gt; 55144 0 gen\\_fsm:loop/7
&gt; &lt;6206.709.0&gt; proc\\_lib:init\\_p/5 '-' 2445894
&gt; 13896 3 eleveldb:get/3
&gt; &lt;6206.94.0&gt; riak\\_sysmon\\_filter '-' 2394053
&gt; 13656 0 gen\\_server:loop/6
&gt; &lt;6206.714.0&gt; proc\\_lib:init\\_p/5 '-' 2177064
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.710.0&gt; proc\\_lib:init\\_p/5 '-' 2153568
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.3.0&gt; erl\\_prim\\_loader '-' 2053533
&gt; 142464 0 erl\\_prim\\_loader:loop/3
&gt; &lt;6206.707.0&gt; proc\\_lib:init\\_p/5 '-' 2032382
&gt; 34472 0 gen\\_fsm:loop/7
&gt;
&gt;
&gt; ===============================================================================================================================
&gt; '' 13:56:36
&gt; Load: cpu 7 Memory: total 70450 binary
&gt; 2994
&gt; procs 665 processes 9133 code
&gt; 10720
&gt; runq 3 atom 501 ets
&gt; 6247
&gt;
&gt; Pid Name or Initial Func Time Reds
&gt; Memory MsgQ Current Function
&gt;
&gt; -------------------------------------------------------------------------------------------------------------------------------
&gt; &lt;6206.105.0&gt; erlang:apply/2 '-' 8092
&gt; 2600 0 cpu\\_sup:measurement\\_server\\_loop/1
&gt; &lt;6206.580.0&gt; proc\\_lib:init\\_p/5 '-' 6710
&gt; 34472 0 eleveldb:write/3
&gt; &lt;6206.94.0&gt; riak\\_sysmon\\_filter '-' 6447
&gt; 13656 0 gen\\_server:loop/6
&gt; &lt;6206.709.0&gt; proc\\_lib:init\\_p/5 '-' 6174
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.28437.0&gt; erlang:apply/2 '-' 3623
&gt; 21440 0 erlang:receive\\_emd/3
&gt; &lt;6206.707.0&gt; proc\\_lib:init\\_p/5 '-' 3089
&gt; 21696 0 gen\\_fsm:loop/7
&gt; &lt;6206.711.0&gt; proc\\_lib:init\\_p/5 '-' 3075
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.374.0&gt; riak\\_kv\\_stat\\_sj\\_2 '-' 2679
&gt; 3856 0 gen\\_server:loop/6
&gt; &lt;6206.714.0&gt; proc\\_lib:init\\_p/5 '-' 1955
&gt; 21696 0 gen\\_fsm:loop/7
&gt; &lt;6206.7.0&gt; application\\_controller '-' 1779
&gt; 55880 0 gen\\_server:loop/6
&gt;
&gt;
&gt; ===============================================================================================================================
&gt; '' 13:56:40
&gt; Load: cpu 8 Memory: total 69471 binary
&gt; 2827
&gt; procs 664 processes 8469 code
&gt; 10720
&gt; runq 0 atom 501 ets
&gt; 6251
&gt;
&gt; Pid Name or Initial Func Time Reds
&gt; Memory MsgQ Current Function
&gt;
&gt; -------------------------------------------------------------------------------------------------------------------------------
&gt; &lt;6206.105.0&gt; erlang:apply/2 '-' 10113
&gt; 2600 0 cpu\\_sup:measurement\\_server\\_loop/1
&gt; &lt;6206.181.0&gt; riak\\_core\\_vnode\\_manager '-' 9724
&gt; 231536 0 gen\\_server:loop/6
&gt; &lt;6206.182.0&gt; riak\\_core\\_capability '-' 5827
&gt; 54960 0 gen\\_server:loop/6
&gt; &lt;6206.715.0&gt; proc\\_lib:init\\_p/5 '-' 5814
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.712.0&gt; proc\\_lib:init\\_p/5 '-' 5153
&gt; 21696 0 gen\\_fsm:loop/7
&gt; &lt;6206.94.0&gt; riak\\_sysmon\\_filter '-' 4465
&gt; 13656 0 gen\\_server:loop/6
&gt; &lt;6206.580.0&gt; proc\\_lib:init\\_p/5 '-' 3619
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.376.0&gt; riak\\_kv\\_stat\\_sj\\_4 '-' 2542
&gt; 3856 0 gen\\_server:loop/6
&gt; &lt;6206.707.0&gt; proc\\_lib:init\\_p/5 '-' 2298
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.7.0&gt; application\\_controller '-' 2148
&gt; 55880 0 gen\\_server:loop/6
&gt;
&gt;
&gt; ===============================================================================================================================
&gt; '' 13:56:45
&gt; Load: cpu 9 Memory: total 69332 binary
&gt; 2786
&gt; procs 665 processes 8324 code
&gt; 10720
&gt; runq 0 atom 501 ets
&gt; 6269
&gt;
&gt; Pid Name or Initial Func Time Reds
&gt; Memory MsgQ Current Function
&gt;
&gt; -------------------------------------------------------------------------------------------------------------------------------
&gt; &lt;6206.105.0&gt; erlang:apply/2 '-' 8092
&gt; 2600 0 cpu\\_sup:measurement\\_server\\_loop/1
&gt; &lt;6206.712.0&gt; proc\\_lib:init\\_p/5 '-' 5472
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.94.0&gt; riak\\_sysmon\\_filter '-' 4674
&gt; 13656 0 gen\\_server:loop/6
&gt; &lt;6206.580.0&gt; proc\\_lib:init\\_p/5 '-' 3939
&gt; 55144 0 gen\\_fsm:loop/7
&gt; &lt;6206.161.0&gt; riak\\_core\\_ring\\_manager '-' 3591
&gt; 230096 0 gen\\_server:loop/6
&gt; &lt;6206.709.0&gt; proc\\_lib:init\\_p/5 '-' 2890
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.376.0&gt; riak\\_kv\\_stat\\_sj\\_4 '-' 2880
&gt; 5720 0 gen\\_server:loop/6
&gt; &lt;6206.710.0&gt; proc\\_lib:init\\_p/5 '-' 2476
&gt; 34472 0 gen\\_fsm:loop/7
&gt; &lt;6206.708.0&gt; proc\\_lib:init\\_p/5 '-' 2033
&gt; 21696 0 gen\\_fsm:loop/7
&gt; &lt;6206.639.0&gt; proc\\_lib:init\\_p/5 '-' 1997
&gt; 34472 0 gen\\_fsm:loop/7
&gt;
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

