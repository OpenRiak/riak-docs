---
title: "Re: Java Client: minConnections"
description: ""
project: community
lastmod: 2015-06-30T07:46:28-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16267"
mailinglist_parent_id: "msg16266"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2015-06-30T07:46:28-07:00
---


Hi Henning,

Thank you for providing more information about this issue. I have
opened the following issue on GitHub where we will follow up:

https://github.com/basho/riak-java-client/issues/523

--
Luke Bakken
Engineer
lbak...@basho.com


On Tue, Jun 30, 2015 at 4:17 AM, Henning Verbeek  wrote:
&gt; I've reported in the past that my application is seeing stange
&gt; exceptions when running under even the slightest load (see
&gt; http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2015-April/017137.html).
&gt;
&gt; The observation is that some threads simply hang when this exception
&gt; occurs, waiting for ever without understanding what is going on. This
&gt; unreliability is very bad for my application where a lot of
&gt; Riak-related tasks are handled in Threads in the background.
&gt;
&gt; I keep trying to find out what is causing this, but I have no real
&gt; clue. But after playing around with
&gt; RiakNode.Builder.min/maxConnections, the problem does not occur
&gt; anymore.
&gt;
&gt; Specifically, I have now set:
&gt; RiakNode riakNode = new RiakNode.Builder()
&gt; .withConnectionTimeout(5000)
&gt; .withMinConnections(2)
&gt; .withMaxConnections(16)
&gt; .withIdleTimeout(500)
&gt; .withBlockOnMaxConnections(false)
&gt; .withRemoteAddress(Config.getInstance().getRiakAddress())
&gt; .withRemotePort(Config.getInstance().getRiakPort())
&gt; .build();
&gt;
&gt; If I leave minConnections at 1, the problem occurs, reproducibly. With
&gt; higher values, it doesn't.
&gt;
&gt; Is there maybe an issue in the code? Are connections reaped too quickly?
&gt;
&gt; Cheers,
&gt; Henning
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

