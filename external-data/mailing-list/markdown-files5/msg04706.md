---
title: "Re: PHP client overhaul"
description: ""
project: community
lastmod: 2011-09-14T10:42:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04706"
mailinglist_parent_id: "msg04702"
author_name: "Kev Burns"
project_section: "mailinglistitem"
sent_date: 2011-09-14T10:42:29-07:00
---


agree on optional read-before-write.
good note on optional returnbody.

I recall a talk by Yammer about their use of Riak in Scala and the gist was
that they achieve retry using closures.
I has envisioned resolvers as being bucket specific and being automatically
called at read time if present before bubbling a 300 to the code operating
the client.

$bucket-&gt;resolver = function($a, $b) use ($bucket) {
 // Try to resolve
 return $whether\\_resolved;
}

- Kev
c: +001 (650) 521-7791


On Wed, Sep 14, 2011 at 8:31 AM, Mark Steele wrote:

&gt; Looks great!
&gt;
&gt; We are currently still using the 5.2 series, but a better client that only
&gt; supports 5.3 might motivate us to upgrade.
&gt;
&gt; I would just add to make any read-before-write stuff optional (for
&gt; performance reasons), same with returnbody behaviors.
&gt;
&gt; Sibling resolution is very application specific. Not sure how to approach
&gt; that one unless you encapsulate the data payload somehow (like this:
&gt; http://labs.mochimedia.com/archive/2011/05/08/statebox/). Even so, that
&gt; locks you into one approach which may not fit all types of applications. I'd
&gt; love to see statebox-like code baked in though.
&gt;
&gt; We usually do all of our conflict resolution at read time (using an
&gt; approach similar to statebox) whenever an object is returned with siblings.
&gt;
&gt; Cheers
&gt;
&gt; Mark
&gt;
&gt; On Wed, Sep 14, 2011 at 10:23 AM, Kev Burns  wrote:
&gt;
&gt;&gt;
&gt;&gt; Riak 1.0 is coming soon.
&gt;&gt; Now would be a good time to overhaul the PHP client.
&gt;&gt;
&gt;&gt; Goals
&gt;&gt;
&gt;&gt; - Add support for Protocol Buffers
&gt;&gt; - Add support for new Riak 1.0 features (2i, pr, pw, client\\_id, etc)
&gt;&gt; - Add performance benchmarks
&gt;&gt; - Improve network performance
&gt;&gt; - Improve tests
&gt;&gt; - Add support for streaming results
&gt;&gt; - Add automatic read-before-write
&gt;&gt; - Add support for retries and sibling resolution
&gt;&gt; - Discourage expensive operations by throwing warnings
&gt;&gt;
&gt;&gt; I also think it's time the client required PHP 5.3+
&gt;&gt;
&gt;&gt; - Namespacing for better class organization
&gt;&gt; - Late static binding for looser coupling and greater extensibility
&gt;&gt; - Anonymous functions for inline retries and sibling resolution
&gt;&gt;
&gt;&gt; Is there anyone using PHP 5.2 in production with Riak that hasn't upgraded
&gt;&gt; to PHP 5.3?
&gt;&gt;
&gt;&gt;
&gt;&gt; - Kev
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

