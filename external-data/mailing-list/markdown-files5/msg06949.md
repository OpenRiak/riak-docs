---
title: "Re: preflist_exhausted with map-reduce and riak-js"
description: ""
project: community
lastmod: 2012-03-13T18:17:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06949"
mailinglist_parent_id: "msg06945"
author_name: "Matthew Tovbin"
project_section: "mailinglistitem"
sent_date: 2012-03-13T18:17:57-07:00
---


Hi,

I got the same problem today on 1.1.0.

As suggested, I updated all the nodes to 1.1.1. The error remains the same:

{ stack: [Getter/Setter],
 arguments: undefined,
 type: undefined,
 message: 'HTTP error 500:
{"phase":0,"error":"[preflist\\_exhausted]","input":"{ok,{r\\_object ....."}}}


-Matthew



On Tue, Mar 13, 2012 at 06:48, Jon Meredith  wrote:

&gt; Hi Arne,
&gt;
&gt; Could you try with 1.1.1 please. We've fixed a number of bugs with how
&gt; MapReduce handles errors that could explain some of what you are seeing.
&gt;
&gt; Jon
&gt;
&gt;
&gt; On Tue, Mar 13, 2012 at 12:55 AM, Arne Claassen wrote:
&gt;
&gt;&gt; I'm running 1.1.0 built from source on Centos 6. I set up two nodes on
&gt;&gt; localhost following the instructions on the basho site for testing and
&gt;&gt; everything was going fine until i needed to fetch all items in a bucket.
&gt;&gt;
&gt;&gt; For this i was using node.js with riak-js and it's db.getAll call,which
&gt;&gt; from the debug logs looks like it uses /mapred
&gt;&gt;
&gt;&gt; The bucket only has about 1200 items in it, each a json payload of about
&gt;&gt; 3KB. Initially, it'd keep getting inconsistent results, sometimes the data
&gt;&gt; would come back, sometimes data would be undefined. So i kept running it,
&gt;&gt; trying to see if there was a pattern, adding more debugging code, etc. But
&gt;&gt; still it would be about a request every couple of seconds. Then it just
&gt;&gt; stopped working altogether and now i always get:
&gt;&gt;
&gt;&gt; { [Error: HTTP error 500:
&gt;&gt; {"phase":0,"error":"[preflist\\_exhausted]","input":"{ok,{r\\_object,&lt;&lt;\\"tweets\\_15368536\\"&gt;&gt;,&lt;&lt;\\"178528155714330620\\"&gt;&gt;,[{r\\_content,{dict,6,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[[&lt;&lt;\\"Links\\"&gt;&gt;]],[],[],[],[],[],[],[],[[&lt;&lt;\\"content-type\\"&gt;&gt;,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110],[&lt;&lt;\\"X-Riak-VTag\\"&gt;&gt;,49,76,115,54,70,75,74,71,119,65,111,70,88,73,117,84,98,88,79,69,52,116]],[[&lt;&lt;\\"index\\"&gt;&gt;]],[],[[&lt;&lt;\\"X-Riak-Last-Modified\\"&gt;&gt;|{1331,487523,218968}]],[],[[&lt;&lt;\\"X-Riak-Meta\\"&gt;&gt;]]}}},&lt;&lt;\\"{\\"coordinates\\":null,\\"create...\\"&gt;&gt;}],...},...}","type":"forward\\_preflist","stack":"[]"}]
&gt;&gt; statusCode: 500 }
&gt;&gt;
&gt;&gt; in the console. I haven't tried restarting riak, just because i'd rather
&gt;&gt; find out what's happening than it going away and coming back later when i
&gt;&gt; don't expect it.
&gt;&gt;
&gt;&gt; Any suggestions on how to troubleshoot this? I can still access items
&gt;&gt; individually and i can even list the keys via ?keys=true, it's just he map
&gt;&gt; reduce that seems to be busted.
&gt;&gt;
&gt;&gt; cheers,
&gt;&gt; arne
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Jon Meredith
&gt; Platform Engineering Manager
&gt; Basho Technologies, Inc.
&gt; jmered...@basho.com
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

