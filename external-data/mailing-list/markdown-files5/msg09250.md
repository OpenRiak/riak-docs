---
title: "Re: if_not_modified"
description: ""
project: community
lastmod: 2012-11-08T11:19:50-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09250"
mailinglist_parent_id: "msg09249"
author_name: "Elias Levy"
project_section: "mailinglistitem"
sent_date: 2012-11-08T11:19:50-08:00
---


Sean,

Thanks for the explanation.

One last follow up. During testing I noticed that when using
if\\_not\\_modified against a test cluster with a node using the PB interface
and the Ruby client, if the bucket had an n\\_val greater than the number of
nodes, the put would fail with 'modified' error, even when you use a W, DW,
and PW of 1.

Presumably this is because the internal get performed by the
if\\_not\\_modified check within Riak uses the default R value, which is
quorum, so if the default n\\_val of 3 is used, it expect at least 2 replies,
whereas there is only one node available. Thus the get will fail.

While a failure may be expected in this situation, the fact that is comes
back as a stale write error is confusing, as the data is not really stale.


On Thu, Nov 8, 2012 at 10:48 AM, Sean Cribbs  wrote:

&gt; Elias,
&gt;
&gt; The resulting strategy of allow\\_mult=false and last\\_write\\_wins=false
&gt; (which is a simplification for developer-friendliness mostly):
&gt;
&gt; 1) Resolve differences using the vector clock first.
&gt; 2) If siblings still exist, return the one with the latest timestamp.
&gt;
&gt; So in a sense, it's a combination of vector-clock resolution and
&gt; resolution by timestamp. This might be ok if your write rate is small,
&gt; meaning that writes are unlikely to conflict; the upshot is that you
&gt; don't have to worry about resolution. However, in general we suggest
&gt; developers think about resolution strategies during development and
&gt; then use allow\\_mult=true in production.
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

