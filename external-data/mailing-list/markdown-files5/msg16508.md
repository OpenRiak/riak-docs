---
title: "Moving the anti-entropy directory (riak 1.4)"
description: ""
project: community
lastmod: 2015-09-11T03:46:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16508"
author_name: "Sujay Mansingh"
project_section: "mailinglistitem"
sent_date: 2015-09-11T03:46:40-07:00
---


On our riak cluster machines, we have a separate disk which stores all the
bitcask data (in /data)

This is so that we can have a (relatively) small disk for the OS, and have
a big disk for /data.

$ df -h / /data
Filesystem Size Used Avail Use% Mounted on
/dev/root 20G 11G 7.9G 57% /
/dev/md3 3.6T 277G 3.1T 9% /data

However, especially more so lately, we see that the /var/lib/riak directory
often becomes very large.

$ pwd
/var/lib/riak
$ du -hcs \\*
9.3G anti\\_entropy
1.1M kv\\_vnode
104K ring
9.3G total

So we see that the anti\\_entropy directory takes up 9.3GB (almost half of /).
(Sometimes it balloons to 18GB, almost taking up the disk. We then restart
riak to get the disk usage down.)

I want to move that directory off /.

Here are the steps I want to perform on each node.

 1. Stop riak
 2. Move /data to /riak/data (I will have to change the name of the mount
 point)
 3. Move /var/lib/riak/anti\\_entropy to /riak/anti\\_entropy
 4. Change the following items in app.config
 - Change {anti\\_entropy\\_data\\_dir, "/var/lib/riak/anti\\_entropy"},
to {anti\\_entropy\\_data\\_dir,
 "/riak/anti\\_entropy"},
 - Change {data\\_root, "/data"} to {data\\_root, "/riak/data"}
 5. Start riak

I just wanted to confirm that if I move the files and change the config,
riak will simply start up and continue as before.

Thanks!

Sujay
â€‹
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

