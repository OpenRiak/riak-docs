---
title: "Re: Write Timeout"
description: ""
project: community
lastmod: 2013-11-26T22:48:43-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13103"
mailinglist_parent_id: "msg13073"
author_name: "Andrew Tynefield"
project_section: "mailinglistitem"
sent_date: 2013-11-26T22:48:43-08:00
---


Hey guys,

Sorry for the bump, but, I'm kind of at a loss on how to troubleshoot this
further. In addition to all the previously mentioned stuff, I have since
left the cluster on riak1, deleted that VM, completely reprovisioned it and
the exact same issues are occurring. Please let me know if there's anything
else I can provide to help anyone help me.

Thanks,
Andrew


On Sat, Nov 23, 2013 at 2:14 PM, Andrew Tynefield wrote:

&gt; Hey guys,
&gt;
&gt; I'm encountering a timeout when attempting a write using `riak-admin test`.
&gt;
&gt; (02:01:08) [riak1] ~ $ time riak-admin test
&gt;
&gt; Failed to write test value: {error,timeout}
&gt;
&gt; real 1m1.561s
&gt; user 0m0.325s
&gt; sys 0m0.103s
&gt;
&gt; (02:02:39) [riak1] ~ $
&gt;
&gt;
&gt; This is one node of a 4 node cluster. The other nodes all work perfectly
&gt; fine when attempting this. What I also find very weird is that this node
&gt; was the second node to be created, nodes created after it (riak{2,3})
&gt; complete their tests fine and do not appear to have any issues.
&gt;
&gt; vm.args and app.config are generated by puppet and are used with identical
&gt; values (except for the node name) by all nodes.
&gt;
&gt; Values of note may be:
&gt; {pb\\_backlog, 128},
&gt; {ring\\_creation\\_size, 256},
&gt;
&gt;
&gt; I've also tried leaving the cluster from this node, waiting for the ring
&gt; to re-stabilize and show it successfully leaving. I then removed the entire
&gt; /var/lib/riak/\\*, started riak back up, rejoined the cluster. (Prior to
&gt; rejoining, I did a riak-admin test and it succeeded.)
&gt;
&gt; I've provided a tail of all the logs within /var/log/riak below
&gt; immediately proceeding the execution of the riak-admin test command.
&gt;
&gt; ==&gt; /var/log/riak/console.log &lt;==
&gt; 2013-11-23 13:45:53.597 [info]
&gt; &lt;0.157.0&gt;@riak\\_core\\_capability:process\\_capability\\_changes:530 New
&gt; capability: {riak\\_kv,anti\\_entropy} = enabled\\_v1
&gt; 2013-11-23 13:45:53.798 [info]
&gt; &lt;0.157.0&gt;@riak\\_core\\_capability:process\\_capability\\_changes:530 New
&gt; capability: {riak\\_kv,handoff\\_data\\_encoding} = encode\\_raw
&gt; 2013-11-23 13:45:54.187 [info]
&gt; &lt;0.157.0&gt;@riak\\_core\\_capability:process\\_capability\\_changes:530 New
&gt; capability: {riak\\_kv,object\\_format} = v1
&gt; 2013-11-23 13:45:54.405 [info]
&gt; &lt;0.157.0&gt;@riak\\_core\\_capability:process\\_capability\\_changes:530 New
&gt; capability: {riak\\_kv,secondary\\_index\\_version} = v2
&gt; 2013-11-23 13:45:54.683 [info]
&gt; &lt;0.157.0&gt;@riak\\_core\\_capability:process\\_capability\\_changes:530 New
&gt; capability: {riak\\_kv,vclock\\_data\\_encoding} = encode\\_zlib
&gt; 2013-11-23 13:45:55.066 [info]
&gt; &lt;0.157.0&gt;@riak\\_core\\_capability:process\\_capability\\_changes:530 New
&gt; capability: {riak\\_kv,crdt} = [pncounter]
&gt; 2013-11-23 13:45:56.141 [info]
&gt; &lt;0.157.0&gt;@riak\\_core\\_capability:process\\_capability\\_changes:530 New
&gt; capability: {riak\\_control,member\\_info\\_version} = v1
&gt; 2013-11-23 13:45:56.277 [info] &lt;0.7.0&gt; Application riak\\_control started on
&gt; node 'r...@riak1.tyne.io'
&gt; 2013-11-23 13:45:56.277 [info] &lt;0.7.0&gt; Application erlydtl started on node
&gt; 'r...@riak1.tyne.io'
&gt; 2013-11-23 13:46:11.607 [info] &lt;0.538.0&gt;@riak\\_core:wait\\_for\\_service:464
&gt; Wait complete for service riak\\_kv (14 seconds)
&gt;
&gt; ==&gt; /var/log/riak/crash.log &lt;==
&gt; 2013-11-23 02:01:43 =ERROR REPORT====
&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1444374665018431399630985401082889078019339583488/33.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43 =ERROR REPORT====
&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1375866775768545325340187674549313311472967745536/29.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43 =ERROR REPORT====
&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1124671181852296386273929343926202167469604339712/42.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43 =ERROR REPORT====
&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1421538701935136041534052825571697155837215637504/30.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43 =ERROR REPORT====
&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1330194849601954609146322523526929467108719853568/35.bitcask.hint'
&gt; invalid
&gt;
&gt; ==&gt; /var/log/riak/error.log &lt;==
&gt; 2013-11-23 02:01:43.869 [error] &lt;0.2775.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1353030812685249967243255099038121389290843799552/15.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.869 [error] &lt;0.2723.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1261686960352068534855524796993353700562348015616/34.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.869 [error] &lt;0.2593.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1170343108018887102467794494948586011833852231680/27.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.869 [error] &lt;0.2623.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1216015034185477818661659645970969856198100123648/37.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.870 [error] &lt;0.2704.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1238850997268773176758592221482161778380224069632/33.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.870 [error] &lt;0.2855.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1444374665018431399630985401082889078019339583488/33.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.870 [error] &lt;0.2805.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1375866775768545325340187674549313311472967745536/29.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.870 [error] &lt;0.2561.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1124671181852296386273929343926202167469604339712/42.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.870 [error] &lt;0.2823.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1421538701935136041534052825571697155837215637504/30.bitcask.hint'
&gt; invalid
&gt; 2013-11-23 02:01:43.871 [error] &lt;0.2759.0&gt; Hintfile
&gt; '/var/lib/riak/bitcask/1330194849601954609146322523526929467108719853568/35.bitcask.hint'
&gt; invalid
&gt;
&gt; ==&gt; /var/log/riak/run\\_erl.log &lt;==
&gt; run\\_erl [2259] Sat Nov 23 13:45:49 2013
&gt; Args before exec of shell:
&gt; run\\_erl [2259] Sat Nov 23 13:45:49 2013
&gt; argv[0] = sh
&gt; run\\_erl [2259] Sat Nov 23 13:45:49 2013
&gt; argv[1] = -c
&gt; run\\_erl [2259] Sat Nov 23 13:45:49 2013
&gt; argv[2] = exec /usr/sbin/riak console
&gt;
&gt;
&gt;
&gt; Here's some information about the installation and cluster:
&gt;
&gt; (02:04:36) [riak1] ~ $ riak version
&gt; 1.4.2
&gt;
&gt; (02:08:07) [riak1] ~ $ riak-admin ringready
&gt; TRUE All nodes agree on the ring ['r...@riak.tyne.io','r...@riak1.tyne.io
&gt; ',
&gt; 'r...@riak2.tyne.io','r...@riak3.tyne.io
&gt; ']
&gt;
&gt; (02:07:31) [riak1] ~ $ riak-admin member-status
&gt; ================================= Membership
&gt; ==================================
&gt; Status Ring Pending Node
&gt;
&gt; -------------------------------------------------------------------------------
&gt; valid 25.0% -- 'r...@riak.tyne.io'
&gt; valid 25.0% -- 'r...@riak1.tyne.io'
&gt; valid 25.0% -- 'r...@riak2.tyne.io'
&gt; valid 25.0% -- 'r...@riak3.tyne.io'
&gt;
&gt; -------------------------------------------------------------------------------
&gt; Valid:4 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt;
&gt;
&gt; Touch test:
&gt;
&gt; (02:07:00) [riak1] ~ $ for dir in /var/lib/riak/\\*/; do touch $dir/test;
&gt; stat $dir/test; done
&gt; File: `/var/lib/riak/anti\\_entropy//test'
&gt; Size: 0 Blocks: 0 IO Block: 4096 regular empty file
&gt; Device: 802h/2050d Inode: 1704796 Links: 1
&gt; Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)
&gt; Access: 2013-11-23 14:07:31.284244924 -0600
&gt; Modify: 2013-11-23 14:07:31.284244924 -0600
&gt; Change: 2013-11-23 14:07:31.284244924 -0600
&gt; File: `/var/lib/riak/bitcask//test'
&gt; Size: 0 Blocks: 0 IO Block: 4096 regular empty file
&gt; Device: 802h/2050d Inode: 1705089 Links: 1
&gt; Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)
&gt; Access: 2013-11-23 14:07:31.310243834 -0600
&gt; Modify: 2013-11-23 14:07:31.310243834 -0600
&gt; Change: 2013-11-23 14:07:31.310243834 -0600
&gt; File: `/var/lib/riak/kv\\_vnode//test'
&gt; Size: 0 Blocks: 0 IO Block: 4096 regular empty file
&gt; Device: 802h/2050d Inode: 1705150 Links: 1
&gt; Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)
&gt; Access: 2013-11-23 14:07:31.316243674 -0600
&gt; Modify: 2013-11-23 14:07:31.316243674 -0600
&gt; Change: 2013-11-23 14:07:31.316243674 -0600
&gt; File: `/var/lib/riak/leveldb//test'
&gt; Size: 0 Blocks: 0 IO Block: 4096 regular empty file
&gt; Device: 802h/2050d Inode: 1705153 Links: 1
&gt; Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)
&gt; Access: 2013-11-23 14:07:31.322243576 -0600
&gt; Modify: 2013-11-23 14:07:31.322243576 -0600
&gt; Change: 2013-11-23 14:07:31.322243576 -0600
&gt; File: `/var/lib/riak/ring//test'
&gt; Size: 0 Blocks: 0 IO Block: 4096 regular empty file
&gt; Device: 802h/2050d Inode: 1705154 Links: 1
&gt; Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)
&gt; Access: 2013-11-23 14:07:31.326243490 -0600
&gt; Modify: 2013-11-23 14:07:31.326243490 -0600
&gt; Change: 2013-11-23 14:07:31.326243490 -0600
&gt;
&gt;
&gt; Any help would be greatly appreciated!
&gt;
&gt; Thanks,
&gt; Andrew
&gt;
&gt; --
&gt; [Andrew Tynefield]
&gt;



-- 
[Andrew Tynefield]
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

