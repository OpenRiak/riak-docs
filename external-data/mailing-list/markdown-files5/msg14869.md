---
title: "Re: [ANN] Kria 0.1.14, an async Clojure Client for Riak 2.0.0.rc1"
description: ""
project: community
lastmod: 2014-09-05T10:22:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14869"
mailinglist_parent_id: "msg14549"
author_name: "David James"
project_section: "mailinglistitem"
sent_date: 2014-09-05T10:22:05-07:00
---


I just got around to using the Maven protobuf files instead of using a
local copy. Much easier! Thanks for mentioning this, Sean.


On Thu, Jul 24, 2014 at 3:48 PM, David James  wrote:

&gt; Thanks for the feedback!
&gt;
&gt; I'll take a look at the Maven Central .proto files.
&gt;
&gt; I started Kria before the new Java client was very far along. I'm glad it
&gt; now supports async operation. I'll try to take a look. I have had mixed
&gt; experiences in wrapping Java libraries. I found many hard to understand
&gt; because of their size and complexity.
&gt;
&gt; Kria supports the Riak Protocol API and is meant to be low-level. It does
&gt; not support the "Additional features" mentioned on
&gt; http://docs.basho.com/riak/2.0.0/dev/using/libraries/. It only has three
&gt; dependencies: Java 7 (for NIO.2), Clojure 1.6, and Protocol Buffers. I
&gt; intentionally avoided Netty because I didn't need the complexity. Kria does
&gt; this in about 2,000 lines of Clojure: 1400 lines of implementation plus
&gt; about 600 lines of tests. The Java library has about 20,000 lines of code.
&gt; I spent considerable time driving out duplication, and I'd like to think it
&gt; makes the code easier to read and more reliable.
&gt;
&gt; Lastly, writing Kria helped me find some strange (e.g. probably
&gt; unintentional) re-use of message codes in Riak:
&gt; https://github.com/basho/riak-java-client/issues/367
&gt;
&gt;
&gt; On Wed, Jul 23, 2014 at 2:59 PM, Sean Cribbs  wrote:
&gt;
&gt;&gt; David,
&gt;&gt;
&gt;&gt; Thanks for contributing to the Riak ecosystem! A few notes:
&gt;&gt;
&gt;&gt; Looking over your README, I see you're probably doing some unnecessary
&gt;&gt; work with respect to the .proto files [1]. We generate, package, and deploy
&gt;&gt; all of those on Maven Central [2] specifically so others can use them as
&gt;&gt; you have, while maintaining the authenticity of the code (it comes from us)
&gt;&gt; and reducing duplication (not N copies everywhere).
&gt;&gt;
&gt;&gt; I don't want to bikeshed it (you obviously have your reasons), but it
&gt;&gt; bears mentioning that the new official Java client is designed so that it
&gt;&gt; would be easier to write wrapper libraries in other JVM languages, and to
&gt;&gt; give the user the option of async or sync at the API level.
&gt;&gt;
&gt;&gt; [1] https://github.com/bluemont/kria#protocol-buffer-setup
&gt;&gt; [2] https://search.maven.org/#search%7Cga%7C1%7Ca%3A%22riak-pb%22
&gt;&gt;
&gt;&gt;
&gt;&gt; On Wed, Jul 23, 2014 at 1:31 PM, David James 
&gt;&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; The latest version of Kria, 0.1.14, supports Riak 2.0.0rc1. Kria (a
&gt;&gt;&gt; right rotation of "Riak") is an open source asynchronous Clojure driver for
&gt;&gt;&gt; Riak 2.0 built on top of Java 7's NIO.2. It uses the Riak protocol buffer
&gt;&gt;&gt; interface.
&gt;&gt;&gt;
&gt;&gt;&gt; https://github.com/bluemont/kria
&gt;&gt;&gt; https://clojars.org/kria
&gt;&gt;&gt;
&gt;&gt;&gt; There are, of course, several Riak drivers for Java and Clojure. I hope
&gt;&gt;&gt; some people find this one useful. I have a section in the README about why
&gt;&gt;&gt; I made it. To summarize, I wanted async support, and the Java driver wasn't
&gt;&gt;&gt; quite what I wanted.
&gt;&gt;&gt;
&gt;&gt;&gt; Please kick the tires.
&gt;&gt;&gt;
&gt;&gt;&gt; In my work projects, Clojure's core.async works great as a layer on top
&gt;&gt;&gt; of Kria. Just create a core.async channel in advance and have the callback
&gt;&gt;&gt; put the desired return value in the core.async channel. (You could also use
&gt;&gt;&gt; Clojure atoms or promises; Kria doesn't care.)
&gt;&gt;&gt;
&gt;&gt;&gt; -David
&gt;&gt;&gt;
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sean Cribbs 
&gt;&gt; Software Engineer
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

