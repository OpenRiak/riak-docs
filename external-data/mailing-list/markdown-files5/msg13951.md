---
title: "Proposal for chunked storage (related to Lowlevel Access to RiakCS	objects)"
description: ""
project: community
lastmod: 2014-03-29T04:55:24-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13951"
author_name: "Timo Gatsonides"
project_section: "mailinglistitem"
sent_date: 2014-03-29T04:55:24-07:00
---



Related to the recent thread about "Lowlevel Access to RiakCS objects" I plan 
to implement an extension to a Riak Object (in the Golang driver at 
https://github.com/tpjg/goriakpbc) that will cover two use cases:
1) storing larger files directly in Riak (not Riak CS)
2) store growing files, e.g. log files, efficiently in Riak

I have some questions for the Riak community. First: am I about to re-invent a 
wheel and if so can someone please point me to an example implementation?

If not I would like to know if there is more interest and maybe more use cases 
so we can develop a standard way to store these objects in Riak, allowing 
access from multiple programming languages. If there is, please read the 
proposal below and provide feedback.

Store the meta-information about a “BigObject” in a regular Riak value. This 
object will be stored in  , . The object will have the following 
meta tags:
- segment\\_size - size of each segment in bytes
- segment\\_count - the number of segments of the object
- total\\_size - optional total size of the entire object (see below).

The objects data would be stored in segments in , . The 
Content-Type would be the same for all objects. Depending on the use case 
total\\_size could be filled.

Using the two use cases above as an example:
1) storing large files, e.g. video: use a large segment\\_size, e.g. 1Mb and 
store the total\\_size since the file will be static and the meta-information can 
be written at once
2) store growing files, e.g. daily log files: use a smaller segment\\_size, e.g. 
10Kb-100Kb, do not store total\\_size as otherwise each “Append” operation would 
require two PUTs. If a segment grows beyond the segment\\_size update the 
meta-information K/V, otherwise only PUT the last segment again. In the 
extension to a client driver a BigObject would store some state information 
that keeps track of the meta-information K/V and the last segment to make the 
Append operation somewhat efficient - note though that each append is 
overwriting the last segment.

Any input is highly appreciated.

Kind regards,
Timo

 



smime.p7s
Description: S/MIME cryptographic signature
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

