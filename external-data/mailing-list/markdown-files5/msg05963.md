---
title: "Re: Secondary Index Query across multiple buckets"
description: ""
project: community
lastmod: 2011-12-15T08:42:26-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05963"
mailinglist_parent_id: "msg05961"
author_name: "Rusty Klophaus"
project_section: "mailinglistitem"
sent_date: 2011-12-15T08:42:26-08:00
---


Hi Jeremy,

Yes, in this scenario, a single query under a large bucket will be faster,
for all of the reasons that you mentioned... connection setup/teardown,
query processing overhead, and seeking to/reading index information from
disk.

Best,
Rusty

On Thu, Dec 15, 2011 at 11:07 AM, Jeremy Raymond wrote:

&gt; Thanks Rusty. What would perform better, running multiple queries across
&gt; several buckets or a single query under one large one? I'd guess the later
&gt; because of whatever overhead is involved in setting up the connection to
&gt; Riak and whatever Riak does to setup and run a mapred/index query.
&gt;
&gt; --
&gt; Jeremy
&gt;
&gt;
&gt;
&gt; On Thu, Dec 15, 2011 at 10:59 AM, Rusty Klophaus  wrote:
&gt;
&gt;&gt; Hi Jeremy,
&gt;&gt;
&gt;&gt; Currently, Secondary Indexes are scoped per bucket. There is no good way
&gt;&gt; to run a Secondary Index query across multiple buckets, short of running
&gt;&gt; multiple queries.
&gt;&gt;
&gt;&gt; You are correct in that you could store the items in a single bucket
&gt;&gt; provided that they all have unique keys. In the LevelDB backend (and most
&gt;&gt; backends), buckets are a logical separation, not a physical separation, so
&gt;&gt; either approach will use the same amount of resources. (The Innostore
&gt;&gt; backend is the exception to this rule, it splits buckets into separate
&gt;&gt; files.)
&gt;&gt;
&gt;&gt; Best,
&gt;&gt; Rusty
&gt;&gt;
&gt;&gt; On Thu, Dec 15, 2011 at 8:29 AM, Jeremy Raymond wrote:
&gt;&gt;
&gt;&gt;&gt; Let me pose the question a different way. What is a good way to pull out
&gt;&gt;&gt; objects across multiple buckets based upon some secondary data that is not
&gt;&gt;&gt; their key?
&gt;&gt;&gt;
&gt;&gt;&gt; The items in the buckets all have unique keys. Maybe move them all into
&gt;&gt;&gt; a single bucket (millions of items) and then I could use secondary indexes
&gt;&gt;&gt; to pull the find them?
&gt;&gt;&gt;
&gt;&gt;&gt; If the keys of my objects are unique does organizing them into buckets
&gt;&gt;&gt; really gain me anything over just putting them all in a single bucket and
&gt;&gt;&gt; using secondary indexes to find them?
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Jeremy
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Sat, Dec 10, 2011 at 2:05 PM, Jeremy Raymond wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Is it possible to run an index query across multiple buckets at once?
&gt;&gt;&gt;&gt; Something similar to how you can feed a map query with bucket/key pairs,
&gt;&gt;&gt;&gt; I'm looking to run an index query with bucket/index pairs.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt; Jeremy
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Rusty Klophaus (@rustyio)
&gt;&gt; \\*Basho Technologies, Inc.\\*
&gt;&gt; www.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;


-- 
Rusty Klophaus (@rustyio)
\\*Basho Technologies, Inc.\\*
www.basho.com
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

