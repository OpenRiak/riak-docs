---
title: "Re: EC2 and node names"
description: ""
project: community
lastmod: 2011-05-04T09:38:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03218"
mailinglist_parent_id: "msg03210"
author_name: "Jeff Pollard"
project_section: "mailinglistitem"
sent_date: 2011-05-04T09:38:44-07:00
---


Grant,

Thanks for the info, that makes total sense.

On Tue, May 3, 2011 at 10:52 AM, Grant Schofield  wrote:

&gt; On May 3, 2011, at 12:35 PM, Jeff Pollard wrote:
&gt;
&gt; Grant,
&gt;
&gt; Thanks for the reply. I think I understand what you're saying, but it's
&gt; not 100% clear to me how exactly it applies to my question. I'll try
&gt; explaining my plan another way if that helps.
&gt;
&gt; Imagine we have 4 nodes running in a ring on EC2: riak@10.5.0.1,
&gt; riak@10.5.0.2, riak@10.5.0.3, riak@10.5.0.4. Then one day node
&gt; riak@10.5.0.3 goes down and is unrecoverable. Our plan had been:
&gt;
&gt; # On a existing node in the cluster
&gt; riak-admin remove riak@10.5.0.3
&gt; riak-admin ringready
&gt; # .. wait for TRUE
&gt;
&gt; # Boot a new EC2 machine configured as riak@10.5.0.5 (brand new IP)
&gt; # Then on that new machine...
&gt; riak start
&gt; riak-admin join riak@10.5.0.1
&gt; riak-admin ringready
&gt; # .. wait for TRUE
&gt;
&gt; In that scenario, I imagine the issue is that removing and adding a new
&gt; node under a new node name is putting extra strain on the cluster to shift
&gt; data around? Simply replacing a new node under the same hostname (even
&gt; though it has a different IP) would mean less work for the cluster? And how
&gt; much extra work are
&gt;
&gt;
&gt; You're correct in assuming that there is extra strain on the cluster moving
&gt; that data around, but the amount of that churn will depend on how much data
&gt; you have in your Riak cluster and your use case. Removing and adding a node
&gt; is a great way to replace a broken node, but if you have a large amount of
&gt; data it might be quicker and load the cluster less to replace the broken
&gt; node with a node that has the same hostname or IP and the old nodes data
&gt; directory.
&gt;
&gt; If riak@10.5.0.3 dies due to a disk problem and your backups won't contain
&gt; the data you would need to replace the node as you described. The best
&gt; solution for replacing a dead node will vary based on circumstances, your
&gt; use case, and your availability needs.
&gt;
&gt; Grant
&gt;
&gt;
&gt;
&gt; Thanks!
&gt;
&gt; On Tue, May 3, 2011 at 6:24 AM, Grant Schofield  wrote:
&gt;
&gt;&gt;
&gt;&gt; On May 2, 2011, at 7:58 PM, Jeff Pollard wrote:
&gt;&gt;
&gt;&gt; I was reviewing the Riak Operations 
&gt;&gt; webinar,
&gt;&gt; and it was mentioned that the preferred vm.args -name for EC2 environments
&gt;&gt; should be "riak@hostname" because you don't have to "rename data or do
&gt;&gt; anything weird" like you would if your nodes were named "riak@ip.address"
&gt;&gt; (approximately 40:05 in the video).
&gt;&gt;
&gt;&gt; I was looking for some elaboration on this tip, namely:
&gt;&gt;
&gt;&gt; 1. What is meant by "rename data or do anything weird"
&gt;&gt;
&gt;&gt; When you bring a cluster together using data copied from a different set
&gt;&gt; of nodes you need to re-ip the first node you plan to start but you also
&gt;&gt; have to change the ring manually on that node so when the subsequent nodes
&gt;&gt; join everything works properly.
&gt;&gt;
&gt;&gt;
&gt;&gt; 1. Is "hostname" in riak@hostname a public DNS host that you configure
&gt;&gt; in your DNS to map to the EC2 public hostname (ec2-50-18-...)?
&gt;&gt;
&gt;&gt; You can use DNS (public or private) or host file entries that reference
&gt;&gt; the private IP of the node if you choose to use hostname.
&gt;&gt;
&gt;&gt;
&gt;&gt; 1. Does anyone have any best practices around vm.args -name in EC2
&gt;&gt; environments?
&gt;&gt;
&gt;&gt; We haven't outlined any best practices ourselves, but I tend to believe
&gt;&gt; using a hostname that you can change the IP for via DNS or a hosts file is a
&gt;&gt; more flexible way of approaching the problem.
&gt;&gt;
&gt;&gt; Grant
&gt;&gt;
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

