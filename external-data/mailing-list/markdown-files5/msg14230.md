---
title: "The best (fastest) way to delete/clear a bucket [python]"
description: ""
project: community
lastmod: 2014-05-19T05:55:33-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14230"
author_name: "Paweł Królikowski"
project_section: "mailinglistitem"
sent_date: 2014-05-19T05:55:33-07:00
---


Hi,

For testing, I'd like to be able to throw a large number of data at Riak
(100k+ entries), check how it performed, change something in the
application, run the test again. I'd like to use the same data every time,
so, I'd like to clear the bucket between every test.

The documentation (
http://docs.basho.com/riak/2.0.0beta1/dev/references/http/) says:

\\*Delete Buckets\\*
There is no straightforward way to delete an entire Bucket. To delete all
the keys in a bucket, you’ll need to delete them all individually.


So, I'm currently using something like:

for k in r\\_bk.get\\_keys():
v = r\\_bk.get(k)
 if v.exists:
r\\_bk.delete(v)

The problem is that r\\_bk.get\\_keys() returns a lot of elements that don't
exist (tombstones?) and iterating over all of them takes time.

Is that the way it's supposed to work? Or am I missing something?

- I'm using default delete\\_mode configuration ( 3 seconds )
- I'm using Riak 2.0 alpha 19 with Python. ( there's a bug with strong
consistency in Beta1, cannot use it)
- changing the bucket name for every run seems .. impractical?

Any advices welcomed,

--
Thanks,
Paweł
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

