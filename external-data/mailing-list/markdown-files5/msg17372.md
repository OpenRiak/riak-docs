---
title: "Re: Querying SOLR outside of Riak"
description: ""
project: community
lastmod: 2016-05-16T08:05:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17372"
mailinglist_parent_id: "msg17370"
author_name: "Jean Chassoul"
project_section: "mailinglistitem"
sent_date: 2016-05-16T08:05:21-07:00
---


Hi Luke,

great advice, reminds me of what Joe Armstrong say from time to time:
measure don't guess.

(=

On Mon, May 16, 2016 at 7:55 AM, Luke Bakken  wrote:

&gt; Hi Alex,
&gt;
&gt; Benchmarking is the only sure way to know if you need to add this
&gt; additional complexity to your system for your own use-case or if
&gt; search in Riak 2.0 will suffice. I suspect the latter will be true.
&gt;
&gt; --
&gt; Luke Bakken
&gt; Engineer
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Mon, May 16, 2016 at 6:08 AM, Alex De la rosa
&gt;  wrote:
&gt; &gt; Hi Fred,
&gt; &gt;
&gt; &gt; Yeah, I realised that on my testing node with n\\_val of 3 I was getting
&gt; the
&gt; &gt; triple of results in the count... that is not ideal.
&gt; &gt;
&gt; &gt; I was just concerned on how much extra-work would get Riak to talk with
&gt; SOLR
&gt; &gt; and compile data against hitting SOLR directly... For my tests these
&gt; days,
&gt; &gt; seems the /search interface is pretty fast and it may not be a real
&gt; problem
&gt; &gt; for Riak... but still have my fears from Riak 0.14 an Riak 1.4
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Alex
&gt; &gt;
&gt; &gt; On Mon, May 16, 2016 at 4:49 PM, Fred Dushin  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Hi Alex,
&gt; &gt;&gt;
&gt; &gt;&gt; Other people have chimed in, but let me repeat that while the
&gt; &gt;&gt; internal\\_solr interface is accessible via HTTP (and needs to be, at
&gt; least
&gt; &gt;&gt; from Riak processes), you cannot use that interface to query Solr and
&gt; expect
&gt; &gt;&gt; a correct result set (unless you are using a single node cluster with an
&gt; &gt;&gt; n\\_val of 1).
&gt; &gt;&gt;
&gt; &gt;&gt; When you run your queries through Riak, Yokozuna, the component that
&gt; &gt;&gt; interfaces with Solr, will use a riak\\_core coverage plan to generate a
&gt; &gt;&gt; distributed Solr filter query across the entire cluster that guarantees
&gt; that
&gt; &gt;&gt; for any document stored on all Solr nodes in the cluster, the query will
&gt; &gt;&gt; select one (and only one) replica. If you were to run your query
&gt; locally
&gt; &gt;&gt; using the internal\\_solr interface, your query would not span the cluster
&gt; &gt;&gt; (likely missing documents on other nodes) and may have duplicates
&gt; (e.g., in
&gt; &gt;&gt; degenerate cases where you have more than one replica on the same node).
&gt; &gt;&gt;
&gt; &gt;&gt; I hope that helps explain why using the internal\\_solr interface is not
&gt; &gt;&gt; only not recommended, it's also not going to give you the results you
&gt; &gt;&gt; expect.
&gt; &gt;&gt;
&gt; &gt;&gt; -Fred
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

