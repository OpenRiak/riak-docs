---
title: "Re: multi datacenter replication"
description: ""
project: community
lastmod: 2013-05-13T17:22:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11064"
mailinglist_parent_id: "msg11063"
author_name: "Patrick Christopher"
project_section: "mailinglistitem"
sent_date: 2013-05-13T17:22:15-07:00
---


Hi Adron,
Thanks for the reply!

The architectural thought that you pose is the idea I'm going for but
having riak do all of the replication, not a new client. The model would
be:
 - single riak cluster
 - bucket a replicates to data center remoteA
 - bucket b replicates to data center remoteB
 - remoteB will never access data from a
 - remoteA will never access data from b

Does riak support that? I've not seen any database that supports that
model on its own.

Pat


On Mon, May 13, 2013 at 12:42 PM, Adron Hall  wrote:

&gt; Hey Pat,
&gt;
&gt; A few answers, thoughts and questions.
&gt;
&gt; 1. Each bucket allows (if after v1.1/1.2) replication. In 1.1 and above
&gt; there is a repl value that accepts a true or false value. True turns on
&gt; realtime and fullsync abilities. In 1.2 above has additional boolean
&gt; parameters of realtime, fullsync, or both. Enabling the property via
&gt; command line:
&gt;
&gt; curl -v -XPUT -H "Content-Type: application/json" \\
&gt; -d '{"props":{"repl":true}}' \\
&gt; http://127.0.0.1:8091/riak/my\\_bucket
&gt;
&gt; 2. Running both styles of replication should be fine. They're on by
&gt; default to start. In the particular situation you describe - using realtime
&gt; on all the time should work well and then only using the fullsync when the
&gt; ship docks and connects at a higher speed - using something to trigger that.
&gt;
&gt; A few additional questions:
&gt;
&gt; - I recall we spoke about data sizes of 3-5k per ship, but then there
&gt; was all of the data that would go along with each client, could you provide
&gt; more elaboration around what count, sizes, connections to other elements
&gt; and related information data? Why type/pieces would need to go to each
&gt; ship, etc.
&gt; - For the connections to each ship during satellite link what does the
&gt; bandwidth, latency and other characteristics look like? Latency times of
&gt; 800, 1500, 6000 or possibly higher 8000, 10000?
&gt;
&gt; Another Architectural Thought:
&gt;
&gt; - One idea that stands out would be to use Riak as the primary cluster
&gt; but to implement a client that does replication itself specifically for a
&gt; bucket (or buckets). It seems like, from my understanding so far, that the
&gt; client might be the key mechanism to control any type of replication - with
&gt; or without MDC being used. Basically following a standard hub-and-spoke
&gt; server & client model.
&gt;
&gt; Hope that helps, cheers!
&gt;
&gt; -Adron
&gt;
&gt;
&gt;
&gt;
&gt; On Fri, May 10, 2013 at 9:45 AM, Patrick Christopher &lt;
&gt; pat.christop...@gmail.com&gt; wrote:
&gt;
&gt;&gt; Hi,
&gt;&gt; Iâ€™m working on an application that will be spread across many (150-200)
&gt;&gt; data centers. I had a great chat with Adron at the Seattle Riak Office
&gt;&gt; Hours and I think that Riak can provide the backbone of the solution.
&gt;&gt; Adron is a great help but I have come away with (or have come up with) two
&gt;&gt; more questions.
&gt;&gt;
&gt;&gt; 1. Does riak support specifying bucket level multi data center
&gt;&gt; replication? There is a single master data center that has all of the data,
&gt;&gt; and that central cluster replicates a single different bucket to each of
&gt;&gt; the remote data centers. Its a hub/spoke model where something at the hub
&gt;&gt; has a view of the full data set and something at a spoke end only has a
&gt;&gt; view of a single, unique bucket.
&gt;&gt;
&gt;&gt; 2. What would be the best way to setup a priority replication
&gt;&gt; strategy? There is always a link between the main dc and the spoke dcs,
&gt;&gt; but sometimes its a big fast link and we'd want to do a full replication
&gt;&gt; and sometimes its the equivalent of a 56k modem and we only want to
&gt;&gt; replicate time critical data. I think riak can handle this by using the
&gt;&gt; real-time sync for critical data and the full-sync for a full sync. Will
&gt;&gt; that work or is that asking for trouble running both styles?
&gt;&gt;
&gt;&gt;
&gt;&gt; And there was a small note in the 
&gt;&gt; docs
&gt;&gt; that
&gt;&gt; says, " ...there are two primary modes of operation..." are there other,
&gt;&gt; secondary modes of replication or is this me over-parsing the docs?
&gt;&gt;
&gt;&gt;
&gt;&gt; Thank you,
&gt;&gt;
&gt;&gt; Pat
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; \\*Adron B Hall\\*
&gt; Blog , Adron.Me , 
&gt; @adron
&gt; with Basho  @Basho 
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

