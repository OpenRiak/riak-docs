---
title: "Re: Python library: Error with counters"
description: ""
project: community
lastmod: 2014-08-17T12:18:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14682"
mailinglist_parent_id: "msg14678"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2014-08-17T12:18:05-07:00
---


Glad you figured it out, Alex. I'll make a note to update the README
about external packages that may be necessary.

On Sun, Aug 17, 2014 at 12:23 PM, Alex De la rosa
 wrote:
&gt; Murphy's law... as soon as I post it, as soon as I found why it failed... I
&gt; was missing the following libraries on my Ubuntu Server:
&gt;
&gt; aptitude install build-essential libssl-dev libffi-dev python-dev
&gt;
&gt; After this, the "cryptography" package got installed like a charm.
&gt;
&gt; Thanks!
&gt; Alex
&gt;
&gt;
&gt; On Sun, Aug 17, 2014 at 7:12 PM, Alex De la rosa 
&gt; wrote:
&gt;&gt;
&gt;&gt; Hi Sean,
&gt;&gt;
&gt;&gt; I tried to install version 2.1.0rc1 as you suggested, but "pip" gives a
&gt;&gt; compilation error and doesn't install it, here you have the log:
&gt;&gt;
&gt;&gt; # pip install riak==2.1.0rc1
&gt;&gt; Downloading/unpacking riak==2.1.0rc1
&gt;&gt; Downloading riak-2.1.0rc1.tar.gz (135kB): 135kB downloaded
&gt;&gt; Running setup.py (path:/tmp/pip\\_build\\_root/riak/setup.py) egg\\_info for
&gt;&gt; package riak
&gt;&gt;
&gt;&gt; Downloading/unpacking riak-pb&gt;=2.0.0 (from riak==2.1.0rc1)
&gt;&gt; Downloading riak\\_pb-2.0.0.16.tar.gz
&gt;&gt; Running setup.py (path:/tmp/pip\\_build\\_root/riak-pb/setup.py) egg\\_info
&gt;&gt; for package riak-pb
&gt;&gt;
&gt;&gt; Downloading/unpacking pyOpenSSL&gt;=0.14 (from riak==2.1.0rc1)
&gt;&gt; Downloading pyOpenSSL-0.14.tar.gz (128kB): 128kB downloaded
&gt;&gt; Running setup.py (path:/tmp/pip\\_build\\_root/pyOpenSSL/setup.py) egg\\_info
&gt;&gt; for package pyOpenSSL
&gt;&gt;
&gt;&gt; warning: no previously-included files matching '\\*.pyc' found anywhere
&gt;&gt; in distribution
&gt;&gt; no previously-included directories found matching 'doc/\\_build'
&gt;&gt; Requirement already satisfied (use --upgrade to upgrade):
&gt;&gt; protobuf&gt;=2.4.1,&lt;2.6.0 in /usr/local/lib/python2.7/dist-packages (from
&gt;&gt; riak-pb&gt;=2.0.0-&gt;riak==2.1.0rc1)
&gt;&gt; Downloading/unpacking cryptography&gt;=0.2.1 (from
&gt;&gt; pyOpenSSL&gt;=0.14-&gt;riak==2.1.0rc1)
&gt;&gt; Downloading cryptography-0.5.3.tar.gz (319kB): 319kB downloaded
&gt;&gt; Running setup.py (path:/tmp/pip\\_build\\_root/cryptography/setup.py)
&gt;&gt; egg\\_info for package cryptography
&gt;&gt; c/\\_cffi\\_backend.c:2:20: fatal error: Python.h: No such file or
&gt;&gt; directory
&gt;&gt; #include 
&gt;&gt; ^
&gt;&gt; compilation terminated.
&gt;&gt; Traceback (most recent call last):
&gt;&gt; File "", line 17, in 
&gt;&gt; File "/tmp/pip\\_build\\_root/cryptography/setup.py", line 174, in
&gt;&gt; 
&gt;&gt; "test": PyTest,
&gt;&gt; File "/usr/lib/python2.7/distutils/core.py", line 111, in setup
&gt;&gt; \\_setup\\_distribution = dist = klass(attrs)
&gt;&gt; File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line
&gt;&gt; 239, in \\_\\_init\\_\\_
&gt;&gt; self.fetch\\_build\\_eggs(attrs.pop('setup\\_requires'))
&gt;&gt; File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line
&gt;&gt; 264, in fetch\\_build\\_eggs
&gt;&gt; replace\\_conflicting=True
&gt;&gt; File "/usr/lib/python2.7/dist-packages/pkg\\_resources.py", line 620,
&gt;&gt; in resolve
&gt;&gt; dist = best[req.key] = env.best\\_match(req, ws, installer)
&gt;&gt; File "/usr/lib/python2.7/dist-packages/pkg\\_resources.py", line 858,
&gt;&gt; in best\\_match
&gt;&gt; return self.obtain(req, installer) # try and download/install
&gt;&gt; File "/usr/lib/python2.7/dist-packages/pkg\\_resources.py", line 870,
&gt;&gt; in obtain
&gt;&gt; return installer(requirement)
&gt;&gt; File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line
&gt;&gt; 314, in fetch\\_build\\_egg
&gt;&gt; return cmd.easy\\_install(req)
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 616, in easy\\_install
&gt;&gt; return self.install\\_item(spec, dist.location, tmpdir, deps)
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 646, in install\\_item
&gt;&gt; dists = self.install\\_eggs(spec, download, tmpdir)
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 834, in install\\_eggs
&gt;&gt; return self.build\\_and\\_install(setup\\_script, setup\\_base)
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 1040, in build\\_and\\_install
&gt;&gt; self.run\\_setup(setup\\_script, setup\\_base, args)
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 1028, in run\\_setup
&gt;&gt; raise DistutilsError("Setup script exited with %s" % (v.args[0],))
&gt;&gt; distutils.errors.DistutilsError: Setup script exited with error:
&gt;&gt; command 'x86\\_64-linux-gnu-gcc' failed with exit status 1
&gt;&gt; Complete output from command python setup.py egg\\_info:
&gt;&gt; c/\\_cffi\\_backend.c:2:20: fatal error: Python.h: No such file or
&gt;&gt; directory
&gt;&gt;
&gt;&gt; #include 
&gt;&gt;
&gt;&gt; ^
&gt;&gt;
&gt;&gt; compilation terminated.
&gt;&gt;
&gt;&gt; Traceback (most recent call last):
&gt;&gt;
&gt;&gt; File "", line 17, in 
&gt;&gt;
&gt;&gt; File "/tmp/pip\\_build\\_root/cryptography/setup.py", line 174, in 
&gt;&gt;
&gt;&gt; "test": PyTest,
&gt;&gt;
&gt;&gt; File "/usr/lib/python2.7/distutils/core.py", line 111, in setup
&gt;&gt;
&gt;&gt; \\_setup\\_distribution = dist = klass(attrs)
&gt;&gt;
&gt;&gt; File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 239, in
&gt;&gt; \\_\\_init\\_\\_
&gt;&gt;
&gt;&gt; self.fetch\\_build\\_eggs(attrs.pop('setup\\_requires'))
&gt;&gt;
&gt;&gt; File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 264, in
&gt;&gt; fetch\\_build\\_eggs
&gt;&gt;
&gt;&gt; replace\\_conflicting=True
&gt;&gt;
&gt;&gt; File "/usr/lib/python2.7/dist-packages/pkg\\_resources.py", line 620, in
&gt;&gt; resolve
&gt;&gt;
&gt;&gt; dist = best[req.key] = env.best\\_match(req, ws, installer)
&gt;&gt;
&gt;&gt; File "/usr/lib/python2.7/dist-packages/pkg\\_resources.py", line 858, in
&gt;&gt; best\\_match
&gt;&gt;
&gt;&gt; return self.obtain(req, installer) # try and download/install
&gt;&gt;
&gt;&gt; File "/usr/lib/python2.7/dist-packages/pkg\\_resources.py", line 870, in
&gt;&gt; obtain
&gt;&gt;
&gt;&gt; return installer(requirement)
&gt;&gt;
&gt;&gt; File "/usr/lib/python2.7/dist-packages/setuptools/dist.py", line 314, in
&gt;&gt; fetch\\_build\\_egg
&gt;&gt;
&gt;&gt; return cmd.easy\\_install(req)
&gt;&gt;
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 616, in easy\\_install
&gt;&gt;
&gt;&gt; return self.install\\_item(spec, dist.location, tmpdir, deps)
&gt;&gt;
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 646, in install\\_item
&gt;&gt;
&gt;&gt; dists = self.install\\_eggs(spec, download, tmpdir)
&gt;&gt;
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 834, in install\\_eggs
&gt;&gt;
&gt;&gt; return self.build\\_and\\_install(setup\\_script, setup\\_base)
&gt;&gt;
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 1040, in build\\_and\\_install
&gt;&gt;
&gt;&gt; self.run\\_setup(setup\\_script, setup\\_base, args)
&gt;&gt;
&gt;&gt; File
&gt;&gt; "/usr/lib/python2.7/dist-packages/setuptools/command/easy\\_install.py", line
&gt;&gt; 1028, in run\\_setup
&gt;&gt;
&gt;&gt; raise DistutilsError("Setup script exited with %s" % (v.args[0],))
&gt;&gt;
&gt;&gt; distutils.errors.DistutilsError: Setup script exited with error: command
&gt;&gt; 'x86\\_64-linux-gnu-gcc' failed with exit status 1
&gt;&gt;
&gt;&gt; ----------------------------------------
&gt;&gt; Cleaning up...
&gt;&gt; Command python setup.py egg\\_info failed with error code 1 in
&gt;&gt; /tmp/pip\\_build\\_root/cryptography
&gt;&gt; Storing debug log for failure in /root/.pip/pip.log
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Alex
&gt;&gt;
&gt;&gt;
&gt;&gt; On Fri, Aug 15, 2014 at 7:07 PM, Sean Cribbs  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hi Alex,
&gt;&gt;&gt;
&gt;&gt;&gt; The published version is not a final release, so it won't be
&gt;&gt;&gt; automatically installed by pip. Try this: pip install riak==2.1.0rc1
&gt;&gt;&gt;
&gt;&gt;&gt; Also, did you activate your bucket-type using riak-admin? It won't be
&gt;&gt;&gt; usable until it's activated.
&gt;&gt;&gt;
&gt;&gt;&gt; On Fri, Aug 15, 2014 at 12:02 PM, Alex De la rosa
&gt;&gt;&gt;  wrote:
&gt;&gt;&gt; &gt; Hi, thanks for your suggestion, but I would prefer to use the official
&gt;&gt;&gt; &gt; packages, and for what I saw on the list some days ago, the new version
&gt;&gt;&gt; &gt; was
&gt;&gt;&gt; &gt; published, so I wonder why is not yet working.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Thanks,
&gt;&gt;&gt; &gt; Alex
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; On Fri, Aug 15, 2014 at 6:20 PM, tele  wrote:
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Hi Alex,
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Use the version from git and see if you get the same error:
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; git clone https://github.com/basho/riak-python-client.git
&gt;&gt;&gt; &gt;&gt; cd riak-python-client
&gt;&gt;&gt; &gt;&gt; python setup.py install
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; :tele
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; On Fri, 15 Aug 2014 18:12:09 +0200
&gt;&gt;&gt; &gt;&gt; Alex De la rosa  wrote:
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; &gt; Hi there,
&gt;&gt;&gt; &gt;&gt; &gt;
&gt;&gt;&gt; &gt;&gt; &gt; I created a "counter" bucket called "likes" with the following shell
&gt;&gt;&gt; &gt;&gt; &gt; script:
&gt;&gt;&gt; &gt;&gt; &gt;
&gt;&gt;&gt; &gt;&gt; &gt; riak-admin bucket-type create likes
&gt;&gt;&gt; &gt;&gt; &gt; '{"props":{"datatype":"counter"}}'
&gt;&gt;&gt; &gt;&gt; &gt;
&gt;&gt;&gt; &gt;&gt; &gt; When I try to follow the guide [
&gt;&gt;&gt; &gt;&gt; &gt; http://docs.basho.com/riak/2.0.0/dev/using/data-types ] to use this
&gt;&gt;&gt; &gt;&gt; &gt; bucket with Python, I found the following issue:
&gt;&gt;&gt; &gt;&gt; &gt;
&gt;&gt;&gt; &gt;&gt; &gt; Traceback (most recent call last):
&gt;&gt;&gt; &gt;&gt; &gt; File "x.py", line 17, in 
&gt;&gt;&gt; &gt;&gt; &gt; bucket = client.bucket\\_type('counter\\_bucket').bucket('likes')
&gt;&gt;&gt; &gt;&gt; &gt; AttributeError: 'RiakClient' object has no attribute 'bucket\\_type'
&gt;&gt;&gt; &gt;&gt; &gt;
&gt;&gt;&gt; &gt;&gt; &gt; Something wrong? Is a fresh install from "pip" so I thought the
&gt;&gt;&gt; &gt;&gt; &gt; Python
&gt;&gt;&gt; &gt;&gt; &gt; library would be in its last updated version?
&gt;&gt;&gt; &gt;&gt; &gt;
&gt;&gt;&gt; &gt;&gt; &gt; Thanks!
&gt;&gt;&gt; &gt;&gt; &gt; Alex
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; &gt; riak-users mailing list
&gt;&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt; &gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt; Software Engineer
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; http://basho.com/
&gt;&gt;
&gt;&gt;
&gt;



-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

