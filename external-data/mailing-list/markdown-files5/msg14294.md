---
title: "Re: Upgraded riak 1.4.9 is pegging the CPU"
description: ""
project: community
lastmod: 2014-06-05T08:51:12-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14294"
mailinglist_parent_id: "msg14293"
author_name: "Alain Rodriguez"
project_section: "mailinglistitem"
sent_date: 2014-06-05T08:51:12-07:00
---


Thanks for the quick reply and no I did not. Is this something I should be
able to do now (stop, remove files, start again) or is it too late? How
could I verify this is the issue?


On Thu, Jun 5, 2014 at 8:42 AM, Shane McEwan  wrote:

&gt; On 05/06/14 16:20, Alain Rodriguez wrote:
&gt; &gt; Hi all,
&gt; &gt;
&gt; &gt; I upgraded 1 of 9 riak nodes in a cluster last night from 1.4.0 to
&gt; &gt; 1.4.9. The rest are running 1.4.0.
&gt; &gt;
&gt; &gt; Ever since I am seeing the upgraded node, riak01 consuming a
&gt; &gt; significantly larger percent of CPU and the PUT times on it have gotten
&gt; &gt; worse. htop indicicates one particular process pegging the CPU, and many
&gt; &gt; many more processes running than I was used to seeing before.
&gt;
&gt; G'day!
&gt;
&gt; Did you turn off and remove the Active Anti Entropy files before upgrading?
&gt;
&gt; From the 1.4.8 release notes:
&gt;
&gt; IMPORTANT We recommend removing current AAE trees before upgrading. That
&gt; is, all files under the anti\\_entropy sub-directory. This will avoid
&gt; potentially large amounts of repair activity once correct hashes start
&gt; being added. The data in the current trees can only be fixed by a full
&gt; rebuild, so this repair activity is wasteful. Trees will start to build
&gt; once AAE is re-enabled. To minimize the impact of this, we recommend
&gt; upgrading during a period of low activity.
&gt;
&gt; Shane.
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

