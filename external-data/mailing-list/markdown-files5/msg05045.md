---
title: "Re: Have Riak servers in separate cluster behind a load balancer, or	on same machines as web server?"
description: ""
project: community
lastmod: 2011-10-04T21:10:02-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05045"
mailinglist_parent_id: "msg05044"
author_name: "Greg Stein"
project_section: "mailinglistitem"
sent_date: 2011-10-04T21:10:02-07:00
---


I don't see that multiplexing or TCP setup is specific to HTTP.

The only difference between protobuf and HTTP is what goes on the wire. Not
how the wire is managed.

(and with that said, the Python client managed the wire in the most horrible
ways imaginable for the HTTP Client; I've since fixed that on my branch)
On Oct 4, 2011 11:37 PM, "Aphyr"  wrote:
&gt; Internode times in our datacenter at SL are indistinguishible from
&gt; loopback; TCP/IP processing dominates. HTTP, on the other hand, involves
&gt; either in-depth connection management/multiplexing, or TCP/IP
&gt; setup/teardown latency at either end of a request. In read-write heavy
&gt; apps, protobufs outperforms HTTP in throughput by 2x or more, against
&gt; objects of 500-4000 bytes. That's with the ruby client; ymmv.
&gt;
&gt; --Kyle
&gt;
&gt; On 10/04/2011 07:18 PM, Greg Stein wrote:
&gt;&gt;
&gt;&gt; On Oct 4, 2011 7:01 PM, "Mike Oxford" &gt; &gt; wrote:
&gt;&gt; &gt;
&gt;&gt; &gt; You'll want to run protobufs if you're looking to optimize your
&gt;&gt; &gt; response time; HTTP sockets (even to localhost) will require much more
&gt;&gt; &gt; overhead and time.
&gt;&gt;
&gt;&gt; Hmm? The protocol seems moot, compared to inter-node comms when r &gt; 1
&gt;&gt; Protocol parsing just doesn't seem like much of a factor. On my laptop,
&gt;&gt; I was seeing a 3ms response time against one node. I can't imagine that
&gt;&gt; parsing was more than a few percent, no matter the protocol.
&gt;&gt;
&gt;&gt; (and no, I have no specific numbers to confirm/deny my thought
&gt;&gt; experiment here)
&gt;&gt;
&gt;&gt; &gt; Even better would be unix sockets if they're available, and you can
&gt;&gt; &gt; bypass the whole TCP stack.
&gt;&gt;
&gt;&gt; What? Is that even an option for Riak? I haven't seen anything about
that.
&gt;&gt;
&gt;&gt; &gt;...
&gt;&gt;
&gt;&gt; Cheers,
&gt;&gt; -g
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

