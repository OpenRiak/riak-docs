---
title: "Re: New to Riak, hitting a connection limit"
description: ""
project: community
lastmod: 2012-08-03T07:48:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08174"
mailinglist_parent_id: "msg08155"
author_name: "Douglas Muth"
project_section: "mailinglistitem"
sent_date: 2012-08-03T07:48:16-07:00
---


Hi Mark,

On Thu, Aug 2, 2012 at 2:02 AM, Mark Phillips  wrote:
&gt;
&gt; I think you're problem here is that you're front-loading requests.
&gt; You're better off to issue them serially and wait for one to finish
&gt; before issuing the next. Rumor has there's an example of how one might
&gt; do this somewhere in Riaktant [1], a somewhat dusty but useful sample
&gt; app. I'll dig through it tomorrow if I remember.
&gt;

Your comment gave me some ideas, so I went and started using the
node-pool module (https://github.com/coopernurse/node-pool) in my test
script. That artificially limited the number of concurrent
connections to whatever number I specified, and solved the problem.

Unfortunately found another issue in node\\_riak which makes it
unsuitable for production use: unbounded use of network sockets. It
seems that socks aren't being closed/reused properly. At ~250
queries/second, I could start getting EADDRNOTAVAIL errors after about
15k total queries. :-(

Since my workplace is a node.js shop, and I really want to use Riak,
I'm going to take a whack at writing my own node.js driver for Riak.
Would anyone find it useful if I could talk my employer into releasing
it under the GPL?

-- Doug

-- 
http://www.dmuth.org/

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

