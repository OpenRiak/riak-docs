---
title: "Re: Experimental branch - 2i query improvements"
description: ""
project: community
lastmod: 2013-04-17T16:56:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10933"
mailinglist_parent_id: "msg10932"
author_name: "Martin Sumner"
project_section: "mailinglistitem"
sent_date: 2013-04-17T16:56:15-07:00
---


D'oh. I meant 400 bytes.


On 18 April 2013 00:05, Kresten Krab Thorup  wrote:

&gt; Very interesting!
&gt;
&gt; Regarding feature #1: I don't understand how an ets based index adds up to
&gt; 400k per posting; as your write up suggests. Did you mean 400b? I thought
&gt; ets was reasonably memory efficient. Do you use very large keys?
&gt;
&gt; Sent from my iPhone
&gt;
&gt; On 16/04/2013, at 23.50, "Martin Sumner"  &gt; wrote:
&gt;
&gt; I've been working on an experimental branch to offer some improvements to
&gt; the functionality and performance of 2i queries in Riak:
&gt; https://github.com/martinsumner/riak\\_kv
&gt;
&gt; Explanation:
&gt; https://github.com/martinsumner/riak\\_kv/blob/master/docs/index\\_speedup.md
&gt;
&gt; There are four basic features that are included:
&gt; 1. The ability to pin particular 2i indexes into memory (without loss of
&gt; consistency on restart of a node)
&gt; 2. The ability to set partition-level static bloom filters for particular
&gt; 2i indexes to greatly reduce the disk overheads of exact-term queries with
&gt; small result sets (e.g. for queries by a secondary identifier such as email
&gt; address)
&gt; 3. The ability to return indexterms, not just keys as results of a query -
&gt; so that those terms can be overloaded with additional information which can
&gt; then be filtered by the application without requiring a M/R stage (note
&gt; this is already available via Russell Brown's branch -
&gt; https://github.com/basho/riak\\_kv/tree/pt34-index-values)
&gt; 4. The ability to pass a regular expression to the query iterator - so
&gt; that range queries will be filtered based on matches to that regular
&gt; expression (for example allowing for non-trailing wildcards) before
&gt; returning the keys and terms
&gt;
&gt; Testing is slight at the moment, both functionally and non-functionally.
&gt; This is still very-much an experiment. We're hoping to do some full scale
&gt; volume testing on the branch in the next couple of weeks.
&gt;
&gt; The branch has been developed to solve some problems we have with edge
&gt; cases in our implementation for the NHS in England - where we have to
&gt; support tracing across an 80M record demographic database. I'd be
&gt; interested if people thought it had value in other environments.
&gt;
&gt; Regards
&gt;
&gt; Martin
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

