---
title: "Re:"
description: ""
project: community
lastmod: 2013-09-09T16:55:02-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12216"
mailinglist_parent_id: "msg12211"
author_name: "Brady Wetherington"
project_section: "mailinglistitem"
sent_date: 2013-09-09T16:55:02-07:00
---


I've been working with Basho to get those documents updated - in short - I
have a pull request that makes using Riak with EIP's in Classic-EC2 much,
much easier. They have accepted it, but it has not been merged with the
mainline yet. I'm assuming you are \\*not\\* on VPC, is that correct?

If so, you should use the ec2 public DNS name as your node identifier
instead. For the IP you listed above, that's:

ec2-54-247-68-179.eu-west-1.compute.amazonaws.com

If you find that name ungainly - go head and make a CNAME that points to it
-

riak-1.yourcompany.com CNAME
ec2-54-247-68-179.eu-west-1.compute.amazonaws.com

Once you've done this, you can use that shortname (riak-1.yourcompany.com)
as your node identifier - and it will survive a node restart (so long as
you reassociate the EIP with the instance).

The reason \\*why\\* this works is that that public DNS name (
ec2-54-247-68-179.eu-west-1.compute.amazonaws.com) resolves to the \\_inside\\_
IP address of your node when you're inside of amazon. So your server can
figure out whether or not it's talking to itself.

-B.


On Mon, Sep 9, 2013 at 7:38 AM, David Montgomery
wrote:

&gt; Why do I get errors restarting riak when i use aws EIP's?
&gt;
&gt; I change the ip address per this doc.
&gt; http://docs.basho.com/riak/1.2.1/cookbooks/Basic-Cluster-Setup/ I am
&gt; using the latest version of riak for ubuntu 12.04
&gt;
&gt; I change the 127.0.0.1 to the EIP. It should work. Yet....riak will not
&gt; work. Any issues I am missing? How do I resolve?
&gt;
&gt;
&gt; console.log
&gt; 2013-09-09 11:28:28.211 [info] &lt;0.7.0&gt; Application webmachine started on
&gt; node 'riak@54.247.68.179'
&gt; 2013-09-09 11:28:28.211 [info] &lt;0.7.0&gt; Application basho\\_stats started on
&gt; node 'riak@54.247.68.179'
&gt; 2013-09-09 11:28:28.229 [info] &lt;0.7.0&gt; Application bitcask started on node
&gt; 'riak@54.247.68.179'
&gt; 2013-09-09 11:28:29.385 [error] &lt;0.172.0&gt; CRASH REPORT Process &lt;0.172.0&gt;
&gt; with 0 neighbours exited with reason: eaddrnotavail in gen\\_server:init\\_it/6
&gt; line 320
&gt; 2013-09-09 11:28:29.385 [error] &lt;0.138.0&gt; Supervisor riak\\_core\\_sup had
&gt; child "http\\_54.247.68.179:8098" started with
&gt; webmachine\\_mochiweb:start([{name,"http\\_54.247.68.179:8098"},{ip,"54.247.68.179"},{p$
&gt; 2013-09-09 11:28:29.387 [info] &lt;0.7.0&gt; Application riak\\_core exited with
&gt; reason: {shutdown,{riak\\_core\\_app,start,[normal,[]]}}
&gt;
&gt; error.log
&gt; 013-09-09 11:08:13.109 [error] &lt;0.138.0&gt; Supervisor riak\\_core\\_sup had
&gt; child riak\\_core\\_capability started with riak\\_core\\_capability:start\\_link()
&gt; at &lt;0.156.0&gt; exit with reason no function clause match$
&gt; 2013-09-09 11:08:13.110 [error] &lt;0.136.0&gt; CRASH REPORT Process &lt;0.136.0&gt;
&gt; with 0 neighbours exited with reason: {{function\\_clause,[{orddict,fetch,['
&gt; riak@10.239.130.225',[{'riak@127.0.0.1',[{{riak\\_cont$
&gt; 2013-09-09 11:08:34.956 [error] &lt;0.156.0&gt; gen\\_server riak\\_core\\_capability
&gt; terminated with reason: no function clause matching orddict:fetch('
&gt; riak@10.239.130.225', [{'riak@127.0.0.1',[{{riak\\_control,m$
&gt; 2013-09-09 11:08:34.957 [error] &lt;0.156.0&gt; CRASH REPORT Process
&gt; riak\\_core\\_capability with 0 neighbours exited with reason: no function
&gt; clause matching orddict:fetch('riak@10.239.130.225', [{'riak@127.$
&gt; 2013-09-09 11:08:34.957 [error] &lt;0.140.0&gt; Supervisor riak\\_core\\_sup had
&gt; child riak\\_core\\_capability started with riak\\_core\\_capability:start\\_link()
&gt; at &lt;0.156.0&gt; exit with reason no function clause match$
&gt; 2013-09-09 11:08:34.958 [error] &lt;0.138.0&gt; CRASH REPORT Process &lt;0.138.0&gt;
&gt; with 0 neighbours exited with reason: {{function\\_clause,[{orddict,fetch,['
&gt; riak@10.239.130.225',[{'riak@127.0.0.1',[{{riak\\_cont$
&gt; 2013-09-09 11:10:56.863 [error] &lt;0.154.0&gt; gen\\_server riak\\_core\\_capability
&gt; terminated with reason: no function clause matching orddict:fetch('
&gt; riak@54.247.68.179', []) line 72
&gt; 2013-09-09 11:10:56.864 [error] &lt;0.154.0&gt; CRASH REPORT Process
&gt; riak\\_core\\_capability with 0 neighbours exited with reason: no function
&gt; clause matching orddict:fetch('riak@54.247.68.179', []) line 72 i$
&gt;
&gt; [ Read 32 lines ]
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

