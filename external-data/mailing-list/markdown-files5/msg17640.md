---
title: "Re: RIAK TS installed nodes not connecting"
description: ""
project: community
lastmod: 2016-09-13T05:46:30-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17640"
mailinglist_parent_id: "msg17638"
author_name: "Stephen Etheridge"
project_section: "mailinglistitem"
sent_date: 2016-09-13T05:46:30-07:00
---


Hi Joris,

I have looked at the tutorial you have been following but I confess I am
confused. In the example you are following I do not see where the spark
and sql contexts are created. I use PySpark through the Jupyter notebook
and I have to specify a path to the connector on invoking the jupyter
notebook. Is it possible for you to share all your code (and how you are
invoking zeppelin) with me so I can trace everything through?

regards
Stephen

On Mon, Sep 12, 2016 at 3:27 PM, Agtmaal, Joris van &lt;
joris.vanagtm...@wartsila.com&gt; wrote:

&gt; Hi
&gt;
&gt;
&gt;
&gt; I’m new to Riak and followed the installation instructions to get it
&gt; working on an AWS cluster (3 nodes).
&gt;
&gt;
&gt;
&gt; So far ive been able to use Riak in pyspark (zeppelin) to
&gt; create/read/write tables, but i would like to use the dataframes directly
&gt; from spark, using the Spark-Riak Connector.
&gt;
&gt; When following the example found here: http://docs.basho.com/riak/ts/
&gt; 1.4.0/add-ons/spark-riak-connector/quick-start/#python
&gt;
&gt; But i run into trouble on this last part:
&gt;
&gt;
&gt;
&gt; host= my\\_ip\\_adress\\_of\\_riak\\_node
&gt;
&gt; pb\\_port = '8087'
&gt;
&gt; hostAndPort = ":".join([host, pb\\_port])
&gt;
&gt; client = riak.RiakClient(host=host, pb\\_port=pb\\_port)
&gt;
&gt;
&gt;
&gt; df.write \\
&gt;
&gt; .format('org.apache.spark.sql.riak') \\
&gt;
&gt; .option('spark.riak.connection.host', hostAndPort) \\
&gt;
&gt; .mode('Append') \\
&gt;
&gt; .save('test')
&gt;
&gt;
&gt;
&gt; Important to note that i’m using a local download of the Jar file that is
&gt; loaded into the pyspark interpreter in zeppeling through:
&gt;
&gt; %dep
&gt;
&gt; z.reset()
&gt;
&gt; z.load("/home/hadoop/spark-riak-connector\\_2.10-1.6.0.jar")
&gt;
&gt;
&gt;
&gt; Here is the error message i get back:
&gt;
&gt; Py4JJavaError: An error occurred while calling o569.save. : 
&gt; java.lang.NoClassDefFoundError:
&gt; com/basho/riak/client/core/util/HostAndPort at com.basho.riak.spark.rdd.
&gt; connector.RiakConnectorConf$.apply(RiakConnectorConf.scala:76) at
&gt; com.basho.riak.spark.rdd.connector.RiakConnectorConf$.
&gt; apply(RiakConnectorConf.scala:89) at org.apache.spark.sql.riak.
&gt; RiakRelation$.apply(RiakRelation.scala:115) at org.apache.spark.sql.riak.
&gt; DefaultSource.createRelation(DefaultSource.scala:51) at
&gt; org.apache.spark.sql.execution.datasources.ResolvedDataSource$.apply(ResolvedDataSource.scala:222)
&gt; at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:148)
&gt; at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:139)
&gt; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at
&gt; sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
&gt; at sun.reflect.DelegatingMethodAccessorImpl.invoke(
&gt; DelegatingMethodAccessorImpl.java:43) at 
&gt; java.lang.reflect.Method.invoke(Method.java:606)
&gt; at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231) at
&gt; py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381) at
&gt; py4j.Gateway.invoke(Gateway.java:259) at py4j.commands.AbstractCommand.
&gt; invokeMethod(AbstractCommand.java:133) at 
&gt; py4j.commands.CallCommand.execute(CallCommand.java:79)
&gt; at py4j.GatewayConnection.run(GatewayConnection.java:209) at
&gt; java.lang.Thread.run(Thread.java:745) ( 'py4j.protocol.Py4JJavaError'&gt;, Py4JJavaError(u'An error occurred while
&gt; calling o569.save.\\n', JavaObject id=o570),  0x7f7021bb0200&gt;)
&gt;
&gt;
&gt;
&gt; Hope somebody can help out.
&gt;
&gt; thanks, joris
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
{ "name" : "Stephen Etheridge",
 "title" : "Solution Architect, EMEA",
 "Organisation" : "Basho Technologies, Inc",
 "Telephone" : "07814 406662",
 "email" : "mailto:setheri...@basho.com",
 "github" : "http://github.com/datalemming",
 "twitter" : "@datalemming"}
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

