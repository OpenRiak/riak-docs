---
title: "Re: Riak not storing data in a round-robin manner across instances"
description: ""
project: community
lastmod: 2016-05-27T13:41:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17429"
mailinglist_parent_id: "msg17427"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2016-05-27T13:41:05-07:00
---


There is a reason Basho's minimum production deployment recommendation is 5
machines. It is to ensure that, when operating with default settings, each
replica of any key is stored on distinct physical nodes. It has to do with
the allocation of virtual nodes to physical machines and replica sets.
Replica sets are sets of virtual nodes, not physical nodes.

When using 3 or 4 machines in your cluster reduce your n\\_val to 2.

Cheers, Alexander

On Friday, May 27, 2016, DeadZen  wrote:

&gt; np, number of nodes and ring size play a lot into that.
&gt; as does your r,w settings.
&gt; might be fun to create a visualization one day ;)
&gt;
&gt; On Friday, May 27, 2016, Vikram Lalit  &gt; wrote:
&gt;
&gt;&gt; Ok got it thanks.
&gt;&gt; On May 27, 2016 4:02 PM, "DeadZen"  wrote:
&gt;&gt;
&gt;&gt;&gt; reiterating my last email
&gt;&gt;&gt;
&gt;&gt;&gt; &gt; theres no guarantee vnodes are assigned to unique servers..
&gt;&gt;&gt;
&gt;&gt;&gt; referencing the docs
&gt;&gt;&gt;
&gt;&gt;&gt; &gt; Nodes \\*attempt\\* to claim their partitions at intervals around the
&gt;&gt;&gt; ring such that there is an even distribution amongst the member nodes and
&gt;&gt;&gt; that no node is responsible for more than one replica of a key.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Friday, May 27, 2016, Vikram Lalit  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I have a Riak cluster (of 3 nodes, with 64 partitions and n\\_val = 3)
&gt;&gt;&gt;&gt; but I find that for some objects, their hosting partitions / vnodes are not
&gt;&gt;&gt;&gt; spread out across the 3 nodes. In some cases, 2 of them are on 1 node and
&gt;&gt;&gt;&gt; the third is on a second node. That runs contrary to my understanding (link
&gt;&gt;&gt;&gt; here: http://docs.basho.com/riak/kv/2.1.4/learn/concepts/clusters/)
&gt;&gt;&gt;&gt; that the data is spread out across partitions in such a way that the
&gt;&gt;&gt;&gt; partitions are on different servers. Is there something I'm missing here
&gt;&gt;&gt;&gt; please in terms of how Riak works? Thanks...
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;

-- 


Alexander Sicular
Solutions Architect
Basho Technologies
9175130679
@siculars
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

