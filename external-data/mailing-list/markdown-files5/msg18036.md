---
title: "Issue with yokozuna_extractor_map (riak 2.1.1)"
description: ""
project: community
lastmod: 2017-02-28T03:56:09-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18036"
author_name: "Simon Jaspar"
project_section: "mailinglistitem"
sent_date: 2017-02-28T03:56:09-08:00
---


Hi,

I’m currently experimenting with riak 2.1.1 for a project. I recently ran into 
some trouble with yokozuna trying to register a custom extractor.

I’m not sure how I ended up in that situation, but I’m currently stuck with my 
cluster's yokozuna\\_extractor\\_map equal to the atom ignore…

I remember having the default extractor map there, before I try to register a 
custom extractor (following basho documentation 
https://docs.basho.com/riak/kv/2.2.0/developing/usage/custom-extractors/ 
 ), 
and end up here.

While attached to one of my riak's node, running yz\\_extractor:get\\_map(). 
returns ignore.

And trying to register a new extractor 
yz\\_extractor:register("custom\\_extractor",yz\\_noop\\_extractor). returns 
already\\_registered , with this in my logs :

2017-02-28 11:41:39.265 [error] 
&lt;0.180.0&gt;@riak\\_core\\_ring\\_manager:handle\\_call:406 ring\\_trans: invalid return 
value: 
{'EXIT',{function\\_clause,[{orddict,find,["custom\\_extractor",ignore],[{file,"orddict.erl"},{line,80}]},{yz\\_extractor,get\\_def,3,[{file,"src/yz\\_extractor.erl"},{line,67}]},{yz\\_extractor,register\\_map,2,[{file,"src/yz\\_extractor.erl"},{line,138}]},{yz\\_misc,set\\_ring\\_trans,2,[{file,"src/yz\\_misc.erl"},{line,302}]},{riak\\_core\\_ring\\_manager,handle\\_call,3,[{file,"src/riak\\_core\\_ring\\_manager.erl"},{line,389}]},{gen\\_server,handle\\_msg,5,[{file,"gen\\_server.erl"},{line,585}]},{proc\\_lib,init\\_p\\_do\\_apply,3,[{file,"proc\\_lib.erl"},{line,239}]}]}}

I have been trying to bypass that issue by reseting the extractor map to its 
default value using lower level functions from yokozuna source code, but with 
no success.

If anyone has any idea or solution that’d be great !

Thanks in advance for your help.

Best,
Simon JASPAR

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

