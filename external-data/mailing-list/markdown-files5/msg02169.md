---
title: "Re: Riak Cluster Setup on EC2"
description: ""
project: community
lastmod: 2011-02-02T08:05:04-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02169"
mailinglist_parent_id: "msg02168"
author_name: "Abhishek Kona"
project_section: "mailinglistitem"
sent_date: 2011-02-02T08:05:04-08:00
---



On 02/02/11 8:38 PM, Sean Cribbs wrote:

Abhishek,

First, make sure all of your nodes are in the same security group.
Yes, both the machines are on the same security group ( which has only 
the ports 8098, 8099, 8087).
 Second, check that your OS doesn't have an additional firewall 
installed (iptables, for example).
I can telnet into the Riak ports from each of the machines, so firewall 
does not seem to be the issue.
 Third, you might consider doing what the Chef recipe for Riak does 
and limit the ports that Erlang uses for distributed communication. 
Adding a section to app.config like the below will limit the port range:


{kernel, [
 {inet\\_dist\\_listen\\_min, 6000},
 {inet\\_dist\\_listen\\_max, 7999}
]}

You'll need to stop Riak, kill the "epmd" process, and then start Riak 
up again for this change to take effect. Make sure those ports are 
also open in your security group and any software firewall you have.


Tried with these changes as well, but still get the same message. 
Anything else, I can try?.

Thanks for the help.

Sean Cribbs
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Feb 2, 2011, at 8:47 AM, Abhishek Kona wrote:


Hi folks

I am trying to set up a Riak cluster on EC2.
Each time I issue a command :

$ sudo riak-admin join riak@10.130.149.253

It fails :

Attempting to restart script through sudo -u riak

Node riak@10.130.149.253 is not reachable!


Netstat on both the machines says the ports are running fine.

netstat -na | egrep '(8087|8098|8099)'

tcp 0 0 0.0.0.0:8098 0.0.0.0:\\* 
LISTEN


tcp 0 0 0.0.0.0:8099 0.0.0.0:\\* 
LISTEN


tcp 0 0 0.0.0.0:8087 0.0.0.0:\\* 
LISTEN



I can telnet to all the ports from each of the machine.
I have been pulling my hair for long but of no avail.
Can any one look and tell me what I am doing wrong.
Are there any debug logs where I can look at what is going wrong?
Is there any EC2 specific trick (like using public hostnames).

I am attaching my app.cfg file for reference.

Thanks
-Abhishek Kona

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

