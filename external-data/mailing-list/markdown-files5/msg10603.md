---
title: "Re: Issue with Riak CS Pre-Authenticated URL"
description: ""
project: community
lastmod: 2013-03-27T07:40:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10603"
mailinglist_parent_id: "msg10602"
author_name: "Dave Finster"
project_section: "mailinglistitem"
sent_date: 2013-03-27T07:40:40-07:00
---


Just adding a bit more info at the request of shino1.

I've got a URL 

http://intranet-development.myriakcs.com/fdcddce0-78ca-0130-bc9c-482a14143152?AWSAccessKeyId=1PBIAEUBPVXSASP0HKLC&Expires=1364393156&Signature=WMRuKTl73/TcmBj1UyH5agdg+NU=

which yields


`AccessDenied`
Access Denied

 /intranet-development/fdcddce0-78ca-0130-bc9c-482a14143152
 



I've got an nginx server out the front of 2 CS instances but I've also run that 
URL directly against the CS instances and encountered the same result. I don't 
see any entries in the logs for Riak/Riak CS/Stanchion about the request aside 
from the 403 in the CS access logs. 

Cheers,
Dave

Begin forwarded message:

&gt; From: Dave Finster 
&gt; Subject: Issue with Riak CS Pre-Authenticated URL
&gt; Date: 27 March 2013 11:46:41 PM AEST
&gt; To: riak-users@lists.basho.com
&gt; 
&gt; Hi Everyone
&gt; 
&gt; Have been playing with Riak and now CS for a little while and have got 
&gt; everything working by just using the aws-sdk gem and dropped my CS 
&gt; credentials and endpoint in. I do seem to have encountered an issue with the 
&gt; generation of pre-authenticated urls, or the query string auth method. The 
&gt; aws-sdk uses the S3Object.url\\_for method (source here: 
&gt; https://github.com/aws/aws-sdk-ruby/blob/master/lib/aws/s3/s3\\_object.rb ) 
&gt; which appears to property follow the auth guidelines 
&gt; (http://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication.html#RESTAuthenticationQueryStringAuth).
&gt; 
&gt; I'm trying to do a simple GET request for a file in a bucket and every URL 
&gt; that gets generated comes back with 'Access Denied' and 403. The CS access 
&gt; logs also show the same. 
&gt; 
&gt; Wondering if anyone has any tips for diagnosing this issue further. At the 
&gt; moment I've just got my Ruby code downloading the stored file to a TempFile 
&gt; and then feeding that back to the client. Using s3cmd and aws-sdk to fetch 
&gt; the file works fine - just seems to be something to do with the query string 
&gt; auth method.
&gt; 
&gt; Thanks,
&gt; Dave

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

