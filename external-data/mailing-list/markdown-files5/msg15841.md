---
title: "Re: Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime"
description: ""
project: community
lastmod: 2015-03-05T08:42:09-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15841"
mailinglist_parent_id: "msg15834"
author_name: "Santi Kumar"
project_section: "mailinglistitem"
sent_date: 2015-03-05T08:42:09-08:00
---


Sorry to spam but here is the output of the AAE status. I'm just pasting
here. I'll have to get familiarised with the output. ON a quick look keys
repaired is not at all there in last column. Your inputs are appreciated.


================================== Exchanges
==================================

Index Last (ago) All (ago)


-------------------------------------------------------------------------------

0 8.0 min 8.5 min


91343852333181432387730302044767688728495783936 7.2 min 7.7 min


182687704666362864775460604089535377456991567872 6.4 min 7.0 min


274031556999544297163190906134303066185487351808 5.7 min 6.2 min


365375409332725729550921208179070754913983135744 4.9 min 5.4 min


456719261665907161938651510223838443642478919680 4.2 min 4.7 min


548063113999088594326381812268606132370974703616 3.4 min 3.9 min


639406966332270026714112114313373821099470487552 2.7 min 3.2 min


730750818665451459101842416358141509827966271488 1.9 min 2.4 min


822094670998632891489572718402909198556462055424 1.2 min 1.7 min


913438523331814323877303020447676887284957839360 26.8 s 56.8 s


981946412581700398168100746981252653831329677312 11.8 s 16.5 min


1004782375664995756265033322492444576013453623296 15.5 min 16.0 min


1073290264914881830555831049026020342559825461248 14.7 min 15.2 min


1096126227998177188652763624537212264741949407232 14.0 min 14.5 min


1164634117248063262943561351070788031288321245184 13.2 min 13.7 min


1187470080331358621040493926581979953470445191168 12.5 min 13.0 min


1255977969581244695331291653115555720016817029120 11.7 min 12.2 min


1278813932664540053428224228626747642198940975104 11.0 min 11.5 min


1347321821914426127719021955160323408745312813056 10.2 min 10.7 min


1370157784997721485815954530671515330927436759040 9.5 min 10.0 min


1438665674247607560106752257205091097473808596992 8.7 min 9.2 min



================================ Entropy Trees
================================

Index Built (ago)

-------------------------------------------------------------------------------

0 2.5 d

91343852333181432387730302044767688728495783936 1.6 d

182687704666362864775460604089535377456991567872 1.6 d

274031556999544297163190906134303066185487351808 1.2 d

365375409332725729550921208179070754913983135744 1.5 d

456719261665907161938651510223838443642478919680 1.5 d

548063113999088594326381812268606132370974703616 2.2 d

639406966332270026714112114313373821099470487552 1.7 d

730750818665451459101842416358141509827966271488 1.4 d

822094670998632891489572718402909198556462055424 1.1 d

913438523331814323877303020447676887284957839360 1.3 d

981946412581700398168100746981252653831329677312 1.1 d

1004782375664995756265033322492444576013453623296 1.4 d

1073290264914881830555831049026020342559825461248 1.1 d

1096126227998177188652763624537212264741949407232 1.3 d

1164634117248063262943561351070788031288321245184 1.3 d

1187470080331358621040493926581979953470445191168 1.2 d

1255977969581244695331291653115555720016817029120 2.2 d

1278813932664540053428224228626747642198940975104 2.4 d

1347321821914426127719021955160323408745312813056 2.0 d

1370157784997721485815954530671515330927436759040 1.9 d

1438665674247607560106752257205091097473808596992 1.7 d


================================ Keys Repaired
================================

Index Last Mean
Max

-------------------------------------------------------------------------------

0 0 0 0


91343852333181432387730302044767688728495783936 0 0 1


182687704666362864775460604089535377456991567872 0 0 1


274031556999544297163190906134303066185487351808 0 0 0


365375409332725729550921208179070754913983135744 0 0 0


456719261665907161938651510223838443642478919680 0 0 0


548063113999088594326381812268606132370974703616 0 0 0


639406966332270026714112114313373821099470487552 0 0 1


730750818665451459101842416358141509827966271488 0 0 0


822094670998632891489572718402909198556462055424 0 0 0


913438523331814323877303020447676887284957839360 0 0 0


981946412581700398168100746981252653831329677312 0 0 1


1004782375664995756265033322492444576013453623296 0 0 0


1073290264914881830555831049026020342559825461248 0 0 0


1096126227998177188652763624537212264741949407232 0 0 0


1164634117248063262943561351070788031288321245184 0 0 0


1187470080331358621040493926581979953470445191168 0 0 0


1255977969581244695331291653115555720016817029120 0 0 0


1278813932664540053428224228626747642198940975104 0 0 0


1347321821914426127719021955160323408745312813056 0 0 0


1370157784997721485815954530671515330927436759040 0 0 0


1438665674247607560106752257205091097473808596992 0 0 0


On Thu, Mar 5, 2015 at 8:05 PM, Zeeshan Lakhani  wrote:

&gt; Hello Santi,
&gt;
&gt; Have you deleted an object in that bucket/index at some point?
&gt;
&gt; Please make sure AAE is running by checking searchâ€™s AAE status,
&gt; `riak-admin search aae-status`, and that data exists in the correct
&gt; directory, `./data/yz\\_anti\\_entropy` (
&gt; http://docs.basho.com/riak/latest/ops/advanced/configs/search/).
&gt;
&gt; You may just need to perform a read-repair by performing a fetch of the
&gt; object itself first, before performing search queries again.
&gt;
&gt; Thanks.
&gt;
&gt; Zeeshan Lakhani
&gt; programmer |
&gt; software engineer at @basho |
&gt; org. member/founder of @papers\\_we\\_love | paperswelove.org
&gt; twitter =&gt; @zeeshanlakhani
&gt;
&gt; On Mar 4, 2015, at 9:06 PM, Santi Kumar  wrote:
&gt;
&gt; But in our case we didnt have spaces in keys. All our keys are UUID's so I
&gt; wouldn't suspect that. AAE I haven't verified .
&gt;
&gt; On Thu, Mar 5, 2015 at 7:16 AM, John O'Brien  wrote:
&gt;
&gt;&gt; I'd lean towards AAE issues on Yokozuna... Same problems we were having
&gt;&gt; with our 'spaces-in-keys' issue... Once we cleaned those up, things were
&gt;&gt; great again.
&gt;&gt;
&gt;&gt; On Wed, Mar 4, 2015 at 8:36 PM, Santi Kumar  wrote:
&gt;&gt;
&gt;&gt;&gt; Raik 2.0.0
&gt;&gt;&gt; On Mar 5, 2015 12:31 AM, "Christopher Meiklejohn" 
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; &gt; On Mar 4, 2015, at 1:15 PM, Santi Kumar  wrote:
&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt; &gt; Hi,
&gt;&gt;&gt;&gt; &gt; We are running into a strange issue with Riak Search. Our setup is
&gt;&gt;&gt;&gt; with 3 nodes of Riak (with search enabled) in 3 different ec2 instances
&gt;&gt;&gt;&gt; behind ELB. App server talks to the cluster through ELB. We are querying
&gt;&gt;&gt;&gt; for list of objects through \\*:\\* query instead of list bucket keys and every
&gt;&gt;&gt;&gt; time the result is different. We have only 4 objects in that bucket /
&gt;&gt;&gt;&gt; index, only few times it's giving all 4 but ofther it returns 2 or 3.
&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt; &gt; This wasn't happening when we have one instance of Riak. Any insight?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi Santi,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Can you provide information regarding what versions of Riak you are
&gt;&gt;&gt;&gt; running?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; - Chris
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Christopher Meiklejohn
&gt;&gt;&gt;&gt; Senior Software Engineer
&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt; cmeiklej...@basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

