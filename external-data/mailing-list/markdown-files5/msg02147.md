---
title: "Re: Getting all the Keys"
description: ""
project: community
lastmod: 2011-01-28T15:03:48-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02147"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-01-28T15:03:48-08:00
---


Another thing to keep in mind is how you design your keys in Riak. In an
RDBMS, it's easy to use an arbitrary surrogate key, like a UUID or identity
column and then create secondary indexes on "useful" attributes in order to
provide natural lookups.

Let's say you have a user. The easiest way to key a user is by a username or
email address.
If a user can have documents, you have a few choices. I would key the
documents as username\\_title\\_slug

 - you can create links from users to documents, but this starts to fall
 apart after a large number of links.
 - You can create a bucket to collect a user's documents and store the
 keys for a user's documents as a list in side that bucket.
 e.g. I'd have a key/value pair named 'jeremiah' and then a list of
 everything I've written ['jeremiah\\_i\\_like\\_pie',
 'jeremiah\\_ten\\_more\\_reasons\\_why\\_i\\_like\\_pie', ..., 'jeremiah\\_mmmm\\_potatoes']

There are a lot of good resources out there
http://blog.basho.com/2010/03/19/schema-design-in-riak---introduction/ Some
of the Riak presentations up on slideshare also talk about data modeling
with Riak.

You're not being silly, I had the same questions when I started using Riak.

Jeremiah Peschka
Microsoft SQL Server MVP
MCITP: Database Developer, DBA


On Fri, Jan 28, 2011 at 3:49 PM, Sean Cribbs  wrote:

&gt; Those are some ways, yes. Generally there are one or more keys that are
&gt; "known" -- usernames, device identifiers, etc -- which then have references
&gt; or in some other way inform the application about how to find other keys.
&gt; This is why links and link-walking were some of the earliest available
&gt; features of Riak.
&gt;
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt;
&gt; On Jan 28, 2011, at 3:07 PM, Marcin Krol wrote:
&gt;
&gt; &gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; &gt; Hash: SHA1
&gt; &gt;
&gt; &gt;
&gt; &gt; I'm playing with riak to see what it's good for, so I need to ask:
&gt; &gt;
&gt; &gt; Sean Cribbs wrote:
&gt; &gt;&gt; To understand why listing keys is difficult, you have to understand
&gt; Riak's (and Dynamo's) original design motivations:
&gt; &gt;&gt;
&gt; &gt;&gt; \\* To be basically available at all times for reads and writes, which in
&gt; turn means to be tolerant of machine and network failures.
&gt; &gt;&gt; \\* To provide low-latency random access to large data sets. (Note I
&gt; didn't say an entire data set.)
&gt; &gt;&gt; \\* To scale linearly with minimal operational complexity.
&gt; &gt;
&gt; &gt; This begs the question: so how DO people know their keys, in practice?
&gt; &gt; Apart from trivial cases like including those keys in pregenerated HTML
&gt; &gt; pages, so when user clicks the link, riak is queried for that key?
&gt; &gt;
&gt; &gt; Do people generate their keys from some templates, like searching a
&gt; &gt; bucket "city-zip\\_code" would generate a range of keys like
&gt; &gt; "london\\_w2qsomething" to "london\\_somethingelse" ?
&gt; &gt;
&gt; &gt; This may look silly to you, but I'm trying to get to grips with idea how
&gt; &gt; riak is \\*actually used\\* in querying.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; - --
&gt; &gt;
&gt; &gt; Regards,
&gt; &gt; mk
&gt; &gt;
&gt; &gt; - --
&gt; &gt; Premature optimization is the root of all fun.
&gt; &gt; -----BEGIN PGP SIGNATURE-----
&gt; &gt; Version: GnuPG v1.4.9 (MingW32)
&gt; &gt; Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
&gt; &gt;
&gt; &gt; iQEcBAEBAgAGBQJNQyH/AAoJEFMgHzhQQ7hOqcoH/itq5jVuBr4ZCnDP06G2tae0
&gt; &gt; nQMIarWOS8rIVqEB6vv99AKggoW9FGCBfR4uOjKzZIv5QgSGWcvvQlcP1hqj3kmD
&gt; &gt; SfKkLKxP7iEDK+w+D/tHlYTuuMkc0PBI2crWtKj6VB6/bPl7eP9SPJBr9Qh86M4l
&gt; &gt; 6KWbQpufkpAKvroJ0odos9qO6bozqM1afUaN0m7v183ghGhUl6TJZ21DDylahNx0
&gt; &gt; MfOox0hl3vxJoUff+qsJiBas2XyD0hBm8vaFux8XhCFermXqgdLHmrHfawzPBpQi
&gt; &gt; JLwYTfq25Kj/xFhyDE4uXLRoH8BHGeRCVwpmTvnvGQyvhMoEz+959kE3WFW41yE=
&gt; &gt; =sjMV
&gt; &gt; -----END PGP SIGNATURE-----
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

