---
title: "Re: Periodically solr down issue."
description: ""
project: community
lastmod: 2017-02-04T19:49:33-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17916"
mailinglist_parent_id: "msg17915"
author_name: "Alex Feng"
project_section: "mailinglistitem"
sent_date: 2017-02-04T19:49:33-08:00
---


Hi Luke,

Here is some error log from solr.log.


2017-02-04 13:15:15,420 [ERROR] @SolrException.java:109
org.apache.solr.common.SolrException:
org.apache.solr.client.solrj.SolrServerException: IOException occured when
talking to server at:
http://nosql-2.dsdb:8093/internal\\_solr/production\\_scheduling
at
org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:308)
at
org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)
at org.apache.solr.core.SolrCore.execute(SolrCore.java:1916)
at
org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:780)
at
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:427)
at
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:217)
at
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)
at
org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)
at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)
at
org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)
at
org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)
at
org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)
at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)
at
org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)
at
org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)
at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)
at
org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)
at
org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)
at
org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)
at org.eclipse.jetty.server.Server.handle(Server.java:368)
at
org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)
at
org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)
at
org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953)
at
org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014)
at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)
at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)
at
org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)
at
org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)
at
org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)
at
org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)
at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.solr.client.solrj.SolrServerException: IOException
occured when talking to server at:
http://nosql-2.dsdb:8093/internal\\_solr/production\\_scheduling
at
org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:507)
at
org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:199)
at
org.apache.solr.handler.component.HttpShardHandler$1.call(HttpShardHandler.java:156)
at
org.apache.solr.handler.component.HttpShardHandler$1.call(HttpShardHandler.java:118)
at java.util.concurrent.FutureTask.run(FutureTask.java:262)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
at java.util.concurrent.FutureTask.run(FutureTask.java:262)
at
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
... 1 more
Caused by: org.apache.http.NoHttpResponseException: The target server
failed to respond
at
org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:143)
at
org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:57)
at
org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:260)
at
org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:283)
at
org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:251)
at
org.apache.http.impl.conn.ManagedClientConnectionImpl.receiveResponseHeader(ManagedClientConnectionImpl.java:197)
at
org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:271)
at
org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:123)
at
org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:682)
at
org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:486)
at
org.apache.http.impl.client.AbstractHttpClient.doExecute(AbstractHttpClient.java:863)
at
org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)
at
org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:106)
at
org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:57)
at
org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:395)
... 9 more

2017-02-04 13:15:15,431 [ERROR] @SolrException.java:120
null:org.apache.solr.common.SolrException:
org.apache.solr.client.solrj.SolrServerException: IOException occured when
talking to server at:
http://nosql-2.dsdb:8093/internal\\_solr/production\\_scheduling
at
org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:308)
at
org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)
at org.apache.solr.core.SolrCore.execute(SolrCore.java:1916)
at
org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:780)
at
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:427)
at
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:217)
at
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)
at
org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)
at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)
at
org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)
at
org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)
at
org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)
at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)
at
org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)
at
org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)
at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)
at
org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)
at
org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)
at
org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)
at org.eclipse.jetty.server.Server.handle(Server.java:368)
at
org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)
at
org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)
at
org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953)
at
org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014)
at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)
at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)
at
org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)
at
org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)
at
org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)
at
org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)
at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.solr.client.solrj.SolrServerException: IOException
occured when talking to server at:
http://nosql-2.dsdb:8093/internal\\_solr/production\\_scheduling
at
org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:507)
at
org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:199)
at
org.apache.solr.handler.component.HttpShardHandler$1.call(HttpShardHandler.java:156)
at
org.apache.solr.handler.component.HttpShardHandler$1.call(HttpShardHandler.java:118)
at java.util.concurrent.FutureTask.run(FutureTask.java:262)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
at java.util.concurrent.FutureTask.run(FutureTask.java:262)
at
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
... 1 more
Caused by: org.apache.http.NoHttpResponseException: The target server
failed to respond
at
org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:143)
at
org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:57)
at
org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:260)
at
org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:283)
at
org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:251)
at
org.apache.http.impl.conn.ManagedClientConnectionImpl.receiveResponseHeader(ManagedClientConnectionImpl.java:197)
at
org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:271)
at
org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:123)
at
org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:682)
at
org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:486)
at
org.apache.http.impl.client.AbstractHttpClient.doExecute(AbstractHttpClient.java:863)
at
org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)
at
org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:106)
at
org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:57)
at
org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:395)
... 9 more


Br,
Alex

2017-02-04 23:30 GMT+08:00 Luke Bakken :

&gt; Hi Alex -
&gt;
&gt; What is in solr.log ?
&gt; --
&gt; Luke Bakken
&gt; Engineer
&gt; lbak...@basho.com
&gt;
&gt;
&gt; On Sat, Feb 4, 2017 at 3:37 AM, Alex Feng  wrote:
&gt; &gt; Hello Riak users,
&gt; &gt;
&gt; &gt; I recently found our solr system got down after running some time, it got
&gt; &gt; recovered after a restart. But then it happened again.
&gt; &gt;
&gt; &gt; Below is the error output, do you guys have any clue about this ?
&gt; &gt;
&gt; &gt;
&gt; &gt; 2017-02-04 18:12:22.329 [error] &lt;0.830.0&gt;@yz\\_kv:index\\_internal:237
&gt; failed to
&gt; &gt; index object
&gt; &gt; {{&lt;&lt;"process\\_test\\_result"&gt;&gt;,&lt;&lt;83,104,105,76,111,110,103,90,105,9
&gt; &gt; 5,77,66,80,65,67,75,45,231,148,159,228,186,167,232,189,
&gt; 166,233,151,180,50,48,49,55,50,52&gt;&gt;},&lt;&lt;"9H5AlII0OZm8xwnGbI"&gt;&gt;}
&gt; &gt; with error {"Failed to index docs",o
&gt; &gt; ther,{error,{conn\\_failed,{error,econnrefused}}}} because
&gt; &gt; [{yz\\_solr,index,3,[{file,"src/yz\\_solr.erl"},{line,205}]},{
&gt; yz\\_kv,index,7,[{file,"src/yz\\_kv.erl"},{
&gt; &gt; line,293}]},{yz\\_kv,index\\_internal,5,[{file,"src/yz\\_kv.
&gt; erl"},{line,224}]},{riak\\_kv\\_vnode,actual\\_put,6,[{file,"
&gt; src/riak\\_kv\\_vnode.erl"},{line,1619}]},{riak\\_k
&gt; &gt; v\\_vnode,perform\\_put,3,[{file,"src/riak\\_kv\\_vnode.erl"},{line,
&gt; 1607}]},{riak\\_kv\\_vnode,do\\_put,7,[{file,"src/riak\\_kv\\_vnode.
&gt; erl"},{line,1398}]},{riak\\_kv\\_vnode,h
&gt; &gt; andle\\_command,3,[{file,"src/riak\\_kv\\_vnode.erl"},{line,558}
&gt; ]},{riak\\_core\\_vnode,vnode\\_command,3,[{file,"src/riak\\_
&gt; core\\_vnode.erl"},{line,346}]}]
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; restart node, got this&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; 2017-02-04 18:13:47.026 [error] &lt;0.4340.0&gt;@yz\\_pb\\_search:maybe\\_
&gt; process:111
&gt; &gt; {solr\\_error,{500,"http://localhost:8093/internal\\_solr/
&gt; process\\_test\\_result/select
&gt; &gt; ",&lt;&lt;"{\\"error\\":{\\"msg\\":\\"org.apache.solr.client.solrj.
&gt; SolrServerException:
&gt; &gt; Server refused connection at:
&gt; &gt; http://nosql-3.dsdb:8093/internal\\_solr/process\\_
&gt; &gt; test\\_result\\",\\"trace\\":\\"org.apache.solr.common.SolrException:
&gt; &gt; org.apache.solr.client.solrj.SolrServerException: Server refused
&gt; connection
&gt; &gt; at: http://nos
&gt; &gt; ql-3.dsdb:8093/internal\\_solr/process\\_test\\_result\\\\n\\\\tat
&gt; &gt; org.apache.solr.handler.component.SearchHandler.handleRequestBody(
&gt; SearchHandler.java:308)\\\\n\\\\tat
&gt; &gt;
&gt; &gt; org.apache.solr.handler.RequestHandlerBase.handleRequest(
&gt; RequestHandlerBase.java:135)\\\\n\\\\tat
&gt; &gt; org.apache.solr.core.SolrCore.execute(SolrCore.java:1916)\\\\
&gt; &gt; n\\\\tat
&gt; &gt; org.apache.solr.servlet.SolrDispatchFilter.execute(
&gt; SolrDispatchFilter.java:780)\\\\n\\\\tat
&gt; &gt; org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDis
&gt; &gt; patchFilter.java:427)\\\\n\\\\tat
&gt; &gt; org.apache.solr.servlet.SolrDispatchFilter.doFilter(
&gt; SolrDispatchFilter.java:217)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.servlet.ServletHa
&gt; &gt; ndler$CachedChain.doFilter(ServletHandler.java:1419)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.servlet.ServletHandler.doHandle(
&gt; ServletHandler.java:455)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.handler.ScopedHandler.handle(
&gt; ScopedHandler.java:137)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.security.SecurityHandler.handle(
&gt; SecurityHandler.java:557)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.session.SessionHandler.
&gt; doHandle(SessionHandler.java:231)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.handler.ContextHandler.
&gt; doHandle(ContextHandler.java:1075)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.servlet.ServletHandler.doScope(
&gt; ServletHandler.java:384)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.session.SessionHandler.
&gt; doScope(SessionHandler.java:193)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.handler.ContextHandler.
&gt; doScope(ContextHandler.java:1009)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.handler.ScopedHandler.handle(
&gt; ScopedHandler.java:135)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(
&gt; ContextHandlerCollection.java:255)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.handler.HandlerCollection.
&gt; handle(HandlerCollection.java:154)\\\\n\\\\tat
&gt; &gt; org.eclipse.jetty.server.handler.HandlerWrap..."&gt;&gt;}}
&gt; &gt; [{yz\\_solr,search,3,[{file,"src/yz\\_solr.erl"},{line,292}]}
&gt; ,{yz\\_pb\\_search,maybe\\_process,3,[{file,"src/yz\\_pb\\_search.
&gt; erl"},{line,76}]},{riak\\_api\\_pb\\_server,process\\_message,4,[{
&gt; file,"src/riak\\_api\\_pb\\_server.erl"},{line,388}]},{riak\\_api\\_
&gt; pb\\_server,connected,2,[{file,"src/riak\\_api\\_pb\\_server.erl"},{
&gt; line,226}]},{riak\\_api\\_pb\\_server,decode\\_buffer,2,[{file,
&gt; "src/riak\\_api\\_pb\\_server.erl"},{line,364}]},{gen\\_fsm,handle\\_
&gt; msg,7,[{file,"gen\\_fsm.erl"},{line,505}]},{proc\\_lib,init\\_p\\_
&gt; do\\_apply,3,[{file,"proc\\_lib.erl"},{line,239}]}]
&gt; &gt; 2017-02-04 18:17:02.756 [error]
&gt; &gt; &lt;0.6871.0&gt;@riak\\_core\\_handoff\\_receiver:handle\\_info:97 Handoff receiver
&gt; for
&gt; &gt; partition 0 exited abnormally after processing 0 objects from
&gt; &gt; {"192.168.9.247",39483}:
&gt; &gt; {error,{vnode\\_timeout,60000,844,&lt;&lt;131,104,2,100,0,10,101,
&gt; 110,99,111,100,101,95,114,97,119,104,3,104,2,109,0,0,0,19,
&gt; 112,114,111,99,101,115,115,95,116,101,115,116,95,114,101,
&gt; 115,117,108,116,109,0,0,0,35,83,104,105,76,111,110,103,90,
&gt; 105,95,77,66,80,65,67,75,45,231,148,159,228,186,167,232,
&gt; 189,166,233,151,180,50,48,49,55,50,52,109,0,0,0,18,57,72,
&gt; 53,65,109,84,122,54,79,109,99,108,87,107,87,68,80,85,109,0,
&gt; 0,2,220,53,1,0,0,0,38,131,108,0,0,0,1,104,2,109,0&gt;&gt;}}
&gt; &gt;
&gt; &gt;
&gt; &gt; Br,
&gt; &gt;
&gt; &gt; Alex
&gt; &gt;
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

