---
title: "Re: CRDT objects and 2i?"
description: ""
project: community
lastmod: 2014-03-26T01:16:30-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13927"
mailinglist_parent_id: "msg13926"
author_name: "Christian Dahlqvist"
project_section: "mailinglistitem"
sent_date: 2014-03-26T01:16:30-07:00
---


Hi Paul,

CRDTs are stored as a normal object in Riak, although in a format that
allows Riak to resolve conflicts automatically, meaning that the normal
restrictions on object size applies. As secondary indexes do not have to be
related to the data in any way, Riak would not be able to determine how
secondary indexes are to be resolved, and secondary indexes are therefore
not supported for CRDTs.

If you need to query CRDTs I would instead recommend enabling Riak Search
2.0 as this supports querying CRDTs through Solr.

Best regards,

Christian


On Wed, Mar 26, 2014 at 6:39 AM, Paul Walk  wrote:

&gt; I'm still a little unclear on the relationship between CRDT, K/V objects
&gt; and buckets. I understand that bucket\\_types add a third level of
&gt; name-spacing, so I expected that so long as I used a bucket\\_type
&gt; consistently I would be able to use CRDT objects with 2i indexes. However,
&gt; using the Ruby client, I find that while this successfully returns my
&gt; previously saved CRDT map called 'my\\_map\\_object\\_key':
&gt;
&gt; map =
&gt; Riak::Crdt::Map.new(my\\_bucket,'my\\_map\\_object\\_key','my\\_map\\_bucket\\_type')
&gt;
&gt; its key is not recognised in the same bucket, using the same bucket\\_type.
&gt; So this:
&gt;
&gt; puts my\\_bucket.get\\_index('$key','0'..'zzzzzzzz',{:bucket\\_type=&gt;
&gt; my\\_map\\_bucket\\_type}).size
&gt;
&gt; returns '0'.
&gt;
&gt; I suspect I am misunderstanding something fundamental - can anyone advise?
&gt;
&gt; Thanks,
&gt;
&gt; Paul
&gt;
&gt; -------------------------------------------
&gt; Paul Walk
&gt; http://www.paulwalk.net
&gt; -------------------------------------------
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

