---
title: "Re: Degraded response times with massive increase in Erlang VM	process memory use"
description: ""
project: community
lastmod: 2013-11-14T08:23:31-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12982"
mailinglist_parent_id: "msg12980"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2013-11-14T08:23:31-08:00
---


Hi Dave,

Could you please provide what version of Riak you're using and a complete
set of archived + compressed logs from a good node and a node experiencing
the memory issue? If the attachments are too large, feel free to mail me
directly and we'll figure something out.

Thanks!



--
Luke Bakken
CSE
lbak...@basho.com


On Thu, Nov 14, 2013 at 1:56 AM, Dave Brady  wrote:

&gt; Hello Everyone,
&gt;
&gt; Two of our five nodes seeing the 100% GET/PUT times (node\\_[get |
&gt; put]\\_fsm\\_time\\_100) increase to as high as 8 seconds, and looking at our
&gt; available metrics we see huge amounts memory being used by Erlang processes
&gt; (memory\\_processed\\_used).
&gt;
&gt; We normally see Erlang processes use tens of MBs, and occasionally a few
&gt; hundred MBs for short periods. One node is now using between 5.2 GB to
&gt; 18.5 GB. The other one is just little lower: 4 GB to 14 GB.
&gt;
&gt; Our average object size is roughly 25 KB.
&gt;
&gt; The logs on these two nodes have lots of:
&gt;
&gt; 2013-11-14 09:26:03.961 [info]
&gt; &lt;0.83.0&gt;@riak\\_core\\_sysmon\\_handler:handle\\_event:92 monitor long\\_gc
&gt; &lt;0.19362.2932&gt;
&gt; [{initial\\_call,{riak\\_core\\_coverage\\_fsm,init,1}},{almost\\_current\\_function,{sms,sms,1}},{message\\_queue\\_len,41}]
&gt; [{timeout,5356},{old\\_heap\\_block\\_size,0},{heap\\_block\\_size,870001580},{mbuf\\_size,0},{stack\\_size,54},{old\\_heap\\_size,0},{heap\\_size,336260414}]
&gt; 2013-11-14 09:26:03.961 [info]
&gt; &lt;0.83.0&gt;@riak\\_core\\_sysmon\\_handler:handle\\_event:92 monitor large\\_heap
&gt; &lt;0.19362.2932&gt;
&gt; [{initial\\_call,{riak\\_core\\_coverage\\_fsm,init,1}},{almost\\_current\\_function,{sms,sms,1}},{message\\_queue\\_len,41}]
&gt; [{old\\_heap\\_block\\_size,0},{heap\\_block\\_size,870001580},{mbuf\\_size,0},{stack\\_size,54},{old\\_heap\\_size,0},{heap\\_size,336260414}]
&gt; 2013-11-14 09:26:03.968 [error] &lt;0.3205.3273&gt; CRASH REPORT Process
&gt; &lt;0.3205.3273&gt; with 0 neighbours crashed with reason: no function clause
&gt; matching webmachine\\_request:peer\\_from\\_peername({error,enotconn},
&gt; {webmachine\\_request,{wm\\_reqstate,#Port&lt;0.38822194&gt;,[],undefined,undefined,undefined,{wm\\_reqdata,...},...}})
&gt; line 150
&gt;
&gt; Anyone seen this before?
&gt; --
&gt; Dave Brady
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

