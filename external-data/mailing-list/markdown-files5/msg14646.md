---
title: "Re: some problems with storage statistic calculation"
description: ""
project: community
lastmod: 2014-08-13T02:01:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14646"
mailinglist_parent_id: "msg14637"
author_name: "Stanislav Vlasov"
project_section: "mailinglistitem"
sent_date: 2014-08-13T02:01:16-07:00
---


2014-08-11 17:03 GMT+06:00 Stanislav Vlasov :

&gt; We have 8 nodes with riak+riak-cs, about 7 Tb data in cluster.
&gt; Some time riak process dead by OOM on several nodes when large
&gt; (~100Gb) file was writed via s3cmd, because riak-cs eated all memory.
&gt; After recovering we experiencing the following problems:
&gt;
&gt; 1) very slow storage statistic calculation (about two hour). Before
&gt; oom it was done in 40 minutes.

After total riak-cs restart statistic calculate fine (about 10 min
from begin to end). But 15 minutes after restart statstic calculation
slowing agan and we see in console log:

2014-08-13 08:18:31.854 [warning]
&lt;0.4043.0&gt;@riak\\_cs\\_manifest:maybe\\_warn\\_bloated\\_manifests:145 Large
manifest size (54195024 bytes) for bucket=&lt;&lt;"test"&gt;&gt; key=
&lt;&lt;"u7850.netangels.ru-20140328-full.tar.lzo"&gt;&gt;
2014-08-13 08:18:43.620 [warning]
&lt;0.4081.0&gt;@riak\\_cs\\_manifest:maybe\\_warn\\_bloated\\_manifests:145 Many
manifest siblings (21 siblings) for bucket=&lt;&lt;"test"&gt;&gt; key=
&lt;&lt;"u7850.netangels.ru-20140328-full.tar.lzo"&gt;&gt;

Filesize was ~120Gb, uploaded before OOM. File does not exists now
(deleted, uploaded with zero size and deleted again), but nothing
changed.

I guess it's a garbage collector issue, because it happen exactly
every 15 minutes ({gc\\_interval,900}) after restart.
What can i do with it?

-- 
Stanislav

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

