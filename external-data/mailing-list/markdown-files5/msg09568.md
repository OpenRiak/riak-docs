---
title: "Re: nebie with volumes and best practices with /var/lib/riak	data directory"
description: ""
project: community
lastmod: 2012-12-12T15:10:02-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09568"
mailinglist_parent_id: "msg09534"
author_name: "Sean Carey"
project_section: "mailinglistitem"
sent_date: 2012-12-12T15:10:02-08:00
---


Hey David, 
My comments are inline. 


On Wednesday, December 12, 2012 at 3:38 AM, David Montgomery wrote:

&gt; Thanks.,that helps...
&gt; 
&gt; So..what happens if I have in existing path on a smaller drive and I attach 
&gt; a new volume and switch? 

- Stop riak. 
- Copy the data out. 
- Mount the new volume with the same permissions. 
- Copy the data in. 
- Start riak. 
- Things should work. 
&gt; In essence looking for best practice on how ot handle this. 
&gt; 

&gt; 
&gt; Is it better to do a rolling upgrade where I start new machines fresh with 1T 
&gt; then remove the smaller nodes 1 by one? So...I have three nodes with 20 gigs 
&gt; each. Increase to 6 nodes. Then one one by remove the old nod and now back 
&gt; to three with 1T each. It does seem that a rolling upgrade involves much 
&gt; less risk.
&gt; 
If you don't have enough disk space. Mount a temporary volume somewhere and 
back the data up (make sure riak is stopped. I would not focus on leaves and 
joins. 

 Make sure to do the copy process 1 node at a time.. 


Please let me know if you need more details. This should work fine and we do 
this all the time. 


&gt; Thanks
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; On Wed, Dec 12, 2012 at 2:13 PM, Sean Carey  (mailto:ca...@basho.com)&gt; wrote:
&gt; &gt; Hey David, 
&gt; &gt; You are correct. You can do 1 of two things here: 
&gt; &gt; 
&gt; &gt; 1) Mount your 1TB volume to /var/lib/riak. All ring, and backend data will 
&gt; &gt; be stored there. 
&gt; &gt; 
&gt; &gt; 2) Mount your volume somewhere like /data/riak and switch the 
&gt; &gt; platform\\_data\\_dir config option to reflect that mounted path. 
&gt; &gt; 
&gt; &gt; If you wanted to snapshot your riak data, it all lives in platform\\_data\\_dir 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Hope this helps, 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Sean 
&gt; &gt; @densone
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On Wednesday, December 12, 2012 at 12:32 AM, David Montgomery wrote:
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; 
&gt; &gt; &gt; I use datapipe for by cloud provider. An I am rather new from a sysadmin 
&gt; &gt; &gt; perspective of having to attach volumes. I am using ubuntu 12.04 64.
&gt; &gt; &gt; 
&gt; &gt; &gt; So...now that I can attach a 1T volume on machine boot....by question is 
&gt; &gt; &gt; this.
&gt; &gt; &gt; 
&gt; &gt; &gt; When I mount the new volume.....should I mount /var/lib/riak? I see 
&gt; &gt; &gt; that the data directory is {platform\\_data\\_dir, "/var/lib/riak"}, from 
&gt; &gt; &gt; the app.config file. Thus data will be written to the new drive solely 
&gt; &gt; &gt; this making use of the 1T? Data will not be stored on the default volume 
&gt; &gt; &gt; which is 20 gigs on datapipe. Then at this point I can snapshot the 
&gt; &gt; &gt; volume to capture all data?
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks
&gt; &gt; &gt; 
&gt; &gt; &gt; David
&gt; &gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

