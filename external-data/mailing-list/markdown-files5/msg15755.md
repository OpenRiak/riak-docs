---
title: "Re: Riak stalls, leveldb backend"
description: ""
project: community
lastmod: 2015-02-19T12:20:57-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15755"
mailinglist_parent_id: "msg15689"
author_name: "Andy Pellett"
project_section: "mailinglistitem"
sent_date: 2015-02-19T12:20:57-08:00
---


Hi Luke,

Your prediction was spot on.

Today, about 2 weeks after setting the parameters from my earlier email, we
saw riak nodes start to run out of memory and fail.

I have to say, it was a great 2 weeks though.

I've adjusted the parameters again, this time paying attention the linked
spreadsheet.

Thanks for your advice,
Andy

On Wed, Feb 11, 2015 at 6:36 PM, Luke Bakken  wrote:

&gt; Hi Andy,
&gt;
&gt; I'd like to strongly recommend using the spreadsheet linked to by this
&gt; document:
&gt;
&gt; http://docs.basho.com/riak/1.4.12/ops/advanced/backends/leveldb/
&gt;
&gt; Spreadsheet:
&gt; https://docs.google.com/spreadsheet/ccc?key=0AnW\\_U8Qe8NdYdGk2V3Qza0VRNkxyRFNGUVVCV0c3V3c&usp=sharing#gid=0
&gt;
&gt; The reason I bring it up is that the parameters you list will most
&gt; certainly exhaust RAM at some point.
&gt;
&gt; --
&gt; Luke Bakken
&gt; Engineer
&gt; lbak...@basho.com
&gt;
&gt; On Wed, Feb 11, 2015 at 11:47 AM, Andy Pellett  wrote:
&gt; &gt; Hi All,
&gt; &gt;
&gt; &gt; I ran across this page:
&gt; &gt;
&gt; &gt; http://docs.basho.com/riak/1.0.0/tutorials/choosing-a-backend/LevelDB/
&gt; &gt;
&gt; &gt; and ended up tuning the following parameters:
&gt; &gt;
&gt; &gt; max\\_open\\_files 16384
&gt; &gt; write\\_buffer\\_size\\_min 1gb
&gt; &gt; write\\_buffer\\_size\\_max 2gb
&gt; &gt; cache\\_size 15gb
&gt; &gt; block\\_size 262144
&gt; &gt;
&gt; &gt; Since making these changes about a week ago, I've seen considerably fewer
&gt; &gt; compactions, and no stalls. Hoping this holds up.
&gt; &gt;
&gt; &gt; Andy
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

