<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: big cache vs. many partitions and replicas placement</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09898" id="c">
<link rel="index" href="maillist.html#09898" id="i">
<link rel="prev" href="msg09893.html" id="p">
<link rel="next" href="msg09909.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09898.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+big+cache+vs.+many+partitions+and+replicas+placement%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: big cache vs. many partitions and replicas placement</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Christian+Dahlqvist%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Christian Dahlqvist</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130128" rel="nofollow">Mon, 28 Jan 2013 09:24:53 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Simon,

By cache size, I am assuming you are referring to the leveldb internal cache. 
Is this correct?</pre><pre>

The arguably most important parameter in your configuration is the ring size. 
Defining an appropriate ring size is very important as it can't change later on 
and determines how far you can scale. It is recommended that you allow for at 
about 10 partitions per physical node 
(<a  rel="nofollow" href="http://docs.basho.com/riak/1.3.0/references/appendices/Cluster-Capacity-Planning/#Ring-Size-Number-of-Partitions">http://docs.basho.com/riak/1.3.0/references/appendices/Cluster-Capacity-Planning/#Ring-Size-Number-of-Partitions</a>),
 which means that if you are preparing for a cluster of around 20 nodes, you 
should probably use 256 partitions.

At the moment we do not recommend tuning the eleveldb cache_size at all, so it 
would be best to leave it at the default value.

With an n_val of 3, Riak will store every record on 3 consecutive vnodes in the 
ring. The case where multiple copies may end up on less than 3 different 
physical servers primarily applies to cases where there are less than 4 nodes 
in the cluster as nodes will repeat around the ring wrap around point.This is 
one of the reasons we recommend using at least 5 nodes in the cluster.

Best regards,

Christian


On 28 Jan 2013, at 15:47, &quot;Effenberg, Simon&quot; &lt;seffenb...@team.mobile.de&gt; wrote:

&gt; Hi,
&gt; 
&gt; we want to save plenty of mails in riak which are in average 14k big. Our 
&gt; cluster will become between 10 to 20 nodes so the question is: what is 
&gt; better, having more partitions but each has less cache or is it the other way 
&gt; around so having less partitions with more cache size?
&gt; 
&gt; Also with an n_val of 3 it is always said, that there is no guarantee for 
&gt; having this on 3 physical nodes but also that it should be distributed 
&gt; evenly. What does it mean? Is there any calculation I can do to get a feeling 
&gt; how often 3 replicas are only on 2 nodes? Or can you say: with 6 nodes and an 
&gt; n_val of 3 it should be the case that almost 99.9 percent is distributed over 
&gt; different physical nodes?
&gt; 
&gt; Cheers,
&gt; Simon
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09893.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09898">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09898">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09909.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg09893.html">big cache vs. many partitions and replicas placement</a></span> <span class="sender italic">Effenberg, Simon</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: big cache vs. many partitions and replicas pl...</span> <span class="sender italic">Christian Dahlqvist</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09909.html">Re: big cache vs. many partitions and replica...</a></span> <span class="sender italic">Simon Effenberg</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: big cache vs. many partitions and replicas placement">
<input type="hidden" name="msgid" value="7C6B2122-0639-41FC-8AC9-A49C80C68844@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09898.html">
<input type="submit" value=" Christian Dahlqvist ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+big+cache+vs.+many+partitions+and+replicas+placement%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09893.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09909.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">7C6B2122-0639-41FC-8AC9-A49C80C68844@basho.com</li>
</ul>
</div>
</body>
</html>
