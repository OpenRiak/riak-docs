<!DOCTYPE html>
<html lang="en">
<head>
<title>Very slow acquisition time (99 percentile) while fast median times</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#17267" id="c">
<link rel="index" href="maillist.html#17267" id="i">
<link rel="prev" href="msg17265.html" id="p">
<link rel="next" href="msg17268.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg17267.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Very+slow+acquisition+time+%5C%2899+percentile%5C%29+while+fast+median+times%22&amp;o=newest" rel="nofollow"><span itemprop="name">Very slow acquisition time (99 percentile) while fast median times</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Guillaume+Boddaert%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Guillaume Boddaert</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20160502" rel="nofollow">Mon, 02 May 2016 04:48:25 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi,

</pre><tt>I'm trying to setup a production environment with Riak as backend. 
</tt><tt>Unfortunately I have very slow write times that bottleneck my whole system.
</tt><pre style="margin: 0em;"></pre><pre>

</pre><tt>Here is a sample of one of my node (riak-admin status | grep -e 
</tt><tt>'^node_put_fsm_time'):
</tt><pre style="margin: 0em;">
node_put_fsm_time_100 : 3305516
node_put_fsm_time_95 : 230589
node_put_fsm_time_99 : 1694593
node_put_fsm_time_mean : 79864
node_put_fsm_time_median : 14973

</pre><tt>As you can see, I have really good times for most of my writes, yet the 
</tt><tt>mean time is not so good because a few writes are taking long (Up to 3 
</tt><tt>seconds)
</tt><pre style="margin: 0em;">
How can I get rid of those slow insert ? Is that intended/normal ?

My setup is the following:
</pre><tt>5 hosts (2CPU, %Cpu(s): 47,1 us,  1,3 sy,  0,0 ni, 51,3 id,  0,0 wa,  
</tt><tt>0,0 hi,  0,2 si,  0,0 st) , ring_size: 128, aae disabled.
</tt><pre style="margin: 0em;">
Writes are w=1 dw=0
each host has 32go of ram, that is almost used for system caching only.
My data are stored on an openstack volume that support up to 3000IOPS.

Here is an iostat sample for 1 minute:
avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          38.00    0.00    1.81    0.03    0.08   60.07

Device:            tps    kB_read/s    kB_wrtn/s    kB_read kB_wrtn
vda               0.37         0.00         2.27          0 136
vdb               9.60         0.00       294.53          0 17672

Thanks,

Guilaume BODDAERT

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg17265.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#17267">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#17267">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg17268.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Very slow acquisition time (99 percentile) while fas...</span> <span class="sender italic">Guillaume Boddaert</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17268.html">Re: Very slow acquisition time (99 percentile) ...</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17271.html">Re: Very slow acquisition time (99 percenti...</a></span> <span class="sender italic">Guillaume Boddaert</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17272.html">Re: Very slow acquisition time (99 perc...</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17273.html">Re: Very slow acquisition time (99 ...</a></span> <span class="sender italic">Guillaume Boddaert</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17274.html">Re: Very slow acquisition time...</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17275.html">Re: Very slow acquisition ...</a></span> <span class="sender italic">Guillaume Boddaert</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17276.html">Re: Very slow acquisit...</a></span> <span class="sender italic">Luke Bakken</span></li>
<li class="icons-email"><span class="subject"><a href="msg17281.html">Re: Very slow acquisit...</a></span> <span class="sender italic">Guillaume Boddaert</span></li>
<li class="icons-email"><span class="subject"><a href="msg17282.html">Re: Very slow acquisit...</a></span> <span class="sender italic">Luke Bakken</span></li>
<li class="icons-email"><span class="subject"><a href="msg17283.html">Re: Very slow acquisit...</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Very slow acquisition time (99 percentile) while fast median times">
<input type="hidden" name="msgid" value="57273DED.7020707@lighthouse-analytics.co">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg17267.html">
<input type="submit" value=" Guillaume Boddaert ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Very+slow+acquisition+time+%5C%2899+percentile%5C%29+while+fast+median+times%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg17265.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg17268.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">57273DED.7020707@lighthouse-analytics.co</li>
</ul>
</div>
</body>
</html>
