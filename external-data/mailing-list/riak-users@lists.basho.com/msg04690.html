<!DOCTYPE html>
<html lang="en">
<head>
<title>Riak Socket Exception using PBCClient</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04690" id="c">
<link rel="index" href="maillist.html#04690" id="i">
<link rel="prev" href="msg04686.html" id="p">
<link rel="next" href="msg04692.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04690.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+Socket+Exception+using+PBCClient%22&amp;o=newest" rel="nofollow"><span itemprop="name">Riak Socket Exception using PBCClient</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Harshal+Dhir%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Harshal Dhir</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110913" rel="nofollow">Tue, 13 Sep 2011 16:39:56 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Folks,
</pre><pre>

I am using Riak Search v0.14.2 5-Node-cluster. We are trying to write a
distributed application using RabbitMQ. But, for some reason riak is
bombing out on me and giving me &quot;Broken Pipe&quot; exceptions.

We are using the latest riak java pbc client.

Here is the detailed error:com.sna.cube.iface:
com.basho.riak.client.cap.DefaultRetrier.attempt(DefaultRetrier.java:75)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
com.basho.riak.client.cap.DefaultRetrier.attempt(DefaultRetrier.java:51)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
com.basho.riak.client.operations.StoreObject.execute(StoreObject.java:116)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
com.basho.riak.client.bucket.DomainBucket.store(DomainBucket.java:139)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
org.com.sna.base.service.component.RiakService.save(DataService.scala:30)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
org.com.sna.base.iface.data.Persistable$class.save(Persistable.scala:16)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
org.com.sna.base.model.document.DocumentCategory.save(DocumentCategory.scal
a:22)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
org.com.sna.cube.iface.CubeProcessorComponent$SimpleConsumer.processMessage
(CubeProcessorComponent.scala:90)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
org.com.sna.cube.iface.CubeProcessorComponent$SimpleConsumer.handleDelivery
(CubeProcessorComponent.scala:68)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
com.rabbitmq.client.impl.ChannelN.processAsync(ChannelN.java:292)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
com.rabbitmq.client.impl.AMQChannel.handleCompleteInboundCommand(AMQChannel
.java:154)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:99)
ERR [20110913-16:26:15.231] org.dell.sna.cube.iface:
com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:443)



Thanks
Harshal









On 9/12/11 7:19 PM, &quot;riak-users-requ...@lists.basho.com&quot;
&lt;riak-users-requ...@lists.basho.com&gt; wrote:

&gt;Send riak-users mailing list submissions to
&gt;        riak-users@lists.basho.com
&gt;
&gt;To subscribe or unsubscribe via the World Wide Web, visit
&gt;        <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;or, via email, send a message with subject or body 'help' to
&gt;        riak-users-requ...@lists.basho.com
&gt;
&gt;You can reach the person managing the list at
&gt;        riak-users-ow...@lists.basho.com
&gt;
&gt;When replying, please edit your Subject line so it is more specific
&gt;than &quot;Re: Contents of riak-users digest...&quot;
&gt;
&gt;
&gt;Today's Topics:
&gt;
&gt;   1. Re: Question from a noob about link walking (Dan Reverri)
&gt;   2. Misbehaving bucket (Jeremy Raymond)
&gt;   3. Re: Misbehaving bucket (Daniel Reverri)
&gt;   4. Re: Misbehaving bucket (Jeremy Raymond)
&gt;   5. riak-1.0.0pre2 segfaults (Henrik Johansen)
&gt;   6. Riak Recap for September 9 - 11 (Mark Phillips)
&gt;   7. Re: riak-1.0.0pre2 segfaults (Mark Phillips)
&gt;   8. Re: riak-1.0.0pre2 segfaults (Ryan Zezeski)
&gt;
&gt;
&gt;----------------------------------------------------------------------
&gt;
&gt;Message: 1
&gt;Date: Mon, 12 Sep 2011 09:18:25 -0700
&gt;From: Dan Reverri &lt;d...@basho.com&gt;
&gt;To: Antonio Fern?ndez Vara &lt;antoniofernandezv...@gmail.com&gt;
&gt;Cc: riak-users &lt;riak-users@lists.basho.com&gt;
&gt;Subject: Re: Question from a noob about link walking
&gt;Message-ID:
&gt;
&gt;&lt;CAAJ=b5kfjcvka+1t6ew6q-7hhkqekwcidxesvtncwu7rfm5...@mail.gmail.com&gt;
&gt;Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
&gt;
&gt;Hi Antonio,
&gt;
&gt;Links only work in one direction so it is not possible to find the items
&gt;that link to an object. You would need to apply links on both sides of the
&gt;relationship.
&gt;
&gt;Thanks,
&gt;Dan
&gt;
&gt;Daniel Reverri
&gt;Developer Advocate
&gt;Basho Technologies, Inc.
&gt;d...@basho.com
&gt;
&gt;
&gt;2011/9/12 Antonio Fern?ndez Vara &lt;antoniofernandezv...@gmail.com&gt;
&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I'm using Ruby and I'm trying to learn how to use Riak basics, now I'm
&gt;&gt; learning links and I have a question I know will be so easy to answer by
&gt;&gt; you, experts :).
&gt;&gt;
&gt;&gt; I know how to search with a simple MapReduce query what items I'm
&gt;&gt;linking,
&gt;&gt; but now the opposite, what items links me.
&gt;&gt;
&gt;&gt; As little concept I've made this simple script, just it creates 10
&gt;&gt;items in
&gt;&gt; a bucket, 20 relations as follow, 20 as like (I don't try to do the next
&gt;&gt; graph thing, just was the first tags that come to my brain):   (BTW: I
&gt;&gt;have
&gt;&gt; tryed to find how this is done in ripple but seems I need to study more
&gt;&gt;to
&gt;&gt; obtain the answer looking the code Sean wrote).
&gt;&gt;
&gt;&gt; As you can see, I just create those 10 items in the bucket (1..10) and
&gt;&gt; randomly add the relations. The mapreduce function works showing me all
&gt;&gt;the
&gt;&gt; links in each relation for each object in the last iteration.
&gt;&gt;
&gt;&gt; Now, I'm trying to find how to get the reverse.
&gt;&gt;
&gt;&gt; Thank you in advance. Hope someone can get some time and help me.
&gt;&gt;
&gt;&gt; -- test-creator.rb --
&gt;&gt; require 'rubygems'
&gt;&gt; require 'riak'
&gt;&gt;
&gt;&gt; client = Riak::Client.new
&gt;&gt; client.http_port = 8091
&gt;&gt;
&gt;&gt; bucket_name = &quot;users8&quot; #change for test in different bucket
&gt;&gt;
&gt;&gt; bucket = client.bucket(bucket_name)
&gt;&gt;
&gt;&gt; 10.times do |n|
&gt;&gt;   o = bucket.new(&quot;#{n + 1}&quot;)
&gt;&gt;   o.data = &quot;#{n + 1}&quot;
&gt;&gt;   o.store
&gt;&gt; end
&gt;&gt;
&gt;&gt; 20.times do |n|
&gt;&gt;   source = rand(10) + 1
&gt;&gt;   destination = rand(10) + 1
&gt;&gt;   puts &quot;#{source} --&gt; follow --&gt; #{destination}&quot;
&gt;&gt;   o = bucket[&quot;#{source}&quot;]
&gt;&gt;   o.links &lt;&lt; Riak::Link.new(bucket_name, destination, 'follow')
&gt;&gt;   o.store
&gt;&gt; end
&gt;&gt;
&gt;&gt; 20.times do |n|
&gt;&gt;   source = rand(10) + 1
&gt;&gt;   destination = rand(10) + 1
&gt;&gt;   puts &quot;#{source} --&gt; like --&gt; #{destination}&quot;
&gt;&gt;   o = bucket[&quot;#{source}&quot;]
&gt;&gt;   o.links &lt;&lt; Riak::Link.new(bucket_name, destination, 'like')
&gt;&gt;   o.store
&gt;&gt; end
&gt;&gt;
&gt;&gt; 10.times do |n|
&gt;&gt;   results = Riak::MapReduce.new(client).add(bucket_name, &quot;#{n +
&gt;&gt; 1}&quot;).link(:bucket =&gt; bucket_name, :tag =&gt; 'follow').map(&quot;function(v) {
&gt;&gt; return [JSON.parse(v.values[0].data)]; }&quot;, :keep =&gt; true).run
&gt;&gt;   puts &quot;follow #{n + 1} = &quot;
&gt;&gt;   p results
&gt;&gt;   results = Riak::MapReduce.new(client).add(bucket_name, &quot;#{n +
&gt;&gt; 1}&quot;).link(:bucket =&gt; bucket_name, :tag =&gt; 'like').map(&quot;function(v) {
&gt;&gt;return
&gt;&gt; [JSON.parse(v.values[0].data)]; }&quot;, :keep =&gt; true).run
&gt;&gt;   puts &quot;like #{n + 1} = &quot;
&gt;&gt;   p results
&gt;&gt; end
&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;-------------- next part --------------
&gt;An HTML attachment was scrubbed...
&gt;URL:
&gt;&lt;<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2">http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2</a>
&gt;0110912/7f27e784/attachment-0001.html&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 2
&gt;Date: Mon, 12 Sep 2011 13:13:16 -0400
&gt;From: Jeremy Raymond &lt;jeraym...@gmail.com&gt;
&gt;To: riak-users@lists.basho.com
&gt;Subject: Misbehaving bucket
&gt;Message-ID:
&gt;
&gt;&lt;cae_i+t8i2kv9o4mmt0-ex5naocgjv2s268mfsqjsqdfcmtq...@mail.gmail.com&gt;
&gt;Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
&gt;
&gt;Hello,
&gt;
&gt;I have a bucket with about 70 items in it the Keys look like this
&gt;&lt;&lt;&quot;1294549200_UbEu1topckAFu2UYy3spr8AG5lc&quot;&gt;&gt; and the values are about 2.8K
&gt;of JSON. For some reason operations on data in this bucket are extremely
&gt;slow. It takes between 5 - 10 seconds to read a value of of the bucket by
&gt;it's key using the Erlang protobuf client. When I do the reads the CPU of
&gt;the node I'm connecting to spikes using up 100% usage on the Riak beam
&gt;process.
&gt;
&gt;I can read data out of any of the other 9 buckets in the system some of
&gt;which have a lot more items in them (one as &gt; 16k items) and the
&gt;operations
&gt;are super fast.
&gt;
&gt;There are no errors in the sasl-error.log files and everything looks
&gt;normal
&gt;in the erlang.log files. Any ideas on what may cause a bucket to churn
&gt;like
&gt;this?
&gt;
&gt;- Jeremy
&gt;-------------- next part --------------
&gt;An HTML attachment was scrubbed...
&gt;URL:
&gt;&lt;<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2">http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2</a>
&gt;0110912/3ca0c903/attachment-0001.html&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 3
&gt;Date: Mon, 12 Sep 2011 10:43:59 -0700
&gt;From: Daniel Reverri &lt;d...@basho.com&gt;
&gt;To: Jeremy Raymond &lt;jeraym...@gmail.com&gt;
&gt;Cc: &quot;riak-users@lists.basho.com&quot; &lt;riak-users@lists.basho.com&gt;
&gt;Subject: Re: Misbehaving bucket
&gt;Message-ID: &lt;c956420c-c7cb-4a72-b6f7-e1b185ce2...@basho.com&gt;
&gt;Content-Type: text/plain;       charset=us-ascii
&gt;
&gt;Hi Jeremy
&gt;
&gt;Are you doing a full bucket query or retrieving individual objects?
&gt;
&gt;Is your bucket configured to allow siblings (allow_mult=true)? Do the
&gt;objects being retrieved have many siblings?
&gt;
&gt;Are you using multiple backends?
&gt;
&gt;Thanks
&gt;Dan
&gt;
&gt;Sent from my iPhone
&gt;
&gt;On Sep 12, 2011, at 10:13 AM, Jeremy Raymond &lt;jeraym...@gmail.com&gt; wrote:
&gt;
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I have a bucket with about 70 items in it the Keys look like this
&gt;&gt;&lt;&lt;&quot;1294549200_UbEu1topckAFu2UYy3spr8AG5lc&quot;&gt;&gt; and the values are about
&gt;&gt;2.8K of JSON. For some reason operations on data in this bucket are
&gt;&gt;extremely slow. It takes between 5 - 10 seconds to read a value of of
&gt;&gt;the bucket by it's key using the Erlang protobuf client. When I do the
&gt;&gt;reads the CPU of the node I'm connecting to spikes using up 100% usage
&gt;&gt;on the Riak beam process.
&gt;&gt;
&gt;&gt; I can read data out of any of the other 9 buckets in the system some of
&gt;&gt;which have a lot more items in them (one as &gt; 16k items) and the
&gt;&gt;operations are super fast.
&gt;&gt;
&gt;&gt; There are no errors in the sasl-error.log files and everything looks
&gt;&gt;normal in the erlang.log files. Any ideas on what may cause a bucket to
&gt;&gt;churn like this?
&gt;&gt;
&gt;&gt; - Jeremy
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 4
&gt;Date: Mon, 12 Sep 2011 14:22:43 -0400
&gt;From: Jeremy Raymond &lt;jeraym...@gmail.com&gt;
&gt;To: Daniel Reverri &lt;d...@basho.com&gt;
&gt;Cc: &quot;riak-users@lists.basho.com&quot; &lt;riak-users@lists.basho.com&gt;
&gt;Subject: Re: Misbehaving bucket
&gt;Message-ID:
&gt;
&gt;&lt;cae_i+t_xrcqgbfzcpn2cjjwowdn38yavma820hh04uvivso...@mail.gmail.com&gt;
&gt;Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
&gt;
&gt;I did riakc_pb_socket:list_keys/2 which completes quickly, then fetched
&gt;each
&gt;object individually by the key using riakc_pb_socket:get/3 which was slow.
&gt;
&gt;The bucket uses the default settings (see below), allow_mult=false, using
&gt;a
&gt;single bitcask backend.
&gt;
&gt;I came across this problem because one of the Riak nodes was reporting via
&gt;Nagios to be short of disk space. Investigating I found that
&gt;/var/lib/riak/bitcask was taking up about 24GB of disk. This much disk
&gt;usage
&gt;was crazy big, since there's probably less than 100MB of data I'm storing
&gt;in
&gt;Riak. Since my original email I've deleted all item in the misbehaving
&gt;bucket (it took several tries as the read slowness/CPU usage
&gt;also appeared on delete operations). The bitcask folder is now 44MB in
&gt;size
&gt;(down from 24GB!). I've repopulated the data in the bucket now storing 157
&gt;items. Things seem to be back to normal for this bucket.
&gt;
&gt;Perhaps I inadvertently pushed something large into the bucket, but each
&gt;of
&gt;the items I put in there was only about 3K in size - this doesn't seem
&gt;likely to me.
&gt;
&gt;
&gt;Bucket Properties:
&gt;{&quot;props&quot;:{&quot;name&quot;:&quot;suite_diff&quot;,&quot;n_val&quot;:3,&quot;allow_mult&quot;:false,&quot;last_write_win
&gt;s&quot;:false,&quot;precommit&quot;:[],&quot;postcommit&quot;:[],&quot;chash_keyfun&quot;:{&quot;mod&quot;:&quot;riak_core_u
&gt;til&quot;,&quot;fun&quot;:&quot;chash_std_keyfun&quot;},&quot;linkfun&quot;:{&quot;mod&quot;:&quot;riak_kv_wm_link_walker&quot;,&quot;
&gt;fun&quot;:&quot;mapreduce_linkfun&quot;},&quot;old_vclock&quot;:86400,&quot;young_vclock&quot;:20,&quot;big_vclock
&gt;&quot;:50,&quot;small_vclock&quot;:10,&quot;r&quot;:&quot;quorum&quot;,&quot;w&quot;:&quot;quorum&quot;,&quot;dw&quot;:&quot;quorum&quot;,&quot;rw&quot;:&quot;quoru
&gt;m&quot;}}
&gt;
&gt;- Jeremy
&gt;
&gt;
&gt;On Mon, Sep 12, 2011 at 1:43 PM, Daniel Reverri &lt;d...@basho.com&gt; wrote:
&gt;
&gt;&gt; Hi Jeremy
&gt;&gt;
&gt;&gt; Are you doing a full bucket query or retrieving individual objects?
&gt;&gt;
&gt;&gt; Is your bucket configured to allow siblings (allow_mult=true)? Do the
&gt;&gt; objects being retrieved have many siblings?
&gt;&gt;
&gt;&gt; Are you using multiple backends?
&gt;&gt;
&gt;&gt; Thanks
&gt;&gt; Dan
&gt;&gt;
&gt;&gt; Sent from my iPhone
&gt;&gt;
&gt;&gt; On Sep 12, 2011, at 10:13 AM, Jeremy Raymond &lt;jeraym...@gmail.com&gt;
&gt;&gt;wrote:
&gt;&gt;
&gt;&gt; &gt; Hello,
&gt;&gt; &gt;
&gt;&gt; &gt; I have a bucket with about 70 items in it the Keys look like this
&gt;&gt; &lt;&lt;&quot;1294549200_UbEu1topckAFu2UYy3spr8AG5lc&quot;&gt;&gt; and the values are about
&gt;&gt;2.8K
&gt;&gt; of JSON. For some reason operations on data in this bucket are extremely
&gt;&gt; slow. It takes between 5 - 10 seconds to read a value of of the bucket
&gt;&gt;by
&gt;&gt; it's key using the Erlang protobuf client. When I do the reads the CPU
&gt;&gt;of
&gt;&gt; the node I'm connecting to spikes using up 100% usage on the Riak beam
&gt;&gt; process.
&gt;&gt; &gt;
&gt;&gt; &gt; I can read data out of any of the other 9 buckets in the system some
&gt;&gt;of
&gt;&gt; which have a lot more items in them (one as &gt; 16k items) and the
&gt;&gt;operations
&gt;&gt; are super fast.
&gt;&gt; &gt;
&gt;&gt; &gt; There are no errors in the sasl-error.log files and everything looks
&gt;&gt; normal in the erlang.log files. Any ideas on what may cause a bucket to
&gt;&gt; churn like this?
&gt;&gt; &gt;
&gt;&gt; &gt; - Jeremy
&gt;&gt; &gt; _______________________________________________
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;-------------- next part --------------
&gt;An HTML attachment was scrubbed...
&gt;URL:
&gt;&lt;<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2">http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2</a>
&gt;0110912/ba1262bd/attachment-0001.html&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 5
&gt;Date: Mon, 12 Sep 2011 22:09:47 +0200
&gt;From: Henrik Johansen &lt;hen...@myunix.dk&gt;
&gt;To: riak-users@lists.basho.com
&gt;Subject: riak-1.0.0pre2 segfaults
&gt;Message-ID: &lt;20110912200947.GA6356@warrier&gt;
&gt;Content-Type: text/plain; charset=us-ascii; format=flowed
&gt;
&gt;Hello list,
&gt;
&gt;I have been playing with single node riak-1.0.0pre2 cluster &amp; riaktant
&gt;today and somehow I managed to get riak to segfault every time I tried
&gt;using the MapReduce functions in riaktant.
&gt;
&gt;Riak-1.0.0pre2 was installed using the 64-bit Debian package on my
&gt;Ubuntu 11.04 laptop - riaktant was pulled form GitHub.
&gt;
&gt;I have gathered some relevant info below - if I can assist in any way
&gt;please let me know ...
&gt;
&gt;dmesg :
&gt;[10488.941750] beam.smp[1496]: segfault at 7f4d61d73ff8 ip
&gt;00007f4d5ea7a83e sp 00007f4d61d74000 error 6 in
&gt;erlang_js_drv.so[7f4d5ea35000+e6000]
&gt;[10944.335495] beam.smp[4681]: segfault at 7fcda9892ff8 ip
&gt;00007fcda386783e sp 00007fcda9893000 error 6 in
&gt;erlang_js_drv.so[7fcda3822000+e6000]
&gt;[11658.589251] beam.smp[6604]: segfault at 7fee7166eff8 ip
&gt;00007fee6dc4983e sp 00007fee7166f000 error 6 in
&gt;erlang_js_drv.so[7fee6dc04000+e6000]
&gt;
&gt;crash.log :
&gt;2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;      Supervisor: {local,riak_pipe_builder_sup}
&gt;      Context:    child_terminated
&gt;      Reason:
&gt;
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;      error before:
&gt;
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;      Offender:
&gt;
&gt;[{pid,&lt;0.1556.0&gt;},{name,undefined},{mfargs,{riak_pipe_builder,start_link,u
&gt;ndefined}},{restart_type,temporary},{shutdown,brutal_kill},{child_type,wor
&gt;ker}]
&gt;
&gt;2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;      Supervisor: {local,riak_pipe_fitting_sup}
&gt;      Context:    child_terminated
&gt;      Reason:
&gt;
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;      error before:
&gt;
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;      Offender:
&gt;
&gt;[{pid,&lt;0.1558.0&gt;},{name,undefined},{mfargs,{riak_pipe_fitting,start_link,u
&gt;ndefined}},{restart_type,temporary},{shutdown,2000},{child_type,worker}]
&gt;
&gt;2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;      Supervisor: {local,riak_pipe_fitting_sup}
&gt;      Context:    child_terminated
&gt;      Reason:
&gt;
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;      error before:
&gt;
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;      Offender:
&gt;
&gt;[{pid,&lt;0.1559.0&gt;},{name,undefined},{mfargs,{riak_pipe_fitting,start_link,u
&gt;ndefined}},{restart_type,temporary},{shutdown,2000},{child_type,worker}]
&gt;
&gt;2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;      Supervisor: {local,riak_pipe_fitting_sup}
&gt;      Context:    child_terminated
&gt;      Reason:
&gt;
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;      error before:
&gt;
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;      Offender:
&gt;
&gt;[{pid,&lt;0.1557.0&gt;},{name,undefined},{mfargs,{riak_pipe_fitting,start_link,u
&gt;ndefined}},{restart_type,temporary},{shutdown,2000},{child_type,worker}]
&gt;
&gt;error.log :
&gt;2011-09-12 21:49:03.025 [error] &lt;0.132.0&gt; Supervisor
&gt;riak_pipe_builder_sup had child at module undefined at &lt;0.1556.0&gt; exit
&gt;with reason
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;error before:
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;in context child_terminated
&gt;2011-09-12 21:49:03.028 [error] &lt;0.133.0&gt; Supervisor
&gt;riak_pipe_fitting_sup had child at module undefined at &lt;0.1558.0&gt; exit
&gt;with reason
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;error before:
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;in context child_terminated
&gt;2011-09-12 21:49:03.031 [error] &lt;0.133.0&gt; Supervisor
&gt;riak_pipe_fitting_sup had child at module undefined at &lt;0.1559.0&gt; exit
&gt;with reason
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;error before:
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;in context child_terminated
&gt;2011-09-12 21:49:03.033 [error] &lt;0.133.0&gt; Supervisor
&gt;riak_pipe_fitting_sup had child at module undefined at &lt;0.1557.0&gt; exit
&gt;with reason
&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{e
&gt;rror,{lucene_parse,&quot;syntax
&gt;error before:
&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{riak
&gt;_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_pip
&gt;e,'-send_inputs_async/3-fun-0-',3}]}
&gt;in context child_terminated
&gt;
&gt;/HenrikJ
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 6
&gt;Date: Mon, 12 Sep 2011 16:38:42 -0700
&gt;From: Mark Phillips &lt;m...@basho.com&gt;
&gt;To: riak-users &lt;riak-users@lists.basho.com&gt;
&gt;Subject: Riak Recap for September 9 - 11
&gt;Message-ID:
&gt;
&gt;&lt;CAE8zJQEumRU=Wpd4Gy9_JvzFe08rRbBUd4dc6Ju5stWme=o...@mail.gmail.com&gt;
&gt;Content-Type: text/plain; charset=ISO-8859-1
&gt;
&gt;Afternoon, Evening, Morning to All
&gt;
&gt;For today's Recap: talks, blog posts, jobs, and more.
&gt;
&gt;Enjoy.
&gt;
&gt;Mark
&gt;
&gt;Community Manager
&gt;Basho Technologies
&gt;wiki.basho.com
&gt;twitter.com/pharkmillups
&gt;------------------------
&gt;
&gt;Riak Recap for September 9 - 11
&gt;========================
&gt;
&gt;1) Mark Cavage wrote a lengthy post on just about everything you would
&gt;ever want to know about LDAP. More importantly he explains why he's
&gt;working on it at Joyent and why they are using Riak with LDAP.
&gt;
&gt;* Read here ---&gt;
&gt;<a  rel="nofollow" href="http://blog.nodejs.org/2011/09/08/ldapjs-a-reprise-of-ldap/">http://blog.nodejs.org/2011/09/08/ldapjs-a-reprise-of-ldap/</a>
&gt;
&gt;2) Basho COO Tony Falco was in the Wall St. Journal talking about the
&gt;history of Basho and Riak, why Riak is so compelling. Basho is part of
&gt;the &quot;Small Business, Large Innovation&quot; competition the WSJ is running
&gt;and we could use your vote.
&gt;
&gt;* Read and vote here ---&gt; *
&gt;<a  rel="nofollow" href="http://blogs.wsj.com/biginnovation/2011/09/09/basho-technologies/">http://blogs.wsj.com/biginnovation/2011/09/09/basho-technologies/</a>
&gt;
&gt;3) Strange Loop is less than a week away, so here's the rundown of
&gt;Riak-flavored talks happening in St. Louis next week.
&gt;
&gt;* Susan Potter will be talking about using riak_core to build
&gt;distributed applications ---&gt;
&gt;<a  rel="nofollow" href="https://thestrangeloop.com/sessions/dynamo-is-not-just-for-datastores">https://thestrangeloop.com/sessions/dynamo-is-not-just-for-datastores</a>
&gt;* Kresten Krab Thorup will be talking about Bringing Riak to the
&gt;Mobile Platform ---&gt;
&gt;<a  rel="nofollow" href="https://thestrangeloop.com/sessions/bringing-riak-to-the-mobile-platform">https://thestrangeloop.com/sessions/bringing-riak-to-the-mobile-platform</a>
&gt;* Sean Cribbs will be talking about Riak's MapReduce in relation to
&gt;traditional SQL ---&gt;
&gt;<a  rel="nofollow" href="https://thestrangeloop.com/sessions/wrap-your-sql-head-around-riak-mapredu">https://thestrangeloop.com/sessions/wrap-your-sql-head-around-riak-mapredu</a>
&gt;ce
&gt;
&gt;I'll also be in attendance. Ping me if you'll be there.
&gt;
&gt;4) Ethan Gunderson built a Riak Rubik's cube.
&gt;
&gt;* Picture here ---&gt; <a  rel="nofollow" href="http://twitpic.com/6k0int">http://twitpic.com/6k0int</a>
&gt;
&gt;5) One great job to pass along:
&gt;
&gt;* truSEF, a financial services startup in NYC, is hiring Senior
&gt;Software Engineers to work on their infrastructure (and there's a lot
&gt;of Riak involved). Details here ---&gt; <a  rel="nofollow" href="http://truesef.com/jobs/sse.html">http://truesef.com/jobs/sse.html</a>
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 7
&gt;Date: Mon, 12 Sep 2011 18:41:59 -0700
&gt;From: Mark Phillips &lt;m...@basho.com&gt;
&gt;To: Henrik Johansen &lt;hen...@myunix.dk&gt;
&gt;Cc: riak-users@lists.basho.com
&gt;Subject: Re: riak-1.0.0pre2 segfaults
&gt;Message-ID:
&gt;
&gt;&lt;cae8zjqfhkwzz684kqe5g7wqlwm69-1ocyxedhm_-le_wz_n...@mail.gmail.com&gt;
&gt;Content-Type: text/plain; charset=ISO-8859-1
&gt;
&gt;Thanks for the thorough report, Henrik!
&gt;
&gt;We're looking into it and will let you know if we need any more info.
&gt;
&gt;Mark
&gt;
&gt;On Mon, Sep 12, 2011 at 1:09 PM, Henrik Johansen &lt;hen...@myunix.dk&gt; wrote:
&gt;&gt; Hello list,
&gt;&gt;
&gt;&gt; I have been playing with single node riak-1.0.0pre2 cluster &amp; riaktant
&gt;&gt;today
&gt;&gt; and somehow I managed to get riak to segfault every time I tried using
&gt;&gt;the
&gt;&gt; MapReduce functions in riaktant.
&gt;&gt;
&gt;&gt; Riak-1.0.0pre2 was installed using the 64-bit Debian package on my
&gt;&gt; Ubuntu 11.04 laptop - riaktant was pulled form GitHub.
&gt;&gt;
&gt;&gt; I have gathered some relevant info below - if I can assist in any way
&gt;&gt; please let me know ...
&gt;&gt;
&gt;&gt; dmesg :
&gt;&gt; [10488.941750] beam.smp[1496]: segfault at 7f4d61d73ff8 ip
&gt;&gt;00007f4d5ea7a83e
&gt;&gt; sp 00007f4d61d74000 error 6 in erlang_js_drv.so[7f4d5ea35000+e6000]
&gt;&gt; [10944.335495] beam.smp[4681]: segfault at 7fcda9892ff8 ip
&gt;&gt;00007fcda386783e
&gt;&gt; sp 00007fcda9893000 error 6 in erlang_js_drv.so[7fcda3822000+e6000]
&gt;&gt; [11658.589251] beam.smp[6604]: segfault at 7fee7166eff8 ip
&gt;&gt;00007fee6dc4983e
&gt;&gt; sp 00007fee7166f000 error 6 in erlang_js_drv.so[7fee6dc04000+e6000]
&gt;&gt;
&gt;&gt; crash.log :
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt; ? ? Supervisor: {local,riak_pipe_builder_sup}
&gt;&gt; ? ? Context: ? ?child_terminated
&gt;&gt; ? ? Reason:
&gt;&gt;
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; ? ? error before:
&gt;&gt;
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; ? ? Offender:
&gt;&gt;
&gt;&gt;
&gt;&gt;[{pid,&lt;0.1556.0&gt;},{name,undefined},{mfargs,{riak_pipe_builder,start_link,
&gt;&gt;undefined}},{restart_type,temporary},{shutdown,brutal_kill},{child_type,w
&gt;&gt;orker}]
&gt;&gt;
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt; ? ? Supervisor: {local,riak_pipe_fitting_sup}
&gt;&gt; ? ? Context: ? ?child_terminated
&gt;&gt; ? ? Reason:
&gt;&gt;
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; ? ? error before:
&gt;&gt;
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; ? ? Offender:
&gt;&gt;
&gt;&gt;
&gt;&gt;[{pid,&lt;0.1558.0&gt;},{name,undefined},{mfargs,{riak_pipe_fitting,start_link,
&gt;&gt;undefined}},{restart_type,temporary},{shutdown,2000},{child_type,worker}]
&gt;&gt;
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt; ? ? Supervisor: {local,riak_pipe_fitting_sup}
&gt;&gt; ? ? Context: ? ?child_terminated
&gt;&gt; ? ? Reason:
&gt;&gt;
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; ? ? error before:
&gt;&gt;
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; ? ? Offender:
&gt;&gt;
&gt;&gt;
&gt;&gt;[{pid,&lt;0.1559.0&gt;},{name,undefined},{mfargs,{riak_pipe_fitting,start_link,
&gt;&gt;undefined}},{restart_type,temporary},{shutdown,2000},{child_type,worker}]
&gt;&gt;
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt; ? ? Supervisor: {local,riak_pipe_fitting_sup}
&gt;&gt; ? ? Context: ? ?child_terminated
&gt;&gt; ? ? Reason:
&gt;&gt;
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; ? ? error before:
&gt;&gt;
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; ? ? Offender:
&gt;&gt;
&gt;&gt;
&gt;&gt;[{pid,&lt;0.1557.0&gt;},{name,undefined},{mfargs,{riak_pipe_fitting,start_link,
&gt;&gt;undefined}},{restart_type,temporary},{shutdown,2000},{child_type,worker}]
&gt;&gt;
&gt;&gt; error.log :
&gt;&gt; 2011-09-12 21:49:03.025 [error] &lt;0.132.0&gt; Supervisor
&gt;&gt;riak_pipe_builder_sup
&gt;&gt; had child at module undefined at &lt;0.1556.0&gt; exit with reason
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt; 2011-09-12 21:49:03.028 [error] &lt;0.133.0&gt; Supervisor
&gt;&gt;riak_pipe_fitting_sup
&gt;&gt; had child at module undefined at &lt;0.1558.0&gt; exit with reason
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt; 2011-09-12 21:49:03.031 [error] &lt;0.133.0&gt; Supervisor
&gt;&gt;riak_pipe_fitting_sup
&gt;&gt; had child at module undefined at &lt;0.1559.0&gt; exit with reason
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt; 2011-09-12 21:49:03.033 [error] &lt;0.133.0&gt; Supervisor
&gt;&gt;riak_pipe_fitting_sup
&gt;&gt; had child at module undefined at &lt;0.1557.0&gt; exit with reason
&gt;&gt;
&gt;&gt;{{modfun,riak_search,mapred_search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},error,{badmatch,{
&gt;&gt;error,{lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt;
&gt;&gt;&quot;}}},[{riak_search_client,parse_query,3},{riak_search,parse_query,3},{ria
&gt;&gt;k_search,mapred_search,3},{riak_kv_mrc_pipe,send_inputs,3},{riak_kv_mrc_p
&gt;&gt;ipe,'-send_inputs_async/3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt;
&gt;&gt; /HenrikJ
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;
&gt;
&gt;
&gt;------------------------------
&gt;
&gt;Message: 8
&gt;Date: Mon, 12 Sep 2011 22:19:19 -0400
&gt;From: Ryan Zezeski &lt;rzeze...@basho.com&gt;
&gt;To: Henrik Johansen &lt;hen...@myunix.dk&gt;
&gt;Cc: riak-users@lists.basho.com
&gt;Subject: Re: riak-1.0.0pre2 segfaults
&gt;Message-ID:
&gt;
&gt;&lt;CACZcpemDvcUUXipZ6MyihL1L5ZOdaQV3tPJOP1+F4YTK=fn...@mail.gmail.com&gt;
&gt;Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
&gt;
&gt;Henrik,
&gt;
&gt;I'm not familiar with riaktant but it looks like an invalid query is being
&gt;passed in.  I.e. an empty query.  This empty query causes and error in the
&gt;query parser and then it appears a segfault in the js driver.
&gt;
&gt;E.g. here I replicate the error at the console:
&gt;
&gt;(riak@127.0.0.1)5&gt; search:search(&lt;&lt;&quot;bucket&quot;&gt;&gt;, &lt;&lt;&gt;&gt;).
&gt;** exception error: no match of right hand side value
&gt;{error,{lucene_parse,&quot;syntax error before: &quot;}}
&gt;     in function  riak_search_client:parse_query/3
&gt;     in call from search:search/3
&gt;
&gt;-Ryan
&gt;
&gt;On Mon, Sep 12, 2011 at 4:09 PM, Henrik Johansen &lt;hen...@myunix.dk&gt; wrote:
&gt;
&gt;&gt; Hello list,
&gt;&gt;
&gt;&gt; I have been playing with single node riak-1.0.0pre2 cluster &amp; riaktant
&gt;&gt; today and somehow I managed to get riak to segfault every time I tried
&gt;&gt;using
&gt;&gt; the MapReduce functions in riaktant.
&gt;&gt;
&gt;&gt; Riak-1.0.0pre2 was installed using the 64-bit Debian package on my
&gt;&gt; Ubuntu 11.04 laptop - riaktant was pulled form GitHub.
&gt;&gt;
&gt;&gt; I have gathered some relevant info below - if I can assist in any way
&gt;&gt; please let me know ...
&gt;&gt;
&gt;&gt; dmesg :
&gt;&gt; [10488.941750] beam.smp[1496]: segfault at 7f4d61d73ff8 ip
&gt;&gt;00007f4d5ea7a83e
&gt;&gt; sp 00007f4d61d74000 error 6 in erlang_js_drv.so[7f4d5ea35000+**e6000]
&gt;&gt; [10944.335495] beam.smp[4681]: segfault at 7fcda9892ff8 ip
&gt;&gt;00007fcda386783e
&gt;&gt; sp 00007fcda9893000 error 6 in erlang_js_drv.so[7fcda3822000+**e6000]
&gt;&gt; [11658.589251] beam.smp[6604]: segfault at 7fee7166eff8 ip
&gt;&gt;00007fee6dc4983e
&gt;&gt; sp 00007fee7166f000 error 6 in erlang_js_drv.so[7fee6dc04000+**e6000]
&gt;&gt;
&gt;&gt; crash.log :
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt;     Supervisor: {local,riak_pipe_builder_sup}
&gt;&gt;     Context:    child_terminated
&gt;&gt;     Reason:
&gt;&gt;     {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt;     error before:
&gt;&gt;     &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt;     Offender:
&gt;&gt;     [{pid,&lt;0.1556.0&gt;},{name,**undefined},{mfargs,{riak_pipe_**
&gt;&gt; builder,start_link,undefined}}**,{restart_type,temporary},{**
&gt;&gt; shutdown,brutal_kill},{child_**type,worker}]
&gt;&gt;
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt;     Supervisor: {local,riak_pipe_fitting_sup}
&gt;&gt;     Context:    child_terminated
&gt;&gt;     Reason:
&gt;&gt;     {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt;     error before:
&gt;&gt;     &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt;     Offender:
&gt;&gt;     [{pid,&lt;0.1558.0&gt;},{name,**undefined},{mfargs,{riak_pipe_**
&gt;&gt; fitting,start_link,undefined}}**,{restart_type,temporary},{**
&gt;&gt; shutdown,2000},{child_type,**worker}]
&gt;&gt;
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt;     Supervisor: {local,riak_pipe_fitting_sup}
&gt;&gt;     Context:    child_terminated
&gt;&gt;     Reason:
&gt;&gt;     {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt;     error before:
&gt;&gt;     &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt;     Offender:
&gt;&gt;     [{pid,&lt;0.1559.0&gt;},{name,**undefined},{mfargs,{riak_pipe_**
&gt;&gt; fitting,start_link,undefined}}**,{restart_type,temporary},{**
&gt;&gt; shutdown,2000},{child_type,**worker}]
&gt;&gt;
&gt;&gt; 2011-09-12 21:49:03 =SUPERVISOR REPORT====
&gt;&gt;     Supervisor: {local,riak_pipe_fitting_sup}
&gt;&gt;     Context:    child_terminated
&gt;&gt;     Reason:
&gt;&gt;     {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt;     error before:
&gt;&gt;     &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt;     Offender:
&gt;&gt;     [{pid,&lt;0.1557.0&gt;},{name,**undefined},{mfargs,{riak_pipe_**
&gt;&gt; fitting,start_link,undefined}}**,{restart_type,temporary},{**
&gt;&gt; shutdown,2000},{child_type,**worker}]
&gt;&gt;
&gt;&gt; error.log :
&gt;&gt; 2011-09-12 21:49:03.025 [error] &lt;0.132.0&gt; Supervisor
&gt;&gt;riak_pipe_builder_sup
&gt;&gt; had child at module undefined at &lt;0.1556.0&gt; exit with reason
&gt;&gt; {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt; &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt; 2011-09-12 21:49:03.028 [error] &lt;0.133.0&gt; Supervisor
&gt;&gt;riak_pipe_fitting_sup
&gt;&gt; had child at module undefined at &lt;0.1558.0&gt; exit with reason
&gt;&gt; {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt; &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt; 2011-09-12 21:49:03.031 [error] &lt;0.133.0&gt; Supervisor
&gt;&gt;riak_pipe_fitting_sup
&gt;&gt; had child at module undefined at &lt;0.1559.0&gt; exit with reason
&gt;&gt; {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt; &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt; 2011-09-12 21:49:03.033 [error] &lt;0.133.0&gt; Supervisor
&gt;&gt;riak_pipe_fitting_sup
&gt;&gt; had child at module undefined at &lt;0.1557.0&gt; exit with reason
&gt;&gt; {{modfun,riak_search,mapred_**search,[&lt;&lt;&quot;syslog&quot;&gt;&gt;,&lt;&lt;&gt;&gt;]},**
&gt;&gt; error,{badmatch,{error,{**lucene_parse,&quot;syntax
&gt;&gt; error before:
&gt;&gt; &quot;}}},[{riak_search_client,**parse_query,3},{riak_search,**
&gt;&gt; parse_query,3},{riak_search,**mapred_search,3},{riak_kv_mrc_**
&gt;&gt; pipe,send_inputs,3},{riak_kv_**mrc_pipe,'-send_inputs_async/**
&gt;&gt; 3-fun-0-',3}]}
&gt;&gt; in context child_terminated
&gt;&gt;
&gt;&gt; /HenrikJ
&gt;&gt;
&gt;&gt; ______________________________**_________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt;
&gt;&gt;<a  rel="nofollow" href="http://lists.basho.com/**mailman/listinfo/riak-users_**lists.basho.com">http://lists.basho.com/**mailman/listinfo/riak-users_**lists.basho.com</a>&lt;ht
&gt;&gt;tp://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com&gt;
&gt;&gt;
&gt;-------------- next part --------------
&gt;An HTML attachment was scrubbed...
&gt;URL:
&gt;&lt;<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2">http://lists.basho.com/pipermail/riak-users_lists.basho.com/attachments/2</a>
&gt;0110912/90888d12/attachment.html&gt;
&gt;
&gt;------------------------------
&gt;
&gt;_______________________________________________
&gt;riak-users mailing list
&gt;riak-users@lists.basho.com
&gt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
&gt;End of riak-users Digest, Vol 26, Issue 22
&gt;******************************************


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04686.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04690">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04690">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04692.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Riak Socket Exception using PBCClient</span> <span class="sender italic">Harshal Dhir</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04692.html">Re: Riak Socket Exception using PBCClient</a></span> <span class="sender italic">Russell Brown</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Riak Socket Exception using PBCClient">
<input type="hidden" name="msgid" value="CA95378A.8E78%harshal.dhir@solutionset.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04690.html">
<input type="submit" value=" Harshal Dhir ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+Socket+Exception+using+PBCClient%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04686.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04692.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CA95378A.8E78%harshal.dhir@solutionset.com</li>
</ul>
</div>
</body>
</html>
