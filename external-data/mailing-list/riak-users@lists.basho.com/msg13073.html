<!DOCTYPE html>
<html lang="en">
<head>
<title>Write Timeout</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd6.html#13073" id="c">
<link rel="index" href="mail6.html#13073" id="i">
<link rel="prev" href="msg13063.html" id="p">
<link rel="next" href="msg13103.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg13073.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Write+Timeout%22&amp;o=newest" rel="nofollow"><span itemprop="name">Write Timeout</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Andrew+Tynefield%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Andrew Tynefield</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131123" rel="nofollow">Sat, 23 Nov 2013 12:15:46 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hey guys,

I'm encountering a timeout when attempting a write using `riak-admin test`.</pre><pre>

(02:01:08) [riak1] ~ $ time riak-admin test

Failed to write test value: {error,timeout}

real 1m1.561s
user 0m0.325s
sys 0m0.103s

(02:02:39) [riak1] ~ $


This is one node of a 4 node cluster. The other nodes all work perfectly
fine when attempting this. What I also find very weird is that this node
was the second node to be created, nodes created after it (riak{2,3})
complete their tests fine and do not appear to have any issues.

vm.args and app.config are generated by puppet and are used with identical
values (except for the node name) by all nodes.

Values of note may be:
  {pb_backlog, 128},
  {ring_creation_size, 256},


I've also tried leaving the cluster from this node, waiting for the ring to
re-stabilize and show it successfully leaving. I then removed the entire
/var/lib/riak/*, started riak back up, rejoined the cluster. (Prior to
rejoining, I did a riak-admin test and it succeeded.)

I've provided a tail of all the logs within /var/log/riak below immediately
proceeding the execution of the riak-admin test command.

==&gt; /var/log/riak/console.log &lt;==
2013-11-23 13:45:53.597 [info]
&lt;0.157.0&gt;@riak_core_capability:process_capability_changes:530 New
capability: {riak_kv,anti_entropy} = enabled_v1
2013-11-23 13:45:53.798 [info]
&lt;0.157.0&gt;@riak_core_capability:process_capability_changes:530 New
capability: {riak_kv,handoff_data_encoding} = encode_raw
2013-11-23 13:45:54.187 [info]
&lt;0.157.0&gt;@riak_core_capability:process_capability_changes:530 New
capability: {riak_kv,object_format} = v1
2013-11-23 13:45:54.405 [info]
&lt;0.157.0&gt;@riak_core_capability:process_capability_changes:530 New
capability: {riak_kv,secondary_index_version} = v2
2013-11-23 13:45:54.683 [info]
&lt;0.157.0&gt;@riak_core_capability:process_capability_changes:530 New
capability: {riak_kv,vclock_data_encoding} = encode_zlib
2013-11-23 13:45:55.066 [info]
&lt;0.157.0&gt;@riak_core_capability:process_capability_changes:530 New
capability: {riak_kv,crdt} = [pncounter]
2013-11-23 13:45:56.141 [info]
&lt;0.157.0&gt;@riak_core_capability:process_capability_changes:530 New
capability: {riak_control,member_info_version} = v1
2013-11-23 13:45:56.277 [info] &lt;0.7.0&gt; Application riak_control started on
node 'r...@riak1.tyne.io'
2013-11-23 13:45:56.277 [info] &lt;0.7.0&gt; Application erlydtl started on node '
r...@riak1.tyne.io'
2013-11-23 13:46:11.607 [info] &lt;0.538.0&gt;@riak_core:wait_for_service:464
Wait complete for service riak_kv (14 seconds)

==&gt; /var/log/riak/crash.log &lt;==
2013-11-23 02:01:43 =ERROR REPORT====
Hintfile
'/var/lib/riak/bitcask/1444374665018431399630985401082889078019339583488/33.bitcask.hint'
invalid
2013-11-23 02:01:43 =ERROR REPORT====
Hintfile
'/var/lib/riak/bitcask/1375866775768545325340187674549313311472967745536/29.bitcask.hint'
invalid
2013-11-23 02:01:43 =ERROR REPORT====
Hintfile
'/var/lib/riak/bitcask/1124671181852296386273929343926202167469604339712/42.bitcask.hint'
invalid
2013-11-23 02:01:43 =ERROR REPORT====
Hintfile
'/var/lib/riak/bitcask/1421538701935136041534052825571697155837215637504/30.bitcask.hint'
invalid
2013-11-23 02:01:43 =ERROR REPORT====
Hintfile
'/var/lib/riak/bitcask/1330194849601954609146322523526929467108719853568/35.bitcask.hint'
invalid

==&gt; /var/log/riak/error.log &lt;==
2013-11-23 02:01:43.869 [error] &lt;0.2775.0&gt; Hintfile
'/var/lib/riak/bitcask/1353030812685249967243255099038121389290843799552/15.bitcask.hint'
invalid
2013-11-23 02:01:43.869 [error] &lt;0.2723.0&gt; Hintfile
'/var/lib/riak/bitcask/1261686960352068534855524796993353700562348015616/34.bitcask.hint'
invalid
2013-11-23 02:01:43.869 [error] &lt;0.2593.0&gt; Hintfile
'/var/lib/riak/bitcask/1170343108018887102467794494948586011833852231680/27.bitcask.hint'
invalid
2013-11-23 02:01:43.869 [error] &lt;0.2623.0&gt; Hintfile
'/var/lib/riak/bitcask/1216015034185477818661659645970969856198100123648/37.bitcask.hint'
invalid
2013-11-23 02:01:43.870 [error] &lt;0.2704.0&gt; Hintfile
'/var/lib/riak/bitcask/1238850997268773176758592221482161778380224069632/33.bitcask.hint'
invalid
2013-11-23 02:01:43.870 [error] &lt;0.2855.0&gt; Hintfile
'/var/lib/riak/bitcask/1444374665018431399630985401082889078019339583488/33.bitcask.hint'
invalid
2013-11-23 02:01:43.870 [error] &lt;0.2805.0&gt; Hintfile
'/var/lib/riak/bitcask/1375866775768545325340187674549313311472967745536/29.bitcask.hint'
invalid
2013-11-23 02:01:43.870 [error] &lt;0.2561.0&gt; Hintfile
'/var/lib/riak/bitcask/1124671181852296386273929343926202167469604339712/42.bitcask.hint'
invalid
2013-11-23 02:01:43.870 [error] &lt;0.2823.0&gt; Hintfile
'/var/lib/riak/bitcask/1421538701935136041534052825571697155837215637504/30.bitcask.hint'
invalid
2013-11-23 02:01:43.871 [error] &lt;0.2759.0&gt; Hintfile
'/var/lib/riak/bitcask/1330194849601954609146322523526929467108719853568/35.bitcask.hint'
invalid

==&gt; /var/log/riak/run_erl.log &lt;==
run_erl [2259] Sat Nov 23 13:45:49 2013
Args before exec of shell:
run_erl [2259] Sat Nov 23 13:45:49 2013
argv[0] = sh
run_erl [2259] Sat Nov 23 13:45:49 2013
argv[1] = -c
run_erl [2259] Sat Nov 23 13:45:49 2013
argv[2] = exec /usr/sbin/riak console



Here's some information about the installation and cluster:

(02:04:36) [riak1] ~ $ riak version
1.4.2

(02:08:07) [riak1] ~ $ riak-admin ringready
TRUE All nodes agree on the ring ['r...@riak.tyne.io','r...@riak1.tyne.io',
                                  'r...@riak2.tyne.io','r...@riak3.tyne.io']

(02:07:31) [riak1] ~ $ riak-admin member-status
================================= Membership
==================================
Status     Ring    Pending    Node
-------------------------------------------------------------------------------
valid      25.0%      --      'r...@riak.tyne.io'
valid      25.0%      --      'r...@riak1.tyne.io'
valid      25.0%      --      'r...@riak2.tyne.io'
valid      25.0%      --      'r...@riak3.tyne.io'
-------------------------------------------------------------------------------
Valid:4 / Leaving:0 / Exiting:0 / Joining:0 / Down:0


Touch test:

(02:07:00) [riak1] ~ $ for dir in /var/lib/riak/*/; do touch $dir/test;
stat $dir/test; done
  File: `/var/lib/riak/anti_entropy//test'
  Size: 0         Blocks: 0          IO Block: 4096   regular empty file
Device: 802h/2050d Inode: 1704796     Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2013-11-23 14:07:31.284244924 -0600
Modify: 2013-11-23 14:07:31.284244924 -0600
Change: 2013-11-23 14:07:31.284244924 -0600
  File: `/var/lib/riak/bitcask//test'
  Size: 0         Blocks: 0          IO Block: 4096   regular empty file
Device: 802h/2050d Inode: 1705089     Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2013-11-23 14:07:31.310243834 -0600
Modify: 2013-11-23 14:07:31.310243834 -0600
Change: 2013-11-23 14:07:31.310243834 -0600
  File: `/var/lib/riak/kv_vnode//test'
  Size: 0         Blocks: 0          IO Block: 4096   regular empty file
Device: 802h/2050d Inode: 1705150     Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2013-11-23 14:07:31.316243674 -0600
Modify: 2013-11-23 14:07:31.316243674 -0600
Change: 2013-11-23 14:07:31.316243674 -0600
  File: `/var/lib/riak/leveldb//test'
  Size: 0         Blocks: 0          IO Block: 4096   regular empty file
Device: 802h/2050d Inode: 1705153     Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2013-11-23 14:07:31.322243576 -0600
Modify: 2013-11-23 14:07:31.322243576 -0600
Change: 2013-11-23 14:07:31.322243576 -0600
  File: `/var/lib/riak/ring//test'
  Size: 0         Blocks: 0          IO Block: 4096   regular empty file
Device: 802h/2050d Inode: 1705154     Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2013-11-23 14:07:31.326243490 -0600
Modify: 2013-11-23 14:07:31.326243490 -0600
Change: 2013-11-23 14:07:31.326243490 -0600


Any help would be greatly appreciated!

Thanks,
Andrew

-- 
[Andrew Tynefield]
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg13063.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd6.html#13073">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail6.html#13073">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg13103.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Write Timeout</span> <span class="sender italic">Andrew Tynefield</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13103.html">Re: Write Timeout</a></span> <span class="sender italic">Andrew Tynefield</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13104.html">Re: Write Timeout</a></span> <span class="sender italic">Brian Sparrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13112.html">Re: Write Timeout</a></span> <span class="sender italic">Andrew Tynefield</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13126.html">Re: Write Timeout</a></span> <span class="sender italic">Andrew Tynefield</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13128.html">Re: Write Timeout</a></span> <span class="sender italic">Kelly McLaughlin</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Write Timeout">
<input type="hidden" name="msgid" value="CAKUFnCPW=SvpTi4+GQ_KEjQQ1HCwDOAS-v2=hbuoTUjVeQi37Q@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg13073.html">
<input type="submit" value=" Andrew Tynefield ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Write+Timeout%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg13063.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg13103.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAKUFnCPW=SvpTi4+GQ_KEjQQ1HCwDOAS-v2=hbuoTUjVeQi37Q@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
