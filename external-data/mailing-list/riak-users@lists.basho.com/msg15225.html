<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak Search queries</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#15225" id="c">
<link rel="index" href="maillist.html#15225" id="i">
<link rel="prev" href="msg15223.html" id="p">
<link rel="next" href="msg15143.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15225.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+Search+queries%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak Search queries</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Eric+Redmond%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Eric Redmond</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20141124" rel="nofollow">Mon, 24 Nov 2014 08:11:34 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Don't use that. It's internal to Riak. Never never use /internal_solr. Use the 
/solr interface exposed by Riak, and defined in the documentation.
Take care,
Eric</pre><pre>


On Nov 24, 2014 9:35 AM, &quot;Jason Ryan&quot; &lt;jason.r...@trustev.com&gt; wrote:
Hi Eric,

I'm using the internal_solr web front end right now, port 8093
On this particular example, I have just one Riak node running locally - version 
2.0.1 - I haven't tested this on a multi node Riak install yet.

Jason

        
Jason Ryan
VP Engineering

Trustev
Real Time, Online Identity Verification
 
email: jason.r...@trustev.com 
skype: jason_j_ryan
web: www.trustev.com

Trustev Ltd, 2100 Cork Airport Business Park, Cork, Ireland. 

On 24 November 2014 at 13:55, Eric Redmond &lt;eredm...@basho.com&gt; wrote:
Your response header should contain shard and many filter values. What URL are 
you using to search with? Does it begin with /solr or /solr_internal? What 
port? How many Riak nodes are you running? And what version do you have 
installed?

Thanks,
Eric

On Nov 24, 2014 5:34 AM, &quot;Jason Ryan&quot; &lt;jason.r...@trustev.com&gt; wrote:
Hi Eric,

I don't get multiple siblings on a Riak GET for the key.

My buckets currently have allow_mult: false and last_write_wins: true
The n_val is the default 3

When I search, an example return is as follows, I can see the _yz_id has a 
unique number on the end alright though?

Thanks for the help!

Jason

{
  &quot;responseHeader&quot;: {
    &quot;status&quot;: 0,
    &quot;QTime&quot;: 6,
    &quot;params&quot;: {
      &quot;sort&quot;: &quot;RequestTimestamp desc&quot;,
      &quot;indent&quot;: &quot;true&quot;,
      &quot;q&quot;: &quot;_yz_rk:20141124091329-GET-200&quot;,
      &quot;_&quot;: &quot;1416824998178&quot;,
      &quot;wt&quot;: &quot;json&quot;
    }
  },
  &quot;response&quot;: {
    &quot;numFound&quot;: 3,
    &quot;start&quot;: 0,
    &quot;docs&quot;: [
      {
        &quot;CredentialType&quot;: &quot;Live&quot;,
        &quot;MerchantSiteId&quot;: &quot;754712a0-8df0-4931-bf65-a37600e203b7&quot;,
        &quot;ResponseStatus&quot;: &quot;OK&quot;,
        &quot;ResponseCode&quot;: &quot;200&quot;,
        &quot;ResponseMessage&quot;: &quot;{ &lt;REMOVED&gt; }&quot;,
        &quot;ResponseTimestamp&quot;: &quot;2014-11-24T09:13:29.111Z&quot;,
        &quot;RequestMessage&quot;: &quot;null&quot;,
        &quot;RequestTimestamp&quot;: &quot;2014-11-24T09:13:27.803Z&quot;,
        &quot;RequestUri&quot;: &quot;/api/v2.0/decision/e12f7e34-cdd0-4138-b0e4-88d906aba391&quot;,
        &quot;RequestMessageType&quot;: &quot;application/json&quot;,
        &quot;RequestMethodType&quot;: &quot;GET&quot;,
        &quot;_yz_id&quot;: &quot;1*Trunk*ApiEvents*20141124091329-GET-200*34&quot;,
        &quot;_yz_rk&quot;: &quot;20141124091329-GET-200&quot;,
        &quot;_yz_rt&quot;: &quot;Trunk&quot;,
        &quot;_yz_rb&quot;: &quot;ApiEvents&quot;
      },
      {
        &quot;CredentialType&quot;: &quot;Live&quot;,
        &quot;MerchantSiteId&quot;: &quot;754712a0-8df0-4931-bf65-a37600e203b7&quot;,
        &quot;ResponseStatus&quot;: &quot;OK&quot;,
        &quot;ResponseCode&quot;: &quot;200&quot;,
        &quot;ResponseMessage&quot;: &quot;{ &lt;REMOVED&gt; }&quot;,
        &quot;ResponseTimestamp&quot;: &quot;2014-11-24T09:13:29.111Z&quot;,
        &quot;RequestMessage&quot;: &quot;null&quot;,
        &quot;RequestTimestamp&quot;: &quot;2014-11-24T09:13:27.803Z&quot;,
        &quot;RequestUri&quot;: &quot;/api/v2.0/decision/e12f7e34-cdd0-4138-b0e4-88d906aba391&quot;,
        &quot;RequestMessageType&quot;: &quot;application/json&quot;,
        &quot;RequestMethodType&quot;: &quot;GET&quot;,
        &quot;_yz_id&quot;: &quot;1*Trunk*ApiEvents*20141124091329-GET-200*35&quot;,
        &quot;_yz_rk&quot;: &quot;20141124091329-GET-200&quot;,
        &quot;_yz_rt&quot;: &quot;Trunk&quot;,
        &quot;_yz_rb&quot;: &quot;ApiEvents&quot;
      },
      {
        &quot;CredentialType&quot;: &quot;Live&quot;,
        &quot;MerchantSiteId&quot;: &quot;754712a0-8df0-4931-bf65-a37600e203b7&quot;,
        &quot;ResponseStatus&quot;: &quot;OK&quot;,
        &quot;ResponseCode&quot;: &quot;200&quot;,
        &quot;ResponseMessage&quot;: &quot;{ &lt;REMOVED&gt; }&quot;,
        &quot;ResponseTimestamp&quot;: &quot;2014-11-24T09:13:29.111Z&quot;,
        &quot;RequestMessage&quot;: &quot;null&quot;,
        &quot;RequestTimestamp&quot;: &quot;2014-11-24T09:13:27.803Z&quot;,
        &quot;RequestUri&quot;: &quot;/api/v2.0/decision/e12f7e34-cdd0-4138-b0e4-88d906aba391&quot;,
        &quot;RequestMessageType&quot;: &quot;application/json&quot;,
        &quot;RequestMethodType&quot;: &quot;GET&quot;,
        &quot;_yz_id&quot;: &quot;1*Trunk*ApiEvents*20141124091329-GET-200*36&quot;,
        &quot;_yz_rk&quot;: &quot;20141124091329-GET-200&quot;,
        &quot;_yz_rt&quot;: &quot;Trunk&quot;,
        &quot;_yz_rb&quot;: &quot;ApiEvents&quot;
      }
    ]
  }
}




        
Jason Ryan
VP Engineering

Trustev
Real Time, Online Identity Verification
 
email: jason.r...@trustev.com 
skype: jason_j_ryan
web: www.trustev.com

Trustev Ltd, 2100 Cork Airport Business Park, Cork, Ireland. 

On 22 November 2014 at 13:57, Eric Redmond &lt;eredm...@basho.com&gt; wrote:
You can check if your object has siblings by performing a key get, and see if 
two values return. If not, then it may be the index. Can you paste the response 
where you get two values?

Thanks,
Eric


On Nov 13, 2014, at 9:46 AM, Jason Ryan &lt;jason.r...@trustev.com&gt; wrote:

&gt; Thanks Eric - I don't see the _yz_vtag returned in the search result set - so 
&gt; not sure how to tell that?
&gt; 
&gt; 
&gt; 
&gt;       
&gt; Jason Ryan
&gt; VP Engineering
&gt; 
&gt; Trustev
&gt; Real Time, Online Identity Verification
&gt;  
&gt; email: jason.r...@trustev.com 
&gt; skype: jason_j_ryan
&gt; web: www.trustev.com
&gt; 
&gt; Trustev Ltd, 2100 Cork Airport Business Park, Cork, Ireland. 
&gt; 
&gt; On 12 November 2014 17:53, Eric Redmond &lt;eredm...@basho.com&gt; wrote:
&gt; 
&gt; On Nov 11, 2014, at 3:55 AM, Jason Ryan &lt;jason.r...@trustev.com&gt; wrote:
&gt; 
&gt;&gt; Hi all,
&gt;&gt; 
&gt;&gt; I have some quick (hopefully!) questions around Riak search.
&gt;&gt; 
&gt;&gt; 1. I'm getting multiple documents returned in the search results for a query 
&gt;&gt; - which I assume is based on the n_val of my bucket as I tried to change the 
&gt;&gt; search index to have a n_val of 1 but got an error that it needed to match 
&gt;&gt; the bucket n_val - is this expected behaviour, i.e. will the search return 
&gt;&gt; multiples based from the n_val, and I need to code for that?
&gt; 
&gt; You should only get multiple results if your values have siblings. You can 
&gt; tell if they're siblings because the duplicates will have different _yz_vtags.
&gt; 
&gt;&gt; 2. What is best practice if we required to change an index (e.g. adding a 
&gt;&gt; new indexed field) and wanted to re-generate the index for a particular 
&gt;&gt; bucket?
&gt; 
&gt; Currently, that requires you rewriting your dataset again. However, there is 
&gt; a PR in the works to allow incremental schema changes, as well as allowing 
&gt; AAE to automatically update indexed documented based on schema changes: 
&gt; <a  rel="nofollow" href="https://github.com/basho/yokozuna/pull/427">https://github.com/basho/yokozuna/pull/427</a>
&gt; 
&gt; 
&gt;&gt; Thanks!
&gt;&gt; Jason
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; This message is for the named person's use only. If you received this 
&gt;&gt; message in error, please immediately delete it and all copies and notify the 
&gt;&gt; sender. You must not, directly or indirectly, use, disclose, distribute, 
&gt;&gt; print, or copy any part of this message if you are not the intended 
&gt;&gt; recipient. Any views expressed in this message are those of the individual 
&gt;&gt; sender and not Trustev Ltd. Trustev is registered in Ireland No. 516425 and 
&gt;&gt; trades from 2100 Cork Airport Business Park, Cork, Ireland.
&gt;&gt; 
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 
&gt; 
&gt; This message is for the named person's use only. If you received this message 
&gt; in error, please immediately delete it and all copies and notify the sender. 
&gt; You must not, directly or indirectly, use, disclose, distribute, print, or 
&gt; copy any part of this message if you are not the intended recipient. Any 
&gt; views expressed in this message are those of the individual sender and not 
&gt; Trustev Ltd. Trustev is registered in Ireland No. 516425 and trades from 2100 
&gt; Cork Airport Business Park, Cork, Ireland.
&gt; 



This message is for the named person's use only. If you received this message 
in error, please immediately delete it and all copies and notify the sender. 
You must not, directly or indirectly, use, disclose, distribute, print, or copy 
any part of this message if you are not the intended recipient. Any views 
expressed in this message are those of the individual sender and not Trustev 
Ltd. Trustev is registered in Ireland No. 516425 and trades from 2100 Cork 
Airport Business Park, Cork, Ireland.



This message is for the named person's use only. If you received this message 
in error, please immediately delete it and all copies and notify the sender. 
You must not, directly or indirectly, use, disclose, distribute, print, or copy 
any part of this message if you are not the intended recipient. Any views 
expressed in this message are those of the individual sender and not Trustev 
Ltd. Trustev is registered in Ireland No. 516425 and trades from 2100 Cork 
Airport Business Park, Cork, Ireland.


</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15223.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#15225">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#15225">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15143.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg15141.html">Riak Search queries</a></span> <span class="sender italic">Jason Ryan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15154.html">Re: Riak Search queries</a></span> <span class="sender italic">Eric Redmond</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15161.html">Re: Riak Search queries</a></span> <span class="sender italic">Jason Ryan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15211.html">Re: Riak Search queries</a></span> <span class="sender italic">Eric Redmond</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15223.html">Re: Riak Search queries</a></span> <span class="sender italic">Jason Ryan</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak Search queries</span> <span class="sender italic">Eric Redmond</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak Search queries">
<input type="hidden" name="msgid" value="599762F4-8E6C-47AE-B68D-E6DD70AA3DB2@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15225.html">
<input type="submit" value=" Eric Redmond ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+Search+queries%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15223.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15143.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">599762F4-8E6C-47AE-B68D-E6DD70AA3DB2@basho.com</li>
</ul>
</div>
</body>
</html>
