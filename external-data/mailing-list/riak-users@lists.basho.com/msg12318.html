<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Invalid hintfiles</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd10.html#12318" id="c">
<link rel="index" href="mail10.html#12318" id="i">
<link rel="prev" href="msg12317.html" id="p">
<link rel="next" href="msg12320.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12318.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Invalid+hintfiles%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Invalid hintfiles</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Andrew+Stone%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Andrew Stone</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130918" rel="nofollow">Wed, 18 Sep 2013 20:29:13 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Toby,

Can you try raising the pb_backlog to 128 in your riak app.config on each
node. It's likely those disconnect errors are left over from the stampede
of connections from the CS connection pool on startup. For one reason or
another the resets don't come through and the hanging disconnected socket
isn't discovered until the next send attempt.</pre><pre>

-Andrew


On Wed, Sep 18, 2013 at 10:31 PM, Toby Corkindale &lt;
toby.corkind...@strategicdata.com.au&gt; wrote:

&gt; On 19/09/13 11:17, Luke Bakken wrote:
&gt;
&gt;&gt; The &quot;error: disconnected&quot; message is a good clue. If you can provide
&gt;&gt; log files that may point to the cause.
&gt;&gt;
&gt;
&gt; See below for logs from riak and riak cs, for a roughly five minute window
&gt; during which I'd fiddled with the load balancer and DNS to try and isolate
&gt; this server from other requests, and only send mine to it.
&gt;
&gt; Unfortunately I really don't see much in there apart from the disconnected
&gt; messages. I did note that there were warnings about system hitting high
&gt; watermarks for memory at one point though. That's a bit odd, as the machine
&gt; wasn't near max capacity at any point - it's only 8GB, but 'free' was
&gt; reporting that most was being used just for buffers and cache at the time;
&gt; as follows:
&gt;
&gt; ie.
&gt;              total       used       free     shared    buffers     cached
&gt; Mem:       8176412    3803404    4373008          0      34112    3052340
&gt; -/+ buffers/cache:     716952    7459460
&gt; Swap:      3903484          0    3903484
&gt;
&gt;
&gt; ======= erlang.log (riak cs) =========
&gt;
&gt; ===== Thu Sep 19 11:58:46 EST 2013
&gt; 11:58:46.287 [info] alarm_handler: {set,{system_memory_high_**
&gt; watermark,[]}}^M
&gt; 12:00:47.864 [info] webmachine_log_handler: closing log file:
&gt; &quot;/var/log/riak-cs/access.log&quot;
&gt; ^M
&gt; 12:00:47.865 [info] opening log file: &quot;/var/log/riak-cs/access.log.**
&gt; 2013_09_19_02&quot;
&gt; ^M
&gt; 12:00:50.081 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:00:51.013 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:00:51.406 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:01:49.320 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:02:04.662 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:03:37.330 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:06:24.345 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:06:41.670 [error] Retrieval of user record for s3 failed. Reason:
&gt; disconnected^M
&gt; 12:06:46.554 [info] Finished garbage collection: 0 seconds, 0 batch_count,
&gt; 0 batch_skips, 0 manif_count, 0 block_count^M
&gt; 12:11:46.300 [info] alarm_handler: {clear,system_memory_high_**
&gt; watermark}^M
&gt; 12:16:46.305 [info] alarm_handler: {set,{system_memory_high_**
&gt; watermark,[]}}^M
&gt; 12:18:46.307 [info] alarm_handler: {clear,system_memory_high_**
&gt; watermark}^M
&gt; ==============================**==========
&gt;
&gt;
&gt; ===== console.log (riak cs) ===================
&gt; 2013-09-19 12:00:47.865 [info] &lt;0.94.0&gt; opening log file:
&gt; &quot;/var/log/riak-cs/access.log.**2013_09_19_02&quot;
&gt;
&gt; 2013-09-19 12:00:50.081 [error] 
&gt; &lt;0.7092.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:00:51.013 [error] 
&gt; &lt;0.10406.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:00:51.406 [error] 
&gt; &lt;0.11179.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:01:49.320 [error] 
&gt; &lt;0.11197.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:02:04.662 [error] 
&gt; &lt;0.9667.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:03:37.330 [error] 
&gt; &lt;0.11343.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:06:24.345 [error] 
&gt; &lt;0.11589.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:06:41.670 [error] 
&gt; &lt;0.11215.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:06:46.554 [info] 
&gt; &lt;0.274.0&gt;@riak_cs_gc_d:**fetching_next_fileset:162
&gt; Finished garbage collection: 0 seconds, 0 batch_count, 0 batch_skips, 0
&gt; manif_count, 0 block_count
&gt; 2013-09-19 12:11:46.300 [info] &lt;0.41.0&gt; alarm_handler:
&gt; {clear,system_memory_high_**watermark}
&gt; 2013-09-19 12:16:46.305 [info] &lt;0.41.0&gt; alarm_handler:
&gt; {set,{system_memory_high_**watermark,[]}}
&gt; 2013-09-19 12:18:46.307 [info] &lt;0.41.0&gt; alarm_handler:
&gt; {clear,system_memory_high_**watermark}
&gt; ==============================**================
&gt;
&gt;
&gt;
&gt; ======= error.log (riak cs) ================
&gt; 2013-09-19 12:00:50.081 [error] 
&gt; &lt;0.7092.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:00:51.013 [error] 
&gt; &lt;0.10406.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:00:51.406 [error] 
&gt; &lt;0.11179.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:01:49.320 [error] 
&gt; &lt;0.11197.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:02:04.662 [error] 
&gt; &lt;0.9667.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:03:37.330 [error] 
&gt; &lt;0.11343.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:06:24.345 [error] 
&gt; &lt;0.11589.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; 2013-09-19 12:06:41.670 [error] 
&gt; &lt;0.11215.0&gt;@riak_cs_wm_common:**maybe_create_user:223
&gt; Retrieval of user record for s3 failed. Reason: disconnected
&gt; ==============================**======
&gt;
&gt;
&gt;
&gt; ========= erlang.log (riak) ==========
&gt; ===== ALIVE Thu Sep 19 12:01:04 EST 2013
&gt;
&gt; ===== ALIVE Thu Sep 19 12:16:04 EST 2013
&gt; ==============================**========
&gt;
&gt;
&gt; =========== console.log (riak) =========
&gt; 2013-09-19 12:03:05.471 [info] 
&gt; &lt;0.146.0&gt;@riak_core_gossip:**log_membership_changes:372
&gt; 'riak@mel-storage04.**strategicdata.internal' joined cluster with status
&gt; 'joining'
&gt; 2013-09-19 12:03:21.048 [info] 
&gt; &lt;0.146.0&gt;@riak_core_gossip:**log_membership_changes:378
&gt; 'riak@mel-storage04.**strategicdata.internal' changed from 'joining' to
&gt; 'valid'
&gt; 2013-09-19 12:03:26.235 [info] 
&gt; &lt;0.182.0&gt;@riak_core_handoff_**manager:handle_info:286
&gt; An outbound handoff of partition riak_kv_vnode
&gt; 274031556999544297163190906134**303066185487351808 was terminated for
&gt; reason: {shutdown,max_concurrency}
&gt;
&gt; ^^ very similar messages to that repeat a few hundred times ^^
&gt;
&gt; ==============================**============
&gt;
&gt;
&gt; ______________________________**_________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/**mailman/listinfo/riak-users_**lists.basho.com">http://lists.basho.com/**mailman/listinfo/riak-users_**lists.basho.com</a>&lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12317.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd10.html#12318">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail10.html#12318">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12320.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12310.html">Riak CS 1.4.1 bug? InvalidAccessKeyId reported for deletio...</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12311.html">Re: Riak CS 1.4.1 bug? InvalidAccessKeyId reported fo...</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12313.html">Invalid hintfiles (was: Riak CS 1.4.1 bug? Invali...</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12314.html">Re: Invalid hintfiles (was: Riak CS 1.4.1 bug...</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12315.html">Re: Invalid hintfiles</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12316.html">Re: Invalid hintfiles</a></span> <span class="sender italic">Seth Thomas</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12430.html">Re: Invalid hintfiles</a></span> <span class="sender italic">Toby Corkindale</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg12317.html">Re: Invalid hintfiles</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Invalid hintfiles</span> <span class="sender italic">Andrew Stone</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12320.html">Re: Invalid hintfiles</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12321.html">Re: Invalid hintfiles</a></span> <span class="sender italic">Andrew Stone</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Invalid hintfiles">
<input type="hidden" name="msgid" value="CAL3qbFK_Jn=YUym5ZtsYm3pAZaaf7ej+r8565OUnt1qV7Haveg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12318.html">
<input type="submit" value=" Andrew Stone ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Invalid+hintfiles%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12317.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12320.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAL3qbFK_Jn=YUym5ZtsYm3pAZaaf7ej+r8565OUnt1qV7Haveg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
