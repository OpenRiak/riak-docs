<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: some really weird stuff with python client's delete...</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#05950" id="c">
<link rel="index" href="maillist.html#05950" id="i">
<link rel="prev" href="msg05947.html" id="p">
<link rel="next" href="msg05951.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05950.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+some+really+weird+stuff+with+python+client%27s+delete...%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: some really weird stuff with python client's delete...</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jon+Meredith%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jon Meredith</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111215" rel="nofollow">Thu, 15 Dec 2011 06:41:32 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Shuhau,

Do you intentionally try and delete all of the keys from the users bucket?
 The keys list is built from the keys in the blog and the users bucket.
 Would changing the code to list the blog bucket, delete then verify before
moving on to the users bucket do what you want?</pre><pre>

Jon

On Wed, Dec 14, 2011 at 7:54 PM, Shuhao Wu &lt;ad...@thekks.net&gt; wrote:

&gt; I'm trying to delete all the keys i've created after running some
&gt; doctests. (I know i should be using the test server.. but it appears that i
&gt; need to be root to run that...)
&gt;
&gt; Here's the script:
&gt;
&gt; #!/usr/bin/python
&gt; if __name__ == &quot;__main__&quot;:
&gt;   import doctest
&gt;   print &quot;Running tests....&quot;
&gt;   #doctest.testfile(&quot;README.md&quot;) # I commented this out because my cleanup
&gt; is not deleting...
&gt;   print &quot;If nothing happened, success.. otherwise.. DEBUG HOUR!&quot;
&gt;
&gt;   # Clean up
&gt;   import riak
&gt;   print &quot;Clean up time!&quot;
&gt;   client = riak.RiakClient()
&gt;   bucket = client.bucket(&quot;blog&quot;)
&gt;   keys = bucket.get_keys()
&gt;   bucket = client.bucket(&quot;users&quot;)
&gt;   keys.extend(bucket.get_keys())
&gt;   print &quot;Keys to be cleaned: &quot; + str(keys)
&gt;
&gt;   for key in keys:
&gt;     print (&quot;Deleting %s...&quot; % key), not bucket.get(key).delete().exists()
&gt;
&gt;   for key in keys:
&gt;     print &quot;Verifying %s deleted: %s&quot; % (key, not bucket.get(key).exists())
&gt;
&gt;   print &quot;Deleted %d keys!&quot; % len(keys)
&gt;
&gt;
&gt; Here's the output:
&gt;
&gt; Running tests....
&gt; If nothing happened, success.. otherwise.. DEBUG HOUR!
&gt; Clean up time!
&gt; Keys to be cleaned: [u'534c8cda268b11e1b1b68ca982440b40',
&gt; u'b8eb84e8268a11e195748ca982440b40', u'6fa5b678268a11e1bf8d8ca982440b40',
&gt; u'dada10a6268a11e1a0888ca982440b40', u'549e0e2a268a11e1be1e8ca982440b40',
&gt; u'4957347e268a11e196e68ca982440b40', u'c03e2df8268b11e1ae5e8ca982440b40',
&gt; u'ddadfe28268a11e1ad0b8ca982440b40', u'7d54bb7a268a11e187718ca982440b40']
&gt; Deleting 534c8cda268b11e1b1b68ca982440b40... True
&gt; Deleting b8eb84e8268a11e195748ca982440b40... True
&gt; Deleting 6fa5b678268a11e1bf8d8ca982440b40... True
&gt; Deleting dada10a6268a11e1a0888ca982440b40... True
&gt; Deleting 549e0e2a268a11e1be1e8ca982440b40... True
&gt; Deleting 4957347e268a11e196e68ca982440b40... True
&gt; Deleting c03e2df8268b11e1ae5e8ca982440b40... True
&gt; Deleting ddadfe28268a11e1ad0b8ca982440b40... True
&gt; Deleting 7d54bb7a268a11e187718ca982440b40... True
&gt; Verifying 534c8cda268b11e1b1b68ca982440b40 deleted: True
&gt; Verifying b8eb84e8268a11e195748ca982440b40 deleted: True
&gt; Verifying 6fa5b678268a11e1bf8d8ca982440b40 deleted: True
&gt; Verifying dada10a6268a11e1a0888ca982440b40 deleted: True
&gt; Verifying 549e0e2a268a11e1be1e8ca982440b40 deleted: True
&gt; Verifying 4957347e268a11e196e68ca982440b40 deleted: True
&gt; Verifying c03e2df8268b11e1ae5e8ca982440b40 deleted: True
&gt; Verifying ddadfe28268a11e1ad0b8ca982440b40 deleted: True
&gt; Verifying 7d54bb7a268a11e187718ca982440b40 deleted: True
&gt; Deleted 9 keys!
&gt;
&gt; I can run this multiple times and it doesn't delete it and always show the
&gt; exact same output... but if i open a separate python console and delete one
&gt; of these keys via the same method (create a client, get a bucket, get the
&gt; object via key, delete the object...), this will go down to 9 keys...
&gt;
&gt; What's wrong? I'm so confused by this thing..
&gt;
&gt; Shuhao
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;


-- 
Jon Meredith
Platform Engineering Manager
Basho Technologies, Inc.
jmered...@basho.com
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05947.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#05950">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#05950">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05951.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05947.html">some really weird stuff with python client's delete...</a></span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: some really weird stuff with python client's dele...</span> <span class="sender italic">Jon Meredith</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05951.html">Re: some really weird stuff with python client's ...</a></span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05952.html">Re: some really weird stuff with python clien...</a></span> <span class="sender italic">Jon Meredith</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05953.html">Re: some really weird stuff with python c...</a></span> <span class="sender italic">Reid Draper</span></li>
<li class="icons-email"><span class="subject"><a href="msg05954.html">Re: some really weird stuff with python c...</a></span> <span class="sender italic">Kostya Rybnikov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05955.html">Re: some really weird stuff with pyt...</a></span> <span class="sender italic">Shuhao Wu</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: some really weird stuff with python client's delete...">
<input type="hidden" name="msgid" value="CAGgQeSv65ru=JmwEPO45p2dYrH09PP62h64qZ-z5K2N+3-m5Vg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05950.html">
<input type="submit" value=" Jon Meredith ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+some+really+weird+stuff+with+python+client%27s+delete...%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05947.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05951.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAGgQeSv65ru=JmwEPO45p2dYrH09PP62h64qZ-z5K2N+3-m5Vg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
