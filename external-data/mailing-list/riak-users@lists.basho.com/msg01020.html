<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Listing keys in a bucket</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#01020" id="c">
<link rel="index" href="maillist.html#01020" id="i">
<link rel="prev" href="msg01019.html" id="p">
<link rel="next" href="msg01023.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg01020.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Listing+keys+in+a+bucket%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Listing keys in a bucket</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Sean+Cribbs%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Sean Cribbs</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100904" rel="nofollow">Sat, 04 Sep 2010 12:19:31 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>You wouldn't put 10,000 files in a single directory on your computer, so 
there's no reason you would have to in Riak either.  What about representing 
your directories as objects, too? The only thing you would require would be a 
known key that's the root of the hierarchy. For example:</pre><pre>

/riak/files/__root, which has links to:
-&gt; &quot;/riak/files/images&quot; (directory)
-&gt; &quot;/riak/files/text&quot; (directory)
-&gt; &quot;/riak/files/index.html&quot; (file)

&quot;/riak/files/images&quot; which has links to:
-&gt; &quot;/riak/files/images%2Ffavicon.ico&quot; (file)
-&gt; &quot;/riak/files/images%2Flogo.jpg&quot; (file)

(note I escape the slashes in the key names)

With proper use of links and tags, this is not a difficult problem.  If you 
just want to mount Riak like a file system, you might look at Artur Bergman's 
riakfuse project.

Sean Cribbs &lt;s...@basho.com&gt;
Developer Advocate
Basho Technologies, Inc.
<a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>

On Sep 4, 2010, at 2:51 PM, John Axel Eriksson wrote:

&gt; Yes, I've thought of this but as I understand it there is a bit of a problem 
&gt; attaching a large amount of links to a key which
&gt; would be necessary here am I right? If I had 10 000 files in riak that would 
&gt; mean 10 000 links attached to the &quot;listing&quot; key.
&gt; 
&gt; 4 sep 2010 kl. 20.44 skrev Matthew Scott:
&gt; 
&gt;&gt; 
&gt;&gt; On Sat, Sep 4, 2010 at 11:31, John Axel Eriksson &lt;j...@insane.se&gt; wrote:
&gt;&gt; Listing keys in a bucket has been described as &quot;bad&quot; and something you use 
&gt;&gt; in development but
&gt;&gt; not in production. I'm just starting out on Riak so I'm a newbie...
&gt;&gt; 
&gt;&gt; I'm thinking of building an application using Riak as filestorage and 
&gt;&gt; possibly much more than that, but it would
&gt;&gt; at least store lots of files with, perhaps, metadata attached. How would I 
&gt;&gt; then list files for display in a webapp if
&gt;&gt; I don't use key listing?
&gt;&gt; 
&gt;&gt; I'm still very much a Riak newb myself, but I'll take a shot at answering 
&gt;&gt; this one by suggesting the use of links.
&gt;&gt; 
&gt;&gt; From what I understand, links some quantity limits when you attach a large 
&gt;&gt; number, but adding and removing them is an inexpensive operation.  (Someone 
&gt;&gt; fact check me on that please :)
&gt;&gt; 
&gt;&gt; - Create a key called 'listing', perhaps even in its own bucket to prevent 
&gt;&gt; namespace collision.
&gt;&gt; 
&gt;&gt; - Create links from that 'listing' key to metadata keys.  Remember that you 
&gt;&gt; can attach a tag to each link to differentiate different types of links, 
&gt;&gt; such as &quot;metadata&quot;.
&gt;&gt; 
&gt;&gt; - The metadata keys' values would contain file metadata in JSON form, and in 
&gt;&gt; turn have a link to the file contents key, tagged &quot;contents&quot;.
&gt;&gt; 
&gt;&gt; - Remember to attach the proper mime type to the key containing your file 
&gt;&gt; contents.
&gt;&gt; 
&gt;&gt; - To get a file listing, do a map/reduce starting at &quot;listing&quot;, following 
&gt;&gt; its &quot;metadata&quot; links and grabbing those values, then reduce to sort by a key.
&gt;&gt; 
&gt;&gt; - To get file contents, follow the &quot;contents&quot; link from the metadata key.
&gt;&gt; 
&gt;&gt; --
&gt;&gt; Matthew Scott
&gt;&gt; ElevenCraft, Inc.
&gt;&gt; <a  rel="nofollow" href="http://11craft.com/">http://11craft.com/</a>
&gt;&gt; +1 360 389-2512
&gt;&gt; 
&gt;&gt;  
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg01019.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#01020">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#01020">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg01023.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg01017.html">Listing keys in a bucket</a></span> <span class="sender italic">John Axel Eriksson</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01018.html">Re: Listing keys in a bucket</a></span> <span class="sender italic">Matthew Scott</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01019.html">Re: Listing keys in a bucket</a></span> <span class="sender italic">John Axel Eriksson</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Listing keys in a bucket</span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01023.html">Re: Listing keys in a bucket</a></span> <span class="sender italic">John Axel Eriksson</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg01021.html">Re: Listing keys in a bucket</a></span> <span class="sender italic">Matthew Scott</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01022.html">Re: Listing keys in a bucket</a></span> <span class="sender italic">John Axel Eriksson</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Listing keys in a bucket">
<input type="hidden" name="msgid" value="E108396B-CCD0-4E1E-AC5A-D311FD39831F@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg01020.html">
<input type="submit" value=" Sean Cribbs ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Listing+keys+in+a+bucket%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg01019.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg01023.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">E108396B-CCD0-4E1E-AC5A-D311FD39831F@basho.com</li>
</ul>
</div>
</body>
</html>
