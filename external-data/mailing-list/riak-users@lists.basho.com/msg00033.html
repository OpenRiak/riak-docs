<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: I like Riak! (but /test is slooooowww -- probably my fault)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#00033" id="c">
<link rel="index" href="maillist.html#00033" id="i">
<link rel="prev" href="msg00030.html" id="p">
<link rel="next" href="msg00025.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg00033.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+I+like+Riak%5C%21+%5C%28but+%5C%2Ftest+is+slooooowww+%5C-%5C-+probably+my+fault%5C%29%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: I like Riak! (but /test is slooooowww -- probably my fault)</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Grant+Schofield%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Grant Schofield</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100413" rel="nofollow">Tue, 13 Apr 2010 14:52:53 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>This is probably being caused the the single core you have on the EC2 node. You 
will need to enable your Erlang to be smp capable to make innostore work. Add 
the following to your /etc/riak/vm.args file (anywhere will do):
-smp enable</pre><pre>

This is something we are going to add to the vm.args we distribute to work 
around the issue.  Give the above a try and report back with any issues you 
have.

Grant Schofield
Developer Advocate
Basho Technologies, Inc.

On Apr 13, 2010, at 3:09 PM, Tyler Smart wrote:

&gt; hi Grant, I am running innostore 8, as downloaded from here, the 32bit deb
&gt; 
&gt; <a  rel="nofollow" href="http://downloads.basho.com/riak/riak-0.9/">http://downloads.basho.com/riak/riak-0.9/</a>
&gt; 
&gt; Here is the erland log file, the last 100 lines of it, but I did not see a 
&gt; SASS log file in the /var/log directory.
&gt; Erlang File:
&gt; 
&gt; 
&gt; =====
&gt; Exec: /usr/lib/riak/erts-5.7.4/bin/erlexec -boot 
&gt; /usr/lib/riak/releases/0.9.1/riak -embedded -config /etc/riak/app.config 
&gt; -args_file /etc/riak/vm.args -- console
&gt; Root: /usr/lib/riak
&gt; Erlang R13B03 (erts-5.7.4) [source] [rq:1] [async-threads:5] 
&gt; [kernel-poll:true]
&gt; 
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.104.0&gt;)
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.105.0&gt;)
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.106.0&gt;)
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.107.0&gt;)
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.108.0&gt;)
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.109.0&gt;)
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.110.0&gt;)
&gt; 
&gt; =INFO REPORT==== 13-Apr-2010::15:18:38 ===
&gt; Spidermonkey VM host starting (&lt;0.111.0&gt;)
&gt; 
&gt; =ERROR REPORT==== 13-Apr-2010::15:18:38 ===
&gt; No ring file available.
&gt; Eshell V5.7.4  (abort with ^G)
&gt; (r...@127.0.0.1)1&gt; 
&gt; =ERROR REPORT==== 13-Apr-2010::15:19:22 ===
&gt; Skipping config setting included_applications; unknown option.
&gt; InnoDB: Mutexes and rw_locks use GCC atomic builtins
&gt; InnoDB: The first specified data file /riak/data/ibdata1 did not exist:
&gt; InnoDB: a new database to be created!
&gt; 100413 15:19:31  InnoDB: Setting file /riak/data/ibdata1 size to 32 MB
&gt; InnoDB: Database physically writes the file full: wait...
&gt; 100413 15:19:32  InnoDB: Log file /riak/logs/ib_logfile0 did not exist: new 
&gt; to be created
&gt; InnoDB: Setting log file /riak/logs/ib_logfile0 size to 16 MB
&gt; InnoDB: Database physically writes the file full: wait...
&gt; 100413 15:19:33  InnoDB: Log file /riak/logs/ib_logfile1 did not exist: new 
&gt; to be created
&gt; InnoDB: Setting log file /riak/logs/ib_logfile1 size to 16 MB
&gt; InnoDB: Database physically writes the file full: wait...
&gt; InnoDB: Doublewrite buffer not found: creating new
&gt; InnoDB: Doublewrite buffer created
&gt; InnoDB: Creating foreign key constraint system tables
&gt; InnoDB: Foreign key constraint system tables created
&gt; 100413 15:19:33 Embedded InnoDB 1.0.6.6750 started; log sequence number 0
&gt; 
&gt; ===== ALIVE Tue Apr 13 15:34:33 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 15:49:34 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 16:04:34 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 16:19:34 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 16:34:34 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 16:49:34 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 17:04:34 UTC 2010
&gt; 
&gt; ===== Tue Apr 13 17:18:31 UTC 2010
&gt; 
&gt; =ERROR REPORT==== 13-Apr-2010::17:18:31 ===
&gt; ** State machine &lt;0.566.0&gt; terminating 
&gt; ** Last message in was flow_timeout
&gt; ** When State == executing
&gt; **      Data  == {state,50096623,
&gt;                         [&lt;0.568.0&gt;,&lt;0.567.0&gt;],
&gt;                         &lt;0.560.0&gt;,66000,
&gt;                         {1271179111446655,#Ref&lt;0.0.0.1123&gt;},
&gt;                         []}
&gt; ** Reason for termination = 
&gt; ** flow_timeout
&gt; 
&gt; ===== ALIVE Tue Apr 13 17:33:31 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 17:48:31 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 18:03:31 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 18:18:31 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 18:33:32 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 18:48:32 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 19:03:32 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 19:18:32 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 19:33:32 UTC 2010
&gt; 
&gt; ===== ALIVE Tue Apr 13 19:48:32 UTC 2010
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; On Tue, Apr 13, 2010 at 3:22 PM, Grant Schofield &lt;gr...@basho.com&gt; wrote:
&gt; What version of Riak and Innostore are you running?  Also providing both your 
&gt; erlang.log.1 as well as your sasl-error.log files from the log directory 
&gt; would help us diagnose the issue you're experiencing.
&gt; 
&gt; Thanks,
&gt; Grant Schofield
&gt; Developer Advocate 
&gt; Basho Technologies, Inc.
&gt; 
&gt; 
&gt; On Apr 13, 2010, at 12:55 PM, Tyler Smart wrote:
&gt; 
&gt;&gt;  {riak, [
&gt;&gt;          %% storage_backend specifies the Erlang module defining the storage 
&gt;&gt; mechanism
&gt;&gt;          %%  that will be used on this node.
&gt;&gt;          %% {storage_backend, riak_dets_backend},
&gt;&gt;          {storage_backend, innostore_riak},
&gt;&gt; 
&gt;&gt;          %% Different storage backends can use other configuration 
&gt;&gt; variables.  For
&gt;&gt;          %%  instance, riak_dets_backend_root determines the directory under 
&gt;&gt; which
&gt;&gt;          %%  dets files will be placed.
&gt;&gt;          {riak_dets_backend_root, &quot;/riak/backendroot&quot;},
&gt;&gt; 
&gt;&gt;          %% Default location of ringstate
&gt;&gt;          {ring_state_dir, &quot;/riak/ringstate&quot;},
&gt;&gt; 
&gt;&gt;          %% riak_web_ip is the IP address that Riak's HTTP interface will 
&gt;&gt; bind to.
&gt;&gt;          %%  If this is undefined, the HTTP interface will not run.
&gt;&gt;          {riak_web_ip, &quot;127.0.0.1&quot;},
&gt;&gt; 
&gt;&gt;          %% riak_web_port is the TCP port that Riak's HTTP interface will 
&gt;&gt; bind to.
&gt;&gt;          {riak_web_port, 8098},
&gt;&gt; 
&gt;&gt;          %% riak_handoff_port is the TCP port that Riak uses for 
&gt;&gt; intra-cluster
&gt;&gt;          %% data handoff.
&gt;&gt;          {riak_handoff_port, 8099},
&gt;&gt; 
&gt;&gt;          %% mapred_name is URL used to submit map/reduce requests to Riak.
&gt;&gt;          {mapred_name, &quot;mapred&quot;},
&gt;&gt; 
&gt;&gt;          %% js_vm_count is the number of Javascript VMs to start per Riak 
&gt;&gt; node.
&gt;&gt;          %% 8 is a good default for smaller installations. A larger number 
&gt;&gt; like
&gt;&gt;          %% 12 or 16 is appropriate for installations handling lots of 
&gt;&gt; map/reduce
&gt;&gt;          %% processing.
&gt;&gt;          {js_vm_count, 8},
&gt;&gt; 
&gt;&gt;          %% js_source_dir should point to a directory containing Javascript 
&gt;&gt; source
&gt;&gt;          %% files which will be loaded by Riak when it initializes 
&gt;&gt; Javascript VMs.
&gt;&gt;          %{js_source_dir, &quot;/tmp/js_source&quot;}
&gt;&gt; 
&gt;&gt; 
&gt;&gt;          %% riak_stat enables the use of the &quot;riak-admin status&quot; command to
&gt;&gt;          %% retrieve information the Riak node for performance and debugging 
&gt;&gt; needs
&gt;&gt;          {riak_stat, true}
&gt;&gt;         ]},
&gt;&gt; 
&gt;&gt;          %% SASL config
&gt;&gt;          {sasl, [
&gt;&gt;                  {sasl_error_logger, {file, &quot;log/sasl-error.log&quot;}},
&gt;&gt;                  {errlog_type, error},
&gt;&gt;                  {error_logger_mf_dir, &quot;log/sasl&quot;},      % Log directory
&gt;&gt;                  {error_logger_mf_maxbytes, 10485760},   % 10 MB max file 
&gt;&gt; size
&gt;&gt;                  {error_logger_mf_maxfiles, 5}           % 5 files max
&gt;&gt;                  ]},
&gt;&gt; 
&gt;&gt;         {innostore, [
&gt;&gt;             {data_home_dir, &quot;/riak/data&quot;}, %% Where data files go
&gt;&gt;             {log_group_home_dir, &quot;/riak/logs&quot;}, %% Where log files go, 
&gt;&gt; ideally the logs and data are on separate drives for performance...maybe 
&gt;&gt; later
&gt;&gt;             {buffer_pool_size, 268435456} %% 256MB in-memory buffer in bytes
&gt;&gt;         ]}
&gt;&gt; ].
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Sorry for the confusion, that is the config file, I hope it helps.
&gt;&gt; 
&gt;&gt; Sincerely,
&gt;&gt; Tyler
&gt;&gt; 
&gt;&gt; On Tue, Apr 13, 2010 at 1:27 PM, Tyler Smart &lt;tyleresm...@gmail.com&gt; wrote:
&gt;&gt; Hi all! 
&gt;&gt; 
&gt;&gt; I have installed Riak on an Ubuntu 8.04 EC-2 instance and it stores all of 
&gt;&gt; its' data on an EBS block (10GB). The machine is 32 bit (small).  It will 
&gt;&gt; accept information in a bucket easily with a curl request like this:
&gt;&gt; 
&gt;&gt; curl -X PUT -H &quot;content-type: text/plain&quot;      
&gt;&gt; <a  rel="nofollow" href="https://127.0.0.1/riak/example/foo">https://127.0.0.1/riak/example/foo</a> --data &quot;I have a document.&quot;
&gt;&gt; 
&gt;&gt; If I query the data like this:
&gt;&gt; 
&gt;&gt;  curl -i -k <a  rel="nofollow" href="https://127.0.0.1/riak/example/foo">https://127.0.0.1/riak/example/foo</a>
&gt;&gt; 
&gt;&gt; I get back the data, it works perfectly. (It sits behind nginx as a reverse 
&gt;&gt; proxy that adds SSL).
&gt;&gt; 
&gt;&gt; However, if I perform this query:
&gt;&gt; 
&gt;&gt; <a  rel="nofollow" href="https://127.0.0.1/riak/example">https://127.0.0.1/riak/example</a>
&gt;&gt; 
&gt;&gt; it never finishes executing, nor if I try <a  rel="nofollow" href="https://127.0.0.1/riak/test">https://127.0.0.1/riak/test</a>
&gt;&gt; 
&gt;&gt; I have attached the conf file, if it will help, and I appreciate any time 
&gt;&gt; you guys have! 
&gt;&gt; 
&gt;&gt; Sincerely,
&gt;&gt; Tyler
&gt;&gt; 
&gt;&gt; 
&gt;&gt; The problem I am having is that I can 
&gt;&gt; 
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg00030.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#00033">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#00033">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg00025.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg00023.html">I like Riak! (but /test is slooooowww -- probably my fault...</a></span> <span class="sender italic">Tyler Smart</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00024.html">Re: I like Riak! (but /test is slooooowww -- probably...</a></span> <span class="sender italic">Tyler Smart</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00030.html">Re: I like Riak! (but /test is slooooowww -- prob...</a></span> <span class="sender italic">Grant Schofield</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: I like Riak! (but /test is slooooowww -- ...</span> <span class="sender italic">Grant Schofield</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: I like Riak! (but /test is slooooowww -- probably my fault)">
<input type="hidden" name="msgid" value="3C1EE546-2975-4E46-A48D-78756F2ECA7A@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg00033.html">
<input type="submit" value=" Grant Schofield ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+I+like+Riak%5C%21+%5C%28but+%5C%2Ftest+is+slooooowww+%5C-%5C-+probably+my+fault%5C%29%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg00030.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg00025.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">3C1EE546-2975-4E46-A48D-78756F2ECA7A@basho.com</li>
</ul>
</div>
</body>
</html>
