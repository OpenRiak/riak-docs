<!DOCTYPE html>
<html lang="en">
<head>
<title>Fw: Issue with Riak Install from Source under SUSE SLES 11 SP11	Version S390 / Problem solved</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07347" id="c">
<link rel="index" href="maillist.html#07347" id="i">
<link rel="prev" href="msg07340.html" id="p">
<link rel="next" href="msg07390.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07347.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Fw%5C%3A+Issue+with+Riak+Install+from+Source+under+SUSE+SLES+11+SP11%09Version+S390+%5C%2F+Problem+solved%22&amp;o=newest" rel="nofollow"><span itemprop="name">Fw: Issue with Riak Install from Source under SUSE SLES 11 SP11	Version S390 / Problem solved</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22claudef%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">claudef</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120430" rel="nofollow">Mon, 30 Apr 2012 05:48:02 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Dear colleagues,

Problem solved! </pre><pre>

To give you a current feedback about the status of the port. I've succeed 
to ported the RIAK database under the IBM mainframe system z model E114 
running it under the Linux SUSE SLES 11 SP1. I was very happy to find a 
post from Mr. Nobuhiro Iwamatsu (Debian Linux Engineer) who described a 
fix for the module atomic_pointer.h to reconize the S390 architecture 
(possibly also the Power7). I suggest to Basho to include this fix into 
the latest .github source distribution. 

 I'v applied those changes to the module and the executable now was 
successfully built.. I already did some testing with the Python and Java 
clients , both are working perfectly with a few samples from the Basho 
wiki. 

First of all, my big thanks for the great support from the Erlang user 
group, as well as the Riak user group that both helped me to quickly fix 
those porting issues. 
Regards, 
Claude 



Dear colleagues, 

Thanks for the quick replies in usergroup. 

I've reinstalled the &quot;curl&quot; and &quot;expat&quot; packages both from its source and 
rebuilt the &quot;git&quot; tool using the: 

./configure --with-curl --with-expat 

ps .. yes, for Suse it must be done from source. 

As Jared pointed below, by changing the git protocol to &quot;<a  rel="nofollow" href="http://&quot">http://&quot</a>; it 
solved the issue and the &quot;leveldb&quot; package was successfully downloaded. 
This is a good step forwards. 

During the build and a few steps later I got another error message 
telling:  &quot;Please implement AtomicPointer for this platform&quot; 

HEAD is now at 14478f1... Rework compaction scoring to ensure L1 doesn't 
exceed the max bytes on that level
make[1]: Entering directory 
`/opt/riak/riak-1.1.2/deps/eleveldb/c_src/leveldb'
c++  -fPIC -fPIC -I 
/opt/riak/riak-1.1.2/deps/eleveldb/c_src/system/include -c -I. -I./include 
-fno-builtin-memcmp -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 
-DNDEBUG        -DSNAPPY db/builder.cc -o db/builder.o
In file included from ./port/port_posix.h:28,
                 from ./port/port.h:14,
                 from ./db/filename.h:14,
                 from db/builder.cc:7:
./port/atomic_pointer.h:133:2: error: #error Please implement 
AtomicPointer for this platform.
make[1]: *** [db/builder.o] Error 1
make[1]: Leaving directory 
`/opt/riak/riak-1.1.2/deps/eleveldb/c_src/leveldb'
ERROR: Command [compile] failed!
make: *** [rel] Error 1

Any idea how to fix this error?  Any dependency with other packages? 

Thanks in advance for your support. 

Regards, 
Claude 


Claude Falbriard 
Certified IT Specialist L2 - Middleware
AMS Hortolândia / SP - Brazil
phone:    +55 19 9837 0789
cell:         +55 13 8117 3316
e-mail:    clau...@br.ibm.com




From:   Jared Morrow &lt;ja...@basho.com&gt;
To:     clau...@br.ibm.com
Cc:     riak-users@lists.basho.com
Date:   28/04/2012 01:17
Subject:        Re: Issue with Riak Install from Source under SUSE SLES 11 
SP11 Version S390



Claude,

The issue is not in the rebar.config file for eleveldb, but in a file that 
fetches the original C++ source for leveldb.   To fix your issue, simply 
unpack the riak source as you already did then:

$ cd deps/eleveldb

And then make the following changes to 'c_src/build_deps.sh':

--- c_src/build_deps.sh.orig 2012-04-27 22:06:31.000000000 -0600
+++ c_src/build_deps.sh 2012-04-27 22:07:49.000000000 -0600
@@ -37,7 +37,7 @@
         export LD_LIBRARY_PATH=&quot;$BASEDIR/system/lib:$LD_LIBRARY_PATH&quot;
 
         if [ ! -d leveldb ]; then
-            git clone git://github.com/basho/leveldb
+            git clone <a  rel="nofollow" href="http://github.com/basho/leveldb">http://github.com/basho/leveldb</a>
             (cd leveldb &amp;&amp; git checkout $LEVELDB_VSN)
         fi
 
Then return to the top-level source directory for Riak and run 'make' and 
things should be better.

-Jared




On Apr 27, 2012, at 12:31 PM, clau...@br.ibm.com wrote:

Dear colleagues, 

Trying to install the RIAK package under a  SUSE SLES 11 SP11 Version 
S390. I've downloaded the .tar.gz install file from the BASHO site. First 
I've installed the Erlang package with the --with-ssl option and 
recompiled the openssl package with the &quot;shared&quot; option, as requested by 
the Erlang procedure. 

Using the &quot;make rel&quot; command, I see a successful build running on the 
screen, until a point where the install tries to connect to the GITHUB, 
throwing an error like this: 
    
test -z &quot;/opt/riak/riak-1.1.2/deps/eleveldb/c_src/system/share/doc/snappy&quot; 
|| /bin/mkdir -p 
&quot;/opt/riak/riak-1.1.2/deps/eleveldb/c_src/system/share/doc/snappy&quot; 
 /usr/bin/install -c -m 644 ChangeLog COPYING INSTALL NEWS README 
format_description.txt 
'/opt/riak/riak-1.1.2/deps/eleveldb/c_src/system/share/doc/snappy' 
test -z &quot;/opt/riak/riak-1.1.2/deps/eleveldb/c_src/system/include&quot; || 
/bin/mkdir -p &quot;/opt/riak/riak-1.1.2/deps/eleveldb/c_src/system/include&quot; 
 /usr/bin/install -c -m 644 snappy.h snappy-sinksource.h 
snappy-stubs-public.h snappy-c.h 
'/opt/riak/riak-1.1.2/deps/eleveldb/c_src/system/include' 
make[2]: Leaving directory 
`/opt/riak/riak-1.1.2/deps/eleveldb/c_src/snappy-1.0.4' 
make[1]: Leaving directory 
`/opt/riak/riak-1.1.2/deps/eleveldb/c_src/snappy-1.0.4' 

fatal: unable to connect to github.com: 
github.com[0: 207.97.227.239]: errno=Connection refused 

Cloning into 'leveldb'... 
ERROR: Command [compile] failed! 
make: *** [rel] Error 1 
  
The riak executable was not yet created under the /bin. 


Question:   
-------------- 
Is there a way to avoid a connect to GITHUB during the package build from 
source, or could you give me a pointer what is causing the connection to 
be refused, as our firewall is configured for outgoing HTTP connections 
(which port and protocol does it use?). 

Thanks in advance for your feedback and support. 

Regards, 
Claude   



Claude Falbriard 
Certified IT Specialist L2 - Middleware
AMS Hortolândia / SP - Brazil
phone:    +55 19 9837 0789
cell:         +55 13 8117 3316
e-mail:    clau...@br.ibm.com
_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07340.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07347">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07347">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07390.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Fw: Issue with Riak Install from Source under SUSE SLES ...</span> <span class="sender italic">claudef</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07390.html">Re: Fw: Issue with Riak Install from Source under S...</a></span> <span class="sender italic">Nobuhiro Iwamatsu</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Fw: Issue with Riak Install from Source under SUSE SLES 11 SP11	Version S390 / Problem solved">
<input type="hidden" name="msgid" value="OF43DA16A4.5E8B8930-ON832579F0.0044DBD6-032579F0.00464924@br.ibm.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07347.html">
<input type="submit" value=" claudef ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Fw%5C%3A+Issue+with+Riak+Install+from+Source+under+SUSE+SLES+11+SP11%09Version+S390+%5C%2F+Problem+solved%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07340.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07390.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">OF43DA16A4.5E8B8930-ON832579F0.0044DBD6-032579F0.00464924@br.ibm.com</li>
</ul>
</div>
</body>
</html>
