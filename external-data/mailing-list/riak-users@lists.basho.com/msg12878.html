<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: LevelDB tuning questions.</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd9.html#12878" id="c">
<link rel="index" href="mail7.html#12878" id="i">
<link rel="prev" href="msg12877.html" id="p">
<link rel="next" href="msg12879.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12878.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+LevelDB+tuning+questions.%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: LevelDB tuning questions.</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Matthew+Von%5C-Maszewski%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Matthew Von-Maszewski</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131107" rel="nofollow">Thu, 07 Nov 2013 10:09:26 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>inserting replies in original text

On Nov 7, 2013, at 12:49 PM, kzhang &lt;kzh...@wayfair.com&gt; wrote:</pre><pre>

&gt; Thanks again!
&gt; 
&gt; I have a few questions regarding the new spreadsheet.
&gt; 
&gt; 'percent reserved', in the spreadsheet, it is set at 10%, we should really
&gt; use 50%?
&gt; 
&gt; 'vnode count', it is 'vnode count per server'?
&gt; 
percent reserved and vnode count:  there are two ways to populate the fields

 - set percent reserved in range of 50 to 75% (50 for small number of nodes 
&lt;10, 75 for &gt;10), 
   and set vnode count to your ring size divided by total number of nodes

 - set percent reserved to 10% 
   and set vnode count to your ring size divided by your worst case count of 
nodes after multiple server failures

The first way is the documented method.  The second is what I have been using 
more recently.


&gt; E11 (max_open_file, with AAE), shows as a static value '10*4*1024*1024',
&gt; whereas D11(max_open_file calculations) is calculated as
&gt; (c11-10)*4*1024*1024, E11 looks a bit odd to me, should I use D11 instead?
&gt; 
No.  AAE does not use your max_open_file count.  It has a static allocation of 
10 to minimize impact.

&gt; I noticed 'avg value size' and 'avg key size' are missing from the new
&gt; compared to 1.2, is it intentional?
Yes.  The two values in 1.2 were used to estimate overhead for bloom filters.  
Bloom filter sizes and accounting completely changed in 1.3.  Made my life 
simpler.

&gt; 
&gt; Is the end goal to make:
&gt; working per vnode = ave for 2 write bufs + cache_size + max_open_files+20M
&gt; for LOG and for MANIFEST?
&gt; 
Yes.  

Side note:  never mess with the write buffer min and max size … unless 
something is really, really wrong … or you have almost no RAM.  There are 
several internal tunings based upon those assumed sizes.

&gt; Thanks,
&gt; 
&gt; Kathleen
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; --
&gt; View this message in context: 
&gt; <a  rel="nofollow" href="http://riak-users.197444.n3.nabble.com/LevelDB-tuning-questions-tp4029246p4029719.html">http://riak-users.197444.n3.nabble.com/LevelDB-tuning-questions-tp4029246p4029719.html</a>
&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12877.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd9.html#12878">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail7.html#12878">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12879.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12411.html">LevelDB tuning questions.</a></span> <span class="sender italic">Guido Medina</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12414.html">Re: LevelDB tuning questions.</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12873.html">Re: LevelDB tuning questions.</a></span> <span class="sender italic">kzhang</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12874.html">Re: LevelDB tuning questions.</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12876.html">Re: LevelDB tuning questions.</a></span> <span class="sender italic">kzhang</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12875.html">Re: LevelDB tuning questions.</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12877.html">Re: LevelDB tuning questio...</a></span> <span class="sender italic">kzhang</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: LevelDB tuning que...</span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li class="icons-email"><span class="subject"><a href="msg12879.html">Re: LevelDB tuning que...</a></span> <span class="sender italic">kzhang</span></li>
<li class="icons-email"><span class="subject"><a href="msg12880.html">Re: LevelDB tuning que...</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li class="icons-email"><span class="subject"><a href="msg12883.html">Re: LevelDB tuning que...</a></span> <span class="sender italic">kzhang</span></li>
<li class="icons-email"><span class="subject"><a href="msg12884.html">Re: LevelDB tuning que...</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li class="icons-email"><span class="subject"><a href="msg12885.html">Re: LevelDB tuning que...</a></span> <span class="sender italic">Matt Black</span></li>
<li class="icons-email"><span class="subject"><a href="msg12892.html">Re: LevelDB tuning que...</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: LevelDB tuning questions.">
<input type="hidden" name="msgid" value="4F9A3FD5-A426-470B-89A5-C7977C3197E9@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12878.html">
<input type="submit" value=" Matthew Von-Maszewski ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+LevelDB+tuning+questions.%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12877.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12879.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">4F9A3FD5-A426-470B-89A5-C7977C3197E9@basho.com</li>
</ul>
</div>
</body>
</html>
