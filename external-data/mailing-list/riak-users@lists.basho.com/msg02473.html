<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: tuning riak for 100s of concurrent connections</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#02473" id="c">
<link rel="index" href="maillist.html#02473" id="i">
<link rel="prev" href="msg02472.html" id="p">
<link rel="next" href="msg02475.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg02473.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+tuning+riak+for+100s+of+concurrent+connections%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: tuning riak for 100s of concurrent connections</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Nico+Meyer%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Nico Meyer</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110225" rel="nofollow">Fri, 25 Feb 2011 11:43:17 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Just out of curiosity I did some tests myself on one of our production
machines. We normally only use the ProtocolBuffers interface and a
thrift interface that we wrote ourselves.</pre><pre>

If I fetch a small key (~250 bytes), the riak server becomes CPU bound
with about 20 concurrent requests, at which point the latency naturally
becomes larger. At this point one riak server is handling over 6000
requests/s. This is on an 8 core system (Dual Intel Xeon E5506
@2.13GHz), and all cores are at nearly 100%. No tuning was done on
either riak or the OS.

Also 99% of the requests still took less then 20ms, while with 10
concurrent requests its more like 2ms.


Am Freitag, den 25.02.2011, 13:54 -0500 schrieb Wilson MacGyver:
&gt; SO_REUSEADDR is also something you set at the socket API as I recall.
&gt; So I don't think it's something you can just set on the TCP/IP itself
&gt; as a global setting.
&gt; 
&gt; On Fri, Feb 25, 2011 at 1:41 PM, Les Mikesell &lt;lesmikes...@gmail.com&gt; wrote:
&gt; &gt; Those settings shouldn't make a big difference in how the number of
&gt; &gt; connections scale up, though.  There is a theoretical maximum rate limit for
&gt; &gt; creating new connections as each socket is supposed to sit in TIME_WAIT for
&gt; &gt; a packet round-trip time to ensure that nothing outstanding will collide
&gt; &gt; with that socket number when it is reused for the same IP address.  Maybe
&gt; &gt; your test is hitting that limit.  Can you set SO_REUSEADDR?
&gt; 
&gt; 



_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg02472.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#02473">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#02473">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg02475.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li><ul>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02465.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg02466.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li class="icons-email"><span class="subject"><a href="msg02468.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg02469.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li class="icons-email"><span class="subject"><a href="msg02470.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg02478.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Joseph Blomstedt</span></li>
<li class="icons-email"><span class="subject"><a href="msg02480.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Bryan O'Sullivan</span></li>
<li class="icons-email"><span class="subject"><a href="msg02481.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg02471.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Les Mikesell</span></li>
<li class="icons-email"><span class="subject"><a href="msg02472.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: tuning riak for 100s of concurrent connecti...</span> <span class="sender italic">Nico Meyer</span></li>
<li class="icons-email"><span class="subject"><a href="msg02475.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg02485.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Nico Meyer</span></li>
<li class="icons-email"><span class="subject"><a href="msg02477.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li class="icons-email"><span class="subject"><a href="msg02483.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Ryan Zezeski</span></li>
<li class="icons-email"><span class="subject"><a href="msg02474.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg02476.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li class="icons-email"><span class="subject"><a href="msg02479.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg02484.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li class="icons-email"><span class="subject"><a href="msg02467.html">Re: tuning riak for 100s of concurrent connecti...</a></span> <span class="sender italic">Wilson MacGyver</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg02458.html">Re: tuning riak for 100s of concurrent connections</a></span> <span class="sender italic">Wilson MacGyver</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: tuning riak for 100s of concurrent connections">
<input type="hidden" name="msgid" value="1298662991.2156.81.camel@erdnuss1.virtualminds-office.de">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg02473.html">
<input type="submit" value=" Nico Meyer ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+tuning+riak+for+100s+of+concurrent+connections%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg02472.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg02475.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">1298662991.2156.81.camel@erdnuss1.virtualminds-office.de</li>
</ul>
</div>
</body>
</html>
