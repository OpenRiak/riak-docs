<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak2.0 with Solr Search: index on one node contains not all	entries</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#15925" id="c">
<link rel="index" href="maillist.html#15925" id="i">
<link rel="prev" href="msg15924.html" id="p">
<link rel="next" href="msg15926.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15925.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak2.0+with+Solr+Search%5C%3A+index+on+one+node+contains+not+all%09entries%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak2.0 with Solr Search: index on one node contains not all	entries</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Zeeshan+Lakhani%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Zeeshan Lakhani</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20150325" rel="nofollow">Wed, 25 Mar 2015 07:12:07 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hello Michael,

First off, that section of the docs related to search index repair that you 
linked to is not referring to Riak Search 2.0 with Solr, and the link itself is 
actually pointing to Riak 1.4.7. We’ll update them accordingly for the current 
incarnation of Riak Search (for the 2.0 series).</pre><pre>

Just to be sure, does your custom schema include the required fields, as 
mentioned in the docs: 
<a  rel="nofollow" href="http://docs.basho.com/riak/latest/dev/advanced/search-schema/#Custom-Schemas">http://docs.basho.com/riak/latest/dev/advanced/search-schema/#Custom-Schemas</a>? 
&lt;<a  rel="nofollow" href="http://docs.basho.com/riak/latest/dev/advanced/search-schema/#Custom-Schemas">http://docs.basho.com/riak/latest/dev/advanced/search-schema/#Custom-Schemas</a>?&gt; 
Are these Riak nodes joined? What’s your ring size, n_val value?

How are you querying the Solr nodes to know which node has the data and which 
one doesn't? Coverage is R=1, so you would be getting a different number on 
some search queries (using the standard /search/query/&lt;index_name&gt;?...) if its 
only on one of the Solr cores.

Can you also post me a screenshot of your search AAE exchanges, e.g. 
`riak-admin search aae-status`? You could look at this thread, 
<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2015-March/016926.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2015-March/016926.html</a>
 
&lt;<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2015-March/016926.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2015-March/016926.html</a>&gt;,
 for answers on how to perform read-repair/repair the AAE tree.

Thanks.

Zeeshan Lakhani
programmer | 
software engineer at @basho | 
org. member/founder of @papers_we_love | paperswelove.org
twitter =&gt; @zeeshanlakhani

&gt; On Mar 25, 2015, at 6:42 AM, Michael Weibel &lt;michael.wei...@gmail.com&gt; wrote:
&gt; 
&gt; Hi all,
&gt; 
&gt; I have on a test environment two riak nodes and each of them has solr 
&gt; activated which index 3 buckets using a custom schema.
&gt; After testing a bit back and forth, I have the case that on one solr node, an 
&gt; entry is not in the index (I know in which node though). 
&gt; Fetching the specific key in the bucket works however, both nodes have the 
&gt; respective entry.
&gt; 
&gt; 1) How can this happen? I don't see any error/warning in the logs (neither 
&gt; solr nor riak logs). 
&gt; 2) Is there a possibility to fix this without having to do e.g. a PUT on the 
&gt; specific key with the same content in order to update it?
&gt; 
&gt; I tried to run a repair on the failing node using the guide: 
&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/1.4.7/ops/running/recovery/repairing-indexes/#Repairing-Search-Indexes">http://docs.basho.com/riak/1.4.7/ops/running/recovery/repairing-indexes/#Repairing-Search-Indexes</a>
&gt;  
&gt; &lt;<a  rel="nofollow" href="http://docs.basho.com/riak/1.4.7/ops/running/recovery/repairing-indexes/#Repairing-Search-Indexes">http://docs.basho.com/riak/1.4.7/ops/running/recovery/repairing-indexes/#Repairing-Search-Indexes</a>&gt;
&gt; When running the repair command on the partitions I received, it gave me 
&gt; however a [{&lt;PartitionId&gt;, down}, {...}] response, which gives me an 
&gt; uncomfortable feeling, but I didn't really figure out yet what this means 
&gt; exactly. 
&gt; 
&gt; Thanks a lot for your help :)
&gt; 
&gt; Best,
&gt; Michael
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15924.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#15925">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#15925">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15926.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg15924.html">Riak2.0 with Solr Search: index on one node contains not a...</a></span> <span class="sender italic">Michael Weibel</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak2.0 with Solr Search: index on one node conta...</span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15926.html">Re: Riak2.0 with Solr Search: index on one node c...</a></span> <span class="sender italic">Michael Weibel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15927.html">Re: Riak2.0 with Solr Search: index on one no...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15928.html">Re: Riak2.0 with Solr Search: index on on...</a></span> <span class="sender italic">Michael Weibel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15929.html">Re: Riak2.0 with Solr Search: index ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak2.0 with Solr Search: index on one node contains not all	entries">
<input type="hidden" name="msgid" value="541424C1-D34A-4C75-B216-7CA0D0D6E97D@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15925.html">
<input type="submit" value=" Zeeshan Lakhani ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak2.0+with+Solr+Search%5C%3A+index+on+one+node+contains+not+all%09entries%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15924.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15926.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">541424C1-D34A-4C75-B216-7CA0D0D6E97D@basho.com</li>
</ul>
</div>
</body>
</html>
