<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Do developers need to sanitize JSON input before sending to Riak	Client?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#15358" id="c">
<link rel="index" href="maillist.html#15358" id="i">
<link rel="prev" href="msg15356.html" id="p">
<link rel="next" href="msg15359.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15358.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Do+developers+need+to+sanitize+JSON+input+before+sending+to+Riak%09Client%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Do developers need to sanitize JSON input before sending to Riak	Client?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jason+Campbell%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jason Campbell</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20141212" rel="nofollow">Fri, 12 Dec 2014 05:20:02 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Riak is binary storage, if there is an injection attack, it will be done 
against the Ruby portion, not against Riak.</pre><pre>

The example you listed gives a ParserError when trying to load it via JSON, so 
I don’t understand how it could even get far enough in your code to reach Riak, 
unless you are not validating user input at all and just storing it in Riak.  
There is nothing wrong with that, but then anything coming out of Riak should 
be considered untrusted and handled accordingly.

A typical workflow would be something like this:
  1. Load user input (a string) as JSON.  This will provide a Ruby object 
representing the JSON
  2. Validate / business logic / whatever you want
  3. Save the Ruby object (or a changed one) in Riak via the client
  4. The Ruby client will convert it to JSON and store the JSON in Riak
  5. On the next request, the Ruby client will load the JSON from Riak and 
convert it back to a Ruby object

So an “injection” object will either fail 1 (like this one) because it’s 
invalid and doesn’t parse or it will fail 2 because you aren’t letting users 
set the admin flag without permission (right?).  I’m not sure how to get to 
step 3 without a seriously flawed JSON library or not checking obvious things.

Regardless though, the injection attack isn’t hidden at any point.  If it 
parses, it will be a Ruby object with all the properties in plain sight, right 
up until you save it into Riak.

If I misunderstood, I’m sorry.  If so, can you clarify what assumption was 
wrong?

Hopefully this helps a bit,
Jason

&gt; On 12 Dec 2014, at 22:30, J. Austin Hughey &lt;jaustinhug...@gmail.com&gt; wrote:
&gt; 
&gt;  
&gt; Hi,
&gt; 
&gt; I’m fairly new to Riak, and I haven’t seen a clear answer to this question 
&gt; through Google, so I’m going to ask the list here.  
&gt; 
&gt; Do I need to sanitize user input BEFORE sending to the Riak client, or does 
&gt; the client handle sanitization? (I plan to use the Ruby client, but I may 
&gt; want to use a different language client later on too depending on the 
&gt; project.)
&gt; 
&gt; I can see the potential for injection here being a real issue:  
&gt; 
&gt; {  
&gt; “username”:”bob”,
&gt; “password_hash”:”abc123xyz\””,”admin”:”true&quot;
&gt; }
&gt; 
&gt; …or something like that. You get the idea. I’m just trying to get it right 
&gt; before I start building something that’s just begging to get owned.
&gt; 
&gt; Thanks.
&gt; 
&gt; --  
&gt; J. Austin Hughey
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15356.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#15358">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#15358">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15359.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg15356.html">Do developers need to sanitize JSON input before sending...</a></span> <span class="sender italic">J. Austin Hughey</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Do developers need to sanitize JSON input befor...</span> <span class="sender italic">Jason Campbell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15359.html">Re: Do developers need to sanitize JSON input b...</a></span> <span class="sender italic">J. Austin Hughey</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15360.html">Re: Do developers need to sanitize JSON inp...</a></span> <span class="sender italic">Kyle Marek-Spartz</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15363.html">Re: Do developers need to sanitize JSON...</a></span> <span class="sender italic">Jason Campbell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15364.html">Re: Do developers need to sanitize...</a></span> <span class="sender italic">J. Austin Hughey</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Do developers need to sanitize JSON input before sending to Riak	Client?">
<input type="hidden" name="msgid" value="8B53510E-7266-4025-8D2D-9D86154B8E93@xiaclo.net">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15358.html">
<input type="submit" value=" Jason Campbell ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Do+developers+need+to+sanitize+JSON+input+before+sending+to+Riak%09Client%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15356.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15359.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">8B53510E-7266-4025-8D2D-9D86154B8E93@xiaclo.net</li>
</ul>
</div>
</body>
</html>
