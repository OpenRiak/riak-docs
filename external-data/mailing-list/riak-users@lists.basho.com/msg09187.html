<!DOCTYPE html>
<html lang="en">
<head>
<title>modelling social network/dating</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09187" id="c">
<link rel="index" href="maillist.html#09187" id="i">
<link rel="prev" href="msg09182.html" id="p">
<link rel="next" href="msg09188.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09187.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22modelling+social+network%5C%2Fdating%22&amp;o=newest" rel="nofollow"><span itemprop="name">modelling social network/dating</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Mark+Steele%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Mark Steele</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121103" rel="nofollow">Sat, 03 Nov 2012 21:55:07 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi all,

I'm sure someone else has done this so I figure I'd try to see if anyone
wants to share.</pre><pre>

I'm creating a social networking type of site which has some pretty big
scaling/feature requirements and would like to evaluate Riak as a candidate
for use as a storage engine.

For scale, I'm looking at

   - 50 million users
   - 500,000 users online at any given time (1 million unique visitors/day)
   - hundreds of millions of events (messages, likes, pictures, etc...)

Features

   - Friends
   - Comments
   - Likes (pictures, videos, various profile entities)
   - Pictures
   - Videos
   - Suggested matches
   - More like this
   - Lots of searching options
   - Messaging
   - etc...

Pseudo off-the-cuff naive model to get discussion going:

Profiles
Key: userid
Value: { handle: 'hammer', tagline: {content: 'please hammer dont hurt em',
likes: [{timestamp: 123123123, userid: 213123}, ...], comments: [timestamp:
123123123, userid: 213123, message: 'blabbity blah', ...]}, age: 36,
latitude: 42.2, longitude: 57.3, geohash: ezs42, ... }

Pics
Key: pictureid
Value: { userid: 12323, visibility: 'private', allowed: [121314, 322342,
1241241], likes:  [{timestamp: 123123123, userid: 213123},
...] , {comments:  [{timestamp: 123123123, userid: 213123, comment: 'rad
pic d00d'}, ...]}

Friends
Key: friendshipid
Value: {from: 123123, to: 5243, timestamp: 252151, status: 'pending',
last_updated: 232342}

MessageThreads
Key: messageid
Value: {to: 12321, from: 5212, content: 'yeah!', status: 'read', replies:
[{from: 12321, timestamp: 1412, content: 'asdf lorem ipsom', status:
'unread'}, ...]}

Timeline
Key: eventid
Value: {to: 12412, from: 5212, eventtype: 'friend request', timestamp:
124112}

Sample queries:
Get all picture metadata for userid 12142
Get all unread messages for user 5212
Get all messages to user 5212 from user 12312
Who are user 2521's friends?
New users since date X aged less than Y &lt;possibly lots of ANDs here&gt;

--

I'm open to suggestions here on pretty much everything (model, Riak
suitability/functionality, conflict resolution strategy, geo search
possibilities, etc...)

I'm thinking that all generated ids should use something like snowflake to
get rough time ordering capabilities on keys (and possibly be able to
exploit this for key-filters).

Anyone have suggestions or recommendations? War stories? I've looked at the
Kiip/Voxer/Clipboard presentations and I'm wondering what the current state
of Riak is. Should I start thinking about implementing the tracking of
indices myself with all the ugliness that entails?

Also, I'm not opposed to running an ElasticSearch cluster if Search/2i
doesn't fit the bill, however the more functionality I can get from one
system the better (less chances of indices getting out of sync, etc...)

We're obviously going to be done all the usual scaling techniques as part
of this system (edge side includes with varnish, application caching,
etc...) however I do expect a pretty big cluster to emerge from this.

Cheers

Mark
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09182.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09187">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09187">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09188.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">

</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="modelling social network/dating">
<input type="hidden" name="msgid" value="CAB5=j_ohdRnkZG1Lc5mA77DOiRtPYM=Z_vt+CUbN7Bu_+18Cmg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09187.html">
<input type="submit" value=" Mark Steele ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22modelling+social+network%5C%2Fdating%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09182.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09188.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAB5=j_ohdRnkZG1Lc5mA77DOiRtPYM=Z_vt+CUbN7Bu_+18Cmg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
