<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: [ANN] Kria 0.1.14, an async Clojure Client for Riak 2.0.0.rc1</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#14549" id="c">
<link rel="index" href="mail2.html#14549" id="i">
<link rel="prev" href="msg14541.html" id="p">
<link rel="next" href="msg14869.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg14549.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+%5C%5BANN%5C%5D+Kria+0.1.14%2C+an+async+Clojure+Client+for+Riak+2.0.0.rc1%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: [ANN] Kria 0.1.14, an async Clojure Client for Riak 2.0.0.rc1</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22David+James%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">David James</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140724" rel="nofollow">Thu, 24 Jul 2014 12:50:22 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Thanks for the feedback!

I'll take a look at the Maven Central .proto files.</pre><pre>

I started Kria before the new Java client was very far along. I'm glad it
now supports async operation. I'll try to take a look. I have had mixed
experiences in wrapping Java libraries. I found many hard to understand
because of their size and complexity.

Kria supports the Riak Protocol API and is meant to be low-level. It does
not support the &quot;Additional features&quot; mentioned on
<a  rel="nofollow" href="http://docs.basho.com/riak/2.0.0/dev/using/libraries/">http://docs.basho.com/riak/2.0.0/dev/using/libraries/</a>. It only has three
dependencies: Java 7 (for NIO.2), Clojure 1.6, and Protocol Buffers. I
intentionally avoided Netty because I didn't need the complexity. Kria does
this in about 2,000 lines of Clojure: 1400 lines of implementation plus
about 600 lines of tests. The Java library has about 20,000 lines of code.
I spent considerable time driving out duplication, and I'd like to think it
makes the code easier to read and more reliable.

Lastly, writing Kria helped me find some strange (e.g. probably
unintentional) re-use of message codes in Riak:
<a  rel="nofollow" href="https://github.com/basho/riak-java-client/issues/367">https://github.com/basho/riak-java-client/issues/367</a>


On Wed, Jul 23, 2014 at 2:59 PM, Sean Cribbs &lt;s...@basho.com&gt; wrote:

&gt; David,
&gt;
&gt; Thanks for contributing to the Riak ecosystem! A few notes:
&gt;
&gt; Looking over your README, I see you're probably doing some unnecessary
&gt; work with respect to the .proto files [1]. We generate, package, and deploy
&gt; all of those on Maven Central [2] specifically so others can use them as
&gt; you have, while maintaining the authenticity of the code (it comes from us)
&gt; and reducing duplication (not N copies everywhere).
&gt;
&gt; I don't want to bikeshed it (you obviously have your reasons), but it
&gt; bears mentioning that the new official Java client is designed so that it
&gt; would be easier to write wrapper libraries in other JVM languages, and to
&gt; give the user the option of async or sync at the API level.
&gt;
&gt; [1] <a  rel="nofollow" href="https://github.com/bluemont/kria#protocol-buffer-setup">https://github.com/bluemont/kria#protocol-buffer-setup</a>
&gt; [2] <a  rel="nofollow" href="https://search.maven.org/#search%7Cga%7C1%7Ca%3A%22riak-pb%22">https://search.maven.org/#search%7Cga%7C1%7Ca%3A%22riak-pb%22</a>
&gt;
&gt;
&gt; On Wed, Jul 23, 2014 at 1:31 PM, David James &lt;davidcja...@gmail.com&gt;
&gt; wrote:
&gt;
&gt;&gt; The latest version of Kria, 0.1.14, supports Riak 2.0.0rc1. Kria (a right
&gt;&gt; rotation of &quot;Riak&quot;) is an open source asynchronous Clojure driver for Riak
&gt;&gt; 2.0 built on top of Java 7's NIO.2. It uses the Riak protocol buffer
&gt;&gt; interface.
&gt;&gt;
&gt;&gt; <a  rel="nofollow" href="https://github.com/bluemont/kria">https://github.com/bluemont/kria</a>
&gt;&gt; <a  rel="nofollow" href="https://clojars.org/kria">https://clojars.org/kria</a>
&gt;&gt;
&gt;&gt; There are, of course, several Riak drivers for Java and Clojure. I hope
&gt;&gt; some people find this one useful. I have a section in the README about why
&gt;&gt; I made it. To summarize, I wanted async support, and the Java driver wasn't
&gt;&gt; quite what I wanted.
&gt;&gt;
&gt;&gt; Please kick the tires.
&gt;&gt;
&gt;&gt; In my work projects, Clojure's core.async works great as a layer on top
&gt;&gt; of Kria. Just create a core.async channel in advance and have the callback
&gt;&gt; put the desired return value in the core.async channel. (You could also use
&gt;&gt; Clojure atoms or promises; Kria doesn't care.)
&gt;&gt;
&gt;&gt; -David
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; <a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg14541.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#14549">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#14549">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg14869.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg14540.html">[ANN] Kria 0.1.14, an async Clojure Client for Riak 2.0.0.rc1</a></span> <span class="sender italic">David James</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14541.html">Re: [ANN] Kria 0.1.14, an async Clojure Client for Riak 2...</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: [ANN] Kria 0.1.14, an async Clojure Client for Ri...</span> <span class="sender italic">David James</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14869.html">Re: [ANN] Kria 0.1.14, an async Clojure Client fo...</a></span> <span class="sender italic">David James</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: [ANN] Kria 0.1.14, an async Clojure Client for Riak 2.0.0.rc1">
<input type="hidden" name="msgid" value="CAD5b4h0qTko0mxkVwq61sjotMkH5HwWP7dqK=8Sw5HHAiFNxBg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg14549.html">
<input type="submit" value=" David James ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+%5C%5BANN%5C%5D+Kria+0.1.14%2C+an+async+Clojure+Client+for+Riak+2.0.0.rc1%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg14541.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg14869.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAD5b4h0qTko0mxkVwq61sjotMkH5HwWP7dqK=8Sw5HHAiFNxBg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
