<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Upgrade path 1.4.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd14.html#11448" id="c">
<link rel="index" href="mail14.html#11448" id="i">
<link rel="prev" href="msg11447.html" id="p">
<link rel="next" href="msg11449.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg11448.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Upgrade+path+1.4.0%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Upgrade path 1.4.0</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Guido+Medina%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Guido Medina</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130710" rel="nofollow">Wed, 10 Jul 2013 04:41:32 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Toby,

</pre><tt>I'm sure someone from Basho will answer soon, I just pointed you to the 
</tt><tt>&quot;release notes&quot; direction. I have only overlooked the release notes 
</tt><tt>until we decide to migrate to 1.4.0 when is final (Right now on rc1)
</tt><pre style="margin: 0em;"></pre><pre>

HTH,

Guido.

On 10/07/13 12:29, Toby Corkindale wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Thanks Guido.

Looks like we've upgraded to 1.4.0 completely now and the cluster is back up.

I'm not sure of the exact root cause, but what we were seeing was that too many 
nodes went down for the ring to be healthy, and then when nodes were restarted 
they waited for the ring to appear for a while, and then exited (or crashed) 
automatically.

I *think* this is because after the package was upgraded, the Riak service 
didn't restart after the upgrade -- and our automated system to catch that and 
restart them wasn't kicking in quickly enough compared to the rate at which the 
servers were being upgraded.

You mention in the release notes that the init scripts have been adjusted - 
maybe that has something to do with it?

Cheers,
Toby

----- Original Message -----
From: &quot;Guido Medina&quot; &lt;guido.med...@temetra.com&gt;
To: &quot;riak-users&quot; &lt;riak-users@lists.basho.com&gt;
Sent: Wednesday, 10 July, 2013 9:05:16 PM
Subject: Re: Upgrade path 1.4.0

Release notes: <a  rel="nofollow" href="https://github.com/basho/riak/blob/1.4/RELEASE-NOTES.md">https://github.com/basho/riak/blob/1.4/RELEASE-NOTES.md</a>

Maybe related to this?
Known Issues
leveldb 1.3 to 1.4 conversion


The first execution of 1.4.0 leveldb using a 1.3.x or 1.2.x dataset will initiate an automatic conversion that could pause the 
startup of each node by 3 to 7 minutes. The leveldb data in &quot;level #1&quot; is being adjusted such that &quot;level #1&quot; 
can operate as an overlapped data level instead of as a sorted data level. The conversion is simply the reduction of the number 
of files in &quot;level #1&quot; to being less than eight via normal compaction of data from &quot;level #1&quot; into 
&quot;level #2&quot;. This is a one time conversion.
HTH,

Guido.

On 10/07/13 11:57, Toby Corkindale wrote:



Hi,
some of our nodes upgraded to Riak 1.4.0, and are now refusing to start and 
join the cluster.
Is there documentation on the upgrade path from 1.3.2 to 1.4.0? It appears we 
have accidentally begun this journey, and I don't know if it's easier to go 
back or forwards now..

PS. It would have been pleasant to receive a warning about the new version on 
the mailing list!

Thanks,
Toby

_______________________________________________
riak-users mailing list riak-users@lists.basho.com 
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre></blockquote><pre style="margin: 0em;">


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg11447.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd14.html#11448">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail14.html#11448">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg11449.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg11442.html">Upgrade path 1.4.0</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg11445.html">Re: Upgrade path 1.4.0</a></span> <span class="sender italic">Guido Medina</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg11447.html">Re: Upgrade path 1.4.0</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Upgrade path 1.4.0</span> <span class="sender italic">Guido Medina</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg11449.html">Re: Upgrade path 1.4.0</a></span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg11452.html">Re: Upgrade path 1.4.0</a></span> <span class="sender italic">Jared Morrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg11468.html">Re: Upgrade path 1.4.0</a></span> <span class="sender italic">Toby Corkindale</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Upgrade path 1.4.0">
<input type="hidden" name="msgid" value="51DD47D6.5080207@temetra.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg11448.html">
<input type="submit" value=" Guido Medina ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Upgrade+path+1.4.0%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg11447.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg11449.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">51DD47D6.5080207@temetra.com</li>
</ul>
</div>
</body>
</html>
