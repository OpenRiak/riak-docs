<!DOCTYPE html>
<html lang="en">
<head>
<title>Freeing space used by deleted objects</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#18537" id="c">
<link rel="index" href="maillist.html#18537" id="i">
<link rel="prev" href="msg18529.html" id="p">
<link rel="next" href="msg18538.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg18537.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Freeing+space+used+by+deleted+objects%22&amp;o=newest" rel="nofollow"><span itemprop="name">Freeing space used by deleted objects</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Daniel+Miller%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Daniel Miller</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20180522" rel="nofollow">Tue, 22 May 2018 10:48:07 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi, we have a few Riak CS clusters where we had been storing (in addition
to permanent data) some temporary data that was intended to be deleted
after a period of time. It turned out that our deletion task was failing,
so the clusters grew much more quickly than anticipated, leading to the
eventual discovery of the failing deletion task. After repairing the
deletion task in mid-March, two of the clusters showed massive storage
usage reductions:</pre><pre>

Cluster 1
Peak storage use: 17.0TB (compressed)
Deleted objects: 11.4TB (uncompressed)
Eventual storage use: 10.1TB (compressed)

Cluster 2
Peak storage use: 1.1TB (compressed)
Deleted objects: 2.3TB (uncompressed)
Eventual storage use: 0.4TB (compressed)

Cluster 3
Peak storage use: 7.3TB (compressed)
Deleted objects: 5.6TB (uncompressed)
Eventual storage use: 7.2TB (compressed)

For clusters 1 and 2 there was a delay of a few days before storage usage
dropped off sharply over the course of about a week. However, on cluster 3
storage usage did not drop off much at all, certainly not enough to account
for the amount of space occupied by the deleted objects. Is there
documentation I can read to understand how garbage collection works in Riak
(CS)? I would like to answer the following:

What factors affect the lag after deleting objects until space is freed on
disk?
Is there any manual intervention I can make on Cluster 3 to trigger garbage
cleanup?

Thank you!
Daniel Miller
Dimagi, Inc.
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg18529.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#18537">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#18537">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg18538.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">

</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Freeing space used by deleted objects">
<input type="hidden" name="msgid" value="CADigEi7+1vnKGPGpWtpoiDrpGw9J8CJsa9MGOGh-n2reNZGROA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg18537.html">
<input type="submit" value=" Daniel Miller ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Freeing+space+used+by+deleted+objects%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg18529.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg18538.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CADigEi7+1vnKGPGpWtpoiDrpGw9J8CJsa9MGOGh-n2reNZGROA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
