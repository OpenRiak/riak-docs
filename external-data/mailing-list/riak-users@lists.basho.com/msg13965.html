<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: O(n) behavior on crdts</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#13965" id="c">
<link rel="index" href="mail2.html#13965" id="i">
<link rel="prev" href="msg13961.html" id="p">
<link rel="next" href="msg13966.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg13965.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+O%5C%28n%5C%29+behavior+on+crdts%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: O(n) behavior on crdts</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Russell+Brown%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Russell Brown</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140401" rel="nofollow">Tue, 01 Apr 2014 12:29:11 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hey James,

Massive respect to any mailing list response about performance that includes 
graphs, thanks!</pre><pre>

I plan to keep optimising right up until we release, so hopefully we can 
further improve the performance. From the look of your graphs there is work to 
be done.

Are these graphs for Set or Map additions, please?

Keep us posted with your testing/assessment, please.

Cheers

Russell


On 1 Apr 2014, at 20:18, James Moore &lt;james.mo...@tapjoy.com&gt; wrote:

&gt; Thanks Russell,
&gt; 
&gt; I'm mainly observing this issue around the add operation on hash's when 
&gt; running a similar operation as this guy
&gt; 
&gt; <a  rel="nofollow" href="https://gist.github.com/russelldb/d330d796ca1b25d1879d">https://gist.github.com/russelldb/d330d796ca1b25d1879d</a>
&gt; 
&gt; the behavior I was seeing show's up in the following graphs
&gt; 
&gt; the horizontal axis is the iteration of the add operation, and the y axis is 
&gt; milliseconds
&gt; 
&gt; &lt;image.png&gt;
&gt; &lt;image.png&gt;
&gt; 
&gt; From that chart it looks as though the fix in compression has resolved the 
&gt; issue :)  ( and also in hindsight the results don't quite look O(n) )
&gt; 
&gt; for larger add operations I'm still seeing a linear performance degradation, 
&gt; but add operations are still pretty quick through 10k operations
&gt; 
&gt; &lt;image.png&gt;
&gt; 
&gt; 
&gt; In answer to you're question on performance I believe the switch up to pre20 
&gt; should resolve the the poor add performance for us, and overall I've found it 
&gt; to be quite impressive so far.
&gt; 
&gt; --james
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; On Tue, Apr 1, 2014 at 2:21 AM, Russell Brown &lt;russell.br...@me.com&gt; wrote:
&gt; Hey James,
&gt; 
&gt; I haven’t analysed the complexity of the data types. Off hand I know that 
&gt; operations on Maps, Sets, Counters etc are not O(n). Merges sometimes will 
&gt; be, if every entry must be compared, and we’re looking at ways to optimise 
&gt; this. The `value` operation on Maps and Sets must be O(n) since we have to 
&gt; derive the correct value for each entry. I’m not sure how we would optimise 
&gt; that.
&gt; 
&gt; We’ve optimised the `context` for operations down to a single version vector 
&gt; (before it was a binary of the entire Map or Set), which should have got us 
&gt; some performance improvements.
&gt; 
&gt; Right now Sets and Maps still use orddict. We have a round of performance and 
&gt; scalability testing starting, and hopefully some optimisations will come out 
&gt; of that.
&gt; 
&gt; I think you’re referring to Sean’s porting of Elixir’s TreeMap to erlang. We 
&gt; have not yet tested that code, nor have we integrated it with riak_dt. I 
&gt; don’t know if anyone even plans to.
&gt; 
&gt; Have you observed poor performance from the data types? The earlier releases' 
&gt; main performance issue was to/from binary encoding. We since switched to 
&gt; erlangs built in t2b/b2t functions, with compression, and have found the 
&gt; performance to be acceptable.
&gt; 
&gt; I guess the short answer is: we’re working on it, but with 2.0 release 
&gt; looming up, we might not get all the way there in time.
&gt; 
&gt; There is some cost for using CRDTs, I don’t think it could be another way, 
&gt; there aren’t any free lunches. My aim is to reduce that cost below the pain 
&gt; barrier of siblings, and writing complex merge functions.
&gt; 
&gt; Cheers
&gt; 
&gt; Russell
&gt; 
&gt; On 31 Mar 2014, at 23:06, James Moore &lt;james.mo...@tapjoy.com&gt; wrote:
&gt; 
&gt; &gt; Hey All,
&gt; &gt;
&gt; &gt; has there been any progress on resolving the O(n) behavior of crdt sets and 
&gt; &gt; maps?
&gt; &gt;
&gt; &gt; Sean mentioned in a previous thread that there was a potential for a fix to 
&gt; &gt; resolve the poor performance of erlang's orddict.
&gt; &gt;
&gt; &gt; thanks!
&gt; &gt;
&gt; &gt; --James
&gt; &gt; _______________________________________________
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg13961.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#13965">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#13965">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg13966.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg13960.html">O(n) behavior on crdts</a></span> <span class="sender italic">James Moore</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13961.html">Re: O(n) behavior on crdts</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: O(n) behavior on crdts</span> <span class="sender italic">Russell Brown</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: O(n) behavior on crdts">
<input type="hidden" name="msgid" value="358D71F2-47BE-4BEF-A683-BAD3A814BCB1@me.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg13965.html">
<input type="submit" value=" Russell Brown ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+O%5C%28n%5C%29+behavior+on+crdts%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg13961.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg13966.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">358D71F2-47BE-4BEF-A683-BAD3A814BCB1@me.com</li>
</ul>
</div>
</body>
</html>
