<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak disk usage</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd6.html#13134" id="c">
<link rel="index" href="mail6.html#13134" id="i">
<link rel="prev" href="msg13131.html" id="p">
<link rel="next" href="msg13118.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg13134.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+disk+usage%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak disk usage</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Hector+Castro%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Hector Castro</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131202" rel="nofollow">Mon, 02 Dec 2013 08:10:26 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Stefan,

The Riak 2.0 technical preview hasn't been heavily tested with Riak CS
because it isn't a stable release. The best combination of Riak and
Riak CS to run right now is Riak 1.4.2 and Riak CS 1.4.3.</pre><pre>

Below are a few settings you can tweak to reclaim disk space more
aggressively in Riak CS:

- `leeway_seconds` – Number of seconds before an object is garbage
collected (might want to start with 3600)
- `gc_interval` – Ensure that all nodes in your cluster *but one* are
set to `infinity` (disables GC on all nodes but one to reduce
redundant work)
- `delete_concurrency` – Number of blocks to delete concurrently

You may want to add another node to your cluster before making any of
these changes so that disk utilization on the existing nodes in your
cluster goes down.

--
Hector


On Sat, Nov 30, 2013 at 6:19 PM, Silasi Stefan &lt;silasiste...@gmail.com&gt; wrote:
&gt; Thanks for your reply Hector.
&gt; I'm using the simple python/boto script for upload via the
&gt; key.set_content_from_file method. Each object has an unique key name.
&gt;
&gt; Today, 2 of the nodes are at 100% disk usage after I tried to remove one of
&gt; them via &quot;riak-admin cluster remove riak@node&quot;.
&gt; I upgraded to the technical preview version 2.0... so far, it didn't help.
&gt;
&gt; Thank you,
&gt; Stefan.
&gt;
&gt;
&gt; On Sat, Nov 30, 2013 at 8:27 PM, Hector Castro &lt;hec...@basho.com&gt; wrote:
&gt;&gt;
&gt;&gt; Hello Silasi,
&gt;&gt;
&gt;&gt; Can you please explain the process you're using to add the image/video
&gt;&gt; data into Riak CS? Are you overwriting objects or using multipart
&gt;&gt; upload?
&gt;&gt;
&gt;&gt; --
&gt;&gt; Hector
&gt;&gt;
&gt;&gt;
&gt;&gt; On Thu, Nov 28, 2013 at 5:33 AM, Silasi Stefan &lt;silasiste...@gmail.com&gt;
&gt;&gt; wrote:
&gt;&gt; &gt; Hello,
&gt;&gt; &gt;
&gt;&gt; &gt; I'm preparing an evironment for an image/video storage website, with
&gt;&gt; &gt; riak-cs
&gt;&gt; &gt; on top of riak cluster.
&gt;&gt; &gt; I have 5 servers with a 900gb disk each and about 700gb of images/videos
&gt;&gt; &gt; collected, mainly images.
&gt;&gt; &gt;
&gt;&gt; &gt; I have a little over 300,000 objects in total, all stored in one place
&gt;&gt; &gt; occupying a little over 700gb data. Based on the formula: 700gb x 3
&gt;&gt; &gt; replication factor, I was expecting to use around 2.1-2.2 TB data.
&gt;&gt; &gt;
&gt;&gt; &gt; After uploading half of the 700gb data (350gb x 3 = 1,05TB), I notice
&gt;&gt; &gt; the
&gt;&gt; &gt; disk usage is around 70% already on all nodes (640gb x 5 = ~3.2TB). The
&gt;&gt; &gt; nodes are dedicated to riak/riak-cs.
&gt;&gt; &gt;
&gt;&gt; &gt; Am I missing something?
&gt;&gt; &gt;
&gt;&gt; &gt; Thank you,
&gt;&gt; &gt; Stefan.
&gt;&gt; &gt;
&gt;&gt; &gt; _______________________________________________
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt; &gt;
&gt;
&gt;

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg13131.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd6.html#13134">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail6.html#13134">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg13118.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg13117.html">Riak disk usage</a></span> <span class="sender italic">Silasi Stefan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13120.html">riak disk usage</a></span> <span class="sender italic">Silasi Stefan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13130.html">Re: riak disk usage</a></span> <span class="sender italic">Hector Castro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13131.html">Re: riak disk usage</a></span> <span class="sender italic">Silasi Stefan</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak disk usage</span> <span class="sender italic">Hector Castro</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak disk usage">
<input type="hidden" name="msgid" value="CAAuGPqqa8CLG7DRJ7W86j5BGALErzDaKehvsjBhVzCrg42yVzA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg13134.html">
<input type="submit" value=" Hector Castro ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+disk+usage%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg13131.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg13118.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAAuGPqqa8CLG7DRJ7W86j5BGALErzDaKehvsjBhVzCrg42yVzA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
