<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Changing Bitcask Expiry Policy</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#18298" id="c">
<link rel="index" href="maillist.html#18298" id="i">
<link rel="prev" href="msg18297.html" id="p">
<link rel="next" href="msg18305.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg18298.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Changing+Bitcask+Expiry+Policy%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Changing Bitcask Expiry Policy</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Martin+Sumner%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Martin Sumner</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20170627" rel="nofollow">Tue, 27 Jun 2017 09:56:52 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Felipe,

I've not played around with this myself.  However, after a brief look at
the bitcask code, it looks like a timestamp is given to each object as it
is written to bitcask - to represent the time it was written, not the time
it will expire.  The expiry_time is part of the state of the bitcask
process passed on startup, and is not looked at during the PUT flow.</pre><pre>

Bitcask checks to see if an object is expired when it is read (and also
when merging files), by comparing the write_time timestamp with the current
time (less the expiry time in seconds) - and the object is then deleted as
part of the GET operation.  So if the expiry time is disabled, these reads
will be forever valid once bitcask has that new state, as no knowledge of
the old expiry time is retained in the store. I don't think the object
itself has any sense of when it will expire, so I would expect that in your
case your data will be preserved.

I would recommend testing this before relying on my quick read through.

Regards

Martin

Hi,

any hint on this question?

Felipe Esteves

Tecnologia
felipe.esteves at b2wdigital.com
&lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;
&lt;seu.email at b2wdigital.com
&lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;&gt;

Tel.: (21) 3504-7162 ramal 57162

Skype: felipe2esteves

2017-06-21 16:35 GMT-03:00 Felipe Esteves &lt;felipe.esteves at
b2wdigital.com 
&lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;&gt;:

&gt;* Hi,
*&gt;&gt;* If I have a Riak cluster with bitcask expiry turned on, let's say, 14
*&gt;* days, and then change it to *bitcask.expiry=off* before any expiration
*&gt;* occurs, all my data will be preserved? Or all data prior to the parameter
*&gt;* change could still expiries based on the previous deadline?
*&gt;&gt;* Riak is version 2.2.3
*&gt;&gt;* thanks,
*&gt;&gt;* Felipe Esteves
*&gt;&gt;* Tecnologia
*&gt;&gt;* felipe.esteves at b2wdigital.com
&lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;
&lt;seu.email at b2wdigital.com
&lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;&gt;
*&gt;&gt;&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg18297.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#18298">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#18298">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg18305.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg18271.html">Changing Bitcask Expiry Policy</a></span> <span class="sender italic">Felipe Esteves</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg18297.html">Re: Changing Bitcask Expiry Policy</a></span> <span class="sender italic">Felipe Esteves</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Changing Bitcask Expiry Policy</span> <span class="sender italic">Martin Sumner</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg18305.html">Re: Changing Bitcask Expiry Policy</a></span> <span class="sender italic">Felipe Esteves</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Changing Bitcask Expiry Policy">
<input type="hidden" name="msgid" value="CANzjUxAaPS_arMrHKYwGmvQM-rox_ZdVLgVhCnpgPJJRh7AM7w@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg18298.html">
<input type="submit" value=" Martin Sumner ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Changing+Bitcask+Expiry+Policy%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg18297.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg18305.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CANzjUxAaPS_arMrHKYwGmvQM-rox_ZdVLgVhCnpgPJJRh7AM7w@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
