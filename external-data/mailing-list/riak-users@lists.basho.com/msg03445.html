<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Issues with capacity planning pages on wiki</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#03445" id="c">
<link rel="index" href="maillist.html#03445" id="i">
<link rel="prev" href="msg03411.html" id="p">
<link rel="next" href="msg03399.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03445.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Issues+with+capacity+planning+pages+on+wiki%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Issues with capacity planning pages on wiki</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Anthony+Molinaro%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Anthony Molinaro</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110526" rel="nofollow">Thu, 26 May 2011 15:43:09 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>
Hi Justin,

   Thanks for the reply.  Good to know you may have some partial
solutions for the sizings of items.  Out use case may long term
require us to write out own backend just for space efficiency, but
I'm hoping we can make it quite far with bitcask.  I've got enough on
my plate at the moment so am unlikely to get to this before you guys
do, but as I recently forked riak_kv for something else, you never
know.</pre><pre>

Thanks

-Anthony

On Wed, May 25, 2011 at 08:10:29PM -0400, Justin Sheehy wrote:
&gt; Hi, Anthony.
&gt; 
&gt; There are really three different things below:
&gt; 
&gt; 1- reducing the minimum overhead of the {Bucket, Key} encoding when
&gt; riak is storing into bitcask
&gt; 
&gt; 2- reducing the size of the vector clock encoding
&gt; 
&gt; 3- reducing the size of the overall riak_object structure and metadata
&gt; 
&gt; All three of these are worth doing.  The reason they are the way they
&gt; are now is that the initial assumptions for most Riak deployments was
&gt; of a high enough mean object size that these few bytes per object
&gt; would proportionally be small noise -- but that's just history and not
&gt; a reason to avoid improvements.
&gt; 
&gt; In fact, preliminary work has been done on all three of these.  It
&gt; just hasn't yet been such a high priority that it got pushed through
&gt; to the finish.  One tricky part with all three is backward
&gt; compatibility, as most production Riak clusters do not expect to need
&gt; a full stop every time we want to make an improvement like these.
&gt; 
&gt; Solving #1, by the way, isn't really in bitcask itself but rather in
&gt; riak_kv_bitcask_backend.  I can take a swing at that (with backward
&gt; compatibility) shortly.  I might also be able to help dig up some of
&gt; the old work on #2 that is nearly a year old, and I think Andy Gross
&gt; may have done some of what's needed for #3.
&gt; 
&gt; With less words: I agree, all this should be made smaller.
&gt; 
&gt; And don't let this stop you if you want to jump ahead and give some of it a 
&gt; try!
&gt; 
&gt; -Justin
&gt; 
&gt; 
&gt; 
&gt; On Wed, May 25, 2011 at 1:50 PM, Anthony Molinaro
&gt; &lt;antho...@alumni.caltech.edu&gt; wrote:
&gt; 
&gt; &gt; Anyway, things make a lot more sense now, and I'm thinking I may need
&gt; &gt; to fork bitcask and get rid of some of that extra overhead.  For instance
&gt; &gt; 13 bytes of overhead to store a tuple of binaries seems unnecessary, it's
&gt; &gt; probably better to just have a single binary with the bucket size as a
&gt; &gt; prefix, so something like
&gt; &gt;
&gt; &gt; &lt;&lt;BucketSize:16,Bucket,Key&gt;&gt;
&gt; &gt;
&gt; &gt; That way you turn 13 bytes of overhead to 2.
&gt; &gt;
&gt; &gt; Of course I'd need some way to work with old data, but a one time migration
&gt; &gt; shouldn't be too bad.
&gt; &gt;
&gt; &gt; It also seems like there should be some way to trim down some of that on
&gt; &gt; disk usage.  I mean 300+ bytes to store 36 bytes is a lot.

-- 
------------------------------------------------------------------------
Anthony Molinaro                           &lt;antho...@alumni.caltech.edu&gt;

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03411.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#03445">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#03445">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03399.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03392.html">Re: Issues with capacity planning pages on wiki</a></span> <span class="sender italic">David Smith</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03393.html">Re: Issues with capacity planning pages on wiki</a></span> <span class="sender italic">Anthony Molinaro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03394.html">Re: Issues with capacity planning pages on wiki</a></span> <span class="sender italic">Anthony Molinaro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03398.html">Re: Issues with capacity planning pages on ...</a></span> <span class="sender italic">Anthony Molinaro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03402.html">Re: Issues with capacity planning pages...</a></span> <span class="sender italic">Nico Meyer</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03403.html">Re: Issues with capacity planning ...</a></span> <span class="sender italic">Jonathan Langevin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03404.html">Re: Issues with capacity plann...</a></span> <span class="sender italic">Nico Meyer</span></li>
<li class="icons-email"><span class="subject"><a href="msg03405.html">Re: Issues with capacity plann...</a></span> <span class="sender italic">Mark Phillips</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg03406.html">Re: Issues with capacity planning ...</a></span> <span class="sender italic">Anthony Molinaro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03411.html">Re: Issues with capacity plann...</a></span> <span class="sender italic">Justin Sheehy</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Issues with capacity plann...</span> <span class="sender italic">Anthony Molinaro</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Issues with capacity planning pages on wiki">
<input type="hidden" name="msgid" value="20110526224250.GB77948@alumni.caltech.edu">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03445.html">
<input type="submit" value=" Anthony Molinaro ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Issues+with+capacity+planning+pages+on+wiki%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03411.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03399.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">20110526224250.GB77948@alumni.caltech.edu</li>
</ul>
</div>
</body>
</html>
