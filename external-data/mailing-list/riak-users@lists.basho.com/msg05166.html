<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Timeout in precommit hook</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd10.html#05166" id="c">
<link rel="index" href="mail11.html#05166" id="i">
<link rel="prev" href="msg05165.html" id="p">
<link rel="next" href="msg05160.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05166.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Timeout+in+precommit+hook%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Timeout in precommit hook</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Hal+Eisen%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Hal Eisen</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111014" rel="nofollow">Fri, 14 Oct 2011 14:30:03 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Alright, thanks for checking that out.

It is possible that some of my data is not UTF-8.  I will scan and see
if that is the case.</pre><pre>

How large can an object be before it starts to become a problem?  Most
of my inputs to the precommit hook should be on the order of 5 KB, and
the outputs are maybe 20% larger than the inputs.

My error.log has this message repeated many times:

    2011-10-12 19:14:28.675 [error] 
&lt;0.4667.1&gt;@riak_kv_put_fsm:decode_precommit:645 Error executing pre-commit 
hook: timeout

My erlang.log looks ver similar:

    12:07:00.074 [error] Error executing pre-commit hook: timeout

And the console.log follows suit:

    2011-10-12 19:14:54.081 [error] 
&lt;0.4688.1&gt;@riak_kv_put_fsm:decode_precommit:645 Error executing pre-commit 
hook: timeout

Is there a dial for controlling how long Riak waits before declaring a
timeout?

Is there a way to increase the verbosity in the logs?

My clients are all using HTTP API, so they hang for a while on each
timeout.  Then they collect an HTTP error and move on to the next
ke/value pair.  The HTTP error is &quot;500 read timeout&quot;.  This makes me
think that not only is the JS VM timeout occuring in the precommit
hook, but that Riak itself is not catching that error condition and
properly closing the HTTP transaction.

Hal

On Fri, Oct 14, 2011 at 05:03:57PM -0400, Sean Cribbs wrote:
&gt; This is good. What we are NOT seeing is the contents of the metadata
&gt; changing while going to-and-from your precommit hook.  I think you need to
&gt; be concerned about a few issues when using JS precommit hooks:
&gt; 
&gt; 1) Your data must never contain a character that is not encoded in UTF-8.
&gt; Yours looks like ASCII/Latin-1 so that should be fine.
&gt; 2) Large objects will take a while to transfer to and from the JS VM because
&gt; it has to be marshalled in each direction, which could be the source of a
&gt; timeout.
&gt; 
&gt; Those things said, it would be good to get more information on what the
&gt; exact error was as reported by Riak. Do you have riak logs or transcripts of
&gt; client sessions?
&gt; 
&gt; Thanks,
&gt; 
&gt; Sean
&gt; 
&gt; On Fri, Oct 14, 2011 at 4:08 PM, Hal Eisen &lt;ei...@dunhackin.org&gt; wrote:
&gt; 
&gt; &gt; Ah!  Much better - thank you!
&gt; &gt;
&gt; &gt; Attaching to /var/run/riak/erlang.pipe.2 (^D to exit)
&gt; &gt;
&gt; &gt; {ok, C} = riak:local_client().
&gt; &gt; {ok,{riak_client,'riak@127.0.0.1',undefined}}
&gt; &gt; (riak@127.0.0.1)4&gt; rp(C:get(&lt;&lt;&quot;test-with&quot;&gt;&gt;,&lt;&lt;&quot;x000071257&quot;&gt;&gt;)).
&gt; &gt; {ok,{r_object,&lt;&lt;&quot;test-with&quot;&gt;&gt;,&lt;&lt;&quot;x000071257&quot;&gt;&gt;,
&gt; &gt;              [{r_content,{dict,6,16,16,8,80,48,
&gt; &gt;
&gt; &gt;  {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
&gt; &gt;                                {{[],[],
&gt; &gt;                                  [[&lt;&lt;&quot;Links&quot;&gt;&gt;]],
&gt; &gt;                                  [],[],[],[],[],[],[],
&gt; &gt;
&gt; &gt;  [[&lt;&lt;&quot;X-Riak-VTag&quot;&gt;&gt;,99,70,100,97,67,116,100,97,57,84,66,121,
&gt; &gt;                                    54,81,66,74,76,66,85,69,80],
&gt; &gt;
&gt; &gt; [&lt;&lt;&quot;content-type&quot;&gt;&gt;,116,101,120,116,47,112,108,97,105,110]],
&gt; &gt;                                  [[&lt;&lt;&quot;index&quot;&gt;&gt;]],
&gt; &gt;                                  [],
&gt; &gt;
&gt; &gt;  [[&lt;&lt;&quot;X-Riak-Last-Modified&quot;&gt;&gt;|{1318,620010,543066}]],
&gt; &gt;                                  [],
&gt; &gt;                                  [[&lt;&lt;&quot;X-Riak-Meta&quot;&gt;&gt;]]}}},
&gt; &gt;                          &lt;&lt;&quot;z80ghJXVZe9m59/5+Ydk2g xMpCOKC5I4INzFCab3WEmw
&gt; &gt; yB5yjZ1ML2NvBn+JzBSGLA 7MvIfktc4v4oMI/Z8qe68w qH/2eaLz5x2RgaZ7dUISLA
&gt; &gt; 5No7f7vOI0XXdysGdKMY1Q FnkJHFqID69vteYIfrGy3A jxTkX87qFnpaNt7dS+olQw
&gt; &gt; yfD4lfuYq5FZ9R/QKX4jbQ RcSMzi4tf73qGvxRx8atJg 09lEaAKkQll1XTjm0WPoIA
&gt; &gt; ZRK9Q9nKpuAsmQsKgmUtyg wgrU12/pd1mqJ6DJm/9nEA xRzkEMEkoQ4NteS5f8KvOQ
&gt; &gt; qrMjiSK8wlpvYG61Jf/cVg m/Mcf/Bik2qW08i9H48v8w x02XsB6uJX5Eqp1brel7rw
&gt; &gt; cO/fLsmwhgeXlcRCY2tV+w b0ki9FVoFhqM30rSKZ9tIw Hw49rZmQg0X3Q5+P+r3/xA
&gt; &gt; mPE3CCEBlMR1aHvmEGo7hA PFncBI6IUCQ76AeaXHTQeQ ttdn0vjtXSGkSw5YhmgMuQ
&gt; &gt; N2k8/HSASeRdh7jH2LmqzQ H/Hed0AF+NoT9ClDiBxlXw jilqBno3VjNw3tBfWjvz7A
&gt; &gt; TnMs7TRj0G3gypoVthU2dw AudPEOAyetho0TjytP3W8A M+df8J3WAbvmnzUQORUhiQ
&gt; &gt; bqmrG6oO+54ZCURAwxfiGw NBc8s48H+J3b68KskSgwPw wWpTIPpHVTDZWDw0/TVu9Q
&gt; &gt; Y2TT8PSVtqudz407XG4LAQ GCvgxc3NUHK7GGTN7k09bg 42mFPfdm+kTh7Q/2E/VjvQ
&gt; &gt; HDg80wt8KYq1ApOt/st7GA GcoU5+pjKKQuDrE9WF5MIg pb/J4Hlk+N3euV/FhM2WXQ
&gt; &gt; pXcbzpPiAMNvfNnf0OXeqg 1n2KtPTBC/Iqo1PieHkTPA 1kWSDjlf7a17u+0Oyj/i4A
&gt; &gt; NBanX0zqkQlQfKzY4vKu/A odDG6D8CcyfYRhBj9KxYpg F+YhZvyFht+k0bwOF0LAiw
&gt; &gt; 9xdxY8gz3/Szj8jShy8exg bINJzHJgrmLjsTloMag5jw 2dT0leh1ouB1oaSm4bl3Dw
&gt; &gt; Z8ah585W09b6dIq22a8/1w ZC6S77eUIXNIgbU+HhsYtg 9FfFRane2I8Y7O5HFFpywA
&gt; &gt; wMfHbTC9PcrvyW9AJ1vcCg KDgCOneN+uzcIScI9yG3iA mhFYFU36QsrdvQaUpOm9yA
&gt; &gt; 2CyNFhmtgXbWZUU8+y5V8A poTs7udvxSJ3MoaolbyENg tTs6PWq5DOAmgikVHJveEQ
&gt; &gt; n2FAjjr7Yz5QzfGyDeb0Zg crMqH3VLocCbNpXgy2zefw ZvBB4WpgkosFp+IoqJw3mQ
&gt; &gt; CT9l4ICilfgHaxxXIqRqog BysDC6EmsvSyN080K+ntRA fzn4MX+9sZiO9MYo66AlkQ
&gt; &gt; RPaDqEFjs1I6/lfC4Ai8jA A6/b1m55KbEl+Fl4NPqDpA 6l0vHEYIIy4H06o9mY5RNQ
&gt; &gt; /EkMpFwAsSSbvjVUpP32+w MpXHasv0yq7TPDaxtfwssQ c1uQtFaBJe1sP2eIGbbgWA
&gt; &gt; o/OQ2I5MQfJ0e/ovG1+H2w FL+muxSHXkW7oCiiHtOARg fLvECeyZDxnHjHW9HgbyFQ
&gt; &gt; 4sQg2SjUv4zg/y7BmzcVFA MruQ6Jdqq1KY1doQ/mbyHQ 0t3qGPAGZc6GI+Nr1OPHxQ
&gt; &gt; rWGrFDIj77wkx9JYO+aSUQ 0Jv0FUSjNlpGyQd+u141ww +9eTnWdJl820aS003oYzxA
&gt; &gt; KN0seVXOkmRWJAsv8BAL3g NfSo1GXm4e3AXz2KtljFUQ 0f4XPQjpWTl63zSx136I1w
&gt; &gt; 8DOrN8MCAfc/FCRJ0DcCjQ Q+xRfWi27dMBWz7cmhE2ew l3jV0hnFCAuaahe+8CkzHA
&gt; &gt; /p/CicP/CvFCttO+rZipIw aNMKlZRyi8OaokvpSzGdIQ PvgVQW93UJj+l3AEAVxhkw
&gt; &gt; k9uF7ZCcE4OP+VzPqUzr2Q x+Ekn/wD653tkIwja9GZbQ KjikqTFsSeWoM1F8RdMQcA
&gt; &gt; dkeWa3NDwpBIZzJS5JD3Ng hhOYXsSeuPdXrmQ56Hm7Kg VCKav8+lZJ5wA7g91HVSlA
&gt; &gt; kswidTLRflbgeQKyVN+tEA mNzoPaV7A5XhY0Z8na5SGw 9LnsMK2faPibKWOXhsti7w
&gt; &gt; gStLoof17gvJ1Du/W76H+w JmV9X/kCDSq+/lWHlrmVhA 4u9ST789n+YR1ajpD+/cnA
&gt; &gt; 7T0sIZkeO+9eBpcTr5+myg rGJ6scy9ti7JbnAvB/ZCWw +JkTnfXhBZOWQxQV53DG3Q
&gt; &gt; OLPv+Lr1ZidHjsdqcE6bUg 7IlWY3qZeHvRl+rNd6zOXg aXTOWsZgYQtE2bn+0P+VSA
&gt; &gt; yeEHT1s/n8jqFdFSrdBylA ZbnupuHMa7nwzSpHdRoYbw 8JNeTNWSCqbHyZal7lOnDw
&gt; &gt; qX2mKbCYt1wpTf/cPkY5BA o8ZcKXQnD9CT7oqb+K59Cw JyPQkrY4heDXwmDMAH6LnQ
&gt; &gt; X5P5g1JN7z3KRkRp0s+fPg aY1RoZ2KEhzlgUmde3AWaA f2/6prsLQIAXtiJUIRaRtQ
&gt; &gt; cyeKSoaWDutXao/Uyexplw X9CzfNfbuwD5e6bOkr9a3Q K0SSiuEfuThMTPOHCGd8SA
&gt; &gt; xFFH3ucpMR71tcMAOUbEjw 6xYN4d6J2QWPywuWjbu9aA XvBZk4unmaqoReHC6KdivQ
&gt; &gt; B+HNfcqJoWeAQkdxg7esPw 2k+1xuk+dNPfhSdZn6YmQg TFb/TOSq+Vc6pd/5E9+Zeg
&gt; &gt; oKCA9C5vE7Oi3xM/BzCV3Q ICy5YqxZB1uWSwcVLSNLcA yP/ppYexJvFS7T2JoUa0RQ
&gt; &gt; Pe8YStj0dV/yaYYup3OT3Q BpBZt++EDwx0qBTskje27A 7F3syl7T1rgHni5+e6zJ8g
&gt; &gt; dtxhHW66r8ZswIeccbXbXA 0fSRpATWhUiAlD5cPNnKJQ m4YZJRoZBXz/cHeSc+lapg
&gt; &gt; Gvo0p/mE7qvbsKfUlBMu5Q Zd7VNTxe5I0LfUjFkbj0MA n8PXFSupM2pnDjbQ7Xm8Qw
&gt; &gt; AlIqKycm+woDuxny2NlSTQ fx3inm2hnSK1HGgAHn4OVA QqDhiPUDO8Zb+NeGIid8Tg
&gt; &gt; OYjH+I68tYxs6TK5V7bzMg AT1AcWbsT6VuseH4y+GDuQ
&gt; &gt; 4A2gO2haDdGPtqCK8JI94A,[],[],[],[],[],[],[],[],[],[],[],[],
&gt; &gt;                      [[clean|true]],
&gt; &gt;                      []}}},
&gt; &gt;
&gt; &gt; What does this tell me?
&gt; &gt;
&gt; &gt; Hal
&gt; &gt;
&gt; &gt;
&gt; &gt; On Fri, Oct 14, 2011 at 03:52:16PM -0400, Sean Cribbs wrote:
&gt; &gt; &gt; Hal,
&gt; &gt; &gt;
&gt; &gt; &gt; Wrap those strings in double-angle brackets, e.g.
&gt; &gt; &gt;
&gt; &gt; &gt; rp(C:get(&lt;&lt;&quot;test-with&quot;&gt;&gt;,&lt;&lt;&quot;x000071257&quot;&gt;&gt;)).
&gt; &gt; &gt;
&gt; &gt; &gt; On Fri, Oct 14, 2011 at 3:27 PM, Hal Eisen &lt;ei...@dunhackin.org&gt; wrote:
&gt; &gt; &gt;
&gt; &gt; &gt; &gt; Sean,
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Interesting.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; This is what I get using the console:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; bash$ /usr/sbin/riak attach
&gt; &gt; &gt; &gt; Attempting to restart script through sudo -u riak
&gt; &gt; &gt; &gt; Attaching to /var/run/riak/erlang.pipe.2 (^D to exit)
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; {ok, C} = riak:local_client().
&gt; &gt; &gt; &gt; {ok,{riak_client,'riak@127.0.0.1',undefined}}
&gt; &gt; &gt; &gt; (riak@127.0.0.1)2&gt; rp(C:get(&quot;test-with&quot;,&quot;x000071257&quot;)).
&gt; &gt; &gt; &gt; {error,notfound}
&gt; &gt; &gt; &gt; ok
&gt; &gt; &gt; &gt; (riak@127.0.0.1)3&gt; [Quit]
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; However, if I use the HTTP API (sorry for the excessive output):
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; bash$ curl <a  rel="nofollow" href="http://127.0.0.1:8098/riak/test-with/x000071257">http://127.0.0.1:8098/riak/test-with/x000071257</a>
&gt; &gt; &gt; &gt; z80ghJXVZe9m59/5+Ydk2g xMpCOKC5I4INzFCab3WEmw yB5yjZ1ML2NvBn+JzBSGLA
&gt; &gt; &gt; &gt; 7MvIfktc4v4oMI/Z8qe68w qH/2eaLz5x2RgaZ7dUISLA 5No7f7vOI0XXdysGdKMY1Q
&gt; &gt; &gt; &gt; FnkJHFqID69vteYIfrGy3A jxTkX87qFnpaNt7dS+olQw yfD4lfuYq5FZ9R/QKX4jbQ
&gt; &gt; &gt; &gt; RcSMzi4tf73qGvxRx8atJg 09lEaAKkQll1XTjm0WPoIA ZRK9Q9nKpuAsmQsKgmUtyg
&gt; &gt; &gt; &gt; wgrU12/pd1mqJ6DJm/9nEA xRzkEMEkoQ4NteS5f8KvOQ qrMjiSK8wlpvYG61Jf/cVg
&gt; &gt; &gt; &gt; m/Mcf/Bik2qW08i9H48v8w x02XsB6uJX5Eqp1brel7rw cO/fLsmwhgeXlcRCY2tV+w
&gt; &gt; &gt; &gt; b0ki9FVoFhqM30rSKZ9tIw Hw49rZmQg0X3Q5+P+r3/xA mPE3CCEBlMR1aHvmEGo7hA
&gt; &gt; &gt; &gt; PFncBI6IUCQ76AeaXHTQeQ ttdn0vjtXSGkSw5YhmgMuQ N2k8/HSASeRdh7jH2LmqzQ
&gt; &gt; &gt; &gt; H/Hed0AF+NoT9ClDiBxlXw jilqBno3VjNw3tBfWjvz7A TnMs7TRj0G3gypoVthU2dw
&gt; &gt; &gt; &gt; AudPEOAyetho0TjytP3W8A M+df8J3WAbvmnzUQORUhiQ bqmrG6oO+54ZCURAwxfiGw
&gt; &gt; &gt; &gt; NBc8s48H+J3b68KskSgwPw wWpTIPpHVTDZWDw0/TVu9Q Y2TT8PSVtqudz407XG4LAQ
&gt; &gt; &gt; &gt; GCvgxc3NUHK7GGTN7k09bg 42mFPfdm+kTh7Q/2E/VjvQ HDg80wt8KYq1ApOt/st7GA
&gt; &gt; &gt; &gt; GcoU5+pjKKQuDrE9WF5MIg pb/J4Hlk+N3euV/FhM2WXQ pXcbzpPiAMNvfNnf0OXeqg
&gt; &gt; &gt; &gt; 1n2KtPTBC/Iqo1PieHkTPA 1kWSDjlf7a17u+0Oyj/i4A NBanX0zqkQlQfKzY4vKu/A
&gt; &gt; &gt; &gt; odDG6D8CcyfYRhBj9KxYpg F+YhZvyFht+k0bwOF0LAiw 9xdxY8gz3/Szj8jShy8exg
&gt; &gt; &gt; &gt; bINJzHJgrmLjsTloMag5jw 2dT0leh1ouB1oaSm4bl3Dw Z8ah585W09b6dIq22a8/1w
&gt; &gt; &gt; &gt; ZC6S77eUIXNIgbU+HhsYtg 9FfFRane2I8Y7O5HFFpywA wMfHbTC9PcrvyW9AJ1vcCg
&gt; &gt; &gt; &gt; KDgCOneN+uzcIScI9yG3iA mhFYFU36QsrdvQaUpOm9yA 2CyNFhmtgXbWZUU8+y5V8A
&gt; &gt; &gt; &gt; poTs7udvxSJ3MoaolbyENg tTs6PWq5DOAmgikVHJveEQ n2FAjjr7Yz5QzfGyDeb0Zg
&gt; &gt; &gt; &gt; crMqH3VLocCbNpXgy2zefw ZvBB4WpgkosFp+IoqJw3mQ CT9l4ICilfgHaxxXIqRqog
&gt; &gt; &gt; &gt; BysDC6EmsvSyN080K+ntRA fzn4MX+9sZiO9MYo66AlkQ RPaDqEFjs1I6/lfC4Ai8jA
&gt; &gt; &gt; &gt; A6/b1m55KbEl+Fl4NPqDpA 6l0vHEYIIy4H06o9mY5RNQ /EkMpFwAsSSbvjVUpP32+w
&gt; &gt; &gt; &gt; MpXHasv0yq7TPDaxtfwssQ c1uQtFaBJe1sP2eIGbbgWA o/OQ2I5MQfJ0e/ovG1+H2w
&gt; &gt; &gt; &gt; FL+muxSHXkW7oCiiHtOARg fLvECeyZDxnHjHW9HgbyFQ 4sQg2SjUv4zg/y7BmzcVFA
&gt; &gt; &gt; &gt; MruQ6Jdqq1KY1doQ/mbyHQ 0t3qGPAGZc6GI+Nr1OPHxQ rWGrFDIj77wkx9JYO+aSUQ
&gt; &gt; &gt; &gt; 0Jv0FUSjNlpGyQd+u141ww +9eTnWdJl820aS003oYzxA KN0seVXOkmRWJAsv8BAL3g
&gt; &gt; &gt; &gt; NfSo1GXm4e3AXz2KtljFUQ 0f4XPQjpWTl63zSx136I1w 8DOrN8MCAfc/FCRJ0DcCjQ
&gt; &gt; &gt; &gt; Q+xRfWi27dMBWz7cmhE2ew l3jV0hnFCAuaahe+8CkzHA /p/CicP/CvFCttO+rZipIw
&gt; &gt; &gt; &gt; aNMKlZRyi8OaokvpSzGdIQ PvgVQW93UJj+l3AEAVxhkw k9uF7ZCcE4OP+VzPqUzr2Q
&gt; &gt; &gt; &gt; x+Ekn/wD653tkIwja9GZbQ KjikqTFsSeWoM1F8RdMQcA dkeWa3NDwpBIZzJS5JD3Ng
&gt; &gt; &gt; &gt; hhOYXsSeuPdXrmQ56Hm7Kg VCKav8+lZJ5wA7g91HVSlA kswidTLRflbgeQKyVN+tEA
&gt; &gt; &gt; &gt; mNzoPaV7A5XhY0Z8na5SGw 9LnsMK2faPibKWOXhsti7w gStLoof17gvJ1Du/W76H+w
&gt; &gt; &gt; &gt; JmV9X/kCDSq+/lWHlrmVhA 4u9ST789n+YR1ajpD+/cnA 7T0sIZkeO+9eBpcTr5+myg
&gt; &gt; &gt; &gt; rGJ6scy9ti7JbnAvB/ZCWw +JkTnfXhBZOWQxQV53DG3Q OLPv+Lr1ZidHjsdqcE6bUg
&gt; &gt; &gt; &gt; 7IlWY3qZeHvRl+rNd6zOXg aXTOWsZgYQtE2bn+0P+VSA yeEHT1s/n8jqFdFSrdBylA
&gt; &gt; &gt; &gt; ZbnupuHMa7nwzSpHdRoYbw 8JNeTNWSCqbHyZal7lOnDw qX2mKbCYt1wpTf/cPkY5BA
&gt; &gt; &gt; &gt; o8ZcKXQnD9CT7oqb+K59Cw JyPQkrY4heDXwmDMAH6LnQ X5P5g1JN7z3KRkRp0s+fPg
&gt; &gt; &gt; &gt; aY1RoZ2KEhzlgUmde3AWaA f2/6prsLQIAXtiJUIRaRtQ cyeKSoaWDutXao/Uyexplw
&gt; &gt; &gt; &gt; X9CzfNfbuwD5e6bOkr9a3Q K0SSiuEfuThMTPOHCGd8SA xFFH3ucpMR71tcMAOUbEjw
&gt; &gt; &gt; &gt; 6xYN4d6J2QWPywuWjbu9aA XvBZk4unmaqoReHC6KdivQ B+HNfcqJoWeAQkdxg7esPw
&gt; &gt; &gt; &gt; 2k+1xuk+dNPfhSdZn6YmQg TFb/TOSq+Vc6pd/5E9+Zeg oKCA9C5vE7Oi3xM/BzCV3Q
&gt; &gt; &gt; &gt; ICy5YqxZB1uWSwcVLSNLcA yP/ppYexJvFS7T2JoUa0RQ Pe8YStj0dV/yaYYup3OT3Q
&gt; &gt; &gt; &gt; BpBZt++EDwx0qBTskje27A 7F3syl7T1rgHni5+e6zJ8g dtxhHW66r8ZswIeccbXbXA
&gt; &gt; &gt; &gt; 0fSRpATWhUiAlD5cPNnKJQ m4YZJRoZBXz/cHeSc+lapg Gvo0p/mE7qvbsKfUlBMu5Q
&gt; &gt; &gt; &gt; Zd7VNTxe5I0LfUjFkbj0MA n8PXFSupM2pnDjbQ7Xm8Qw AlIqKycm+woDuxny2NlSTQ
&gt; &gt; &gt; &gt; fx3inm2hnSK1HGgAHn4OVA QqDhiPUDO8Zb+NeGIid8Tg OYjH+I68tYxs6TK5V7bzMg
&gt; &gt; &gt; &gt; AT1AcWbsT6VuseH4y+GDuQ 4A2gO2haDdGPtqCK8JI94A E4WXTtWQSkOGFv972z90OQ
&gt; &gt; &gt; &gt; Dyi11JswIK/uzZW0AJrfTA qLqlZVT5Y2mrk+TzuwaMIg kDzpIl/KPpiMKvIV1OVE0w
&gt; &gt; &gt; &gt; CgnIhEuo8JNsIL15ETDWtg KyTUlQUqjOZjWOtXa4kSyA peABMjc6cDEAD9mHo8n4ew
&gt; &gt; &gt; &gt; jV6Vfyl4k0h72Y+oMPpkEw R9HpkFg8nGdCTTafNBRyjg 8iFwYumjl6HcpCnn1wvGyg
&gt; &gt; &gt; &gt; fvYF/I26VCXWll+9TI++Hw qPFe2oDFCtsOcZQ63IAVzw N6dJ2AjkZJWo2h5TUtA8rg
&gt; &gt; &gt; &gt; s+Pjk8d+NaSj88vR5Cm13A HX96vBj8tDl1BlOZsNHkjg KnnqJ8J55HH00YCwjWKwCg
&gt; &gt; &gt; &gt; HJrAFZyU2NDL7clzRFry2g bEt2Gii3NP6Tgx4/tADOhw BkCWYyJq8vMRRIWqTgojtA
&gt; &gt; &gt; &gt; FA9padUhP9Ds4DFI5i5GHg tzzjmMOfUGr3YdInfYU6kg vUyatzD1UTIGuZnsDZDR+w
&gt; &gt; &gt; &gt; gqpLCvNMIxOlYgdpkuUKow B3fVwX1AZrgquG3/ikavbw +nzfrRpar4Nw6+2keh/xww
&gt; &gt; &gt; &gt; l2ZSfytdPpXUpzP8+3e9fg fndXseEqvLc2q5p1T/theg WHinq4T7Q0AhBsV1ZYRy+g
&gt; &gt; &gt; &gt; AG9S6RAqjTvi/lYU9CupiQ NjZjiBd3LkK1nXTP9XH7sw FJ6Wd6WYn9NCrkQhPfaIaA
&gt; &gt; &gt; &gt; pKBCz0/Wv7R3AcvIoWU62g H/intdx6fR8O1lqqKcBLHg 9+bIVQTOboJELHcPfIYG8A
&gt; &gt; &gt; &gt; v4IpaW96O7RwDP3e8Z+iPw ghYSQoJ7cD5qz5xya
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Hal
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; On Fri, Oct 14, 2011 at 08:22:39AM -0400, Sean Cribbs wrote:
&gt; &gt; &gt; &gt; &gt; Hal,
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; I would be interested to see what the format of the object is after
&gt; &gt; it
&gt; &gt; &gt; &gt; has
&gt; &gt; &gt; &gt; &gt; passed through your precommit hook.  We recently fixed some bugs
&gt; &gt; related
&gt; &gt; &gt; &gt; to
&gt; &gt; &gt; &gt; &gt; the JSON format of riak_objects that might result in an unclean
&gt; &gt; &gt; &gt; round-trip
&gt; &gt; &gt; &gt; &gt; through the JavaScript VM. That is, the format coming out is not the
&gt; &gt; same
&gt; &gt; &gt; &gt; as
&gt; &gt; &gt; &gt; &gt; went in.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; Could you do the first step (store a new object through your
&gt; &gt; precommit
&gt; &gt; &gt; &gt; &gt; hook), and then fetch it by attaching to the console?  Here's what
&gt; &gt; you
&gt; &gt; &gt; &gt; can
&gt; &gt; &gt; &gt; &gt; do on the console:
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; 1&gt; {ok, C} = riak:local_client().
&gt; &gt; &gt; &gt; &gt; 2&gt; rp(C:get(&lt;&lt;&quot;bucket&quot;&gt;&gt;,&lt;&lt;&quot;key&quot;&gt;&gt;)).
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; Of course, replace &quot;bucket&quot; and &quot;key&quot; as appropriate for your object.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; On Fri, Oct 14, 2011 at 3:57 AM, Hal Eisen &lt;ei...@dunhackin.org&gt;
&gt; &gt; wrote:
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; I made progress, thanks to Russell who answered my email the other
&gt; &gt; day.
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; I've got a simple javascript precommit hook installed and it seems
&gt; &gt; to
&gt; &gt; &gt; &gt; &gt; &gt; work fine, most of the time.  However, it will randomly timeout.
&gt; &gt;  There
&gt; &gt; &gt; &gt; &gt; &gt; aren't any interesting messages in any of the logs.  I am able to
&gt; &gt; store
&gt; &gt; &gt; &gt; &gt; &gt; a key/value pair one minute, but then not be able to store the same
&gt; &gt; &gt; &gt; pair
&gt; &gt; &gt; &gt; &gt; &gt; in the next minute.
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; Where should I be looking to get more info?  Are there any &quot;safe&quot;
&gt; &gt; &gt; &gt; &gt; &gt; operations, or operations that are discouraged in precommit hooks?
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; &gt; &gt; Hal
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; &gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; &gt; &gt; &gt; riak-users@lists.basho.com
&gt; &gt; &gt; &gt; &gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; --
&gt; &gt; &gt; &gt; &gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt; &gt; &gt; &gt; &gt; Developer Advocate
&gt; &gt; &gt; &gt; &gt; Basho Technologies, Inc.
&gt; &gt; &gt; &gt; &gt; <a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>
&gt; &gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; --
&gt; &gt; &gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt; &gt; &gt; Developer Advocate
&gt; &gt; &gt; Basho Technologies, Inc.
&gt; &gt; &gt; <a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>
&gt; &gt;
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; <a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05165.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd10.html#05166">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail11.html#05166">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05160.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05156.html">Timeout in precommit hook</a></span> <span class="sender italic">Hal Eisen</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05158.html">Re: Timeout in precommit hook</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05162.html">Re: Timeout in precommit hook</a></span> <span class="sender italic">Hal Eisen</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05163.html">Re: Timeout in precommit hook</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05164.html">Re: Timeout in precommit hook</a></span> <span class="sender italic">Hal Eisen</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05165.html">Re: Timeout in precommit hook</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Timeout in precommit hook</span> <span class="sender italic">Hal Eisen</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Timeout in precommit hook">
<input type="hidden" name="msgid" value="20111014212952.GA17602@volcano.builtonlinux.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05166.html">
<input type="submit" value=" Hal Eisen ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Timeout+in+precommit+hook%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05165.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05160.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">20111014212952.GA17602@volcano.builtonlinux.com</li>
</ul>
</div>
</body>
</html>
