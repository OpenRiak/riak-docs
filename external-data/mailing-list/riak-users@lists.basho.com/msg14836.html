<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak 2 - how much space is needed for online resizing?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#14836" id="c">
<link rel="index" href="maillist.html#14836" id="i">
<link rel="prev" href="msg14833.html" id="p">
<link rel="next" href="msg14844.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg14836.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+2+%5C-+how+much+space+is+needed+for+online+resizing%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak 2 - how much space is needed for online resizing?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jordan+West%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jordan West</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140902" rel="nofollow">Tue, 02 Sep 2014 14:18:36 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Max,

A ring resize won't make things much better. It is intended to change the
number of partitions from 64, in your case, to 32 or 256, for example.
While these rings sizes may have better distributions with 5 nodes they
will not be perfect. The quickest solution using the existing cluster and
settings would be to add 3 nodes (for a total of 8) or remove one (for a
total of 4) -- we don't suggest the latter, you can read more about why in
[1], but decide based on your application's needs. There are a few other
options but they are more complicated. Somewhat related, since you are
using a pre-build, is this development/test data? Do you have the option of
re-building the cluster? If you would like to stick with 5 nodes and can
re-build the cluster from scratch, another alternative is to try &quot;claim_v3&quot;
(the default is v2). See wants_claim_fun and choose_claim_fun in [2].
You'll want to set these to wants_claim_v3 and choose_claim_v3,
repsectively, in the riak_core section of your advanced.config. It may
result in a better, albeit not perfect, balance.</pre><pre>

To answer your original question about capacity, a conservative rule is,
below 50% capacity on every node.

I would also suggest upgrading to a more recent build.

Jordan


[1] <a  rel="nofollow" href="http://basho.com/why-your-riak-cluster-should-have-at-least-five-nodes/">http://basho.com/why-your-riak-cluster-should-have-at-least-five-nodes/</a>
[2]
<a  rel="nofollow" href="http://docs.basho.com/riak/1.4.10/ops/advanced/configs/configuration-files/">http://docs.basho.com/riak/1.4.10/ops/advanced/configs/configuration-files/</a>


On Tue, Sep 2, 2014 at 5:21 AM, Max Vernimmen &lt;m.vernim...@comparegroup.eu&gt;
wrote:

&gt;  Hi,
&gt;
&gt;
&gt;
&gt; We have 5 riak nodes running riak-2.0.0pre20-1.el6.x86_64 with a ringsize
&gt; of 64. We would like to do a ring resize because the distribution of
&gt; content is very uneven (64/5 has a left over of 4 parts that all end up on
&gt; the same node). The documentation says riak-2 can do this online (
&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/2.0.0/ops/advanced/ring-resizing/">http://docs.basho.com/riak/2.0.0/ops/advanced/ring-resizing/</a>) and warns
&gt; 'Make sure that you have sufficient storage to complete the resize
&gt; operation'.
&gt;
&gt;
&gt;
&gt; Could anyone tell me how much is ‘sufficient’?
&gt;
&gt; And in addition, some of the nodes in the cluster have more free space
&gt; available than other nodes (some are at 40% used disk, others at 60%). Is
&gt; the location of the space important?
&gt;
&gt;
&gt;
&gt; Thank you,
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; Max
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg14833.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#14836">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#14836">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg14844.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg14833.html">riak 2 - how much space is needed for online resizing?</a></span> <span class="sender italic">Max Vernimmen</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak 2 - how much space is needed for online resizi...</span> <span class="sender italic">Jordan West</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14844.html">RE: riak 2 - how much space is needed for online re...</a></span> <span class="sender italic">Max Vernimmen</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak 2 - how much space is needed for online resizing?">
<input type="hidden" name="msgid" value="CANvRNddaS36GaJ88r=HE-ZzXTUQNXNr58cqMuQzp76r8MA69WQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg14836.html">
<input type="submit" value=" Jordan West ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+2+%5C-+how+much+space+is+needed+for+online+resizing%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg14833.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg14844.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CANvRNddaS36GaJ88r=HE-ZzXTUQNXNr58cqMuQzp76r8MA69WQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
