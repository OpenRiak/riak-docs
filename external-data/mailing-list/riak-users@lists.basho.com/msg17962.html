<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Secondary indexes or Riak search ?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#17962" id="c">
<link rel="index" href="maillist.html#17962" id="i">
<link rel="prev" href="msg17920.html" id="p">
<link rel="next" href="msg17964.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg17962.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Secondary+indexes+or+Riak+search+%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Secondary indexes or Riak search ?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Alex+Feng%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Alex Feng</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20170212" rel="nofollow">Sun, 12 Feb 2017 22:20:07 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Russell,

In your reply, you mentioned this,</pre><pre>

&gt;&gt; There is also the feature that can return the actual riak objects for a
$keys index search,
&gt;&gt;You can pack the index terms with data and return the terms in a query so
that you don’t need a further object fetch (see &gt;&gt;return_terms in docs.)

If I understood correctly, it is possible to fetch object (value) by 2i in
one time. But, we have tried using &quot;return_term = true&quot;, it returns the
index with key comparing only key when not using &quot;return_term=true&quot;.  It
doesn't help much with extra index, what we want to achieve is to fetch the
object in one time.


Our use case,  client search DB every 10 seconds by 2i, Riak will return a
list of around 5000 results(Keys), then client will query DB to fetch value
for each key, basically it is around 5000 times,  client is easy to run
into some issues most of the time. Any suggestion here ?

Many thanks in advance.

Br,
Alex

2017-02-06 19:02 GMT+08:00 Alex Feng &lt;sweden.f...@gmail.com&gt;:

&gt; Hi Russell,
&gt;
&gt; It is really helpful, thank you a lot.
&gt; We are suffering from solr crash now, are considering to switch to 2i.
&gt;
&gt; Br,
&gt; Alex
&gt;
&gt; 2017-02-06 16:53 GMT+08:00 Russell Brown &lt;russell.br...@icloud.com&gt;:
&gt;
&gt;&gt; It’s worth noting that secondary indexes (2i) has some other advantages
&gt;&gt; over solr search. If you _can_ model your queries in 2i then I'd recommend
&gt;&gt; it.
&gt;&gt;
&gt;&gt; Secondary indexes  have a richer API than is currently documented, if you
&gt;&gt; look at <a  rel="nofollow" href="https://docs.basho.com/riak/1.4.7/dev/using/2i/">https://docs.basho.com/riak/1.4.7/dev/using/2i/</a> you’ll see that
&gt;&gt; documents a feature that allows the index terms to be filtered via reg ex.
&gt;&gt; There is also the feature that can return the actual riak objects for a
&gt;&gt; $keys index search,
&gt;&gt; You can pack the index terms with data and return the terms in a query so
&gt;&gt; that you don’t need a further object fetch (see return_terms in docs.)
&gt;&gt; Secondary indexes are written atomically with the object they index.
&gt;&gt; Operationally they don’t require you run a JVM and Solr alongside your
&gt;&gt; riak nodes.
&gt;&gt;
&gt;&gt; You have the tools with basho_bench to answer the question about
&gt;&gt; performance and overhead for your workload. I suspect for “overhead” 2i
&gt;&gt; wins, as there is no JVM-per-node.
&gt;&gt;
&gt;&gt; Modelling for 2i is perhaps harder, in the classical nosql way, you have
&gt;&gt; to do more work upfront when designing your querying.
&gt;&gt;
&gt;&gt; I hope that helps a little. I worked quite a lot on 2i and never really
&gt;&gt; understood why riak-search was seen as a replacment, imo they’re
&gt;&gt; complementary, and you pick the one that best fits.
&gt;&gt;
&gt;&gt; Cheers
&gt;&gt;
&gt;&gt; Russell
&gt;&gt;
&gt;&gt; On 2 Feb 2017, at 09:43, Alex Feng &lt;sweden.f...@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt; &gt; Hello Riak-users,
&gt;&gt; &gt;
&gt;&gt; &gt; I am currently using Riak search to do some queries, since my queries
&gt;&gt; are very simple, it should be fulfilled by secondary indexes as well.
&gt;&gt; &gt; So, my question is which one has better performance and less overhead,
&gt;&gt; let's say both can fulfill the query requirement.
&gt;&gt; &gt;
&gt;&gt; &gt; Many thanks in advance.
&gt;&gt; &gt;
&gt;&gt; &gt; Br,
&gt;&gt; &gt; Alex
&gt;&gt; &gt; _______________________________________________
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg17920.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#17962">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#17962">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg17964.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg17911.html">Secondary indexes or Riak search ?</a></span> <span class="sender italic">Alex Feng</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17912.html">Re: Secondary indexes or Riak search ?</a></span> <span class="sender italic">Jason Voegele</span></li>
<li class="icons-email"><span class="subject"><a href="msg17919.html">Re: Secondary indexes or Riak search ?</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17920.html">Re: Secondary indexes or Riak search ?</a></span> <span class="sender italic">Alex Feng</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Secondary indexes or Riak search ?</span> <span class="sender italic">Alex Feng</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17964.html">Re: Secondary indexes or Riak search ?</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17966.html">Re: Secondary indexes or Riak search ?</a></span> <span class="sender italic">Alex Feng</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17967.html">Re: Secondary indexes or Riak sear...</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17968.html">Re: Secondary indexes or Riak ...</a></span> <span class="sender italic">Alex Feng</span></li>
<li class="icons-email"><span class="subject"><a href="msg17969.html">Re: Secondary indexes or Riak ...</a></span> <span class="sender italic">John Daily</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Secondary indexes or Riak search ?">
<input type="hidden" name="msgid" value="CAAZfT385oTqXhpSwUE8mycVYSjmX0xxQ=Y1qAqis218MVsPcJw@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg17962.html">
<input type="submit" value=" Alex Feng ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Secondary+indexes+or+Riak+search+%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg17920.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg17964.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAAZfT385oTqXhpSwUE8mycVYSjmX0xxQ=Y1qAqis218MVsPcJw@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
