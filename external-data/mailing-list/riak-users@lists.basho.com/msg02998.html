<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: [newbie] riak performance - basics</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#02998" id="c">
<link rel="index" href="maillist.html#02998" id="i">
<link rel="prev" href="msg02997.html" id="p">
<link rel="next" href="msg03000.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg02998.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+%5C%5Bnewbie%5C%5D+riak+performance+%5C-+basics%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: [newbie] riak performance - basics</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Kelly+McLaughlin%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Kelly McLaughlin</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110413" rel="nofollow">Wed, 13 Apr 2011 07:38:56 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>MH,

Riak may not seem as fast in a single node configuration compared to things
like mongodb or others, but keep in mind the strengths of Riak are its
performance at scale and the ease with which it does scale. Nobody runs a
single node configuration in an actual production environment so keep that
in mind as you draw conclusions from your tests. I would encourage you to do
some testing on a cluster of nodes. Riak is written in Erlang and the
benefits of Erlang really become apparent when there is a lot of concurrent
load. The advantages of Riak specifically become apparent when you have a
few nodes crash, but don't lose any data and your cluster keeps humming
along. I would also point out the ease of administration with Riak. Scaling
either up or down is very simple I think when compared to other systems that
use shards or other schemes. Hope this helps some. Good luck and have fun!</pre><pre>


-Kelly


On Wed, Apr 13, 2011 at 6:58 AM, M H &lt;jde...@gmail.com&gt; wrote:

&gt; Hi,
&gt;
&gt; I am new to Riak - just compiled it and trying it out. I have some
&gt; questions about performance.
&gt;
&gt; I am running a single riak node with default configuration (only
&gt; changed the IPs) on a core i7 machine (Ubuntu). I run a very simple
&gt; JMeter test (RESTful calls):
&gt;  1 .PUT a simple json object into riak (~30 bytes; key is static - so
&gt; DB has only one key)
&gt;  2. GET the object
&gt;
&gt; While the test is running riak seems to be using all the CPU it can
&gt; get - 'top' reports ~99.5% CPU usage (beam.smp is using ~780% so all 8
&gt; cores).
&gt;
&gt; Here are some results from the JMeter test:
&gt; * 5 threads:
&gt;  1.PUT  avg: 458 ms  Throughput 6.1/sec
&gt;  2.GET  avg: 355 ms  Throughput 6.1/sec
&gt;
&gt; * 50 threads:
&gt;  1.PUT  avg: 5325 ms  Throughput 6.1/sec
&gt;  2.GET  avg: 2838 ms  Throughput 6.1/sec
&gt;
&gt; The numbers are pretty disappointing. Is there something wrong with
&gt; the default configuration? Or I am misusing riak in some way? There is
&gt; only 1 key with simple value in the DB....
&gt;
&gt;
&gt; Here's some numbers from admin stats:
&gt;
&gt; vnode gets : 2118
&gt; vnode_puts : 1067
&gt; read_repairs : 1
&gt; vnode_gets_total : 224061
&gt; vnode_puts_total : 89045
&gt; node_gets : 680
&gt; node_gets_total : 74676
&gt; node_get_fsm_time_mean : 3047570
&gt; node_get_fsm_time_median : 2949500
&gt; node_get_fsm_time_95 : 4888000
&gt; node_get_fsm_time_99 : 5964050
&gt; node_get_fsm_time_100 : 6348870
&gt; node_puts : 339
&gt; node_puts_total : 29543
&gt; node_put_fsm_time_mean : 2433651
&gt; node_put_fsm_time_median : 2472125
&gt; node_put_fsm_time_95 : 4054512
&gt; node_put_fsm_time_99 : 4504152
&gt; node_put_fsm_time_100 : 4908213
&gt; read_repairs_total : 180
&gt; cpu_nprocs : 620
&gt; cpu_avg1 : 2104
&gt; cpu_avg5 : 2117
&gt; cpu_avg15 : 2099
&gt; storage_backend : riak_kv_bitcask_backend
&gt;
&gt; Any hints?
&gt;
&gt; --
&gt; MH
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg02997.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#02998">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#02998">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03000.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg02996.html">[newbie] riak performance - basics</a></span> <span class="sender italic">M H</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02997.html">SV: [newbie] riak performance - basics</a></span> <span class="sender italic">Jens Rantil</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: [newbie] riak performance - basics</span> <span class="sender italic">Kelly McLaughlin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03000.html">Re: [newbie] riak performance - basics</a></span> <span class="sender italic">Dan Reverri</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: [newbie] riak performance - basics">
<input type="hidden" name="msgid" value="BANLkTikdQadZaMmgnCtYHf=M+-jAsJ6JWw@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg02998.html">
<input type="submit" value=" Kelly McLaughlin ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+%5C%5Bnewbie%5C%5D+riak+performance+%5C-+basics%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg02997.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03000.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">BANLkTikdQadZaMmgnCtYHf=M+-jAsJ6JWw@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
