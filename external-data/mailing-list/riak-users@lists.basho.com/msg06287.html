<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: 2i and Links</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd3.html#06287" id="c">
<link rel="index" href="maillist.html#06287" id="i">
<link rel="prev" href="msg05923.html" id="p">
<link rel="next" href="msg05924.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06287.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+2i+and+Links%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: 2i and Links</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Ryan+Zezeski%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ryan Zezeski</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120114" rel="nofollow">Sat, 14 Jan 2012 12:01:46 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Dang,

I'm sorry your question went unanswered for so long.  Sometimes they slip
through the cracks.  First, let me make sure I understand your data model.</pre><pre>

1. You have users
2. You have content
3. Users generate and own content, a piece of content may have an arbitrary
number of tags
4. You want to be able to search content (full-text), furthermore this
search should only match against content a specific user owns, finally you
also want to be able to filter these results against the tags on the content

To be honest my knowledge of Riak links is very limited.  Conceptually it
seems like a fine way to model ownership of content, but perhaps one of my
colleagues  can speak more authoritatively to that.

That said, since you want full-text search on content I think using Riak's
built-in search solution makes sense.  Not only can it provide the
full-text searching you need but along with the noop/whitespace analyzers
and inline fields it can be used for filtering by tag as well.  You can
also tag each content with a user field and use search to determine all
content owned by a user to avoid links if necessary.  That said, let me add
some caveats before you decide to spend time with it:

1. Search is not fully compatible with Lucene/Solr, it's a limited subset.
 Do not expect it to be just like Solr.

2. Boolean queries with one or more low cardinality fields will cause pain
(e.g. `sex:male AND last_name:zezeski`).  This is where inline fields come
into play [1].

3. There is currently no anti-entropy in Search so if you lose replicas or
they become corrupted you will need to reindex all data [2].

You can find some documentation on Search here:
<a  rel="nofollow" href="http://wiki.basho.com/Riak-Search.html">http://wiki.basho.com/Riak-Search.html</a>

Also, in regards to your question on object size, we do recommend less than
64MB (realistically it should be much, much lower if you care about
latency).  Luwak should no longer be considered an option as we have EOL'd
it [3].  If you are asking because your docs (content) might be large then
perhaps you should think of making your docs more granular.  E.g. if you
are indexing books then perhaps a doc should be a chapter from the book.

-Ryan

[1]:
<a  rel="nofollow" href="https://github.com/rzezeski/try-try-try/tree/master/2011/riak-search-inline-fields">https://github.com/rzezeski/try-try-try/tree/master/2011/riak-search-inline-fields</a>

[2]: <a  rel="nofollow" href="https://issues.basho.com/show_bug.cgi?id=1304">https://issues.basho.com/show_bug.cgi?id=1304</a>

[3]:
<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-December/006905.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-December/006905.html</a>

On Mon, Dec 12, 2011 at 4:53 PM, God Dang &lt;godd...@hotmail.com&gt; wrote:

&gt;  Hi,
&gt;
&gt;  I'm trying to grok Links and 2i and are toying with some concepts for our
&gt; schema design.
&gt;
&gt; Out usecase:
&gt; -Users
&gt; -Content that belongs to a user and ability for any given user to full
&gt; text search their content (without seeing anyone else content). Also per
&gt; user be able to tag the content and easily filter listings based on these
&gt; tags.
&gt;
&gt; A design I've been toying with and been giving various stabs at code wise
&gt; is:
&gt; -A User bucket
&gt; -Each user can have arbitrary contents related using Links.
&gt; -A Content bucket
&gt; -Content linked (on the user bucket and maybe reversed on each content) to
&gt; a user
&gt;
&gt; Are Links indexed in any way and would a (good) option for implementing
&gt; tags be an approach where we use the Tag field on each link to store the
&gt; information(also maybe in the user value). Like: {{&lt;&lt;&quot;User&quot;&gt;&gt;, &lt;&lt;&quot;Link to
&gt; content&quot;&gt;&gt;}, &lt;&lt;&quot;Tag1, Tag2, Tag3, etc&quot;&gt;&gt;}, Best is of course if the tags
&gt; are Indexed and I can feed these into a m/r job but I guess it would be
&gt; feasible to do it &quot;client&quot; side also. Maybe a other (better) option is to
&gt; put a 2i on each content with the Tag and feed the Link keys in to a m/r
&gt; job that goes over the indexed tags?
&gt;
&gt; Is it possible using riak search to keep a per user index or do we have to
&gt; roll our own? Or maybe some other smart approach.
&gt;
&gt; Also, I read somewhere that a Riak value is best served &lt; ~64MB, is that
&gt; true and should we use Luwak after that.
&gt;
&gt; Appreciate any insights.
&gt;
&gt; Thanks, -dang
&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05923.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd3.html#06287">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06287">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05924.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05923.html">2i and Links</a></span> <span class="sender italic">God Dang</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: 2i and Links</span> <span class="sender italic">Ryan Zezeski</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: 2i and Links">
<input type="hidden" name="msgid" value="CACZcpe=z9c343Z1TX5_hfNrxeC1ddQKoF6tHGYbJ4pZc-yQ12g@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06287.html">
<input type="submit" value=" Ryan Zezeski ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+2i+and+Links%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05923.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05924.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACZcpe=z9c343Z1TX5_hfNrxeC1ddQKoF6tHGYbJ4pZc-yQ12g@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
