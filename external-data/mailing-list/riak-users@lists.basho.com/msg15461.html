<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Deleting a strongly consistent key</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#15461" id="c">
<link rel="index" href="mail2.html#15461" id="i">
<link rel="prev" href="msg15453.html" id="p">
<link rel="next" href="msg15454.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15461.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Deleting+a+strongly+consistent+key%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Deleting a strongly consistent key</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Drew+Pirrone%5C-Brusse%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Drew Pirrone-Brusse</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20150109" rel="nofollow">Fri, 09 Jan 2015 09:58:42 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hello Zsolt,

Whether or not it is correct or valuable for you to use delete
operations is (as with many features of Riak) largely dependent on
your use-case. Deletes in the strongly consistent mode are much less
valuable than deletes in the eventually consistent mode because keys
are never reaped from strongly consistent buckets. You might be able
to reclaim some disk space with a strongly consistent delete by
shrinking the size of the stored value, but that key will never be
removed from the system. The next time a GET is performed for that
key, the return value should look like the return value for a key that
never existed though, so if those are the semantics you're after it
might still be correct to delete keys.</pre><pre>

I hope that answered your question.
Best,
-Drew


On Fri, Jan 9, 2015 at 4:55 AM, Zsolt Laky &lt;zsolt.l...@lamardan.com&gt; wrote:
&gt; Hello Drew,
&gt;
&gt; Thinking through the delete operation on a strong consistent bucket, a
&gt; question popped up for me.
&gt;
&gt; Should not we use delete_object instead to keep strong consistency? The
&gt; delete function takes a key and does not care about the current state/value
&gt; of the object itself. If in the meantime another process changes the value
&gt; of an object, delete will simply delete it. So is there a benefit using
&gt; delete on strongly consistent bucket other than swipe the bucket not caring
&gt; about other processes store their state info?
&gt;
&gt; Thanks for your thoughts,
&gt; Zsolt
&gt;
&gt; -----Eredeti üzenet-----
&gt; Feladó: riak-users [<a  rel="nofollow" href="mailto:riak-users-boun...@lists.basho.com">mailto:riak-users-boun...@lists.basho.com</a>] Meghatalmazó
&gt; Drew Pirrone-Brusse
&gt; Küldve: Thursday, January 08, 2015 12:32 AM
&gt; Címzett: Igor Birman
&gt; Másolatot kap: riak-users@lists.basho.com
&gt; Tárgy: Re: Deleting a strongly consistent key
&gt;
&gt; Hello Igor,
&gt;
&gt; Deletions should be a strongly consistent operation, yes. If after a
&gt; successful strongly consistent delete a GET of that key returns stale data
&gt; something is likely wrong, be it with your application, the cluster, or Riak
&gt; itself.
&gt;
&gt; That said, deletions don't actually remove keys from Riak. Strongly
&gt; consistent deletions should behave identically to conditional PUTs, where
&gt; the value put is a tombstone. When Riak is running in an eventually
&gt; consistent mode, those tombstones are (sometimes) eventually harvested and
&gt; removed from disk. In the strongly consistent mode (as with `delete_mode =
&gt; keep`) Riak will never harvest those tombstones, so they will remain on disk
&gt; indefinitely.
&gt; Our documentation has lots of good information, if you're looking for some
&gt; implementation details[1].
&gt;
&gt; Generally speaking, if you know you're going to immediately re-use a key,
&gt; it's better to simply overwrite values than issuing an intermittent delete.
&gt;
&gt; Best regards,
&gt; -Drew
&gt;
&gt; [1]:
&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/advanced/strong-consistency/#Implement">http://docs.basho.com/riak/latest/ops/advanced/strong-consistency/#Implement</a>
&gt; ation-Details
&gt;
&gt; On Wed, Jan 7, 2015 at 10:01 AM, Igor Birman &lt;igor_bir...@yahoo.com&gt; wrote:
&gt;&gt; Is deleting a strongly consistent key a consistent operation?  I have
&gt;&gt; found in testing that if I delete a key and then attempt to
&gt;&gt; immediately reuse it, sometimes the delete completes after I have
&gt;&gt; reused it.  Should I expect that when I get a 204 from a delete that I
&gt;&gt; can immediately create a new key with the same id?
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
&gt; ---
&gt; This email has been checked for viruses by Avast antivirus software.
&gt; <a  rel="nofollow" href="http://www.avast.com">http://www.avast.com</a>
&gt;

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15453.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#15461">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#15461">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15454.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg15448.html">Deleting a strongly consistent key</a></span> <span class="sender italic">Igor Birman</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15450.html">Re: Deleting a strongly consistent key</a></span> <span class="sender italic">Drew Pirrone-Brusse</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15453.html">RE: Deleting a strongly consistent key</a></span> <span class="sender italic">Zsolt Laky</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Deleting a strongly consistent key</span> <span class="sender italic">Drew Pirrone-Brusse</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Deleting a strongly consistent key">
<input type="hidden" name="msgid" value="CANXL_jzWUW4NZM4SeiNLDqW4C5-Q9rOO_repvfXo4z1ccod8RA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15461.html">
<input type="submit" value=" Drew Pirrone-Brusse ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Deleting+a+strongly+consistent+key%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15453.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15454.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CANXL_jzWUW4NZM4SeiNLDqW4C5-Q9rOO_repvfXo4z1ccod8RA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
