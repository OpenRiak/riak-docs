<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Difference between 2I and Search</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#05315" id="c">
<link rel="index" href="maillist.html#05315" id="i">
<link rel="prev" href="msg05292.html" id="p">
<link rel="next" href="msg05321.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05315.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Difference+between+2I+and+Search%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Difference between 2I and Search</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Rusty+Klophaus%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Rusty Klophaus</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111025" rel="nofollow">Tue, 25 Oct 2011 14:09:58 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Soren,

Excellent question. As you noted, Secondary Indexes and Search cover some of
the same ground. But, there are key differences.</pre><pre>

As a rule of thumb: Developers should try Secondary Indexes first, and only
use Riak Search if they need more flexibility around querying. Secondary
Indexes has fewer moving parts, and in technology, that's an advantage.

Here's another way to look at it: &quot;Secondary Indexes vs. Search&quot; is kind of
like &quot;MySQL vs. Solr&quot;. While both solutions allow you to store and retrieve
data, Riak Search works best for applications that need full-text search on
documents that don't change very much, and are in JSON, XML, or plain-text
format.

To elaborate, there are two core differences between Secondary Indexes and
Search.

1. In Secondary Indexes, the *application* tokenizes the document

80% of the problems that developers face when first using Riak Search relate
to either the schema, document formats, or tokenization. Setting this up
correctly can be confusing and error prone.

Secondary Indexes skips these issues by pushing responsibility for
tokenizing the document to the application. This simplifies indexing; Riak
indexes your object exactly how you instruct it to, no more, no less.

2. Secondary Indexes use document partitioning (aka: local indexes)

Document partitioning means that the index for a document is stored locally
on the same server (or in our case, vnode) as the document itself. Picture
many small indexes that work together to form a big index. This is the
approach that Secondary Indexes use. Riak Search, on the other hand, uses
term partitioning (aka: a global index). The document is tokenized, and then
the postings (the entries in the index) are written to the different vnodes
in the cluster. Picture one big index.

There are many tradeoffs between the two approaches, but the most
significant is that term-partitioning (the Riak Search approach) has more
overhead at write time. In a typical &quot;search&quot; use case, documents don't
change very often, so a system sees more query traffic than write traffic.
Losing some write performance to gain query performance makes sense. Also,
in a term partitioned system, write overhead can be mitigated somewhat by
writing documents in batches, which Riak Search supports through the Solr
interface.

In comparison, document partitioning (the Secondary Index approach) is
optimized for the typical KV use case, where the system sees more KV reads
and writes and index queries. A document-partitioned system makes KV reads
and writes fast, but with more overhead at query time. That said, queries
still run within a typical web response time; we’ve done a lot of work to
make sure that this is fast.

One thing to note is that the Secondary Indexes feature is new, and we’ve
deliberately aimed to keep things simple in this first release to get
something out there while still leaving room for more advanced features down
the road. Secondary Indexes won’t ever support the *full* query interface of
Riak Search, but I’m looking forward to seeing it get fleshed out in future
releases.

So to summarize, while there is some overlap, there are distinct ideal use
cases for both products. It's important to understand the tradeoffs, but in
general most applications that currently use Riak KV will be better served
with Secondary Indexes than Riak Search.

Hope that helps!

Best,
Rusty

On Tue, Oct 25, 2011 at 4:53 AM, Soren Hansen &lt;so...@linux2go.dk&gt; wrote:

&gt; From a user's perspective, 2I and Search seem incredibly similar.
&gt;
&gt; Both offer a way to efficiently query Riak for objects based on things
&gt; other than their keys. The fact that 2I uses explicitly set indices,
&gt; while Riak Search indexes the contents of Riak objects[1] seems like a
&gt; minor detail.
&gt;
&gt; The interface for Riak search is much richer, and notably supports
&gt; querying on multiple terms in one go.
&gt;
&gt; My question is: What would be my motivation for using 2I? As far as I
&gt; can tell, anything I can do with 2I, I can also do with Search, so the
&gt; differences must lie elsewhere (performance? availability?
&gt; consistency?), and I'm at a bit of a loss here.
&gt;
&gt; [1]: I realise Riak Search can index things that aren't in Riak KV,
&gt; but that's beside the point for this particular discussion.
&gt;
&gt; --
&gt; Soren Hansen        | <a  rel="nofollow" href="http://linux2go.dk/">http://linux2go.dk/</a>
&gt; Ubuntu Developer    | <a  rel="nofollow" href="http://www.ubuntu.com/">http://www.ubuntu.com/</a>
&gt; OpenStack Developer | <a  rel="nofollow" href="http://www.openstack.org/">http://www.openstack.org/</a>
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;



-- 
Rusty Klophaus (@rustyio)

*Basho Technologies, Inc.*
www.basho.com
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05292.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#05315">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#05315">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05321.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05292.html">Difference between 2I and Search</a></span> <span class="sender italic">Soren Hansen</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Difference between 2I and Search</span> <span class="sender italic">Rusty Klophaus</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05321.html">Re: Difference between 2I and Search</a></span> <span class="sender italic">Kresten Krab Thorup</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05324.html">Re: Difference between 2I and Search</a></span> <span class="sender italic">Soren Hansen</span></li>
<li class="icons-email"><span class="subject"><a href="msg05332.html">Re: Difference between 2I and Search</a></span> <span class="sender italic">Ryan Zezeski</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg05322.html">Re: Difference between 2I and Search</a></span> <span class="sender italic">Elias Levy</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Difference between 2I and Search">
<input type="hidden" name="msgid" value="CAOr2nz4-pJ8j24n5NP5UJjOkSTLwLi0zL4cX-+KLRJQ1ZpkfOQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05315.html">
<input type="submit" value=" Rusty Klophaus ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Difference+between+2I+and+Search%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05292.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05321.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAOr2nz4-pJ8j24n5NP5UJjOkSTLwLi0zL4cX-+KLRJQ1ZpkfOQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
