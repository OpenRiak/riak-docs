<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Looking for an easy cache solution based on pre-commit hook</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#13753" id="c">
<link rel="index" href="mail3.html#13753" id="i">
<link rel="prev" href="msg13752.html" id="p">
<link rel="next" href="msg13755.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg13753.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Looking+for+an+easy+cache+solution+based+on+pre%5C-commit+hook%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Looking for an easy cache solution based on pre-commit hook</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Christian+Dahlqvist%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Christian Dahlqvist</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140305" rel="nofollow">Wed, 05 Mar 2014 07:38:12 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Ivaylo,

For read intensive applications a common solution is to perform the caching
outside Riak, e.g. using Varnish, memcached or Redis. Often the application
will be responsible for populating the cache, but either the application or
Riak (through a commit hook) can be responsible for purging old records
from the cache when they are updated in Riak.</pre><pre>

If you still choose to perform the caching in Riak, you always have the
option of using different bucket properties for the cache bucket, e.g. a
smaller n_val, in order to optimise performance.

Best regards,

Christian


On Wed, Mar 5, 2014 at 2:24 PM, Brian Sparrow &lt;bspar...@basho.com&gt; wrote:

&gt; Hello Ivaylo,
&gt;
&gt; Yes, you could use a pre-commit hook for this but it's important to
&gt; understand the limitations of this design. A pre-commit hook blocks the
&gt; write until the hook comes back successful and then it proceeds. This is
&gt; going to add latency to write operations on the bitcask backend. An
&gt; alternative design would be to do 2 PUTs for each object, one in bitcask
&gt; and one in memory, to remove the hook all together. Either will work but
&gt; obviously have different trade offs.
&gt;
&gt; I recommend having a look at the riak_search pre-commit hook(specifically
&gt; the pre-commit function)[0] for an example of how to write/install a
&gt; pre-commit hook.
&gt;
&gt; Let me know if you have any questions.
&gt;
&gt; Thanks!
&gt; Brian
&gt;
&gt; [0]
&gt; <a  rel="nofollow" href="https://github.com/basho/riak_search/blob/develop/src/riak_search_kv_hook.erl">https://github.com/basho/riak_search/blob/develop/src/riak_search_kv_hook.erl</a>
&gt;
&gt;
&gt; On Tue, Mar 4, 2014 at 11:39 AM, Ivaylo Panitchkov &lt;
&gt; ipanitch...@hibernum.com&gt; wrote:
&gt;
&gt;&gt;
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; I'm playing with the Bitcask storage backend and realized it will be nice
&gt;&gt; if there is a cache functionality realized with the Memory backend. If I
&gt;&gt; install both Bitcask and Memory storage backends as Mult Is there any easy
&gt;&gt; way, a simple script that could do the caching by simply installing it with
&gt;&gt; pre-commit hook?
&gt;&gt;
&gt;&gt; Thanks in advance,
&gt;&gt; Ivaylo Panitchkov
&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg13752.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#13753">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail3.html#13753">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg13755.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg13748.html">Looking for an easy cache solution based on pre-commit...</a></span> <span class="sender italic">Ivaylo Panitchkov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13752.html">Re: Looking for an easy cache solution based on p...</a></span> <span class="sender italic">Brian Sparrow</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Looking for an easy cache solution based ...</span> <span class="sender italic">Christian Dahlqvist</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Looking for an easy cache solution based on pre-commit hook">
<input type="hidden" name="msgid" value="CAGLZ9HOtiR8Uwpo1F6uVkU5gLQKQdbzEy=upyy_r1jjmiJAWDA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg13753.html">
<input type="submit" value=" Christian Dahlqvist ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Looking+for+an+easy+cache+solution+based+on+pre%5C-commit+hook%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg13752.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg13755.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAGLZ9HOtiR8Uwpo1F6uVkU5gLQKQdbzEy=upyy_r1jjmiJAWDA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
