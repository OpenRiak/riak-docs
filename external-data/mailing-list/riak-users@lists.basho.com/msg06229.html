<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Newbie question 1/3</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06229" id="c">
<link rel="index" href="maillist.html#06229" id="i">
<link rel="prev" href="msg06228.html" id="p">
<link rel="next" href="msg06230.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06229.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Newbie+question+1%5C%2F3%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Newbie question 1/3</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeffrey+Massung%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeffrey Massung</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120110" rel="nofollow">Tue, 10 Jan 2012 13:57:47 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>

On Jan 10, 2012, at 2:46 PM, John DeTreville wrote:</pre><pre>

&gt; A related question. You say that if my n_val is 3, some data may reside only 
&gt; on 2 physical nodes. Ignoring failures, might some of it of reside on just 
&gt; one node?

That's a function of ring size and number of nodes in your cluster. For 
example, if you have a 1 node cluster and n_val is 3, obviously all 3 replicas 
will be on a single physical node.

Now, let's say you had a ring size of 8 and 3 physical nodes. When Riak 
partitions the ring and decides which nodes will act as the primary node for 
each partition, it will look something like this:

0 = dev1
1 = dev 2
2 = dev 3
3 = dev 1
4 = dev 2
5 = dev 3
6 = dev 1
7 = dev 2

Now, when we go to hash an object into the ring, it will end up going to one of 
those 8 partitions (0-7), and it will get replicated on partitions P+1 and P+2 
(for n_val = 3). For example, if an object were to get hashed to partition 0, 
then it would exist on partitions 0, 1, and 2, and be replicated on physical 
nodes dev1, dev2, and dev3.

But, as you can see, 8 (partitions) is not evenly divisible by 3 (nodes), so, 
if an object were to hash to partition 6 (or 7), where it would replicate two 
actually wraps around the ring to partitions 6, 7, and 0, being replicated on 
only 2 physical nodes (dev1 twice and dev2 once).

Throwing out really contrived cases to make the math work (ring size=1, 
n_val=1, # nodes=1, etc), and ignoring failures, then no, you shouldn't ever 
have a case where you specify n_val &gt; 2 and end up with a situation where all 
the replicas end up on a single, physical node.

--
Jeffrey Massung
Software Engineer
j...@basho.com
_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06228.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06229">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06229">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06230.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg06171.html">Newbie question 1/3</a></span> <span class="sender italic">John DeTreville</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06198.html">Re: Newbie question 1/3</a></span> <span class="sender italic">Jeffrey Massung</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06228.html">Re: Newbie question 1/3</a></span> <span class="sender italic">John DeTreville</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Newbie question 1/3</span> <span class="sender italic">Jeffrey Massung</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06230.html">Re: Newbie question 1/3</a></span> <span class="sender italic">John DeTreville</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Newbie question 1/3">
<input type="hidden" name="msgid" value="089FAEE9-5668-4EDE-A877-0AF863CB781B@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06229.html">
<input type="submit" value=" Jeffrey Massung ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Newbie+question+1%5C%2F3%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06228.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06230.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">089FAEE9-5668-4EDE-A877-0AF863CB781B@basho.com</li>
</ul>
</div>
</body>
</html>
