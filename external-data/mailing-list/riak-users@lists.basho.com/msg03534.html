<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Best practice for using erlang modules in riak?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#03534" id="c">
<link rel="index" href="maillist.html#03534" id="i">
<link rel="prev" href="msg03463.html" id="p">
<link rel="next" href="msg03535.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03534.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Best+practice+for+using+erlang+modules+in+riak%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Best practice for using erlang modules in riak?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Sylvain+Niles%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Sylvain Niles</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110602" rel="nofollow">Thu, 02 Jun 2011 13:00:41 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>So I've had a few helpful emails, but unfortunately I'm about to write
my own erlang HTTP server to call my erlang M/R functions because even
examples from the contrib section of the wiki just don't work.</pre><pre>

My last plea for help before we look at writing a replacement for
Riak's REST API:

a. Any documentation that shows how to properly deploy your erlang
code with the riak cluster (I'm currently writing a module, storing it
with riak_core, adding it to riak_core.app, and it's building fine,
can call it from riak console.)
b. The correct way to call an erlang function from the REST api or via
Ripple, specifically we are using the output of a Javascript Map to an
Erlang Reduce (If this is not supported, please let us know!)


Thanks in advance,
Sylvain Niles


On Fri, May 27, 2011 at 12:16 PM, Sylvain Niles &lt;sylvain.ni...@gmail.com&gt; wrote:
&gt; Still looking for advice on this, additionally I'm looking for the
&gt; correct way to call the erlang modules from Ripple. I've tried calling
&gt; it from a reduce like so:
&gt;
&gt; reduced = 
&gt; Riak::MapReduce.new(Ripple.client).add(a-bucket').map(&quot;function(v){return
&gt; [[v.values[0].data], [v.bucket, v.key]];}&quot;, :keep =&gt;
&gt; true).reduce([&quot;my_module&quot;,&quot;my_function&quot;], :keep =&gt; true).run
&gt;
&gt; and I can see that it never gets called, just returns [].
&gt;
&gt; I can call the module while attached to a Riak console in the cluster
&gt; and it works exactly as expected given the exact output of the
&gt; previous map: [[&quot;value&quot;], [&quot;bucket&quot;, &quot;key&quot;]]
&gt;
&gt; Any pointers would be greatly appreciated! If there's any open source
&gt; code out there using ripple in this fashion I'd love a pointer!
&gt;
&gt; Thanks,
&gt; -Sylvain
&gt;
&gt; On Tue, May 24, 2011 at 6:55 PM, Sylvain Niles &lt;sylvain.ni...@gmail.com&gt; 
&gt; wrote:
&gt;&gt; So I've seen a few well written examples of erlang map or reduce
&gt;&gt; functions in the contrib section of the wiki/github but the missing
&gt;&gt; piece of glue for me is: Where do I compile from? I've done a lot of
&gt;&gt; ejabberd development and generally I just throw it in the src
&gt;&gt; directory, add a config param to the ejabberd.conf to load my new
&gt;&gt; module at startup, make install, and I'm done. Should I be deploying
&gt;&gt; my modules to /deps/riak_core/src/?
&gt;&gt;
&gt;&gt; The wiki has this note:
&gt;&gt;
&gt;&gt; Distributing Erlang MapReduce Code
&gt;&gt;
&gt;&gt; Any modules and functions you use in your Erlang MapReduce calls must
&gt;&gt; be available on all nodes in the cluster. You can add them in Erlang
&gt;&gt; applications by specifying the -pz option in vm.args or by adding the
&gt;&gt; path to the add_paths setting in app.config.
&gt;&gt;
&gt;&gt; But the vm.args page does not list the valid config format/options for
&gt;&gt; the -pz option. Is the add_paths behavior such that a valid beam in
&gt;&gt; that dir will automatically be loaded on startup and all exported
&gt;&gt; functions available? What about live code updates of internally
&gt;&gt; developed modules?
&gt;&gt;
&gt;&gt; Thanks in advance!
&gt;&gt;
&gt;&gt; -Sylvain
&gt;&gt;
&gt;

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03463.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#03534">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#03534">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03535.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03400.html">Best practice for using erlang modules in riak?</a></span> <span class="sender italic">Sylvain Niles</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03460.html">Re: Best practice for using erlang modules in riak?</a></span> <span class="sender italic">Sylvain Niles</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03463.html">Re: Best practice for using erlang modules in riak?</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Best practice for using erlang modules in riak?</span> <span class="sender italic">Sylvain Niles</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03535.html">Re: Best practice for using erlang modules in r...</a></span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03537.html">Re: Best practice for using erlang modules ...</a></span> <span class="sender italic">Sylvain Niles</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03538.html">Re: Best practice for using erlang mod...</a></span> <span class="sender italic">Aphyr</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg03536.html">Re: Best practice for using erlang modules in r...</a></span> <span class="sender italic">Sean Cribbs</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Best practice for using erlang modules in riak?">
<input type="hidden" name="msgid" value="BANLkTi=CkWAqMdZrQ7Ch3tD=Vxv+jCSjZQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03534.html">
<input type="submit" value=" Sylvain Niles ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Best+practice+for+using+erlang+modules+in+riak%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03463.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03535.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">BANLkTi=CkWAqMdZrQ7Ch3tD=Vxv+jCSjZQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
