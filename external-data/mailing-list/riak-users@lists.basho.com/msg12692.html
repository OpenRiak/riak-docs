<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak consumes too much memory</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd8.html#12692" id="c">
<link rel="index" href="mail8.html#12692" id="i">
<link rel="prev" href="msg12691.html" id="p">
<link rel="next" href="msg12693.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12692.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+consumes+too+much+memory%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak consumes too much memory</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22darren%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">darren</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131018" rel="nofollow">Fri, 18 Oct 2013 11:10:23 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Is it smart enough to manage itself?
Or does it require human babysitting?
</pre><pre>

Sent from my Verizon Wireless 4G LTE Smartphone

-------- Original message --------
From: Matthew Von-Maszewski &lt;matth...@basho.com&gt; 
Date: 10/18/2013  1:48 PM  (GMT-05:00) 
To: Dave Martorana &lt;d...@flyclops.com&gt; 
Cc: darren &lt;dar...@ontrenet.com&gt;,riak-users@lists.basho.com 
Subject: Re: Riak consumes too much memory 
 
Dave,

flexcache will be a new feature in Riak 2.0.  There are some subscribers to 
this mailing list that like to download and try things early.  I was directing 
those subscribers to the GitHub branch that contains the work-in-progress code.

flexcache is a new method for sizing / accounting the memory used by leveldb.  
It replaces the current method completely.  flexcache is therefore not an 
option, but an upgrade to the existing logic.

Again, the detailed discussion is here:  
ttps://github.com/basho/leveldb/wiki/mv-flexcache

Matthew


On Oct 18, 2013, at 12:33 PM, Dave Martorana &lt;d...@flyclops.com&gt; wrote:

Matthew,

For we who don't quite understand, can you explain - does this mean 
mv-flexcache is a feature that just comes with 2.0, or is it something that 
will need to be turned on, etc?

Thanks!

Dave


On Thu, Oct 17, 2013 at 9:45 PM, Matthew Von-Maszewski &lt;matth...@basho.com&gt; 
wrote:
It is already in test and available for your download now:

<a  rel="nofollow" href="https://github.com/basho/leveldb/tree/mv-flexcache">https://github.com/basho/leveldb/tree/mv-flexcache</a>

Discussion is here:

<a  rel="nofollow" href="https://github.com/basho/leveldb/wiki/mv-flexcache">https://github.com/basho/leveldb/wiki/mv-flexcache</a>

This code is slated for Riak 2.0.  Enjoy!!

Matthew

On Oct 17, 2013, at 20:50, darren &lt;dar...@ontrenet.com&gt; wrote:

But why isn't riak smart enough to adjust itself to the available memory or 
lack thereof?

No serious enterprise technology should just consume everything and crash.


Sent from my Verizon Wireless 4G LTE Smartphone



-------- Original message --------
From: Matthew Von-Maszewski &lt;matth...@basho.com&gt; 
Date: 10/17/2013 8:38 PM (GMT-05:00) 
To: ZhouJianhua &lt;jh.z...@outlook.com&gt; 
Cc: riak-users@lists.basho.com 
Subject: Re: Riak consumes too much memory 


Greetings,

The default config targets 5 servers and 16 to 32G of RAM.  Yes, the app.config 
needs some adjustment to achieve happiness for you:

- change ring_creation_size from 64 to 16 (remove the % from the beginning of 
the line)
- add this line before &quot;{data_root, &lt;path&gt;}&quot; in eleveldb section: 
&quot;{max_open_files, 40},&quot; (be sure the comma is at the end of this line).

Good luck,
Matthew


On Oct 17, 2013, at 8:23 PM, ZhouJianhua &lt;jh.z...@outlook.com&gt; wrote:

Hi

I installed riak v1.4.2 on ubuntu12.04(64bit, 4G RAM) with apt-get, run it with 
default app.conf but change the backend to leveldb, and test it with 
<a  rel="nofollow" href="https://github.com/tpjg/goriakpbc">https://github.com/tpjg/goriakpbc</a> .

Just keep putting (key, value) to an bucket, the memory always increasing, and 
in the end it crashed, as it cannot allocate memory.

Should i change the configuration or other?
_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>



</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12691.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd8.html#12692">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail8.html#12692">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12693.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12681.html">Riak consumes too much memory</a></span> <span class="sender italic">ZhouJianhua</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12682.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">wjossey</span></li>
<li class="icons-email"><span class="subject"><a href="msg12683.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li class="icons-email"><span class="subject"><a href="msg12684.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Eric Redmond</span></li>
<li class="icons-email"><span class="subject"><a href="msg12685.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">darren</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12686.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">wjossey</span></li>
<li class="icons-email"><span class="subject"><a href="msg12687.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12689.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Dave Martorana</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12691.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak consumes too much memory</span> <span class="sender italic">darren</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12693.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12694.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Darren Govoni</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12695.html">Re: Riak consumes too much memory</a></span> <span class="sender italic">Matthew Von-Maszewski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12753.html">Re: Riak consumes too much mem...</a></span> <span class="sender italic">Dave Martorana</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak consumes too much memory">
<input type="hidden" name="msgid" value="79nb69723yj15y0bgh0oq6or.1382119692976@email.android.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12692.html">
<input type="submit" value=" darren ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+consumes+too+much+memory%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12691.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12693.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">79nb69723yj15y0bgh0oq6or.1382119692976@email.android.com</li>
</ul>
</div>
</body>
</html>
