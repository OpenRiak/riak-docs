<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak deployment</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd5.html#00882" id="c">
<link rel="index" href="mail5.html#00882" id="i">
<link rel="prev" href="msg00874.html" id="p">
<link rel="next" href="msg00883.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg00882.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+deployment%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak deployment</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Orlin+Bozhinov%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Orlin Bozhinov</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100813" rel="nofollow">Fri, 13 Aug 2010 11:45:59 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<tt>First of all, let's eliminate CouchDB.  Its WOL filesystem is irrelevant 
</tt><tt>for this is generated data.  If a document gets lost (for whatever 
</tt><tt>reason) - it can be regenerated.  Topmost though, CouchDB can't run 
</tt><tt>dynamic queries.  That's what the field indexes are for.  MongoDB is 
</tt><tt>happy to store &amp; query my data.  The assumption is that &quot;Riak Search&quot; 
</tt><tt>will also be able to search it, once released.  Is there a reason to 
</tt><tt>think MongoDB will be better than Riak for range search (indexed floats)?
</tt><pre style="margin: 0em;">

My reasons for using Riak:</pre><pre>

</pre><tt>* will use it for other buckets anyway (hence reuse of skills &amp; 
</tt><tt>infrastructure)
</tt><tt>* would like to add the &quot;distributed redundancy&quot; as soon as I can afford 
</tt><tt>more servers for the #bigdata bucket
</tt><tt>* can postpone search until end of this Q3 (as advertised) or Q4, 
</tt><tt>perhaps even longer
</tt><tt>* the dataset will eventually expand to be very much bigger (real big) 
</tt><tt>and I rather not shard
</tt><pre style="margin: 0em;">

</pre><tt>I'm sure the &quot;cannot tell riak where to place buckets&quot; can be worked 
</tt><tt>around...  I have some ideas, please tell me which are possible and 
</tt><tt>which are recommended:
</tt><pre style="margin: 0em;">

</pre><tt>1. I write directly to the big node (rather than through a 
</tt><tt>load-balancing proxy) - would it pass this data to other nodes for a 
</tt><tt>bucket of N=1?
</tt><tt>2. I detach the big node from the cluster when writing, temporarily 
</tt><tt>falling back to a 2 node cluster and a solo node.  This can happen 
</tt><tt>during (the relatively safer) western nighttime (which is my daytime) 
</tt><tt>and things will be monitored closely.  Once the node joins back into the 
</tt><tt>cluster, would it have reasons to move any of the big bucket data to the 
</tt><tt>other small nodes?
</tt><tt>3. Can I run 2 instances (nodes) of Riak on the big server?  One for the 
</tt><tt>cluster of 3 nodes (little data).  And one (single node cluster) for the 
</tt><tt>big data bucket.
</tt><tt>4. I'd rather save $240 / year (one less Linode 512) -- but it's no big 
</tt><tt>deal to spend either.  After I do the big upgrades (some day) - are 
</tt><tt>there tools to migrate the big bucket from the solo node cluster (into 
</tt><tt>the other cluster)?
</tt><pre style="margin: 0em;">

</pre><tt>I basically want to keep the big data isolated in any way possible.  If 
</tt><tt>something goes terribly wrong (e.g. corrupt bucket or server explodes?) 
</tt><tt>- no harm done to me.  I just boot a fresh instance / node form backup.  
</tt><tt>Whatever state the big data was (when last backed up) is always good 
</tt><tt>enough for this kind of data.
</tt><pre style="margin: 0em;">

</pre><tt>The order I listed these in - is my preferred order.  Separate clusters 
</tt><tt>(#3 or #4) is last option, because (ideally) I'd like to be able to link 
</tt><tt>to the big bucket (though I probably shouldn't link until there's 
</tt><tt>redundancy for that data).  But since I can't think of any good reasons 
</tt><tt>- maybe it's better to run separate clusters for starters, and merge 
</tt><tt>them in the future?  Would Riak let me do #1 or #2?  Or perhaps there is 
</tt><tt>a better way?
</tt><pre style="margin: 0em;">

Orlin


Alexander Sicular wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
- You can not tell riak where to place buckets.
- You could set the N val on a bucket to one, and you should in the case of 
your 'big bucket'. Otherwise you will get N replicas on the same physical host.
-Use linode. 512&gt;  256 = better.

But in reality , your use case doesnt mesh well with what riak is all about. 
distributed redundancy. I would use couchdb for your 'big bucket' of data. 
Couch uses a write only log (wol) filesystem with an incremental b-tree index 
for map reduce. This may work better for you.

-Alexander

On Aug 12, 2010, at 6:44 AM, Orlin Bozhinov wrote:

</pre><tt>   
</tt><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
I can easily wait for Riak Search to do this 
<a  rel="nofollow" href="http://groups.google.com/group/mongodb-user/browse_thread/thread/c2563a8566591a30/b3d19f21675a899e">http://groups.google.com/group/mongodb-user/browse_thread/thread/c2563a8566591a30/b3d19f21675a899e</a>
 - instead of mongodb.  Does this deployment I have in mind make sense:

I'll get a medium (or large) Linode box for the big dataset bucket.  Hopefully you can 
give me an idea about how much RAM I'll need for that.  This is batch-generated data.  It 
takes time to generate, but (once added) it will not change.  Because of that I'd like to 
save some money and not replicate it.  I plan to have 2 other small Linode servers and 
run a Riak cluster of 3.  Can I tell Riak to keep the big bucket exclusively on the big 
server?  It will be used only for queries.  So if the server crashes, I can just reboot 
it, expecting the same data back up.  Because it's a single-node bucket (if that's even 
possible to have in a cluster), I probably still won't be &quot;linking&quot; to it from 
other buckets (so when it fails, the impact is minimal).  Or maybe I should keep it in a 
separate (single node) cluster anyway?

Cluster separation means I can run the smaller cluster elsewhere.  The Joyent + 
Riak news is very exciting!  I couldn't afford to put the big bucket dataset on it 
(another reason to have 2 clusters) and I'd have to go with the smallest 
SmartMachines for starters.  Would 256 MB RAM be good enough (just for Riak)?  
What kind of load can that handle?  I'm also tempted to just run everything on 
Linode.  It's about 3 times cheaper (as far memory goes) and the upgrades are less 
dramatic.  Would you recommend that (for low-budget)?  I imagine there will be an 
easy (Linode -&gt;  Joyent) Riak migration path...

Orlin

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre><tt>     
</tt></blockquote><pre style="margin: 0em;">

</pre><tt>   
</tt></blockquote><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg00874.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd5.html#00882">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail5.html#00882">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg00883.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg00871.html">riak deployment</a></span> <span class="sender italic">Orlin Bozhinov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00874.html">Re: riak deployment</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak deployment</span> <span class="sender italic">Orlin Bozhinov</span></li>
<li class="icons-email"><span class="subject"><a href="msg00883.html">Re: riak deployment</a></span> <span class="sender italic">Jason J. W. Williams</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak deployment">
<input type="hidden" name="msgid" value="4C6592DC.20701@soundsapiens.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg00882.html">
<input type="submit" value=" Orlin Bozhinov ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+deployment%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg00874.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg00883.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">4C6592DC.20701@soundsapiens.com</li>
</ul>
</div>
</body>
</html>
