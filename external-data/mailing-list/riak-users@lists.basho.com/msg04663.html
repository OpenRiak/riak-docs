<!DOCTYPE html>
<html lang="en">
<head>
<title>Question from a noob about link walking</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#04663" id="c">
<link rel="index" href="mail3.html#04663" id="i">
<link rel="prev" href="msg04651.html" id="p">
<link rel="next" href="msg04671.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04663.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Question+from+a+noob+about+link+walking%22&amp;o=newest" rel="nofollow"><span itemprop="name">Question from a noob about link walking</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Antonio+Fern%C3%A1ndez+Vara%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Antonio Fernández Vara</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110912" rel="nofollow">Mon, 12 Sep 2011 01:12:18 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi,

I'm using Ruby and I'm trying to learn how to use Riak basics, now I'm
learning links and I have a question I know will be so easy to answer by
you, experts :).</pre><pre>

I know how to search with a simple MapReduce query what items I'm linking,
but now the opposite, what items links me.

As little concept I've made this simple script, just it creates 10 items in
a bucket, 20 relations as follow, 20 as like (I don't try to do the next
graph thing, just was the first tags that come to my brain):   (BTW: I have
tryed to find how this is done in ripple but seems I need to study more to
obtain the answer looking the code Sean wrote).

As you can see, I just create those 10 items in the bucket (1..10) and
randomly add the relations. The mapreduce function works showing me all the
links in each relation for each object in the last iteration.

Now, I'm trying to find how to get the reverse.

Thank you in advance. Hope someone can get some time and help me.

-- test-creator.rb --
require 'rubygems'
require 'riak'

client = Riak::Client.new
client.http_port = 8091

bucket_name = &quot;users8&quot; #change for test in different bucket

bucket = client.bucket(bucket_name)

10.times do |n|
  o = bucket.new(&quot;#{n + 1}&quot;)
  o.data = &quot;#{n + 1}&quot;
  o.store
end

20.times do |n|
  source = rand(10) + 1
  destination = rand(10) + 1
  puts &quot;#{source} --&gt; follow --&gt; #{destination}&quot;
  o = bucket[&quot;#{source}&quot;]
  o.links &lt;&lt; Riak::Link.new(bucket_name, destination, 'follow')
  o.store
end

20.times do |n|
  source = rand(10) + 1
  destination = rand(10) + 1
  puts &quot;#{source} --&gt; like --&gt; #{destination}&quot;
  o = bucket[&quot;#{source}&quot;]
  o.links &lt;&lt; Riak::Link.new(bucket_name, destination, 'like')
  o.store
end

10.times do |n|
  results = Riak::MapReduce.new(client).add(bucket_name, &quot;#{n +
1}&quot;).link(:bucket =&gt; bucket_name, :tag =&gt; 'follow').map(&quot;function(v) {
return [JSON.parse(v.values[0].data)]; }&quot;, :keep =&gt; true).run
  puts &quot;follow #{n + 1} = &quot;
  p results
  results = Riak::MapReduce.new(client).add(bucket_name, &quot;#{n +
1}&quot;).link(:bucket =&gt; bucket_name, :tag =&gt; 'like').map(&quot;function(v) { return
[JSON.parse(v.values[0].data)]; }&quot;, :keep =&gt; true).run
  puts &quot;like #{n + 1} = &quot;
  p results
end
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04651.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#04663">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail3.html#04663">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04671.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Question from a noob about link walking</span> <span class="sender italic">Antonio Fernández Vara</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04671.html">Re: Question from a noob about link walking</a></span> <span class="sender italic">Dan Reverri</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Question from a noob about link walking">
<input type="hidden" name="msgid" value="CAE=9bX53p2jjwbS3XhWU1JU=k=hXmpkeWrjddd28eY7rj03Dow@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04663.html">
<input type="submit" value=" Antonio Fernández Vara ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Question+from+a+noob+about+link+walking%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04651.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04671.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAE=9bX53p2jjwbS3XhWU1JU=k=hXmpkeWrjddd28eY7rj03Dow@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
