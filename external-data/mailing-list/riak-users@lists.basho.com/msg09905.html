<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: about hash calculation in reference page at docs.basho.com</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09905" id="c">
<link rel="index" href="maillist.html#09905" id="i">
<link rel="prev" href="msg09877.html" id="p">
<link rel="next" href="msg09910.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09905.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+about+hash+calculation+in+reference+page+at+docs.basho.com%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: about hash calculation in reference page at docs.basho.com</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Charlie+Voiselle%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Charlie Voiselle</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130128" rel="nofollow">Mon, 28 Jan 2013 15:27:48 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Donald:

Since we are traversing the ring in a clockwise fashion, the data is written 
into the next partition you would run into moving forward.  You can see how the 
partitions are chosen in chash:ordered_from/2 at 
<a  rel="nofollow" href="https://github.com/basho/riak_core/blob/master/src/chash.erl#L138">https://github.com/basho/riak_core/blob/master/src/chash.erl#L138</a>.  The 
preference list is built using the partitions that come after the hashed value.</pre><pre>

If you consider the partition's name to be the end value that the partition 
holds, the an object that hashes to 
1045375627425331784151332358177649483819648417632 being assigned to 
1096126227998177188652763624537212264741949407232 makes sense. That partition 
would hold items that hash from 
913438523331814323877303020447676887284957839361 to 
1096126227998177188652763624537212264741949407232


Does this help?

Thanks,
Charlie Voiselle


On Jan 24, 2013, at 12:05 AM, Donald Yan &lt;dyan....@gmail.com&gt; wrote:

&gt; Hi there,
&gt; 
&gt; I'm reading this page at 
&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/references/appendices/concepts/Replication/#Understanding-replication-by-example">http://docs.basho.com/riak/latest/references/appendices/concepts/Replication/#Understanding-replication-by-example</a>
&gt;  and have a question about the example given in the page.  I quote it here:
&gt; &quot;
&gt; The DocIdx hash is a 160 bit integer:
&gt; 
&gt; (dev1@127.0.0.1)5&gt; &lt;&lt;I:160/integer&gt;&gt; = DocIdx.
&gt; &lt;&lt;183,28,67,173,80,128,26,94,190,198,65,15,27,243,135,127,121,101,255,96&gt;&gt;
&gt; (dev1@127.0.0.1)6&gt; I.
&gt; 1045375627425331784151332358177649483819648417632
&gt; The node looks up the hashed key in the ring which returns a list of 
&gt; “preferred” partitions for the given key.
&gt; 
&gt; (node1@127.0.0.1)&gt; Preflist = riak_core_ring:preflist(DocIdx, Ring).
&gt; [{1096126227998177188652763624537212264741949407232, 'dev1@127.0.0.1'},
&gt; {1278813932664540053428224228626747642198940975104, 'dev2@127.0.0.1'},
&gt; {0, 'dev1@127.0.0.1'},
&gt; {182687704666362864775460604089535377456991567872, 'dev2@127.0.0.1'},
&gt; {365375409332725729550921208179070754913983135744, 'dev3@127.0.0.1'},
&gt; {548063113999088594326381812268606132370974703616, 'dev1@127.0.0.1'},
&gt; {730750818665451459101842416358141509827966271488, 'dev2@127.0.0.1'},
&gt; {913438523331814323877303020447676887284957839360, 'dev3@127.0.0.1'}]
&gt; 
&gt; &quot;
&gt; 
&gt; I question is since the key is  calculated as 
&gt; &quot;1045375627425331784151332358177649483819648417632&quot;, shouldn't the prefer 
&gt; list be like the following instead?
&gt; &quot;
&gt; [{913438523331814323877303020447676887284957839360, 'dev3@127.0.0.1'},
&gt; {1096126227998177188652763624537212264741949407232, 'dev1@127.0.0.1'},
&gt; {1278813932664540053428224228626747642198940975104, 'dev2@127.0.0.1'},
&gt; {0, 'dev1@127.0.0.1'},
&gt; {182687704666362864775460604089535377456991567872, 'dev2@127.0.0.1'},
&gt; {365375409332725729550921208179070754913983135744, 'dev3@127.0.0.1'},
&gt; {548063113999088594326381812268606132370974703616, 'dev1@127.0.0.1'},
&gt; {730750818665451459101842416358141509827966271488, 'dev2@127.0.0.1'}]
&gt; &quot;
&gt; because value &quot;1045375627425331784151332358177649483819648417632&quot; falls 
&gt; between 913438523331814323877303020447676887284957839360 (partition 5) and 
&gt; 1096126227998177188652763624537212264741949407232 (partition 6)?
&gt; 
&gt; Please Riak experts help to clear my confusion here.  Why partition 6, 7, 0 
&gt; are on the top 3 of the list?
&gt; 
&gt; Appreciate in advance.
&gt; 
&gt; 
&gt; -donald
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09877.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09905">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09905">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09910.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg09877.html">about hash calculation in reference page at docs.basho.co...</a></span> <span class="sender italic">Donald Yan</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: about hash calculation in reference page at docs...</span> <span class="sender italic">Charlie Voiselle</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09910.html">Re: about hash calculation in reference page at ...</a></span> <span class="sender italic">Donald Yan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09912.html">Re: about hash calculation in reference page...</a></span> <span class="sender italic">Charlie Voiselle</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09969.html">Re: about hash calculation in reference ...</a></span> <span class="sender italic">Donald Yan</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: about hash calculation in reference page at docs.basho.com">
<input type="hidden" name="msgid" value="70DD0FCA-0FF3-4807-AEE6-44522A12C2BA@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09905.html">
<input type="submit" value=" Charlie Voiselle ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+about+hash+calculation+in+reference+page+at+docs.basho.com%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09877.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09910.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">70DD0FCA-0FF3-4807-AEE6-44522A12C2BA@basho.com</li>
</ul>
</div>
</body>
</html>
