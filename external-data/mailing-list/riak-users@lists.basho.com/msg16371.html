<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Rolling upgrade from 1.4.2 to 2.0.5</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#16371" id="c">
<link rel="index" href="maillist.html#16371" id="i">
<link rel="prev" href="msg16370.html" id="p">
<link rel="next" href="msg16403.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg16371.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Rolling+upgrade+from+1.4.2+to+2.0.5%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Rolling upgrade from 1.4.2 to 2.0.5</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Dmitri+Zagidulin%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Dmitri Zagidulin</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20150806" rel="nofollow">Thu, 06 Aug 2015 06:13:15 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Sujay,

You're right - the best way to verify the backup is to bring up a separate
5 node cluster, and restore it from the backup files.
The procedure is slightly more involved than untar-ing, though. The backed
up ring directories from the original cluster will contain the node ids
(which rely on their IP addresses, etc). Since the new re-hydrated cluster
is likely to have different IPs from the original one, there's a few more
steps you need to take.</pre><pre>

The procedure of standing up a new cluster from backups is outlined here:
<a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/running/nodes/renaming/#Clusters-from-Backups">http://docs.basho.com/riak/latest/ops/running/nodes/renaming/#Clusters-from-Backups</a>

There is one other important step to remember. If, by any chance, you're
bringing up the new cluster on the same network as the old cluster is
running on, be sure to modify the Erlang cookie in the new cluster (so that
as far as Erlang is concerned, they're existing on different networks).
The Erlang cookie must be modified in /etc/riak/riak.conf so the new
cluster does not conflict with any existing cluster.

Let us know if you have any further questions.

Dmitri

On Thu, Aug 6, 2015 at 8:40 AM, Sujay Mansingh &lt;su...@editd.com&gt; wrote:

&gt; Thanks Magnus &amp; John.
&gt;
&gt; Yes certainly I will test it on a separate cluster first! Which is related
&gt; to another question I have.
&gt;
&gt; If I want to backup I can archive the directories on the nodes as
&gt; described here:
&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/running/backups/#OS-Specific-Directory-Locations">http://docs.basho.com/riak/latest/ops/running/backups/#OS-Specific-Directory-Locations</a>
&gt;
&gt; But in order to verify the backup (or perform operations on the cluster in
&gt; 'offline' mode), can I simply bring up a separate 5 node cluster and untar
&gt; the backup files?
&gt; (Probably not the /etc/riak directory, but the data and ring directories.)
&gt;
&gt; I want to do that, and then try adding a riak 2.0.6 node to the test riak
&gt; 1.4.2 cluster and see if things are ok.
&gt;
&gt; Thanks,
&gt;
&gt; Sujay
&gt;
&gt; On Thu, Aug 6, 2015 at 9:31 AM, Magnus Kessler &lt;mkess...@basho.com&gt; wrote:
&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On 5 August 2015 at 18:53, John Daily &lt;jda...@basho.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; That’s correct: upgrades to either 2.0.x or 2.1.x are supported from the
&gt;&gt;&gt; 1.4 series.
&gt;&gt;&gt;
&gt;&gt;&gt; Side note: I definitely recommend testing the upgrade process in a QA
&gt;&gt;&gt; environment first.
&gt;&gt;&gt;
&gt;&gt;&gt; -John
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; Hi Sujay,
&gt;&gt;
&gt;&gt; The latest release in the 2.0 series is 2.0.6 [0]. Please use this
&gt;&gt; version if you upgrade to 2.0.
&gt;&gt;
&gt;&gt; Please also review the documentation about the new 'riak.conf'
&gt;&gt; configuration file [1][2]. 2.x installations should use the new format, but
&gt;&gt; you can continue to use the 'app.config' format from Riak 1.x. To maintain
&gt;&gt; complete backwards compatibility when using 'app.config', please add
&gt;&gt;
&gt;&gt; [{default_bucket_props,
&gt;&gt;   [{allow_mult,false}, %% have Riak resolve conflicts and do not return 
&gt;&gt; siblings
&gt;&gt;   {dvv_enabled,false}]}, %% use vector clocks for conflict resolution
&gt;&gt;   %% other settings
&gt;&gt; ]
&gt;&gt;
&gt;&gt; to 'app.config'. This will ensure that your existing application
&gt;&gt; continues to work exactly as before. When using 'riak.conf', these settings
&gt;&gt; will be applied automatically.
&gt;&gt;
&gt;&gt;
&gt;&gt; Magnus
&gt;&gt;
&gt;&gt; [0] <a  rel="nofollow" href="http://docs.basho.com/riak/2.0.6/downloads/">http://docs.basho.com/riak/2.0.6/downloads/</a>
&gt;&gt; [1]
&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/intro-v20/#Simplified-Configuration-Management">http://docs.basho.com/riak/latest/intro-v20/#Simplified-Configuration-Management</a>
&gt;&gt; [2]
&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/advanced/configs/configuration-files/">http://docs.basho.com/riak/latest/ops/advanced/configs/configuration-files/</a>
&gt;&gt;
&gt;&gt; On Aug 5, 2015, at 12:13 PM, Sujay Mansingh &lt;su...@editd.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Hello all, I have a 5 node riak cluster, all nodes running 1.4.2.
&gt;&gt;&gt;
&gt;&gt;&gt; I want to upgrade to riak 2.x
&gt;&gt;&gt;
&gt;&gt;&gt; According to this:
&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/upgrading/rolling-upgrades/">http://docs.basho.com/riak/latest/ops/upgrading/rolling-upgrades/</a> I can
&gt;&gt;&gt; perform a rolling upgrade (a mixed cluster)
&gt;&gt;&gt; as long as the versions aren't more than 2 versions apart.
&gt;&gt;&gt;
&gt;&gt;&gt; There is no riak 1.5 so would riak 1.4.2 -&gt; 2.0.5 count as 1 version
&gt;&gt;&gt; apart?
&gt;&gt;&gt;
&gt;&gt;&gt; Sujay
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Magnus Kessler
&gt;&gt; Client Services Engineer @ Basho
&gt;&gt;
&gt;&gt; Registered Office - 8 Lincoln’s Inn Fields London WC2A 3BP Reg 07970431
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg16370.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#16371">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#16371">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg16403.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg16363.html">Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16364.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16368.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Magnus Kessler</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16370.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Rolling upgrade from 1.4.2 to 2.0.5</span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16403.html">Re: Rolling upgrade from 1.4.2 to 2...</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16404.html">Re: Rolling upgrade from 1.4.2 ...</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16405.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16451.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li class="icons-email"><span class="subject"><a href="msg16452.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16456.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li class="icons-email"><span class="subject"><a href="msg16460.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16463.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li class="icons-email"><span class="subject"><a href="msg16464.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16474.html">Re: Rolling upgrade from 1....</a></span> <span class="sender italic">Sujay Mansingh</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Rolling upgrade from 1.4.2 to 2.0.5">
<input type="hidden" name="msgid" value="CA+TO3kVukSVQsqHagY0yZj6onbx+s_hefhK9DhNuCanThsCQhA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg16371.html">
<input type="submit" value=" Dmitri Zagidulin ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Rolling+upgrade+from+1.4.2+to+2.0.5%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg16370.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg16403.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CA+TO3kVukSVQsqHagY0yZj6onbx+s_hefhK9DhNuCanThsCQhA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
