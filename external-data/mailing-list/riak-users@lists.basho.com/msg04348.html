<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: High volume data series storage and queries</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04348" id="c">
<link rel="index" href="maillist.html#04348" id="i">
<link rel="prev" href="msg04345.html" id="p">
<link rel="next" href="msg04271.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04348.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+High+volume+data+series+storage+and+queries%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: High volume data series storage and queries</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeremiah+Peschka%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeremiah Peschka</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110811" rel="nofollow">Thu, 11 Aug 2011 09:03:05 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>On Aug 11, 2011, at 7:49 AM, Paul O wrote:

&gt; However, I'm still a bit in the dark regarding some aspects of storing
&gt; everything in one big database. Are these records stored in an &quot;append
&gt; only&quot; fashion? If they are, then how can the range query be done
&gt; without considering potentially a huge number of records? If they are
&gt; not &quot;append only&quot; then the DB might have to shuffle data around which
&gt; would degrade performance or store an index.</pre><pre>

Having one monolithic table could result in a lot of random reads since data 
will likely be written in insertion order. With appropriate indexing, you can 
reduce the randomness considerably. In a worst case scenario your database will 
effectively say &quot;Up yours, I'm not doing this many random reads, it's going to 
be cheaper to scan the whole table.&quot;

&gt; 
&gt; Anyway, I'll read some more on this, it's probably just my ignorance
&gt; regarding how those databases work, but if the DBs can be append-only
&gt; then I need one DB per data source and even then I have to contend
&gt; with data insertions in the past (a requirement which I hope I made
&gt; explicit in previous emails.) And if I have to use multiple DBs are
&gt; these solutions able to juggle multiple DBs, open/close them quickly,
&gt; etc.?

This depends a lot on your database back end. Both Oracle and PostgreSQL don't 
have any physical insertion order other than the order the rows come in - they 
use append only structures on disk. PostgreSQL compounds this by storing 
different versions of the row in the main table (e.g. if there is a 
modification). 

SQL Server and MySQL use index ordered tables, Oracle can be told to do this on 
a table by table basis. An index ordered table is often referred to as a table 
with a clustered index. Ciprian mentioned that a few times in his benchmark.

A good fit solution to your problem would be to create a single table per data 
source and instruct the database to leave a bit of extra space on each data 
page (by setting a fill factor around 80% or so). That gives you some room for 
inserts of historical records. You'd want to adjust your fill factor as real 
world usage evolves. By putting each data source in a separate physical table, 
you can do a lot of interesting things with storage techniques and whatnot, but 
you also get the advantage of only having to perform reads on a single table at 
a time to get data from any given source. With a monolithic table, you can run 
into all kinds of problems with data statistics and accurately predicting the 
kind of data access you need, especially as your database grows in size.

If you need to perform analytical queries across all of your data, you can 
always build views to help you out there, too.

All of these features vary slightly from vendor to vendor, and some of them 
even have specific features to make this kind of design easier to implement and 
administer. This is why Ciprian and I were talking about an RDBMS solution 
requiring domain specific knowledge of a single product/vendor. The advantage 
of something like Riak is that you stand up some nodes and you're going to get 
relatively predictable performance. 

I hate to scare you off from any solution, but Ciprian has experience building 
this on top of Riak core and I have experience building this solution on top of 
an RDBMS.

&gt; 
&gt; I hope I'm not too off-list-topic with this and hope at least some
&gt; other people find the discussion useful.

I find data storage systems to be fascinating :)

&gt; 
&gt; Regards,
&gt; 
&gt; Paul
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
 Microsoft SQL Server MVP


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04345.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04348">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04348">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04271.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li><ul>
<li><ul>
<li><ul>
<li><ul>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04310.html">Re: High volume data series st...</a></span> <span class="sender italic">Paul O</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg04260.html">Re: High volume data series storage and queries</a></span> <span class="sender italic">Ciprian Dorin Craciun</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04266.html">Re: High volume data series storage and queries</a></span> <span class="sender italic">Paul O</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04304.html">Re: High volume data series storage and que...</a></span> <span class="sender italic">Ciprian Dorin Craciun</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04313.html">Re: High volume data series storage and...</a></span> <span class="sender italic">Paul O</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04314.html">Re: High volume data series storage...</a></span> <span class="sender italic">Ciprian Dorin Craciun</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04317.html">Re: High volume data series st...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04320.html">Re: High volume data serie...</a></span> <span class="sender italic">Ciprian Dorin Craciun</span></li>
<li class="icons-email"><span class="subject"><a href="msg04321.html">Re: High volume data serie...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg04345.html">Re: High volume data series st...</a></span> <span class="sender italic">Paul O</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: High volume data serie...</span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: High volume data series storage and queries">
<input type="hidden" name="msgid" value="E1BC3530-1338-498F-9E8A-9095DF624A29@gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04348.html">
<input type="submit" value=" Jeremiah Peschka ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+High+volume+data+series+storage+and+queries%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04345.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04271.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">E1BC3530-1338-498F-9E8A-9095DF624A29@gmail.com</li>
</ul>
</div>
</body>
</html>
