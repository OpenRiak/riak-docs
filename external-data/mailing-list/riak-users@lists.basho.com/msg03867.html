<!DOCTYPE html>
<html lang="en">
<head>
<title>RE: Mysterious JavaScript MapReduce crashes and timeouts with 0.14.2</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#03867" id="c">
<link rel="index" href="maillist.html#03867" id="i">
<link rel="prev" href="msg03860.html" id="p">
<link rel="next" href="msg03817.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03867.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22RE%5C%3A+Mysterious+JavaScript+MapReduce+crashes+and+timeouts+with+0.14.2%22&amp;o=newest" rel="nofollow"><span itemprop="name">RE: Mysterious JavaScript MapReduce crashes and timeouts with 0.14.2</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22David+Mitchell%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">David Mitchell</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110629" rel="nofollow">Wed, 29 Jun 2011 07:54:42 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Mathias,

Thank you for your thoughtful replies.</pre><pre>

While Erlang code looks a bit odd to me, it probably would not be too difficult 
to write a few jobs in Erlang.

Sometimes, I do not see any timeouts.  Other times, I see one or two timeouts 
out of 100 MapReduce jobs.  The biggest problem is that sometimes the beam 
process will terminate due to timeout errors.  This type of error is 
unrecoverable.  If using JavaScript MapReduce makes Riak prone to crashing, 
this is a good reason to abandon JavaScript MapReduce for data processing.

I suspect that the problem of MapReduce timeouts is related to the &quot;extra 
overhead&quot; of using of the SpiderMonkey JavaScript engine, but I would need to 
do more testing to come to a more firm conclusion.

David


-----Original Message-----
From: Mathias Meyer [<a  rel="nofollow" href="mailto:math...@basho.com">mailto:math...@basho.com</a>] 
Sent: Wednesday, June 29, 2011 4:25 AM
To: David Mitchell
Cc: riak-users@lists.basho.com
Subject: Re: Mysterious JavaScript MapReduce crashes and timeouts with 0.14.2


On Samstag, 25. Juni 2011 at 00:23, David Mitchell wrote:

&gt; Hi Mathias,
&gt; 
&gt; Thank you for responding, and give me things to try.
&gt; 
&gt; I am testing Raik using a hypervisor, so each node only has one CPU and 1.5 
&gt; GB of RAM. I have 222,526 total keys stored.
&gt;

 
I'd suggest testing your setup on something other than a hypervisor'd setup of 
virtual machines to get a good picture of performance, especially at this 
memory and machine size.


&gt; Correct me if I am mistaken, but if we want to use Riak for data processing 
&gt; via MapReduce, we should abandon JavaScript and opt for Erlang. This is my 
&gt; first take away. Second, use Riak Search rather than key filters to do range 
&gt; queries.
&gt;

 
Considering your key filter setup, yes, you should be using Riak Search instead 
to prefilter your MapReduce inputs. As for MapReduce itself, it's well worth 
looking into Erlang, because it avoids a lot of overhead involved with 
JavaScript MapReduce. I wouldn't hold it generally true to always go for Erlang 
for more intensive MapReducing, it just depends on how often you run your 
queries and what execution speed expectations you have of them. In your case 
I'd say it'd be well worth looking into Erlang as an alternative.

Mathias Meyer
Developer Advocate, Basho Technologies




_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03860.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#03867">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#03867">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03817.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03816.html">Mysterious JavaScript MapReduce crashes and timeouts with 0...</a></span> <span class="sender italic">David Mitchell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03818.html">Re: Mysterious JavaScript MapReduce crashes and timeou...</a></span> <span class="sender italic">Mathias Meyer</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03821.html">RE: Mysterious JavaScript MapReduce crashes and ti...</a></span> <span class="sender italic">David Mitchell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03860.html">Re: Mysterious JavaScript MapReduce crashes an...</a></span> <span class="sender italic">Mathias Meyer</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">RE: Mysterious JavaScript MapReduce crashe...</span> <span class="sender italic">David Mitchell</span></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg03817.html">Re: Mysterious JavaScript MapReduce crashes and timeou...</a></span> <span class="sender italic">David Mitchell</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="RE: Mysterious JavaScript MapReduce crashes and timeouts with 0.14.2">
<input type="hidden" name="msgid" value="66F8E97DB33472418E78DD25BB4E281D0FA160CF63@MBX.IXIHQ.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03867.html">
<input type="submit" value=" David Mitchell ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22RE%5C%3A+Mysterious+JavaScript+MapReduce+crashes+and+timeouts+with+0.14.2%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03860.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03817.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">66F8E97DB33472418E78DD25BB4E281D0FA160CF63@MBX.IXIHQ.com</li>
</ul>
</div>
</body>
</html>
