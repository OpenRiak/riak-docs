<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak-admin member_status ambiguous with Riak 1.0.2</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd5.html#05986" id="c">
<link rel="index" href="mail5.html#05986" id="i">
<link rel="prev" href="msg05982.html" id="p">
<link rel="next" href="msg05987.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05986.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak%5C-admin+member_status+ambiguous+with+Riak+1.0.2%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak-admin member_status ambiguous with Riak 1.0.2</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeffrey+Massung%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeffrey Massung</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111218" rel="nofollow">Sun, 18 Dec 2011 11:28:37 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Zheng,

A 'down' status for a node is different from &quot;unreachable&quot; or &quot;partitioned&quot;. 
It's quite possible (to the node you are running riak-admin from) that dev2 and 
dev3 are still actively up and running, but not partitioned from the rest of 
the cluster due to other networking reasons.</pre><pre>

When at least one node is partitioned from the rest of the cluster, various 
ring membership actions cannot be performed. For example, you can't add or 
remove a node from the cluster. When you - the admin - know that a node has 
crashed, gone offline, or will be partitioned from the rest of the ring for a 
prolonged period of time, you can mark a given node as 'down' using riak-admin:

$ riak-admin down dev2@127.0.0.1
Success: &quot;dev2@127.0.0.1&quot; marked as down

$ riak-admin member_status
Status     Ring    Pending    Node
--------------------------
down      100.0%      --      'dev2@127.0.0.1'
valid       0.0%      --      'dev1@127.0.0.1'
---------------------------
Valid:1 / Leaving:0 / Exiting:0 / Joining:0 / Down:1

Notice now how there is one node 'valid' and another 'down'. Once dev2 is no 
longer partitioned from the rest of the cluster, it will automatically have its 
status changed back to 'valid'.

Hope this helps,

--
Jeff Massung
Basho Technologies, Inc.

On Dec 18, 2011, at 9:21 AM, Zheng Zhibin wrote:

&gt; Dear all,
&gt; 
&gt; There is a problem of riak-admin member_status I found, please find my 
&gt; actions below:
&gt; 
&gt; [一 12 19 zhengzhibin@ZhengmatoMacBook-Air ~/riak/dev]$dev1/bin/riak-admin 
&gt; member_status
&gt; ================================= Membership 
&gt; ==================================
&gt; Status     Ring    Pending    Node
&gt; -------------------------------------------------------------------------------
&gt; valid      34.4%      --      'dev1@127.0.0.1'
&gt; valid      32.8%      --      'dev2@127.0.0.1'
&gt; valid      32.8%      --      'dev3@127.0.0.1'
&gt; -------------------------------------------------------------------------------
&gt; Valid:3 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt; [一 12 19 zhengzhibin@ZhengmatoMacBook-Air ~/riak/dev]$dev2/bin/riak ping
&gt; Node 'dev2@127.0.0.1' not responding to pings.
&gt; [一 12 19 zhengzhibin@ZhengmatoMacBook-Air ~/riak/dev]$dev3/bin/riak ping
&gt; Node 'dev3@127.0.0.1' not responding to pings.
&gt; [一 12 19 zhengzhibin@ZhengmatoMacBook-Air ~/riak/dev]$dev1/bin/riak-admin 
&gt; member_status
&gt; ================================= Membership 
&gt; ==================================
&gt; Status     Ring    Pending    Node
&gt; -------------------------------------------------------------------------------
&gt; valid      34.4%      --      'dev1@127.0.0.1'
&gt; valid      32.8%      --      'dev2@127.0.0.1'
&gt; valid      32.8%      --      'dev3@127.0.0.1'
&gt; -------------------------------------------------------------------------------
&gt; Valid:3 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt; [一 12 19 zhengzhibin@ZhengmatoMacBook-Air ~/riak/dev]$
&gt; 
&gt; 
&gt; 
&gt; Can anyone tell me why there is no 'Down' Count in the riak-admin 
&gt; member_status? Actually there aretwo down node in this cluster 'dev2' and 
&gt; 'dev3'.
&gt; 
&gt; Best Regards,
&gt; Witeman Zheng
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05982.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd5.html#05986">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail5.html#05986">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05987.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05982.html">riak-admin member_status ambiguous with Riak 1.0.2</a></span> <span class="sender italic">Zheng Zhibin</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak-admin member_status ambiguous with Riak 1.0....</span> <span class="sender italic">Jeffrey Massung</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05987.html">Re: riak-admin member_status ambiguous with Riak ...</a></span> <span class="sender italic">Jeffrey Massung</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05993.html">Re: riak-admin member_status ambiguous with R...</a></span> <span class="sender italic">Zheng Zhibin</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak-admin member_status ambiguous with Riak 1.0.2">
<input type="hidden" name="msgid" value="333958F0-13ED-4CA5-9FA6-3902DFD9D8F5@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05986.html">
<input type="submit" value=" Jeffrey Massung ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak%5C-admin+member_status+ambiguous+with+Riak+1.0.2%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05982.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05987.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">333958F0-13ED-4CA5-9FA6-3902DFD9D8F5@basho.com</li>
</ul>
</div>
</body>
</html>
