<!DOCTYPE html>
<html lang="en">
<head>
<title>RE: Riak and Spring</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#14618" id="c">
<link rel="index" href="maillist.html#14618" id="i">
<link rel="prev" href="msg14617.html" id="p">
<link rel="next" href="msg14639.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg14618.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22RE%5C%3A+Riak+and+Spring%22&amp;o=newest" rel="nofollow"><span itemprop="name">RE: Riak and Spring</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Simon+Hartley%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Simon Hartley</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140806" rel="nofollow">Wed, 06 Aug 2014 10:02:40 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi,

Thanks, for your suggestions.</pre><pre>

I've done something similar, but injected the client config directly into the 
client bean in the application configuration (not via the 
HTTPClientConfigFactory). E.g:

@ComponentScan
@EnableAutoConfiguration
public class Application {

    @Value( &quot;${riak.pool.host}&quot; ) private String poolHost;
    @Value( &quot;${riak.pool.port}&quot; ) private int poolPort;
    @Value( &quot;${riak.pool.timeout.connection}&quot; ) private long 
poolTimeoutConnection;
    @Value( &quot;${riak.pool.timeout.idle}&quot; ) private long poolTimeoutIdle;
    @Value( &quot;${riak.pool.timeout.request}&quot; ) private int poolTimeoutRequest;
    @Value( &quot;${riak.pool.buffersize}&quot; ) private int poolBufferSize;

       @Bean
    public static PropertyPlaceholderConfigurer properties(){
      PropertyPlaceholderConfigurer ppc = new PropertyPlaceholderConfigurer();
      ClassPathResource[] resources = new ClassPathResource[ ]{ new 
ClassPathResource( &quot;app.properties&quot; ) };
      ppc.setLocations(resources);
      ppc.setIgnoreUnresolvablePlaceholders(true);
      return ppc;
    }

       @Bean
       @Scope(&quot;singleton&quot;)
       IRiakClient riakClient() throws Exception{

              //create a single client connection configuration using the 
property file values
              Configuration config = (new PBClientConfig.Builder())
                                                                            
.withConnectionTimeoutMillis(poolTimeoutConnection)
                                                                            
.withIdleConnectionTTLMillis(poolTimeoutIdle)
                                                                            
.withRequestTimeoutMillis(poolTimeoutRequest)
                                                                           
.withHost(poolHost)
                                                                           
.withPort(poolPort)
                                                                            
.withSocketBufferSizeKb(poolBufferSize)
                                                                           
.build();

              //create the singleton Riak client using the connection 
configuration
              IRiakClient client = RiakFactory.newClient(config);

              return client;
       }

    public static void main(String[] args) {

        SpringApplication.run(Application.class, args);
    }
}

I'm not aware of any obvious benefits of one method over the other. If anyone 
can enlighten me please do so :)

Thanks,

Simon.

From: Mark Richard Thomas [<a  rel="nofollow" href="mailto:mark.tho...@equifax.com">mailto:mark.tho...@equifax.com</a>]
Sent: 06 August 2014 09:50
To: Simon Hartley; riak-users@lists.basho.com
Subject: RE: Riak and Spring

Hello


1)      Create a riakClient bean (applicationContext.xml)

       &lt;bean id=&quot;riakClient&quot; class=&quot;com.basho.riak.client.RiakFactory&quot;
              factory-method=&quot;newClient&quot;&gt;
              &lt;constructor-arg ref=&quot;HTTPClientConfigFactory&quot; /&gt;
       &lt;/bean&gt;


2)      create a HTTPClientConfigFactory bean in which you can specify the host 
and port:

package com.webapp.util;

import org.apache.http.client.HttpClient;
import org.springframework.beans.factory.FactoryBean;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import com.basho.riak.client.raw.http.HTTPClientConfig;

@Component
public class HTTPClientConfigFactory implements FactoryBean&lt;HTTPClientConfig&gt; {

                @Value(&quot;${${environment}.host}&quot;)
                private String host;
                @Value(&quot;${${environment}.port}&quot;)
                private int port;

                @Autowired
                HttpClient httpClient;

                public HTTPClientConfig getObject() throws Exception {
                                return new 
HTTPClientConfig.Builder().withHttpClient(httpClient)
                                                                
.withHost(host).withPort(port).build();
                }

                @Override
                public Class&lt;?&gt; getObjectType() {
                                return HTTPClientConfig.class;
                }

                @Override
                public boolean isSingleton() {
                                return true;
                }

                @Override
                protected void finalize() throws Throwable {
                                httpClient.getConnectionManager().shutdown();
                }
}


3)      Use the RiakClient within a service:

       @Autowired
       private IRiakClient client;

       public Name getName(String sname) {
              try {
                     Name name = client.fetchBucket(NAMEBUCKET).execute()
                                  .fetch(sname, Name.class).execute();
                     if (name == null) {
                           throw new ResourceNotFoundException(sname);
                     }
                     return name;
              } catch (UnresolvedConflictException | RiakRetryFailedException
                           | ConversionException e) {
                     throw new ServiceUnavailableException(sname);
              }
       }

Mark Thomas | Software Engineer | Equifax UK

p:   +44 (0)208 941 0573
m:  +44 (0)7908 798 270
e:   mark.tho...@equifax.com&lt;<a  rel="nofollow" href="mailto:mark.tho...@equifax.com">mailto:mark.tho...@equifax.com</a>&gt;

Equifax Ltd, Capital House, 25 Chapel Street, London, NW1 5DS

From: riak-users [<a  rel="nofollow" href="mailto:riak-users-boun...@lists.basho.com">mailto:riak-users-boun...@lists.basho.com</a>] On Behalf Of Simon 
Hartley
Sent: 30 July 2014 15:37
To: riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;
Subject: [IE]:Riak and Spring

Hi,

I'm looking at using a Riak backend in a new component.

My current client is a Spring shop. I'm not all that knowledgable about the 
intricaies of Spring , so this question many not make sense, but I am hoping to 
integrate Riak in a Spring friendly way.

I was looking at the 
spring-projects/spring-data-keyvalue&lt;<a  rel="nofollow" href="https://github.com/spring-projects/spring-data-keyvalue">https://github.com/spring-projects/spring-data-keyvalue</a>&gt;
 project, but that's been deprecated in favour of 
spring-projects/spring-data-riak&lt;<a  rel="nofollow" href="https://github.com/spring-projects/spring-data-riak">https://github.com/spring-projects/spring-data-riak</a>&gt;
 which is empty.

Does anyone know of a Spring-Riak integration project that is high quality and 
currently active -  preferably with excellent documentation and examples ;)

Thanks,

Simon.
Confidentiality: The contents of this e-mail and any attachments transmitted 
with it are intended to be confidential to the intended recipient; and may be 
privileged or otherwise protected from disclosure. If you are not an intended 
recipient of this e-mail, do not duplicate or redistribute it by any means. 
Please delete it and any attachments and notify the sender that you have 
received it in error. This e-mail is sent by a William Hill PLC group company. 
The William Hill group companies include, among others, William Hill PLC 
(registered number 4212563), William Hill Organization Limited (registered 
number 278208), William Hill US HoldCo Inc, WHG (International) Limited 
(registered number 99191) and WHG Trading Limited (registered number 101439). 
Each of William Hill PLC, William Hill Organization Limited is registered in 
England and Wales and has its registered office at Greenside House, 50 Station 
Road, Wood Green, London N22 7TP. William Hill U.S. HoldCo, Inc. is 160 
Greentree Drive, Suite 101, Dover 19904, Kent, Delaware, United States of 
America. Each of WHG (International) Limited and WHG Trading Limited is 
registered in Gibraltar and has its registered office at 6/1 Waterport Place, 
Gibraltar. Unless specifically indicated otherwise, the contents of this e-mail 
are subject to contract; and are not an official statement, and do not 
necessarily represent the views, of William Hill PLC, its subsidiaries or 
affiliated companies. Please note that neither William Hill PLC, nor its 
subsidiaries and affiliated companies can accept any responsibility for any 
viruses contained within this e-mail and it is your responsibility to scan any 
emails and their attachments. William Hill PLC, its subsidiaries and affiliated 
companies may monitor e-mail traffic data and also the content of e-mails for 
effective operation of the e-mail system, or for security, purposes..
Equifax Limited is registered in England with Registered No. 2425920. 
Registered Office: Capital House, 25 Chapel Street, London NW1 5DS. Equifax 
Limited is authorised and regulated by the Financial Conduct Authority.
Equifax Touchstone Limited is registered in Scotland with Registered No. 
SC113401. Registered Office: 54 Deerdykes View, Westfield Park, Cumbernauld G68 
9HN.
Equifax Commercial Services Limited is registered in the Republic of Ireland 
with Registered No. 215393. Registered Office: IDA Business &amp; Technology Park, 
Rosslare Road, Drinagh, Wexford.

This message contains information from Equifax which may be confidential and 
privileged. If you are not an intended recipient, please refrain from any 
disclosure, copying, distribution or use of this information and note that such 
actions are prohibited. If you have received this transmission in error, please 
notify by e-mail postmas...@equifax.com&lt;<a  rel="nofollow" href="mailto:postmas...@equifax.com">mailto:postmas...@equifax.com</a>&gt;.
Confidentiality: The contents of this e-mail and any attachments transmitted 
with it are intended to be confidential to the intended recipient; and may be 
privileged or otherwise protected from disclosure. If you are not an intended 
recipient of this e-mail, do not duplicate or redistribute it by any means. 
Please delete it and any attachments and notify the sender that you have 
received it in error. This e-mail is sent by a William Hill PLC group company. 
The William Hill group companies include, among others, William Hill PLC 
(registered number 4212563), William Hill Organization Limited (registered 
number 278208), William Hill US HoldCo Inc, WHG (International) Limited 
(registered number 99191) and WHG Trading Limited (registered number 101439). 
Each of William Hill PLC, William Hill Organization Limited is registered in 
England and Wales and has its registered office at Greenside House, 50 Station 
Road, Wood Green, London N22 7TP. William Hill U.S. HoldCo, Inc. is 160 
Greentree Drive, Suite 101, Dover 19904, Kent, Delaware, United States of 
America. Each of WHG (International) Limited and WHG Trading Limited is 
registered in Gibraltar and has its registered office at 6/1 Waterport Place, 
Gibraltar. Unless specifically indicated otherwise, the contents of this e-mail 
are subject to contract; and are not an official statement, and do not 
necessarily represent the views, of William Hill PLC, its subsidiaries or 
affiliated companies. Please note that neither William Hill PLC, nor its 
subsidiaries and affiliated companies can accept any responsibility for any 
viruses contained within this e-mail and it is your responsibility to scan any 
emails and their attachments. William Hill PLC, its subsidiaries and affiliated 
companies may monitor e-mail traffic data and also the content of e-mails for 
effective operation of the e-mail system, or for security, purposes..
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg14617.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#14618">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#14618">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg14639.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg14587.html">Riak and Spring</a></span> <span class="sender italic">Simon Hartley</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14588.html">Re: Riak and Spring</a></span> <span class="sender italic">hotmail . kwyto</span></li>
<li class="icons-email"><span class="subject"><a href="msg14617.html">RE: Riak and Spring</a></span> <span class="sender italic">Mark Richard Thomas</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">RE: Riak and Spring</span> <span class="sender italic">Simon Hartley</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14639.html">Re: Riak and Spring</a></span> <span class="sender italic">Michael Duergner</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="RE: Riak and Spring">
<input type="hidden" name="msgid" value="b01f9fdcc3d24b42a7c85981eeae4699@DBXPR05MB032.eurprd05.prod.outlook.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg14618.html">
<input type="submit" value=" Simon Hartley ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22RE%5C%3A+Riak+and+Spring%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg14617.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg14639.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">b01f9fdcc3d24b42a7c85981eeae4699@DBXPR05MB032.eurprd05.prod.outlook.com</li>
</ul>
</div>
</body>
</html>
