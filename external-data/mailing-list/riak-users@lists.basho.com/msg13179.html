<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Timeout on Streaming all keys</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd6.html#13179" id="c">
<link rel="index" href="mail6.html#13179" id="i">
<link rel="prev" href="msg13178.html" id="p">
<link rel="next" href="msg13181.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg13179.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Timeout+on+Streaming+all+keys%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Timeout on Streaming all keys</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Guido+Medina%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Guido Medina</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131209" rel="nofollow">Mon, 09 Dec 2013 06:22:39 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Shimon,

</pre><tt>Did you try streaming the 2i bucket index and then doing your job per 
</tt><tt>key basis? I sent you a code snippet the other day.
</tt><pre style="margin: 0em;"></pre><pre>

</pre><tt>It should work fine regardless of how many keys you have in your bucket, 
</tt><tt>it is equivalent to the section:
</tt><pre style="margin: 0em;">

</pre><tt><a  rel="nofollow" href="http://docs.basho.com/riak/latest/dev/using/2i/">http://docs.basho.com/riak/latest/dev/using/2i/</a> - Look for &quot;Retrieve all 
</tt><tt>Bucket Keys via $bucket Index&quot;
</tt><pre style="margin: 0em;">

Except that the code I sent you uses streaming API.

Guido.

On 09/12/13 14:10, Luke Bakken wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Shimon,

There is a tech preview of 2.0.0 available here that includes
Yokozuna: <a  rel="nofollow" href="http://docs.basho.com/riak/2.0.0pre5/downloads/">http://docs.basho.com/riak/2.0.0pre5/downloads/</a>

However, since then there have been updates to Yokozuna. You can build
from the latest sources using the instructions here:

<a  rel="nofollow" href="https://github.com/basho/yokozuna/blob/develop/docs/INSTALL.md#source-package">https://github.com/basho/yokozuna/blob/develop/docs/INSTALL.md#source-package</a>

You will find related YZ docs in that &quot;docs&quot; directory as well.

--
Luke Bakken
CSE
lbak...@basho.com


On Mon, Dec 9, 2013 at 4:11 AM, Shimon Benattar &lt;shim...@gmail.com&gt; wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Luke, I'd love to have your insights on our problem.

About setting the timeout, we are anyway considering to upgrade to version 2.0 
so maybe I'll try that. is there an official release data?
Does the basic installation already include installation of Yokozuna? is there 
some guide on how to work woth Yokozuna?

Thanks,

Shimon


On 5 December 2013 19:48, Luke Bakken &lt;lbak...@basho.com&gt; wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Shimon,

I spoke with a member of the Java client team and the timeout is set to 60 
seconds. In the 2.0 version of the client this will be user-settable.

To make sure there's not a crash or other issue causing the long list keys, feel free to 
run &quot;riak-debug&quot; on nodes in your cluster and provide the generated archives. 
We can discuss that off-list.

--
Luke Bakken
CSE
lbak...@basho.com


On Wed, Dec 4, 2013 at 12:43 AM, Shimon Benattar &lt;shim...@gmail.com&gt; wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Luke,
We're using v1.4

On Dec 3, 2013 6:19 PM, &quot;Luke Bakken&quot; &lt;lbak...@basho.com&gt; wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Shimon,

What version of Riak and the Java client are you using?

Thanks
--
Luke Bakken
CSE
lbak...@basho.com


On Thu, Nov 28, 2013 at 4:00 AM, Shimon Benattar &lt;shim...@gmail.com&gt; wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Riak users,



Unfortunately for me I need to implement the get all keys method in our system 
(I know it is not recommended)



I am developing classes with the Java Api and using the streaming option as 
following



StreamingOperation&lt;String&gt; keys = riakBucket.keys();

while (keys.hasNext()) {

final String next = keys.next();

out.write(next);

out.newLine();

}

riakBucket.keys().cancel();



My problem here is that for a simple class I inserted in Riak, after ~4.7 
million keys I am getting a timeout from Riak.

Is there any way to configure the read operation timeout or to somehow catch 
the timeout and continue to receive the next keys (Can I somehow bulk read the 
keys)?



Thanks,



Shimon




_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre></blockquote></blockquote></blockquote></blockquote></blockquote><pre style="margin: 0em;">
_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre></blockquote><pre style="margin: 0em;">


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg13178.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd6.html#13179">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail6.html#13179">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg13181.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg13116.html">Timeout on Streaming all keys</a></span> <span class="sender italic">Shimon Benattar</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13154.html">Re: Timeout on Streaming all keys</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13178.html">Re: Timeout on Streaming all keys</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Timeout on Streaming all keys</span> <span class="sender italic">Guido Medina</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13181.html">2i indices vs. links vs. map vs. ??</a></span> <span class="sender italic">Ralf Kohrt</span></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg13155.html">Re: Timeout on Streaming all keys</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13156.html">Re: Timeout on Streaming all keys</a></span> <span class="sender italic">Guido Medina</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Timeout on Streaming all keys">
<input type="hidden" name="msgid" value="52A5D1DB.7000301@temetra.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg13179.html">
<input type="submit" value=" Guido Medina ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Timeout+on+Streaming+all+keys%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg13178.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg13181.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">52A5D1DB.7000301@temetra.com</li>
</ul>
</div>
</body>
</html>
