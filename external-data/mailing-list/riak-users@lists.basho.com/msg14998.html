<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Creating a new object immediately after deleting one with the	same key</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#14998" id="c">
<link rel="index" href="maillist.html#14998" id="i">
<link rel="prev" href="msg14997.html" id="p">
<link rel="next" href="msg14999.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg14998.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Creating+a+new+object+immediately+after+deleting+one+with+the%09same+key%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Creating a new object immediately after deleting one with the	same key</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Sargun+Dhillon%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Sargun Dhillon</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20141009" rel="nofollow">Thu, 09 Oct 2014 01:36:45 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Distributed deletion, and garbage collection is a really hard problem.
Riak has a couple different ways to do it talked about here:
<a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/advanced/deletion/">http://docs.basho.com/riak/latest/ops/advanced/deletion/</a></pre><pre>

The default mechanism tombstones the key, and then waits 3 seconds
after the write has reached stable state (on all the primary vnodes of
the preflist), and then blows it away. Although, this is configurable,
it's probably not what you want to change. You should pass the
deletedvclock=true, when doing the get, and then pass back the vclock
on write. There is more information in the linked doc.

On Thu, Oct 9, 2014 at 1:23 AM,  &lt;t...@fastmail.fm&gt; wrote:
&gt; Hi all,
&gt;
&gt; While testing a simple go / protobuf driver I encountered following
&gt; behaviour:
&gt; After deleting an object and creating a new one with the same key
&gt; immediately afterwards Riak creates a sibling of the new object. Trying to
&gt; fetch an object with the key directly before creating the new one fails.
&gt;
&gt; If the timespan between delete and create is greater than ~3 seconds
&gt; everything works as expected.
&gt;
&gt; Is this behaviour documented somewhere? Does the required minimal timespan
&gt; depend on the cluster setup or is it configurable?
&gt; I'm currently using Riak v2.0.0 on OS X locally, allow_mult is set to true.
&gt;
&gt; Best regards,
&gt; Tilo Soenke
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg14997.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#14998">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#14998">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg14999.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg14997.html">Creating a new object immediately after deleting one with t...</a></span> <span class="sender italic">tilo</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Creating a new object immediately after deleting o...</span> <span class="sender italic">Sargun Dhillon</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14999.html">Re: Creating a new object immediately after deleti...</a></span> <span class="sender italic">tilo</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Creating a new object immediately after deleting one with the	same key">
<input type="hidden" name="msgid" value="CAMp4zn8UYjF-XPCA0gy+vvR4=6pKj--PnWcst9JSCb5qH5NnHA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg14998.html">
<input type="submit" value=" Sargun Dhillon ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Creating+a+new+object+immediately+after+deleting+one+with+the%09same+key%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg14997.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg14999.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAMp4zn8UYjF-XPCA0gy+vvR4=6pKj--PnWcst9JSCb5qH5NnHA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
