<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak Join is Screwed Up</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07378" id="c">
<link rel="index" href="maillist.html#07378" id="i">
<link rel="prev" href="msg07377.html" id="p">
<link rel="next" href="msg07379.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07378.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+Join+is+Screwed+Up%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak Join is Screwed Up</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Rebecca+Meritz%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Rebecca Meritz</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120503" rel="nofollow">Thu, 03 May 2012 00:05:29 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>I figured out a way to fix the problem. But I don't understand why the
solution works.</pre><pre>

Before A sent a join request to B and then B to C and the second request
failed.

Now A sends a join request to B and then C to B and the second
request succeeds.

Must a node that is the only member of its cluster always ask to join the
larger cluster for the request to succeed? Why is this?

Thanks,
Rebecca

On Thu, May 3, 2012 at 8:41 AM, Rebecca Meritz &lt;rebecca.mer...@klarna.com&gt;wrote:

&gt; I'm testing a script that joins my riak ring on all machines. There is no
&gt; data in the database yet but I have repeated joined the ring
&gt; an separated it while working on the script that sets up the environment on
&gt; my machines. The ring is now in a bizarre state:
&gt;
&gt; [rebecca]$ riak-admin member_status
&gt; Attempting to restart script through sudo -u riak
&gt; ================================= Membership
&gt; ==================================
&gt; Status     Ring    Pending    Node
&gt;
&gt; -------------------------------------------------------------------------------
&gt; valid      50.0%      --      'r...@xx.xxx.xx.10'
&gt; valid      50.0%      --      'r...@xx.xxx.xx.12'
&gt;
&gt; -------------------------------------------------------------------------------
&gt; Valid:2 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt; [pay@payment-testing-gw2 ~]$ riak-admin join r...@xx.xxx.xx.14
&gt; Attempting to restart script through sudo -u riak
&gt; *Failed: This node is already a member of a cluster*
&gt; [pay@payment-testing-gw2 ~]$ riak-admin force-remove r...@xx.xxx.xx.14
&gt; Attempting to restart script through sudo -u riak
&gt; *Failed: &quot;r...@xx.xxx.xx.14&quot; is not a member of the cluster.*
&gt;
&gt; I cannot join a new member nor can I remove it.
&gt;
&gt; I've tried stop them all get them to leave, if they wouldn't leave I
&gt; forced their removal. I stopped them all. I even deleted the whole old ring
&gt; file before restarting.
&gt;
&gt; How can I fix this situations. What causes the above error?
&gt;
&gt; Thanks,
&gt; Rebecca
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07377.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07378">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07378">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07379.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg07377.html">Riak Join is Screwed Up</a></span> <span class="sender italic">Rebecca Meritz</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak Join is Screwed Up</span> <span class="sender italic">Rebecca Meritz</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07379.html">Re: Riak Join is Screwed Up</a></span> <span class="sender italic">Joseph Blomstedt</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak Join is Screwed Up">
<input type="hidden" name="msgid" value="CADSm5g-anqbcpNef=UBc7Xqr76ATr=6AVdqkXW2Sd6P-5Y7D4A@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07378.html">
<input type="submit" value=" Rebecca Meritz ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+Join+is+Screwed+Up%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07377.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07379.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CADSm5g-anqbcpNef=UBc7Xqr76ATr=6AVdqkXW2Sd6P-5Y7D4A@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
