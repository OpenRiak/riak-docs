<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Unable to configure Riak-CS-Control to manage users</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd8.html#12569" id="c">
<link rel="index" href="mail9.html#12569" id="i">
<link rel="prev" href="msg12568.html" id="p">
<link rel="next" href="msg12570.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12569.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Unable+to+configure+Riak%5C-CS%5C-Control+to+manage+users%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Unable to configure Riak-CS-Control to manage users</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Siddhu+Warrier+%5C%28siwarrie%5C%29%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Siddhu Warrier (siwarrie)</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131009" rel="nofollow">Wed, 09 Oct 2013 09:24:32 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Dmitri,

Sorry I failed to attach the s3cfg file.</pre><pre>

Cheers,

Siddhu

From: Dmitri Zagidulin &lt;dzagidu...@basho.com&lt;<a  rel="nofollow" href="mailto:dzagidu...@basho.com">mailto:dzagidu...@basho.com</a>&gt;&gt;
Date: Wednesday, 9 October 2013 16:51
To: Siddhu Warrier &lt;siwar...@cisco.com&lt;<a  rel="nofollow" href="mailto:siwar...@cisco.com">mailto:siwar...@cisco.com</a>&gt;&gt;
Cc: &quot;riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;&quot; 
&lt;riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;&gt;
Subject: Re: Unable to configure Riak-CS-Control to manage users

Ok, I suspect it has to do with a mismatch between cs_root_host setting in 
riakcs.app.config and the corresponding setting in riak-cs-control.app.config.  
Can you attach your .s3cfg, so I can confirm?

Dmitri


On Wed, Oct 9, 2013 at 11:16 AM, Siddhu Warrier (siwarrie) 
&lt;siwar...@cisco.com&lt;<a  rel="nofollow" href="mailto:siwar...@cisco.com">mailto:siwar...@cisco.com</a>&gt;&gt; wrote:
Hi Dmitri,

Thanks again for your rapid reply!

1, 2) I have attached my riak, stanchion, riak-cs and riak-cs-control 
app.config files here
3)
Things that work with s3cmd (s3 config attached):

  *   Create a bucket, upload a file, download a file, delete buckets 
recursively, list contents of buckets

[root@cpn-int-store-03 ~]# s3cmd mb s3://cloudcuckooland
Bucket 's3://cloudcuckooland/' created
[root@cpn-int-store-03 ~]# s3cmd put cobbler.ks s3://cloudcuckooland/shoemaker
cobbler.ks -&gt; s3://cloudcuckooland/shoemaker  [1 of 1]
 6964 of 6964   100% in    0s   114.14 kB/s  done
[root@cpn-int-store-03 ~]# s3cmd la
2013-10-09 14:47      6964   s3://cloudcuckooland/shoemaker

[root@cpn-int-store-03 ~]# s3cmd get s3://cloudcuckooland/shoemaker 
/tmp/shoemaker.tmp
s3://cloudcuckooland/shoemaker -&gt; /tmp/shoemaker.tmp  [1 of 1]
 6964 of 6964   100% in    0s   659.50 kB/s  done
[root@cpn-int-store-03 ~]# s3cmd rb --force s3://cloudcuckooland
WARNING: Bucket is not empty. Removing all the objects from it first. This may 
take some time...
File s3://cloudcuckooland/shoemaker deleted
Bucket 's3://cloudcuckooland/' removed

Things that do not work:

  *   Riak CS Control: Create user
  *   Riak CS Control: List users

Note: With anonymous user creation set to true, I was able to view information 
about users and modify them.

I was however able to view the information about a particular user.
[root@cpn-int-store-03 ~]# s3cmd get s3://riak-cs/user -
s3://riak-cs/user -&gt; &lt;stdout&gt;  [1 of 1]
&lt;?xml version=&quot;1.0&quot; 
encoding=&quot;UTF-8&quot;?&gt;&lt;User&gt;&lt;Email&gt;x...@cisco.com&lt;<a  rel="nofollow" href="mailto:x...@cisco.com">mailto:x...@cisco.com</a>&gt;&lt;/Email&gt;&lt;DisplayName&gt;xxxxx&lt;/DisplayName&gt;&lt;Name&gt;Rory
 Irvine&lt;/Name&gt;&lt;KeyId&gt;5VI-NIFLNIHKRNGKPBVX&lt;/KeyId&gt;&lt;KeySec 338 of 338   100% in   
 0s     4.57 kB/s  
doneeySecret&gt;&lt;Id&gt;c26c71a140f18b6853b45fd3ce4a672e0471b62a04920c2a77def7a0bfbcde0d&lt;/Id&gt;&lt;Status&gt;enabled&lt;/Status&gt;&lt;/User&gt;
[root@cpn-int-store-03 ~]# s3cmd get s3://riak-cs/user/9UND62Q1-EIDE9YO1GI0  -
s3://riak-cs/user/9UND62Q1-EIDE9YO1GI0 -&gt; &lt;stdout&gt;  [1 of 1]
&lt;?xml version=&quot;1.0&quot; 
encoding=&quot;UTF-8&quot;?&gt;&lt;User&gt;&lt;Email&gt;foo...@example.com&lt;<a  rel="nofollow" href="mailto:foo...@example.com">mailto:foo...@example.com</a>&gt;&lt;/Email&gt;&lt;DisplayName&gt;foobar&lt;/DisplayName&gt;&lt;Name&gt;foo
 bar&lt;/Name&gt;&lt;KeyId&gt;9UND62Q1-EIDE9YO1GI0&lt;/KeyId&gt;&lt;KeySecret&gt;4o 333 of 333   100% 
in    0s    43.04 kB/s  
doneet&gt;&lt;Id&gt;6057fd7d3a7c43b06f839441585d35de197baa57a4696318803afd81c5887aec&lt;/Id&gt;&lt;Status&gt;disabled&lt;/Status&gt;&lt;/User&gt;

Thanks,

Siddhu

From: Dmitri Zagidulin &lt;dzagidu...@basho.com&lt;<a  rel="nofollow" href="mailto:dzagidu...@basho.com">mailto:dzagidu...@basho.com</a>&gt;&gt;
Date: Wednesday, 9 October 2013 16:02

To: Siddhu Warrier &lt;siwar...@cisco.com&lt;<a  rel="nofollow" href="mailto:siwar...@cisco.com">mailto:siwar...@cisco.com</a>&gt;&gt;
Cc: &quot;riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;&quot; 
&lt;riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;&gt;
Subject: Re: Unable to configure Riak-CS-Control to manage users

Thanks Siddhu,
Couple more questions.

1) Can you include a couple more sections from the Riak CS config 
(specifically, the anonymous_user_creation section and the admin_key).

2) Just to double-check, can you re-include the Riak CS Control config? (the 
whole riak_cs_control section).

3) Describe again exactly which parts are working and which aren't. What do you 
see when you open the Riak CS Control web interface? (And which commands are 
working with s3cmd?)



On Wed, Oct 9, 2013 at 10:50 AM, Siddhu Warrier (siwarrie) 
&lt;siwar...@cisco.com&lt;<a  rel="nofollow" href="mailto:siwar...@cisco.com">mailto:siwar...@cisco.com</a>&gt;&gt; wrote:
Hi Dimitri,

Thank you for your email. I just tried this. I still have the same problem, 
except that I no longer get 403 errors in my Riak CS error log (as a matter of 
fact, I get nothing at all in my Riak CS, Riak CS Control, Stanchion, and Riak 
error logs).

I've put the basic config section of my riak-cs/app.config here for your 
reference.

               %% Riak CS http/https port and IP address to listen at
               %% for object storage activity
               {cs_ip, &quot;10.0.1.202&quot;},
               {cs_port, 8080 } ,

               %% Riak node to which Riak CS accesses
               {riak_ip, &quot;10.0.1.202&quot;},
               {riak_pb_port, 8087 } ,

               %% Configuration for access to request
               %% serialization service
               {stanchion_ip, &quot;10.0.1.202&quot;},
               {stanchion_port, 8085 },
               {stanchion_ssl, false },

Thanks,

Siddhu

From: Dmitri Zagidulin &lt;dzagidu...@basho.com&lt;<a  rel="nofollow" href="mailto:dzagidu...@basho.com">mailto:dzagidu...@basho.com</a>&gt;&gt;
Date: Wednesday, 9 October 2013 15:38
To: Siddhu Warrier &lt;siwar...@cisco.com&lt;<a  rel="nofollow" href="mailto:siwar...@cisco.com">mailto:siwar...@cisco.com</a>&gt;&gt;
Cc: &quot;riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;&quot; 
&lt;riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;&gt;
Subject: Re: Unable to configure Riak-CS-Control to manage users

(Just to be extra clear, that's meant to be a comma at the end of that 
directive, not a period. Also, don't forget to restart Riak CS Control, after 
changing the proxy host).


On Wed, Oct 9, 2013 at 10:36 AM, Dmitri Zagidulin 
&lt;dzagidu...@basho.com&lt;<a  rel="nofollow" href="mailto:dzagidu...@basho.com">mailto:dzagidu...@basho.com</a>&gt;&gt; wrote:
Hi Siddhu,

Can you try changing 'cs_proxy_host' to localhost? So:

 {cs_proxy_host, &quot;127.0.0.1&quot; }.

and retry.




On Wed, Oct 9, 2013 at 9:55 AM, Siddhu Warrier (siwarrie) 
&lt;siwar...@cisco.com&lt;<a  rel="nofollow" href="mailto:siwar...@cisco.com">mailto:siwar...@cisco.com</a>&gt;&gt; wrote:
Hi,

I have a two node Riak CS (1.4) cluster set up on two nodes (node-1 and node-2 
henceforth). Node-1 is the headnode. Both node-1 and node-2 are running 
CentOS-6.4.

Node-1

  *   Riak 1.4.2
  *   Stanchion 1.4.1
  *   Riak-CS 1.4.1
  *   Riak-CS-Control 1.0.2

Node-2

  *   Riak 1.4.2
  *   Riak-CS 1.4.1

I have got Riak CS working, and have created admin credentials that I've set 
correctly on stanchion, riak-cs, and riak-cs-control on node 1, and on riak-cs 
on node 2. I am able to use the admin credentials to perform operations on the 
bucket using s3cmd.

However, when I try to list riak-cs users using the riak-cs-control, I get no 
results. The error that comes up in /var/log/riak-cs.log is:

10.0.1.202 - - [09/Oct/2013:13:09:31 +0000] &quot;GET /buckets/users/objects 
HTTP/1.1&quot; 403 160 &quot;&quot; &quot;&quot;

I also receive a 403 when I try to create an admin user.

I saw <a  rel="nofollow" href="https://github.com/basho/riak_cs_control/issues/31">https://github.com/basho/riak_cs_control/issues/31</a> and set my 
/etc/riak-cs-control/app.config file up to use the cs_proxy_host parameter as 
well, though I'm not using proxies, but to no avail. I have reproduced the 
relevant section of my riak-cs-control/app.config here:
    {riak_cs_control, [
       %% What port to run the application on.
       {port, 8000 },

       %% Instance of Riak CS you wish to talk to.
       {cs_hostname, &quot;10.0.1.202&quot; },
       {cs_port, 8080 },
       {cs_protocol, &quot;http&quot; },

       %% Proxy information; necessary if you are using 
s3.amazonaws.com&lt;<a  rel="nofollow" href="http://s3.amazonaws.com">http://s3.amazonaws.com</a>&gt; as
       %% your hostname.
       {cs_proxy_host, &quot;10.0.1.202&quot; },
       {cs_proxy_port, 8080 },

       %% Credentials you want the application to run as.
       {cs_admin_key, &quot;5VI-NIFLNIHKRNGKPBVX&quot; },
       {cs_admin_secret, &quot;xxxxxxx&quot; },

       %% Specify the bucket name for administration options.
       {cs_administration_bucket, &quot;riak-cs&quot; }
    ]},

Is there something I am missing/doing wrong?

Thanks,

Siddhu

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>





</pre>
<p><strong><a href="msg12569/s3cfg" ><img src="../attachment.png" alt="Attachment:" width=27 height=28></a>
<a href="msg12569/s3cfg" >s3cfg</a></strong><br>
<em>Description:</em> s3cfg</p>
<pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12568.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd8.html#12569">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail9.html#12569">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12570.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12561.html">Unable to configure Riak-CS-Control to manage us...</a></span> <span class="sender italic">Siddhu Warrier (siwarrie)</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12565.html">Re: Unable to configure Riak-CS-Control to ...</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12564.html">Re: Unable to configure Riak-CS-Control...</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12566.html">Re: Unable to configure Riak-CS-Con...</a></span> <span class="sender italic">Siddhu Warrier (siwarrie)</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12567.html">Re: Unable to configure Riak-CS...</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12568.html">Re: Unable to configure Ri...</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Unable to configur...</span> <span class="sender italic">Siddhu Warrier (siwarrie)</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12570.html">Re: Unable to conf...</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg12579.html">Re: Unable to conf...</a></span> <span class="sender italic">Christopher Meiklejohn</span></li>
<li class="icons-email"><span class="subject"><a href="msg12581.html">Re: Unable to conf...</a></span> <span class="sender italic">Siddhu Warrier (siwarrie)</span></li>
<li class="icons-email"><span class="subject"><a href="msg12620.html">Re: Unable to conf...</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg12622.html">Re: Unable to conf...</a></span> <span class="sender italic">Christopher Meiklejohn</span></li>
<li class="icons-email"><span class="subject"><a href="msg12627.html">Re: Unable to conf...</a></span> <span class="sender italic">Siddhu Warrier (siwarrie)</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Unable to configure Riak-CS-Control to manage users">
<input type="hidden" name="msgid" value="B460448B71E1B941A38BEDB0D2530E850BFF928E@xmb-rcd-x04.cisco.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12569.html">
<input type="submit" value=" Siddhu Warrier (siwarrie) ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Unable+to+configure+Riak%5C-CS%5C-Control+to+manage+users%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12568.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12570.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">B460448B71E1B941A38BEDB0D2530E850BFF928E@xmb-rcd-x04.cisco.com</li>
</ul>
</div>
</body>
</html>
