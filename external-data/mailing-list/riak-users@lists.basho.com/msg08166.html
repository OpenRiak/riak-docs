<!DOCTYPE html>
<html lang="en">
<head>
<title>Riak Java client questions</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#08166" id="c">
<link rel="index" href="mail2.html#08166" id="i">
<link rel="prev" href="msg08165.html" id="p">
<link rel="next" href="msg08167.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg08166.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+Java+client+questions%22&amp;o=newest" rel="nofollow"><span itemprop="name">Riak Java client questions</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Oved+Machlev%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Oved Machlev</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120802" rel="nofollow">Thu, 02 Aug 2012 10:09:23 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi,

I have been working with Riak in past 3 weeks, using the java client.
I have encountered a few issues, and could not find solutions so far.
This is the first time I write an email to this mailing list - Would be great 
if it reaches the right destination :)</pre><pre>


1.       Riak supports auto generated keys when storing an object - 
<a  rel="nofollow" href="http://wiki.basho.com/Basic-Riak-API-Operations.html:">http://wiki.basho.com/Basic-Riak-API-Operations.html:</a>

Store a new object and assign random key #

If your application would rather leave key-generation up to Riak, issue a POST 
request to the bucket URL instead of a PUT to a bucket/key pair: POST 
/riak/bucket If you don't pass Riak a &quot;key&quot; name after the bucket, it will know 
to create one for you.

Is it possible to do the same when using the java client? it seems that key 
must be provided when storing an object.

2.       I have a POJO which I store. It contains a set of objects which I do 
not wish to persist, I mark it as transient:



transient private Set&lt;Service&gt; services;

but still, this set is being persisted - when I fetch my POJO (curl and java) I 
can see this:



                
{&quot;name&quot;:&quot;oved&quot;,&quot;lastUpdate&quot;:&quot;1343923201735&quot;,&quot;data&quot;:null,&quot;services&quot;:[]}



Is there something else I need to do to tell Riak to ignore it?



3.       This is more basic question - I keep on thinking that my stored 
objects should implement the IRIAKObject, but I avoided doing that so far, 
because in all the examples in the cookbook, it is never being done. So in 
theoretical level - should the objects that are stored in riak database 
implement this interface or not? Is there any value in doing that?



4.       MapReduce - If I perform the following without the line in bold (link) 
I get the collection of ServiceProviders without the Services that are linked.
When adding the LinkPhase, I am getting a JsonMappingException (see below). Any 
idea what is causing that? What am I missing? Both objects (service and 
serviceProvider) are stored as JsonObjects.

    public Collection&lt;ServiceProvider&gt; getAllServiceProvider() throws Exception{

        BucketMapReduce m = riakClient.mapReduce(&quot;SERVICE_PROVIDER&quot;);
        m.addMapPhase(new NamedJSFunction(&quot;Riak.mapValuesJson&quot;), true);
        m.addLinkPhase(&quot;SERVICE&quot;, &quot;_&quot;);
        MapReduceResult result = m.execute();
        return result.getResult(ServiceProvider.class);
    }


The exception:
com.basho.riak.client.convert.ConversionException: 
org.codehaus.jackson.map.JsonMappingException: Can not deserialize instance of 
com.att.cso.omss.datastore.riak.entities.ServiceProvider out of START_ARRAY 
token
 at [Source: 
java.io.StringReader@31958905&lt;<a  rel="nofollow" href="mailto:java.io.StringReader@31958905">mailto:java.io.StringReader@31958905</a>&gt;; line: 1, 
column: 2]
    at 
com.basho.riak.client.raw.http.ConversionUtil$1.getResult(ConversionUtil.java:601)


Sorry for the long email, and thanks in advance...


Thanks,
Oved Machlev
____________________________
Get AT&amp;T Connect for Mobile now!
Android&lt;<a  rel="nofollow" href="https://play.google.com/store/apps/details?id=com.att.connect">https://play.google.com/store/apps/details?id=com.att.connect</a>&gt; | 
iPhone&lt;<a  rel="nofollow" href="http://itunes.apple.com/us/app/at-t-connect-mobile/id318798264?mt=8">http://itunes.apple.com/us/app/at-t-connect-mobile/id318798264?mt=8</a>&gt; | 
iPad&lt;<a  rel="nofollow" href="http://itunes.apple.com/il/app/at-t-connect-mobile-application/id459888209?mt=8">http://itunes.apple.com/il/app/at-t-connect-mobile-application/id459888209?mt=8</a>&gt;
 | BB&lt;<a  rel="nofollow" href="http://downloads.uc.att.com/BB/Public/Latest/En/KB/att_connect.jad">http://downloads.uc.att.com/BB/Public/Latest/En/KB/att_connect.jad</a>&gt;

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg08165.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#08166">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#08166">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg08167.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Riak Java client questions</span> <span class="sender italic">Oved Machlev</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08167.html">Re: Riak Java client questions</a></span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08391.html">MapReduce - sorting via the Java client</a></span> <span class="sender italic">Oved Machlev</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08496.html">Re: MapReduce - sorting via the Java c...</a></span> <span class="sender italic">Deepak Balasubramanyam</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08497.html">Re: MapReduce - sorting via the Ja...</a></span> <span class="sender italic">Mark Phillips</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08498.html">Re: MapReduce - sorting via t...</a></span> <span class="sender italic">Deepak Balasubramanyam</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08499.html">Re: MapReduce - sorting v...</a></span> <span class="sender italic">Mark Phillips</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Riak Java client questions">
<input type="hidden" name="msgid" value="7F9AB8052E563043BF5218BB9ADE257F36592C37@ISRTLVEXMX1.interwise.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg08166.html">
<input type="submit" value=" Oved Machlev ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+Java+client+questions%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg08165.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg08167.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">7F9AB8052E563043BF5218BB9ADE257F36592C37@ISRTLVEXMX1.interwise.com</li>
</ul>
</div>
</body>
</html>
