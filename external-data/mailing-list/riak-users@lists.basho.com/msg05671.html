<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Social network data / Graph properties of Riak</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#05671" id="c">
<link rel="index" href="maillist.html#05671" id="i">
<link rel="prev" href="msg05670.html" id="p">
<link rel="next" href="msg05683.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05671.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Social+network+data+%5C%2F+Graph+properties+of+Riak%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Social network data / Graph properties of Riak</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Aphyr%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Aphyr</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111118" rel="nofollow">Fri, 18 Nov 2011 12:28:43 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
On 11/18/2011 11:50 AM, Jeroen van Dijk wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
And I also didn't include the riak user list for this reply:</pre><pre>


On Fri, Nov 18, 2011 at 7:04 PM, Aphyr &lt;ap...@aphyr.com
&lt;<a  rel="nofollow" href="mailto:ap...@aphyr.com">mailto:ap...@aphyr.com</a>&gt;&gt; wrote:

    Depending on whether you think it will be more efficient to store
    the graph or its dual, consider each node a vertex and write the
    adjacency list as a part of its data. You can store whatever
    weights, etc. you need on the edges there.

    Don't use links; they're just a thin layer on top of mapreduce, so
    there's really not much advantage to using them. Links are subject
    to the HTTP header lengths too, so storing more than a thousand on
    any node is likely to break down.


Thank you for this suggestion. Also thanks for the warning on not using
links for what I want. So you are saying each vertex will have a list of
the other vertices that it is connected to? And save each edge as
key/value pair? Or are you saying each vertex should embed the adjacent
edges, meaning duplicated edges?
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>Depends on whether you want to store the graph or its dual. If you're 
</tt><tt>dealing with a sparse DAG where the input keys are likely to be vertex 
</tt><tt>names, the natural choice is to store each vertex as an object in riak 
</tt><tt>and each outbound edge from it as a property of that vertex.
</tt><pre style="margin: 0em;">

/users/user1:
  owns: [item1, ...]
  follows: [user2, ...]

</pre><tt>Of course, this method doesn't work well when you need to follow edges 
</tt><tt>in reverse, so you may need to store the reciprocal relationship on 
</tt><tt>target nodes:
</tt><pre style="margin: 0em;">

/items/item1:
  owner: user1,

/users/user2:
  followed-by: [user1, ...]

</pre><tt>and so forth. That requires two writes and potentially lossy conflict 
</tt><tt>resolution strategies, e.g. a follows b but b is not followed by a. We 
</tt><tt>use processes which walk the graph continuously and enforce relationship 
</tt><tt>integrity as they go. We have a social graph of several hundred million 
</tt><tt>objects stored this way in Riak, and it works reasonably well.
</tt><pre style="margin: 0em;">

</pre><tt>Naturally, you'll want to choose an encoding which is fast and 
</tt><tt>space-efficient for a large dataset. Depending on your needs, JSON, 
</tt><tt>protocol buffers, or fixed-length record entries might be work well.
</tt><pre style="margin: 0em;">

</pre><tt>Also consider the depth of traversals you'll need to perform. It may be 
</tt><tt>best to use a graph database like neo4j for deep traversals. You could 
</tt><tt>store your primary dataset in Riak and replicate only the important 
</tt><tt>graph information to a graph DB via post-commit hooks. That would solve 
</tt><tt>the reciprocal consistency problem (at the cost of replication lag), and 
</tt><tt>could reduce the amount of data you need to put into the graph DB.
</tt><pre style="margin: 0em;">

</pre><tt>Given that Linkedin has this problem, you might look into their tools as 
</tt><tt>well.
</tt><pre style="margin: 0em;">

--Kyle

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
I'm guessing you mean the former, because that makes sense to me. So you
would save a graph assuming users and items like the following key/value
pairs:

//Vertices
user1: properties
user2: properties
item1: properties

//Edges
user1-owns-item1: properties
user1-follows-user2: properties
user2-follows-user1: properties

To be able to find the available edges, each vertices would need to
reference the keys of the edges. Is this what you mean?

If so, one more question about a possible problem. Say I have an item
with many many outgoing edges, so it needs to embed these references.
This would make it really costly to fetch this item from Riak I assume,
even if you are only interested in normal properties. Wouldn't that mean
you will have to save the properties seperately from the edges
references to it feasible?

Did I grasp what you were proposing Kyle?

Thanks,
Jeroen

    --Kyle


    On 11/18/2011 07:38 AM, Jeroen van Dijk wrote:

        Hi all,

        I'm currently evaluating whether Riak would fit as the main
        storage of
        my current project, a social network. The reason I am attracted
        to Riak
        and less to a Graph database as main storage is that I want the easy
        horizontal scalability and multi-site replication that Riak
        provides.
        The only thing I doubt is whether the key-value/link model of
        Riak is
        flexible enough to be able to store a property graph
        (<a  rel="nofollow" href="http://arxiv.org/abs/1006.__2361">http://arxiv.org/abs/1006.__2361</a>
        &lt;<a  rel="nofollow" href="http://arxiv.org/abs/1006.2361">http://arxiv.org/abs/1006.2361</a>&gt;). I am not asking whether the
        querying/graph traversing will be easy; I'm probably going to use a
        graph database or a Pregel like platform (e.g.
        <a  rel="nofollow" href="http://www.goldenorbos.org/">http://www.goldenorbos.org/</a>) for that problem. I guess my main
        question
        is whether it would be easy/feasible to import and export a property
        graph in and from Riak? Has someone done this before?

        I realize the above might be too specific, so here are two more
        questions that I think are relevant:

        - Is there a known upper limit of links that can be stored (I
        don't want
        to add them all at once so 1000 per request is fine,
        
<a  rel="nofollow" href="http://lists.basho.com/__pipermail/riak-users_lists.__basho.com/2010-March/000786.__html">http://lists.basho.com/__pipermail/riak-users_lists.__basho.com/2010-March/000786.__html</a>
        
&lt;<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2010-March/000786.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2010-March/000786.html</a>&gt;)
        - Is there a way to add meta data to links (edges)? E.g. weigths and
        other attributes.

        Any other ideas or advise are also highly appreciated.

        Cheers,

        Jeroen



        _________________________________________________
        riak-users mailing list
        riak-users@lists.basho.com &lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;
        <a  rel="nofollow" href="http://lists.basho.com/__mailman/listinfo/riak-users___lists.basho.com">http://lists.basho.com/__mailman/listinfo/riak-users___lists.basho.com</a>
        &lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;





_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05670.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#05671">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#05671">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05683.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05657.html">Social network data / Graph properties of Riak</a></span> <span class="sender italic">Jeroen van Dijk</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05659.html">Re: Social network data / Graph properties of Riak</a></span> <span class="sender italic">Eric Moritz</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05669.html">RE: Social network data / Graph properties of Ria...</a></span> <span class="sender italic">Jeroen van Dijk</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg05667.html">Re: Social network data / Graph properties of Riak</a></span> <span class="sender italic">Aphyr</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05670.html">RE: Social network data / Graph properties of Ria...</a></span> <span class="sender italic">Jeroen van Dijk</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Social network data / Graph properties of...</span> <span class="sender italic">Aphyr</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05683.html">Re: Social network data / Graph propertie...</a></span> <span class="sender italic">Jeroen van Dijk</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Social network data / Graph properties of Riak">
<input type="hidden" name="msgid" value="4EC6BFF5.1070902@aphyr.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05671.html">
<input type="submit" value=" Aphyr ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Social+network+data+%5C%2F+Graph+properties+of+Riak%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05670.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05683.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">4EC6BFF5.1070902@aphyr.com</li>
</ul>
</div>
</body>
</html>
