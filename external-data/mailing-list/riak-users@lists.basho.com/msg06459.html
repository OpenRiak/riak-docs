<!DOCTYPE html>
<html lang="en">
<head>
<title>efficient fetching of values falling in a key range</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06459" id="c">
<link rel="index" href="maillist.html#06459" id="i">
<link rel="prev" href="msg06458.html" id="p">
<link rel="next" href="msg06461.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06459.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22efficient+fetching+of+values+falling+in+a+key+range%22&amp;o=newest" rel="nofollow"><span itemprop="name">efficient fetching of values falling in a key range</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Dietrich+Featherston%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Dietrich Featherston</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120130" rel="nofollow">Mon, 30 Jan 2012 10:12:56 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>I'm using a leveldb-backed riak 1.0.2 and looking for some suggestions to
fetch a block of data by key range. I have control over the keys and all
reads out of this setup will involve at minimum a key range. It seems that
if leveldb is an ideal candidate for this kind of access pattern so long as
I'm able to take advantage of that in the APIs exposed by riak.</pre><pre>

First thought is to use the built-in $key index to do a query for the keys
falling in a range, then fetch the underlying objects (either directly or
via a map job). Doesn't look like this is yielding any results for a range
known to contain data, however.

Doing something like the following in the Java API yields no data

val keys =
&gt; bucket.fetchIndex(BinIndex.named(&quot;$key&quot;)).from(startKey).to(endKey).execute();


Whereas the same question phrased as a keyfilter map job does yield data

    riak.mapReduce(query)
&gt;       .addKeyFilter(new BetweenFilter(startKey, endKey))
&gt;       .addMapPhase(new NamedErlangFunction(&quot;riak_kv_mapreduce&quot;,
&gt; &quot;map_object_value&quot;), true)
&gt;       .execute()


Perhaps there is something I need to do to make sure the $key index is
built other than using the leveldb backend, but I couldn't find any
evidence of that in the docs.

Does this seem like a reasonable approach? If so, any thoughts on how I
might be reading the key index incorrectly?

Thanks,
D
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06458.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06459">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06459">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06461.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">efficient fetching of values falling in a key range</span> <span class="sender italic">Dietrich Featherston</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06461.html">Re: efficient fetching of values falling in a ke...</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06462.html">Re: efficient fetching of values falling in ...</a></span> <span class="sender italic">Dietrich Featherston</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06463.html">Re: efficient fetching of values falling...</a></span> <span class="sender italic">Dietrich Featherston</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06465.html">Re: efficient fetching of values fal...</a></span> <span class="sender italic">Russell Brown</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="efficient fetching of values falling in a key range">
<input type="hidden" name="msgid" value="CAHQXTbGUtE8ZoqHWF1hQcd9kfci2YmHCQP6t81cXowkvt4Mrzw@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06459.html">
<input type="submit" value=" Dietrich Featherston ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22efficient+fetching+of+values+falling+in+a+key+range%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06458.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06461.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAHQXTbGUtE8ZoqHWF1hQcd9kfci2YmHCQP6t81cXowkvt4Mrzw@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
