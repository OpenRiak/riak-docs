<!DOCTYPE html>
<html lang="en">
<head>
<title>RE: Cluster setup</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09556" id="c">
<link rel="index" href="maillist.html#09556" id="i">
<link rel="prev" href="msg09555.html" id="p">
<link rel="next" href="msg09557.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09556.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22RE%5C%3A+Cluster+setup%22&amp;o=newest" rel="nofollow"><span itemprop="name">RE: Cluster setup</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Kevin+Burton%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Kevin Burton</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121212" rel="nofollow">Wed, 12 Dec 2012 08:43:18 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>But when setting up a cluster on VM's there is only one public address. So
in your scenario there is only IP not IP1, IP2, IP3. So they are all equal
including the IP address which addresses the cluster. The public ports
direct traffic to individual machines. At least that is the way I understand
it and the way I have been connecting with SSH. I haven't tried it but I
suppose you could keep all of the ports private and the same and only expose
one port. But I don't know how to do that so the public port is handled
equally as the IP address.</pre><pre>

-----Original Message-----
From: Antonio Rohman Fernandez [<a  rel="nofollow" href="mailto:roh...@mahalostudio.com">mailto:roh...@mahalostudio.com</a>] 
Sent: Wednesday, December 12, 2012 10:37 AM
To: Kevin Burton
Cc: Shane McEwan; riak-users@lists.basho.com
Subject: Re: Cluster setup

You have to understand that there is no master node in Riak, all nodes are
equal, so you have as many entrypoint IPs as servers:

<a  rel="nofollow" href="http://IP1:8089/riak">http://IP1:8089/riak</a>
<a  rel="nofollow" href="http://IP2:8089/riak">http://IP2:8089/riak</a>
<a  rel="nofollow" href="http://IP3:8089/riak">http://IP3:8089/riak</a>
Etc...

You can query data, put data, delete data, etc... In any node at any time

Rohman

Sent from my iPhone

On 12/12/2012, at 17:18, &quot;Kevin Burton&quot; &lt;rkevinbur...@charter.net&gt; wrote:

&gt; On last question. Since this is a cluster there is only one public IP 
&gt; address. Doesn't that necessitate the ports being different values (ie 
&gt; 8088
&gt; -&gt; node1, 8089 -&gt; node2, 8090 -&gt; node3 or something like that)?
&gt; 
&gt; -----Original Message-----
&gt; From: Shane McEwan [<a  rel="nofollow" href="mailto:sh...@mcewan.id.au">mailto:sh...@mcewan.id.au</a>]
&gt; Sent: Wednesday, December 12, 2012 10:12 AM
&gt; To: Kevin Burton
&gt; Cc: riak-users@lists.basho.com
&gt; Subject: Re: Cluster setup
&gt; 
&gt; Looks good to me!
&gt; 
&gt; On 12/12/12 16:10, Kevin Burton wrote:
&gt;&gt; So now I have
&gt;&gt; 
&gt;&gt; [azureuser@bsicentos3 ~]$ sudo riak-admin member-status Attempting to 
&gt;&gt; restart script through sudo -H -u riak 
&gt;&gt; ================================= Membership 
&gt;&gt; ==================================
&gt;&gt; Status     Ring    Pending    Node
&gt;&gt; ---------------------------------------------------------------------
&gt;&gt; -
&gt;&gt; ------
&gt;&gt; ---
&gt;&gt; valid      32.8%      --      'riak@10.79.108.25'
&gt;&gt; valid      34.4%      --      'riak@10.79.110.52'
&gt;&gt; valid      32.8%      --      'riak@10.79.90.11'
&gt;&gt; ---------------------------------------------------------------------
&gt;&gt; -
&gt;&gt; ------
&gt;&gt; ---
&gt;&gt; Valid:3 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt;&gt; 
&gt;&gt; Does this look right?
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -----Original Message-----
&gt;&gt; From: Shane McEwan [<a  rel="nofollow" href="mailto:sh...@mcewan.id.au">mailto:sh...@mcewan.id.au</a>]
&gt;&gt; Sent: Wednesday, December 12, 2012 9:58 AM
&gt;&gt; To: Kevin Burton
&gt;&gt; Cc: riak-users@lists.basho.com
&gt;&gt; Subject: Re: Cluster setup
&gt;&gt; 
&gt;&gt; Run the join commands on the OTHER machines . . . NOT the master.
&gt;&gt; 
&gt;&gt; Use the master's IP address in the join commands but the actual 
&gt;&gt; command must be run on the non-master machines. You're telling the
&quot;slave&quot;
&gt;&gt; machines to join the cluster by telling them which machine they need 
&gt;&gt; to talk to to get the cluster information.
&gt;&gt; 
&gt;&gt; On 12/12/12 15:51, Kevin Burton wrote:
&gt;&gt;&gt; *So again from the master I do 'sudo riak-admin cluster join
&gt;&gt;&gt; riak@10.79.90.11 &lt;<a  rel="nofollow" href="mailto:riak@10.79.90.11">mailto:riak@10.79.90.11</a>&gt;' but I get:*
&gt;&gt;&gt; 
&gt;&gt;&gt; [sudo] password for azureuser:
&gt;&gt;&gt; 
&gt;&gt;&gt; Attempting to restart script through sudo -H -u riak
&gt;&gt;&gt; 
&gt;&gt;&gt; Failed: This node is already a member of a cluster
&gt;&gt;&gt; 
&gt;&gt;&gt; *Looking at the plan:*
&gt;&gt;&gt; 
&gt;&gt;&gt; [azureuser@bsicentos1 ~]$ sudo riak-admin cluster plan
&gt;&gt;&gt; 
&gt;&gt;&gt; Attempting to restart script through sudo -H -u riak
&gt;&gt;&gt; 
&gt;&gt;&gt; =============================== Staged Changes 
&gt;&gt;&gt; ================================
&gt;&gt;&gt; 
&gt;&gt;&gt; Action         Nodes(s)
&gt;&gt;&gt; 
&gt;&gt;&gt; --------------------------------------------------------------------
&gt;&gt;&gt; -
&gt;&gt;&gt; -
&gt;&gt;&gt; ---------
&gt;&gt;&gt; 
&gt;&gt;&gt; join           'riak@10.79.108.25'
&gt;&gt;&gt; 
&gt;&gt;&gt; --------------------------------------------------------------------
&gt;&gt;&gt; -
&gt;&gt;&gt; -
&gt;&gt;&gt; ---------
&gt;&gt;&gt; 
&gt;&gt;&gt; NOTE: Applying these changes will result in 1 cluster transition
&gt;&gt;&gt; 
&gt;&gt;&gt; ####################################################################
&gt;&gt;&gt; #
&gt;&gt;&gt; #
&gt;&gt;&gt; #########
&gt;&gt;&gt; 
&gt;&gt;&gt;                           After cluster transition 1/1
&gt;&gt;&gt; 
&gt;&gt;&gt; ####################################################################
&gt;&gt;&gt; #
&gt;&gt;&gt; #
&gt;&gt;&gt; #########
&gt;&gt;&gt; 
&gt;&gt;&gt; ================================= Membership 
&gt;&gt;&gt; ==================================
&gt;&gt;&gt; 
&gt;&gt;&gt; Status     Ring    Pending    Node
&gt;&gt;&gt; 
&gt;&gt;&gt; --------------------------------------------------------------------
&gt;&gt;&gt; -
&gt;&gt;&gt; -
&gt;&gt;&gt; ---------
&gt;&gt;&gt; 
&gt;&gt;&gt; valid       0.0%     50.0%    'riak@10.79.108.25'
&gt;&gt;&gt; 
&gt;&gt;&gt; valid     100.0%     50.0%    'riak@10.79.110.52'
&gt;&gt;&gt; 
&gt;&gt;&gt; --------------------------------------------------------------------
&gt;&gt;&gt; -
&gt;&gt;&gt; -
&gt;&gt;&gt; ---------
&gt;&gt;&gt; 
&gt;&gt;&gt; Valid:2 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt;&gt;&gt; 
&gt;&gt;&gt; WARNING: Not all replicas will be on distinct nodes
&gt;&gt;&gt; 
&gt;&gt;&gt; Transfers resulting from cluster changes: 32
&gt;&gt;&gt; 
&gt;&gt;&gt;    32 transfers from 'riak@10.79.110.52' to 'riak@10.79.108.25'
&gt;&gt;&gt; 
&gt;&gt;&gt; *I don't see riak@10.79.90.11 &lt;<a  rel="nofollow" href="mailto:riak@10.79.90.11">mailto:riak@10.79.90.11</a>&gt; in the
&gt;&gt;&gt; cluster.*
&gt;&gt;&gt; 
&gt;&gt;&gt; -----Original Message-----
&gt;&gt;&gt; From: Shane McEwan [<a  rel="nofollow" href="mailto:sh...@mcewan.id.au">mailto:sh...@mcewan.id.au</a>]
&gt;&gt;&gt; Sent: Wednesday, December 12, 2012 9:43 AM
&gt;&gt;&gt; To: Kevin Burton
&gt;&gt;&gt; Cc: riak-users@lists.basho.com
&gt;&gt;&gt; Subject: Re: Cluster setup
&gt;&gt;&gt; 
&gt;&gt;&gt; There's no need to join the &quot;master&quot; to itself. Just join the other 
&gt;&gt;&gt; nodes to the master.
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09555.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09556">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09556">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09557.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li><ul>
<li><ul>
<li><ul>
<li><ul>
<li><ul>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09546.html">Re: Cluster setup</a></span> <span class="sender italic">Shane McEwan</span></li>
<li class="icons-email"><span class="subject"><a href="msg09547.html">RE: Cluster setup</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg09548.html">Re: Cluster setup</a></span> <span class="sender italic">Shane McEwan</span></li>
<li class="icons-email"><span class="subject"><a href="msg09549.html">RE: Cluster setup</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg09550.html">Re: Cluster setup</a></span> <span class="sender italic">Shane McEwan</span></li>
<li class="icons-email"><span class="subject"><a href="msg09551.html">RE: Cluster setup</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg09552.html">RE: Cluster setup</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg09553.html">Re: Cluster setup</a></span> <span class="sender italic">Shane McEwan</span></li>
<li class="icons-email"><span class="subject"><a href="msg09554.html">RE: Cluster setup</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg09555.html">Re: Cluster setup</a></span> <span class="sender italic">Antonio Rohman Fernandez</span></li>
<li class="icons-email tSliceCur"><span class="subject">RE: Cluster setup</span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg09557.html">Re: Cluster setup</a></span> <span class="sender italic">Antonio Rohman Fernandez</span></li>
<li class="icons-email"><span class="subject"><a href="msg09558.html">RE: Cluster setup</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg09567.html">Re: Cluster setup</a></span> <span class="sender italic">Jared Morrow</span></li>
<li class="icons-email"><span class="subject"><a href="msg09540.html">RE: Cluster setup</a></span> <span class="sender italic">Kevin Burton</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg09514.html">Re: Cluster setup</a></span> <span class="sender italic">rkevinburton</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="RE: Cluster setup">
<input type="hidden" name="msgid" value="00da01cdd887$c665b030$53311090$@charter.net">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09556.html">
<input type="submit" value=" Kevin Burton ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22RE%5C%3A+Cluster+setup%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09555.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09557.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">00da01cdd887$c665b030$53311090$@charter.net</li>
</ul>
</div>
</body>
</html>
