<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Should Riak have used dedicated nodes for secondary indices?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06403" id="c">
<link rel="index" href="maillist.html#06403" id="i">
<link rel="prev" href="msg06402.html" id="p">
<link rel="next" href="msg06406.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06403.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Should+Riak+have+used+dedicated+nodes+for+secondary+indices%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Should Riak have used dedicated nodes for secondary indices?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeremiah+Peschka%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeremiah Peschka</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120125" rel="nofollow">Wed, 25 Jan 2012 06:49:24 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Good news! Riak doesn't use sharding.

Data locality is critical in a distributed system. When you create an
index, your structure looks something like:</pre><pre>

indexed_value:record_id

Reading from an index requires locating indexed_value, finding all matching
values, and then retrieving all matching record_ids. By keeping index data
on the same node as the source data, Riak avoids having to remote the query
to retrieve object data. This is a Good Thing. The network is slow and
unreliable. Just ask an Australian.

Riak's approach is intended to provide a uniform system where you can treat
any node equally. The idea that there should be an unsharded index node is
a bit ludicrous. Let's say you have 1TB of raw data. Your indexes are
pretty light and are only about 20% of your data size. This means that you
need 200GB of good storage (not some cheap $150 SATA HDD you found on
NewEgg). 200GB of RAID 10 SAS storage isn't that pricey to put in a single
unsharded machine. Over time as your data grows and your indexing changes,
you may have 10TB and your index size is ~40% of your data. Your unsharded
index server now has to have 4TB of fast, reliable storage. And, since this
is an unsharded system, you'll want multiple replicas of your unsharded
index server to make sure that a hardware hiccup doesn't take down your
ability to perform fast lookups. Besides - a single indexing server becomes
a single bottleneck and a single point of failure in your system.

Most people using Lucene as their indexing store are sharding Lucene. From
an anecdotal standpoint, about 70% of the people I've talked to using
Lucene are getting to the point of sharding their replicated Lucene indexes.

I'm not saying that either approach is good or bad; just remember that
every solution has drawbacks.
---
Jeremiah Peschka, SQL Server MVP
Managing Director, Brent Ozar PLF, LLC


On Wed, Jan 25, 2012 at 5:15 AM, Runar Jordahl &lt;runar.jord...@gmail.com&gt;wrote:

&gt; Siddharth Anand, says that secondary indices (for a key-value store)
&gt; best is placed on a separate node, avoiding the need to look up 1 / N
&gt; nodes during a query:
&gt;
&gt; &quot;Systems that shard data based on a primary key will do well when
&gt; routed by that key. When routed by a secondary key, the system will
&gt; need to “spray” a query across all shards. If one of the shards is
&gt; experiencing high latency, the system will return either no results or
&gt; incomplete (i.e. inconsistent) results. For this reason, it would make
&gt; sense to store the secondary index on an unsharded (but replicated)
&gt; system.&quot;
&gt;
&gt; <a  rel="nofollow" href="http://highscalability.com/blog/2012/1/24/the-state-of-nosql-in-2012.html">http://highscalability.com/blog/2012/1/24/the-state-of-nosql-in-2012.html</a>
&gt;
&gt; If I understand Riak correctly, it takes the opposite approach,
&gt; storing secondary indices together with the data.
&gt;
&gt; To me at appears like Riak’s approach gives a more uniform system,
&gt; with all nodes having the same responsibilities. Does anyone else have
&gt; any thoughts on this?
&gt;
&gt; Kind regards
&gt; Runar Jordahl
&gt; blog.epigent.com
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06402.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06403">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06403">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06406.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg06402.html">Should Riak have used dedicated nodes for secondary indic...</a></span> <span class="sender italic">Runar Jordahl</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Should Riak have used dedicated nodes for second...</span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06406.html">unsubscribe</a></span> <span class="sender italic">Roberto Calero</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06409.html">Re: unsubscribe</a></span> <span class="sender italic">Ryan Zezeski</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Should Riak have used dedicated nodes for secondary indices?">
<input type="hidden" name="msgid" value="CACJEN2pr-TfewH7AmG-szcoZS5YhkoXDtigyr4366TtkE2uQ=Q@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06403.html">
<input type="submit" value=" Jeremiah Peschka ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Should+Riak+have+used+dedicated+nodes+for+secondary+indices%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06402.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06406.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACJEN2pr-TfewH7AmG-szcoZS5YhkoXDtigyr4366TtkE2uQ=Q@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
