<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak performance issue with many connected objects (11 million +)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#08424" id="c">
<link rel="index" href="maillist.html#08424" id="i">
<link rel="prev" href="msg08422.html" id="p">
<link rel="next" href="msg08426.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg08424.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+performance+issue+with+many+connected+objects+%5C%2811+million+%5C%2B%5C%29%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak performance issue with many connected objects (11 million +)</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jared+Morrow%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jared Morrow</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120831" rel="nofollow">Fri, 31 Aug 2012 10:41:02 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>*My first reply bounced due to it being too big, so I'll try again with
your original email shortened.   So pardon duplicate replies if it did in
fact go through.*</pre><pre>

Lei,

One issue that stands out is that you are running a single-node cluster.
With a n_val of 3, you will be storing 3 copies of every piece of data on
that one node.  Also, if you are doing a read with a r of 3, you are
waiting for the data to be read three times from a single node.  If
possible, consider making a larger cluster (even with smaller machines) to
get a better idea about how Riak operates.  We recommend a minimum of five
physical nodes for a n_val of 3.  If you lower your n_val you can possibly
lower your physical node count and still get good performance at the
sacrifice of higher availability.

Given all of the above, it is still unusual that your reads *never* return.
 There might be another issue there irregardless of cluster size.  When you
say &quot;connected&quot; objects, are you referring to links and link-walking?   If
so, how deep are you going with your links?  Some context here would be
helpful.

Thanks,
Jared

On Fri, Aug 31, 2012 at 9:54 AM, Lei Gu &lt;l...@e-dialog.com&gt; wrote:

&gt; I started performance testing Riak by loading 11 million connected objects
&gt; in Riak. Loading has not been an issue, although it did take a long time.
&gt; Now when I tried to access an object, Riak never returns and was using
&gt; 100% of CPU and 74% of memory.
&gt;
&gt;   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
&gt;  8952 riak      20   0 23.4g  11g 1708 S 100.6 74.1   1520:49 beam.smp
&gt; &lt;snip&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg08422.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#08424">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#08424">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg08426.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg08422.html">Riak performance issue with many connected objects (11 millio...</a></span> <span class="sender italic">Lei Gu</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak performance issue with many connected objects (...</span> <span class="sender italic">Jared Morrow</span></li>
<li class="icons-email"><span class="subject"><a href="msg08426.html">Re: Riak performance issue with many connected objects (...</a></span> <span class="sender italic">Lei Gu</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak performance issue with many connected objects (11 million +)">
<input type="hidden" name="msgid" value="CACUSOvd0w9tA9CmOwydsA_sNrA0=1Bf_qPbg8=5JteNiL-Yqaw@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg08424.html">
<input type="submit" value=" Jared Morrow ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+performance+issue+with+many+connected+objects+%5C%2811+million+%5C%2B%5C%29%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg08422.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg08426.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACUSOvd0w9tA9CmOwydsA_sNrA0=1Bf_qPbg8=5JteNiL-Yqaw@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
