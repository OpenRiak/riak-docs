<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Map Reduce Requirements</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04419" id="c">
<link rel="index" href="maillist.html#04419" id="i">
<link rel="prev" href="msg04415.html" id="p">
<link rel="next" href="msg04424.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04419.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Map+Reduce+Requirements%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Map Reduce Requirements</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeremiah+Peschka%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeremiah Peschka</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110823" rel="nofollow">Tue, 23 Aug 2011 07:01:46 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>On Aug 22, 2011, at 8:50 PM, bill robertson wrote:

&gt; I wonder if it would be feasible to deploy an erlang web-service in the riak 
&gt; node's webmachine instance that could translate meta-data into Erlang funs 
&gt; and drive the map reduce operation that way. I'm not sure if I could get 
&gt; around having specific knowledge of the protobuf structures baked into that 
&gt; code, but I don't think it matters in this case.
&gt; 
&gt; I also wonder how much 1.0 will change this picture.
&gt; 
&gt; &gt; Additionally, are secondary indexes meta-data?  i.e. If I built some 
&gt; &gt; secondary indices, these are stored in some form internal to Riak, and 
&gt; &gt; therefore available for query regardless of the type of data its associated 
&gt; &gt; with. Is this correct?
&gt; 
&gt; Secondary indexes are a separate physical structure, or so I gather. (Rusty 
&gt; could be full of lies.) They're stored separately from the initial data and 
&gt; not as metadata in the object headers. So, yes, you can store whatever you 
&gt; want in secondary indexes and query it however you want, provided there's an 
&gt; API that supports what you're doing.
&gt; 
&gt; Would secondary indexes eliminate the need for key-filtering? Logically, it 
&gt; would seem that you could do with indexes, but do they have similar 
&gt; performance characteristics?  (i.e. does one suck more than the other?)</pre><pre>

Key filters will always perform a list-keys operation. Meaning that they result 
in an in memory scan of all keys in the key space. 

Not knowing entirely how indexes are implemented internally (reading the source 
is on my TO DO list), I can only guess from my experience with other databases 
how this would work. Indexes generally work best when you have a low search 
cardinality - when you're seeking only a few records from the index. As long as 
you can structure secondary indexes to answer the questions you're asking, then 
indexes make it easy to perform fast queries. 

The difference comes in based on your storage mechanism. With bitcask, all keys 
are in memory so that list-keys scan only happens between RAM and CPU and isn't 
THAT expensive of an operation. If indexes are not a memory resident structure, 
then a scan of an index (when you're doing a search that's some kind of 
substring or ends with operation) will be painfully slow - much like when you 
have to perform a table scan in an RDBMS.

The upside of key filtering, and composite key names in general, is that you 
can create meaningful keys that you can assemble on the fly. e.g. To get 
yesterday's trades of Ford stock in the NYSE, (assuming you have a trades 
bucket) you could get at yesterday's trading history through something like 
<a  rel="nofollow" href="http://my_riak_server:8091/riak/trades/NYSE:F:20110822">http://my_riak_server:8091/riak/trades/NYSE:F:20110822</a> Being able to perform ad 
hoc seeks like that is really powerful.

TL;DR - key filters and secondary indexes serve different purposes.

&gt; 
&gt; Thanks again,
&gt; Bill Robertson


---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP
_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04415.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04419">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04419">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04424.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg04406.html">Map Reduce Requirements</a></span> <span class="sender italic">bill robertson</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04407.html">Re: Map Reduce Requirements</a></span> <span class="sender italic">Will Moss</span></li>
<li class="icons-email"><span class="subject"><a href="msg04408.html">Re: Map Reduce Requirements</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04409.html">Fwd: Map Reduce Requirements</a></span> <span class="sender italic">bill robertson</span></li>
<li class="icons-email"><span class="subject"><a href="msg04410.html">Re: Map Reduce Requirements</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04415.html">Re: Map Reduce Requirements</a></span> <span class="sender italic">bill robertson</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Map Reduce Requirements</span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04424.html">Re: Map Reduce Requirements</a></span> <span class="sender italic">Brian Rowe</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Map Reduce Requirements">
<input type="hidden" name="msgid" value="00137898-30C1-4BD4-A822-FB518B555510@gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04419.html">
<input type="submit" value=" Jeremiah Peschka ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Map+Reduce+Requirements%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04415.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04424.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">00137898-30C1-4BD4-A822-FB518B555510@gmail.com</li>
</ul>
</div>
</body>
</html>
