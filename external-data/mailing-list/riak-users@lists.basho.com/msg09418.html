<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Erlang MR bulk fetch</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd5.html#09418" id="c">
<link rel="index" href="mail5.html#09418" id="i">
<link rel="prev" href="msg09417.html" id="p">
<link rel="next" href="msg09918.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09418.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Erlang+MR+bulk+fetch%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Erlang MR bulk fetch</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Elias+Levy%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Elias Levy</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121202" rel="nofollow">Sun, 02 Dec 2012 17:31:11 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>I should mention that I can't use the existing map_identify function.
 Doing so causes the PB connection to die.  Presumably there is some binary
data within the RObject that cases an error when Riak tries to convert it
to JSON.</pre><pre>


On Sun, Dec 2, 2012 at 5:26 PM, Elias Levy &lt;fearsome.lucid...@gmail.com&gt;wrote:

&gt; While processing a request I am finding that I am spending most of my time
&gt; fetching data from Riak.  As I am using the Ruby client I can't
&gt; parallelise them, as it does not support non-blocking IO and I don't want
&gt; to spawn many threads.
&gt;
&gt; For these requests I am willing to accept an R of 1, so I can use a MR job
&gt; as a bulk fetch, but I would prefer to avoid the JS VM, as its rather
&gt; slow and I don't want to worry about running out of VMs at the wrong time.
&gt;
&gt; I can easily fetch the values using only Erlang MR by adding the keys to
&gt; my MR object and doing
&gt;
&gt;     map([&quot;riak_kv_mapreduce&quot;, &quot;map_object_value&quot;], :arg =&gt; [ true ],
&gt; :keep =&gt; true).
&gt;
&gt; but this gives me an array of values.  I need to to know the which values
&gt; are associated with what key, and my values do not include the key or
&gt; otherwise allow me to map them.
&gt;
&gt; From looking at the Riak code there does not seem to exist an exported
&gt; Erlang map function that will return a value with its key.
&gt;
&gt; Did I miss one?  Is such a function somewhere in the source?  If not,
&gt; anyone have one handy they'd like to share?
&gt;
&gt;
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09417.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd5.html#09418">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail5.html#09418">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09918.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg09417.html">Erlang MR bulk fetch</a></span> <span class="sender italic">Elias Levy</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Erlang MR bulk fetch</span> <span class="sender italic">Elias Levy</span></li>
<li class="icons-email"><span class="subject"><a href="msg09918.html">Re: Erlang MR bulk fetch</a></span> <span class="sender italic">Mark Phillips</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10019.html">Re: Erlang MR bulk fetch</a></span> <span class="sender italic">alexmoore</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg10024.html">Re: Erlang MR bulk fetch</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg10375.html">Re: Erlang MR bulk fetch</a></span> <span class="sender italic">liuhuan123</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10377.html">Re: Erlang MR bulk fetch</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Erlang MR bulk fetch">
<input type="hidden" name="msgid" value="CAFDmHdP-qgPJ_HaCwTDc-dY6jXbu+5yu2u28Dt7ZtEieQCCoZA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09418.html">
<input type="submit" value=" Elias Levy ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Erlang+MR+bulk+fetch%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09417.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09918.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAFDmHdP-qgPJ_HaCwTDc-dY6jXbu+5yu2u28Dt7ZtEieQCCoZA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
