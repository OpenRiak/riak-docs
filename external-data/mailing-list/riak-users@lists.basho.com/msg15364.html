<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Do developers need to sanitize JSON input before sending to	Riak Client?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#15364" id="c">
<link rel="index" href="maillist.html#15364" id="i">
<link rel="prev" href="msg15363.html" id="p">
<link rel="next" href="msg15357.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15364.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Do+developers+need+to+sanitize+JSON+input+before+sending+to%09Riak+Client%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Do developers need to sanitize JSON input before sending to	Riak Client?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22J.+Austin+Hughey%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">J. Austin Hughey</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20141213" rel="nofollow">Sat, 13 Dec 2014 02:24:08 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Just wanted to say thanks again to everyone for the insight here. I fully agree 
with the “security mindset” (hence my starting this chain) and am aware of the 
need to prevent external access to Riak nodes (I’ll probably just use iptables 
to prevent access from everywhere except known application machines and use 
them as bastion host for SSH/admin).</pre><pre>

&gt; Exactly, SQL injection happens because people construct SQL statements 
&gt; themselves and aren’t aware of correct escaping edge cases. Use a library to 
&gt; convert between Ruby and JSON, and you’ll be fine on that front.

This is the core of what I was asking, really. I’ve seen problems in various 
SQL libraries/ORMs (ActiveRecord for example) where specially crafted strings, 
even passed into the library/sanitizer, can still trigger injection. I just 
haven’t done anything using JSON for a data store before so I wanted to get a 
clear picture of how to do it *right* before I did it wrong :-)

Thanks again!

--  
J. Austin Hughey

On December 12, 2014 at 5:24:07 PM, Jason Campbell 
(xia...@xiaclo.net(<a  rel="nofollow" href="mailto:xia...@xiaclo.net">mailto:xia...@xiaclo.net</a>)) wrote:

&gt; Exactly, SQL injection happens because people construct SQL statements 
&gt; themselves and aren’t aware of correct escaping edge cases. Use a library to 
&gt; convert between Ruby and JSON, and you’ll be fine on that front. The same 
&gt; applies to SQL really. SQL injection is impossible if you pass Ruby objects 
&gt; directly into an SQL library and let it escape them.
&gt;  
&gt; Security as a topic is much too large to cover in a mailing list, but the 
&gt; same principle applies. Use proven libraries, and don’t try to do too much 
&gt; security yourself. It’s hard, and you will most likely get it wrong. 
&gt; Especially crypto.
&gt;  
&gt; Specific to Riak though, ensure you lock it down. It applies to any database 
&gt; really, but if you can, remove any direct internet access from the boxes, 
&gt; firewall every port you can. If you are using protocol buffers, you can 
&gt; disable HTTP access as well, it makes it a bit harder for an attacker. Run 
&gt; Riak on a non-standard port, firewall communication between the Riak nodes. 
&gt; Riak can also use a TLS certificate to encrypt handoff traffic which can 
&gt; prevent data interception between Riak nodes.
&gt;  
&gt; That is by no means a complete list, but a starting point at least. Security 
&gt; is a mindset, remove anything you don’t need, because the more tools you give 
&gt; an attacker, the worse things get, even if you think they are harmless.
&gt;  
&gt; Hope that helps,
&gt; Jason
&gt;  
&gt; &gt; On 13 Dec 2014, at 02:28, Kyle Marek-Spartz wrote:
&gt; &gt;
&gt; &gt; Ruby should &quot;do the right thing&quot; and escape your content appropriately,
&gt; &gt; that is, if you have a Ruby hash of:
&gt; &gt;
&gt; &gt; {'test' =&gt; 'yes&quot;, &quot;injection&quot;: &quot;oops!&quot;'}
&gt; &gt;
&gt; &gt; JSON.dump will give you:
&gt; &gt;
&gt; &gt; {&quot;test&quot;:&quot;yes\&quot;, \&quot;injection\&quot;: \&quot;oops!\&quot;&quot;}
&gt; &gt;
&gt; &gt;
&gt; &gt; J. Austin Hughey writes:
&gt; &gt;
&gt; &gt;&gt; Thank you very much for the explanation, Jason. My example attack was 
&gt; &gt;&gt; probably a bit “off”, but the basic use case I’m thinking of is an API. 
&gt; &gt;&gt; Say I have an API that accepts JSON. The user has “spoofed” the JSON input 
&gt; &gt;&gt; to the API, possibly setting an “admin” flag or something (doesn’t matter 
&gt; &gt;&gt; what, specifically, just an example of how a property may be set). 
&gt; &gt;&gt; Assuming no other business logic validation (which of course I DEFINITELY 
&gt; &gt;&gt; plan to implement), I was simply curious if, when sending info directly to 
&gt; &gt;&gt; Riak as JSON, if the client did anything to sanitize input from injection.
&gt; &gt;&gt;
&gt; &gt;&gt; Think SQL injection, but JSON instead. Data is data, representation 
&gt; &gt;&gt; implementation differs, but the same concerns apply. I’m just trying to 
&gt; &gt;&gt; see what I need to do to prevent that injection-style attack from 
&gt; &gt;&gt; happening.
&gt; &gt;&gt;
&gt; &gt;&gt; Sounds like, based on your response (thanks again, by the way!), I need to 
&gt; &gt;&gt; validate the Ruby object after it’s created and ensure no invalid 
&gt; &gt;&gt; attributes or values exist, prior to its being sent to Riak.
&gt; &gt;&gt;
&gt; &gt;&gt; Any additional thoughts on other security concerns I should have here? I’m 
&gt; &gt;&gt; new to “NoSQL” and I like Riak due to its operational model, so I’d like 
&gt; &gt;&gt; to use it more often. I just need to know what I’m doing before I put an 
&gt; &gt;&gt; app out into the wild!
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks again.
&gt; &gt;
&gt; &gt; --
&gt; &gt; Kyle Marek-Spartz
&gt;  


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15363.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#15364">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#15364">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15357.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg15356.html">Do developers need to sanitize JSON input before sending...</a></span> <span class="sender italic">J. Austin Hughey</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15358.html">Re: Do developers need to sanitize JSON input befor...</a></span> <span class="sender italic">Jason Campbell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15359.html">Re: Do developers need to sanitize JSON input b...</a></span> <span class="sender italic">J. Austin Hughey</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15360.html">Re: Do developers need to sanitize JSON inp...</a></span> <span class="sender italic">Kyle Marek-Spartz</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15363.html">Re: Do developers need to sanitize JSON...</a></span> <span class="sender italic">Jason Campbell</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Do developers need to sanitize...</span> <span class="sender italic">J. Austin Hughey</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Do developers need to sanitize JSON input before sending to	Riak Client?">
<input type="hidden" name="msgid" value="etPan.548c139e.74b0dc51.421@Js-MacBook-Pro.local">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15364.html">
<input type="submit" value=" J. Austin Hughey ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Do+developers+need+to+sanitize+JSON+input+before+sending+to%09Riak+Client%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15363.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15357.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">etPan.548c139e.74b0dc51.421@Js-MacBook-Pro.local</li>
</ul>
</div>
</body>
</html>
