<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak-python-client2, a rewrite of the official client</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06971" id="c">
<link rel="index" href="maillist.html#06971" id="i">
<link rel="prev" href="msg06970.html" id="p">
<link rel="next" href="msg06974.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06971.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak%5C-python%5C-client2%2C+a+rewrite+of+the+official+client%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak-python-client2, a rewrite of the official client</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Shuhao+Wu%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Shuhao Wu</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120315" rel="nofollow">Thu, 15 Mar 2012 11:16:14 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>The things you like to see is also what I like to see, and it's what I have
already done/is in progress.</pre><pre>

The main part of the code that I feel is very messy is the fact that the
transport completely depends on RiakBucket and RiakObject and RiakObject
and RiakBucket does essentially nothing.

I'm changing it so that the transports and what not could operate
*independently* from the rest of the framework.

If you have the time, take a look at my current source code and the
docstrings. Any suggestions for future work will be appreciated.

Cheers,

Shuhao



On Thu, Mar 15, 2012 at 2:08 PM, Armon Dadgar &lt;armon.dad...@gmail.com&gt;
wrote:
&gt;&gt; Message: 4
&gt;&gt; Date: Thu, 15 Mar 2012 11:13:03 -0400
&gt;&gt; From: Shuhao Wu &lt;ad...@thekks.net&gt;
&gt;&gt; To: &quot;Andrey V. Martyanov&quot; &lt;reald...@gmail.com&gt;
&gt;&gt; Cc: riak-users@lists.basho.com
&gt;&gt; Subject: Re: riak-python-client2, a rewrite of the official client
&gt;&gt; Message-ID:
&gt;&gt;       &lt;CAP1J66d0VmsV0VKx+W849tE2KM8_S7wMW5ta=a9+munncxu...@mail.gmail.com
&gt;
&gt;&gt; Content-Type: text/plain; charset=ISO-8859-1
&gt;&gt;
&gt;&gt; I'm looked into just modifying and contributing to the existing library,
and
&gt;&gt; found several issues with it. Here's my main motivation for a rewrite:
&gt;&gt;
&gt;&gt; ? 1. The current structure riak-python-client is somewhat messy.
Everything
&gt;&gt;     depends on each other. Just look at things like RiakLink and
&gt;&gt; RiakIndexEntry.
&gt;&gt;     They're unnecessary and overcomplicates the code. Furthermore, if
you look
&gt;&gt;     the transports, it's very much dependent on things like RiakObject,
and
&gt;&gt;     RiakObject is pretty much nothing without the transport. It's almost
like a
&gt;&gt;     circular dependency. So instead, I redesigned the transports to
operate
&gt;&gt;     independently from things like RiakObject. To do this, simply
modifying
&gt;&gt;     is not feasible and it will result in an almost complete rewrite
anyway due
&gt;&gt;     to the dependencies problems I described.
&gt;&gt;  2. There's a lot of &quot;bloat&quot; in the current riak-python-client. A simple
&gt;&gt;     example would be get_ and set_, as well as things like RiakLink and
&gt;&gt;     RiakIndexEntry. To get rid of those would pretty much require a
rewrite as
&gt;&gt;     well.
&gt;&gt;  3. Basho currently do not have a dedicated python developer working on
this.
&gt;&gt;     I don't know this for sure but I think their resources, in terms
&gt;&gt; of clients,
&gt;&gt;     go mainly to java, ruby and javascript, though that's just my
observations.
&gt;&gt;
&gt;&gt; My primary goal of having a rewrite is hopefully simplify the code base
as well
&gt;&gt; as improve some aspects of the python client (such as not using
deprecated
&gt;&gt; functions such as apply) and (hopefully) increase the speed of the
client.
&gt;&gt; After examining the code (which I had to do while rewriting), I don't
think
&gt;&gt; simply modifying the current codebase could fix its issues (there are
more
&gt;&gt; issues then what I've stated), and I don't think it will take as long as
people
&gt;&gt; think. The current code base has about 4k lines of python and 0.5k lines
of
&gt;&gt; Erlang. In my client, a chunk of the code actually comes from the
original
&gt;&gt; client as they work with a few adaptations.
&gt;&gt;
&gt;&gt; As far as road map goes, I'm currently just rewriting all the
functionalities
&gt;&gt; provided by the current python client, and here's a list of things that
Sean
&gt;&gt; would like to see accomplished, which I will work on once I have all the
&gt;&gt; functionalities of the current client complete:
&gt;&gt;
&gt;&gt;    <a  rel="nofollow" href="https://gist.github.com/1959278">https://gist.github.com/1959278</a>
&gt;&gt;
&gt;&gt; I hope I've answered all the questions. If there is any more
questions/comments,
&gt;&gt; feel free to shoot it my way.
&gt;&gt;
&gt;&gt; Shuhao
&gt;&gt;
&gt;
&gt; I agree that the Python client does need some work to clean it up,
&gt; and make it more idiomatic Python, but I'm not sure that a total rewrite
&gt; is necessary.
&gt;
&gt; Most of the abstractions are good, but they just need a bit of cleanup.
&gt; I think there is always a tendency to assume things are unnecessarily
messy,
&gt; but once you get to rewriting it you end up running into the pain points
that
&gt; drove those design decisions.
&gt;
&gt; If there is interest, we could just formulate a roadmap for the a set of
breaking
&gt; changes to the existing client, and release it as a new version of the
same project.
&gt;
&gt; Things I would like to see:
&gt;  * Cleanup the transport interface
&gt;  * RiakObject needs to be simplified
&gt;  * Support a RiakJSONObject subclass which has the encoding logic that is
inside RiakObject now
&gt;  * Indexes need to be cleaned up
&gt;  * MapReduce interfaces feel a bit dirty
&gt;  * Much improved exception hierarchy
&gt;  * RiakClient / RiakBucket interface needs to cleaned up
&gt;
&gt; Best Regards,
&gt;
&gt; Armon Dadgar
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06970.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06971">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06971">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06974.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg06936.html">riak-python-client2, a rewrite of the official client</a></span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06938.html">Re: riak-python-client2, a rewrite of the officia...</a></span> <span class="sender italic">Jim Adler</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06961.html">Re: riak-python-client2, a rewrite of the off...</a></span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06964.html">Re: riak-python-client2, a rewrite of the...</a></span> <span class="sender italic">Russell Brown</span></li>
<li class="icons-email"><span class="subject"><a href="msg06966.html">Re: riak-python-client2, a rewrite of the...</a></span> <span class="sender italic">Andrey V. Martyanov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06967.html">Re: riak-python-client2, a rewrite of...</a></span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06968.html">Re: riak-python-client2, a rewri...</a></span> <span class="sender italic">Andrey V. Martyanov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06969.html">Re: riak-python-client2, a r...</a></span> <span class="sender italic">Shuhao Wu</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg06982.html">Re: riak-python-client2, a rewri...</a></span> <span class="sender italic">Greg Stein</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg06970.html">Re: riak-python-client2, a rewrite of the officia...</a></span> <span class="sender italic">Armon Dadgar</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak-python-client2, a rewrite of the off...</span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06974.html">Re: riak-python-client2, a rewrite of the...</a></span> <span class="sender italic">Sean Cribbs</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg06983.html">Re: riak-python-client2, a rewrite of the off...</a></span> <span class="sender italic">Greg Stein</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak-python-client2, a rewrite of the official client">
<input type="hidden" name="msgid" value="CAP1J66d4VCmqzg6jfqaH7Fq7cQWvrCrcvNL5wujWLqt8+nfJ2Q@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06971.html">
<input type="submit" value=" Shuhao Wu ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak%5C-python%5C-client2%2C+a+rewrite+of+the+official+client%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06970.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06974.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAP1J66d4VCmqzg6jfqaH7Fq7cQWvrCrcvNL5wujWLqt8+nfJ2Q@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
