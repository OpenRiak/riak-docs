<!DOCTYPE html>
<html lang="en">
<head>
<title>Handoff stalled on 1.0.2 riak cluster</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07598" id="c">
<link rel="index" href="maillist.html#07598" id="i">
<link rel="prev" href="msg07596.html" id="p">
<link rel="next" href="msg07599.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07598.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Handoff+stalled+on+1.0.2+riak+cluster%22&amp;o=newest" rel="nofollow"><span itemprop="name">Handoff stalled on 1.0.2 riak cluster</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22John+Axel+Eriksson%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">John Axel Eriksson</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120603" rel="nofollow">Sun, 03 Jun 2012 02:07:04 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi.

We had an issue where one of the riak servers died (had to be force removed
from cluster). After we did that things got really bad and most data was
unreachable for hours. I added a new node to replace the old one at one
point as well - that never got any data and even now about a day later it
hasn't gotten any data.
What seems to be the issue now is that there are a few nodes are waiting on
handoff of 1 partition. When I look at ring_status I see this:</pre><pre>

Attempting to restart script through sudo -u riak
================================== Claimant
===================================
Claimant:  'riak@r-001.x.x.x
Status:     up
Ring Ready: true

============================== Ownership Handoff
==============================
Owner:      riak@r-004.x.x.x
Next Owner: riak@r-003.x.x.x

Index: 930565495644285842450002452081070828921550798848
  Waiting on: []
  Complete:   [riak_kv_vnode,riak_pipe_vnode,riak_search_vnode]

-------------------------------------------------------------------------------

============================== Unreachable Nodes
==============================
All nodes are up and reachable


Ok, so it looks like the problem described in the Release Notes for 1.0.2
here <a  rel="nofollow" href="https://github.com/basho/riak/blob/1.0.2-release/RELEASE-NOTES.org">https://github.com/basho/riak/blob/1.0.2-release/RELEASE-NOTES.org</a>.
Unfortunately I've run that code (through riak attach) with no result.

It's been in this state for 12 hours now I think. What can we do to fix our
cluster?

I upgraded to 1.0.3 hoping it would fix our problems but that didn't help.
I cannot upgrade to 1.1.x because we mainly use Luwak for large object
support
and that's discontinued in 1.1.x as far as I know.

Thanks for your help,
John
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07596.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07598">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07598">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07599.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Handoff stalled on 1.0.2 riak cluster</span> <span class="sender italic">John Axel Eriksson</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07599.html">Re: Handoff stalled on 1.0.2 riak cluster</a></span> <span class="sender italic">Mark Phillips</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07602.html">Re: Handoff stalled on 1.0.2 riak cluster</a></span> <span class="sender italic">John Axel Eriksson</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Handoff stalled on 1.0.2 riak cluster">
<input type="hidden" name="msgid" value="CAMmJxtKQ5EkdFntrsT+0yZoj=_yniD_pxSg0xH17HEa-3Xd3+Q@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07598.html">
<input type="submit" value=" John Axel Eriksson ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Handoff+stalled+on+1.0.2+riak+cluster%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07596.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07599.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAMmJxtKQ5EkdFntrsT+0yZoj=_yniD_pxSg0xH17HEa-3Xd3+Q@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
