<!DOCTYPE html>
<html lang="en">
<head>
<title>60 second timeout in Riak</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#13789" id="c">
<link rel="index" href="mail2.html#13789" id="i">
<link rel="prev" href="msg13787.html" id="p">
<link rel="next" href="msg13790.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg13789.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%2260+second+timeout+in+Riak%22&amp;o=newest" rel="nofollow"><span itemprop="name">60 second timeout in Riak</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Matthew+MacClary%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Matthew MacClary</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140311" rel="nofollow">Tue, 11 Mar 2014 22:44:51 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi everyone, we are running Riak 1.4.1 on RHEL 6.2 using bitcask. We are
using protobufs with the Java client, and our binary objects are typically
a few hundred KB in size. I have noticed a persistent anomaly with riak
reads and writes. It seems like often, maybe 0.5% of the time, writing to
Riak takes 60 seconds longer than it should. Here is a prime example I just
trimmed from a log file (see the last time entry below).</pre><pre>

This is not bitcask merge related because it happens before any of the
bitcask slabs are large enough to merge. I am seeing lots of busy_dist_port
messages in the Riak logs. One unique setting is that we have a small zdbbl
setting of 128K because this seemed to prevent congestive collapse of
throughput at high sustained loads. I believe that this 60 second timeout
persisted across the various zdbbl settings we tried. Also we see this
occasional 60 second delay on both VMs and real server hardware.

Does anyone know where this 60 second delay comes from?

Thanks!

-Matt


2014-03-11 20:40:00,747 INFO  [Thread-61] sally.ReportHandler - Riak load
time for 88: 0.087 seconds
2014-03-11 20:40:01,137 INFO  [Thread-62] sally.ReportHandler - Riak load
time for 70: 0.185 seconds
2014-03-11 20:40:01,958 INFO  [Thread-63] sally.ReportHandler - Riak load
time for 97: 0.054 seconds
2014-03-11 20:40:02,566 INFO  [Thread-64] sally.ReportHandler - Riak load
time for 90: 0.043 seconds
2014-03-11 20:40:02,830 INFO  [Thread-65] sally.ReportHandler - Riak load
time for 85: 0.051 seconds
2014-03-11 20:40:04,162 INFO  [Thread-66] sally.ReportHandler - Riak load
time for 101: 0.075 seconds
2014-03-11 20:40:04,503 INFO  [Thread-67] sally.ReportHandler - Riak load
time for 103: 0.048 seconds
2014-03-11 20:40:05,745 INFO  [Thread-68] sally.ReportHandler - Riak load
time for 98: 0.031 seconds
2014-03-11 20:40:06,041 INFO  [Thread-69] sally.ReportHandler - Riak load
time for 102: 0.063 seconds
2014-03-11 20:40:06,444 INFO  [Thread-70] sally.ReportHandler - Riak load
time for 92: 0.022 seconds
2014-03-11 20:40:06,903 INFO  [Thread-71] sally.ReportHandler - Riak load
time for 99: 0.039 seconds
2014-03-11 20:40:09,847 INFO  [Thread-72] sally.ReportHandler - Riak load
time for 106: 0.019 seconds
2014-03-11 20:40:10,107 INFO  [Thread-73] sally.ReportHandler - Riak load
time for 108: 0.043 seconds
2014-03-11 20:40:47,820 INFO  [Thread-52] sally.ReportHandler - Riak load
time for 62: 1 minutes, 0.190 seconds
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg13787.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#13789">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#13789">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg13790.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">60 second timeout in Riak</span> <span class="sender italic">Matthew MacClary</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13790.html">Re: 60 second timeout in Riak</a></span> <span class="sender italic">Christian Dahlqvist</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13791.html">Re: 60 second timeout in Riak</a></span> <span class="sender italic">Matthew MacClary</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13792.html">Re: 60 second timeout in Riak</a></span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13797.html">Re: 60 second timeout in Riak</a></span> <span class="sender italic">Matthew MacClary</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13798.html">Re: 60 second timeout in Riak</a></span> <span class="sender italic">Brian Roach</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="60 second timeout in Riak">
<input type="hidden" name="msgid" value="CAFYg45wa01GpHFNCs-MJrnpZL3EkZRnmfiTsVbow-bS=L0u3Jg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg13789.html">
<input type="submit" value=" Matthew MacClary ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%2260+second+timeout+in+Riak%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg13787.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg13790.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAFYg45wa01GpHFNCs-MJrnpZL3EkZRnmfiTsVbow-bS=L0u3Jg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
