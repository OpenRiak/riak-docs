<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Millions of buckets?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd5.html#04278" id="c">
<link rel="index" href="maillist.html#04278" id="i">
<link rel="prev" href="msg03325.html" id="p">
<link rel="next" href="msg03309.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04278.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Millions+of+buckets%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Millions of buckets?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22pablochacin%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">pablochacin</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110809" rel="nofollow">Tue, 09 Aug 2011 05:27:47 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Ryan 

I'm resurrecting this topic because a  have a similar request of storing in
riak streams of items coming from sources with unique ids. In your post you
said</pre><pre>


Ryan Kennedy wrote:
&gt; 
&gt; At Yammer we have a notion of streams (notifications is one of our
&gt; streams). Each stream has a list of stream items. For instance, &quot;Bob
&gt; liked your message&quot; or &quot;Jenny replied to your message&quot; or &quot;Charlie
&gt; mentioned you in a thread&quot;. Each stream item has a uniquely generated,
&gt; monotonically increasing ID. That's great, that gives us something to
&gt; sort and dedupe on. We store the stream items for a user in a single
&gt; key/value. Each stream type has it's own bucket. To get to my
&gt; notifications, I would fetch /riak/notifications/ryan. To keep things
&gt; simple (and bounded) we only store the most recent 1,000 or so stream
&gt; items for each user. Older notifications age out of the system as
&gt; newer ones replace them. That's fineâ€¦for nearly all of our users 1,000
&gt; notifications would represent a significant amount of calendar time.
&gt; More than they could be expected to page back through.
&gt; 

What confuses me is the phrase &quot;We store the stream items for a user in a
single key/value&quot;. Does this mean all the items are put together under a
single key? if so, when a new item arrives, you need to read the key, update
and re-write. Doesn't this affect performance

In my case, I need to maintain a very hight write throughput, so I would
prefer not to update. Would it be efficient storing/retrieving items under a
bucket on the form /source/period and use the timestamp as key, where the
period may be configurable for the application and will probably be in the
order of minutes. In that way all items from a source will in the same
bucket. However, this will lead to millions of buckets very quickly.

Another option would be to batch the items (which are very short) and store
them as an object under /source/period as has been discussed in this thread: 
<a  rel="nofollow" href="http://riak-users.197444.n3.nabble.com/High-volume-data-series-storage-and-queries-td3236378.html">http://riak-users.197444.n3.nabble.com/High-volume-data-series-storage-and-queries-td3236378.html</a>
High volume data series storage and queries 

Thanks in advance

--
View this message in context: 
<a  rel="nofollow" href="http://riak-users.197444.n3.nabble.com/Millions-of-buckets-tp2928567p3238776.html">http://riak-users.197444.n3.nabble.com/Millions-of-buckets-tp2928567p3238776.html</a>
Sent from the Riak Users mailing list archive at Nabble.com.

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03325.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd5.html#04278">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04278">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03309.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03304.html">Millions of buckets?</a></span> <span class="sender italic">alexeypro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03305.html">Re: Millions of buckets?</a></span> <span class="sender italic">alexeypro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03306.html">Re: Millions of buckets?</a></span> <span class="sender italic">Aphyr</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03308.html">Re: Millions of buckets?</a></span> <span class="sender italic">Alexey Prohorenko</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg03307.html">Re: Millions of buckets?</a></span> <span class="sender italic">Jared Morrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03325.html">Re: Millions of buckets?</a></span> <span class="sender italic">Ryan Kennedy</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Millions of buckets?</span> <span class="sender italic">pablochacin</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Millions of buckets?">
<input type="hidden" name="msgid" value="1312892833772-3238776.post@n3.nabble.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04278.html">
<input type="submit" value=" pablochacin ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Millions+of+buckets%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03325.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03309.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">1312892833772-3238776.post@n3.nabble.com</li>
</ul>
</div>
</body>
</html>
