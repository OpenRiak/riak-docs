<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#15841" id="c">
<link rel="index" href="maillist.html#15841" id="i">
<link rel="prev" href="msg15862.html" id="p">
<link rel="next" href="msg15939.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15841.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Query+on+Riak+Search+in+a+cluster+of+3+nodes+behind+ELB+is+giving%09different+result+everytime%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Santi+Kumar%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Santi Kumar</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20150305" rel="nofollow">Thu, 05 Mar 2015 08:42:09 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Sorry to spam but here is the output of the AAE status. I'm just pasting
here. I'll have to get familiarised with the output. ON a quick look keys
repaired is not at all there in last column. Your inputs are appreciated.</pre><pre>


================================== Exchanges
==================================

Index                                              Last (ago)    All (ago)


-------------------------------------------------------------------------------

0                                                  8.0 min       8.5 min


91343852333181432387730302044767688728495783936    7.2 min       7.7 min


182687704666362864775460604089535377456991567872   6.4 min       7.0 min


274031556999544297163190906134303066185487351808   5.7 min       6.2 min


365375409332725729550921208179070754913983135744   4.9 min       5.4 min


456719261665907161938651510223838443642478919680   4.2 min       4.7 min


548063113999088594326381812268606132370974703616   3.4 min       3.9 min


639406966332270026714112114313373821099470487552   2.7 min       3.2 min


730750818665451459101842416358141509827966271488   1.9 min       2.4 min


822094670998632891489572718402909198556462055424   1.2 min       1.7 min


913438523331814323877303020447676887284957839360   26.8 s        56.8 s


981946412581700398168100746981252653831329677312   11.8 s        16.5 min


1004782375664995756265033322492444576013453623296  15.5 min      16.0 min


1073290264914881830555831049026020342559825461248  14.7 min      15.2 min


1096126227998177188652763624537212264741949407232  14.0 min      14.5 min


1164634117248063262943561351070788031288321245184  13.2 min      13.7 min


1187470080331358621040493926581979953470445191168  12.5 min      13.0 min


1255977969581244695331291653115555720016817029120  11.7 min      12.2 min


1278813932664540053428224228626747642198940975104  11.0 min      11.5 min


1347321821914426127719021955160323408745312813056  10.2 min      10.7 min


1370157784997721485815954530671515330927436759040  9.5 min       10.0 min


1438665674247607560106752257205091097473808596992  8.7 min       9.2 min



================================ Entropy Trees
================================

Index                                              Built (ago)

-------------------------------------------------------------------------------

0                                                  2.5 d

91343852333181432387730302044767688728495783936    1.6 d

182687704666362864775460604089535377456991567872   1.6 d

274031556999544297163190906134303066185487351808   1.2 d

365375409332725729550921208179070754913983135744   1.5 d

456719261665907161938651510223838443642478919680   1.5 d

548063113999088594326381812268606132370974703616   2.2 d

639406966332270026714112114313373821099470487552   1.7 d

730750818665451459101842416358141509827966271488   1.4 d

822094670998632891489572718402909198556462055424   1.1 d

913438523331814323877303020447676887284957839360   1.3 d

981946412581700398168100746981252653831329677312   1.1 d

1004782375664995756265033322492444576013453623296  1.4 d

1073290264914881830555831049026020342559825461248  1.1 d

1096126227998177188652763624537212264741949407232  1.3 d

1164634117248063262943561351070788031288321245184  1.3 d

1187470080331358621040493926581979953470445191168  1.2 d

1255977969581244695331291653115555720016817029120  2.2 d

1278813932664540053428224228626747642198940975104  2.4 d

1347321821914426127719021955160323408745312813056  2.0 d

1370157784997721485815954530671515330927436759040  1.9 d

1438665674247607560106752257205091097473808596992  1.7 d


================================ Keys Repaired
================================

Index                                                Last      Mean
Max

-------------------------------------------------------------------------------

0                                                     0         0         0


91343852333181432387730302044767688728495783936       0         0         1


182687704666362864775460604089535377456991567872      0         0         1


274031556999544297163190906134303066185487351808      0         0         0


365375409332725729550921208179070754913983135744      0         0         0


456719261665907161938651510223838443642478919680      0         0         0


548063113999088594326381812268606132370974703616      0         0         0


639406966332270026714112114313373821099470487552      0         0         1


730750818665451459101842416358141509827966271488      0         0         0


822094670998632891489572718402909198556462055424      0         0         0


913438523331814323877303020447676887284957839360      0         0         0


981946412581700398168100746981252653831329677312      0         0         1


1004782375664995756265033322492444576013453623296     0         0         0


1073290264914881830555831049026020342559825461248     0         0         0


1096126227998177188652763624537212264741949407232     0         0         0


1164634117248063262943561351070788031288321245184     0         0         0


1187470080331358621040493926581979953470445191168     0         0         0


1255977969581244695331291653115555720016817029120     0         0         0


1278813932664540053428224228626747642198940975104     0         0         0


1347321821914426127719021955160323408745312813056     0         0         0


1370157784997721485815954530671515330927436759040     0         0         0


1438665674247607560106752257205091097473808596992     0         0         0


On Thu, Mar 5, 2015 at 8:05 PM, Zeeshan Lakhani &lt;zlakh...@basho.com&gt; wrote:

&gt; Hello Santi,
&gt;
&gt; Have you deleted an object in that bucket/index at some point?
&gt;
&gt; Please make sure AAE is running by checking searchâ€™s AAE status,
&gt; `riak-admin search aae-status`, and that data exists in the correct
&gt; directory, `./data/yz_anti_entropy` (
&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/advanced/configs/search/">http://docs.basho.com/riak/latest/ops/advanced/configs/search/</a>).
&gt;
&gt; You may just need to perform a read-repair by performing a fetch of the
&gt; object itself first, before performing search queries again.
&gt;
&gt; Thanks.
&gt;
&gt; Zeeshan Lakhani
&gt; programmer |
&gt; software engineer at @basho |
&gt; org. member/founder of @papers_we_love | paperswelove.org
&gt; twitter =&gt; @zeeshanlakhani
&gt;
&gt; On Mar 4, 2015, at 9:06 PM, Santi Kumar &lt;sa...@veradocs.com&gt; wrote:
&gt;
&gt; But in our case we didnt have spaces in keys. All our keys are UUID's so I
&gt; wouldn't suspect that. AAE I haven't verified .
&gt;
&gt; On Thu, Mar 5, 2015 at 7:16 AM, John O'Brien &lt;boar...@gmail.com&gt; wrote:
&gt;
&gt;&gt; I'd lean towards AAE issues on Yokozuna... Same problems we were having
&gt;&gt; with our 'spaces-in-keys' issue... Once we cleaned those up, things were
&gt;&gt; great again.
&gt;&gt;
&gt;&gt; On Wed, Mar 4, 2015 at 8:36 PM, Santi Kumar &lt;sa...@veradocs.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Raik 2.0.0
&gt;&gt;&gt; On Mar 5, 2015 12:31 AM, &quot;Christopher Meiklejohn&quot; &lt;cmeiklej...@basho.com&gt;
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; &gt; On Mar 4, 2015, at 1:15 PM, Santi Kumar &lt;sa...@veradocs.com&gt; wrote:
&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt; &gt; Hi,
&gt;&gt;&gt;&gt; &gt; We are running into a strange issue with Riak Search. Our setup is
&gt;&gt;&gt;&gt; with 3 nodes of Riak (with search enabled) in 3 different  ec2 instances
&gt;&gt;&gt;&gt; behind ELB. App server talks to the cluster through ELB. We are querying
&gt;&gt;&gt;&gt; for list of objects through *:* query instead of list bucket keys and every
&gt;&gt;&gt;&gt; time the result is different. We have only 4 objects in that bucket /
&gt;&gt;&gt;&gt; index, only few times it's giving all 4 but ofther it returns 2 or 3.
&gt;&gt;&gt;&gt; &gt;
&gt;&gt;&gt;&gt; &gt; This wasn't happening when we have one instance of Riak. Any insight?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi Santi,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Can you provide information regarding what versions of Riak you are
&gt;&gt;&gt;&gt; running?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; - Chris
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Christopher Meiklejohn
&gt;&gt;&gt;&gt; Senior Software Engineer
&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt; cmeiklej...@basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15862.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#15841">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#15841">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15939.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li><ul>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15830.html">Re: Query on Riak Search in a cluster of 3 node...</a></span> <span class="sender italic">John O'Brien</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15831.html">Re: Query on Riak Search in a cluster of 3 ...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15834.html">Re: Query on Riak Search in a cluster o...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15839.html">Re: Query on Riak Search in a clus...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15844.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li class="icons-email"><span class="subject"><a href="msg15846.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li class="icons-email"><span class="subject"><a href="msg15859.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li class="icons-email"><span class="subject"><a href="msg15860.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li class="icons-email"><span class="subject"><a href="msg15861.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Baskar Srinivasan</span></li>
<li class="icons-email"><span class="subject"><a href="msg15862.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
</ul></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Query on Riak Search in a clus...</span> <span class="sender italic">Santi Kumar</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg15939.html">Query on Riak Search in a cluster of 3 nodes behind ELB ...</a></span> <span class="sender italic">Vitaliy E</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15940.html">Re: Query on Riak Search in a cluster of 3 nodes be...</a></span> <span class="sender italic">Alex De la rosa</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15942.html">Re: Query on Riak Search in a cluster of 3 node...</a></span> <span class="sender italic">Vitaliy E</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15944.html">Re: Query on Riak Search in a cluster of 3 ...</a></span> <span class="sender italic">Alex De la rosa</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg15941.html">Re: Query on Riak Search in a cluster of 3 nodes be...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15943.html">Re: Query on Riak Search in a cluster of 3 node...</a></span> <span class="sender italic">Vitaliy E</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg15945.html">Re: Query on Riak Search in a cluster of 3 nodes be...</a></span> <span class="sender italic">Michael Weibel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15946.html">Re: Query on Riak Search in a cluster of 3 node...</a></span> <span class="sender italic">Vitaliy E</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime">
<input type="hidden" name="msgid" value="CADY+tZUDW2urkkVgY3L9BwK_n_X1PWx+yGTeG9N2D4eXY2chwA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15841.html">
<input type="submit" value=" Santi Kumar ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Query+on+Riak+Search+in+a+cluster+of+3+nodes+behind+ELB+is+giving%09different+result+everytime%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15862.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15939.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CADY+tZUDW2urkkVgY3L9BwK_n_X1PWx+yGTeG9N2D4eXY2chwA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
