<!DOCTYPE html>
<html lang="en">
<head>
<title>riak handoffs stalled</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#14489" id="c">
<link rel="index" href="maillist.html#14489" id="i">
<link rel="prev" href="msg14487.html" id="p">
<link rel="next" href="msg14490.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg14489.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22riak+handoffs+stalled%22&amp;o=newest" rel="nofollow"><span itemprop="name">riak handoffs stalled</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22%D0%9B%D0%B5%D0%BE%D0%BD%D0%B8%D0%B4+%D0%A0%D1%8F%D0%B1%D0%BE%D1%88%D1%82%D0%B0%D0%BD%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Леонид Рябоштан</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140714" rel="nofollow">Mon, 14 Jul 2014 04:44:26 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hello, guys,

It seems like we ran into emergency. I wonder if there can be any help on
that.</pre><pre>

Everything that happened below was because we were trying to rebalace space
used by nodes that we running out of space.

Cluster is 7 machines now, member_status looks like:
Attempting to restart script through sudo -u riak
================================= Membership
==================================
Status     Ring    Pending    Node
-------------------------------------------------------------------------------
valid      15.6%     20.3%    'riak@192.168.135.180'
valid       0.0%      0.0%    'riak@192.168.152.90'
valid       0.0%      0.0%    'riak@192.168.153.182'
valid      26.6%     23.4%    'riak@192.168.164.133'
valid      27.3%     21.1%    'riak@192.168.177.36'
valid       8.6%     15.6%    'riak@192.168.194.138'
valid      21.9%     19.5%    'riak@192.168.194.149'
-------------------------------------------------------------------------------
Valid:7 / Leaving:0 / Exiting:0 / Joining:0 / Down:0

2 nodes with 0 Ring was made to force leave the cluster, they have plenty
of data on them which is now seems to be not accessible. Handoffs are stuck
it seems. Node 'riak@192.168.152.90'(is in same situation as '
riak@192.168.153.182') tries to handoff partitions to 'riak@192.168.164.133'
but fails for unknown reason after huge timeouts(from 5 to 40 minutes).
Partition it's trying to move is about 10Gb in size. It grows slowly on
target node, but probably it's just usual writes from normal operation. It
doesn't get any smaller on source node.

I wonder is there any way to let cluster know that we want those nodes to
be actually members of source node and there's no actual need to transfer
them? How to redo cluster ownership balance? Revert this force-leave stuff.

Thank you,
Leonid
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg14487.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#14489">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#14489">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg14490.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">riak handoffs stalled</span> <span class="sender italic">Леонид Рябоштан</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14490.html">Re: riak handoffs stalled</a></span> <span class="sender italic">Ciprian Manea</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14491.html">Re: riak handoffs stalled</a></span> <span class="sender italic">Леонид Рябоштан</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14492.html">Re: riak handoffs stalled</a></span> <span class="sender italic">Ciprian Manea</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="riak handoffs stalled">
<input type="hidden" name="msgid" value="CAPPe8QYkAjHDRL0fD6K2ZikXJ8gptzFsNb08sizb2iJz0BUg0g@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg14489.html">
<input type="submit" value=" Леонид Рябоштан ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22riak+handoffs+stalled%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg14487.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg14490.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAPPe8QYkAjHDRL0fD6K2ZikXJ8gptzFsNb08sizb2iJz0BUg0g@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
