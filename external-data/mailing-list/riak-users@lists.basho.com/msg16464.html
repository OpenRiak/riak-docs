<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Rolling upgrade from 1.4.2 to 2.0.5</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#16464" id="c">
<link rel="index" href="maillist.html#16464" id="i">
<link rel="prev" href="msg16463.html" id="p">
<link rel="next" href="msg16474.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg16464.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Rolling+upgrade+from+1.4.2+to+2.0.5%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Rolling upgrade from 1.4.2 to 2.0.5</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Dmitri+Zagidulin%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Dmitri Zagidulin</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20150826" rel="nofollow">Wed, 26 Aug 2015 18:35:03 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Sujay,

Checking into it, it seems like there is a bug with 'reip' in 1.4.2.</pre><pre>

You have a couple of options, then.

1) Since you're just trying to verify the data, you can actually restore
all the files except for the 'ring' directory. And then just form a new
cluster of 5 nodes, with different IPs (don't forget about the cookie). The
new cluster would still have the data from the old cluster, though. It will
go through a lot of partition transfers, but the data should be preserved.

2) You can fix the 'reip' issue yourself, by doing the following:
Edit the 'riak-admin' shell script (you can see where it lives on your OS
by doing 'which riak-admin'.)
Change the following line:
<a  rel="nofollow" href="https://github.com/basho/riak/blob/riak-1.4.2/rel/files/riak-admin#L382">https://github.com/basho/riak/blob/riak-1.4.2/rel/files/riak-admin#L382</a>
(line 382) to read 'node_down_check' instead of 'node_up_check'.
Then save and re-try the 'reip' command.

3) Even better: upgrade the test cluster (that you're using to restore the
data) to version 1.4.12, it has the 'reip' problem fixed. And then follow
the same procedure.



On Wed, Aug 26, 2015 at 2:18 AM, Sujay Mansingh &lt;su...@editd.com&gt; wrote:

&gt; Thanks for your reply Dmitri.
&gt;
&gt; ubuntu@test-riak-products-hetzner-04:~$ sudo riak ping
&gt; Node 'riak@172.16.16.211' not responding to pings.
&gt; ubuntu@test-riak-products-hetzner-04:~$ ps -ef | grep erl
&gt; ubuntu   13786 13709  0 07:12 pts/0    00:00:00 grep --color=auto erl
&gt; ubuntu@test-riak-products-hetzner-04:~$ sudo riak-admin reip riak@192.168.3.8 
&gt; riak@172.16.16.211
&gt; Node is not running!
&gt; ubuntu@test-riak-products-hetzner-04:~$ riak version
&gt; 1.4.2
&gt;
&gt; It’s odd, because it looks like the reip command requires the node to be
&gt; running.
&gt;
&gt; Riak doesn’t seem to be running.
&gt;
&gt; Sujay
&gt; ​
&gt;
&gt;
&gt; On Tue, Aug 25, 2015 at 6:31 PM, Dmitri Zagidulin &lt;dzagidu...@basho.com&gt;
&gt; wrote:
&gt;
&gt;&gt; Can you paste me the command-line output of 'riak-admin reip', and the
&gt;&gt; error message? As far as I know, 'reip' requires the node to be not
&gt;&gt; running. (This was the case at least as far back as Riak 1.3, and probably
&gt;&gt; earlier).
&gt;&gt;
&gt;&gt; I don't think there are ways of verifying the backup while the nodes are
&gt;&gt; not running. I'm confident we can sort this out, though, and get them up
&gt;&gt; and running.
&gt;&gt;
&gt;&gt; On Tue, Aug 25, 2015 at 6:17 AM, Sujay Mansingh &lt;su...@editd.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Thanks Dmitri.
&gt;&gt;&gt;
&gt;&gt;&gt; I tried that, but with no luck. I replaced the ring and bitcask data
&gt;&gt;&gt; directories.
&gt;&gt;&gt;
&gt;&gt;&gt; But I can’t run riak-admin reip ... because it complains that riak
&gt;&gt;&gt; isn’t running.
&gt;&gt;&gt;
&gt;&gt;&gt; However, I can’t start riak (I get the following in
&gt;&gt;&gt; /var/log/riak/error.log).
&gt;&gt;&gt; (The existing cluster is the 192.168.3.x range, and the new one is the
&gt;&gt;&gt; 172.16.16.x range.)
&gt;&gt;&gt;
&gt;&gt;&gt; 2015-08-25 11:13:39.217 [error] &lt;0.161.0&gt; gen_server riak_core_capability 
&gt;&gt;&gt; terminated with reason: no function clause matching 
&gt;&gt;&gt; orddict:fetch('riak@172.16.16.211', 
&gt;&gt;&gt; [{'riak@192.168.3.5',[{{riak_control,member_info_version},[v1,v0]},{{riak_core,resizable_ring},...},...]},...])
&gt;&gt;&gt;  line 72
&gt;&gt;&gt; 2015-08-25 11:13:39.217 [error] &lt;0.161.0&gt; CRASH REPORT Process 
&gt;&gt;&gt; riak_core_capability with 0 neighbours exited with reason: no function 
&gt;&gt;&gt; clause matching orddict:fetch('riak@172.16.16.211', 
&gt;&gt;&gt; [{'riak@192.168.3.5',[{{riak_control,member_info_version},[v1,v0]},{{riak_core,resizable_ring},...},...]},...])
&gt;&gt;&gt;  line 72 in gen_server:terminate/6 line 747
&gt;&gt;&gt; 2015-08-25 11:13:39.219 [error] &lt;0.137.0&gt; Supervisor riak_core_sup had 
&gt;&gt;&gt; child riak_core_capability started with riak_core_capability:start_link() 
&gt;&gt;&gt; at &lt;0.161.0&gt; exit with reason no function clause matching 
&gt;&gt;&gt; orddict:fetch('riak@172.16.16.211', 
&gt;&gt;&gt; [{'riak@192.168.3.5',[{{riak_control,member_info_version},[v1,v0]},{{riak_core,resizable_ring},...},...]},...])
&gt;&gt;&gt;  line 72 in context child_terminated
&gt;&gt;&gt; 2015-08-25 11:13:39.219 [error] &lt;0.135.0&gt; CRASH REPORT Process &lt;0.135.0&gt; 
&gt;&gt;&gt; with 0 neighbours exited with reason: 
&gt;&gt;&gt; {{function_clause,[{orddict,fetch,['riak@172.16.16.211',[{'riak@192.168.3.5',[{{riak_control,member_info_version},[v1,v0]},{{riak_core,resizable_ring},[true,false]},{{riak_core,staged_joins},[true,false]},{{riak_core,vnode_routing},[proxy,legacy]},{{riak_kv,anti_entropy},[enabled_v1,disabled]},{{riak_kv,crdt},[[pncounter],[]]},{{riak_kv,handoff_data_encoding},[encode_raw,encode_zlib]},{{riak_kv,index_backpressure},[true,false]},{{riak_kv,legacy_keylisting},[false]},{{riak_kv,listkeys_backpressure},...},...]},...]],...},...]},...}
&gt;&gt;&gt;  in application_master:init/4 line 138
&gt;&gt;&gt;
&gt;&gt;&gt; At the moment, it looks like I can’t restore the cluster. Is there any
&gt;&gt;&gt; other way of verifying the backup? Perhaps I can simply pull out all the
&gt;&gt;&gt; keys in the bitcask data dump?
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Sujay
&gt;&gt;&gt; ​
&gt;&gt;&gt;
&gt;&gt;&gt; On Mon, Aug 24, 2015 at 1:43 PM, Dmitri Zagidulin &lt;dzagidu...@basho.com&gt;
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi Sujay,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This is where we get into the fact that maintaining docs across many
&gt;&gt;&gt;&gt; versions is a hard problem :)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; You'll want to follow the instructions laid out in
&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/running/nodes/renaming/#Clusters-from-Backups">http://docs.basho.com/riak/latest/ops/running/nodes/renaming/#Clusters-from-Backups</a>
&gt;&gt;&gt;&gt;  (the
&gt;&gt;&gt;&gt; Clusters from Backup section, specifically). That outlines the instructions
&gt;&gt;&gt;&gt; on renaming the ring on an existing new cluster from backup. (And keep in
&gt;&gt;&gt;&gt; mind what I said earlier about renaming the Erlang cookie in vm.args).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Since it's written for Riak version 2, you'll want to cross-reference
&gt;&gt;&gt;&gt; it with the slightly older version of the doc, that you're looking at,
&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/1.4.2/ops/running/nodes/renaming/">http://docs.basho.com/riak/1.4.2/ops/running/nodes/renaming/</a> . The
&gt;&gt;&gt;&gt; procedure should be largely the same, just the names of the config files
&gt;&gt;&gt;&gt; are different.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Monday, August 24, 2015, Sujay Mansingh &lt;su...@editd.com&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hi guys
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I am looking at the instructions here:
&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/1.4.2/ops/running/nodes/renaming/">http://docs.basho.com/riak/1.4.2/ops/running/nodes/renaming/</a>
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; However, these are instructions for renaming an existing cluster
&gt;&gt;&gt;&gt;&gt; ‘in-place’.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; What I have is an existing 5 node cluster.
&gt;&gt;&gt;&gt;&gt; I have brought up a completely new (and separate) 5 node cluster.
&gt;&gt;&gt;&gt;&gt; I am copying over the bitcask data and /var/lib/riak/ring directories
&gt;&gt;&gt;&gt;&gt; from each existing node to the new cluster. (i.e. from existing-01 to
&gt;&gt;&gt;&gt;&gt; new-01, existing-02 to new-02, etc)
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; The instructions above mention to join the cluster, but I don’t wish
&gt;&gt;&gt;&gt;&gt; to do that (as it would join a new node to the existing cluster).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; At the moment I have not formed the new cluster (all 5 riak nodes are
&gt;&gt;&gt;&gt;&gt; standalone).
&gt;&gt;&gt;&gt;&gt; What do I need to do in order to rename the ring on the nodes in the
&gt;&gt;&gt;&gt;&gt; new cluster?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Sujay
&gt;&gt;&gt;&gt;&gt; ​
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On Tue, Aug 11, 2015 at 4:47 PM, Dmitri Zagidulin &lt;
&gt;&gt;&gt;&gt;&gt; dzagidu...@basho.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Hi Sujay,
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Yes, riak.conf is a riak 2 thing. If you're running 1.4, you would
&gt;&gt;&gt;&gt;&gt;&gt; change the -setcookie in vm.args, exactly.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; And no, the node name doesn't have to match the cookie. The two are
&gt;&gt;&gt;&gt;&gt;&gt; independent.
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On Tue, Aug 11, 2015 at 3:22 PM, Sujay Mansingh &lt;su...@editd.com&gt;
&gt;&gt;&gt;&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Oh and also, does the first part of the riak node name have to match
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the cookie?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I.e. If I change the cookie to riaktest, does the node name have to
&gt;&gt;&gt;&gt;&gt;&gt;&gt; be riaktest@{{ ip_addr }} ?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Tuesday, August 11, 2015, Sujay Mansingh &lt;su...@editd.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks Dmitri
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; When you say the cookie must be modified in /etc/riak/riak.conf,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; is that a riak 2 thing?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I can see a -setcookie riak line in /etc/riak/vm.args, is that
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; what you mean?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sujay
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ​
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu, Aug 6, 2015 at 2:11 PM, Dmitri Zagidulin &lt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; dzagidu...@basho.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sujay,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; You're right - the best way to verify the backup is to bring up a
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; separate 5 node cluster, and restore it from the backup files.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; The procedure is slightly more involved than untar-ing, though.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; The backed up ring directories from the original cluster will contain 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; node ids (which rely on their IP addresses, etc). Since the new 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; re-hydrated
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; cluster is likely to have different IPs from the original one, 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; there's a
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; few more steps you need to take.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; The procedure of standing up a new cluster from backups is
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; outlined here:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/running/nodes/renaming/#Clusters-from-Backups">http://docs.basho.com/riak/latest/ops/running/nodes/renaming/#Clusters-from-Backups</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; There is one other important step to remember. If, by any chance,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; you're bringing up the new cluster on the same network as the old 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; cluster
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; is running on, be sure to modify the Erlang cookie in the new cluster 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; (so
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; that as far as Erlang is concerned, they're existing on different 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; networks).
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; The Erlang cookie must be modified in /etc/riak/riak.conf so the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; new cluster does not conflict with any existing cluster.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Let us know if you have any further questions.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Dmitri
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu, Aug 6, 2015 at 8:40 AM, Sujay Mansingh &lt;su...@editd.com&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks Magnus &amp; John.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Yes certainly I will test it on a separate cluster first! Which
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; is related to another question I have.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; If I want to backup I can archive the directories on the nodes as
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; described here:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/running/backups/#OS-Specific-Directory-Locations">http://docs.basho.com/riak/latest/ops/running/backups/#OS-Specific-Directory-Locations</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; But in order to verify the backup (or perform operations on the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; cluster in 'offline' mode), can I simply bring up a separate 5 node 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; cluster
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; and untar the backup files?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; (Probably not the /etc/riak directory, but the data and ring
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; directories.)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I want to do that, and then try adding a riak 2.0.6 node to the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; test riak 1.4.2 cluster and see if things are ok.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sujay
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu, Aug 6, 2015 at 9:31 AM, Magnus Kessler &lt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; mkess...@basho.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On 5 August 2015 at 18:53, John Daily &lt;jda...@basho.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; That’s correct: upgrades to either 2.0.x or 2.1.x are supported
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; from the 1.4 series.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Side note: I definitely recommend testing the upgrade process
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; in a QA environment first.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; -John
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi Sujay,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; The latest release in the 2.0 series is 2.0.6 [0]. Please use
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; this version if you upgrade to 2.0.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Please also review the documentation about the new 'riak.conf'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; configuration file [1][2]. 2.x installations should use the new 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; format, but
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; you can continue to use the 'app.config' format from Riak 1.x. To 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; maintain
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; complete backwards compatibility when using 'app.config', please add
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; [{default_bucket_props,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   [{allow_mult,false}, %% have Riak resolve conflicts and do not 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; return siblings
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   {dvv_enabled,false}]}, %% use vector clocks for conflict 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; resolution
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   %% other settings
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ]
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; to 'app.config'. This will ensure that your existing application
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; continues to work exactly as before. When using 'riak.conf', these 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; settings
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; will be applied automatically.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Magnus
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; [0] <a  rel="nofollow" href="http://docs.basho.com/riak/2.0.6/downloads/">http://docs.basho.com/riak/2.0.6/downloads/</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; [1]
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/intro-v20/#Simplified-Configuration-Management">http://docs.basho.com/riak/latest/intro-v20/#Simplified-Configuration-Management</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; [2]
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/advanced/configs/configuration-files/">http://docs.basho.com/riak/latest/ops/advanced/configs/configuration-files/</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Aug 5, 2015, at 12:13 PM, Sujay Mansingh &lt;su...@editd.com&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hello all, I have a 5 node riak cluster, all nodes running
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1.4.2.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I want to upgrade to riak 2.x
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; According to this:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/ops/upgrading/rolling-upgrades/">http://docs.basho.com/riak/latest/ops/upgrading/rolling-upgrades/</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I can perform a rolling upgrade (a mixed cluster)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; as long as the versions aren't more than 2 versions apart.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; There is no riak 1.5 so would riak 1.4.2 -&gt; 2.0.5 count as 1
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; version apart?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Sujay
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Magnus Kessler
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Client Services Engineer @ Basho
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Registered Office - 8 Lincoln’s Inn Fields London WC2A 3BP Reg
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 07970431
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg16463.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#16464">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#16464">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg16474.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg16370.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16371.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16403.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16404.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16405.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16451.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li class="icons-email"><span class="subject"><a href="msg16452.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16456.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li class="icons-email"><span class="subject"><a href="msg16460.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16463.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Rolling upgrade from 1.4.2 to 2.0.5</span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li class="icons-email"><span class="subject"><a href="msg16474.html">Re: Rolling upgrade from 1.4.2 to 2.0.5</a></span> <span class="sender italic">Sujay Mansingh</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Rolling upgrade from 1.4.2 to 2.0.5">
<input type="hidden" name="msgid" value="CA+TO3kWFwC-=nqmQguDdgSkN13DM0d5JFMz7zHMcg+zocZ3+SQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg16464.html">
<input type="submit" value=" Dmitri Zagidulin ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Rolling+upgrade+from+1.4.2+to+2.0.5%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg16463.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg16474.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CA+TO3kWFwC-=nqmQguDdgSkN13DM0d5JFMz7zHMcg+zocZ3+SQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
