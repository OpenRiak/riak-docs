<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: bitcask 42?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#01172" id="c">
<link rel="index" href="maillist.html#01172" id="i">
<link rel="prev" href="msg01190.html" id="p">
<link rel="next" href="msg01170.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg01172.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+bitcask+42%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: bitcask 42?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Bruce+Lowekamp%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Bruce Lowekamp</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100930" rel="nofollow">Thu, 30 Sep 2010 22:24:09 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Dan,

Thanks for the suggestions.  Our startup script currently starts riak on each 
node, then goes back and joins each node to node 1, waiting until ringready is 
ok before advancing.  Appropriate pauses added, and we had to reduce the gossip 
interval to 10 seconds to make it run quickly enough.</pre><pre>

What we found was that 4 is apparently a minimum number of partitions per node. 
 When we increased the partitions, we got better distribution up to 63 nodes.  
With 128 partitions, it stopped distributing them beyond the 42nd node added 
(and wasn't balancing on those nodes).

Don't know if that is documented anywhere or not.  I've seen recommendations 
for having more partitions, but we weren't aware there was a correctness issue.

Bruce


On Sep 30, 2010, at 4:16 PM, Dan Reverri wrote:

&gt; Hi Michael,
&gt; 
&gt; There is no hard coded limit to the number of nodes that can belong to a 
&gt; cluster. Depending on how quickly you are adding nodes to the cluster you may 
&gt; be running into an issue with the ring not converging on a single state.
&gt; 
&gt; Can you try using the &quot;riak-admin ringready&quot; command between each join of a 
&gt; node? This command will return TRUE if the nodes all agree on a particular 
&gt; ring state. You should run this command until it returns TRUE after each join.
&gt; 
&gt; Also, Alexander is correct; you should deploy your nodes with an increased 
&gt; value for the &quot;ring_creation_size&quot; parameter in app.config. The typical 
&gt; recommendation is to have a minimum of 10 partitions per node and the value 
&gt; should be a power of 2 (64, 128, 256, 512, 1024). For a 63 node cluster a 
&gt; value of 1024 would work well.
&gt; 
&gt; Thanks,
&gt; Dan
&gt; 
&gt; Daniel Reverri
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; d...@basho.com
&gt; 
&gt; 
&gt; On Thu, Sep 30, 2010 at 12:02 PM, Alexander Sicular &lt;sicul...@gmail.com&gt; 
&gt; wrote:
&gt; The default vnode number is 64. If you are connecting 63 physical nodes 
&gt; togeter in one riak cluster than you really want to increase the number of 
&gt; vnodes. There is some recommended metric for physical nodes to vnodes. I 
&gt; think it's like a minimum of 4 vnodes per physical node. But I could be 
&gt; totally making that up. 
&gt; 
&gt; -Alexander. 
&gt; 
&gt; 
&gt; @siculars on twitter
&gt; <a  rel="nofollow" href="http://siculars.posterous.com">http://siculars.posterous.com</a>
&gt; 
&gt; Sent from my iPhone
&gt; 
&gt; On Sep 30, 2010, at 14:26, Michael Colussi &lt;mcolu...@gmail.com&gt; wrote:
&gt; 
&gt;&gt; Hey guys,
&gt;&gt; 
&gt;&gt; My team was trying to launch a 63 node Riak cluster yesterday, using version 
&gt;&gt; 0.13rc3 and the bitcask backend.
&gt;&gt; 
&gt;&gt; All 63 nodes agreed that the ring consisted of nodes 1-42 only.
&gt;&gt; 
&gt;&gt; Any ideas?  Is there a hardcoded limit to the number of nodes allowed?
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg01190.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#01172">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#01172">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg01170.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01166.html">Re: bitcask 42?</a></span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01167.html">Re: bitcask 42?</a></span> <span class="sender italic">Mark Phillips</span></li>
<li class="icons-email"><span class="subject"><a href="msg01168.html">Re: bitcask 42?</a></span> <span class="sender italic">Mojito Sorbet</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01175.html">Re: bitcask 42?</a></span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01177.html">Re: bitcask 42?</a></span> <span class="sender italic">Wilson MacGyver</span></li>
<li class="icons-email"><span class="subject"><a href="msg01178.html">Re: bitcask 42?</a></span> <span class="sender italic">Dan Reverri</span></li>
<li class="icons-email"><span class="subject"><a href="msg01179.html">Re: bitcask 42?</a></span> <span class="sender italic">Mojito Sorbet</span></li>
<li class="icons-email"><span class="subject"><a href="msg01180.html">Re: bitcask 42?</a></span> <span class="sender italic">Dan Reverri</span></li>
<li class="icons-email"><span class="subject"><a href="msg01185.html">Re: bitcask 42?</a></span> <span class="sender italic">Nico Meyer</span></li>
<li class="icons-email"><span class="subject"><a href="msg01190.html">Re: bitcask 42?</a></span> <span class="sender italic">Alexander Sicular</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email tSliceCur"><span class="subject">Re: bitcask 42?</span> <span class="sender italic">Bruce Lowekamp</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: bitcask 42?">
<input type="hidden" name="msgid" value="7A66C06C-A88F-4C83-AD78-465C44B76988@skype.net">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg01172.html">
<input type="submit" value=" Bruce Lowekamp ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+bitcask+42%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg01190.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg01170.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">7A66C06C-A88F-4C83-AD78-465C44B76988@skype.net</li>
</ul>
</div>
</body>
</html>
