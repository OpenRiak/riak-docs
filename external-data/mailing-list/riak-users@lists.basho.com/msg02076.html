<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Getting all the Keys</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#02076" id="c">
<link rel="index" href="maillist.html#02076" id="i">
<link rel="prev" href="msg02072.html" id="p">
<link rel="next" href="msg02078.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg02076.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Getting+all+the+Keys%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Getting all the Keys</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Eric+Moritz%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Eric Moritz</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110123" rel="nofollow">Sun, 23 Jan 2011 10:02:01 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>This is the best way for me to understand how to model data in Riak.  Think
about the web. You always have a starting point. The starting point is an
URL. An URL is analogous to a key in Riak. A URL gets you a document on the
web, a key gets you a document in Riak.</pre><pre>

Now on the web page addressed by your URL has other URLs that serve as
pointers to other pages.

In Riak, your starting doc(s) need to have references to other documents to
related them.

In fact both systems, when defined this way are extremely relational. They
diverge from relational databases in the fact that there's tons of redundant
data and no built-in integrity checking.

On the web this results in 404s and inconsistent titles in a tags.  The same
problems happen in Riak; deleted keys could still be referenced by other
documents.  It's all reminiscent of dangling pointers in my CS classes.
Just in that old C code I had to write, there was a lot of house keeping to
make sure integrity was preserved.

Unlike the web, with Riak, we have complete control over what links to
what.  Unfortunately it adds complexity to applications that otherwise would
be simple in an ACID DB. The benefit to this added complexity is AP.

The folks who wrote the Dynamo paper state that, at least for them, this
added complexity when negligible because they were already designing their
services to compensate for integrity issues. Unfortunately for most of us,
our SQL databases let us ignore those issues.

tl;dr think of Riak like the web. The web interrelates pages using URLs, we
have design our app's Riak docs similarly using key references.
On Jan 22, 2011 8:22 PM, &quot;Sean Cribbs&quot; &lt;s...@basho.com&gt; wrote:
&gt; On Jan 22, 2011, at 4:15 PM, Thomas Burdick wrote:
&gt;
&gt;&gt; * Why is key listing so slow?
&gt;
&gt; It is slow because, even if the keys are in RAM, you have to scan roughly
all of the keys in the cluster to get a listing for a single bucket. As a
certain person is fond of saying, &quot;full table scan is full table scan&quot;.
There are ways to improve this, but without single-arbiters of state (and
points of failure) it is very costly.
&gt;
&gt;&gt; * What do people do in the context of purely using riak to do what I
want, have a big set of keys to iterate over?
&gt;
&gt; As others have said so eloquently, they don't, they use something else. Or
they try to minimize how frequently they do it. Part of the current
revolution in data storage is about realizing that no one tool is going to
completely fit your needs, and that that's good and right. Anyone who tells
you otherwise is selling you a bill of goods.
&gt;
&gt; To understand why listing keys is difficult, you have to understand Riak's
(and Dynamo's) original design motivations:
&gt;
&gt; * To be basically available at all times for reads and writes, which in
turn means to be tolerant of machine and network failures.
&gt; * To provide low-latency random access to large data sets. (Note I didn't
say an entire data set.)
&gt; * To scale linearly with minimal operational complexity.
&gt;
&gt; Everything has tradeoffs - these are the ones we chose with Riak. Now, we
(Basho) are actively trying to create ways to make discovering your data
easier (key-filters are one of them, as Justin mentioned we're discussing
counters and indices), but the majority of people who use Riak have ways of
discovering or knowing keys ahead of time. If that's not your case, you
should look into other solutions; some good ones have been mentioned in this
thread. That said, we hear your pain and are working hard to improve
usability while maintaining the properties discussed above.
&gt;
&gt; Cheers,
&gt;
&gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; <a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>
&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg02072.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#02076">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#02076">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg02078.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg02060.html">Re: Getting all the Keys</a></span> <span class="sender italic">Alexander Staubo</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02061.html">Re: Getting all the Keys</a></span> <span class="sender italic">Alexander Staubo</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02062.html">Re: Getting all the Keys</a></span> <span class="sender italic">Gary William Flake</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02063.html">Re: Getting all the Keys</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02064.html">Re: Getting all the Keys</a></span> <span class="sender italic">Justin Sheehy</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg02065.html">Re: Getting all the Keys</a></span> <span class="sender italic">Les Mikesell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02066.html">Re: Getting all the Keys</a></span> <span class="sender italic">Thomas Burdick</span></li>
<li class="icons-email"><span class="subject"><a href="msg02070.html">Re: Getting all the Keys</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li class="icons-email"><span class="subject"><a href="msg02071.html">Re: Getting all the Keys</a></span> <span class="sender italic">Thomas Burdick</span></li>
<li class="icons-email"><span class="subject"><a href="msg02072.html">Re: Getting all the Keys</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Getting all the Keys</span> <span class="sender italic">Eric Moritz</span></li>
<li class="icons-email"><span class="subject"><a href="msg02078.html">Re: Getting all the Keys</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li class="icons-email"><span class="subject"><a href="msg02081.html">Re: Getting all the Keys</a></span> <span class="sender italic">Les Mikesell</span></li>
<li class="icons-email"><span class="subject"><a href="msg02082.html">Re: Getting all the Keys</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li class="icons-email"><span class="subject"><a href="msg02142.html">Re: Getting all the Keys</a></span> <span class="sender italic">Marcin Krol</span></li>
<li class="icons-email"><span class="subject"><a href="msg02143.html">Re: Getting all the Keys</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li class="icons-email"><span class="subject"><a href="msg02147.html">Re: Getting all the Keys</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li class="icons-email"><span class="subject"><a href="msg02079.html">Best relational DB to use with RIak</a></span> <span class="sender italic">Mojito Sorbet</span></li>
<li class="icons-email"><span class="subject"><a href="msg02083.html">Re: Best relational DB to use with RIa...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg02077.html">Re: Getting all the Keys</a></span> <span class="sender italic">Eric Moritz</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02084.html">Re: Getting all the Keys</a></span> <span class="sender italic">Eric Moritz</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Getting all the Keys">
<input type="hidden" name="msgid" value="AANLkTi=8cXK+rSega-8=FDy3JnAuWuxnHFOfns3Z9ZyK@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg02076.html">
<input type="submit" value=" Eric Moritz ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Getting+all+the+Keys%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg02072.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg02078.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">AANLkTi=8cXK+rSega-8=FDy3JnAuWuxnHFOfns3Z9ZyK@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
