<!DOCTYPE html>
<html lang="en">
<head>
<title>Corrupted data using Riak Python Client on Win7 64 bit</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd7.html#12900" id="c">
<link rel="index" href="mail7.html#12900" id="i">
<link rel="prev" href="msg12898.html" id="p">
<link rel="next" href="msg12906.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12900.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Corrupted+data+using+Riak+Python+Client+on+Win7+64+bit%22&amp;o=newest" rel="nofollow"><span itemprop="name">Corrupted data using Riak Python Client on Win7 64 bit</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22finkle+mcgraw%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">finkle mcgraw</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131108" rel="nofollow">Fri, 08 Nov 2013 11:43:29 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Fellow Riak users,

I've noticed that when I upload binary files with sizes of &gt;~1 MB to Riak
from my Windows 7 (64 bit) machine, then read the same data back again,
often it has a few corrupted bytes, while maintining the correct total data
length.</pre><pre>

Here's the Python script I use to provoke and detect the situation:
<a  rel="nofollow" href="https://gist.github.com/anonymous/7376084">https://gist.github.com/anonymous/7376084</a>

Notice that I included the typical output when running the script at the
bottom of the gist. As you can see, for that particular run, half of the
dummy-data files were corrupted. The returned data from Riak has the exact
same length as the source, but not the exact same content. I've only done
brief analysis of how the corruptions appear within the files that are
detected as corrupted, but it looks like it's typically between 1 to 5
bytes that are altered, evenly distributed within the file.

I get no exceptions or warnings from the Riak Python client. Everything
appears to be in order.

So far I've tested this on two different windows machines against two
different Riak clusters (a five node Amazon cluster with a loadbalancer in
front, and a local devcluster running inside an Ubuntu 12.04 Virtual
Machine). The problems appear in all four possible combinations.

However, if I run the script from within an Ubuntu VM, on one of the said
Windows machines, against any of the two Riak clusteres, the problems do
NOT appear.

Another observation: If I generate 50 sample files, upload them, then
repeatedly try to download them over and over again, the script will detect
corruptions in different files on each repetition of downloading. E.g., on
round one it might say that file 1,5, and 19 were corrupted, but on round
two it might say 3, 8 and 19.

Here is the riak stats-view from the Amazon cluster we're running (that I
tested the script agains):
<a  rel="nofollow" href="https://gist.github.com/anonymous/7376379">https://gist.github.com/anonymous/7376379</a>

But as I said, the corruptions appear also when working locally between a
Win7 machine and a cluster running on a virtual Ubuntu 12.04 machine.

Here are my local package versions, running on Python 2.7.5 64 bit on
Windows 7 64 bit:
protobuf==2.4.1
riak==2.0.1
riak-pb==1.4.1.1

Any ideas? This seems relatively serious, unless it's some kind of brutal
oversight on my part.

Finkle
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12898.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd7.html#12900">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail7.html#12900">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12906.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Corrupted data using Riak Python Client on Win7 64 bit</span> <span class="sender italic">finkle mcgraw</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12906.html">Re: Corrupted data using Riak Python Client on Wi...</a></span> <span class="sender italic">Engel Sanchez</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12909.html">Re: Corrupted data using Riak Python Client o...</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12910.html">Re: Corrupted data using Riak Python Clie...</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12921.html">Re: Corrupted data using Riak Python ...</a></span> <span class="sender italic">finkle mcgraw</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12922.html">Re: Corrupted data using Riak Py...</a></span> <span class="sender italic">Christian Dahlqvist</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12925.html">Re: Corrupted data using Ria...</a></span> <span class="sender italic">finkle mcgraw</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Corrupted data using Riak Python Client on Win7 64 bit">
<input type="hidden" name="msgid" value="CAOw9kdZAdRO__=9mwEuForYAHNZo4aQ-VzsouO5PcdTu0yrSCg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12900.html">
<input type="submit" value=" finkle mcgraw ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Corrupted+data+using+Riak+Python+Client+on+Win7+64+bit%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12898.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12906.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAOw9kdZAdRO__=9mwEuForYAHNZo4aQ-VzsouO5PcdTu0yrSCg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
