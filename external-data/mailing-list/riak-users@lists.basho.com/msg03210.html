<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: EC2 and node names</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#03210" id="c">
<link rel="index" href="maillist.html#03210" id="i">
<link rel="prev" href="msg03208.html" id="p">
<link rel="next" href="msg03218.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03210.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+EC2+and+node+names%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: EC2 and node names</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Grant+Schofield%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Grant Schofield</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110503" rel="nofollow">Tue, 03 May 2011 10:52:20 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>On May 3, 2011, at 12:35 PM, Jeff Pollard wrote:

&gt; Grant,
&gt; 
&gt; Thanks for the reply.  I think I understand what you're saying, but it's not 
&gt; 100% clear to me how exactly it applies to my question.  I'll try explaining 
&gt; my plan another way if that helps.
&gt; 
&gt; Imagine we have 4 nodes running in a ring on EC2: riak@10.5.0.1, 
&gt; riak@10.5.0.2, riak@10.5.0.3, riak@10.5.0.4.  Then one day node riak@10.5.0.3 
&gt; goes down and is unrecoverable.  Our plan had been: 
&gt; 
&gt; # On a existing node in the cluster
&gt; riak-admin remove riak@10.5.0.3
&gt; riak-admin ringready
&gt; # .. wait for TRUE
&gt; 
&gt; # Boot a new EC2 machine configured as riak@10.5.0.5 (brand new IP)
&gt; # Then on that new machine...
&gt; riak start
&gt; riak-admin join riak@10.5.0.1
&gt; riak-admin ringready
&gt; # .. wait for TRUE
&gt; 
&gt; In that scenario, I imagine the issue is that removing and adding a new node 
&gt; under a new node name is putting extra strain on the cluster to shift data 
&gt; around?  Simply replacing a new node under the same hostname (even though it 
&gt; has a different IP) would mean less work for the cluster?  And how much extra 
&gt; work are 
&gt; </pre><pre>

You're correct in assuming that there is extra strain on the cluster moving 
that data around, but the amount of that churn will depend on how much data you 
have in your Riak cluster and your use case. Removing and adding a node is a 
great way to replace a broken node, but if you have a large amount of data it 
might be quicker and load the cluster less to replace the broken node with a 
node that has the same hostname or IP and the old nodes data directory. 

If riak@10.5.0.3 dies due to a disk problem and your backups won't contain the 
data you would need to replace the node as you described. The best solution for 
replacing a dead node will vary based on circumstances, your use case, and your 
availability needs.

Grant



&gt; Thanks!
&gt; 
&gt; On Tue, May 3, 2011 at 6:24 AM, Grant Schofield &lt;gr...@basho.com&gt; wrote:
&gt; 
&gt; On May 2, 2011, at 7:58 PM, Jeff Pollard wrote:
&gt; 
&gt;&gt; I was reviewing the Riak Operations webinar, and it was mentioned that the 
&gt;&gt; preferred vm.args -name for EC2 environments should be &quot;riak@hostname&quot; 
&gt;&gt; because you don't have to &quot;rename data or do anything weird&quot; like you would 
&gt;&gt; if your nodes were named &quot;riak@ip.address&quot; (approximately 40:05 in the 
&gt;&gt; video).
&gt;&gt; 
&gt;&gt; I was looking for some elaboration on this tip, namely:
&gt;&gt; What is meant by &quot;rename data or do anything weird&quot;
&gt; 
&gt; When you bring a cluster together using data copied from a different set of 
&gt; nodes you need to re-ip the first node you plan to start but you also have to 
&gt; change the ring manually on that node so when the subsequent nodes join 
&gt; everything works properly. 
&gt; 
&gt;&gt; Is &quot;hostname&quot; in riak@hostname a public DNS host that you configure in your 
&gt;&gt; DNS to map to the EC2 public hostname (ec2-50-18-...)?
&gt; 
&gt; You can use DNS (public or private) or host file entries that reference the 
&gt; private IP of the node if you choose to use hostname.
&gt; 
&gt;&gt; Does anyone have any best practices around vm.args -name in EC2 environments?
&gt; 
&gt; We haven't outlined any best practices ourselves, but I tend to believe using 
&gt; a hostname that you can change the IP for via DNS or a hosts file is a more 
&gt; flexible way of approaching the problem. 
&gt; 
&gt; Grant
&gt; 
&gt; 
&gt;&gt; Thanks!
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03208.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#03210">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#03210">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03218.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03190.html">EC2 and node names</a></span> <span class="sender italic">Jeff Pollard</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03201.html">Re: EC2 and node names</a></span> <span class="sender italic">Grant Schofield</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03202.html">Re: EC2 and node names</a></span> <span class="sender italic">John E. Vincent</span></li>
<li class="icons-email"><span class="subject"><a href="msg03208.html">Re: EC2 and node names</a></span> <span class="sender italic">Jeff Pollard</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: EC2 and node names</span> <span class="sender italic">Grant Schofield</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03218.html">Re: EC2 and node names</a></span> <span class="sender italic">Jeff Pollard</span></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg03203.html">Re: EC2 and node names</a></span> <span class="sender italic">Dmitry Demeshchuk</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: EC2 and node names">
<input type="hidden" name="msgid" value="A06C657F-3158-4248-81D8-621F2B5E2C44@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03210.html">
<input type="submit" value=" Grant Schofield ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+EC2+and+node+names%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03208.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03218.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">A06C657F-3158-4248-81D8-621F2B5E2C44@basho.com</li>
</ul>
</div>
</body>
</html>
