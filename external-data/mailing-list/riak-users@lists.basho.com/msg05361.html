<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: eleveldb make test failure</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#05361" id="c">
<link rel="index" href="maillist.html#05361" id="i">
<link rel="prev" href="msg05349.html" id="p">
<link rel="next" href="msg05363.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05361.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+eleveldb+make+test+failure%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: eleveldb make test failure</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jared+Morrow%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jared Morrow</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111028" rel="nofollow">Fri, 28 Oct 2011 19:47:19 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Phil,

I tried reproducing the issue on OSX, Ubuntu 11, and Fedora 13 with no luck.
  The curiosity I have is the following</pre><pre>

&gt; undefined symbol: _ZN6snappy13RawUncompressEPKcmPc'&quot;}}
&gt; *** test module not found ***
&gt;
You have -DSNAPPY being passed into the compiler, and it appears that is
where the 'undefined symbol' error is coming from.   We don't compile with
snappy installed, so I'm not too familiar with its versions.   So if I was
you, I'd either double check if your snappy install is up to date, or simply
disable its use.   To do that, it seems like if you make a simple change to:
 c_src/leveldb/Makefile

Simply comment out the following section

# If Snappy is installed, add compilation and linker flags
&gt;&gt;
&gt;&gt;
&gt;
&gt; # (see <a  rel="nofollow" href="http://code.google.com/p/snappy/">http://code.google.com/p/snappy/</a>)
&gt;&gt;
&gt;&gt;
&gt;
&gt; ifeq ($(SNAPPY), 1)
&gt;
&gt; SNAPPY_CFLAGS=-DSNAPPY
&gt;
&gt; SNAPPY_LDFLAGS=-lsnappy
&gt;
&gt; else
&gt;
&gt; SNAPPY_CFLAGS=
&gt;
&gt; SNAPPY_LDFLAGS=
&gt;
&gt; endif
&gt;
&gt;


Then try a 'make clean' and 'make test' again.

If you are still having issues after that, please let me know.

-Jared



On Fri, Oct 28, 2011 at 1:09 PM, Phil Sorber &lt;p...@omniti.com&gt; wrote:

&gt; I am trying to do some benchmarking with eleveldb but even getting the
&gt; basic 'make test' going is failing. Am I doing something obviously
&gt; wrong here?
&gt;
&gt; Also, I tried to put the eleveldb driver into basho bench, but not
&gt; sure if that is the intent there.
&gt;
&gt; $ make test
&gt; ./rebar compile
&gt; ==&gt; eleveldb (compile)
&gt; make[1]: Entering directory `/home/phil/git/basho/eleveldb/c_src/leveldb'
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/builder.cc -o db/builder.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/c.cc -o db/c.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/db_impl.cc -o db/db_impl.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/db_iter.cc -o db/db_iter.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/filename.cc -o db/filename.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/dbformat.cc -o db/dbformat.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/log_reader.cc -o db/log_reader.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/log_writer.cc -o db/log_writer.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/memtable.cc -o db/memtable.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/repair.cc -o db/repair.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/table_cache.cc -o db/table_cache.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/version_edit.cc -o db/version_edit.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/version_set.cc -o db/version_set.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY db/write_batch.cc -o db/write_batch.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY port/port_posix.cc -o port/port_posix.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/block.cc -o table/block.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/block_builder.cc -o table/block_builder.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/format.cc -o table/format.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/iterator.cc -o table/iterator.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/merger.cc -o table/merger.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/table.cc -o table/table.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/table_builder.cc -o table/table_builder.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY table/two_level_iterator.cc -o table/two_level_iterator.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/arena.cc -o util/arena.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/cache.cc -o util/cache.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/coding.cc -o util/coding.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/comparator.cc -o util/comparator.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/crc32c.cc -o util/crc32c.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/env.cc -o util/env.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/env_posix.cc -o util/env_posix.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/hash.cc -o util/hash.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/histogram.cc -o util/histogram.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/logging.cc -o util/logging.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/options.cc -o util/options.o
&gt; g++  -fPIC -c -I. -I./include -fno-builtin-memcmp
&gt; -DLEVELDB_PLATFORM_POSIX -pthread -DOS_LINUX -O2 -DNDEBUG
&gt; -DSNAPPY util/status.cc -o util/status.o
&gt; rm -f libleveldb.a
&gt; ar -rs libleveldb.a ./db/builder.o ./db/c.o ./db/db_impl.o
&gt; ./db/db_iter.o ./db/filename.o ./db/dbformat.o ./db/log_reader.o
&gt; ./db/log_writer.o ./db/memtable.o ./db/repair.o ./db/table_cache.o
&gt; ./db/version_edit.o ./db/version_set.o ./db/write_batch.o
&gt; ./port/port_posix.o ./table/block.o ./table/block_builder.o
&gt; ./table/format.o ./table/iterator.o ./table/merger.o ./table/table.o
&gt; ./table/table_builder.o ./table/two_level_iterator.o ./util/arena.o
&gt; ./util/cache.o ./util/coding.o ./util/comparator.o ./util/crc32c.o
&gt; ./util/env.o ./util/env_posix.o ./util/hash.o ./util/histogram.o
&gt; ./util/logging.o ./util/options.o ./util/status.o
&gt; ar: creating libleveldb.a
&gt; make[1]: Leaving directory `/home/phil/git/basho/eleveldb/c_src/leveldb'
&gt; Compiled src/eleveldb.erl
&gt; Compiling c_src/eleveldb.cc
&gt; ./rebar eunit
&gt; ==&gt; eleveldb (eunit)
&gt; Compiled test/basho_bench_driver_eldb.erl
&gt; Compiled src/eleveldb.erl
&gt; undefined
&gt;
&gt; =ERROR REPORT==== 28-Oct-2011::14:52:58 ===
&gt; The on_load function for module eleveldb returned {error,
&gt;                                                   {load_failed,
&gt;                                                    &quot;Failed to load
&gt; NIF library: '/home/phil/git/basho/eleveldb/priv/eleveldb.so:
&gt; undefined symbol: _ZN6snappy13RawUncompressEPKcmPc'&quot;}}
&gt; *** test module not found ***
&gt; ::eleveldb
&gt;
&gt; =======================================================
&gt;  Failed: 0.  Skipped: 0.  Passed: 0.
&gt; One or more tests were cancelled.
&gt; ERROR: One or more eunit tests failed.
&gt; make: *** [test] Error 1
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05349.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#05361">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#05361">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05363.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05349.html">eleveldb make test failure</a></span> <span class="sender italic">Phil Sorber</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: eleveldb make test failure</span> <span class="sender italic">Jared Morrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05363.html">Re: eleveldb make test failure</a></span> <span class="sender italic">Phil Sorber</span></li>
<li class="icons-email"><span class="subject"><a href="msg05400.html">Re: eleveldb make test failure</a></span> <span class="sender italic">Phil Sorber</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05407.html">Re: eleveldb make test failure</a></span> <span class="sender italic">Jared Morrow</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: eleveldb make test failure">
<input type="hidden" name="msgid" value="CACUSOvdMkH8vn4RgMy_utNnpTffGp3ivC_cQNi_H4bn+yQDdpg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05361.html">
<input type="submit" value=" Jared Morrow ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+eleveldb+make+test+failure%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05349.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05363.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACUSOvdMkH8vn4RgMy_utNnpTffGp3ivC_cQNi_H4bn+yQDdpg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
