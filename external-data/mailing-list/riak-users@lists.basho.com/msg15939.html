<!DOCTYPE html>
<html lang="en">
<head>
<title>Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#15939" id="c">
<link rel="index" href="maillist.html#15939" id="i">
<link rel="prev" href="msg15841.html" id="p">
<link rel="next" href="msg15940.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15939.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Query+on+Riak+Search+in+a+cluster+of+3+nodes+behind+ELB+is+giving%09different+result+everytime%22&amp;o=newest" rel="nofollow"><span itemprop="name">Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Vitaliy+E%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Vitaliy E</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20150401" rel="nofollow">Wed, 01 Apr 2015 00:52:03 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hello everyone,

I've just joined the list, and am a bit late to the party. Sorry about
that. Thought I would contribute an answer anyway.</pre><pre>

Santi, what is you n_val?

I observed the behavior you are describing on Riak 2.0.0 with n_val=3 in
two cases:

1. One of the nodes was not part of the cluster although the cluster was
thinking it was. Don't ask me how that happened. Obviously, when a request
hit that node part of the entries could not be found there.

2. Look for indexing errors in Solr console and Riak logs. Each Riak node
has its own Solr &quot;repository&quot;, so if an entry fails to be indexed on any of
them, search results will be inconsistent depending on which set of nodes
returns it. Let's say you have replicas on nodes A, B, and C. Entry X
failed to be indexed on A, entry Y failed to be indexed on A and B, and
entry Z was indexed OK on all nodes. Then you may get {X,Y,Z}, {X,Z}, or
{Z} as your search results.

In our case the indexing failures were caused by disk/filesystem errors.

Regards,
Vitaly
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15841.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#15939">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#15939">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15940.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li><ul>
<li><ul>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15831.html">Re: Query on Riak Search in a cluster of 3 ...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15834.html">Re: Query on Riak Search in a cluster o...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15839.html">Re: Query on Riak Search in a clus...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15844.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li class="icons-email"><span class="subject"><a href="msg15846.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li class="icons-email"><span class="subject"><a href="msg15859.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li class="icons-email"><span class="subject"><a href="msg15860.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
<li class="icons-email"><span class="subject"><a href="msg15861.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Baskar Srinivasan</span></li>
<li class="icons-email"><span class="subject"><a href="msg15862.html">Re: Query on Riak Search in a ...</a></span> <span class="sender italic">Zeeshan Lakhani</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg15841.html">Re: Query on Riak Search in a clus...</a></span> <span class="sender italic">Santi Kumar</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email tSliceCur"><span class="subject">Query on Riak Search in a cluster of 3 nodes behind ELB ...</span> <span class="sender italic">Vitaliy E</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15940.html">Re: Query on Riak Search in a cluster of 3 nodes be...</a></span> <span class="sender italic">Alex De la rosa</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15942.html">Re: Query on Riak Search in a cluster of 3 node...</a></span> <span class="sender italic">Vitaliy E</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15944.html">Re: Query on Riak Search in a cluster of 3 ...</a></span> <span class="sender italic">Alex De la rosa</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg15941.html">Re: Query on Riak Search in a cluster of 3 nodes be...</a></span> <span class="sender italic">Santi Kumar</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15943.html">Re: Query on Riak Search in a cluster of 3 node...</a></span> <span class="sender italic">Vitaliy E</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg15945.html">Re: Query on Riak Search in a cluster of 3 nodes be...</a></span> <span class="sender italic">Michael Weibel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15946.html">Re: Query on Riak Search in a cluster of 3 node...</a></span> <span class="sender italic">Vitaliy E</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Query on Riak Search in a cluster of 3 nodes behind ELB is giving	different result everytime">
<input type="hidden" name="msgid" value="CAG57SfOcC1M+yzW_t9qg3U_Ch0V-oBeWGpv7wOeSsBZXBy=-mg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15939.html">
<input type="submit" value=" Vitaliy E ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Query+on+Riak+Search+in+a+cluster+of+3+nodes+behind+ELB+is+giving%09different+result+everytime%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15841.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15940.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAG57SfOcC1M+yzW_t9qg3U_Ch0V-oBeWGpv7wOeSsBZXBy=-mg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
