<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: 1.4.2: 'riak-admin reip' no longer works?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd8.html#12719" id="c">
<link rel="index" href="mail8.html#12719" id="i">
<link rel="prev" href="msg12718.html" id="p">
<link rel="next" href="msg12724.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12719.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+1.4.2%5C%3A+%27riak%5C-admin+reip%27+no+longer+works%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: 1.4.2: 'riak-admin reip' no longer works?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Joe+Caswell%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Joe Caswell</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131021" rel="nofollow">Mon, 21 Oct 2013 09:58:40 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Reip is the old, evil way to do it that is fraught with peril.  When it
works it works spectacularly, and when it doesn't, it fails spectacularly.
The only use case left for reip is when you have simultaneously changed the
node name for every node in the cluster, such as when loading an entire
cluster's worth of backups to new machines.  Since a node will not be able
to start unless it is a member of the ring it currently holds, and
`riak-admin cluster [force-]replace` requires there to be at least one node
in the cluster running,  reip is the only option to get the first node
started.  After the first node, all the rest can be handled with cluster
replace.</pre><pre>

Joe Caswell

From:  Brady Wetherington &lt;br...@bespincorp.com&gt;
Date:  Monday, October 21, 2013 12:26 PM
To:  Dave Brady &lt;dbr...@weborama.com&gt;
Cc:  Riak Users Mailing List &lt;riak-users@lists.basho.com&gt;
Subject:  Re: 1.4.2: 'riak-admin reip' no longer works?

Huh. I thought we were supposed to use &quot;force-replace&quot; instead of &quot;reip&quot;?

I remember having a discussion a few months back about the documentation and
we cleared it up a little.

Is &quot;reip&quot; the same as &quot;force-replace&quot;, or is it more...&quot;quick-and-dirty?&quot; Is
it deprecated?

-B.


On Mon, Oct 21, 2013 at 11:33 AM, Dave Brady &lt;dbr...@weborama.com&gt; wrote:
&gt; Thanks for clarifying it!
&gt; 
&gt; This functionality has been *great* to create quick-and-dirty test rings.
&gt; 
&gt; --
&gt; Dave Brady
&gt; 
&gt; 
&gt; From: &quot;Jared Morrow&quot; &lt;ja...@basho.com&gt;
&gt; To: &quot;Dave Brady&quot; &lt;dbr...@weborama.com&gt;
&gt; Cc: &quot;Riak Users Mailing List&quot; &lt;riak-users@lists.basho.com&gt;
&gt; Sent: Lundi 21 Octobre 2013 16:42:22
&gt; 
&gt; Subject: Re: 1.4.2: 'riak-admin reip' no longer works?
&gt; 
&gt; We actually discussed this recently, my understanding of reip was clearly not
&gt; complete, and Joe Caswell put me on the right track.  'reip' will continue to
&gt; stick around.
&gt; 
&gt; -Jared
&gt; 
&gt; 
&gt; On Mon, Oct 21, 2013 at 8:23 AM, Dave Brady &lt;dbr...@weborama.com&gt; wrote:
&gt;&gt; No problem, Jared!  I'm happy it was a very simple fix.
&gt;&gt; 
&gt;&gt; What concerns me is that the 'cluster' commands do not have an analogous
&gt;&gt; feature: 'replace' does not do the same thing as 'reip'.
&gt;&gt; 
&gt;&gt; Is it truly a foregone conclusion that 'reip' is going away?
&gt;&gt; 
&gt;&gt; --
&gt;&gt; Dave Brady
&gt;&gt; 
&gt;&gt; 
&gt;&gt; From: &quot;Jared Morrow&quot; &lt;ja...@basho.com&gt;
&gt;&gt; To: &quot;Dave Brady&quot; &lt;dbr...@weborama.com&gt;
&gt;&gt; Cc: &quot;Riak Users Mailing List&quot; &lt;riak-users@lists.basho.com&gt;
&gt;&gt; Sent: Lundi 21 Octobre 2013 16:17:52
&gt;&gt; Subject: Re: 1.4.2: 'riak-admin reip' no longer works?
&gt;&gt; 
&gt;&gt; 
&gt;&gt; This was a mistake on my part, if you s/up/down/ (node_down_check) on that
&gt;&gt; line it will correctly ensure the node is down before running reip.  Sorry
&gt;&gt; about that, clearly 'reip' is not heavily used with the new cluster commands
&gt;&gt; and it slipped under the radar for all these months.
&gt;&gt; 
&gt;&gt; -Jared
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Mon, Oct 21, 2013 at 7:48 AM, Dave Brady &lt;dbr...@weborama.com&gt; wrote:
&gt;&gt;&gt; Thanks to Joe Caswell at Basho: just have to comment out line 382
&gt;&gt;&gt; (node_up_check) in the riak-admin script.
&gt;&gt;&gt; 
&gt;&gt;&gt; --
&gt;&gt;&gt; Dave Brady
&gt;&gt;&gt; 
&gt;&gt;&gt; ----- Original Message -----
&gt;&gt;&gt; From: &quot;Dave Brady&quot; &lt;dbr...@weborama.com&gt;
&gt;&gt;&gt; To: riak-users@lists.basho.com
&gt;&gt;&gt; Sent: Lundi 21 Octobre 2013 13:59:37
&gt;&gt;&gt; Subject: 1.4.2: 'riak-admin reip' no longer works?
&gt;&gt;&gt; 
&gt;&gt;&gt; Hi everyone,
&gt;&gt;&gt; 
&gt;&gt;&gt; So, I went to copy /var/lib/riak/* from one five-node cluster to another, so
&gt;&gt;&gt; that we could experiment on the data.
&gt;&gt;&gt; 
&gt;&gt;&gt; I did this fairly frequently in the past (&lt; 1.4.0), and always used
&gt;&gt;&gt; &quot;riak-admin reip &lt;old&gt; &lt;new&gt;&quot;.
&gt;&gt;&gt; 
&gt;&gt;&gt; Now, when I try that command on our 1.4.2 ring, 'riak-admin' dies with &quot;Node
&gt;&gt;&gt; is not running!&quot;
&gt;&gt;&gt; 
&gt;&gt;&gt; This confuses me, since &quot;reip&quot; requires the ring to be down, but the
&gt;&gt;&gt; &quot;riak-admin&quot; script is indeed expecting the local node to be running when
&gt;&gt;&gt; using this option.
&gt;&gt;&gt; 
&gt;&gt;&gt; I see on the wiki that it is mentioned that &quot;cluster replace&quot; will replace
&gt;&gt;&gt; &quot;reip&quot; in the future.  I hope not, since &quot;cluster replace&quot; does not provide
&gt;&gt;&gt; the same functionality.
&gt;&gt;&gt; 
&gt;&gt;&gt; Anyone run into this and find a fix?  (Or I am missing something obvious?)
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt; 
&gt;&gt;&gt; --
&gt;&gt;&gt; Dave Brady
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt; 
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt; 
&gt;&gt; 
&gt; 
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 

_______________________________________________ riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12718.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd8.html#12719">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail8.html#12719">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12724.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12707.html">1.4.2: 'riak-admin reip' no longer works?</a></span> <span class="sender italic">Dave Brady</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12710.html">Re: 1.4.2: 'riak-admin reip' no longer works?</a></span> <span class="sender italic">Dave Brady</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12711.html">Re: 1.4.2: 'riak-admin reip' no longer works?</a></span> <span class="sender italic">Jared Morrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12714.html">Re: 1.4.2: 'riak-admin reip' no longer wor...</a></span> <span class="sender italic">Dave Brady</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12713.html">Re: 1.4.2: 'riak-admin reip' no longer...</a></span> <span class="sender italic">Dave Brady</span></li>
<li class="icons-email"><span class="subject"><a href="msg12716.html">Re: 1.4.2: 'riak-admin reip' no longer...</a></span> <span class="sender italic">Jared Morrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12717.html">Re: 1.4.2: 'riak-admin reip' no l...</a></span> <span class="sender italic">Dave Brady</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12718.html">Re: 1.4.2: 'riak-admin reip' ...</a></span> <span class="sender italic">Brady Wetherington</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: 1.4.2: 'riak-admin re...</span> <span class="sender italic">Joe Caswell</span></li>
<li class="icons-email"><span class="subject"><a href="msg12724.html">Re: 1.4.2: 'riak-admin re...</a></span> <span class="sender italic">Shane McEwan</span></li>
<li class="icons-email"><span class="subject"><a href="msg12727.html">Re: 1.4.2: 'riak-admin re...</a></span> <span class="sender italic">Rune Skou Larsen</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: 1.4.2: 'riak-admin reip' no longer works?">
<input type="hidden" name="msgid" value="CE8AD39F.28055%jcaswell@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12719.html">
<input type="submit" value=" Joe Caswell ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+1.4.2%5C%3A+%27riak%5C-admin+reip%27+no+longer+works%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12718.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12724.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CE8AD39F.28055%jcaswell@basho.com</li>
</ul>
</div>
</body>
</html>
