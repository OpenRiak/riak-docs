<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: CorrugatedIron v0.1.3 Released</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04970" id="c">
<link rel="index" href="maillist.html#04970" id="i">
<link rel="prev" href="msg04963.html" id="p">
<link rel="next" href="msg04833.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04970.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+CorrugatedIron+v0.1.3+Released%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: CorrugatedIron v0.1.3 Released</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Kyle+Quest%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Kyle Quest</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111001" rel="nofollow">Sat, 01 Oct 2011 11:08:52 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>No, it was a different .NET bug. Everything was running locally. Same
ConfigurationManager.GetSection() exception though...</pre><pre>

If we are sticking with .NET concepts then I'd use WCF as an
example... You can have it setup through app config files or you can
specify the parameters in the API.

The code samples I gave where just... samples for illustration
purposes :-) The main idea there was to illustrate a quick way to get
to a riak client object. You can still do all the cluster setup magic
behind the scene with this simplified API. When I create an
initialization API I have several versions:
1. Init API that grabs the init parameters from a config file (what
you have now in your library).
2. Init API that takes a string that contains init parameters (XML or
JSON or custom string; depending on the project; this ends up being
the most flexible init API that can be used in a lot of different
scenarios).
3. Init API that takes the init parameters as an object (so users can
specify the params programmatically).
4. Simplified Init API that takes the bare minimum init parameter set
(that's the code samples I showed).

Showing the &quot;transport&quot; param in the sample snippets was not there to
say that you must always specify transport info. It was just a sample
that I took from my python test code :-) I did notice that you
abstract the transport info and that's good.

Once again... what I provided wasn't an exact implementation spec. It
was just a sample to show the concept :-)

Even though the language silos still exists, it becomes more common
for people to be multilingual, so there's value in similarity. It
makes it easier for a Java developer to start using .NET libraries,
etc. It also helps when it comes to sample code... I'm not talking
about reusing the sample code from different languages, of course :-)
I'm talking about seeing samples in a different language with a
different library and then quickly translating it to what you need to
do. It's all about getting things done as fast as possible with least
effort possible :-)


On Sat, Oct 1, 2011 at 6:35 AM, OJ Reeves &lt;o...@buffered.io&gt; wrote:
&gt; Hi Kyle,
&gt; Thanks for the response. My comments are inline.
&gt;
&gt; On 1 October 2011 17:17, Kyle Quest &lt;kcq.li...@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt; You guys have done an amazing job the library in terms of its
&gt;&gt; capabilities. The docs are ok in most cases, but not always great.
&gt;&gt; Though compared to a lot of other code I've seen you are way ahead :-)
&gt;
&gt; Thank you. We realise we still have a way to go with the docs, but we wanted
&gt; to make sure that we at least had sample applications and enough
&gt; documentation to get people going. So far, we seemed to have managed to get
&gt; just over the line. More work certainly needs to be done and it's something
&gt; that Jeremiah and I are very aware of.
&gt;
&gt;&gt;
&gt;&gt; I didn't mean to imply that it would be a good idea to do a carbon
&gt;&gt; copy of the Erlang client library, but picking a language that's close
&gt;&gt; enough would makes sense.
&gt;
&gt; I was using Erlang as an extreme example, but the principle holds regardless
&gt; of what we compare it to. The closest language that has a Riak client is the
&gt; official Java client. While Russell has done an outstanding job with all the
&gt; work he has done I really don't feel that the .NET version should
&gt; necessarily take on the same look and feel. This is for a few reasons:
&gt;
&gt; There are obvious language differences, some of which are much nicer in .NET
&gt; than in Java (lambdas in particular). The .NET API should make good use of
&gt; features like this rather than suffer from trying to mimic another language
&gt; that doesn't have support for them. (though I believe Java either has
&gt; lambdas now or will have them soon. not sure, I'm not a big Java person :)).
&gt; The Java client has been around for quite a long time and its code base has
&gt; a long history. It has the pain of backwards compatibility and non-breaking
&gt; changes for existing users. Our library is obviously very new and doesn't
&gt; need to carry around any design issues that the Java client may or may not
&gt; have. Don't get me wrong, I am not saying that the Java client has design
&gt; issues. What I'm trying to say is that a library's design should do it's
&gt; best to model the requirement for the target DB as it currently stands and
&gt; not take on the look and feel of another library which has been around
&gt; longer.
&gt; The approach to Java apps isn't necessarily the same as .NET ones and I
&gt; don't believe that Java-like idioms should be brought into the .NET world.
&gt; .NET people have their own ways and they like to stick to them.
&gt;
&gt; Apart from those points, keeping API's consistent across the different
&gt; libraries isn't something that I consider important. I think it's more
&gt; important to have the library make sense to the community that it has been
&gt; targeted at. Asking someone to use your code is hard enough without saying
&gt; &quot;please think like a Java guy when you use this&quot; :)
&gt;
&gt;&gt;
&gt;&gt; .NET 4.0 has/had a bug in ConfigurationManager.GetSection() and that's
&gt;&gt; exactly what your library uses, so your library gets that bug too :-)
&gt;
&gt; Are you referring to the exception that gets thrown when you run the
&gt; application on a network share? (ie. this one)? If not, please let me know
&gt; which one it is as I haven't noticed any news of it at all. If it isÂ this
&gt; one, it honestly doesn't concern me at all. Nobody is going to run an
&gt; application like this, which talks to Riak, across a network share or using
&gt; UNC paths. Particularly not in production. Production applications will run
&gt; in IIS or will run on local machines. If this issue does crop up, I'm happy
&gt; to deal with it at that point. My gut feeling is that .NET 4.x will be
&gt; released with the fix before it is an issue for any of our users.
&gt;
&gt;&gt;
&gt;&gt; What you can't do with CorrugatedIron is something simple like this
&gt;&gt; (preferred):
&gt;&gt;
&gt;&gt; var client = new RiakClient(port: 8098, transport:
&gt;&gt; RiakClient.HttpTransport);
&gt;&gt; client.Blah()... etc
&gt;
&gt; There are multiple issues with this approach:
&gt;
&gt; You're completely bypassing clustering, load balancing and connection
&gt; pooling.
&gt; You have hard-coded references to ports, hosts, etc.
&gt; The user of the API is responsible for the lifetime of the client
&gt; connection.
&gt;
&gt; The above approach really only suits rapid development. It's the kind of
&gt; thing that you're going throw into a REPL and nothing more. Personally I
&gt; don't like the idea of exposing this kind of functionality to the user and
&gt; run the risk of it being misused in a production application. During
&gt; development you might want to quickly determine if you're able to connect to
&gt; the server and this can be done in so many ways, even outside of CI.
&gt; Configuration will need to be specified at some point any way, and won't end
&gt; up living in this version of the Config API.
&gt; We made a point from the outset with CI to make sure the user doesn't have
&gt; to think about the lifetime of the connections they're using. In fact, we
&gt; didn't want them to think about connections at all. We wanted users to focus
&gt; on what they wanted to do, the data they wanted to work with and to focus on
&gt; the business problem they're solving. Boilerplate code which worries about
&gt; connection lifetimes is not what we wanted to see ripple (pun intended)
&gt; through the client's code. Instead, when you use the RiakClient object in
&gt; CI, you just say &quot;please do this!&quot; without saying where it should happen,
&gt; how it should happen and what to do with the resources it has used while
&gt; doing it once it has finished.Â I think this has really helped in making the
&gt; API clean, and I'm quite pleased with the result :)
&gt; Let's face it, asking a dev to remember to put a connection back in a pool
&gt; is giving them rope to hang themselves with.
&gt; BTW as a small side point: you can't specify the transport type for the
&gt; client connections in CI. You have no choice but to use both REST and PBC.
&gt; This is because CorrugatedIron is responsible for making the right choice
&gt; for the transport to use for a given API call. That decision shouldn't be
&gt; made by the user of the library, instead they should only care about using
&gt; the client and asking for a function to be performed. How that function is
&gt; performed is and what transport is used is an implementation detail they
&gt; should be totally ignorant of. Not only does this allow people to just focus
&gt; on what they want to do, it means that we can easily change the transports
&gt; for the relative API functions across releases and the users of the API do
&gt; not have to change anything at all in their code. We're trying to protect
&gt; the users and I think this is a good idea.
&gt;&gt;
&gt;&gt; or at least something like that (to be close to the model you have):
&gt;&gt;
&gt;&gt; var cluster = RiakCluster.FromParams(port: 8098, transport:
&gt;&gt; RiakClient.HttpTransport);
&gt;&gt; var client = cluster.CreateClient();
&gt;&gt;
&gt;&gt; The above statement (RiakCluster.FromParams(...) can optionally take
&gt;&gt; an array of string to represent IP addresses for each node in the
&gt;&gt; cluster defaulting to one node on the localhost if nothing is
&gt;&gt; specified.
&gt;
&gt; This approach would require every Riak node to be running the exact same
&gt; configuration on every single node. This goes all the way to the number of
&gt; connections in the pool per node and the ports that REST and PBC are running
&gt; on. While this may be the most common scenario (and probably the recommended
&gt; one) it doesn't allow you to specify that configuration per node. To add
&gt; that support you'd have to add an (optional?) array for each of those
&gt; fields, at which point you're better off having objets/records which
&gt; represent each node. Now we're moving back towards what we already have.
&gt; If the list of IP addresses/host names was optional, where should we connect
&gt; to if they don't specify a host? The idea of &quot;sensible defaults&quot; is almost
&gt; impossible to apply. Every deployment of Riak should have its parameters
&gt; carefully considered and tweaked appropriately so that it is optimal for
&gt; that scenario.
&gt; Again, other than adding this to a REPL, I don't see this happening in
&gt; production.
&gt;&gt;
&gt;&gt; As for XML... I personally try to stay away from it and most of my
&gt;&gt; configs are in JSON even in .NET apps :-) By the way, you are using a
&gt;&gt; good JSON library, which is pretty good at dealing with not always
&gt;&gt; perfectly formatted JSON, so you can easily support JSON-based
&gt;&gt; configs.
&gt;
&gt; If we were talking about streams of data that are pushed from client to
&gt; server and vice versa then I would agree and I would look to use JSON. JSON
&gt; is much nicer and easier to deal with.
&gt; For one-off configuration, I really don't see an issue. XML and JSON are
&gt; really no different when it's a single-shot configuration block. I think the
&gt; XML vs JSON issue really isn't the deal breaker, for me it's the question of
&gt; where the configuration lives.
&gt; Almost every production .NET application has some sort of app.config or
&gt; web.config. This is where configuration lives and is where .NET people go
&gt; when they have their own configuration or if they're looking to modify
&gt; existing configuration. If we were to create a JSON-based configuration over
&gt; an XML one, where would it go? Bearing in mind that .NET config is XML by
&gt; default, we'd either have to have the files elsewhere on disk (resulting in
&gt; more assets to manage) or put the configuration in an XML field. The thought
&gt; of either of these doesn't appeal to me at all. What makes sense to me, and
&gt; to many other .NET people, is to remain consistent with the approach that
&gt; .NET takes as a whole, and use the existing features that come out of the
&gt; box. That is, use the configuration sections/elements/etc, use the
&gt; attributes that define the properties to get rudimentary validation and easy
&gt; deserialisation.
&gt; I just don't see the argument for JSON configuration compelling. I'm
&gt; certainly open to being convinced, but I'm yet to see an argument which
&gt; really tells me that I should go out on a limb and put in something
&gt; different to what most of the .NET world is already doing. And let's be
&gt; honest, we're talking about configurationÂ here. Once it's done, it's done.
&gt; It's not really an operational expense, a real-time data risk or anything
&gt; else that can drastically affect the success of your application. We're
&gt; literally just saying &quot;Hey, CI, please talk to that thing over there&quot;.
&gt;&gt;
&gt;&gt; Once again I'd like to say that you did a great job.
&gt;
&gt;
&gt; Thank you again for the feedback. It's always hard to get feedback of any
&gt; kind, and Jeremiah and I really appreciated it.
&gt;
&gt;&gt;
&gt;&gt; Having inline API
&gt;&gt; docs would be helpful.
&gt;
&gt; Agreed. Jeremiah has been bugging me about this (and rightly so). My
&gt; argument so far for not having it has been that our code churn has been
&gt; really high while building the early version of the library. Keeping code
&gt; comments and inline API documentation in sync while building it would have
&gt; been a huge overhead for us. Now that we're getting to the point where the
&gt; API is stable, we'll be investing the time to make sure that the comments
&gt; (which ironically have to be XML ;)) will be added.
&gt;
&gt;&gt;
&gt;&gt; And having a simple way to create clients
&gt;&gt; without having to deal with configs would be great (especially
&gt;&gt; considering the .NET 4.0 bug you are stuck with).
&gt;
&gt; Â Again, I'm not too concerned about the bug. I think it's an edge case that
&gt; won't hurt us at all. I also think that most users don't mind having a bit
&gt; of XML config as it's something they end up dealing with most of the time
&gt; any way.
&gt; Having said all this, I don't want to appear ignorant of the needs of the
&gt; users. My question is: does a block of XML configuration really stop you
&gt; from using the library?
&gt; Thank you again for your comments. We've dived into the configuration stuff
&gt; a bit here, but I'm still veryÂ interested in hearing about the other areas
&gt; of the API which you found complicated. Configuration is one thing that,
&gt; even if you don't like it, you can get past without too much pain. API
&gt; complexity is a very different and, in my view, a much more important issue
&gt; to fix. So when you have time I would love to hear your thoughts on where
&gt; the complexity has made your use of CI painful.
&gt; All the best!
&gt; OJ
&gt;

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04963.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04970">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04970">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04833.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg04832.html">CorrugatedIron v0.1.3 Released</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04942.html">Re: CorrugatedIron v0.1.3 Released</a></span> <span class="sender italic">Kyle Quest</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04943.html">Re: CorrugatedIron v0.1.3 Released</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04945.html">Re: CorrugatedIron v0.1.3 Released</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li class="icons-email"><span class="subject"><a href="msg04946.html">Re: CorrugatedIron v0.1.3 Released</a></span> <span class="sender italic">Kyle Quest</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04956.html">Re: CorrugatedIron v0.1.3 Released</a></span> <span class="sender italic">OJ Reeves</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04962.html">Re: CorrugatedIron v0.1.3 Released</a></span> <span class="sender italic">Kyle Quest</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04963.html">Re: CorrugatedIron v0.1.3 Relea...</a></span> <span class="sender italic">OJ Reeves</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: CorrugatedIron v0.1.3 R...</span> <span class="sender italic">Kyle Quest</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: CorrugatedIron v0.1.3 Released">
<input type="hidden" name="msgid" value="CAOuTbKNNsvDjM2Of+=6Rovs34eMHFLxqt-UpKLAKOfK826XNAg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04970.html">
<input type="submit" value=" Kyle Quest ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+CorrugatedIron+v0.1.3+Released%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04963.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04833.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAOuTbKNNsvDjM2Of+=6Rovs34eMHFLxqt-UpKLAKOfK826XNAg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
