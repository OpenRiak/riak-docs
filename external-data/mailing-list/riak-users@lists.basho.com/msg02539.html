<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: too_many_results error</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd3.html#02539" id="c">
<link rel="index" href="maillist.html#02539" id="i">
<link rel="prev" href="msg02537.html" id="p">
<link rel="next" href="msg02000.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg02539.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+too_many_results+error%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: too_many_results error</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Rusty+Klophaus%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Rusty Klophaus</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110303" rel="nofollow">Thu, 03 Mar 2011 05:07:06 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi John,

It sounds like there might be a misunderstanding here. The error is not
indicating that the index has grown to large, it's indicating that you are
running a query with many, many results - enough to potentially gobble up
all of your memory. Rather than let this happen, Riak Search tries to detect
the situation and fails the query rather than crashing.</pre><pre>

The intention is that most people will never bump up against the max_results
setting. The few who do will have special use cases with especially large
queries, and when this happens, it's going to require just a little testing
and tuning to find a number that is large enough to handle their queries
while still small enough to prevent memory exhaustion. It sounds like you
fall into this situation. If you are running on big servers, you can safely
bump up the number, the value depends on both your available memory and your
object size.

Best,
Rusty



On Thu, Mar 3, 2011 at 6:42 AM, John Axel Eriksson &lt;j...@insane.se&gt; wrote:

&gt; Well, I'm in this situation atm. I guess I could go and change the
&gt; max_results setting but really - this actually
&gt; means that I can't search my data and to me, it's more important to be able
&gt; to search than to get an error when
&gt; my index has grown too large. I understand that there's nothing for this in
&gt; the solr spec, but getting an error because
&gt; I've indexed too much data is kind of unexpected.
&gt;
&gt; I'm not familiar with the internals but I would've expected the rows
&gt; parameter to be applied before the max_results limit - not
&gt; the other way around. I suspect there's a reason for this, but still - my
&gt; data is now in an unsearchable state.
&gt;
&gt; 16 jan 2011 kl. 15.06 skrev Rusty Klophaus:
&gt;
&gt; That's one way of looking at it. The other viewpoint is that given the
&gt; choice between returning a partial (a.k.a. incorrect) result set vs. failing
&gt; loudly, the safest option is to fail loudly.
&gt;
&gt; Ideally there would be a way to return a partial result set with an
&gt; indication in Solr that the result set is partial, but:
&gt;
&gt; 1) The Solr spec doesn't indicate a way to include such a message (at least
&gt; none that I could find)
&gt; 2) This is the first iteration of this feature, so we decided to keep it
&gt; simple until we have more detailed information on what people need.
&gt;
&gt; So with that in mind, how would you prefer this be handled? I'm open to
&gt; rethinking the behavior.
&gt;
&gt; Best,
&gt; Rusty
&gt;
&gt;
&gt; On Sun, Jan 16, 2011 at 8:53 AM, Eric Moritz &lt;e...@themoritzfamily.com&gt;wrote:
&gt;
&gt;&gt; That sounds like a bug rather that a feature to me. For instance if I
&gt;&gt; wrote 100,001 blog entries, the search engine breaks hard for a query trying
&gt;&gt; to find my latest tweets.
&gt;&gt;
&gt;&gt; Is that what would happen?
&gt;&gt; ---------- Forwarded message ----------
&gt;&gt; From: &quot;Rusty Klophaus&quot; &lt;ru...@basho.com&gt;
&gt;&gt; Date: Jan 16, 2011 8:42 AM
&gt;&gt; Subject: Re: Re: too_many_results error
&gt;&gt; To: &quot;Eric Moritz&quot; &lt;e...@themoritzfamily.com&gt;
&gt;&gt; Cc: &quot;riak-users@lists.basho.com&quot; &lt;riak-users@lists.basho.com&gt;
&gt;&gt;
&gt;&gt; Hi Eric,
&gt;&gt;
&gt;&gt; This is a failsafe that is applied prior to the 'rows' parameter.
&gt;&gt;
&gt;&gt; It is applied separately to provide a hard system limit, intended to allow
&gt;&gt; the cluster administrator to guard against a malicious user, a client
&gt;&gt; application that accidentally requests too much data, etc.
&gt;&gt;
&gt;&gt; Best,
&gt;&gt; Rusty
&gt;&gt;
&gt;&gt;
&gt;&gt; On Sun, Jan 16, 2011 at 8:38 AM, Eric Moritz &lt;e...@themoritzfamily.com&gt;wrote:
&gt;&gt;
&gt;&gt;&gt; Would using the rows URL parameter fix this or is the error occurring
&gt;&gt;&gt; prior to the result being limited?
&gt;&gt;&gt;  ---------- Forwarded message ----------
&gt;&gt;&gt; From: &quot;Rusty Klophaus&quot; &lt;ru...@basho.com&gt;
&gt;&gt;&gt; Date: Jan 16, 2011 8:34 AM
&gt;&gt;&gt; Subject: Re: too_many_results error
&gt;&gt;&gt; To: &quot;Malka Feldman&quot; &lt;mal...@3basegroup.com&gt;
&gt;&gt;&gt; Cc: &lt;riak-users@lists.basho.com&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Hi Malka,
&gt;&gt;&gt;
&gt;&gt;&gt; The error you see is caused by a protective configuration setting that is
&gt;&gt;&gt; new in the 0.14 release. By default, the system will stop the query after
&gt;&gt;&gt; 100,000 results and return an error to the system. It is intended to prevent
&gt;&gt;&gt; Riak Search from grabbing all available memory when faced with a large
&gt;&gt;&gt; result set.
&gt;&gt;&gt;
&gt;&gt;&gt; You can override this by setting the 'max_search_results' setting in the
&gt;&gt;&gt; etc/app.config file.
&gt;&gt;&gt;
&gt;&gt;&gt; Best,
&gt;&gt;&gt; Rusty
&gt;&gt;&gt;
&gt;&gt;&gt; On Sun, Jan 16, 2011 at 7:11 AM, Malka Feldman &lt;mal...@3basegroup.com&gt;wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;  Hi
&gt;&gt;&gt;&gt; I try to get results from query through solr , but I get the error of
&gt;&gt;&gt;&gt; too many results
&gt;&gt;&gt;&gt; the query is :
&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://79.125.59.136:8098/solr/user_profile/select?q=country:USA">http://79.125.59.136:8098/solr/user_profile/select?q=country:USA</a>
&gt;&gt;&gt;&gt; I know I can have hundreds of thousands of answers, can it hold them?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; the error :
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; {error,
&gt;&gt;&gt;&gt;     {throw,
&gt;&gt;&gt;&gt;         {too_many_results,
&gt;&gt;&gt;&gt;             {scope,#Ref&lt;0.0.78.140604&gt;,&quot;user_profile&quot;,&quot;value&quot;,
&gt;&gt;&gt;&gt;                 {scope,#Ref&lt;0.0.78.140603&gt;,undefined,&quot;country&quot;,
&gt;&gt;&gt;&gt;                     {term,#Ref&lt;0.0.78.140609&gt;,&lt;&lt;&quot;USA&quot;&gt;&gt;,
&gt;&gt;&gt;&gt;                         [{'riak@10.230.7.111',28438},
&gt;&gt;&gt;&gt;                          {'riak@10.230.21.243',28438},
&gt;&gt;&gt;&gt;                          {'riak@10.230.45.195',28438}],
&gt;&gt;&gt;&gt;                         28438.0,1.0,
&gt;&gt;&gt;&gt;                         #Fun}}}},
&gt;&gt;&gt;&gt;         [{riak_search_client,'-search/5-fun-0-',4},
&gt;&gt;&gt;&gt;          {riak_search_client,fold_results,5},
&gt;&gt;&gt;&gt;          {riak_search_client,search,6},
&gt;&gt;&gt;&gt;          {riak_search_client,search_doc,6},
&gt;&gt;&gt;&gt;          {riak_solr_searcher_wm,run_query,1},
&gt;&gt;&gt;&gt;          {riak_solr_searcher_wm,to_xml,2},
&gt;&gt;&gt;&gt;          {webmachine_resource,resource_call,3},
&gt;&gt;&gt;&gt;          {webmachine_resource,do,3}]}}
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; thanks,
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; *Malka Feldman*
&gt;&gt;&gt;&gt; Tribase LTD.
&gt;&gt;&gt;&gt; 41 Shimon Hatzadik St.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Elad, Israel
&gt;&gt;&gt;&gt; Tel. 074-7122736  Fax. 03-9075211 Cell. 972-54-8370828
&gt;&gt;&gt;&gt; m &lt;miri.melt...@tribasesoft.com&gt;al...@3basegroup.com
&gt;&gt;&gt;&gt; www.3basegroup.com &lt;<a  rel="nofollow" href="http://www.tribasesoft.com/">http://www.tribasesoft.com/</a>&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; [image: cid:image001.jpg@01CB2DDB.3AC492C0]
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg02537.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd3.html#02539">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#02539">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg02000.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg01993.html">too_many_results error</a></span> <span class="sender italic">Malka Feldman</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01994.html">Re: too_many_results error</a></span> <span class="sender italic">Rusty Klophaus</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01995.html">Fwd: Re: too_many_results error</a></span> <span class="sender italic">Eric Moritz</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01996.html">Re: Re: too_many_results error</a></span> <span class="sender italic">Rusty Klophaus</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg01997.html">Fwd: Re: Re: too_many_results error</a></span> <span class="sender italic">Eric Moritz</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01998.html">Re: Re: Re: too_many_results error</a></span> <span class="sender italic">Rusty Klophaus</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg02537.html">Re: too_many_results error</a></span> <span class="sender italic">John Axel Eriksson</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: too_many_results error</span> <span class="sender italic">Rusty Klophaus</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: too_many_results error">
<input type="hidden" name="msgid" value="AANLkTi=HNmDOaCtfMhO_VokAt3jG56GNjFNA1FPLn5QS@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg02539.html">
<input type="submit" value=" Rusty Klophaus ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+too_many_results+error%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg02537.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg02000.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">AANLkTi=HNmDOaCtfMhO_VokAt3jG56GNjFNA1FPLn5QS@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
