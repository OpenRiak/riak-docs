<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak 1.0.2 RC1</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#05449" id="c">
<link rel="index" href="maillist.html#05449" id="i">
<link rel="prev" href="msg05445.html" id="p">
<link rel="next" href="msg05450.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05449.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+1.0.2+RC1%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak 1.0.2 RC1</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Joseph+Blomstedt%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Joseph Blomstedt</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111106" rel="nofollow">Sun, 06 Nov 2011 19:11:04 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>&gt; RE: large ring size warning in the release notes, is the performance
&gt; degradation linear below 256? That is, until the major release that fixes
&gt; this, is it best to keep ring sizes at 64 for best performance?</pre><pre>

The large ring size warning in the release notes is predominately
related to an issue with Riak's ring gossip functionality.
Adding/removing nodes, changing bucket properties, and setting cluster
metadata all result in a brief period (usually a few seconds) where
gossip traffic increases significantly. The size of the ring
determines both the number of gossip messages that occur during this
window, as well as the size of each message. With large rings, it is
possible that messages are generated faster than they can be handled,
resulting in large message queues that impact cluster performance and
tie up system memory until the message queues are fully drained. In
general, there is no problem as long as your hardware is fast enough
to process the brief spike in gossip traffic in close to real time.
Concerning this specific issue, choosing a ring size smaller than the
maximum you can handle does not provide any additional performance
gains.

However, unrelated to this issue, there are general performance
considerations related to ring size versus the number of nodes in your
cluster. Given a fixed number of nodes, a larger ring results in more
vnodes per node. This allows more process concurrency which may
improvement performance. However, each vnode runs it's own backend
instance that has it's own set of on-disk files, and competing
reads/writes to different files may result in additional I/O
contention than having fewer vnodes per node. The overall performance
is going to depend largely on your OS, your file system, and your
traffic pattern. So, it's hard to give specific hard and fast rules.
The other issue is 2I performance. Secondary indexes send request to a
covering set of vnodes, which works out to ring_size / N requests;
therefore increasing the ring_size without increasing N leads to more
2I requests. Again, the right answer depends largely on your use case.

Overall, I believe we normally recommend between 10 and 50 vnodes per
node, with the ring size rounded up to the next power of two.
Personally, I think 16 vnodes per node is a good number, which matches
the common 64 partition, 4 node Riak cluster. Thus, choosing a ring
size based on that ratio and your expected number of future nodes is a
reasonable choice. Just be sure to stay under 1024 until the issue
with gossip overloading the cluster is resolved.

-Joe

On Sat, Nov 5, 2011 at 9:49 AM, Jim Adler &lt;jim.ad...@comcast.net&gt; wrote:
&gt; RE: large ring size warning in the release notes, is the performance
&gt; degradation linear below 256? That is, until the major release that fixes
&gt; this, is it best to keep ring sizes at 64 for best performance?
&gt; Jim
&gt;
&gt; Sent from my phone. Please forgive the typos.
&gt; On Nov 4, 2011, at 7:20 PM, Jared Morrow &lt;ja...@basho.com&gt; wrote:
&gt;
&gt; As we've mentioned earlier, the 1.0.2 release of Riak is coming soon.   Like
&gt; we did with Riak 1.0.0, we are provided a release candidate for test before
&gt; we release 1.0.2 final.
&gt; You can find the packages here:
&gt; <a  rel="nofollow" href="http://downloads.basho.com/riak/riak-1.0.2rc1/">http://downloads.basho.com/riak/riak-1.0.2rc1/</a>
&gt; The release notes have been updated and can be found here:
&gt;  <a  rel="nofollow" href="https://github.com/basho/riak/blob/1.0/RELEASE-NOTES.org">https://github.com/basho/riak/blob/1.0/RELEASE-NOTES.org</a>
&gt; Thank you, as always, for continuing to provide bug reports and feedback.
&gt; -Jared
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;



-- 
Joseph Blomstedt &lt;j...@basho.com&gt;
Software Engineer
Basho Technologies, Inc.
<a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05445.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#05449">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#05449">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05450.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05444.html">Riak 1.0.2 RC1</a></span> <span class="sender italic">Jared Morrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05445.html">Re: Riak 1.0.2 RC1</a></span> <span class="sender italic">Jim Adler</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak 1.0.2 RC1</span> <span class="sender italic">Joseph Blomstedt</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05450.html">Re: Riak 1.0.2 RC1</a></span> <span class="sender italic">Jim Adler</span></li>
<li class="icons-email"><span class="subject"><a href="msg05452.html">Re: Riak 1.0.2 RC1</a></span> <span class="sender italic">Anthony Molinaro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05456.html">Re: Riak 1.0.2 RC1</a></span> <span class="sender italic">Joseph Blomstedt</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak 1.0.2 RC1">
<input type="hidden" name="msgid" value="CANvk2KQZGKW916eZobGnJ8uRnLKqguNibo21NaUODOWgyH5h3g@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05449.html">
<input type="submit" value=" Joseph Blomstedt ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+1.0.2+RC1%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05445.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05450.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CANvk2KQZGKW916eZobGnJ8uRnLKqguNibo21NaUODOWgyH5h3g@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
