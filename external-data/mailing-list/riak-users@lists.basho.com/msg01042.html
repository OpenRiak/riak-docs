<!DOCTYPE html>
<html lang="en">
<head>
<title>Listing large key spaces, and bucket Links header</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#01042" id="c">
<link rel="index" href="maillist.html#01042" id="i">
<link rel="prev" href="msg01041.html" id="p">
<link rel="next" href="msg01043.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg01042.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Listing+large+key+spaces%2C+and+bucket+Links+header%22&amp;o=newest" rel="nofollow"><span itemprop="name">Listing large key spaces, and bucket Links header</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Gavin+Carr%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Gavin Carr</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100906" rel="nofollow">Mon, 06 Sep 2010 09:03:45 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Greetings all,

I'm a riak newbie, trying out version 0.12.1. One of the use-cases
we're interested in is using riak as a backend for brackup[1], an
open source backup tool. </pre><pre>

brackup supports pluggable targets/backends, including filesystems, 
ftp, sftp, Amazon S3, etc. I've written a first-pass riak target 
that I'm testing, which works nicely for small backups. I'm now
looking to scale that up, and had a couple of questions.


1. Almost entirely brackup only needs per-key lookups and writes. 
The one one exception is garbage collection, where I need to walk 
the entire set of keys to figure out which chunks are orphaned and 
can therefore be deleted.

So I'm wondering is there an upper limit on number of keys where
&quot;listing keys is expensive&quot; turns into &quot;listing keys is insane&quot;?
I'm looking at millions of keys/chunks for large backups, I guess.

I guess splitting chunks over multiple buckets and performing
multiple queries might help. Is there an recommended upper limit
for keys per bucket on bitcask for sane list keys performance?


2. There seems to be a standard Link header coming back on my 
bucket key queries that is huge - twice the size of the response
body with my 45b keys. So for 50k keys the response is about 1MB,
and the Link header is about 2MB! I'm wondering if there's any
way of turning this off, given I aren't doing any Link walking?


Thanks,
Gavin


[1] <a  rel="nofollow" href="http://code.google.com/p/brackup/">http://code.google.com/p/brackup/</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg01041.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#01042">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#01042">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg01043.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Listing large key spaces, and bucket Links header</span> <span class="sender italic">Gavin Carr</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01043.html">Re: Listing large key spaces, and bucket Links header</a></span> <span class="sender italic">Justin Sheehy</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Listing large key spaces, and bucket Links header">
<input type="hidden" name="msgid" value="20100906160329.GD1925@openfusion.com.au">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg01042.html">
<input type="submit" value=" Gavin Carr ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Listing+large+key+spaces%2C+and+bucket+Links+header%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg01041.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg01043.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">20100906160329.GD1925@openfusion.com.au</li>
</ul>
</div>
</body>
</html>
