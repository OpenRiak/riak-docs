<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Correct way to use pbc/mapreduce to do multiget where keys and	bucket names are binary values?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#03559" id="c">
<link rel="index" href="mail2.html#03559" id="i">
<link rel="prev" href="msg03556.html" id="p">
<link rel="next" href="msg03593.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03559.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Correct+way+to+use+pbc%5C%2Fmapreduce+to+do+multiget+where+keys+and%09bucket+names+are+binary+values%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Correct way to use pbc/mapreduce to do multiget where keys and	bucket names are binary values?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jacques%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jacques</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110604" rel="nofollow">Sat, 04 Jun 2011 13:54:22 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Interesting.  Are there any benefits to maintaining the json version of the
map reduce definition for the pb client?  If the erlang version of the
mapreduce definition offers a superset of the json functionality, couldn't
it simply replace the json version?</pre><pre>

Thoughts?

I guess one downside would be not being able to share the code with the http
version of the client.  (But this is begs the question of why ultimately to
have the http client for anything but calls the pb client doesn't support).

As an aside, I ran across your alternative ideas around a cleaner riak
client api and on first glance it definitely looks more usable.

I have to run off but will drill into this on Monday.  Thanks again for your
help!

Jacques


On Sat, Jun 4, 2011 at 1:19 PM, Russell Brown &lt;russell.br...@me.com&gt; wrote:

&gt;
&gt; On 4 Jun 2011, at 18:22, Jacques wrote:
&gt;
&gt; I like the sound of option 3 also. I'll have a look at it this weekend and
&gt;&gt; get back to you.
&gt;&gt;
&gt;
&gt; Awesome!  Thanks.  If you can give me a point in the right direction
&gt; regarding the correct typing approach and what not, I'm up for giving it a
&gt; shot as well.
&gt;
&gt;
&gt; Ok, I have a half working hack. It isn't pretty 'cos the Jinterface API is
&gt; verbose. I've hacked the pbc.MapReduceBuilder to encode the job as
&gt; &quot;application/x-erlang-binary&quot; and submit that, but really this code should
&gt; be in a separate class, maybe using the output from
&gt; MapReduceBuilder.getJSON() as input. That way you can get the feature
&gt; without patching the client.
&gt;
&gt; What I haven't done is decode the response from Riak yet. If you want  a
&gt; pointer here is a gist of the (unclean) hack. It could use a lot of work,
&gt; but it proves the concept:
&gt;
&gt; <a  rel="nofollow" href="https://gist.github.com/1008293">https://gist.github.com/1008293</a>
&gt;
&gt; The gist is just the diff so you can apply it as a patch
&gt; to src/main/java/com/basho/riak/pbc/mapreduce/MapReduceBuilder.java if you
&gt; want to play with it.
&gt;
&gt; You'll have to add Jinterface to your pom too.
&gt;
&gt;     &lt;!-- jinterface --&gt;
&gt;     &lt;dependency&gt;
&gt; &lt;groupId&gt;org.erlang.otp&lt;/groupId&gt;
&gt; &lt;artifactId&gt;jinterface&lt;/artifactId&gt;
&gt; &lt;version&gt;1.5.4&lt;/version&gt;
&gt;     &lt;/dependency&gt;
&gt;
&gt; I think it is best to put the result decoding outside the library too. I'm
&gt; going to hack up a poc for that now, but I thought I'd post what I have thus
&gt; far.
&gt;
&gt; Cheers
&gt;
&gt; Russell
&gt;
&gt;
&gt; Thanks again,
&gt; Jacques
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03556.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#03559">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#03559">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03593.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03524.html">Correct way to use pbc/mapreduce to do multiget where keys a...</a></span> <span class="sender italic">Jacques</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03528.html">Re: Correct way to use pbc/mapreduce to do multiget whe...</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03533.html">Re: Correct way to use pbc/mapreduce to do multiget...</a></span> <span class="sender italic">Jacques</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03540.html">Re: Correct way to use pbc/mapreduce to do mult...</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03542.html">Re: Correct way to use pbc/mapreduce to do ...</a></span> <span class="sender italic">Jacques</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03550.html">Re: Correct way to use pbc/mapreduce t...</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03556.html">Re: Correct way to use pbc/mapredu...</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Correct way to use pbc/map...</span> <span class="sender italic">Jacques</span></li>
<li class="icons-email"><span class="subject"><a href="msg03593.html">Re: Correct way to use pbc/map...</a></span> <span class="sender italic">Jacques</span></li>
<li class="icons-email"><span class="subject"><a href="msg03594.html">Re: Correct way to use pbc/map...</a></span> <span class="sender italic">Russell Brown</span></li>
<li class="icons-email"><span class="subject"><a href="msg03604.html">Re: Correct way to use pbc/map...</a></span> <span class="sender italic">Jacques</span></li>
<li class="icons-email"><span class="subject"><a href="msg03697.html">Re: Correct way to use pbc/map...</a></span> <span class="sender italic">Jacques</span></li>
<li class="icons-email"><span class="subject"><a href="msg03706.html">Re: Correct way to use pbc/map...</a></span> <span class="sender italic">Russell Brown</span></li>
<li class="icons-email"><span class="subject"><a href="msg03717.html">Re: Correct way to use pbc/map...</a></span> <span class="sender italic">Jacques</span></li>
<li class="icons-email"><span class="subject"><a href="msg03722.html">Re: Correct way to use pbc/map...</a></span> <span class="sender italic">Jacques</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Correct way to use pbc/mapreduce to do multiget where keys and	bucket names are binary values?">
<input type="hidden" name="msgid" value="BANLkTikgTqzF-VmNfaDXrxgMykrNjRq5+A@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03559.html">
<input type="submit" value=" Jacques ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Correct+way+to+use+pbc%5C%2Fmapreduce+to+do+multiget+where+keys+and%09bucket+names+are+binary+values%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03556.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03593.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">BANLkTikgTqzF-VmNfaDXrxgMykrNjRq5+A@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
