<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: distributed basho bench</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd3.html#16976" id="c">
<link rel="index" href="maillist.html#16976" id="i">
<link rel="prev" href="msg16515.html" id="p">
<link rel="next" href="msg16508.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg16976.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+distributed+basho+bench%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: distributed basho bench</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Kinson+Chan+%E9%99%B3%E5%82%91%E4%BF%A1%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Kinson Chan 陳傑信</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20160117" rel="nofollow">Sun, 17 Jan 2016 20:05:00 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Sorry for pumping the thread, but it looks much less trivial than anticipated.  
Without a single line of error, the benchmark program (bhead) simply started 
everything by itself.  I have watched login records of the remote nodes, and 
there has not been a single login attempt.  Could anyone give me some hints?  
Thanks...</pre><pre>

[root@iZ94zaby5xkZ basho_bench]# basho_bench -N bhead@10.44.90.29 -C mycookies 
-d /root/basho_bench/results /root/basho_bench/basho_cluster.config             
                                                                                
                                                         
11:58:02.157 [debug] Lager installed handler {lager_file_backend,
                            
&quot;/root/basho_bench/results/20160118_115802/console.log&quot;} into lager_event
11:58:02.157 [debug] Lager installed handler {lager_file_backend,
                            
&quot;/root/basho_bench/results/20160118_115802/error.log&quot;} into lager_event
11:58:02.157 [debug] Lager installed handler error_logger_lager_h into 
error_logger
11:58:02.173 [debug] Supervisor gr_param_sup started 
gr_param:start_link(gr_lager_default_tracer_params) at pid &lt;0.67.0&gt;
11:58:02.173 [debug] Supervisor gr_counter_sup started 
gr_counter:start_link(gr_lager_default_tracer_counters) at pid &lt;0.68.0&gt;
11:58:02.173 [debug] Supervisor gr_manager_sup started 
gr_manager:start_link(gr_lager_default_tracer_params_mgr, 
gr_lager_default_tracer_params, []) at pid &lt;0.69.0&gt;
11:58:02.173 [debug] Supervisor gr_manager_sup started 
gr_manager:start_link(gr_lager_default_tracer_counters_mgr, 
gr_lager_default_tracer_counters, [{input,0},{filter,0},{output,0}]) at pid 
&lt;0.70.0&gt;
11:58:02.309 [info] Application lager started on node 'bhead@10.44.90.29'
11:58:02.312 [notice] Changed loglevel of 
/root/basho_bench/results/20160118_115802/console.log to debug
11:58:02.320 [debug] Supervisor inet_gethost_native_sup started undefined at 
pid &lt;0.80.0&gt;
11:58:02.320 [debug] Supervisor kernel_safe_sup started 
inet_gethost_native:start_link() at pid &lt;0.79.0&gt;
11:58:02.642 [debug] Lager installed handler lager_backend_throttle into 
lager_event
11:58:02.712 [info] No dimension available for key generator: 
{int_to_bin_bigendian,{uniform_int,200000}}
11:58:02.727 [debug] Supervisor sasl_safe_sup started 
alarm_handler:start_link() at pid &lt;0.93.0&gt;
11:58:02.728 [debug] Supervisor sasl_safe_sup started overload:start_link() at 
pid &lt;0.94.0&gt;
11:58:02.732 [debug] Supervisor sasl_sup started 
supervisor:start_link({local,sasl_safe_sup}, sasl, safe) at pid &lt;0.92.0&gt;
11:58:02.738 [debug] Supervisor sasl_sup started release_handler:start_link() 
at pid &lt;0.95.0&gt;
11:58:02.738 [info] Application sasl started on node 'bhead@10.44.90.29'
11:58:02.745 [debug] Supervisor crypto_sup started crypto_server:start_link() 
at pid &lt;0.101.0&gt;
11:58:02.746 [info] Application crypto started on node 'bhead@10.44.90.29'
11:58:02.746 [debug] Supervisor folsom_sup started 
folsom_sample_slide_sup:start_link() at pid &lt;0.111.0&gt;
11:58:02.746 [debug] Supervisor folsom_sup started 
folsom_meter_timer_server:start_link() at pid &lt;0.112.0&gt;
11:58:02.747 [debug] Supervisor folsom_sup started 
folsom_metrics_histogram_ets:start_link() at pid &lt;0.113.0&gt;
11:58:02.747 [info] Application folsom started on node 'bhead@10.44.90.29'
11:58:02.748 [info] Random source: calling crypto:rand_bytes(100663296) 
(override with the 'value_generator_source_size' config option
11:58:02.748 [debug] Supervisor basho_bench_sup started 
basho_bench_stats:start_link() at pid &lt;0.106.0&gt;
11:58:05.655 [info] Random source: finished crypto:rand_bytes(100663296)
11:58:05.658 [info] Using target {10,44,90,29}:8087 for worker 1
11:58:05.659 [debug] Supervisor basho_bench_sup started 
basho_bench_worker:start_link(basho_bench_worker_1, 1) at pid &lt;0.116.0&gt;
11:58:05.660 [info] Using target {10,116,145,71}:8087 for worker 2
11:58:05.660 [info] Using target {10,44,90,29}:8087 for worker 3
11:58:05.661 [info] Using target {10,116,145,71}:8087 for worker 4
11:58:05.661 [debug] Supervisor basho_bench_sup started 
basho_bench_worker:start_link(basho_bench_worker_2, 2) at pid &lt;0.120.0&gt;
11:58:05.661 [debug] Supervisor basho_bench_sup started 
basho_bench_worker:start_link(basho_bench_worker_3, 3) at pid &lt;0.123.0&gt;
11:58:05.662 [info] Starting max worker: &lt;0.127.0&gt; on 'bhead@10.44.90.29'
11:58:05.662 [info] Starting max worker: &lt;0.124.0&gt; on 'bhead@10.44.90.29'
11:58:05.662 [debug] Supervisor basho_bench_sup started 
basho_bench_worker:start_link(basho_bench_worker_4, 4) at pid &lt;0.126.0&gt;
11:58:05.662 [info] Starting max worker: &lt;0.121.0&gt; on 'bhead@10.44.90.29'
11:58:05.663 [info] Starting max worker: &lt;0.118.0&gt; on 'bhead@10.44.90.29'
11:58:05.663 [debug] Supervisor kernel_safe_sup started timer:start_link() at 
pid &lt;0.129.0&gt;
11:58:05.663 [info] Application basho_bench started on node 'bhead@10.44.90.29'

In the basho_cluster.config:
{mode, max}.
{duration, 5}.
{report_interval,1}.
{concurrent, 4}.
{driver, basho_bench_driver_riakc_pb}.
{key_generator, {int_to_bin_bigendian, {uniform_int, 200000}}}.
{value_generator, {fixed_bin, 1000}}.
{riakc_pb_ips, [{10,44,90,29},{10,116,145,71}]}.
{riakc_pb_replies, 1}.
{operations, [{get, 1}, {update, 1}]}.
%% Use {auto_reconnect, false} to get &quot;old&quot; behavior (prior to April 2013).
%% See deps/riakc/src/riakc_pb_socket.erl for all valid socket options.
{pb_connect_options, [{auto_reconnect, true}]}.
%% Overrides for the PB client's default 60 second timeout, on a
%% per-type-of-operation basis.  All timeout units are specified in
%% milliseconds.  The pb_timeout_general config item provides a
%% default timeout if the read/write/listkeys/mapreduce timeout is not
%% specified.
{pb_timeout_general, 30000}.
{pb_timeout_read, 5000}.
{pb_timeout_write, 5000}.
{pb_timeout_listkeys, 50000}.
%% The general timeout will be used because this specific item is commented:
%% {pb_timeout_mapreduce, 50000}.
%% Remote_nodes must be in the format of [{fqdn, nodename}]
%% basho_bench / distributed Erlang use longnames
{remote_nodes, [{'head.local', 'bb'}, {'head2.local', 'bb'}]}.
{distribute_work, true}.

Regards,
Kinson

On 14 Sep, 2015, at 11:23 am, Sargun Dhillon &lt;sar...@sargun.me&gt; wrote:

&gt; So, the way it should work is pretty simple:
&gt; Run the command a la: ./basho_bench -N nodeA@10.0.1.123 -C basho_bench_cookie 
&gt; &lt;config&gt; 
&gt; (It's key that the IP address be the external IP, and not the internal IP of 
&gt; the box, a la loopback)
&gt; 
&gt; In addition, nodeB must have the same version of Erlang installed as Node A. 
&gt; So, typically, you should install ESL Erlang (my recommendation is R16, 
&gt; <a  rel="nofollow" href="https://www.erlang-solutions.com/downloads/download-erlang-otp">https://www.erlang-solutions.com/downloads/download-erlang-otp</a>) on both 
&gt; boxes, and compile your own Basho bench.
&gt; 
&gt; -Thanks,
&gt; Sargun!
&gt; 
&gt; On Thu, Sep 10, 2015 at 9:15 AM, Jens V. Fischer &lt;jensvfisc...@gmail.com&gt; 
&gt; wrote:
&gt; Hi,
&gt; 
&gt; I'm trying to use basho bench in distributed mode, that is to say to use more 
&gt; than one machine for load generation. The documentation and the &quot;--join&quot; 
&gt; param of the basho_bench seem to indicate that this should be possible. But 
&gt; so far I failed to set it up. Let's say I want to start basho bench on two 
&gt; nodes, lets call them Node A and B. What parameters to basho_bench are needed 
&gt; on A and B respectively? 
&gt; 
&gt; I also saw the previous mail exchange on the topic (How to run bash bench 
&gt; distributed, 18.5.2015). From there I gathered that I need to use something 
&gt; like the following (for Node A):
&gt; 
&gt; Start command:
&gt; ./basho_bench -N nodeA@127.0.0.1 -C basho_bench_cookie &lt;config&gt;
&gt; 
&gt; Also I need in my config (on Node A):
&gt; {remote_nodes, [{&lt;domain_name_remote_node&gt;, 'nodeB'}]}.
&gt; {distribute_work, true}.
&gt; 
&gt; Do I need to do anything on Node B? Like starting basho_bench with &quot;--join&quot;? 
&gt; What would the command look like? What do I need to put into my config on 
&gt; Node B? In what order do I have to execute the commands on A and B? 
&gt; 
&gt; Additionally, as I am trying to use the distributed setup with a custom 
&gt; driver: Does distributed mode only works with certain drivers, i.e. does the 
&gt; driver need to support it? For what exactly is the passwordless SSH needed? 
&gt; Because I don't have SSH access on the particular cluster, I do however have 
&gt; access over TCP and are, for example, able to setup distributed Erlang 
&gt; between the nodes. Any chance to get basho_bench working in this setup?
&gt; 
&gt; Any help is greatly appreciated. I'm glad to provide more information if 
&gt; needed. 
&gt; 
&gt; Best regards
&gt; Jens
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

--
Kinson Chan, PhD
Senior System Engineer
Direct Line: +852 2655 6113        Tel: +852 2655 6100        Email:
kinsonc...@clustertech.com

ClusterTech Limited
Modernize Your Business with Advanced Computing Technologies
Cloud + High Performance Computing + Big Data + FPGA
Business Intelligence ∙ Financial Engineering ∙ Environmental Science ∙ Smart 
City

Website: www.clustertech.com/         Fax: +852 2994 2101
Hong Kong Address: Units 211 - 213, Lakeside 1, No. 8 Science Park West
Ave., Science Park, N.T. Hong Kong
Hong Kong ∙ Beijing ∙ Shanghai ∙ Guangzhou ∙ Shenzhen ∙ Wuhan ∙ Xi'an ∙ Sydney
**********************************************************************************************************************
The information contained in this e-mail and its attachments is
confidential and intended solely for the specified addressees. If you
have received this email in error, please do not read, copy, distribute,
disclose or use any information of this email in any way and please
immediately notify the sender and delete this email. Thank you for your
cooperation.
**********************************************************************************************************************


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg16515.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd3.html#16976">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#16976">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg16508.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg16507.html">distributed basho bench</a></span> <span class="sender italic">Jens V. Fischer</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16515.html">Re: distributed basho bench</a></span> <span class="sender italic">Sargun Dhillon</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: distributed basho bench</span> <span class="sender italic">Kinson Chan 陳傑信</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: distributed basho bench">
<input type="hidden" name="msgid" value="700DC191-E0B0-4B52-8A93-94DB3694E611@clustertech.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg16976.html">
<input type="submit" value=" Kinson Chan 陳傑信 ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+distributed+basho+bench%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg16515.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg16508.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">700DC191-E0B0-4B52-8A93-94DB3694E611@clustertech.com</li>
</ul>
</div>
</body>
</html>
