<!DOCTYPE html>
<html lang="en">
<head>
<title>Riak crashing due to "eheap_alloc: Cannot allocate xxxx bytes of	memory"</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#03929" id="c">
<link rel="index" href="maillist.html#03929" id="i">
<link rel="prev" href="msg03928.html" id="p">
<link rel="next" href="msg03941.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03929.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+crashing+due+to+%5C%22eheap_alloc%5C%3A+Cannot+allocate+xxxx+bytes+of%09memory%5C%22%22&amp;o=newest" rel="nofollow"><span itemprop="name">Riak crashing due to "eheap_alloc: Cannot allocate xxxx bytes of	memory"</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeff+Pollard%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeff Pollard</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110705" rel="nofollow">Tue, 05 Jul 2011 08:58:45 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Over the last few days we've had random nodes in our 5-node cluster crash
with &quot;eheap_alloc: Cannot allocate xxxx bytes of memory&quot; errors in the
erl_crash.dump file.  In general, the error messages seem to crash trying to
allocate 13-20 gigs of memory (our boxes have 32 gigs total).  As far as I
can tell crashing doesn't seem to coincide with any particular requests to
Riak.  I've tried to make some sense fo the erl_crash.dump file but haven't
had any luck.  I'm also in the process of restoring our riak bakups to our
staging cluster in hopes of more accurately reproducing the issue in a less
noisy environment.</pre><pre>

My questions for the list are:

   1. Any clue how to further diagnose the issue? I can attach my
   erl_crash.dump if needed.
   2. Is it possible/likely this is due to large m/r requests?  We have a
   couple m/r requests.  One goes over no more than 4 documents at a time while
   the other goes over anywhere between 60 and 10,000 documents, though more
   towards the smaller number of documents.  We use 16 js VMs with max memory
   for the VM and stack of 32 MB, each.
   3. We're running riak 0.14.1.  Would upgrading to 0.14.2 help?

Thanks!
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03928.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#03929">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#03929">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03941.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Riak crashing due to &quot;eheap_alloc: Cannot allocate xxxx ...</span> <span class="sender italic">Jeff Pollard</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03941.html">Re: Riak crashing due to &quot;eheap_alloc: Cannot alloc...</a></span> <span class="sender italic">Jeff Pollard</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03942.html">Re: Riak crashing due to &quot;eheap_alloc: Cannot a...</a></span> <span class="sender italic">Aphyr</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Riak crashing due to &quot;eheap_alloc: Cannot allocate xxxx bytes of	memory&quot;">
<input type="hidden" name="msgid" value="CAF0rtAG54h1Qh=cbNSpTTxjLGt_dN3Dv8EAu_fC7s4tWoH9q=w@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03929.html">
<input type="submit" value=" Jeff Pollard ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+crashing+due+to+%5C%22eheap_alloc%5C%3A+Cannot+allocate+xxxx+bytes+of%09memory%5C%22%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03928.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03941.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAF0rtAG54h1Qh=cbNSpTTxjLGt_dN3Dv8EAu_fC7s4tWoH9q=w@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
