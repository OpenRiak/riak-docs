<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Facing exception error in riak-erlang client in erlang shell	while doing Mapreduce</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#14224" id="c">
<link rel="index" href="maillist.html#14224" id="i">
<link rel="prev" href="msg14223.html" id="p">
<link rel="next" href="msg14226.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg14224.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Facing+exception+error+in+riak%5C-erlang+client+in+erlang+shell%09while+doing+Mapreduce%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Facing exception error in riak-erlang client in erlang shell	while doing Mapreduce</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Gopi+Krishna%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Gopi Krishna</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140517" rel="nofollow">Sat, 17 May 2014 08:16:19 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi,

I got it. very much thanks,one more doubt please clarify it.</pre><pre>

same thing i have done for another bucket called &quot;test&quot; which contains data
in the form of key, value.

but when i do map reduce i am getting the following:

{ok, [{0,[S]}]} =
riakc_pb_socket:mapred(Pid,&lt;&lt;&quot;test&quot;&gt;&gt;,[{map,{qfun,Maps},none,true}]).
** exception error: no match of right hand side value {ok,[{0,
                                                            [&lt;&lt;&quot;{\&quot;age\&quot;:
24, \&quot;name\&quot;: \&quot;krishna\&quot;}&quot;&gt;&gt;,
                                                             &lt;&lt;&quot;{\&quot;age\&quot;:
29, \&quot;name\&quot;: \&quot;sharat\&quot;}&quot;&gt;&gt;,
                                                             &lt;&lt;&quot;{\&quot;age\&quot;:
27, \&quot;name\&quot;: \&quot;anil\&quot;}&quot;&gt;&gt;,
                                                             &lt;&lt;&quot;{\&quot;age\&quot;:
28, \&quot;name\&quot;: \&quot;kumar\&quot;}&quot;&gt;&gt;,
                                                             &lt;&lt;&quot;{\&quot;age\&quot;:
24, \&quot;name\&quot;: \&quot;gopi\&quot;}&quot;&gt;&gt;,
                                                             &lt;&lt;&quot;{\&quot;age\&quot;:
25, \&quot;name\&quot;: \&quot;ramesh\&quot;}&quot;&gt;&gt;]}]}





On Sat, May 17, 2014 at 8:21 PM, Steve Vinoski &lt;st...@basho.com&gt; wrote:

&gt;
&gt;
&gt;
&gt; On Sat, May 17, 2014 at 10:04 AM, Gopi Krishna &lt;g...@lintelindia.com&gt;wrote:
&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I am getting the following , don't know what was happening could you
&gt;&gt; please elaborate and explain the solution to this.
&gt;&gt;
&gt;&gt; I am working on erlang-riak-client.
&gt;&gt;
&gt;&gt;
&gt;&gt; 1&gt; {ok, Pid} = riakc_pb_socket:start_link('127.0.0.1',10017).
&gt;&gt; {ok,&lt;0.34.0&gt;}
&gt;&gt; 2&gt;
&gt;&gt; 2&gt;
&gt;&gt; 2&gt; Object = riakc_obj:new(&lt;&lt;&quot;test_age&quot;&gt;&gt;, &lt;&lt;&quot;test1&quot;&gt;&gt;, &lt;&lt;&quot;gopi &amp; 1&quot;&gt;&gt;).
&gt;&gt; {riakc_obj,&lt;&lt;&quot;test_age&quot;&gt;&gt;,&lt;&lt;&quot;test1&quot;&gt;&gt;,undefined,[],
&gt;&gt;            undefined,&lt;&lt;&quot;gopi &amp; 1&quot;&gt;&gt;}
&gt;&gt; 3&gt;
&gt;&gt; 3&gt;
&gt;&gt; 3&gt; riakc_pb_socket:put(Pid,Object).
&gt;&gt; ok
&gt;&gt; 4&gt;
&gt;&gt; 4&gt; Mapf = fun(Obj,_,_) -&gt; [{I,1}|| I &lt;-
&gt;&gt; binary_to_term(riak_object:get_value(Object))] end.
&gt;&gt;
&gt;
&gt; There are two problems with your Mapf function:
&gt;
&gt; 1. The body of the function incorrectly uses Object, which is a variable
&gt; in your shell from command 2, rather than Obj, the incoming parameter to
&gt; the function. This is the source of the function_clause error you're
&gt; getting.
&gt;
&gt; 2. You've stored a binary value in your object, not an Erlang term, so
&gt; binary_to_term will fail here with a badarg exception. Change your Mapf
&gt; function to this instead:
&gt;
&gt; Mapf = fun(Obj,_,_) -&gt; [riak_object:get_value(Obj)] end.
&gt;
&gt; #Fun&lt;erl_eval.18.82930912&gt;
&gt;&gt; 5&gt; {ok, [{0,[R]}]} =
&gt;&gt; riakc_pb_socket:mapred(Pid,&lt;&lt;&quot;test_age&quot;&gt;&gt;,[{map,{qfun,Mapf},none,true}])
&gt;&gt; 5&gt; .
&gt;&gt; ** exception error: no match of right hand side value
&gt;&gt; {error,&lt;&lt;&quot;{\&quot;phase\&quot;:0,\&quot;error\&quot;:\&quot;function_clause\&quot;,\&quot;input\&quot;:\&quot;{ok,{r_object,&lt;&lt;\\\&quot;test_age\\\&quot;&gt;&gt;,&lt;&lt;\\\&quot;test1\\\&quot;&gt;&gt;,[{r_content,{dict&quot;...&gt;&gt;}
&gt;&gt;
&gt;
&gt; If you make the changes I described above, you get:
&gt;
&gt; 5&gt; {ok, [{0,[R]}]} =
&gt; riakc_pb_socket:mapred(Pid,&lt;&lt;&quot;test_age&quot;&gt;&gt;,[{map,{qfun,Mapf},none,true}]).
&gt; {ok,[{0,[&lt;&lt;&quot;gopi &amp; 1&quot;&gt;&gt;]}]}
&gt; 6&gt; R.
&gt; &lt;&lt;&quot;gopi &amp; 1&quot;&gt;&gt;
&gt;
&gt; exactly as expected.
&gt;
&gt; --steve
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;


-- 

Thanks &amp; Regards,
J.Gopi Krishna
+91-8341452934,
www.lintelindia.com
Lintel Technologies Pvt. LTD,Hyderabad.

This message contains confidential information and is intended for
recipient. If you are not the intended recipient you are notified that
disclosing, copying, distributing or taking any action in reliance on the
contents of this information is strictly prohibited. E-mail transmission
cannot be guaranteed to be secure or error-free as information could be
intercepted, corrupted, lost, destroyed, arrive late or incomplete, or
contain viruses. The sender therefore does not accept liability for any
errors or omissions in the contents of this message, which arise as a
result of e-mail transmission. If verification is required please request a
hard-copy version.
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg14223.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#14224">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#14224">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg14226.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg14222.html">Facing exception error in riak-erlang client in erlang shell...</a></span> <span class="sender italic">Gopi Krishna</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14223.html">Re: Facing exception error in riak-erlang client in erl...</a></span> <span class="sender italic">Steve Vinoski</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Facing exception error in riak-erlang client in...</span> <span class="sender italic">Gopi Krishna</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14226.html">Re: Facing exception error in riak-erlang clien...</a></span> <span class="sender italic">Steve Vinoski</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Facing exception error in riak-erlang client in erlang shell	while doing Mapreduce">
<input type="hidden" name="msgid" value="CAGHdnkP4hkZX0YVqLohbP=M-Om-fA+s+Ba32Og+eOUN_EJ6KDA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg14224.html">
<input type="submit" value=" Gopi Krishna ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Facing+exception+error+in+riak%5C-erlang+client+in+erlang+shell%09while+doing+Mapreduce%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg14223.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg14226.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAGHdnkP4hkZX0YVqLohbP=M-Om-fA+s+Ba32Og+eOUN_EJ6KDA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
