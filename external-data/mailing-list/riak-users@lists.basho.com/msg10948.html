<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Yokozuna max practical bucket limit</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#10948" id="c">
<link rel="index" href="maillist.html#10948" id="i">
<link rel="prev" href="msg10802.html" id="p">
<link rel="next" href="msg10950.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg10948.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Yokozuna+max+practical+bucket+limit%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Yokozuna max practical bucket limit</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Ryan+Zezeski%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ryan Zezeski</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130422" rel="nofollow">Mon, 22 Apr 2013 13:22:28 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Elias,

I could see that being something some folks want.  From my point of view, I
&gt; find that the existing design of one core per bucket may be more useful, so
&gt; long as I can search across cores with similar schemas (I created an 
&gt; issue&lt;<a  rel="nofollow" href="https://github.com/basho/yokozuna/issues/87">https://github.com/basho/yokozuna/issues/87</a>&gt;to track that feature), as 
&gt; it allows me to easily drop the index for a
&gt; bucket.  In a multi-tenant environment, where you may have an index per
&gt; customer, this is rather useful.  A lot less painful than trying to delete
&gt; the index (and data) by performing a key listing and delete operations.
&gt;</pre><pre>

Well you still can't avoid the key-listing/delete for Riak itself.  For
Solr this would be a delete-by-query which isn't nearly as expensive.


&gt;
&gt; As I've expressed before, I wish buckets behaved the same way, segregating
&gt; their data into distinct backend, but I understand that this results in
&gt; lower resource usage, as things like LevelDB caches would then not be
&gt; shared and you'd need additional file descriptors.  At the very least, it
&gt; would be great if backend instances could be
&gt; created programmatically through the HTTP or PB API, rather than having to
&gt; modify app.config and perform a rolling restart.  That not very
&gt; operationally friendly.
&gt;

Yes, there are benefits to be had both ways.  Segregating the actual
backend instances allows for efficient drop of entire bucket, but adds
strain in terms of file descriptors and I/O contention.  Multi-backend
sorta helps but is static in nature as you mention.


&gt;
&gt; As for large number of cores, I could see some folks creating many of
&gt; them.  Buckets are relatively cheap, since by default they are all stored
&gt; in the default backend instance.  Their only cost being
&gt; the additional network traffic for gossiping non-default bucket properties.
&gt;  So folks create them freely. Once Yokozuna is better documented, it should
&gt; be pointed out that the same is not true of a bucket's index, since they
&gt; create one core per bucket.  So an indexed bucket has quite a bit more
&gt; static overhead than non-indexed one.
&gt;

Good point.


&gt;
&gt; If you use Riak and have 300 customers, you can easily create a bucket per
&gt; customer, even if you only have 64 partions and are using Riak Search on
&gt; all of them, as Search stores all the data in the same merge index backend.
&gt;  You may want to twice before upgrading such cluster to Yokozuna.
&gt;

Well, Riak Search will have issues as well.  First, each bucket will
require a pre-commit hook to be installed which means custom bucket
properties to be copied into the ring.  There is a known drawback with Riak
where many bucket properties greatly reduce ring gossip throughput and can
cause issues.  I believe Joseph Blomstedt may have some patches going into
the next release that will improve this but ultimately we need to get
bucket properties out of the ring.  Even if that is solved, Riak Search
will have other tradeoffs such as substantially reduced feature support
compared to Yokozuna as well as reduced performance for many types of
queries.  But I do agree many indexes (thus cores) could pose a problem for
Yokozuna.

-Z
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg10802.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#10948">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#10948">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg10950.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg10770.html">Yokozuna max practical bucket limit</a></span> <span class="sender italic">Elias Levy</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10786.html">Re: Yokozuna max practical bucket limit</a></span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10802.html">Re: Yokozuna max practical bucket limit</a></span> <span class="sender italic">Elias Levy</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Yokozuna max practical bucket limit</span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10950.html">Re: Yokozuna max practical bucket limit</a></span> <span class="sender italic">Elias Levy</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Yokozuna max practical bucket limit">
<input type="hidden" name="msgid" value="CACZcpe=fyA3Vn1rHApqXu_mHQeKTDFuaUpPHONHQSSCy3djvbA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg10948.html">
<input type="submit" value=" Ryan Zezeski ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Yokozuna+max+practical+bucket+limit%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg10802.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg10950.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACZcpe=fyA3Vn1rHApqXu_mHQeKTDFuaUpPHONHQSSCy3djvbA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
