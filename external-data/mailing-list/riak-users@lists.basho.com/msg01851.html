<!DOCTYPE html>
<html lang="en">
<head>
<title>A first encounter with Riak/Riak-search - not getting it to work.</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#01851" id="c">
<link rel="index" href="maillist.html#01851" id="i">
<link rel="prev" href="msg01847.html" id="p">
<link rel="next" href="msg01852.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg01851.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22A+first+encounter+with+Riak%5C%2FRiak%5C-search+%5C-+not+getting+it+to+work.%22&amp;o=newest" rel="nofollow"><span itemprop="name">A first encounter with Riak/Riak-search - not getting it to work.</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Sven+Johansson%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Sven Johansson</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20101229" rel="nofollow">Wed, 29 Dec 2010 07:01:32 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>I am putting together an application prototype for a client that needs to
store vast amounts of historical data.
The data is supposed to be delivered to this application as XML, and these
documents needs to be searchable
based on certain field values in these documents.</pre><pre>

After reading up on Riak, and riak-search more specifically, I found that it
seemed like a very good match given
that it is supposed to be able to understand and index XML documents out of
the box.
(In the end, I'm expecting to find that it's a more efficient solution to
using a custom index &amp; analyzer factory, but
from what I can make of the docs in the Basho wiki the out of the
box-behaviour should suffice for the prototype).

However, things are not going as smooth as one would expect.
As soon as I enable an index through the precommit-hook on a bucket, I am
getting a 403 response back
for any PUT or POST operation that does not use the content type
&quot;text/plain&quot;.
This seems a bit off to me that riak-search is able to introspect both
application/xml and application/json, but
will not accept content declared to be of these MIME types.
I am getting errors

Having accepted this for the time being, I have gone ahead to import some
test documents into riak-search and
attempt to query the index.

This is the format of my test documents:

&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;Event&gt;
  &lt;EntityRef&gt;NUR-X5-199-456&lt;/EntityRef&gt;
  &lt;Nodes&gt;
    &lt;NodeRef&gt;NN-CUST-7278&lt;/NodeRef&gt;
    &lt;NodeRef&gt;NN-CUST-9619&lt;/NodeRef&gt;
    &lt;NodeRef&gt;NN-CUST-699&lt;/NodeRef&gt;
    &lt;NodeRef&gt;NN-CUST-8184&lt;/NodeRef&gt;
    &lt;NodeRef&gt;NN-SYS-2383&lt;/NodeRef&gt;
   &lt;/Nodes&gt;
&lt;/Event&gt;

Querying the index with q=EntityRef will give me all of the results back, as
expected.
However, attempting to use actual values to search, like so:
q=EntityRef:NUR-X5-199-456
gives me nothing.

I have also stored the sample XML from the wiki in the same bucket, and yes
- a query for
q=name:Alyssa%20P.%20Hacker does indeed return _that_ document.

I am completely new to Riak, so what I know I've learned through this
experiment and reading up
on the wiki (which, alas, does not indulge in detail), which has left me
with having to do some
guesswork to get me this far.

Any feedback &amp; help on what I might be doing wrong, would be greatly
appreciated.

Thanks / Sven

-- 
Sven Johansson
Phone: +46704966945
Twitter: @svjson
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg01847.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#01851">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#01851">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg01852.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">A first encounter with Riak/Riak-search - not getting it to...</span> <span class="sender italic">Sven Johansson</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01852.html">Re: A first encounter with Riak/Riak-search - not gett...</a></span> <span class="sender italic">Rusty Klophaus</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="A first encounter with Riak/Riak-search - not getting it to work.">
<input type="hidden" name="msgid" value="AANLkTikn+U58ZzVtWo8q1aOg_CXw-_Y3Z523H-q9K91b@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg01851.html">
<input type="submit" value=" Sven Johansson ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22A+first+encounter+with+Riak%5C%2FRiak%5C-search+%5C-+not+getting+it+to+work.%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg01847.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg01852.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">AANLkTikn+U58ZzVtWo8q1aOg_CXw-_Y3Z523H-q9K91b@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
