<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Quick Q re: error</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09301" id="c">
<link rel="index" href="maillist.html#09301" id="i">
<link rel="prev" href="msg09298.html" id="p">
<link rel="next" href="msg09303.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09301.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Quick+Q+re%5C%3A+error%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Quick Q re: error</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Sean+Cribbs%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Sean Cribbs</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121113" rel="nofollow">Tue, 13 Nov 2012 07:40:23 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Glad you figured it out, Martin.

As you may have noticed, while Ripple provides the tight Rails
integration with initializers and such, the basic client does not. If
people think that's a valuable feature, I'd be happy to accept
pull-requests. :D</pre><pre>

On Tue, Nov 13, 2012 at 9:30 AM, Martin Streicher
&lt;martin.streic...@gmail.com&gt; wrote:
&gt;
&gt; The issue was inconsistent configuration. There was a call to 
&gt; Riak::Client.new in config/initializers/riak.rb and two more calls in a 
&gt; method to do searches. I expected Riak::Client.new to perhaps pick up 
&gt; settings from a YML file each time, but I think I was wrong. I changed the 
&gt; code to create one connection in the initializers file, pointing to the node 
&gt; defined in the YML file, and then reuse that connection.
&gt;
&gt; Martin
&gt;
&gt;
&gt;
&gt; On Nov 10, 2012, at 12:05 PM, Sean Cribbs wrote:
&gt;
&gt;&gt; Can you ping the node? i.e. Riak::Client.ping
&gt;&gt;
&gt;&gt; On Fri, Nov 9, 2012 at 9:17 AM, Martin Streicher
&gt;&gt; &lt;martin.streic...@gmail.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Locally, everything runs fine when on 127.0.0.1.
&gt;&gt;&gt;
&gt;&gt;&gt; If I change to 192.168.0.2 and change the vm.args and app.config and remove 
&gt;&gt;&gt; the data/rings, I fail to connect when trying to enable search.
&gt;&gt;&gt;
&gt;&gt;&gt; I can get further if I do
&gt;&gt;&gt;
&gt;&gt;&gt; client = Riak::Client.new(nodes: [{host: '192.168.0.2'}])
&gt;&gt;&gt;
&gt;&gt;&gt; and then enable search using that client variable.
&gt;&gt;&gt;
&gt;&gt;&gt; I think I am misunderstanding something about the nodes and which nodes the 
&gt;&gt;&gt; operations are going to.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Nov 9, 2012, at 12:10 PM, Sean Cribbs wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Well, it's pretty obvious that it simply can't connect, especially
&gt;&gt;&gt;&gt; since your configuration is the default -- which means HTTP pointed to
&gt;&gt;&gt;&gt; 127.0.0.1:8098. Is your Riak node running and on that port? Can you
&gt;&gt;&gt;&gt; hit it from curl on the command line?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Fri, Nov 9, 2012 at 7:36 AM, Martin Streicher
&gt;&gt;&gt;&gt; &lt;martin.streic...@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I'm not doing anything special in Riak::Client.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; How can I narrow what the RuntimeError is?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; On Nov 9, 2012, at 10:21 AM, Sean Cribbs wrote:
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Martin,
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; How is your Riak::Client object configured? That looks like one of two
&gt;&gt;&gt;&gt;&gt;&gt; possibilities: first, the request failed 3 times in a row; second, one
&gt;&gt;&gt;&gt;&gt;&gt; of the backends is raising an exception that seems network related but
&gt;&gt;&gt;&gt;&gt;&gt; isn't one of the standard network errors (i.e it's a RuntimeError, but
&gt;&gt;&gt;&gt;&gt;&gt; it should be a SystemError with econnrefused errno!).
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; On Fri, Nov 9, 2012 at 7:12 AM, Martin Streicher
&gt;&gt;&gt;&gt;&gt;&gt; &lt;martin.streic...@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I get a connection refused error when I try to enable search from my 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; code.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/shared/bundle/ruby/1.9.1/gems/riak-client-1.0.5/lib/riak/client.rb:450:in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  `rescue in recover_from': Connection refused - connect(2) 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; (RuntimeError)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/shared/bundle/ruby/1.9.1/gems/riak-client-1.0.5/lib/riak/client.rb:422:in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  `recover_from'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/shared/bundle/ruby/1.9.1/gems/riak-client-1.0.5/lib/riak/client.rb:284:in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  `http'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/shared/bundle/ruby/1.9.1/gems/riak-client-1.0.5/lib/riak/client.rb:129:in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  `backend'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/shared/bundle/ruby/1.9.1/gems/riak-client-1.0.5/lib/riak/client.rb:246:in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  `get_bucket_props'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/shared/bundle/ruby/1.9.1/gems/riak-client-1.0.5/lib/riak/bucket.rb:77:in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  `props'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/shared/bundle/ruby/1.9.1/gems/riak-client-1.0.5/lib/riak/bucket.rb:68:in
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  `props='
&gt;&gt;&gt;&gt;&gt;&gt;&gt;      from 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; /var/www/zutron/releases/20121108191450/lib/classes/riak_search.rb:6:in 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; `enable_search'
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; enable_search is:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; def self.enable_search(bucket_name, client = Riak::Client.new)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  bucket = client.bucket bucket_name
&gt;&gt;&gt;&gt;&gt;&gt;&gt;  bucket.props = {search: true}
&gt;&gt;&gt;&gt;&gt;&gt;&gt; end
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Any ideas why it's failing? Search is enabled on the machine.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt;&gt;&gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt;&gt;&gt;&gt;&gt;&gt; Software Engineer
&gt;&gt;&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt;&gt;&gt;&gt; Software Engineer
&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt; <a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt;&gt; Software Engineer
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; <a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>
&gt;



-- 
Sean Cribbs &lt;s...@basho.com&gt;
Software Engineer
Basho Technologies, Inc.
<a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09298.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09301">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09301">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09303.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg09254.html">Quick Q re: error</a></span> <span class="sender italic">Martin Streicher</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09256.html">Re: Quick Q re: error</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09257.html">Re: Quick Q re: error</a></span> <span class="sender italic">Martin Streicher</span></li>
<li class="icons-email"><span class="subject"><a href="msg09258.html">Re: Quick Q re: error</a></span> <span class="sender italic">Martin Streicher</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09263.html">Re: Quick Q re: error</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09265.html">Re: Quick Q re: error</a></span> <span class="sender italic">Martin Streicher</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09278.html">Re: Quick Q re: error</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09298.html">Re: Quick Q re: error</a></span> <span class="sender italic">Martin Streicher</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Quick Q re: error</span> <span class="sender italic">Sean Cribbs</span></li>
<li class="icons-email"><span class="subject"><a href="msg09303.html">Re: Quick Q re: error</a></span> <span class="sender italic">Martin Streicher</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Quick Q re: error">
<input type="hidden" name="msgid" value="CAHsw=e0U31nfPKUR96=O6N2jvW350e+O_o8v-LLTBCHbYN357Q@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09301.html">
<input type="submit" value=" Sean Cribbs ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Quick+Q+re%5C%3A+error%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09298.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09303.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAHsw=e0U31nfPKUR96=O6N2jvW350e+O_o8v-LLTBCHbYN357Q@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
