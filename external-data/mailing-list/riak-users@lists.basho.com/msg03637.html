<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Question for Riak Developer Advocates</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd6.html#03637" id="c">
<link rel="index" href="mail6.html#03637" id="i">
<link rel="prev" href="msg03636.html" id="p">
<link rel="next" href="msg03623.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03637.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Question+for+Riak+Developer+Advocates%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Question for Riak Developer Advocates</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Andrew+Thompson%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Andrew Thompson</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110609" rel="nofollow">Thu, 09 Jun 2011 20:31:09 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>On Thu, Jun 09, 2011 at 08:01:24PM -0700, Ben Tilly wrote:
&gt; It sounds like you understood perfectly.
&gt; 
&gt; Basically we are running a cluster of machines that are busy doing
&gt; lots of stuff.  We wanted to use Riak to keep configuration
&gt; information about those machines and the stuff they were doing.  So
&gt; Riak would be running on machines whose primary job is something else.
&gt;  A critical use case for us is to figure out what needs to be done on
&gt; which other machines after one of the machines goes down.  Therefore
&gt; having the potential to have our data unavailable during a failover
&gt; because of the failover kills the benefit that we wanted from a high
&gt; availability system.</pre><pre>

I think you're confusing 2 issues. The time when a *new* node is joining
a cluster or an established node is leaving the cluster *VS* when a node
in the cluster is unavailable.

In the first case, when you are changing the cluster membership (not the
list of available nodes) you will currently get notfounds as the
partitions claims are changed.

In the second case (which should be the more common one if you aren't
constantly adding/removing nodes from the cluster) you will NOT receive
notfounds (assuming your n_val is &gt; 1 and your r value is less than the
n_val). When you do a get on the key which is stored on the downed node
riak will create a fallback vnode for the missing vnode, do a GET on
that key (and it should get N-1 replies) and do a
read-repair on the newly spun up fallback vnode. You should not get
notfounds in this case unless R==N or N=1 or you've had multiple nodes
fail since you last fetched this key (if the cluster is large enough
this should be unlikely).

If you want to increase your robustness further, you can increase N and
reduce R. Git HEAD also has a new GET parameter called notfound_ok,
which instructs riak to treat notfound responses as valid responses
(counting towards R) instead as an error.

Let me know if that clarifies things at all.

Andrew

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03636.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd6.html#03637">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail6.html#03637">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03623.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03619.html">Question for Riak Developer Advocates</a></span> <span class="sender italic">Srdjan Pejic</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03621.html">Re: Question for Riak Developer Advocates</a></span> <span class="sender italic">Scott Gonyea</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03622.html">Re: Question for Riak Developer Advocates</a></span> <span class="sender italic">John Hornbeck</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg03633.html">Re: Question for Riak Developer Advocates</a></span> <span class="sender italic">Ben Tilly</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03635.html">Re: Question for Riak Developer Advocates</a></span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03636.html">Re: Question for Riak Developer Advocates</a></span> <span class="sender italic">Ben Tilly</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Question for Riak Developer Advocates</span> <span class="sender italic">Andrew Thompson</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Question for Riak Developer Advocates">
<input type="hidden" name="msgid" value="20110610033032.GB1658@hijacked.us">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03637.html">
<input type="submit" value=" Andrew Thompson ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Question+for+Riak+Developer+Advocates%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03636.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03623.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">20110610033032.GB1658@hijacked.us</li>
</ul>
</div>
</body>
</html>
