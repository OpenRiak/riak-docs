<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Strange Exception in java-client</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09925" id="c">
<link rel="index" href="maillist.html#09925" id="i">
<link rel="prev" href="msg09924.html" id="p">
<link rel="next" href="msg09926.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09925.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Strange+Exception+in+java%5C-client%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Strange Exception in java-client</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Ingo+Rockel%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ingo Rockel</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130130" rel="nofollow">Wed, 30 Jan 2013 08:09:39 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Hi Dmitri,

</pre><tt>it doesn't happen in my code and it does happen while the riak-client 
</tt><tt>tries to deserialize a fetched object from riak in a 
</tt><tt>&quot;fetch-before-store&quot; (see the stack), I also get this error randomly 
</tt><tt>while trying just to fetch an object from the database.
</tt><pre style="margin: 0em;"></pre><pre>

</pre><tt>And if I try to fetch the object from the cmdline I just get a 404. So I 
</tt><tt>would expect the java-client just returns a null-result for this fetch 
</tt><tt>and not to throw an exception.
</tt><pre style="margin: 0em;">

</pre><tt>All my objects are stored using the riak-java-client and the 
</tt><tt>json-serializer.
</tt><pre style="margin: 0em;">

</pre><tt>Ahh, just tested: if I retry it sometimes works, although most of the 
</tt><tt>time still fails (haven't tried with a sleep so far).
</tt><pre style="margin: 0em;">

Ingo

Am 30.01.2013 16:57, schrieb Dmitri Zagidulin:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Ingo.

It's difficult to diagnose the exact reason without looking at your code.
But that error is a JSON parser error. It gets thrown whenever the code
tries to parse an empty string as a json object.
The general-case solution is to validate your strings or input streams
that you're turning into JSON objects, or to catch an exception when
creating that object and deal with it accordingly.

But again, it's hard to say why it's happening exactly, in your case --
try to determine where in your code that's happening and think of ways
some input or result is empty, and check for that.

Dmitri



On Wed, Jan 30, 2013 at 10:44 AM, Ingo Rockel
&lt;ingo.roc...@bluelionmobile.com &lt;<a  rel="nofollow" href="mailto:ingo.roc...@bluelionmobile.com">mailto:ingo.roc...@bluelionmobile.com</a>&gt;&gt;
wrote:

    Hi,

    I wrote a java tool to convert part of our data from a
    mysql-database into riak. As this tool is running while our system
    is still up, it needs to replay all modifications done in the mysql
    database, during these modifications I sometimes get this exception
    from the riak client:

    com.basho.riak.client.convert.__ConversionException:
    java.io.EOFException: No content to map to Object due to end of input
    com.basho.riak.client.convert.__ConversionException:
    java.io.EOFException: No content to map to Object due to end of input
             at
    
com.basho.riak.client.convert.__JSONConverter.toDomain(__JSONConverter.java:167)
             at
    
com.basho.riak.client.__operations.FetchObject.__execute(FetchObject.java:110)
             at
    
com.basho.riak.client.__operations.StoreObject.__execute(StoreObject.java:112)
             at
    
com.bluelionmobile.qeep.__messaging.db.impl.__MessageKVImpl.__storeUniqueMessageDto(__MessageKVImpl.java:264)
             at
    
com.bluelionmobile.qeep.__messaging.db.impl.__MessageKVImpl.__createDataFromDTO(__MessageKVImpl.java:138)
             at
    
com.bluelionmobile.qeep.__messaging.db.impl.__MessageKVImpl.__updateDataFromDTO(__MessageKVImpl.java:205)
             at
    
com.bluelionmobile.qeep.__messaging.db.utils.Replay$__ReplayRunner.run(Replay.java:__243)
             at java.lang.Thread.run(Thread.__java:722)
    Caused by: java.io.EOFException: No content to map to Object due to
    end of input
             at
    
org.codehaus.jackson.map.__ObjectMapper._initForReading(__ObjectMapper.java:2775)
             at
    
org.codehaus.jackson.map.__ObjectMapper._readMapAndClose(__ObjectMapper.java:2718)
             at
    org.codehaus.jackson.map.__ObjectMapper.readValue(__ObjectMapper.java:1863)
             at
    
com.basho.riak.client.convert.__JSONConverter.toDomain(__JSONConverter.java:156)
             ... 7 more

    it only happens once every few thousand updates and if I check the
    object from the cmdline I only get a 404.

    Any ideas what might cause this and how to fix/workaround it?

    Ingo


    _________________________________________________
    riak-users mailing list
    riak-users@lists.basho.com &lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;
    <a  rel="nofollow" href="http://lists.basho.com/__mailman/listinfo/riak-users___lists.basho.com">http://lists.basho.com/__mailman/listinfo/riak-users___lists.basho.com</a>
    &lt;<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>&gt;




_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre></blockquote><pre style="margin: 0em;">


--
Software Architect

Blue Lion mobile GmbH
Tel. +49 (0) 221 788 797 14
Fax. +49 (0) 221 788 797 19
Mob. +49 (0) 176 24 87 30 89

ingo.roc...@bluelionmobile.com
&gt;&gt;&gt; qeep: Hefferwolf

www.bluelionmobile.com
www.qeep.net

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09924.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09925">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09925">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09926.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg09923.html">Strange Exception in java-client</a></span> <span class="sender italic">Ingo Rockel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09924.html">Re: Strange Exception in java-client</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Strange Exception in java-client</span> <span class="sender italic">Ingo Rockel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09926.html">Re: Strange Exception in java-client</a></span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09935.html">Re: Strange Exception in java-client</a></span> <span class="sender italic">Ingo Rockel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09942.html">Re: Strange Exception in java-clien...</a></span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09945.html">Re: Strange Exception in java-c...</a></span> <span class="sender italic">Ingo Rockel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09968.html">Re: Strange Exception in ja...</a></span> <span class="sender italic">Brian Roach</span></li>
<li class="icons-email"><span class="subject"><a href="msg09988.html">Re: Strange Exception in ja...</a></span> <span class="sender italic">Ingo Rockel</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Strange Exception in java-client">
<input type="hidden" name="msgid" value="5109450F.8090605@bluelionmobile.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09925.html">
<input type="submit" value=" Ingo Rockel ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Strange+Exception+in+java%5C-client%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09924.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09926.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">5109450F.8090605@bluelionmobile.com</li>
</ul>
</div>
</body>
</html>
