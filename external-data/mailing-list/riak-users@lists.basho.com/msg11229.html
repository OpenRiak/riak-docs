<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: a new leveldb fork from the folks at hyperdex</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd15.html#11229" id="c">
<link rel="index" href="mail15.html#11229" id="i">
<link rel="prev" href="msg11228.html" id="p">
<link rel="next" href="msg11230.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg11229.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+a+new+leveldb+fork+from+the+folks+at+hyperdex%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: a new leveldb fork from the folks at hyperdex</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Matthew+Von%5C-Maszewski%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Matthew Von-Maszewski</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130606" rel="nofollow">Thu, 06 Jun 2013 14:06:51 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>reposting reply originally at: <a  rel="nofollow" href="https://news.ycombinator.com/item?id=5833414">https://news.ycombinator.com/item?id=5833414</a></pre><pre>

As the person doing the github:basho/leveldb work, I agree with the above (very 
professional reply, not something you expect to see on the Internet, thank 
you). We are optimizing to our individual environments. I do need to review the 
compaction algorithms to see if there is benefit to Basho. However, it will be 
a few weeks before that happens.
The write multi-threading does not help Basho's Riak 1.x series. We parallelize 
by using multiple leveldb database (Riak term vnodes) and do NOT parallelize 
individual database until 2.0. Therefore, unfair to measure that feature agains 
Riak.
Our compaction code is adjusted with an emphasis on running multiple 
compactions of varied priority. Our use of multiple databases got hung up on 
leveldb's single compaction thread. Again, this complete difference of 
environments would be unfair in a Hyperleveldb direct comparison.
And the most difficult issue for dropping hyper into Riak is that our leveldb 
performs the write throttling, hyperleveldb leaves that to HyperDex. This is 
yet again an environment design decision ... but says coding is require to make 
hyperleveldb &quot;just work&quot; with Riak. That will be a while.
I therefore do not claim that Basho's leveldb would be better with HyperDex and 
suspect that today's hyperleveldb would not be better with Basho's Riak. We 
optimized to our different pain points.
Matthew
On Jun 6, 2013, at 3:08 PM, Alexander Sicular &lt;sicul...@gmail.com&gt; wrote:

&gt; If you haven't seen it on HN [0], Hyperdex just dropped a leveldb fork they 
&gt; are calling HyperLevelDB [1]. It seems like they are looking for drop-in 
&gt; replacement compatibility. I'm interested to hear thoughts from the Basho 
&gt; folks (or anyone else) once they've had a chance to look it over. One of 
&gt; their specific goals is maintaining performance during compaction which I 
&gt; know has been an issue for some people using the leveldb backend. 
&gt; 
&gt; If you read their post there seems to be three things they are doing to reach 
&gt; their higher performance:
&gt; 
&gt; 1. multi-threaded synchronized write ordering. 
&gt; &quot;LevelDB uses very coarse-grained synchronization which forces all writes to 
&gt; proceed in an ordered, first-come-first-served fashion, effectively reducing 
&gt; throughput to that of a single thread. HyperLevelDB increases concurrency by 
&gt; allowing multiple threads to agree on the order of their respective writes, 
&gt; and then independently apply the writes in a manner consistent with the 
&gt; agreed-upon order.&quot;
&gt; 
&gt; 2. tuned write delay on compaction.
&gt; &quot;HyperLevelDB removes this artificial delay, allowing the application (in our 
&gt; case, HyperDex) to independently decide to delay writes, using information 
&gt; available outside the scope of LevelDB.&quot;
&gt; 
&gt; 3. tuned intra-level re-writes.
&gt; &quot;LevelDB's compaction algorithm is not efficient, and in the &quot;fillrand&quot; 
&gt; benchmark will, on average, rewrite 3MB of data in the upper level for every 
&gt; 1MB of data in the lower level. HyperLevelDB avoids this waste by selecting 
&gt; the compaction with the smallest overhead.&quot;
&gt; 
&gt; 
&gt; Thanks,
&gt; -Alexander Sicular
&gt; 
&gt; @siculars
&gt; 
&gt; 
&gt; [0] <a  rel="nofollow" href="https://news.ycombinator.com/item?id=5833414">https://news.ycombinator.com/item?id=5833414</a>
&gt; [1] <a  rel="nofollow" href="http://hyperdex.org/performance/leveldb/">http://hyperdex.org/performance/leveldb/</a>.
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg11228.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd15.html#11229">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail15.html#11229">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg11230.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg11228.html">a new leveldb fork from the folks at hyperdex</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: a new leveldb fork from the folks at hyperd...</span> <span class="sender italic">Matthew Von-Maszewski</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: a new leveldb fork from the folks at hyperdex">
<input type="hidden" name="msgid" value="8FF334DA-7D0C-4E6D-98DC-226613E062FA@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg11229.html">
<input type="submit" value=" Matthew Von-Maszewski ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+a+new+leveldb+fork+from+the+folks+at+hyperdex%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg11228.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg11230.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">8FF334DA-7D0C-4E6D-98DC-226613E062FA@basho.com</li>
</ul>
</div>
</body>
</html>
