<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: What is the best way to model relationships in Riak from 1.0	forward?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04908" id="c">
<link rel="index" href="maillist.html#04908" id="i">
<link rel="prev" href="msg04905.html" id="p">
<link rel="next" href="msg04915.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04908.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+What+is+the+best+way+to+model+relationships+in+Riak+from+1.0%09forward%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: What is the best way to model relationships in Riak from 1.0	forward?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeremiah+Peschka%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeremiah Peschka</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110928" rel="nofollow">Wed, 28 Sep 2011 11:39:31 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>If you want to perform some kind of ad hoc querying, your only real option is 
Map Reduce. Fun fact: you can perform Riak Search queries through Map Reduce.</pre><pre>

You can also do this with HTPP requests for Riak Search or indexes (either HTTP 
or Protocol Buffers), but you'll probably end up doing something that looks 
like this:

Query objects from Riak Search
Collect relationship IDs from Riak Search results
Query objects from Riak or Riak Search by ID
Repeat

Depending on your application patterns, it's possible to save the complete 
object graph in Riak. Riak is ill-suited to ad hoc querying patterns like you 
can perform on an RDBMS.

A good pattern for this comes from orders. In an RDBMS you might have tables to 
define OrderHeaders, LineItems, Customers, and Addresses. With riak you could 
easily save this as an object graph that looks like this:

{ order_header: { blah blah blah },
  line_items: [],
  customer: { blah blah blah },
  shipping_address: { blah blah blah },
  billing_address: { blah blah blah }
}

Data modeling in Riak typically requires that you flatten your data model when 
you save it: optimize for reads, not writes. 

If you have a predictable key name format, you can use key filters to perform 
an in-memory query on key names before performing your MR queries on the 
results of the key filter. 

Without knowing more about what you're actually trying to accomplish, it's not 
possible to provide you with an accurate and detailed answer; I can only give 
you generalities and hand waving. It may be that you aren't able to give that 
info out on a mailing list, and I completely understand that.

---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Sep 28, 2011, at 2:29 PM, Harshal Dhir wrote:

&gt; 
&gt; Hi Jeremiah,
&gt; 
&gt; Thanks for your quick response. But, we also want to do a query on the
&gt; bucket, so yes implementing links if you want to pull one object makes
&gt; sense, but if you want to do query. Only way to do this to use MapReduce.
&gt; 
&gt; Please correct me if I am wrong.
&gt; 
&gt; 
&gt; Harshal Dhir | Technical Architect
&gt; 
&gt; solutionset
&gt; 
&gt; P: 510-214-3519  Twitter: @harshaldhir
&gt; 
&gt; 85 Second Street, San Francisco, CA 94105
&gt; 
&gt; Twitter: @harshaldhir MSN: hars...@solutionset.com Jabber:
&gt; harshal.d...@gmail.com
&gt; www.solutionset.com &lt;<a  rel="nofollow" href="http://www.solutionset.com/">http://www.solutionset.com/</a>&gt;
&gt; 
&gt; This message is intended for the addressee(s) only and may contain
&gt; confidential or privileged
&gt; information. Any use of this information by persons other than
&gt; addressee(s) is prohibited. If you
&gt; have received this message in error, please reply to the sender and delete
&gt; or destroy all copies.
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; On 9/28/11 11:17 AM, &quot;Jeremiah Peschka&quot; &lt;jeremiah.pesc...@gmail.com&gt; wrote:
&gt; 
&gt;&gt; You can link walk without MapReduce - the RpbContent object returned by
&gt;&gt; the ProtocolBuffers API should include the immediate level of links.
&gt;&gt; Otherwise, many clients support using HTTP requests to perform link walks
&gt;&gt; of arbitrary depths.
&gt;&gt; 
&gt;&gt; The bigger question is: what are you trying to accomplish?
&gt;&gt; 
&gt;&gt; ---
&gt;&gt; Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
&gt;&gt; Microsoft SQL Server MVP
&gt;&gt; 
&gt;&gt; On Sep 28, 2011, at 2:08 PM, Harshal Dhir wrote:
&gt;&gt; 
&gt;&gt;&gt; Hi folks,
&gt;&gt;&gt; 
&gt;&gt;&gt; We were just wondering what is the best possible way to model 1 Â­ N
&gt;&gt;&gt; relationships in Riak. We know that there are links but the mapreduce is
&gt;&gt;&gt; too slow. So, we moved towards using RiakSearch but it seems that
&gt;&gt;&gt; modeling relationships and having lists in riak search KV object doesn't
&gt;&gt;&gt; quiet do the job.
&gt;&gt;&gt; 
&gt;&gt;&gt; So, we were looking for some guidance on this front.
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks
&gt;&gt;&gt; Harshal
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt; 
&gt; 


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04905.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04908">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04908">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04915.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg04900.html">What is the best way to model relationships in Riak from ...</a></span> <span class="sender italic">Harshal Dhir</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04903.html">Re: What is the best way to model relationships in R...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04905.html">Re: What is the best way to model relationships ...</a></span> <span class="sender italic">Harshal Dhir</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: What is the best way to model relationsh...</span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04915.html">Re: What is the best way to model relati...</a></span> <span class="sender italic">Les Mikesell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04917.html">Re: What is the best way to model r...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: What is the best way to model relationships in Riak from 1.0	forward?">
<input type="hidden" name="msgid" value="F040FE71-9EAE-4DE3-A35A-9C5A5660CA81@gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04908.html">
<input type="submit" value=" Jeremiah Peschka ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+What+is+the+best+way+to+model+relationships+in+Riak+from+1.0%09forward%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04905.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04915.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">F040FE71-9EAE-4DE3-A35A-9C5A5660CA81@gmail.com</li>
</ul>
</div>
</body>
</html>
