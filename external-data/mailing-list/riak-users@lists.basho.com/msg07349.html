<!DOCTYPE html>
<html lang="en">
<head>
<title>newbie data modeling questions</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07349" id="c">
<link rel="index" href="maillist.html#07349" id="i">
<link rel="prev" href="msg07348.html" id="p">
<link rel="next" href="msg07352.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07349.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22newbie+data+modeling+questions%22&amp;o=newest" rel="nofollow"><span itemprop="name">newbie data modeling questions</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Davis+Ford%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Davis Ford</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120430" rel="nofollow">Mon, 30 Apr 2012 13:11:34 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>I've been evaluating Riak for about a week now, just playing around with
it, writing some sample apps, and reading all the docs.  I've also read
Mathias Meyer's excellent  <a  rel="nofollow" href="http://riakhandbook.com/">http://riakhandbook.com/</a> - (highly recommended).
 I've been trying to devour all the information as fast as I can consume
it, but my brain is getting a little older, and sometime I need to read
things more than once :)</pre><pre>

A friend &amp; I manufacture small, low-power networked devices that capture
sensor data and report it to a server via HTTP.  I'm looking at using Riak
to store this data.  The data can grow infinitely, and the number of
devices may grow to become quite large.  Each device posts all of its
sensor readings in one shot periodically on a configurable interval, or
because of an individual sensor interrupt.  It looks a bit like:

{ friendly_name: &quot;Basement Device&quot;,
  mac: &quot;00:11:22:AA:BB:CC&quot;,
  v1: 13523,
  v2: 35235,
  timestamp: 1335816375022
}

where each v[x] represents the value of an individual sensor.  The data
never needs to be modified once written.  I need to query it by timestamp
range and per device (all readings for device id=foo and between timestamp
bar and baz).  I'd also like to support m/r jobs to gather interesting
stats on the sensor data.  Devices are also attached to users in the system
(hence each user will want to view their own device sensor data).

That's sort of how the data looks and how I want to interact with it.  This
is how I was thinking of applying it via Riak:

Leveldb as the storage option b/c it avoids the need to keep all keys in
memory (infinite growth) and supports 2i indexing.

Each device has its own bucket with the bucket name being the mac addr +
some guid (INCR via Redis).  E.g. 001122AABBCC-1 -- this allows
differentiation if a user changes the mac addr, posing a mac addr conflict.


Object keys will just be the timestamp -- avoids any conflict resolution
and provides time series data that is already sorted.

2i indexes on mac and friendly name

User objects also stored in Riak with a link to a list of bucket names
where they claim ownership to the device.

Does this data model seem sane for what I'm trying to do?  Any hesitations,
recommendations..?

Is there a way to cap a bucket to a fixed size - in a LIFO manner, or does
the app have to do that?

Finally, I'm building the application in node.js and I've been playing with
the excellent riak-js client library.  I have some reservations, though.
 The protobuf support is still experimental and I saw frank06 indicate that
he probably won't have time to continue dev. b/c of other commitments.  Is
anyone else using riak-js in production -- anyone on the list thinking of
taking over dev. of a riak js client..or are there any other riak js
clients out there (riak-js was the only one I noticed).

Thanks in advance for any feedback.
Davis
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07348.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07349">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07349">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07352.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">newbie data modeling questions</span> <span class="sender italic">Davis Ford</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07352.html">Re: newbie data modeling questions</a></span> <span class="sender italic">Daniil Churikov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07355.html">Re: newbie data modeling questions</a></span> <span class="sender italic">Davis Ford</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07358.html">Re: newbie data modeling questions</a></span> <span class="sender italic">Daniil Churikov</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="newbie data modeling questions">
<input type="hidden" name="msgid" value="CAHyzJDPdf87rROpBic7nxFQZG1z+R2g-etjai6e9PsRQLK9DtA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07349.html">
<input type="submit" value=" Davis Ford ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22newbie+data+modeling+questions%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07348.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07352.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAHyzJDPdf87rROpBic7nxFQZG1z+R2g-etjai6e9PsRQLK9DtA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
