<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: reversing node removal?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#14092" id="c">
<link rel="index" href="maillist.html#14092" id="i">
<link rel="prev" href="msg14091.html" id="p">
<link rel="next" href="msg14093.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg14092.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+reversing+node+removal%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: reversing node removal?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Allen+Landsidel%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Allen Landsidel</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20140415" rel="nofollow">Tue, 15 Apr 2014 09:46:40 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<tt>I realize I made a mistake, it would just be nice if the UI could warn 
</tt><tt>me that I was about to do so, especially given the consequences.
</tt><pre style="margin: 0em;">

</pre><tt>If it was simply showing me how much space each node was using (forget a 
</tt><tt>percentage or anything) that would've been enough to avert disaster. 
</tt><tt>With four nodes, if they're over 25% capacity (far lower than any 
</tt><tt>sensible warning level in a monitoring system), the cluster leave is 
</tt><tt>going to fail.  The more nodes you add to the system, the lower you'd 
</tt><tt>have to set that warning threshold to alert you that you're in a state 
</tt><tt>where you can't safely retire a node.
</tt><pre style="margin: 0em;"></pre><pre>

On 4/15/2014 12:40, Luke Bakken wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Allen -

Failure / node leave situations should be taken into account during
cluster capacity planning. I've created an issue to more thoroughly
explain this in our documentation:

<a  rel="nofollow" href="https://github.com/basho/basho_docs/issues/1034">https://github.com/basho/basho_docs/issues/1034</a>

--
Luke Bakken
CSE
lbak...@basho.com &lt;<a  rel="nofollow" href="mailto:lbak...@basho.com">mailto:lbak...@basho.com</a>&gt;


On Tue, Apr 15, 2014 at 9:28 AM, Allen Landsidel
&lt;landsidel.al...@gmail.com &lt;<a  rel="nofollow" href="mailto:landsidel.al...@gmail.com">mailto:landsidel.al...@gmail.com</a>&gt;&gt; wrote:

    Luke,

    I already do use nagios for that, but the disk space was fine before
    I told one of the nodes to leave the cluster.  That's my problem --
    there was not enough free space in the cluster for it to move all
    that nodes data.  It accepted the leave and then ran me out of disk
    space on all the other nodes, with no way to abort or recover.

    My only option was to add more space to the other nodes (as you
    said, adding new nodes will not work until the leave is done), which
    is easy enough in a virtualized environment but requires downtime.
      In a bare metal environment, it could be catastrophic to the cluster.


    On 4/15/2014 12:19, Luke Bakken wrote:

        Hi Allen,

        Cluster leave does not check for disk space and in general, Riak
        is not
        aware of how much space it has available to itself (most db systems
        don't monitor disk space I think). I'll send a note to product
        management about this. We recommend using a monitoring solution
        (like
        collectd + graphite) to keep an eye on available disk space.


        --
        Luke Bakken
        CSE
        lbak...@basho.com &lt;<a  rel="nofollow" href="mailto:lbak...@basho.com">mailto:lbak...@basho.com</a>&gt;
        &lt;<a  rel="nofollow" href="mailto:lbak...@basho.com">mailto:lbak...@basho.com</a> &lt;<a  rel="nofollow" href="mailto:lbak...@basho.com">mailto:lbak...@basho.com</a>&gt;&gt;

</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg14091.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#14092">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#14092">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg14093.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg14060.html">reversing node removal?</a></span> <span class="sender italic">Allen Landsidel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14073.html">Re: reversing node removal?</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14074.html">Re: reversing node removal?</a></span> <span class="sender italic">Allen Landsidel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14090.html">Re: reversing node removal?</a></span> <span class="sender italic">Allen Landsidel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14091.html">Re: reversing node removal?</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: reversing node removal?</span> <span class="sender italic">Allen Landsidel</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14093.html">Re: reversing node removal?</a></span> <span class="sender italic">Luke Bakken</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg14094.html">Re: reversing node removal?</a></span> <span class="sender italic">Allen Landsidel</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: reversing node removal?">
<input type="hidden" name="msgid" value="534D61D2.7070306@gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg14092.html">
<input type="submit" value=" Allen Landsidel ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+reversing+node+removal%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg14091.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg14093.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">534D61D2.7070306@gmail.com</li>
</ul>
</div>
</body>
</html>
