<!DOCTYPE html>
<html lang="en">
<head>
<title>riak-admin leave behavior</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07298" id="c">
<link rel="index" href="maillist.html#07298" id="i">
<link rel="prev" href="msg07295.html" id="p">
<link rel="next" href="msg07299.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07298.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22riak%5C-admin+leave+behavior%22&amp;o=newest" rel="nofollow"><span itemprop="name">riak-admin leave behavior</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Michael+Radford%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Michael Radford</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120423" rel="nofollow">Mon, 23 Apr 2012 18:11:39 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>A coworker who's testing various backup and recovery strategies (using
riak 1.1.2) told me that while watching a node running &quot;riak-admin
leave&quot;, he saw the disk usage of the leveldb data directory slowly
shrinking, and when the node had completed leaving, the directory was
the same size as an empty, newly started node's.</pre><pre>

I'm curious why that might be, and why the deletion would be
incremental...he was interpreting it as the actual data being handed
off to the other nodes.

That would be surprising, since we were told in no uncertain terms
that running &quot;riak-admin leave&quot; did not proactively create new
replicas of any objects that the node's vnodes had been responsible
for, but rather, taking a node out of a cluster with n=3 would
temporarily leave some fraction of the objects with only 2 replicas
until their keys had been read, triggering read repair.

So is the deletion from the leaving node just to be polite in case
someone wants to join the node to a different cluster after leaving?
(And maybe it's somewhat incremental just because it's done on a
per-vnode basis?)

Mike

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07295.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07298">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07298">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07299.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">riak-admin leave behavior</span> <span class="sender italic">Michael Radford</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07299.html">Re: riak-admin leave behavior</a></span> <span class="sender italic">Kyle Kingsbury</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07300.html">Re: riak-admin leave behavior</a></span> <span class="sender italic">Michael Radford</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07301.html">Re: riak-admin leave behavior</a></span> <span class="sender italic">Kyle Kingsbury</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07302.html">Re: riak-admin leave behavior</a></span> <span class="sender italic">Joseph Blomstedt</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07303.html">Re: riak-admin leave behavior</a></span> <span class="sender italic">Mark Phillips</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="riak-admin leave behavior">
<input type="hidden" name="msgid" value="CAOUfeeGR=Lp7+pn+j0bePgyybp4XoO3M-HkgwMFG6cM5pnX83g@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07298.html">
<input type="submit" value=" Michael Radford ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22riak%5C-admin+leave+behavior%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07295.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07299.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAOUfeeGR=Lp7+pn+j0bePgyybp4XoO3M-HkgwMFG6cM5pnX83g@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
