<!DOCTYPE html>
<html lang="en">
<head>
<title>Planning JS VM capacity, and how the JS VM count is intended to work	(preflist_exhausted, etc)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07350" id="c">
<link rel="index" href="maillist.html#07350" id="i">
<link rel="prev" href="msg07349.html" id="p">
<link rel="next" href="msg07351.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07350.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Planning+JS+VM+capacity%2C+and+how+the+JS+VM+count+is+intended+to+work%09%5C%28preflist_exhausted%2C+etc%5C%29%22&amp;o=newest" rel="nofollow"><span itemprop="name">Planning JS VM capacity, and how the JS VM count is intended to work	(preflist_exhausted, etc)</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Brian+Conway%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Brian Conway</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120430" rel="nofollow">Mon, 30 Apr 2012 14:25:37 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>There are no shortage of references out there to avoiding a
preflist_exhausted error due to JS VM capacity being too small when
running MapReduce with JavaScript:</pre><pre>

<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2012-March/thread.html#7853">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2012-March/thread.html#7853</a>
<a  rel="nofollow" href="https://github.com/basho/riak_kv/issues/284">https://github.com/basho/riak_kv/issues/284</a>
<a  rel="nofollow" href="http://wiki.basho.com/Configuration-Files.html#app.config">http://wiki.basho.com/Configuration-Files.html#app.config</a>

My question is, are there any good guidelines for planning JS VM
capacity? For example, if you're running a particularly wide MapReduce
with JS and hit the &quot;All VMs are busy&quot; message in your logs, the
prescribed advice is to bump up the JS counts until you no longer hit
it.

But isn't that just going to fail again as soon as you have more than
one M/R running at the same time?

Is it better to blindly increase the count into the thousands and hope
you cover all your bases, or set up a queuing mechanism outside of
Riak to fire off the MapReduce jobs at a rate that makes optimal use
of your hardware and JS VM count?

The MapReduce doc[1] touches briefly on configuration tuning for
JavaScript, but is there an option to have a pool configuration, where
MapReduce phases wait for a free JS VM when all are in use, rather
than erroring out?

I may have a fundamental misunderstanding on how this is supposed to
work, my apologies if so. Thanks in advance.

Brian Conway

[1] <a  rel="nofollow" href="http://wiki.basho.com/MapReduce.html#Configuration-Tuning-for-Javascript">http://wiki.basho.com/MapReduce.html#Configuration-Tuning-for-Javascript</a>

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07349.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07350">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07350">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07351.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">

</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Planning JS VM capacity, and how the JS VM count is intended to work	(preflist_exhausted, etc)">
<input type="hidden" name="msgid" value="CACe8Y3EPrPubaAjWnrrnGohR7YYVJLNDe=+JvUQYSs1BgcMxnQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07350.html">
<input type="submit" value=" Brian Conway ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Planning+JS+VM+capacity%2C+and+how+the+JS+VM+count+is+intended+to+work%09%5C%28preflist_exhausted%2C+etc%5C%29%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07349.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07351.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACe8Y3EPrPubaAjWnrrnGohR7YYVJLNDe=+JvUQYSs1BgcMxnQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
