<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak-cs sync buckets from S3 to Riak-cs</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#16772" id="c">
<link rel="index" href="maillist.html#16772" id="i">
<link rel="prev" href="msg16766.html" id="p">
<link rel="next" href="msg16775.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg16772.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak%5C-cs+sync+buckets+from+S3+to+Riak%5C-cs%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak-cs sync buckets from S3 to Riak-cs</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Alberto+Ayllon%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Alberto Ayllon</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20151116" rel="nofollow">Mon, 16 Nov 2015 04:30:07 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hello.

Thanks for your help Dmitri.</pre><pre>

Perhaps this is not the correct place to ask this, but maybe someone had
have the same problem.

I build a test environment with two nodes of RIAK-CS, not in cluster, and
I'm trying to move objects from one to another, to a bucket with the same
name (testbucket).
I'm using BOTO, and the copy_key method, but it fails, I guess that problem
is in the HEAD call, this call checks if the key exists in the destination
bucket before make the PUT, that copy the key.

Here is the code I'm using.

from boto.s3.key import Key
from boto.s3.connection import S3Connection
from boto.s3.connection import OrdinaryCallingFormat

apikey04='GFR3O0HFPXQ-BWSXEMAG'
secretkey04='eIiigR4Rov2O2kxuSHNW7WPoJE2KmrtMpzzqlg=='

apikey02='J0TT_C9MJPWPGHW-KEWY'
secretkey02='xcLOt3ANqyNJ0kAjP8Mxx68qr7kgyXG3eqJuMA=='
cf=OrdinaryCallingFormat()

conn04=S3Connection(aws_access_key_id=apikey04,aws_secret_access_key=secretkey04,
                      is_secure=False,host='rk04.ejemplo.com
',port=8080,calling_format=cf)

conn02=S3Connection(aws_access_key_id=apikey02,aws_secret_access_key=secretkey02,
                      is_secure=False,host='rk02.ejemplo.com
',port=8080,calling_format=cf)

bucket04=conn04.get_bucket('testbucket')
bucket02=conn02.get_bucket('testbucket')

rs04 = bucket04.list()

for k in rs04:
    print k.name
    bucket02.copy_key(k.key, bucket04, k.key)


When this script is executed it returns:

Traceback (most recent call last):
  File &quot;s3_connect_2.py&quot;, line 38, in &lt;module&gt;
    bucket02.copy_key(k.key, bucket04, k.key)
  File
&quot;/home/alberto/.virtualenvs/boto/local/lib/python2.7/site-packages/boto/s3/bucket.py&quot;,
line 888, in copy_key
    response.reason, body)
boto.exception.S3ResponseError: S3ResponseError: 404 Not Found
&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF-8&quot;?&gt;&lt;Error&gt;&lt;Code&gt;NoSuchKey&lt;/Code&gt;&lt;Message&gt;The specified key
does not exist.&lt;/Message&gt;&lt;Resource&gt;/&amp;lt;Bucket: testbucket&amp;gt;$



The idea is copy all keys in testbucket from rk04.ejemplo.com, to
testbucket in test02.ejemplo.com, maybe someone can help me.


Thanks a lot.


2015-11-13 17:06 GMT+01:00 Dmitri Zagidulin &lt;dzagidu...@basho.com&gt;:

&gt; Hi Alberto,
&gt;
&gt; From what I understand, the state of the art in terms of migration of
&gt; objects from Amazon S3 to Riak CS is -- writing migration scripts.
&gt; Either as shell scripts (using s3cmd), or language-specific libraries like
&gt; boto (or even just the S3 SDKs).
&gt; And the scripts would consist of:
&gt; 1) get a list of the buckets you want to migrate
&gt; 2) List the keys in those buckets
&gt; 3) Migrate each object from AWS to CS.
&gt;
&gt; You're right that mounting buckets as filesystems is a (distant)
&gt; possibility, but we have not seen much successful use of those (though if
&gt; anybody's made that work, let us know).
&gt;
&gt;
&gt;
&gt; On Thu, Nov 12, 2015 at 12:40 PM, Alberto Ayllon &lt;aayl...@qdqmedia.com&gt;
&gt; wrote:
&gt;
&gt;&gt; Hello.
&gt;&gt;
&gt;&gt; I'm new using Riak and Riak-cs, I have installed a Riak-cs cluster with 4
&gt;&gt; nodes and it works fine,
&gt;&gt;
&gt;&gt; Here is my question,  the company where I work has some buckets in Amazon
&gt;&gt; s3, and I would like migrate objects from these buckets to our Riak-cs
&gt;&gt; installation, as far as I know I can do it using S3FUSE or S3BACKER,
&gt;&gt; mounting buckets as a filesystem, but would like avoid mount it as
&gt;&gt; filesystem. I tried it with boto python library, using the copy_key method,
&gt;&gt; but it doesn't work.
&gt;&gt;
&gt;&gt; Has anybody try with success synchronize buckets from AS3 to Riak-CS?
&gt;&gt;
&gt;&gt; Thanks.
&gt;&gt;
&gt;&gt; P:D: Excuse for my English.
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg16766.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#16772">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#16772">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg16775.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg16763.html">riak-cs sync buckets from S3 to Riak-cs</a></span> <span class="sender italic">Alberto Ayllon</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16766.html">Re: riak-cs sync buckets from S3 to Riak-cs</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak-cs sync buckets from S3 to Riak-cs</span> <span class="sender italic">Alberto Ayllon</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16775.html">Re: riak-cs sync buckets from S3 to Riak-c...</a></span> <span class="sender italic">Shunichi Shinohara</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16778.html">Re: riak-cs sync buckets from S3 to Ri...</a></span> <span class="sender italic">Alberto Ayllon</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak-cs sync buckets from S3 to Riak-cs">
<input type="hidden" name="msgid" value="CAP=ZShdCy5QT=aU++AJErZ_YRq9gW6VGP2SMABhjRatm1JUzDw@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg16772.html">
<input type="submit" value=" Alberto Ayllon ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak%5C-cs+sync+buckets+from+S3+to+Riak%5C-cs%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg16766.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg16775.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAP=ZShdCy5QT=aU++AJErZ_YRq9gW6VGP2SMABhjRatm1JUzDw@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
