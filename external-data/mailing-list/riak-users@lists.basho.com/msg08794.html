<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak search and basic write operations</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#08794" id="c">
<link rel="index" href="maillist.html#08794" id="i">
<link rel="prev" href="msg08787.html" id="p">
<link rel="next" href="msg08797.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg08794.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+search+and+basic+write+operations%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak search and basic write operations</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Brian+Roach%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Brian Roach</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121002" rel="nofollow">Tue, 02 Oct 2012 15:24:34 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Greetings!

First and foremost, search and secondary indexes (2i) are not the same thing.</pre><pre>

You need to enable 2i and use the ELevelDB backend as described here:
<a  rel="nofollow" href="http://wiki.basho.com/Secondary-Indexes---Configuration-and-Examples.html">http://wiki.basho.com/Secondary-Indexes---Configuration-and-Examples.html</a>

Secondly, the default Converter (JSONConverter) in the Java client
does support serializing/deserializing of secondary indexes. The page
you link to in the cookbook is demonstrating how to write your own
custom converter (for something other than JSON), and its first
example does not support them.

Enable 2i in Riak, annotate your POJO as you have, and use the default
Converter and you should be fine; nothing else is needed.

On Tue, Oct 2, 2012 at 4:03 PM, kamiseq &lt;kami...@gmail.com&gt; wrote:
&gt; hej I am a bit confused about search functionality and basic
&gt; read/write operations.
&gt;
&gt; Im using recent (1.0.6) java client and pb cluster riak client. just
&gt; for testing Im only using two local machines joined into one cluster.
&gt; storing and reading objects works fine  with key(let say I have users
&gt; bucket and I generate id from timestamp).
&gt;
&gt; but
&gt; 1. I cannot fetch objects using rest client in firefox after I store
&gt; objects using java client (I ll check with curl) but I can query for
&gt; keys in bucket (<a  rel="nofollow" href="http://192.168.0.121:8098/riak/users/?keys=true&amp;props=false">http://192.168.0.121:8098/riak/users/?keys=true&amp;props=false</a>).
&gt; 2. I followed 
&gt; <a  rel="nofollow" href="https://github.com/basho/riak-java-client/wiki/Using-a-custom-Converter">https://github.com/basho/riak-java-client/wiki/Using-a-custom-Converter</a>
&gt; and I annotated one of the field with @RiakIndex(name = &quot;user_email&quot;)
&gt; and now I tried to look-up this object with email but I got
&gt; Caused by: com.basho.riak.client.RiakException: java.io.IOException:
&gt; {&quot;phase&quot;:&quot;index&quot;,&quot;error&quot;:&quot;{indexes_not_supported,riak_kv_bitcask_backend}&quot;,&quot;input&quot;:&quot;{cover,[{1370157784997721485815954530671515330927436759040,[1370157784997721485815954530671515330927436759040]}],{&lt;&lt;\&quot;users\&quot;&gt;&gt;,{eq,&lt;&lt;\&quot;user_email_bin\&quot;&gt;&gt;,&lt;&lt;\&quot;js@gm.com1\&quot;&gt;&gt;}}}&quot;,&quot;type&quot;:&quot;result&quot;,&quot;stack&quot;:&quot;[]&quot;}
&gt;     at com.basho.riak.client.query.MapReduce.execute(MapReduce.java:80)
&gt;     at 
&gt; com.basho.riak.client.raw.pbc.PBClientAdapter.fetchIndex(PBClientAdapter.java:436)
&gt;
&gt; I ve google a bit and all I could find was this
&gt; <a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-September/005749.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-September/005749.html</a>
&gt; post a year old now. which points out that search needs to be enabled
&gt; in app.config file. I changed settings and restarted both machines.
&gt; but I keep getting same exception every time.
&gt; 3. in same 
&gt; <a  rel="nofollow" href="https://github.com/basho/riak-java-client/wiki/Using-a-custom-Converter">https://github.com/basho/riak-java-client/wiki/Using-a-custom-Converter</a>
&gt; tutorial I read that default converter is not marshalling indexes,
&gt; links and metadata and it shows how to get and restore those
&gt; information back but looking into code for default converter
&gt; implementation I could find the same lines of code as in the article
&gt;
&gt; Map&lt;String, String&gt; usermetaData =
&gt; usermetaConverter.getUsermetaData(domainObject);
&gt;         RiakIndexes indexes = riakIndexConverter.getIndexes(domainObject);
&gt;         Collection&lt;RiakLink&gt; links = 
&gt; riakLinksConverter.getLinks(domainObject);
&gt;
&gt;         return RiakObjectBuilder.newBuilder(bucket, key)
&gt;             .withValue(value)
&gt;             .withVClock(vclock)
&gt;             .withUsermeta(usermetaData)
&gt;             .withIndexes(indexes)
&gt;             .withLinks(links)
&gt;             .withContentType(Constants.CTYPE_OCTET_STREAM)
&gt;             .build();
&gt; 4. can I specify data encoding it seems that it is not UTF-8
&gt; 5. I also saw in app.config that vnode_vclocks is set to true, so
&gt; should I still set clientId on riak client?? I read it will be skipped
&gt; anyway now.
&gt;
&gt; thanks for any comments
&gt;
&gt; pozdrawiam
&gt; Paweł Kamiński
&gt;
&gt; kami...@gmail.com
&gt; pkaminski....@gmail.com
&gt; ______________________
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg08787.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#08794">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#08794">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg08797.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Re: riak search and basic write operations</span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08797.html">Re: riak search and basic write operations</a></span> <span class="sender italic">kamiseq</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08804.html">Re: riak search and basic write operations</a></span> <span class="sender italic">kamiseq</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08805.html">Re: riak search and basic write operations</a></span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08806.html">Re: riak search and basic write operations</a></span> <span class="sender italic">kamiseq</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak search and basic write operations">
<input type="hidden" name="msgid" value="CAM+FMBv_HrJ5JTnGMOu5owRRv-z4OyW_KTsux4xR9nvyfEf6+Q@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg08794.html">
<input type="submit" value=" Brian Roach ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+search+and+basic+write+operations%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg08787.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg08797.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAM+FMBv_HrJ5JTnGMOu5owRRv-z4OyW_KTsux4xR9nvyfEf6+Q@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
