<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Question on the symptoms of Ticket 260</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#01280" id="c">
<link rel="index" href="maillist.html#01280" id="i">
<link rel="prev" href="msg01278.html" id="p">
<link rel="next" href="msg01290.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg01280.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Question+on+the+symptoms+of+Ticket+260%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Question on the symptoms of Ticket 260</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Dan+Reverri%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Dan Reverri</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20101013" rel="nofollow">Wed, 13 Oct 2010 18:21:42 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi SC,

If a single client is writing to a single key with read and write quorums
your reads should reflect your writes. Are other clients updating the same
key concurrently? Are you updating the values with the correct vclock? Would
it be possible to provide a minimal test case that reproduces the issue?</pre><pre>

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Wed, Oct 13, 2010 at 5:07 PM, scott clasen &lt;scott.cla...@gmail.com&gt;wrote:

&gt; Hi-
&gt;
&gt;    I am writing a Riak backend for Akka's persistent data structures,
&gt; and am running into what looks like behavior similar to what is
&gt; mentioned in this ticket.
&gt;
&gt; <a  rel="nofollow" href="https://issues.basho.com/show_bug.cgi?id=260">https://issues.basho.com/show_bug.cgi?id=260</a>  which says---&gt;
&gt;
&gt; In cases where objects are rapidly updated and deleted, unpredictable
&gt; behavior
&gt; seems to occur due to race conditions.  Exposing tombstones to the client
&gt; when
&gt; allow_mult is true would allow resolution of the conflict that is normally
&gt; hidden from the user. This will require the client who is interested in
&gt; resolving delete+update conflicts to submit the vclock when performing the
&gt; delete.
&gt;
&gt; This is on a single riak instance 0.13.0, on OS X, installed via 'brew
&gt; install riak', w
&gt;
&gt; The behavior I am seeing is in a single threaded test that rapidly
&gt; inserts, updates and deletes the value for a single key in a single
&gt; bucket.
&gt;
&gt; This is using the protobuf interface, via the riak-java-pb-client.
&gt; All reads use quorum, and all writes use quorum and durableWrite
&gt; quorum as well.
&gt;
&gt; Running the tests outside the debugger cause test failures because the
&gt; reads are not seeing the latest write/delete
&gt;
&gt; When I run the tests in debug mode, with breakpoints set to watch the
&gt; values returned from riak, the tests pass.
&gt;
&gt; This makes me think there is some race condition like the one
&gt; mentioned in ticket 260 occurring. Although it could certainly be user
&gt; error  ;).
&gt;
&gt; Other than the default config, I have tried fiddling with
&gt; last_write_wins and allow_multi but no combination of those seem to
&gt; help.
&gt;
&gt; Is there anything I am missing, or any configuration or code that can
&gt; give me a consistent view?
&gt;
&gt; Thanks
&gt; SC
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg01278.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#01280">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#01280">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg01290.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg01278.html">Question on the symptoms of Ticket 260</a></span> <span class="sender italic">scott clasen</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Question on the symptoms of Ticket 260</span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01290.html">Re: Question on the symptoms of Ticket 260</a></span> <span class="sender italic">Scott Clasen</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01295.html">Re: Question on the symptoms of Ticket 260</a></span> <span class="sender italic">scott clasen</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg01296.html">Re: Question on the symptoms of Ticket 260</a></span> <span class="sender italic">scott clasen</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Question on the symptoms of Ticket 260">
<input type="hidden" name="msgid" value="AANLkTin6kp9RfN5VnsYjripR20o39H8oPZP+o8XXVbyw@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg01280.html">
<input type="submit" value=" Dan Reverri ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Question+on+the+symptoms+of+Ticket+260%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg01278.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg01290.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">AANLkTin6kp9RfN5VnsYjripR20o39H8oPZP+o8XXVbyw@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
