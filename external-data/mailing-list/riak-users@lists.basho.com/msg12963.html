<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Forcing Siblings to Occur</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd7.html#12963" id="c">
<link rel="index" href="mail7.html#12963" id="i">
<link rel="prev" href="msg12952.html" id="p">
<link rel="next" href="msg12964.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12963.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Forcing+Siblings+to+Occur%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Forcing Siblings to Occur</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jason+Campbell%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jason Campbell</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131112" rel="nofollow">Tue, 12 Nov 2013 14:43:32 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<table width="100%"><tr><td style=""><div id="BB10_response_div" style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);">I am currently forcing siblings for time series data. The maximum bucket sizes are very predictable due to the nature of the data. I originally used the get/update/set cycle, but as I approach the end of the interval, reading and writing 1MB+ objects at a high frequency kills network bandwidth. So now, I append siblings, and I have a cron that merges the previous siblings (a simple set union works for me, only entire objects are ever deleted).</div><div style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);"><br></div><div style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);">I can see how it can be dangerous to insert siblings, bit if you have some other method of knowing how much data is in one, I don't see size being an issue. I have also considered using a counter to know how large an object is without fetching it, which shouldn't be off by more than a few siblings unless there is a network partition.</div><div style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);"><br></div><div style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);">So aside from size issues, which can be roughly predicted or worked around, is there any reason to not create hundreds or thousands of siblings and resolve them later? I realise sets could work well for my use case, but they seem overkill for simple append operations when I don't need delete functionality. Creating your own CRDTs are trivial if you never need to delete.</div><div style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);"><br></div><div style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);">Thoughts are welcome,</div><div style="width: 100%; font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);">Jason</div>                                                                                                                                     <div id="_signaturePlaceholder" style="font-size: initial; font-family: Calibri, 'Slate Pro', sans-serif; color: rgb(31, 73, 125); text-align: initial; background-color: rgb(255, 255, 255);"></div>                                                                                                                                                                                        <table width="100%" style="background-color:white;border-spacing:0px;"> <tbody><tr><td id="_persistentHeaderContainer" colspan="2" style="font-size: initial; text-align: initial; background-color: rgb(255, 255, 255);">                                              <div id="_persistentHeader" style="border-style: solid none none; border-top-color: rgb(181, 196, 223); border-top-width: 1pt; padding: 3pt 0in 0in; font-family: Tahoma, 'BB Alpha Sans', 'Slate Pro'; font-size: 10pt;">  <div><b>From: </b>John Daily</div><div><b>Sent: </b>Wednesday, 13 November 2013 3:10 AM</div><div><b>To: </b>Olav Frengstad</div><div><b>Cc: </b>riak-users</div><div><b>Subject: </b>Re: Forcing Siblings to Occur</div></div></td></tr></tbody></table><div id="_persistentHeaderEnd" style="border-style: solid none none; border-top-color: rgb(186, 188, 209); border-top-width: 1pt; font-size: initial; text-align: initial; background-color: rgb(255, 255, 255);"></div><br><div id="_originalContent" style=""><div>Forcing siblings other than for testing purposes is not typically a good idea; as you indicate, the object size can easily become a problem as all siblings will live inside the same Riak value.</div><div><br></div><div>Your counter-example sounds a lot like a use case for server-side CRDTs; data structures that allow the application to add values without retrieving the server-side content first, and siblings are resolved by Riak.</div><div><br></div><div>These will arrive with Riak 2.0; see&nbsp;<a rel="nofollow" href="https://gist.github.com/russelldb/f92f44bdfb619e089a4d">https://gist.github.com/russelldb/f92f44bdfb619e089a4d</a> for an overview.</div><div><br></div><div>-John</div><br><div><div>On Nov 12, 2013, at 7:13 AM, Olav Frengstad &lt;<a rel="nofollow" href="mailto:o...@fwt.no">o...@fwt.no</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr">Do you consider forcing siblings a good idea? I would like to get some input on possible use cases and pitfalls.<div>For instance i have considered to force siblings and then merge them on read instead of fetching an object every time i want to update it (especially with larger objects).</div>
<div><br>It's not clear from the docs if there are any limitations, will the maximum object size be the limitation:?<br><div><br></div><div>A section of the docs[1] comees comes to mind:<br><div><br></div><div>"Having an enormous object in your node can cause reads of that object to crash the entire node. Other issues are increased cluster latency as the object is replicated and out of memory errors."<div class="gmail_extra">
<br></div><div class="gmail_extra">[1]&nbsp;<a rel="nofollow" href="http://docs.basho.com/riak/latest/theory/concepts/Vector-Clocks/#Siblings">http://docs.basho.com/riak/latest/theory/concepts/Vector-Clocks/#Siblings</a></div><div class="gmail_extra">
<br><div class="gmail_quote">2013/11/9 Brian Roach <span dir="ltr">&lt;<a rel="nofollow" href="mailto:ro...@basho.com" target="_blank">ro...@basho.com</a>&gt;</span><br><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
<div class="im">On Fri, Nov 8, 2013 at 11:38 AM, Russell Brown &lt;<a rel="nofollow" href="mailto:russell.br...@me.com">russell.br...@me.com</a>&gt; wrote:<br>
<br>
&gt; If youâ€™re using a well behaved client like the Riak-Java-Client, or any other that gets a vclock before doing a put, use whatever option stops that.<br>
<br>
</div>for (int i = 0; i &lt; numReplicasWanted; i++) {<br>
&nbsp; &nbsp; bucket.store("key", "value").withoutFetch().execute();<br>
}<br>
<br>
:)<br>
<span class=""><font color="#888888"><br>
- Roach<br>
</font></span><div class=""><div class="h5"><br>
_______________________________________________<br>
riak-users mailing list<br>
<a rel="nofollow" href="mailto:riak-users@lists.basho.com">riak-users@lists.basho.com</a><br>
<a rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com" target="_blank">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a></div></div></blockquote></div>
</div></div></div></div></div>
_______________________________________________<br>riak-users mailing list<br><a rel="nofollow" href="mailto:riak-users@lists.basho.com">riak-users@lists.basho.com</a><br>http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com<br></blockquote></div><br><br></div></td></tr></table><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12952.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd7.html#12963">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail7.html#12963">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12964.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12895.html">Forcing Siblings to Occur</a></span> <span class="sender italic">Mark A. Basil, Jr.</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12896.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">John Daily</span></li>
<li class="icons-email"><span class="subject"><a href="msg12897.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12899.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12951.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12952.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Forcing Siblings to Occur</span> <span class="sender italic">Jason Campbell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12964.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12965.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li class="icons-email"><span class="subject"><a href="msg12966.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li class="icons-email"><span class="subject"><a href="msg12968.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Sam Elliott</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg12969.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Carlos Baquero</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12970.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Russell Brown</span></li>
<li class="icons-email"><span class="subject"><a href="msg12971.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Hector Castro</span></li>
<li class="icons-email"><span class="subject"><a href="msg12973.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li class="icons-email"><span class="subject"><a href="msg12975.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Forcing Siblings to Occur">
<input type="hidden" name="msgid" value="20131112221003.5632144.74867.1652@xiaclo.net">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12963.html">
<input type="submit" value=" Jason Campbell ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Forcing+Siblings+to+Occur%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12952.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12964.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">20131112221003.5632144.74867.1652@xiaclo.net</li>
</ul>
</div>
</body>
</html>
