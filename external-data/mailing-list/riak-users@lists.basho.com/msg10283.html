<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: MapReduce scalability</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#10283" id="c">
<link rel="index" href="maillist.html#10283" id="i">
<link rel="prev" href="msg10266.html" id="p">
<link rel="next" href="msg10284.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg10283.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+MapReduce+scalability%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: MapReduce scalability</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Christian+Dahlqvist%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Christian Dahlqvist</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130228" rel="nofollow">Thu, 28 Feb 2013 01:33:36 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Boris,

Apart from not scaling quite as well as straight K/V access, emulating multiGET 
through MapReduce also has another significant drawback. MapReduce has no 
concept of quorum reads, and only work on a single copy of the data, which can 
be thought of basically as a read with R=1 that does not trigger read-repair. 
It is therefore possible that it can give inconsistent or incorrect results if 
all replicas do not have the same data. It is worth noting that MapReduce was 
designed as a way to efficiently spread compute work across the cluster, and 
re-appropriating it for use with data collection is not its designed purpose.</pre><pre>

The recommended way to implement efficient multiget is to perform normal GET 
operations in parallel. If you are retrieving 20 objects, you don't necessarily 
need to do all 20 GETs in parallel, but could set it up to use perhaps 3 or 4 
connections. If you then pair this with a connection pool that can grow and 
shrink in size (perhaps between a minimum and a maximum value) as load 
requires, you should be able to retrieve the objects in a reasonable time 
without overloading the cluster.

Best regards,

Christian


On 27 Feb 2013, at 02:18, Boris Okner &lt;boris.ok...@gmail.com&gt; wrote:

&gt; Thanks Christian,
&gt; 
&gt; The problem I'm trying to solve is to find the way to retrieve values for 
&gt; limited number of keys with the best possible latency (or maybe with decent 
&gt; latency which is balanced with decent throughput). Let's say we have keys 
&gt; stored in some cache 
&gt; on top of Riak, and want to retrieve values, 20 at the time, to be able to 
&gt; implement pagination. Another alternative to mapreduce would to send multiple 
&gt; asynchronous gets, but then we'd have to worry about connection pool being 
&gt; exhausted if there's too many such &quot;page&quot; requests. So what would be the 
&gt; proper way to deal with the situation when we need to emulate multiple key 
&gt; retrieval?
&gt; 
&gt; On Tue, Feb 26, 2013 at 1:57 AM, Christian Dahlqvist &lt;christ...@basho.com&gt; 
&gt; wrote:
&gt; Hi Boris,
&gt; 
&gt; MapReduce is a very flexible and powerful way of querying Riak and allows 
&gt; processing to be performed locally where the data resides, which allows for 
&gt; efficient processing of larger data sets. A result of this is that every 
&gt; mapreduce job requires a covering set of vnodes (all vnodes that hold the 
&gt; data required for processing) to participate, meaning that it puts 
&gt; considerable more load on the system compared to straight K/V access and 
&gt; therefore does not scale quite as well. It is primarily designed for batch 
&gt; type processing over reasonably large amounts of data and scales well with 
&gt; increased data volumes as new nodes are added. We do however usually not 
&gt; recommended using it as an interface for realtime queries where low and 
&gt; predictable latencies are required and the concurrency level, and therefore 
&gt; load level on the cluster, can not be controlled.
&gt; 
&gt; I am not sure I understand what you mean by the performance degrading with 
&gt; the number of nodes, unless you are strictly measuring latency rather than 
&gt; throughput. As the number of nodes increase, it gets more and more likely 
&gt; that multiple physical nodes will be involved in the job, which will add to 
&gt; the amount of communication and coordination required between the nodes, 
&gt; thereby increasing latency. Could you please explain in more detail what you 
&gt; are trying to achieve?
&gt; 
&gt; Best regards,
&gt; 
&gt; Christian 
&gt; 
&gt; 
&gt; On 25 Feb 2013, at 16:41, Boris Okner &lt;boris.ok...@gmail.com&gt; wrote:
&gt; 
&gt;&gt; Hello,
&gt;&gt; 
&gt;&gt; I'm experimenting with 2 Riak 1.3.0 nodes (both are &quot;bare metal&quot;), and it 
&gt;&gt; looks like mapreduce performs better when one of the nodes is down. The 
&gt;&gt; mapreduce requests are running on 20-key blocks. So am I doing something 
&gt;&gt; wrong, or is it an expected behaviour, i.e. mapreduce degrades with the the 
&gt;&gt; number of nodes increased? If the former, could 
&gt;&gt; you give me some pointers on how to set up it to get advantage of multiple 
&gt;&gt; nodes?
&gt;&gt; 
&gt;&gt; Thanks in advance for your help,
&gt;&gt; Boris
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg10266.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#10283">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#10283">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg10284.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg10237.html">MapReduce scalability</a></span> <span class="sender italic">Boris Okner</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10241.html">Re: MapReduce scalability</a></span> <span class="sender italic">Christian Dahlqvist</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10266.html">Re: MapReduce scalability</a></span> <span class="sender italic">Boris Okner</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: MapReduce scalability</span> <span class="sender italic">Christian Dahlqvist</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10284.html">Re: MapReduce scalability</a></span> <span class="sender italic">Bernard Fouché</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10285.html">Re: MapReduce scalability</a></span> <span class="sender italic">Christian Dahlqvist</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10289.html">Re: MapReduce scalability</a></span> <span class="sender italic">Rune Skou Larsen</span></li>
<li class="icons-email"><span class="subject"><a href="msg10292.html">Re: MapReduce scalability</a></span> <span class="sender italic">Bernard Fouché</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg10290.html">Re: MapReduce scalability</a></span> <span class="sender italic">Elias Levy</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: MapReduce scalability">
<input type="hidden" name="msgid" value="A3640FB9-9FDD-4DBB-AE6A-CBFB2FAE1383@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg10283.html">
<input type="submit" value=" Christian Dahlqvist ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+MapReduce+scalability%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg10266.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg10284.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">A3640FB9-9FDD-4DBB-AE6A-CBFB2FAE1383@basho.com</li>
</ul>
</div>
</body>
</html>
