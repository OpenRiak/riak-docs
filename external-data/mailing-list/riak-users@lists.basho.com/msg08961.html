<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Is Riak suitable for s small-record write-intensive	billion-records application?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#08961" id="c">
<link rel="index" href="maillist.html#08961" id="i">
<link rel="prev" href="msg08960.html" id="p">
<link rel="next" href="msg08962.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg08961.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Is+Riak+suitable+for+s+small%5C-record+write%5C-intensive%09billion%5C-records+application%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Is Riak suitable for s small-record write-intensive	billion-records application?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeremiah+Peschka%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeremiah Peschka</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121018" rel="nofollow">Thu, 18 Oct 2012 07:17:41 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>TL;DR version: Riak works, storage overhead will be more than you think.

Good point, Alex, it was easy to forget about overhead.</pre><pre>

I did some quick digging and the best info I can find is a delightful
exchange between Alex and I around April of last year [1] and this awesome
email from Nico Meyer back in May of 2011[2]. Another option is to use the
magical Bitcask capacity sizing page in the documentation[3]. Yes, it's for
Bitcask. No, I couldn't find something for LevelDB.

Based on Alex's recollection and Nico's math, you can expect between ~120
and ~380 bytes of overhead per object when you're using bitcask. LevelDB
should be similar, but compression may help out here if you're storing
repetitive values or if integer compression kicks in.

However, if you have any likelihood of updates in your application, you can
see additional growth in the object headers - vector clocks may grow and
there's always a possibility of siblings if writes come in fast (object
overhead goes up again with siblings being stored alongside the object).

[1]:
<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-August/005178.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-August/005178.html</a>
[2]:
<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-May/004292.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-May/004292.html</a>
[3]:
<a  rel="nofollow" href="http://docs.basho.com/riak/latest/references/appendices/Bitcask-Capacity-Planning/">http://docs.basho.com/riak/latest/references/appendices/Bitcask-Capacity-Planning/</a>

---
Jeremiah Peschka
Managing Director, Brent Ozar PLF, LLC


On Thu, Oct 18, 2012 at 6:53 AM, Alexander Sicular &lt;sicul...@gmail.com&gt;wrote:

&gt; I've read the other replies and I'm gonna be the downer at this party.
&gt; Imho, Riak is not well suited to small value applications due to on disk
&gt; overhead. Last time this came up on the list, I recall there being a ~450
&gt; byte overhead per key. If that still holds, and I believe it does, you need
&gt; to factor it into your disk space calculations.
&gt;
&gt; Otherwise, your criteria are well within the capabilities of Riak. Use the
&gt; leveldb backend and in your client code run a get before a put and you'll
&gt; be fine. Of course, if you're writing a single key in rapid succession you
&gt; need to consider the eventual consistency nature of Riak and factor that
&gt; into your design.
&gt;
&gt; Keep us posted,
&gt; Alexander
&gt;
&gt;
&gt; @siculars
&gt; <a  rel="nofollow" href="http://siculars.posterous.com">http://siculars.posterous.com</a>
&gt;
&gt; Sent from my iRotaryPhone
&gt;
&gt; On Oct 18, 2012, at 7:42, Yassen Damyanov &lt;yassen....@gmail.com&gt; wrote:
&gt;
&gt; &gt; Hi everyone,
&gt; &gt;
&gt; &gt; Absolutely new (and ignorant) to NoSQL solutions and to Riak (my
&gt; &gt; apologies; but extensive experience with SQL RDBMS).
&gt; &gt;
&gt; &gt; We consider a NoSQL DB deployment for a mission-critical application
&gt; &gt; where we need to store several hundreds of MILLIONS of data records,
&gt; &gt; each record consisting of about 6 string fields, record total length
&gt; &gt; is 160 bytes. There is a unique key in each record that seems suitable
&gt; &gt; for hashing (20+ bytes string, e.g. &quot;cle01_tpls01_2105328884&quot;).
&gt; &gt;
&gt; &gt; The application should be able to write several hundreds of new
&gt; &gt; records per second, but first check if the unique key already exists.
&gt; &gt; Writing is to be done only if it is not there. If it is, the app needs
&gt; &gt; to retrieve the whole record and return it to the client and no
&gt; &gt; writing is done in this case.
&gt; &gt;
&gt; &gt; I need to know if Riak would be suitable for such application. Please,
&gt; &gt; advice, thanks!
&gt; &gt;
&gt; &gt; (Again, apologies for my ignorance. If we choose Riak, I promise to
&gt; &gt; get educated ;)
&gt; &gt;
&gt; &gt; Yassen
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg08960.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#08961">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#08961">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg08962.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg08956.html">Is Riak suitable for s small-record write-intensive bill...</a></span> <span class="sender italic">Yassen Damyanov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08957.html">Re: Is Riak suitable for s small-record write-inten...</a></span> <span class="sender italic">Dmitry Demeshchuk</span></li>
<li class="icons-email"><span class="subject"><a href="msg08958.html">Re: Is Riak suitable for s small-record write-inten...</a></span> <span class="sender italic">Guido Medina</span></li>
<li class="icons-email"><span class="subject"><a href="msg08960.html">Re: Is Riak suitable for s small-record write-inten...</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Is Riak suitable for s small-record write-i...</span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg08962.html">Re: Is Riak suitable for s small-record write-inten...</a></span> <span class="sender italic">Reid Draper</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08963.html">Re: Is Riak suitable for s small-record write-i...</a></span> <span class="sender italic">Pavel Kogan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08964.html">Re: Is Riak suitable for s small-record wri...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08965.html">Re: Is Riak suitable for s small-record...</a></span> <span class="sender italic">Les Mikesell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08971.html">Re: Is Riak suitable for s small-r...</a></span> <span class="sender italic">Daniil Churikov</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg08972.html">Re: Is Riak suitable for s small-record write-inten...</a></span> <span class="sender italic">Yassen Damyanov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08973.html">Re: Is Riak suitable for s small-record write-i...</a></span> <span class="sender italic">Yassen Damyanov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08974.html">Re: Is Riak suitable for s small-record wri...</a></span> <span class="sender italic">Yassen Damyanov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08977.html">Re: Is Riak suitable for s small-record...</a></span> <span class="sender italic">Guido Medina</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08978.html">Re: Is Riak suitable for s small-r...</a></span> <span class="sender italic">Les Mikesell</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Is Riak suitable for s small-record write-intensive	billion-records application?">
<input type="hidden" name="msgid" value="CACJEN2phZhNPUQUegmFnyQ8AvUO4j6TjAeOa5L0S5sTOxv1K6Q@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg08961.html">
<input type="submit" value=" Jeremiah Peschka ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Is+Riak+suitable+for+s+small%5C-record+write%5C-intensive%09billion%5C-records+application%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg08960.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg08962.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACJEN2phZhNPUQUegmFnyQ8AvUO4j6TjAeOa5L0S5sTOxv1K6Q@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
