<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: 2i with the riakc client</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#08037" id="c">
<link rel="index" href="maillist.html#08037" id="i">
<link rel="prev" href="msg08025.html" id="p">
<link rel="next" href="msg08026.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg08037.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+2i+with+the+riakc+client%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: 2i with the riakc client</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Jeremy+Ong%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Jeremy Ong</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120723" rel="nofollow">Mon, 23 Jul 2012 23:27:06 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi, to close this thread, I wrote a very brief blog post documenting basic
usage of secondary indices and get_index using riakc at
<a  rel="nofollow" href="http://www.jeremyong.com/blog/2012/07/23/secondary-indices-in-riak-with-erlang/">http://www.jeremyong.com/blog/2012/07/23/secondary-indices-in-riak-with-erlang/</a></pre><pre>

It's obviously not geared toward expert users (I for one, am not an expert
user) but I'm throwing it out there in case somebody else struggles with
the same issues.

Cheers,
Jeremy

On Sun, Jul 22, 2012 at 2:05 PM, Jeremy Ong &lt;jer...@playmesh.com&gt; wrote:

&gt; Ah perfect that works thanks.
&gt;
&gt; I saw the github issue asking for documentation on this. I feel woefully
&gt; unqualified to write this up, but would be happy to for the benefit of
&gt; other users running into similar issues as I.
&gt;
&gt; Thanks,
&gt; Jeremy
&gt;
&gt;
&gt; On Sun, Jul 22, 2012 at 2:02 PM, Sean Cribbs &lt;s...@basho.com&gt; wrote:
&gt;
&gt;&gt; Jeremy,
&gt;&gt;
&gt;&gt; Your index field must have a &quot;_bin&quot; or &quot;_int&quot; suffix on it to signify
&gt;&gt; whether it is a binary or an integer. Add &quot;_bin&quot; to the field name you have
&gt;&gt; in your example, e.g.
&gt;&gt;
&gt;&gt; MetaData = dict:store(&lt;&lt;&quot;index&quot;&gt;&gt;, [{&lt;&lt;&quot;afield_bin&quot;&gt;&gt;, &lt;&lt;&quot;avalue&quot;&gt;&gt;}],
&gt;&gt; dict:new())
&gt;&gt;
&gt;&gt; On Sun, Jul 22, 2012 at 4:49 PM, Jeremy Ong &lt;jer...@playmesh.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; I am trying to store objects with indexed metadata but am running into
&gt;&gt;&gt; various difficulties (commands in bold).
&gt;&gt;&gt;
&gt;&gt;&gt; *Obj = riakc_obj:new(&lt;&lt;&quot;foo&quot;&gt;&gt;, &lt;&lt;&quot;bar&quot;&gt;&gt;, &lt;&lt;&quot;zing&quot;&gt;&gt;).*
&gt;&gt;&gt; {riakc_obj,&lt;&lt;&quot;foo&quot;&gt;&gt;,&lt;&lt;&quot;bar&quot;&gt;&gt;,undefined,[],undefined,
&gt;&gt;&gt;            &lt;&lt;&quot;zing&quot;&gt;&gt;}
&gt;&gt;&gt; *
&gt;&gt;&gt; *
&gt;&gt;&gt; *MetaData = dict:store(&lt;&lt;&quot;index&quot;&gt;&gt;, [{&quot;afield&quot;, &quot;avalue&quot;}], dict:new()).
&gt;&gt;&gt; *
&gt;&gt;&gt; {dict,1,16,16,8,80,48,
&gt;&gt;&gt;       {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
&gt;&gt;&gt;       {{[],[],[],[],[],[],[],[],[],[],[],
&gt;&gt;&gt;         [[&lt;&lt;&quot;index&quot;&gt;&gt;,{&quot;afield&quot;,&quot;avalue&quot;}]],
&gt;&gt;&gt;         [],[],[],[]}}}
&gt;&gt;&gt;
&gt;&gt;&gt; *Obj1 = riakc_obj:update_metadata(Obj, MetaData).*
&gt;&gt;&gt; {riakc_obj,&lt;&lt;&quot;foo&quot;&gt;&gt;,&lt;&lt;&quot;bar&quot;&gt;&gt;,undefined,[],
&gt;&gt;&gt;            {dict,1,16,16,8,80,48,
&gt;&gt;&gt;                  {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],...},
&gt;&gt;&gt;                  {{[],[],[],[],[],[],[],[],[],[],[],[[...]],[],...}}},
&gt;&gt;&gt;            &lt;&lt;&quot;zing&quot;&gt;&gt;}
&gt;&gt;&gt;
&gt;&gt;&gt; *{ok, Pid} = riakc_pb_socket:start_link(&quot;127.0.0.1&quot;, 8087).*
&gt;&gt;&gt; {ok,&lt;0.103.0&gt;}
&gt;&gt;&gt;
&gt;&gt;&gt; *riakc_pb_socket:put(Pid, Obj1).*
&gt;&gt;&gt; *
&gt;&gt;&gt; *
&gt;&gt;&gt; {error,{0,
&gt;&gt;&gt;         &lt;&lt;&quot;{precommit_fail,[{unknown_field_type,&lt;&lt;\&quot;afield\&quot;&gt;&gt;}]}&quot;&gt;&gt;}}
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; I get this error when I try other things for the field name too. Any
&gt;&gt;&gt; ideas? I tried to look for documentation but nothing seems to be coming up.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Jeremy
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt;&gt; Software Engineer
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; <a  rel="nofollow" href="http://basho.com/">http://basho.com/</a>
&gt;&gt;
&gt;&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg08025.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#08037">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#08037">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg08026.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg08023.html">2i with the riakc client</a></span> <span class="sender italic">Jeremy Ong</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08024.html">Re: 2i with the riakc client</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08025.html">Re: 2i with the riakc client</a></span> <span class="sender italic">Jeremy Ong</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: 2i with the riakc client</span> <span class="sender italic">Jeremy Ong</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: 2i with the riakc client">
<input type="hidden" name="msgid" value="CA+Jb5n4Bg3Okc2er05YLj0Z84uqgLBpgxH_dYjZEsiM64MxmAQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg08037.html">
<input type="submit" value=" Jeremy Ong ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+2i+with+the+riakc+client%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg08025.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg08026.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CA+Jb5n4Bg3Okc2er05YLj0Z84uqgLBpgxH_dYjZEsiM64MxmAQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
