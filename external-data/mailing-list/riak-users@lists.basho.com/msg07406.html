<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Questions about Riak Enterprise</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07406" id="c">
<link rel="index" href="maillist.html#07406" id="i">
<link rel="prev" href="msg07405.html" id="p">
<link rel="next" href="msg07421.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07406.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Questions+about+Riak+Enterprise%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Questions about Riak Enterprise</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Mark+Rose%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Mark Rose</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120509" rel="nofollow">Wed, 09 May 2012 09:11:45 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>On Wed, May 9, 2012 at 12:38 AM, Andrew Thompson &lt;and...@hijacked.us&gt; wrote:
&gt;
&gt; &gt; Does the approximately 1 ms of latency between av zones affect Riak's
&gt; &gt; performance that much?
&gt;
&gt; If the latency is *guranteed* to be that low, then you should be ok,
&gt; although I'm not sure how the networking works across zones. If the
&gt; latency can do crazy things in outage conditions, you'll stand a decent
&gt; chance of screwing the cluster. A downed node is better than a really,
&gt; really slow one.
&gt;</pre><pre>

Well, one thing about AWS is that nothing is guaranteed. I have seen
latency spike up to 10 ms between zones, but it's brief. The zones may or
may not be in the same building, but they are close together and share the
same 10.x.x.x space. Amazon currently charges 1Â¢/GB for transfer between
zones, so there's obviously some network constraints between them compared
to machines inside a zone.


&gt; &gt; We were planning to run across av zones for fault tolerance, just beefing
&gt; &gt; up single nodes for the moment until rack awareness is available. So the
&gt; &gt; recommended solution is to use EDS to accomplish this?
&gt;
&gt; I'm not sure what you're describing here.
&gt;

Basically, we were are planning to run a single 3 node cluster, with 1 node
in each av zone. We use this technique with a 3 node Galera cluster
(synchronous MySQL replication). Galera handles a disappearing node very
well, so if an av zone starts acting up the remaining machines continue
working. We run all our instance types in multiple zones so we can handle
an av zone going down.

&gt;From what you're describing, Riak/Erlang doesn't handle a flaky
node/network well, so some manual intervention would be needed in the case
a node/network starts acting funny.

Because Riak doesn't offer rack awareness (we could treat each av zone as a
rack), and we still want copies of our data in multiple zones, our only
option to ensure live data is replicated in all the zones (for high
availability) is to set the number of replicas equal to the number of
nodes. We'll be fine until we outgrow the largest EC2 instance type.

Is rack awareness a planned feature? If so, when (ballpark) is it planned
for?

Actually, its worse than that because of some legacy behaviour. EDS
&gt; wants to know the bind IP, not a hostname, and it will exchange node IPs
&gt; with the other side of the connection, so internal IPs can 'leak' to the
&gt; other cluster and cause connection problems. There is a workaround for
&gt; this, and I do plan to address it.
&gt;

I suppose the interim solution for EDS across EC2 regions is to use a VPC
in each region and use unique 10.x.x.x subnets in each and VPN between
them. But for us, we're not at the point of deploying to multiple regions
yet, so no need to dig more into this at the moment.

Thank you for answering my questions. This really helps!

-Mark
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07405.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07406">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07406">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07421.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg07366.html">Questions about Riak Enterprise</a></span> <span class="sender italic">Mark Rose</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07395.html">Re: Questions about Riak Enterprise</a></span> <span class="sender italic">Andrew Thompson</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07397.html">Re: Questions about Riak Enterprise</a></span> <span class="sender italic">Mark Rose</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07405.html">Re: Questions about Riak Enterprise</a></span> <span class="sender italic">Andrew Thompson</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Questions about Riak Enterprise</span> <span class="sender italic">Mark Rose</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg07421.html">Re: Questions about Riak Enterprise</a></span> <span class="sender italic">Ahmed Bashir</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07442.html">Re: Questions about Riak Enterprise</a></span> <span class="sender italic">Andrew Thompson</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg07407.html">Re: Questions about Riak Enterprise</a></span> <span class="sender italic">Elias Levy</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07443.html">Re: Questions about Riak Enterprise</a></span> <span class="sender italic">Andrew Thompson</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Questions about Riak Enterprise">
<input type="hidden" name="msgid" value="CACiSN6Wvd_A-83Z4YvdsVwHBbSZhhy_NMaSUJbh4796+_oaHcw@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07406.html">
<input type="submit" value=" Mark Rose ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Questions+about+Riak+Enterprise%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07405.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07421.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACiSN6Wvd_A-83Z4YvdsVwHBbSZhhy_NMaSUJbh4796+_oaHcw@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
