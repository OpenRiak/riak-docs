<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak replication and quorum</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#03414" id="c">
<link rel="index" href="maillist.html#03414" id="i">
<link rel="prev" href="msg03330.html" id="p">
<link rel="next" href="msg03329.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03414.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+replication+and+quorum%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak replication and quorum</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Mathias+Meyer%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Mathias Meyer</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110526" rel="nofollow">Thu, 26 May 2011 02:16:07 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Peter,

wrote my replies inline.</pre><pre>

Mathias Meyer
Developer Advocate, Basho Technologies


On Freitag, 13. Mai 2011 at 20:05, Peter Fales wrote:

&gt; Sean,
&gt; 
&gt; Thanks to you and Ben for clarifying how that works. Since that was 
&gt; so helpful, I'll ask a followup question, and also a question on 
&gt; a mostly un-related topic...
&gt; 
&gt; 1) When I've removed a couple of nodes and the remaining nodes pick up 
&gt; the slack, is there any way for me to look under the hood and see that?
&gt; I'm using wget to fetch the '.../stats' URL from one of the remaing 
&gt; live nodes, and under ring_ownership it still lists the original 4
&gt; nodes, each one owning 1/4 or the total partitions. That's part of
&gt; reason why I didn't think the data ownership had been moved.
&gt; 
Ring ownership is only affected by nodes explicitly entering and leaving the 
cluster. Unless you explicitly tell the cluster to remove a node, or explicitly 
tell that node to leave the cluster, ownership will remain the same even in 
case of a failure on one or more nodes. Data ownership is moved around 
implicitly in case of failure. By looking at the preference list, the 
coordinating node simply picks the next node(s) to pick up the slack for the 
failed one(s).

The only way to find out if a handoff is currently happening between any two 
nodes is to look at the logs. They'll indicate beginning and end of a transfer. 
The cluster state and therefore the stats don't take re-partitioning or handoff 
into account yet.
&gt; 2) My test involves sending a large number of read/write requests to the 
&gt; cluster from multiple client connections and timing how long each request
&gt; takes. I find that the vast majority of the requests are processed 
&gt; quickly (a few milliseconds to 10s of milliseconds). However, every once
&gt; in while, the server seems to &quot;hang&quot; for a while. When that happens
&gt; the response can take several hundred milliseconds or even several 
&gt; seconds. Is this something that is known and/or expected? There 
&gt; doesn't seem to be any pattern to how often it happens -- typically 
&gt; I'll see it a &quot;few&quot; times during a 10-minute test run. Sometimes
&gt; it will go for several minutes without a problem. I haven't ruled
&gt; out a problem with my test client, but it's fairly simple-minded C++
&gt; program using the protocol buffers interface, so I don't think there
&gt; is too much that can go wrong on that end.
&gt; 
Easiest to find out if the problem is something stalling is to look at the 
stats and the percentiles for put and get fsms, which are responsible for 
taking care of reads and writes. Look for the JSON keys node_get_fsm_time_* and 
node_put_fsm_time_*. If anything jumps out here during and shortly after your 
benchmark run, something on the Riak or EC2 end is probably waiting for 
something else.

Are you using EBS in any way for storing Riak's data? If so, what kind of setup 
do you have, single volume or RAID? 

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03330.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#03414">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#03414">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03329.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03326.html">Riak replication and quorum</a></span> <span class="sender italic">Peter Fales</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03327.html">Re: Riak replication and quorum</a></span> <span class="sender italic">Ben Tilly</span></li>
<li class="icons-email"><span class="subject"><a href="msg03328.html">Re: Riak replication and quorum</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03330.html">Re: Riak replication and quorum</a></span> <span class="sender italic">Peter Fales</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak replication and quorum</span> <span class="sender italic">Mathias Meyer</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak replication and quorum">
<input type="hidden" name="msgid" value="ECE9BA98464043E7BC837F8A2049DA69@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03414.html">
<input type="submit" value=" Mathias Meyer ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+replication+and+quorum%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03330.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03329.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">ECE9BA98464043E7BC837F8A2049DA69@basho.com</li>
</ul>
</div>
</body>
</html>
