<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak doesn't start on new Macbook Pro Retina</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07966" id="c">
<link rel="index" href="maillist.html#07966" id="i">
<link rel="prev" href="msg07956.html" id="p">
<link rel="next" href="msg07971.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07966.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+doesn%27t+start+on+new+Macbook+Pro+Retina%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak doesn't start on new Macbook Pro Retina</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Steve+Hull%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Steve Hull</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120716" rel="nofollow">Mon, 16 Jul 2012 12:20:16 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>So one thing that seems bizarre is that riak has created directory
structure under /tmp to mirror the directory structure from root to the
binary executable.</pre><pre>

For example, after I tried to start riak using the binary installed by
brew, I noticed this directory structure that got added to /tmp:

! ls -alhrt /tmp/usr/local/Cellar/riak/1.1.2-x86_64/libexec/
total 0
drwxr-xr-x  3 shull  wheel   102B Jul 13 13:56 ../
drwxr-xr-x  2 shull  wheel    68B Jul 13 14:24 ./


And similarly for the local pre-packaged version, it created:

! ls -alhrt /tmp/Users/shull/Dev/prodar/riak-1.1.4/
total 0
drwxr-xr-x  3 shull  wheel   102B Jul 13 14:08 ../
drwxr-xr-x  4 shull  wheel   136B Jul 16 11:56 ./
prw-------  1 shull  wheel     0B Jul 16 11:57 erlang.pipe.1.w|
prw-------  1 shull  wheel     0B Jul 16 11:57 erlang.pipe.1.r|


I guess there's nothing really *wrong* with that, it just kind of worried
me at first to see that directory structure under /tmp.

Anyway if I read your email correctly, you wanted me to try to start riak
and then after it reports failure, try to attach to it:

[07-16 11:55] (master)~/Dev/prodar
! riak-1.1.4/bin/riak start
Riak failed to start within 15 seconds,
see the output of 'riak console' for more information.
If you want to wait longer, set the environment variable
WAIT_FOR_ERLANG to the number of seconds to wait.

[07-16 11:56] (master)~/Dev/prodar
! riak-1.1.4/bin/riak attach
Node is not running!


Not sure if any logs would be interesting to look at after this.
 Interestingly, riak does seem to be running, as basic REST stuff seems to
work OK (using Ruby + Ripple).

-S

On Mon, Jul 16, 2012 at 12:23 AM, Erik Søe Sørensen &lt;e...@trifork.com&gt; wrote:

&gt; Well, from the logs it looks like a normal and successful startup...
&gt; consistent with the fact that a riak process continues to exists.
&gt; And the startup does not seem to be slow (which would cause a timeout for
&gt; the script waiting for the node to come up); from logging starts to the
&gt; node is ready takes just 2s.
&gt; It then remains to be determined why the start script reports timeout.
&gt;
&gt; Either it can't connect to the node, or the check it attempts to make
&gt; within the node (whether an Erlang process called 'riak_core_node_watcher'
&gt; is registered) never succeeds.
&gt; Have you tried attaching to the node, using &quot;riak attach&quot;?  That would
&gt; check which of the two things fail.
&gt;
&gt; The pipe files are usually called things like
&gt;   /tmp/riak/erlang.pipe.2.r
&gt; (they exist in pairs: one to and one from the node).
&gt;
&gt; /Erik
&gt;
&gt; ________________________________________
&gt; From: Steve Hull [st...@taskrabbit.com]
&gt; Sent: 16 July 2012 08:20
&gt; To: Erik Søe Sørensen
&gt; Cc: videlalv...@gmail.com; riak-users@lists.basho.com
&gt; Subject: Re: riak doesn't start on new Macbook Pro Retina
&gt;
&gt; Hi Erik!
&gt;
&gt; Thanks for the suggestions.  I checked out /tmp but didn't see anything
&gt; that looked like a pipe for riak... perhaps could you tell me what the file
&gt; would be named?
&gt;
&gt; Not sure which logs would be most useful, but please find everything that
&gt; was generated attached.
&gt;
&gt; -S
&gt;
&gt; On Sat, Jul 14, 2012 at 9:40 AM, Erik Søe Sørensen &lt;e...@trifork.com
&gt; &lt;<a  rel="nofollow" href="mailto:e...@trifork.com">mailto:e...@trifork.com</a>&gt;&gt; wrote:
&gt; If I remember correctly, this may be a symptom that the pipe file on /tmp
&gt; which Riak wants to use does already exists but is owned by another user.
&gt; This happens if Riak has previously been run by a different user.
&gt; If it's not that, I suggest you provide the logs from the failed &quot;riak
&gt; start&quot; attempt for further diagnosis...
&gt;



-- 
*Steve Hull *| *TaskRabbit *|Software Engineer
*P:* 510.928.4719
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07956.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07966">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07966">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07971.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg07939.html">riak doesn't start on new Macbook Pro Retina</a></span> <span class="sender italic">Steve Hull</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07940.html">Re: riak doesn't start on new Macbook Pro Retina</a></span> <span class="sender italic">Alvaro Videla</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07941.html">Re: riak doesn't start on new Macbook Pro Ret...</a></span> <span class="sender italic">Steve Hull</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg07946.html">SV: riak doesn't start on new Macbook Pro Retina</a></span> <span class="sender italic">Erik Søe Sørensen</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07953.html">Re: riak doesn't start on new Macbook Pro Ret...</a></span> <span class="sender italic">Steve Hull</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07956.html">RE: riak doesn't start on new Macbook Pro...</a></span> <span class="sender italic">Erik Søe Sørensen</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak doesn't start on new Macbook...</span> <span class="sender italic">Steve Hull</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07971.html">Re: riak doesn't start on new Ma...</a></span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07975.html">Re: riak doesn't start on ne...</a></span> <span class="sender italic">Mark Phillips</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07977.html">Re: riak doesn't start o...</a></span> <span class="sender italic">Jeff Kirkell</span></li>
<li class="icons-email"><span class="subject"><a href="msg07978.html">Re: riak doesn't start o...</a></span> <span class="sender italic">Steve Hull</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak doesn't start on new Macbook Pro Retina">
<input type="hidden" name="msgid" value="CAFqty14kb1BGNMuz7DLX854Crb08w99oQVWpyVFT_nPPV5xdgA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07966.html">
<input type="submit" value=" Steve Hull ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak+doesn%27t+start+on+new+Macbook+Pro+Retina%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07956.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07971.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAFqty14kb1BGNMuz7DLX854Crb08w99oQVWpyVFT_nPPV5xdgA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
