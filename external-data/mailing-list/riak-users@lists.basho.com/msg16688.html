<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: counter crdt in riak</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd8.html#16688" id="c">
<link rel="index" href="mail8.html#16688" id="i">
<link rel="prev" href="msg16685.html" id="p">
<link rel="next" href="msg16686.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg16688.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+counter+crdt+in+riak%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: counter crdt in riak</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22David+Byron%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">David Byron</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20151020" rel="nofollow">Tue, 20 Oct 2015 22:49:16 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">

On 10/20/15 9:26 PM, xia...@xiaclo.net wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
This gives a little more detail about each of the CRDT types:
<a  rel="nofollow" href="https://github.com/basho/riak/issues/354">https://github.com/basho/riak/issues/354</a>
</pre></blockquote><pre style="margin: 0em;"></pre><pre>

Thanks much.  That link is very helpful.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Your assumptions are correct.  Within Riak, an actor is a vnode, and
counters behave as G-Counters.

Keep in mind that Riak counters store both an increment and decrement
for each actor, which allows decrements and negative counters as well
while preserving the accuracy of G-Counters.
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>I'd read in 
</tt><tt><a  rel="nofollow" href="https://github.com/basho/riak/blob/develop/releasenotes/riak-1.4.md#pn-counters">https://github.com/basho/riak/blob/develop/releasenotes/riak-1.4.md#pn-counters</a> 
</tt><tt>that riak's counters were PN...which I think is what you're 
</tt><tt>saying...except the part about them behaving as G-Counters.
</tt><pre style="margin: 0em;">

</pre><tt>Sorry if I'm a little slow on the uptake here, and thanks again for your 
</tt><tt>help.
</tt><pre style="margin: 0em;">

-DB

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hope this helps,
Jason
________________________________________________________________________
From: David Byron &lt;dby...@dbyron.com &lt;<a  rel="nofollow" href="mailto:dby...@dbyron.com">mailto:dby...@dbyron.com</a>&gt;&gt;
Date: Wed Oct 21 2015 15:03:04 GMT+1100 (AUS Eastern Summer Time)
To: riak-users@lists.basho.com &lt;riak-users@lists.basho.com
&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;&gt;
Subject: counter crdt in riak

Apologies if this is basic question, or one that's already been
answered.  I've done a fair amount of digging (e.g.
<a  rel="nofollow" href="http://thread.gmane.org/gmane.comp.db.riak.user/12808/focus=12816">http://thread.gmane.org/gmane.comp.db.riak.user/12808/focus=12816</a>), but
  I'm still confused about the documentation regarding conflict
resolution  for riak's crdt counter.  Specifically this:
<a  rel="nofollow" href="https://github.com/basho/basho_docs/blame/riak/2.1.1/source/languages/en/riak/theory/concepts/crdts.md#L238">https://github.com/basho/basho_docs/blame/riak/2.1.1/source/languages/en/riak/theory/concepts/crdts.md#L238</a>
  (using the blame view to get a line number reference in markdown),
which  says:

&quot;Counters | Each actor keeps an independent count for increments and
decrements; upon merge, the pairwise maximum of the counts for each
actor will win (e.g. if one count for an actor holds 172 and the other
holds 173, 173 will win upon merge)&quot;

This makes it sound to me like an increment from one of the actors gets
  dropped.  Fingers crossed this isn't actually what happens.

I think this is saying the same thing that the cdrt paper (section 3.1.2
  State-based increment-only Counter (G-Counter) of
<a  rel="nofollow" href="https://hal.inria.fr/file/index/docid/555588/filename/techreport.pdf">https://hal.inria.fr/file/index/docid/555588/filename/techreport.pdf</a>)
says -- that increments that happen during a partition eventually
resolve correctly.  I could use a more step-by-step illustration though
  -- pairwise maximum of the counts for each actor is a little dense.

Apologies for ugly formatting, but an example like this would make more
  sense to me.

- actor a increments counter
    a {a: 1}                   b {}

- actor b increments counter
    a {a: 1}                   b {b: 1}

- a merges b's info
    a {a: 1, b: 1}             b {b: 1}

- b merges a's info
    a:{a: 1, b: 1}             b {a: 1, b: 1}

so eventually this all resolves such that a and b both increment the
counter by 2, right?  Is this how riak's crdt counter works?  If so I'll
  breathe a sigh of relief and make a pull request against the docs if
you  like.

Thanks much for your help.

-DB
</pre></blockquote><pre style="margin: 0em;">

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg16685.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd8.html#16688">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail8.html#16688">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg16686.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg16684.html">counter crdt in riak</a></span> <span class="sender italic">David Byron</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16689.html">Re: counter crdt in riak</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16692.html">Re: counter crdt in riak</a></span> <span class="sender italic">David Byron</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg16685.html">Re: counter crdt in riak</a></span> <span class="sender italic">xiaclo</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: counter crdt in riak</span> <span class="sender italic">David Byron</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: counter crdt in riak">
<input type="hidden" name="msgid" value="56272722.9050703@dbyron.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg16688.html">
<input type="submit" value=" David Byron ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+counter+crdt+in+riak%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg16685.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg16686.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">56272722.9050703@dbyron.com</li>
</ul>
</div>
</body>
</html>
