<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Is riak the right choice to log and retrieve log data?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06547" id="c">
<link rel="index" href="maillist.html#06547" id="i">
<link rel="prev" href="msg06545.html" id="p">
<link rel="next" href="msg06585.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06547.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Is+riak+the+right+choice+to+log+and+retrieve+log+data%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Is riak the right choice to log and retrieve log data?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Alexander+Sicular%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Alexander Sicular</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120206" rel="nofollow">Mon, 06 Feb 2012 04:32:17 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hello Heiner,

Looks like a very interesting project. Would love to hear how it turns out. Do 
let us know what you end up deploying. Here are some of my thoughts. </pre><pre>

Between secondary indexes and/or search you should not have a problem 
retrieving a &quot;blip page&quot; of data. 

Certainly do not use the bitcask backend due to in memory key index. You would 
definitely need to use leveldb.

Data bloat. Your 200B will triple on disk because Riak writes ~400B of data for 
itself per key (not exactly certain of the numbers in the post 1.0 branch). For 
this reason alone I'm not sure Riak is optimal for collection of large 
quantities of small values. The sweetspot is in the multi KB range where the 
overhead becomes some smaller % of total data. 

Ring state changes late in your collection cycle will result in a significant 
amount of data rebalancing which will obviously take a while. I would 
overdeploy more nodes early on and replace them in-place, over time to take 
advantage of newer hardware. I feel that although a lot of great work has 
already been done, there is still more work to be done on the rebalancing 
mechanics and algorithm to make this less of a pain point for larger systems. 

I would consider evaluating Cassandra or HBase for this project as well. 

Cheers,
Alexander

@siculars on twitter
<a  rel="nofollow" href="http://siculars.posterous.com">http://siculars.posterous.com</a>

Sent from my iRotaryPhone

On Feb 6, 2012, at 5:22, Heiner Bunjes &lt;bun...@innotec-data.de&gt; wrote:

&gt; I need a database to log and retrieve sensor data.
&gt; 
&gt; Is riak the right solution for this task and if, how?
&gt; If not, which other DB system might be a better fit?
&gt; 
&gt; I know that before the implementation of secondary indices riak probably was 
&gt; not suitable for this kind of task. I just hope it is now.
&gt; 
&gt; 
&gt; 
&gt; The details are as follows:
&gt; 
&gt; ######## &lt;requirements version=&quot;3&quot;&gt;
&gt; 
&gt; Glossary
&gt; 
&gt; - Node = A computer on which an instance of the database
&gt;  is running
&gt; 
&gt; - Blip = one data record send by a sensor
&gt; 
&gt; - Blip page = The sorted list of all blips for a specific sensor
&gt;  and a specific time range.
&gt; 
&gt; 
&gt; The scale is as follows:
&gt; 
&gt; (01) 10E6 sensors deliver 1 blip every 100 seconds
&gt;     -&gt; Insert rate = 10 kiloblip/s
&gt;     -&gt; Insert rate ~ 315 gigablip/Year
&gt; 
&gt; (02) They have to be stored for ~3 years
&gt;     -&gt; Size of database = 1 terablip
&gt; 
&gt; (03) Each blip has about 200 bytes
&gt;     -&gt; Size of database = 200TB
&gt; 
&gt; (04) The system will start with just 10E4 sensors but will
&gt;     soon increase upto the described volume.
&gt; 
&gt; 
&gt; The main operations on the data are:
&gt; 
&gt; (05) Add the new blips to the database
&gt;     (written blips are never changed)!
&gt; 
&gt; (06) Return all blips for sensor X with a timestamp
&gt;     between timestamp_a and timestamp_b!
&gt;     With other words: Return a blip page.
&gt; 
&gt; (07) Return all the blips specified in (06) ordered
&gt;     by timestamp!
&gt; 
&gt; (08) Delete all blips older than Y!
&gt; 
&gt; 
&gt; Further the following is true:
&gt; 
&gt; (09) Each added blip is clearly (without ambiguity) identifiable by
&gt;     sensor_id+timestamp.
&gt; 
&gt; (10) 99.9% of the blips are inserted in
&gt;     chronological order, the rest is not.
&gt; 
&gt; (11) The database system MUST be free and open source.
&gt; 
&gt; (12) The DB SHOULD be easy to administrate.
&gt; 
&gt; (13) All data MUST still be writable and readable while less
&gt;     then the configurable number N of nodes are down (unexpectedly).
&gt; 
&gt; (14) The mechanisms to distribute the data to the available
&gt;     nodes SHOULD be handled by the database.
&gt;     This means that the database SHOULD automatically
&gt;     redistribute the data when nodes are added or removed.
&gt; 
&gt; ######## &lt;/requirements&gt;
&gt; 
&gt; 
&gt; Many thanks in advance
&gt; Heiner
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06545.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06547">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06547">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06585.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg06545.html">Is riak the right choice to log and retrieve log data?</a></span> <span class="sender italic">Heiner Bunjes</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Is riak the right choice to log and retrieve lo...</span> <span class="sender italic">Alexander Sicular</span></li>
<li class="icons-email"><span class="subject"><a href="msg06585.html">Is riak the right choice to log and retrieve log da...</a></span> <span class="sender italic">Heiner Bunjes</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Is riak the right choice to log and retrieve log data?">
<input type="hidden" name="msgid" value="10BA23F8-DBE7-4025-BE78-68E9DA9EC5CD@gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06547.html">
<input type="submit" value=" Alexander Sicular ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Is+riak+the+right+choice+to+log+and+retrieve+log+data%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06545.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06585.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">10BA23F8-DBE7-4025-BE78-68E9DA9EC5CD@gmail.com</li>
</ul>
</div>
</body>
</html>
