<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: A put is not put in Riak</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#16901" id="c">
<link rel="index" href="mail2.html#16901" id="i">
<link rel="prev" href="msg16894.html" id="p">
<link rel="next" href="msg16896.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg16901.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+A+put+is+not+put+in+Riak%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: A put is not put in Riak</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Alexander+Sicular%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Alexander Sicular</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20151230" rel="nofollow">Wed, 30 Dec 2015 15:28:16 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Patrice, since Riak is distributed it uses a quorum (default 2 when
n_val is 3) to read your data. Since you're doing a post commit hook
to read your data immediately after you write there may be delay in
getting the new value from two of three copies written due simply to
timing. So the rule of thumb is to do a w+r&gt;n transaction where you
ensure that you write/read with some total value more than your number
of replicas. Read these posts (part four talks about RYOW):</pre><pre>

<a  rel="nofollow" href="http://basho.com/posts/technical/understanding-riaks-configurable-behaviors-part-1/">http://basho.com/posts/technical/understanding-riaks-configurable-behaviors-part-1/</a>
<a  rel="nofollow" href="http://basho.com/posts/technical/riaks-config-behaviors-part-2/">http://basho.com/posts/technical/riaks-config-behaviors-part-2/</a>
<a  rel="nofollow" href="http://basho.com/posts/technical/riaks-config-behaviors-part-3/">http://basho.com/posts/technical/riaks-config-behaviors-part-3/</a>
<a  rel="nofollow" href="http://basho.com/posts/technical/riaks-config-behaviors-part-4/">http://basho.com/posts/technical/riaks-config-behaviors-part-4/</a>

-Alexander

@siculars
<a  rel="nofollow" href="http://siculars.posthaven.com">http://siculars.posthaven.com</a>

Sent from my iRotaryPhone

&gt; On Dec 30, 2015, at 11:14, John Daily &lt;jda...@basho.com&gt; wrote:
&gt;
&gt; This smells like a clock problem. Are you confident all of your serversâ€™ 
&gt; clocks are set to the same time?
&gt;
&gt; Updates can be treacherous if clocks are not synchronized and multiple writes 
&gt; to the same key occur in a period of time short enough to fit within the 
&gt; clock skew.
&gt;
&gt; I wrote about this after a similar question arose here: 
&gt; <a  rel="nofollow" href="http://basho.com/posts/technical/clocks-are-bad-or-welcome-to-distributed-systems/">http://basho.com/posts/technical/clocks-are-bad-or-welcome-to-distributed-systems/</a>
&gt;
&gt; -John
&gt;
&gt;&gt; On Dec 8, 2015, at 9:39 AM, Patrice Bruno &lt;patr...@kuantic.com&gt; wrote:
&gt;&gt;
&gt;&gt; Good-Evening everyone,
&gt;&gt;
&gt;&gt; I'm reading this maling for minths now wioth great interest, and now we are 
&gt;&gt; using Riak, I have a question to not say an issue that I can not figure out.
&gt;&gt;
&gt;&gt; We have migrated leveldb files from Riak 1.3.1 to Riak 2.1.1.
&gt;&gt; The clusters has 6 Nodes and 6 computers.
&gt;&gt; We are running now on CentOS Linux release 7.1.1503 (Core) (we were under 
&gt;&gt; Fedora when we are under Riak 1.3.1).
&gt;&gt;
&gt;&gt; We have kept the default Riak paramaters. We are not using 'bucket_type'. 
&gt;&gt; The only paramaters we have tuned are:
&gt;&gt; erlang.distribution_buffer_size = 128MB
&gt;&gt; erlang.async_threads = 128
&gt;&gt;
&gt;&gt; My issue is on a Bucket without sibling (default settings) I'm making a put 
&gt;&gt; and when I do the get the value has not been changed, and old value stayed 
&gt;&gt; under the key. So, I have made a test: I've made a put of an objet A, I can 
&gt;&gt; see in the precommit hook that it's well the object A, but in the postcommit 
&gt;&gt; the object (argument passed) is an old one.
&gt;&gt; I thought that I'm not sending the right object, but when I see it in 
&gt;&gt; precommit hook, I'm sure now that I send what I expect to send.
&gt;&gt;
&gt;&gt; It's not for all the objects, but it appears time to time under load.
&gt;&gt;
&gt;&gt; Do you already seen this issue ?
&gt;&gt; Do you have an idea or something I can enhance/tune ?
&gt;&gt;
&gt;&gt;
&gt;&gt; Help me mailing list, you are my only hope :-) (dixit Princess Leia).
&gt;&gt;
&gt;&gt; --
&gt;&gt;
&gt;&gt; Best Reagrds,
&gt;&gt;
&gt;&gt;   Patrice Bruno
&gt;&gt;   Kuantic
&gt;&gt; ---
&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg16894.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#16901">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#16901">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg16896.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg16893.html">A put is not put in Riak</a></span> <span class="sender italic">Patrice Bruno</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16894.html">Re: A put is not put in Riak</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: A put is not put in Riak</span> <span class="sender italic">Alexander Sicular</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: A put is not put in Riak">
<input type="hidden" name="msgid" value="CALKhwhX=sUtwze-ks1U_5XGQk4b-rN=SAYz3p2DLD07jJ_-O=w@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg16901.html">
<input type="submit" value=" Alexander Sicular ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+A+put+is+not+put+in+Riak%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg16894.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg16896.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CALKhwhX=sUtwze-ks1U_5XGQk4b-rN=SAYz3p2DLD07jJ_-O=w@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
