<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Node cannot join</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#08338" id="c">
<link rel="index" href="maillist.html#08338" id="i">
<link rel="prev" href="msg08337.html" id="p">
<link rel="next" href="msg08339.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg08338.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Node+cannot+join%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Node cannot join</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Ryan+Zezeski%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ryan Zezeski</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120821" rel="nofollow">Tue, 21 Aug 2012 06:36:41 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Daniel,

Cluster operations (invoked by `riak-admin cluster`) are now multi-phase.
 Instead of calling an operation and it taking effect immediately you need
to stage your changes, view your changes, and then commit them.  E.g.</pre><pre>

riak-admin cluster join blah

riak-admin cluster plan

riak-admin cluster commit

There is an `-f` option to keep the old behavior but we recommend against
this.  Staged clustering was put in place to keep users from hurting their
clusters and to make multiple changes more efficient.

-Z

On Tue, Aug 21, 2012 at 9:28 AM, Daniel Iwan &lt;iwan.dan...@gmail.com&gt; wrote:

&gt; Hi
&gt;
&gt; In my setup everything worked fine until I upgraded to riak 1.2
&gt; (although this may be a coincidence)
&gt; Nodes are installed from scratch with changes only to db backend (I'm
&gt; using eLevelDB)
&gt; and names.
&gt; For some reason node cannot join to another.
&gt; What am I doing wrong?
&gt;
&gt; I'm using Ubuntu 10.04 but I've seen the same behaviour on Ubuntu 12.04
&gt; I may miss openssl dependency. I don't know if that matters
&gt;
&gt;
&gt; user@node2:~$ riak-admin cluster join riak@10.173.240.1
&gt; Attempting to restart script through sudo -H -u riak
&gt; Success: staged join request for 'riak@10.173.240.2' to 'riak@10.173.240.1
&gt; '
&gt;
&gt;
&gt; user@node1:~$ riak-admin member-status
&gt; Attempting to restart script through sudo -H -u riak
&gt; ================================= Membership
&gt; ==================================
&gt; Status     Ring    Pending    Node
&gt;
&gt; -------------------------------------------------------------------------------
&gt; joining     0.0%      --      'riak@10.173.240.2'
&gt; valid     100.0%      --      'riak@10.173.240.1'
&gt;
&gt; -------------------------------------------------------------------------------
&gt;
&gt; Valid:1 / Leaving:0 / Exiting:0 / Joining:1 / Down:0
&gt; user@node1:~$
&gt; user@node1:~$ riak-admin transfers
&gt;
&gt; Attempting to restart script through sudo -H -u riak
&gt; No transfers active
&gt;
&gt; Active Transfers:
&gt;
&gt; user@node1:~$
&gt;
&gt; riak-admin status
&gt; Attempting to restart script through sudo -H -u riak
&gt; 1-minute stats for 'riak@10.173.240.1'
&gt; -------------------------------------------
&gt; vnode_gets : 0
&gt; vnode_gets_total : 0
&gt; vnode_puts : 0
&gt; vnode_puts_total : 0
&gt; vnode_index_reads : 0
&gt; vnode_index_reads_total : 0
&gt; vnode_index_writes : 0
&gt; vnode_index_writes_total : 0
&gt; vnode_index_writes_postings : 0
&gt; vnode_index_writes_postings_total : 0
&gt; vnode_index_deletes : 0
&gt; vnode_index_deletes_total : 0
&gt; vnode_index_deletes_postings : 0
&gt; vnode_index_deletes_postings_total : 0
&gt; node_gets : 0
&gt; node_gets_total : 0
&gt; node_get_fsm_siblings_mean : 0
&gt; node_get_fsm_siblings_median : 0
&gt; node_get_fsm_siblings_95 : 0
&gt; node_get_fsm_siblings_99 : 0
&gt; node_get_fsm_siblings_100 : 0
&gt; node_get_fsm_objsize_mean : 0
&gt; node_get_fsm_objsize_median : 0
&gt; node_get_fsm_objsize_95 : 0
&gt; node_get_fsm_objsize_99 : 0
&gt; node_get_fsm_objsize_100 : 0
&gt; node_get_fsm_time_mean : 0
&gt; node_get_fsm_time_median : 0
&gt; node_get_fsm_time_95 : 0
&gt; node_get_fsm_time_99 : 0
&gt; node_get_fsm_time_100 : 0
&gt; node_puts : 0
&gt; node_puts_total : 0
&gt; node_put_fsm_time_mean : 0
&gt; node_put_fsm_time_median : 0
&gt; node_put_fsm_time_95 : 0
&gt; node_put_fsm_time_99 : 0
&gt; node_put_fsm_time_100 : 0
&gt; read_repairs : 0
&gt; read_repairs_total : 0
&gt; coord_redirs_total : 0
&gt; executing_mappers : 0
&gt; precommit_fail : 0
&gt; postcommit_fail : 0
&gt; pbc_active : 0
&gt; pbc_connects : 0
&gt; pbc_connects_total : 0
&gt; cpu_nprocs : 340
&gt; cpu_avg1 : 182
&gt; cpu_avg5 : 136
&gt; cpu_avg15 : 92
&gt; mem_total : 4154609664
&gt; mem_allocated : 1475477504
&gt; disk : [{&quot;/&quot;,54417668,2},
&gt;         {&quot;/dev&quot;,2024188,1},
&gt;         {&quot;/dev/shm&quot;,2028616,0},
&gt;         {&quot;/var/run&quot;,2028616,1},
&gt;         {&quot;/var/lock&quot;,2028616,0},
&gt;         {&quot;/lib/init/rw&quot;,2028616,0},
&gt;         {&quot;/var/lib/ureadahead/debugfs&quot;,54417668,2},
&gt;         {&quot;/media/ARRAY1&quot;,10739982336,1},
&gt;         {&quot;/boot&quot;,186663,22}]
&gt; nodename : 'riak@10.173.240.1'
&gt; connected_nodes : ['riak@10.173.240.2']
&gt; sys_driver_version : &lt;&lt;&quot;2.0&quot;&gt;&gt;
&gt; sys_global_heaps_size : 0
&gt; sys_heap_type : private
&gt; sys_logical_processors : 4
&gt; sys_otp_release : &lt;&lt;&quot;R15B01&quot;&gt;&gt;
&gt; sys_process_count : 1392
&gt; sys_smp_support : true
&gt; sys_system_version : &lt;&lt;&quot;Erlang R15B01 (erts-5.9.1) [source] [64-bit]
&gt; [smp:4:4] [async-threads:64] [kernel-poll:true]&quot;&gt;&gt;
&gt; sys_system_architecture : &lt;&lt;&quot;x86_64-unknown-linux-gnu&quot;&gt;&gt;
&gt; sys_threads_enabled : true
&gt; sys_thread_pool_size : 64
&gt; sys_wordsize : 8
&gt; ring_members : ['riak@10.173.240.1','riak@10.173.240.2']
&gt; ring_num_partitions : 64
&gt; ring_ownership : &lt;&lt;&quot;[{'riak@10.173.240.1',64}]&quot;&gt;&gt;
&gt; ring_creation_size : 64
&gt; storage_backend : riak_kv_eleveldb_backend
&gt; erlydtl_version : &lt;&lt;&quot;0.7.0&quot;&gt;&gt;
&gt; riak_control_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; cluster_info_version : &lt;&lt;&quot;1.2.2&quot;&gt;&gt;
&gt; riak_api_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; riak_search_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; merge_index_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; riak_kv_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; riak_pipe_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; riak_core_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; lager_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; syntax_tools_version : &lt;&lt;&quot;1.6.8&quot;&gt;&gt;
&gt; compiler_version : &lt;&lt;&quot;4.8.1&quot;&gt;&gt;
&gt; bitcask_version : &lt;&lt;&quot;1.5.1&quot;&gt;&gt;
&gt; basho_stats_version : &lt;&lt;&quot;1.0.2&quot;&gt;&gt;
&gt; luke_version : &lt;&lt;&quot;0.2.5&quot;&gt;&gt;
&gt; webmachine_version : &lt;&lt;&quot;1.9.2&quot;&gt;&gt;
&gt; mochiweb_version : &lt;&lt;&quot;1.5.1&quot;&gt;&gt;
&gt; inets_version : &lt;&lt;&quot;5.9&quot;&gt;&gt;
&gt; erlang_js_version : &lt;&lt;&quot;1.2.0&quot;&gt;&gt;
&gt; runtime_tools_version : &lt;&lt;&quot;1.8.8&quot;&gt;&gt;
&gt; os_mon_version : &lt;&lt;&quot;2.2.9&quot;&gt;&gt;
&gt; riak_sysmon_version : &lt;&lt;&quot;1.1.2&quot;&gt;&gt;
&gt; ssl_version : &lt;&lt;&quot;5.0.1&quot;&gt;&gt;
&gt; public_key_version : &lt;&lt;&quot;0.15&quot;&gt;&gt;
&gt; crypto_version : &lt;&lt;&quot;2.1&quot;&gt;&gt;
&gt; sasl_version : &lt;&lt;&quot;2.2.1&quot;&gt;&gt;
&gt; stdlib_version : &lt;&lt;&quot;1.18.1&quot;&gt;&gt;
&gt; kernel_version : &lt;&lt;&quot;2.15.1&quot;&gt;&gt;
&gt; memory_total : 26853928
&gt; memory_processes : 6744452
&gt; memory_processes_used : 6744438
&gt; memory_system : 20109476
&gt; memory_atom : 429569
&gt; memory_atom_used : 406875
&gt; memory_binary : 58504
&gt; memory_code : 9277444
&gt; memory_ets : 774080
&gt;
&gt;
&gt; D.
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg08337.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#08338">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#08338">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg08339.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg08337.html">Node cannot join</a></span> <span class="sender italic">Daniel Iwan</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Node cannot join</span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08339.html">Re: Node cannot join</a></span> <span class="sender italic">Shane McEwan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08340.html">Re: Node cannot join</a></span> <span class="sender italic">John E. Vincent</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg08342.html">Re: Node cannot join</a></span> <span class="sender italic">Daniel Iwan</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08343.html">Re: Node cannot join</a></span> <span class="sender italic">Andrew Thompson</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Node cannot join">
<input type="hidden" name="msgid" value="CACZcpenB3ja_zjazFVw=5NWqZNU7k0eLmDS9eruJaRH7eEhcHQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg08338.html">
<input type="submit" value=" Ryan Zezeski ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Node+cannot+join%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg08337.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg08339.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACZcpenB3ja_zjazFVw=5NWqZNU7k0eLmDS9eruJaRH7eEhcHQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
