<!DOCTYPE html>
<html lang="en">
<head>
<title>removing stale members from the ring was: Re: Questions about ring	state management.</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd3.html#01433" id="c">
<link rel="index" href="maillist.html#01433" id="i">
<link rel="prev" href="msg00862.html" id="p">
<link rel="next" href="msg00835.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg01433.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22removing+stale+members+from+the+ring+was%5C%3A+Re%5C%3A+Questions+about+ring%09state+management.%22&amp;o=newest" rel="nofollow"><span itemprop="name">removing stale members from the ring was: Re: Questions about ring	state management.</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Gernot+Ullrich%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Gernot Ullrich</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20101101" rel="nofollow">Mon, 01 Nov 2010 07:01:05 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
I've got a similar problem:
</pre><tt>riak_admin status lists some ring-members, that are no longer available 
</tt><tt>at all.   How can I get rid of those listings?
</tt><tt>the procedure given below does not make any changes.  And 'riak-admin 
</tt><tt>leave' does not work in this case, because the nodes are no longer 
</tt><tt>available.
</tt><pre style="margin: 0em;"></pre><pre>

Best regards
Gernot Ullrich
mylugo GmbH
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Mark,

</pre><tt>The option &quot;default_gossip_seed&quot; is not a Riak option; at least not 
</tt><tt>one I have seen. You are correct that it does not appear in the Riak 
</tt><tt>source code. If this was an option it has been removed.
</tt><pre style="margin: 0em;">

</pre><tt>To form a Riak cluster you must tell a node about another node in the 
</tt><tt>cluster using the &quot;riak-admin join&quot; command. A node only needs to be 
</tt><tt>told about one other node in a cluster; Riak learns about other 
</tt><tt>cluster nodes via gossip.The seeding process would look as follows:
</tt><pre style="margin: 0em;">
riak start
riak-admin join ot...@node


</pre><tt>Currently, removing a node must be done via Erlang. Bug 571 has been 
</tt><tt>filed to request a &quot;remove&quot; command:
</tt><pre style="margin: 0em;">
<a  rel="nofollow" href="https://issues.basho.com/show_bug.cgi?id=571">https://issues.basho.com/show_bug.cgi?id=571</a>

Removing a node via Erlang:
1. Attach to a riak node
riak attach
2. Get a local client
{ok, C} = riak:local_client().

3. Remove the node
C:remove_from_cluster('n...@host').

4 Detach from the node using CTRL+D
^D

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com &lt;<a  rel="nofollow" href="mailto:d...@basho.com">mailto:d...@basho.com</a>&gt;


</pre><tt>On Tue, Aug 3, 2010 at 9:58 AM, Mark Anderson &lt;m...@opscode.com 
</tt><tt>&lt;<a  rel="nofollow" href="mailto:m...@opscode.com">mailto:m...@opscode.com</a>&gt;&gt; wrote:
</tt><pre style="margin: 0em;">

    I'm playing around with setting up and tearing down clusters and I had
    a few questions:

    Looking at the chef recipe for riak sets an option in riak_core
    'default_gossip_seed'; apparently this is intended to cue a newly spun
    up node where to look to join the cluster. But for the life of me I
    can't get it to work, and I can't find any mention of it in the
    source.
    What's the recommended way to seed a freshly spun up node with a
    seed machine?

    I'm also trying to figure out how to evict a node from the ring. If
    you have access to the machine, you can do 'riak-admin leave' but what
    can you do if you don't? I'm imagining a usage pattern where you are
    running a bunch of vhosted machines. One dies, and you spin up a new
    machine, with a new node name to replace it. How do you get that old
    machine out of the ring?

    The natural way to name nodes in ec2 is to do something like
    r...@ec2_internal_ip. But once an instance is terminated, there is no
    way to get that ip back. I suspect I'm doing things wrong here, so
    suggestions for better configuration patterns are very welcome.

    _______________________________________________
    riak-users mailing list
    riak-users@lists.basho.com &lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;
    <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>



_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre></blockquote><pre style="margin: 0em;">


--
Dr. Gernot Ullrich | Softwarearchitekt | mylugo GmbH |
Erdmannstr. 10-12, 22765 Hamburg |
Tel.: +49 40 41 91 26 22 | Fax: +49 40 41 91 26 23 |
Mobil: +49 162 985 1582
Mail: gernot.ullr...@mylugo.de
Web: www.mylugo.de
Handelsregistereintrag: Amtsgericht Hamburg, HRB 104 354

Disclaimer:
Internet und E-Mail sind vielen Kommunikationsformen weit überlegen.
mylugo steht auch hier für sorgfältigen Umgang mit Informationen nach
dem aktuellen Stand der Technik. Bedenken Sie aber, dass Leitungswege
und Provider weder in Ihrem, noch im Einflußbereich von mylugo stehen.
mylugo kann daher keine Haftung für die Verbindlichkeit von Inhalten,
den Schutz vor weiterer Übertragung und ungewolltem Empfang, sowie
Schäden durch Speicherung und Verwendung von Informationen übernehmen.
Der Inhalt dieser E-Mail ist vertraulich und ausschließlich für den
bezeichneten Adressaten bestimmt. Wenn Sie nicht der vorgesehene
Adressat dieser E-Mail oder dessen Vertreter sind, beachten Sie bitte,
dass jede Form der Kenntnisnahme, Veröffentlichung, Vervielfältigung
oder Weitergabe des Inhalts dieser E-Mail unzulässig ist. Wir bitten
Sie, sich in diesem Fall mit dem Absender der E-Mail in Verbindung zu
setzen.

The information in this e-mail is confidential. The contents may not be
disclosed or used by anyone other then the addressee. Access to this
e-mail by anyone else is unauthorised. If you are not the intended
recipient, please notify mylugo immediately and delete this e-mail.
mylugo cannot accept any responsibility for the accuracy or completeness
of this e-mail as it has been sent over public networks. If you have any
concerns over the content of this message or its Accuracy or Integrity,
please contact mylugo immediately.
All outgoing e-mails from mylugo are checked using regularly updated
virus scanning software but you should take whatever measures you deem
to be appropriate to ensure that this message and any attachments are
virus free.


</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg00862.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd3.html#01433">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#01433">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg00835.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg00834.html">Questions about ring state management.</a></span> <span class="sender italic">Mark Anderson</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00862.html">Re: Questions about ring state management.</a></span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">removing stale members from the ring was: Re: Ques...</span> <span class="sender italic">Gernot Ullrich</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="removing stale members from the ring was: Re: Questions about ring	state management.">
<input type="hidden" name="msgid" value="4CCEC80D.2050700@mylugo.de">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg01433.html">
<input type="submit" value=" Gernot Ullrich ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22removing+stale+members+from+the+ring+was%5C%3A+Re%5C%3A+Questions+about+ring%09state+management.%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg00862.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg00835.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">4CCEC80D.2050700@mylugo.de</li>
</ul>
</div>
</body>
</html>
