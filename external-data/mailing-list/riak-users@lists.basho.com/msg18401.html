<!DOCTYPE html>
<html lang="en">
<head>
<title>Node diversity work</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#18401" id="c">
<link rel="index" href="maillist.html#18401" id="i">
<link rel="prev" href="msg18395.html" id="p">
<link rel="next" href="msg18402.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg18401.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Node+diversity+work%22&amp;o=newest" rel="nofollow"><span itemprop="name">Node diversity work</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22SEN%2C+Ramen+%5C%28NHS+DIGITAL%5C%29%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">SEN, Ramen (NHS DIGITAL)</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20170804" rel="nofollow">Fri, 04 Aug 2017 03:41:08 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>As part of a series of improvements and ongoing work on Riak KV we are doing 
here at NHS Digital, I have added a new bucket option to Riak KV, called 
'node_confirms'.</pre><pre>

A full write-up is available: 
<a  rel="nofollow" href="https://github.com/ramensen/riak_kv/blob/rs-physical-promises/docs/Node-Diversity.md">https://github.com/ramensen/riak_kv/blob/rs-physical-promises/docs/Node-Diversity.md</a>

In summary, within the database clusters used for the NHS Spine, historically 
we have used the primary write option (pw=2) to ensure data isn't lost due to 
individual hardware failures, as a proxy for physical diversity guarantees. 
This has worked well, however can lead to a situation where a riak database 
cluster rejects some writes in the case of two node failures.

The solution is to more directly tie configuration options over diversity to 
the physical layout of the system at run-time, not the abstract concept of the 
ring, and the new node_confirms option allows operators to specify the number 
of diverse nodes that must confirm their writes before a write is considered 
successful.

Next Friday Martin (@masleeds) is planning to do a write-up of the testing so 
far of the core node_worker_pool to help with multi-data-centre anti-entropy.

Regards,
Ramen

?

Dr Ramen Sen
Lead Systems Engineer
Operations and Non-functional Test Lead
Spine 2 Core
NHS Digital

ramen....@nhs.net&lt;<a  rel="nofollow" href="mailto://ramen....@nhs.net">mailto://ramen....@nhs.net</a>&gt;

NHS Digital provides information and technology for better health and care.
Find out more about who we are and what we do at  
www.digital.nhs.uk&lt;<a  rel="nofollow" href="http://www.digital.nhs.uk">http://www.digital.nhs.uk</a>&gt;

@NHSDigital
enquir...@nhsdigital.nhs.uk&lt;<a  rel="nofollow" href="mailto://enquir...@nhsdigital.nhs.uk">mailto://enquir...@nhsdigital.nhs.uk</a>&gt;
General enquiries: 0300 303 5678



********************************************************************************************************************

This message may contain confidential information. If you are not the intended 
recipient please inform the
sender that you have received the message in error before deleting it.
Please do not disclose, copy or distribute information in this e-mail or take 
any action in relation to its contents. To do so is strictly prohibited and may 
be unlawful. Thank you for your co-operation.

NHSmail is the secure email and directory service available for all NHS staff 
in England and Scotland. NHSmail is approved for exchanging patient data and 
other sensitive information with NHSmail and other accredited email services.

For more information and to find out how you can switch, 
<a  rel="nofollow" href="https://portal.nhs.net/help/joiningnhsmail">https://portal.nhs.net/help/joiningnhsmail</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg18395.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#18401">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#18401">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg18402.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">

</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Node diversity work">
<input type="hidden" name="msgid" value="1501843198945.71271@nhs.net">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg18401.html">
<input type="submit" value=" SEN, Ramen (NHS DIGITAL) ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Node+diversity+work%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg18395.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg18402.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">1501843198945.71271@nhs.net</li>
</ul>
</div>
</body>
</html>
