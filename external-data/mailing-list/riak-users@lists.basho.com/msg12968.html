<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Forcing Siblings to Occur</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd7.html#12968" id="c">
<link rel="index" href="mail7.html#12968" id="i">
<link rel="prev" href="msg12966.html" id="p">
<link rel="next" href="msg12969.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12968.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Forcing+Siblings+to+Occur%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Forcing Siblings to Occur</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Sam+Elliott%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Sam Elliott</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131113" rel="nofollow">Wed, 13 Nov 2013 00:33:22 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>We have introduced these so that users who are accidentally creating siblings 
(and large objects) can be notified in their logs.  </pre><pre>

1) Of course you can choose to change the limits
2) Please Please only do so if you know what you're doing. There's a certain 
amount of &quot;you're on your own&quot;, because we'll set the defaults for these values 
to what we think is sensible for Riak. Of course, if you think your magical 
system will work fine, it's entirely up to you.

We hope that our Data Types will provide enough useful types such that they 
cover the vast majority of data models. Riak 2.0 will get counters, sets, and 
maps, but if you have suggestions for generalised data structures you think 
would be useful to other Riak users, do send them our way and we'll see what we 
can do.

Sam

--  
Sam Elliott
Engineer
sam.elli...@basho.com
--


On Wednesday, 13 November 2013 at 12:43AM, Olav Frengstad wrote:

&gt; Forgot the link!
&gt;  
&gt; [1] 
&gt; <a  rel="nofollow" href="https://github.com/basho/riak_kv/commit/6981450c5ffc18207b3a1dc057fd3840a0906c42">https://github.com/basho/riak_kv/commit/6981450c5ffc18207b3a1dc057fd3840a0906c42</a>
&gt;  
&gt;  
&gt; 2013/11/13 Olav Frengstad &lt;o...@fwt.no (<a  rel="nofollow" href="mailto:o...@fwt.no">mailto:o...@fwt.no</a>)&gt;
&gt; &gt; @John, I'm definitely looking forward to CRDT's but at the same time i'm 
&gt; &gt; looking into alternative approaches for achieving the same thing.  
&gt; &gt;  
&gt; &gt; @Jason, your description is close to what i had in mind. Only real 
&gt; &gt; difference is merge would be on read. I did some testing and m/r seems to 
&gt; &gt; work by using an initial map phase calling `riak_object:get_values`
&gt; &gt;  
&gt; &gt;  
&gt; &gt; There's also the addition of maximum number of siblings in riak-2.0[1]
&gt; &gt;  
&gt; &gt;  
&gt; &gt;  
&gt; &gt;  
&gt; &gt; 2013/11/13 John Daily &lt;jda...@basho.com (<a  rel="nofollow" href="mailto:jda...@basho.com">mailto:jda...@basho.com</a>)&gt;
&gt; &gt; &gt; Jason, I don’t see any inherent problems, given reasonable management of 
&gt; &gt; &gt; the situation as you describe. I’d have to chase the code path to see 
&gt; &gt; &gt; what overhead you’re introducing to Riak’s processing, but if it’s 
&gt; &gt; &gt; working well for you, then who am I to object?
&gt; &gt; &gt;  
&gt; &gt; &gt; Perhaps someone who’s more familiar with the sibling management code 
&gt; &gt; &gt; could chime in.
&gt; &gt; &gt;  
&gt; &gt; &gt; -John
&gt; &gt; &gt;  
&gt; &gt; &gt;  
&gt; &gt; &gt; On Nov 12, 2013, at 5:10 PM, Jason Campbell &lt;xia...@xiaclo.net 
&gt; &gt; &gt; (<a  rel="nofollow" href="mailto:xia...@xiaclo.net">mailto:xia...@xiaclo.net</a>)&gt; wrote:
&gt; &gt; &gt; &gt; I am currently forcing siblings for time series data. The maximum 
&gt; &gt; &gt; &gt; bucket sizes are very predictable due to the nature of the data. I 
&gt; &gt; &gt; &gt; originally used the get/update/set cycle, but as I approach the end of 
&gt; &gt; &gt; &gt; the interval, reading and writing 1MB+ objects at a high frequency 
&gt; &gt; &gt; &gt; kills network bandwidth. So now, I append siblings, and I have a cron 
&gt; &gt; &gt; &gt; that merges the previous siblings (a simple set union works for me, 
&gt; &gt; &gt; &gt; only entire objects are ever deleted).  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; I can see how it can be dangerous to insert siblings, bit if you have 
&gt; &gt; &gt; &gt; some other method of knowing how much data is in one, I don't see size 
&gt; &gt; &gt; &gt; being an issue. I have also considered using a counter to know how 
&gt; &gt; &gt; &gt; large an object is without fetching it, which shouldn't be off by more 
&gt; &gt; &gt; &gt; than a few siblings unless there is a network partition.  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; So aside from size issues, which can be roughly predicted or worked 
&gt; &gt; &gt; &gt; around, is there any reason to not create hundreds or thousands of 
&gt; &gt; &gt; &gt; siblings and resolve them later? I realise sets could work well for my 
&gt; &gt; &gt; &gt; use case, but they seem overkill for simple append operations when I 
&gt; &gt; &gt; &gt; don't need delete functionality. Creating your own CRDTs are trivial if 
&gt; &gt; &gt; &gt; you never need to delete.  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; Thoughts are welcome,
&gt; &gt; &gt; &gt; Jason
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; From: John Daily
&gt; &gt; &gt; &gt; Sent: Wednesday, 13 November 2013 3:10 AM
&gt; &gt; &gt; &gt; To: Olav Frengstad
&gt; &gt; &gt; &gt; Cc: riak-users
&gt; &gt; &gt; &gt; Subject: Re: Forcing Siblings to Occur
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; Forcing siblings other than for testing purposes is not typically a 
&gt; &gt; &gt; &gt; good idea; as you indicate, the object size can easily become a problem 
&gt; &gt; &gt; &gt; as all siblings will live inside the same Riak value.  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; Your counter-example sounds a lot like a use case for server-side 
&gt; &gt; &gt; &gt; CRDTs; data structures that allow the application to add values without 
&gt; &gt; &gt; &gt; retrieving the server-side content first, and siblings are resolved by 
&gt; &gt; &gt; &gt; Riak.  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; These will arrive with Riak 2.0; see 
&gt; &gt; &gt; &gt; <a  rel="nofollow" href="https://gist.github.com/russelldb/f92f44bdfb619e089a4d">https://gist.github.com/russelldb/f92f44bdfb619e089a4d</a> for an overview.
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; -John
&gt; &gt; &gt; &gt; On Nov 12, 2013, at 7:13 AM, Olav Frengstad &lt;o...@fwt.no 
&gt; &gt; &gt; &gt; (<a  rel="nofollow" href="mailto:o...@fwt.no">mailto:o...@fwt.no</a>)&gt; wrote:
&gt; &gt; &gt; &gt; &gt; Do you consider forcing siblings a good idea? I would like to get 
&gt; &gt; &gt; &gt; &gt; some input on possible use cases and pitfalls.
&gt; &gt; &gt; &gt; &gt; For instance i have considered to force siblings and then merge them 
&gt; &gt; &gt; &gt; &gt; on read instead of fetching an object every time i want to update it 
&gt; &gt; &gt; &gt; &gt; (especially with larger objects).
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; It's not clear from the docs if there are any limitations, will the 
&gt; &gt; &gt; &gt; &gt; maximum object size be the limitation:?
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; A section of the docs[1] comees comes to mind:
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &quot;Having an enormous object in your node can cause reads of that 
&gt; &gt; &gt; &gt; &gt; object to crash the entire node. Other issues are increased cluster 
&gt; &gt; &gt; &gt; &gt; latency as the object is replicated and out of memory errors.&quot;
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; [1] 
&gt; &gt; &gt; &gt; &gt; <a  rel="nofollow" href="http://docs.basho.com/riak/latest/theory/concepts/Vector-Clocks/#Siblings">http://docs.basho.com/riak/latest/theory/concepts/Vector-Clocks/#Siblings</a>
&gt; &gt; &gt; &gt; &gt;   
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; 2013/11/9 Brian Roach &lt;ro...@basho.com (<a  rel="nofollow" href="mailto:ro...@basho.com">mailto:ro...@basho.com</a>)&gt;
&gt; &gt; &gt; &gt; &gt; &gt; On Fri, Nov 8, 2013 at 11:38 AM, Russell Brown 
&gt; &gt; &gt; &gt; &gt; &gt; &lt;russell.br...@me.com (<a  rel="nofollow" href="mailto:russell.br...@me.com">mailto:russell.br...@me.com</a>)&gt; wrote:
&gt; &gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &gt; &gt; If you’re using a well behaved client like the Riak-Java-Client, 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; or any other that gets a vclock before doing a put, use whatever 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; option stops that.
&gt; &gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &gt; for (int i = 0; i &lt; numReplicasWanted; i++) {
&gt; &gt; &gt; &gt; &gt; &gt; bucket.store(&quot;key&quot;, &quot;value&quot;).withoutFetch().execute();
&gt; &gt; &gt; &gt; &gt; &gt; }
&gt; &gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &gt; :)
&gt; &gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &gt; - Roach
&gt; &gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; &gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; &gt; &gt; &gt; riak-users@lists.basho.com (<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>)
&gt; &gt; &gt; &gt; &gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a> 
&gt; &gt; &gt; &gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; &gt; &gt; riak-users@lists.basho.com (<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>)
&gt; &gt; &gt; &gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt;  
&gt; &gt; &gt; &gt; _______________________________________________
&gt; &gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; &gt; riak-users@lists.basho.com (<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>)
&gt; &gt; &gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; &gt; &gt;  
&gt; &gt;  
&gt; &gt;  
&gt; &gt;  
&gt; &gt;  
&gt; &gt; --  
&gt; &gt; Med Vennlig Hilsen
&gt; &gt; Olav Frengstad
&gt; &gt;  
&gt; &gt; Systemutvikler // FWT
&gt; &gt; +47 920 42 090
&gt;  
&gt;  
&gt;  
&gt;  
&gt;  
&gt;  
&gt; --  
&gt; Med Vennlig Hilsen
&gt; Olav Frengstad
&gt;  
&gt; Systemutvikler // FWT
&gt; +47 920 42 090
&gt;  
&gt;  
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>)
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>




_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12966.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd7.html#12968">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail7.html#12968">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12969.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12895.html">Forcing Siblings to Occur</a></span> <span class="sender italic">Mark A. Basil, Jr.</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12896.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">John Daily</span></li>
<li class="icons-email"><span class="subject"><a href="msg12897.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12899.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Brian Roach</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12951.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12952.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12963.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Jason Campbell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12964.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">John Daily</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12965.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li class="icons-email"><span class="subject"><a href="msg12966.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Forcing Siblings to O...</span> <span class="sender italic">Sam Elliott</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg12969.html">Re: Forcing Siblings to Occur</a></span> <span class="sender italic">Carlos Baquero</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12970.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Russell Brown</span></li>
<li class="icons-email"><span class="subject"><a href="msg12971.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Hector Castro</span></li>
<li class="icons-email"><span class="subject"><a href="msg12973.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Olav Frengstad</span></li>
<li class="icons-email"><span class="subject"><a href="msg12975.html">Re: Forcing Siblings to O...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Forcing Siblings to Occur">
<input type="hidden" name="msgid" value="D0CB93B5EB4447CD91B7B9499ABB3B90@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12968.html">
<input type="submit" value=" Sam Elliott ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Forcing+Siblings+to+Occur%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12966.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12969.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">D0CB93B5EB4447CD91B7B9499ABB3B90@basho.com</li>
</ul>
</div>
</body>
</html>
