<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Cluster restarted and doesn’t respond	to queries</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd5.html#13328" id="c">
<link rel="index" href="mail5.html#13328" id="i">
<link rel="prev" href="msg13327.html" id="p">
<link rel="next" href="msg13329.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg13328.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Cluster+restarted+and+doesn%E2%80%99t+respond%09to+queries%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Cluster restarted and doesn’t respond	to queries</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Brian+Sparrow%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Brian Sparrow</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131223" rel="nofollow">Mon, 23 Dec 2013 10:43:04 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Just jumping in:  
 The issue is here: {&lt;&lt;&quot;bitcask_mult&quot;&gt;&gt;,  riak_kv_bitcask_backend, [
                                                                            
{data_root, &quot;./data/leveldb”}</pre><pre>

The reason riak-admin test works is it uses the default backend in the case of 
multi-backend. Based on your config this is the eleveldb backend which already 
owns these directories and had no issue starting up. This should probably be 
checked during riak start as backend should *never* share a data_root.

If you wouldn’t mind making an issue against the riak repo with the details of 
your problem we can work out the best way to check this on startup.

The mitigation is to shut the node down, change the bitcask_mult data_root to 
the correct entry and restart.

Thanks!  

--  
Brian Sparrow
Developer Advocate
Basho Technologies

Sent with Sparrow (<a  rel="nofollow" href="http://www.sparrowmailapp.com/?sig">http://www.sparrowmailapp.com/?sig</a>)


On Monday, December 23, 2013 at 1:37 PM, Justin Lambert wrote:

&gt; Attached is my app.config.  It is managed by puppet so I don’t think it 
&gt; changed at all.  Again, this was just a Centos 6.4 -&gt; CentOS 6.5 upgrade - 
&gt; the riak package wasn’t touched at all.
&gt;  
&gt; Any thought as to why riak-admin test works but just getting a key with curl 
&gt; never returns?
&gt;  
&gt;  
&gt; On Mon, Dec 23, 2013 at 10:44 AM, Ryan Zezeski &lt;rzeze...@basho.com 
&gt; (<a  rel="nofollow" href="mailto:rzeze...@basho.com">mailto:rzeze...@basho.com</a>)&gt; wrote:
&gt; &gt;  
&gt; &gt; On Mon, Dec 23, 2013 at 12:35 PM, Justin Lambert &lt;jlamb...@letsevenup.com 
&gt; &gt; (<a  rel="nofollow" href="mailto:jlamb...@letsevenup.com">mailto:jlamb...@letsevenup.com</a>)&gt; wrote:
&gt; &gt; &gt;  
&gt; &gt; &gt; I do see some errors in the error.log, but the referenced directories 
&gt; &gt; &gt; don’t appear to exist:  
&gt; &gt; &gt; 2013-12-23 16:52:33.290 [error] 
&gt; &gt; &gt; &lt;0.1721.0&gt;@riak_kv_bitcask_backend:move_unused_dirs:607 Failed to move 
&gt; &gt; &gt; unused data directory 
&gt; &gt; &gt; &quot;./data/leveldb/388211372416021087647853783690262677096107081728&quot;. 
&gt; &gt; &gt; Reason: eexist
&gt; &gt; &gt;  
&gt; &gt;  
&gt; &gt; This error is interesting. It is coming from the bitcask backend but trying 
&gt; &gt; to read a leveldb directory. My guess is something happened with your 
&gt; &gt; configuration when you upgraded. What does your app.config look like?  
&gt; &gt;  
&gt; &gt; -Z
&gt;  
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>)
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;  
&gt;  
&gt;  
&gt;  
&gt; Attachments:  
&gt; - app.config
&gt;  


</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg13327.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd5.html#13328">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail5.html#13328">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg13329.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg13324.html">Cluster restarted and doesn’t respond to queries</a></span> <span class="sender italic">Justin Lambert</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13325.html">Re: Cluster restarted and doesn’t respond to queries</a></span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13326.html">Re: Cluster restarted and doesn’t respond to queri...</a></span> <span class="sender italic">Justin Lambert</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13327.html">Re: Cluster restarted and doesn’t respond to q...</a></span> <span class="sender italic">John Daily</span></li>
<li class="icons-email tSliceCur"><span class="subject">Re: Cluster restarted and doesn’t respond	to q...</span> <span class="sender italic">Brian Sparrow</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13329.html">Re: Cluster restarted and doesn’t respond ...</a></span> <span class="sender italic">Justin Lambert</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg13330.html">Re: Cluster restarted and doesn’t res...</a></span> <span class="sender italic">Brian Sparrow</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Cluster restarted and doesn’t respond	to queries">
<input type="hidden" name="msgid" value="4B5C172FD0EB4D3D9E105716B727F04E@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg13328.html">
<input type="submit" value=" Brian Sparrow ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Cluster+restarted+and+doesn%E2%80%99t+respond%09to+queries%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg13327.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg13329.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">4B5C172FD0EB4D3D9E105716B727F04E@basho.com</li>
</ul>
</div>
</body>
</html>
