<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Score for each search</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04242" id="c">
<link rel="index" href="maillist.html#04242" id="i">
<link rel="prev" href="msg04241.html" id="p">
<link rel="next" href="msg04044.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04242.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Score+for+each+search%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Score for each search</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Archana+Bhattarai%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Archana Bhattarai</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110805" rel="nofollow">Fri, 05 Aug 2011 08:58:18 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Rusty,

Thanks for the answer.</pre><pre>

We have indexed the following json object:


{
    &quot;@class&quot;: &quot;com.starsite.data.Answer&quot;,
    &quot;answer_text&quot;: &quot;momo is the best nepalese food&quot;,
    &quot;keywords&quot;: null,
    &quot;metaDescription&quot;: null,
    &quot;post_date&quot;: null,
    &quot;id&quot;: &quot;202ba4ac-0fd3-4709-ba84-463e0caa413c&quot;,
    &quot;version&quot;: 1,
    &quot;scope&quot;: [
        &quot;type|com.starsite.data.Answer&quot;
    ]
}

we issued the following query:

answer_text: &quot;food&quot;

and the data we got in keydata was as follows:

[{&quot;p&quot;:[4,0],&quot;score&quot;:[4.855199135883779,1.8398742574541822]}]


What does 0-indexing mean ? If the scoring in riak-search is done based on 
vector-space model like in lucene, I was expecting the scores to be normalized 
between 0 and 1.

In case of position information, I assume the words 'is' and 'the' are removed 
as part of stopwords removal. If they're not removed the position should have 
been 5. If they are removed, the position should have been 3. The word &quot;food&quot; 
occurs only once. Shouldn't we be getting just one position ?

Thanks,
Archana



On Aug 5, 2011, at 11:08 AM, Rusty Klophaus wrote:

Hi Archana,

Yes, the 'p' attribute is positional information. That list is indicating that 
the term occurs on the 0th and 43rd positions in the document, and is 
0-indexed. Not sure why you are getting two positions if the word only occurred 
once. What was the original query?

The scoring information that you see is a bug. For now, as a workaround, you 
can add the scores together. This will give you a *relative* score, allowing 
you to rank results for the current query.

To fix this issue, some processing needs to happen within riak to combine and 
normalize the scores into a final score that can be used for correct ranking 
against other queries as well. (This is being done for the Solr interface, but 
not the Map/Reduce interface.) Riak Search models scoring after Lucene as much 
as possible, so you can read this for more information about scoring, 
especially the final normalization step: 
<a  rel="nofollow" href="http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/Similarity.html">http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/Similarity.html</a>

This issue is tracked in <a  rel="nofollow" href="https://issues.basho.com/show_bug.cgi?id=1154">https://issues.basho.com/show_bug.cgi?id=1154</a>

Best,
Rusty


On Thu, Aug 4, 2011 at 3:27 PM, Archana Bhattarai 
&lt;abhatta...@sharecare.com&lt;<a  rel="nofollow" href="mailto:abhatta...@sharecare.com">mailto:abhatta...@sharecare.com</a>&gt;&gt; wrote:
Hi Rusty,

Thanks a lot for the answer. We could get some data in the keydata  as follows:


[{&quot;p&quot;:[43,0],&quot;score&quot;:[5.3669048584479,1.7201627119528418]}

But couldn't exactly interpret what it's representing. I believe p is giving 
positional information. But why is it two dimensional when the word we searched 
only occurred once in the document. Does the position ignore stopword positions 
and just count other words? Also why are there two scores ? Isn't the score 
normalized ? Or am I doing something wrong to get these scores ?


Thanks a lot in advance,
Archana


On Jul 22, 2011, at 11:09 AM, Rusty Klophaus wrote:

Hi Archana,

Yes. When you use a search query to initiate a map/reduce job, the scores are 
fed into the first phase as keydata, along with other metadata about the search 
result including positional information and any inline fields.

More information in the links below:

 *   
<a  rel="nofollow" href="http://wiki.basho.com/Riak-Search---Querying.html#Querying-Integrated-with-Map-Reduce">http://wiki.basho.com/Riak-Search---Querying.html#Querying-Integrated-with-Map-Reduce</a>
 *   <a  rel="nofollow" href="http://wiki.basho.com/MapReduce.html">http://wiki.basho.com/MapReduce.html</a> (search for &quot;keydata&quot;)

Best,
Rusty

On Fri, Jul 22, 2011 at 10:53 AM, Archana Bhattarai 
&lt;abhatta...@sharecare.com&lt;<a  rel="nofollow" href="mailto:abhatta...@sharecare.com">mailto:abhatta...@sharecare.com</a>&gt;&gt; wrote:
Hi,

Is there a way to get back the score while querying via solr interface or 
ideally mapreduce over search ? It looks like solr interface only supports 
sorting.


Thanks in advance,
Archana
_______________________________________________
riak-users mailing list
riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>



--
Rusty Klophaus

Basho Technologies, Inc.
11921 Freedom Drive, Suite 550
Reston, VA 20190
www.basho.com&lt;<a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>&gt;





_______________________________________________
riak-users mailing list
riak-users@lists.basho.com&lt;<a  rel="nofollow" href="mailto:riak-users@lists.basho.com">mailto:riak-users@lists.basho.com</a>&gt;
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>




--
Rusty Klophaus

Basho Technologies, Inc.
11921 Freedom Drive, Suite 550
Reston, VA 20190
www.basho.com&lt;<a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>&gt;



</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04241.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04242">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04242">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04044.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg04042.html">Score for each search</a></span> <span class="sender italic">Archana Bhattarai</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04043.html">Re: Score for each search</a></span> <span class="sender italic">Rusty Klophaus</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04233.html">Re: Score for each search</a></span> <span class="sender italic">Archana Bhattarai</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04241.html">Re: Score for each search</a></span> <span class="sender italic">Rusty Klophaus</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Score for each search</span> <span class="sender italic">Archana Bhattarai</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Score for each search">
<input type="hidden" name="msgid" value="EA02C8B3-23EF-4D52-99D8-329064C46271@sharecare.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04242.html">
<input type="submit" value=" Archana Bhattarai ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Score+for+each+search%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04241.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04044.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">EA02C8B3-23EF-4D52-99D8-329064C46271@sharecare.com</li>
</ul>
</div>
</body>
</html>
