<!DOCTYPE html>
<html lang="en">
<head>
<title>Connection Pooling with the python-riak-client</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06342" id="c">
<link rel="index" href="maillist.html#06342" id="i">
<link rel="prev" href="msg06334.html" id="p">
<link rel="next" href="msg06343.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06342.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Connection+Pooling+with+the+python%5C-riak%5C-client%22&amp;o=newest" rel="nofollow"><span itemprop="name">Connection Pooling with the python-riak-client</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Michael+Clemmons%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Michael Clemmons</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120120" rel="nofollow">Fri, 20 Jan 2012 12:54:07 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hey All,
FIrst time on the list, so go easy.  I've been working with the
python-riak-client for a while and one of the biggest blockers has been its
lack of connection pooling.  Until recently the fork maintained at
<a  rel="nofollow" href="https://github.com/bretthoerner/riak-python-client">https://github.com/bretthoerner/riak-python-client</a> has been sufficient for
my needs.  I'd been merging it in with the master branch privately up until
December.
I've decided to go back and cleanup that approach and reapply it to the
current master branch.  To my surprise I found that the ConnectionManager
supports multiple connections and has the tools to add and remove them.
Looking at the simple case of the RiakHttpTransport layer and the
http_request method it looks like it should grab a new connection(or an old
one) and try it and if it fails move on to the next putting the host port
pair at the bottom of the list.
So it looked like all I needed to do was update the client code to accept a
list of hostport pairs and it would just work, which sounded too easy to be
true.  I tested it anyways and if I use one hostport that is a working riak
node it connects and everything works.  If I include 2 nodes one working
and one a random port it fails no matter the order.  So its not just trying
to connect to the first and failing its connecting to them all and failing
if any fail.
Anyone have any idea of why its built this way and what other solutions
people have worked out on their own?  My intent is to do this so it merges
cleanly with the current master, and doesn't introduce unnecessary change,
to increase the likelyhood of a successful pull request.
-Michael
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06334.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06342">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06342">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06343.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Connection Pooling with the python-riak-client</span> <span class="sender italic">Michael Clemmons</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06343.html">Re: Connection Pooling with the python-riak-client</a></span> <span class="sender italic">Shuhao Wu</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06344.html">Re: Connection Pooling with the python-riak-clie...</a></span> <span class="sender italic">Sean Cribbs</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg06383.html">Re: Connection Pooling with the python-riak-client</a></span> <span class="sender italic">Greg Stein</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06389.html">Re: Connection Pooling with the python-riak-clie...</a></span> <span class="sender italic">Michael Clemmons</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06391.html">Re: Connection Pooling with the python-riak-...</a></span> <span class="sender italic">Greg Stein</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06393.html">Re: Connection Pooling with the python-r...</a></span> <span class="sender italic">Michael Clemmons</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Connection Pooling with the python-riak-client">
<input type="hidden" name="msgid" value="CABfaNM5Qpo3V7G1seNLyjQAO4ybQ1uxAzcg7LW19eygp2QfivA@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06342.html">
<input type="submit" value=" Michael Clemmons ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Connection+Pooling+with+the+python%5C-riak%5C-client%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06334.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06343.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CABfaNM5Qpo3V7G1seNLyjQAO4ybQ1uxAzcg7LW19eygp2QfivA@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
