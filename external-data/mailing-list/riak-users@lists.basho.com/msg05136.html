<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Secondary index scalability</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#05136" id="c">
<link rel="index" href="maillist.html#05136" id="i">
<link rel="prev" href="msg05126.html" id="p">
<link rel="next" href="msg05135.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg05136.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Secondary+index+scalability%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Secondary index scalability</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Rusty+Klophaus%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Rusty Klophaus</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20111012" rel="nofollow">Wed, 12 Oct 2011 07:03:55 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Nate,

No, Secondary Indexes doesn't attempt to cluster index integer keys. Since
Secondary Indexes uses document-partitioning, only the *document* key (and
not the *index* key) has any bearing on where the data lives.</pre><pre>

As Sean mentioned, the other approach is to use term-partitioning, where the
index key determines how the index data is partitioned. In the case of Riak
Search, which uses term-partitioning, we still hash the index key, and don't
make any attempt to cluster nearby integer keys on the same partition. The
reason is that once you begin clustering keys, then you need to understand
something about the underlying data being represented. Consider, for
example, an index on birth month and an index on shoe size. The month would
be in the range of 1 to 12 with an even distribution, while the shoe size
(in the US) would be in the range of 0 to 15, with a normal distribution
centered around 9 or 10. To spread the index evenly across all partitions,
the system would need to know the upper and lower bounds and the
distribution of values in advance.

Best,
Rusty

On Tue, Oct 11, 2011 at 5:29 PM, Nate Lawson &lt;n...@root.org&gt; wrote:

&gt; A related question -- does the secondary index implementation make some
&gt; attempt to cluster &quot;nearby&quot; integer keys for range queries? In other words,
&gt; if I have an integer secondary index on a set of keys, is this taken into
&gt; account in the partition function?
&gt;
&gt; Since you have to query the full covering set anyway to get all the
&gt; results, I'm not sure how much of an advantage this would be and the
&gt; complexity tradeoff. I'm just wondering if reducing the covering set size
&gt; based on secondary index would be useful for some.
&gt;
&gt; -Nate
&gt;
&gt; On Oct 10, 2011, at 7:09 AM, Sean Cribbs wrote:
&gt;
&gt; &gt; 1. The design of secondary indexes is based on &quot;document partitioning&quot;,
&gt; which makes it very simple to keep indexes consistent with the objects they
&gt; reference, but does mean that queries will have to communicate with a
&gt; &quot;covering set&quot; of partitions, more or less (Ring Size / N) of them.  This
&gt; design is the dual of Riak Search's design, or &quot;term partitioning&quot;, which
&gt; only requires one partition to respond for a given index/field/term, but can
&gt; be prone to hotspots.
&gt; &gt;
&gt; &gt; I do not know of any comparisons to Cassandra's secondary index feature.
&gt; &gt;
&gt; &gt; 2. See #1. It is stored in the same place as the objects themselves,
&gt; which means queries need to contact many partitions.
&gt; &gt;
&gt; &gt; On Mon, Oct 10, 2011 at 4:56 AM, OZAWA Tsuyoshi &lt;
&gt; ozawa.tsuyo...@gmail.com&gt; wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I have 2 questions about the riak's new feature - secondary index.
&gt; &gt;
&gt; &gt; 1. Is there the scalability benchmark of the secondary index feature? I
&gt; &gt; read some blog about the implementation of riak secondary index, but it
&gt; &gt; seems to run scanning across mostly all nodes at worst case if my
&gt; &gt; expectation is correct. Secondary index feature of riak is more scalable
&gt; &gt; than the one of Cassandra?
&gt; &gt;
&gt; &gt; 2. Where is the metadata which the nodes contain the indexed data? Is it
&gt; &gt; distributed across riak storage servers by consistent hashing?
&gt; &gt;
&gt; &gt; Thank you.
&gt; &gt;
&gt; &gt; Best Regards,
&gt; &gt; OZAWA Tsuyoshi
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Sean Cribbs &lt;s...@basho.com&gt;
&gt; &gt; Developer Advocate
&gt; &gt; Basho Technologies, Inc.
&gt; &gt; <a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>
&gt; &gt;
&gt; &gt; _______________________________________________
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;



-- 
Rusty Klophaus

*Basho Technologies, Inc.*
11921 Freedom Drive, Suite 550
Reston, VA 20190
www.basho.com
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg05126.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#05136">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#05136">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg05135.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg05111.html">Secondary index scalability</a></span> <span class="sender italic">OZAWA Tsuyoshi</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05112.html">Re: Secondary index scalability</a></span> <span class="sender italic">Sean Cribbs</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg05126.html">Re: Secondary index scalability</a></span> <span class="sender italic">Nate Lawson</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Secondary index scalability</span> <span class="sender italic">Rusty Klophaus</span></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg05135.html">Re: Secondary index scalability</a></span> <span class="sender italic">OZAWA Tsuyoshi</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Secondary index scalability">
<input type="hidden" name="msgid" value="CAOr2nz6JsJo9RP44wD=pQ_GMU0ep=5G+SNbQR1533BCnBenrSQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg05136.html">
<input type="submit" value=" Rusty Klophaus ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Secondary+index+scalability%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg05126.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg05135.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAOr2nz6JsJo9RP44wD=pQ_GMU0ep=5G+SNbQR1533BCnBenrSQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
