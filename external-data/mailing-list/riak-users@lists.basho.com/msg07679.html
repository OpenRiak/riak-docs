<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: [error] Supervisor riak_pipe_vnode_worker_sup had child undefined	started with ...</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#07679" id="c">
<link rel="index" href="maillist.html#07679" id="i">
<link rel="prev" href="msg07653.html" id="p">
<link rel="next" href="msg07629.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg07679.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+%5C%5Berror%5C%5D+Supervisor+riak_pipe_vnode_worker_sup+had+child+undefined%09started+with+...%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: [error] Supervisor riak_pipe_vnode_worker_sup had child undefined	started with ...</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Ivaylo+Panitchkov%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ivaylo Panitchkov</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120613" rel="nofollow">Wed, 13 Jun 2012 12:04:08 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre style="margin: 0em;">

Hi Mark,</pre><pre>

</pre><tt>I resized the cluster from 4x1GB RAM to 4x4GB RAM. Also increased 
</tt><tt>{map_js_vm_count, 8 } to {map_js_vm_count, 48 } and {reduce_js_vm_count, 
</tt><tt>6 } to {reduce_js_vm_count, 36 } inside app.config but still have the 
</tt><tt>same problem from time to time...
</tt><pre style="margin: 0em;">

The function I use to do the link-walking call is below:

/**
</pre><tt> * Fetches all user artifacts using link walking and returns them in 
</tt><tt>the callback
</tt><pre style="margin: 0em;">
 *
 * @param id - unique user id
 * @param cb
 * @return - an array of user artifacts
 */
fetchUserArtifacts = function(id, cb) {
    riakwalk(config.CONCRETESBUCKET, id, [
        [config.ARTIFACTSBUCKET, 'artifacts', '_']
    ], function(user_artifacts) {
        if(user_artifacts.length) {
</pre><tt>            // the first element in the result holds all links, so we 
</tt><tt>will skip it
</tt><pre style="margin: 0em;">
            cb(user_artifacts[1]);
        }
        else {
            cb([]);
        }
    });
};

</pre><tt>As you could see it's a simple query fetching 50-150 small objects. The 
</tt><tt>cluster is almost idle so it should be able to serve the request. I had 
</tt><tt>similar problem awhile ago and decided to fetch objects one by one 
</tt><tt>instead of using link-walking and that patch did the trick. The 
</tt><tt>performance degraded slightly but at least worked all the time. For the 
</tt><tt>case mentioned here I just created a non link-walking version that 
</tt><tt>fetches 150 objects for about a second which is acceptable. Will 
</tt><tt>investigate further when I have time :-)
</tt><pre style="margin: 0em;">

Ivaylo



On 12-06-10 05:20 PM, Mark Phillips wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Hi Ivaylo,

Take a look at this thread:

<a  rel="nofollow" href="http://riak.markmail.org/search/?q=exit%20with%20reason%20fitting_died%20in%20context%20child_terminated#query:exit%20with%20reason%20fitting_died%20in%20context%20child_terminated+page:1+mid:n4gfl43hcvzthjl7+state:results">http://riak.markmail.org/search/?q=exit%20with%20reason%20fitting_died%20in%20context%20child_terminated#query:exit%20with%20reason%20fitting_died%20in%20context%20child_terminated+page:1+mid:n4gfl43hcvzthjl7+state:results</a>

</pre><tt>I think this is what you're seeing. You should read the entire message 
</tt><tt>I linked to, but the important thing is that the reason you're seeing 
</tt><tt>the &quot;fitting_died in context child_terminated&quot; logs is due to a 
</tt><tt>timeout with a Riak Pipe-based M/R process. To paraphrase Bryan Fink, 
</tt><tt>those messages are normal and intended to help debug issues. Are you 
</tt><tt>still seeing them?
</tt><pre style="margin: 0em;">

</pre><tt>I would be interested to know what type of MapReduce load you're 
</tt><tt>putting on your cluster. &quot;4 machines x 1GB RAM&quot; isn't a very powerful 
</tt><tt>cluster and MapReduce jobs (especially those written in java script) 
</tt><tt>can tax Riak nodes significantly. Anything details you can share?
</tt><pre style="margin: 0em;">

Mark



</pre><tt>On Wed, Jun 6, 2012 at 4:38 PM, Ivaylo Panitchkov 
</tt><tt>&lt;ipanitch...@hibernum.com &lt;<a  rel="nofollow" href="mailto:ipanitch...@hibernum.com">mailto:ipanitch...@hibernum.com</a>&gt;&gt; wrote:
</tt><pre style="margin: 0em;">


    Hello everyone,

    We started getting the following errors on all servers in the
    cluster (4 machines x 1GB RAM, riak_1.0.2-1_amd64.deb):

    20:12:36.753 [error] Supervisor riak_pipe_vnode_worker_sup had
    child undefined started with
    {riak_pipe_vnode_worker,start_link,undefined} at &lt;0.8855.0&gt; exit
    with reason fitting_died in context child_terminated
    20:12:36.754 [error] Supervisor riak_pipe_vnode_worker_sup had
    child undefined started with
    {riak_pipe_vnode_worker,start_link,undefined} at &lt;0.8856.0&gt; exit
    with reason fitting_died in context child_terminated
    20:12:36.965 [error] Supervisor riak_pipe_vnode_worker_sup had
    child undefined started with
    {riak_pipe_vnode_worker,start_link,undefined} at &lt;0.8860.0&gt; exit
    with reason fitting_died in context child_terminated
    20:12:36.967 [error] Supervisor riak_pipe_vnode_worker_sup had
    child undefined started with
    {riak_pipe_vnode_worker,start_link,undefined} at &lt;0.8861.0&gt; exit
    with reason fitting_died in context child_terminated


    If we restart the riak service on all machines one by one the
    error message disappears for a while.
    Any ideas to solve the issue will be much appreciated.

    Thanks in advance,
    Ivaylo

    REMARK: Replaced the IP addresses for security sake

    *root@riak01:~# riak-admin member_status*
    Attempting to restart script through sudo -u riak
    ================================= Membership
    ==================================
    Status     Ring    Pending    Node
    
-------------------------------------------------------------------------------
    valid      25.0%      --      'riak@IP1'
    valid      25.0%      --      'riak@IP2'
    valid      25.0%      --      'riak@IP3'
    valid      25.0%      --      'riak@IP4'
    
-------------------------------------------------------------------------------
    Valid:4 / Leaving:0 / Exiting:0 / Joining:0 / Down:0

    *root@riak01:~# riak-admin ring_status*
    Attempting to restart script through sudo -u riak
    ================================== Claimant
    ===================================
    Claimant:  'riak@IP1'
    Status:     up
    Ring Ready: true

    ============================== Ownership Handoff
    ==============================
    No pending changes.

    ============================== Unreachable Nodes
    ==============================
    All nodes are up and reachable

    *root@riak01:~# riak-admin ringready*
    Attempting to restart script through sudo -u riak
    TRUE All nodes agree on the ring
    ['riak@IP1','riak@IP2','riak@IP3','riak@IP4']

    *root@riak01:~# riak-admin transfers*
    Attempting to restart script through sudo -u riak
    No transfers active

</pre></blockquote><pre style="margin: 0em;">

--
Ivaylo Panitchkov
Software developer
Hibernum Creations Inc.

Ce courriel est confidentiel et peut aussi être protégé par la loi.Si vous avez 
reçu ce courriel par erreur, veuillez nous en aviser immédiatement en y 
répondant, puis supprimer ce message de votre système. Veuillez ne pas le 
copier, l’utiliser pour quelque raison que ce soit ni divulguer son contenu à 
quiconque.
This email is confidential and may also be legally privileged. If you have 
received this email in error, please notify us immediately by reply email and 
then delete this message from your system. Please do not copy it or use it for 
any purpose or disclose its content.

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg07653.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#07679">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#07679">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg07629.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg07628.html">[error] Supervisor riak_pipe_vnode_worker_sup had child ...</a></span> <span class="sender italic">Ivaylo Panitchkov</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg07653.html">Re: [error] Supervisor riak_pipe_vnode_worker_sup h...</a></span> <span class="sender italic">Mark Phillips</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: [error] Supervisor riak_pipe_vnode_worker_s...</span> <span class="sender italic">Ivaylo Panitchkov</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: [error] Supervisor riak_pipe_vnode_worker_sup had child undefined	started with ...">
<input type="hidden" name="msgid" value="4FD8E41D.9080300@hibernum.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg07679.html">
<input type="submit" value=" Ivaylo Panitchkov ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+%5C%5Berror%5C%5D+Supervisor+riak_pipe_vnode_worker_sup+had+child+undefined%09started+with+...%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg07653.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg07629.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">4FD8E41D.9080300@hibernum.com</li>
</ul>
</div>
</body>
</html>
