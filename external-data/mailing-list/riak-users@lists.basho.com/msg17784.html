<!DOCTYPE html>
<html lang="en">
<head>
<title>Java client -- slow to shutdown</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#17784" id="c">
<link rel="index" href="maillist.html#17784" id="i">
<link rel="prev" href="msg17779.html" id="p">
<link rel="next" href="msg17785.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg17784.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Java+client+%5C-%5C-+slow+to+shutdown%22&amp;o=newest" rel="nofollow"><span itemprop="name">Java client -- slow to shutdown</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Toby+Corkindale%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Toby Corkindale</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20161123" rel="nofollow">Wed, 23 Nov 2016 22:00:07 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi,
I'm using the Java client via protocol buffers to Riak.
(Actually I'm using it via Scala 2.11.8 on OpenJDK 8)</pre><pre>

After calling client.shutdown(), there is always a delay of 4 seconds
before the app actually exits. Why is this, and what can I do about it?

To demonstrate the issue, use these files:
<a  rel="nofollow" href="https://gist.github.com/TJC/9a6a174cb1419a7c32e8018c5a495e3d">https://gist.github.com/TJC/9a6a174cb1419a7c32e8018c5a495e3d</a>

If you put both of them in a fresh directory and then run &quot;sbt&quot;, it should
grab various dependencies and stuff, and then you can use &quot;compile&quot; and
&quot;run&quot; commands.
(You'll need to do &quot;export RIAK_SERVER=my.riak.cluster.net&quot; in the shell
before you run sbt)

If you do &quot;run&quot; a few times, you'll see it always takes four seconds to get
back to the sbt prompt. If you comment out the two riak statements in the
source code (the connection and shutdown), then &quot;run&quot; a few times, it takes
zero seconds.

I've tested this outside of sbt and the same issue exists.. it's just
easier to make a quick demo that works inside sbt.

Also reported as <a  rel="nofollow" href="https://github.com/basho/riak-java-client/issues/689">https://github.com/basho/riak-java-client/issues/689</a>

Cheers
Toby
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg17779.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#17784">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#17784">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg17785.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Java client -- slow to shutdown</span> <span class="sender italic">Toby Corkindale</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg17785.html">Re: Java client -- slow to shutdown</a></span> <span class="sender italic">Luke Bakken</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Java client -- slow to shutdown">
<input type="hidden" name="msgid" value="CABEgq940vUpnEx2348vr4gCJA9Hyhaza6QzHqM8bwtWY54gneQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg17784.html">
<input type="submit" value=" Toby Corkindale ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Java+client+%5C-%5C-+slow+to+shutdown%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg17779.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg17785.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CABEgq940vUpnEx2348vr4gCJA9Hyhaza6QzHqM8bwtWY54gneQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
