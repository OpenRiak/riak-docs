<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak over "LAN" vs "WAN"</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09349" id="c">
<link rel="index" href="maillist.html#09349" id="i">
<link rel="prev" href="msg09345.html" id="p">
<link rel="next" href="msg09350.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09349.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+over+%5C%22LAN%5C%22+vs+%5C%22WAN%5C%22%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak over "LAN" vs "WAN"</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Ryan+Zezeski%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ryan Zezeski</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121119" rel="nofollow">Mon, 19 Nov 2012 07:47:30 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Jon,

On Mon, Nov 19, 2012 at 3:28 AM, Jon Perez &lt;jbperez...@yahoo.com&gt; wrote:
&gt;
&gt;
&gt; Why exactly are these reasons?  I suspect they have to do with performance.
&gt; If so, how exactly does performance degrade when nodes are spread out
&gt; between hosts with latencies in the tens to hundred plus milliseconds (as
&gt; is
&gt; typical over WANs)?
&gt;</pre><pre>

Yes, latency is a big reason.  Every Riak requests involves N vnodes.  If
those vnodes are spread across different regions with varying latencies
then your deviation grows and higher percentiles go through the roof.  For
some this many be okay, but the wider you go the more unpredictable your
latency profile becomes.  Predictable latency is key to many applications
built on top of Riak.  Many of these apps are web-apps with tight
constraints of the maximum time any request should take.  Given that most
webapps are made up of many components behind the scenes it is vital the
each individual component deliver as predictably as possible so that the
developers can have some confidence on the end-to-end latency of a request.
 This is a point made very clear in the Dynamo paper which heavily
influenced the design of Riak.


&gt; Or does it have more to do with reliability of connections and overhead in
&gt; retrying them?  I can understand that Bashio has a vested interest in
&gt; promoting Riak Enterprise for this, but it would be nice if the technical
&gt; details of why were actually laid out in detail.
&gt;

This is another reason.  A node that is dead is indistinguishable from a
node that is simply taking a really long time to respond.  Once you spread
nodes across a WAN the chance for network failure, and thus network
partitions, becomes much greater.  Riak is designed to always be available
for writes but you still want to avoid partitions as much as possible.
 Partitions are one of the primary causes of siblings, potentially
generating lots of sibling resolution.  Partitions also cause additional
load to be placed on the nodes.  Say you had a 6-node cluster configured as
2 3-node clusters in different data centers.  If the link between the data
centers goes down or becomes too slow you'd end up with a partition between
the 2 3-node clusters and each would have to take on the load that was
being served by the 6-node cluster.  This includes things like disk space,
file descriptors, open ports, memory usage, CPU usage, network utilization,
etc.



&gt; From my limited experience with Riak, getting multiple nodes within a
&gt; cluster going is extremely simple, whereas going multiple clusters is a
&gt; very
&gt; different story and requires a new layer of understanding.  It's too bad
&gt; that there is a distinction between nodes over &quot;WANs&quot; and &quot;LANs&quot;.  I guess
&gt; the holy grail of dbs is still some ways off, although Riak seems to be the
&gt; closest fit right now.
&gt;


The way Riak is designed is far from the most efficient way to replicate
data across a WAN.  A lot of that code was/is written with assumptions of
LAN and fairly predictable latency.  This is one of the reasons we have a
separate piece of software that performs this task.  This problem is not as
easy as some people think.  You should checkout Andrew Thompson's RICON
talk on Riak's WAN replication.

<a  rel="nofollow" href="http://vimeo.com/52016325">http://vimeo.com/52016325</a>

-Z
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09345.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09349">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09349">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09350.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg09345.html">Riak over &quot;LAN&quot; vs &quot;WAN&quot;</a></span> <span class="sender italic">Jon Perez</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak over &quot;LAN&quot; vs &quot;WAN&quot;</span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09350.html">Re: Riak over &quot;LAN&quot; vs &quot;WAN&quot;</a></span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg09370.html">Re: Riak over &quot;LAN&quot; vs &quot;WAN&quot;</a></span> <span class="sender italic">Jon Perez</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak over &quot;LAN&quot; vs &quot;WAN&quot;">
<input type="hidden" name="msgid" value="CACZcpe=KWT17rCrr_-gKnoeD_cVksWAPG9DKpYzT9vagD=VV3w@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09349.html">
<input type="submit" value=" Ryan Zezeski ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+over+%5C%22LAN%5C%22+vs+%5C%22WAN%5C%22%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09345.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09350.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACZcpe=KWT17rCrr_-gKnoeD_cVksWAPG9DKpYzT9vagD=VV3w@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
