<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Nodes missing primary partitions</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06626" id="c">
<link rel="index" href="maillist.html#06626" id="i">
<link rel="prev" href="msg06625.html" id="p">
<link rel="next" href="msg06628.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06626.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Nodes+missing+primary+partitions%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Nodes missing primary partitions</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Anthony+Molinaro%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Anthony Molinaro</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120216" rel="nofollow">Thu, 16 Feb 2012 18:20:42 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>No that's the only error.  It may be that there were older errors which rolled 
out but I would expect a rolling restart would result in at least new errors 
but no.  It's been 30 hours or so since the restart and still the same output 
from riak-admin transfers</pre><pre>

I guess I might be able to stop all the nodes but I hate to do that as it 
degrades my service but I can only assume its already degraded?

Is there functions I could run while attached to get more information?

-Anthony

On Feb 16, 2012, at 2:21 PM, Joseph Blomstedt &lt;j...@basho.com&gt; wrote:

&gt; Anthony,
&gt; 
&gt; The primary partition warning suggests that a vnode that should be
&gt; running on your node is not running. After a restart, all primary
&gt; vnodes are started, which is why the primary warning goes away.
&gt; However, the fact that the warning re-appears is unexpected. The
&gt; handoff receiver errors also suggests that a vnode that was running
&gt; (and receiving handoff data) suddenly shutdown. This is likely the
&gt; same vnode.
&gt; 
&gt; Are there any other details in your logs that would indicate why a
&gt; vnode is shutting down and/or crashing? Any messages about issues
&gt; reading in the Bitcask data for any vnodes?
&gt; 
&gt; -Joe
&gt; 
&gt; On Wed, Feb 15, 2012 at 12:30 PM, Anthony Molinaro
&gt; &lt;antho...@alumni.caltech.edu&gt; wrote:
&gt;&gt; Hi,
&gt;&gt; 
&gt;&gt; I have a 12 node riak cluster running riak 0.14.2.  I had several nodes
&gt;&gt; crash with OOM errors, and after restarting them I see the following when
&gt;&gt; running riak-admin transfers
&gt;&gt; 
&gt;&gt; Attempting to restart script through sudo -u riak
&gt;&gt; 'riak@10.5.11.39' waiting to handoff 1 partitions
&gt;&gt; 'riak@10.5.11.39' does not have 1 primary partitions running
&gt;&gt; 'riak@10.5.11.37' waiting to handoff 1 partitions
&gt;&gt; 'riak@10.5.11.37' does not have 1 primary partitions running
&gt;&gt; 'riak@10.5.10.30' waiting to handoff 1 partitions
&gt;&gt; 'riak@10.5.10.30' does not have 1 primary partitions running
&gt;&gt; 
&gt;&gt; The only errors in the whole cluster are 2 errors on 10.5.10.30, both of
&gt;&gt; the form
&gt;&gt; 
&gt;&gt; 
&gt;&gt; =ERROR REPORT==== 15-Feb-2012::17:49:38 ===
&gt;&gt; Handoff receiver for partition
&gt;&gt; 1044745311060762632934665329637030439832170528768
&gt;&gt; exiting abnormally after processing 7 objects:
&gt;&gt; {timeout,
&gt;&gt; {gen_fsm,
&gt;&gt; sync_send_all_state_event,
&gt;&gt; [&lt;0.1299.1&gt;,
&gt;&gt;  {handoff_data,
&gt;&gt;   
&gt;&gt; &lt;&lt;141,144,203,78,2,49,20,134,207,12,76,4,77,12,49,38,38,174,221,54,25,102,64,134,189,151,141,168,33,6,217,145,127,218,142,157,138,29,3,229,9,120,3,119,190,133,91,151,238,92,243,68,182,74,162,184,162,77,78,206,245,59,253,187,27,204,15,78,178,110,154,138,62,151,44,73,58,49,139,139,172,199,210,12,9,227,167,73,12,153,246,179,162,43,143,95,107,75,181,35,168,49,155,84,185,150,220,62,17,81,48,247,118,171,249,169,111,87,53,65,205,217,132,87,198,74,99,85,83,80,93,148,220,34,68,203,221,6,110,17,171,150,254,119,84,240,55,247,205,241,230,200,175,222,27,179,97,137,71,54,186,195,3,122,24,59,66,31,6,23,232,224,25,9,46,113,239,162,129,243,135,46,51,69,14,141,54,82,156,109,144,2,79,58,92,147,174,48,183,108,80,137,178,40,165,80,181,156,40,106,231,20,209,75,78,225,232,195,141,249,230,214,242,71,78,136,243,252,230,154,175,214,48,21,250,98,157,150,246,221,149,2,19,209,74,191,125,238,235,95,161,193,246,66,55,159,40,40,226,83,9,227,64,118,182,144,90,187,143,92,24,33,139,210,72,241,5&gt;&gt;},60000]}}
&gt;&gt; 
&gt;&gt; =ERROR REPORT==== 15-Feb-2012::17:49:41 ===
&gt;&gt; Handoff receiver for partition
&gt;&gt; 1044745311060762632934665329637030439832170528768
&gt;&gt; exiting abnormally after processing 7 objects:
&gt;&gt; {timeout,
&gt;&gt; {gen_fsm,
&gt;&gt; sync_send_all_state_event,
&gt;&gt; [&lt;0.1299.1&gt;,
&gt;&gt;  {handoff_data,
&gt;&gt;   
&gt;&gt; &lt;&lt;141,144,75,78,195,48,16,134,39,105,2,41,72,168,2,36,36,214,108,88,88,74,232,35,112,128,34,22,45,32,132,16,130,69,245,59,118,112,210,226,208,36,101,193,182,27,14,193,33,184,0,123,142,133,13,149,160,172,234,209,140,172,121,124,227,223,27,78,181,125,16,71,224,113,24,167,44,13,123,156,197,221,78,155,161,23,113,150,182,79,142,142,35,36,157,94,39,222,127,107,204,213,186,160,160,28,21,60,151,73,253,72,68,78,101,227,74,243,19,219,174,26,130,154,229,40,41,116,45,117,173,154,130,60,145,37,53,92,180,140,5,184,68,168,90,249,191,163,156,191,185,111,142,13,123,118,245,230,45,187,202,48,102,55,215,120,64,23,5,198,198,43,115,215,40,241,132,33,6,120,49,126,10,133,115,72,244,49,53,89,99,75,36,199,146,118,23,164,1,170,154,13,11,145,165,153,20,170,193,137,252,136,147,79,103,156,214,158,61,51,102,155,119,230,63,114,92,83,110,222,241,139,254,97,176,224,41,215,214,61,239,254,35,84,46,28,237,211,107,254,254,185,149,255,106,117,86,215,186,252,74,65,126,50,145,208,6,84,151,51,153,231,230,47,103,90,200,52,211,82,124,1&gt;&gt;},60000]}}
&gt;&gt; 
&gt;&gt; I tried strobing through restarting all nodes, which seemed temporarily
&gt;&gt; fix this particular node, but then I think this error cropped up.
&gt;&gt; 
&gt;&gt; If there's anything I can try or more information I can give let me know.
&gt;&gt; The boxes are 16 core, 24 GB memory, with data in bitcask on an SSD drive,
&gt;&gt; there are 1024 partitions spread across 12 machines.  Each machine does
&gt;&gt; roughly 55-120K vnode gets per second, 20-40K node gets per second, 1-2K
&gt;&gt; vnode puts, and 1-2K node puts.
&gt;&gt; 
&gt;&gt; Thanks for the help,
&gt;&gt; 
&gt;&gt; -Anthony
&gt;&gt; 
&gt;&gt; --
&gt;&gt; ------------------------------------------------------------------------
&gt;&gt; Anthony Molinaro                           &lt;antho...@alumni.caltech.edu&gt;
&gt;&gt; 
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 
&gt; 
&gt; -- 
&gt; Joseph Blomstedt &lt;j...@basho.com&gt;
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; <a  rel="nofollow" href="http://www.basho.com/">http://www.basho.com/</a>


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06625.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06626">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06626">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06628.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg06604.html">Bucket properties persist across crash/restart?</a></span> <span class="sender italic">Anthony Molinaro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06607.html">Nodes missing primary partitions</a></span> <span class="sender italic">Anthony Molinaro</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06625.html">Re: Nodes missing primary partitions</a></span> <span class="sender italic">Joseph Blomstedt</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Nodes missing primary partitions</span> <span class="sender italic">Anthony Molinaro</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg06628.html">Re: Bucket properties persist across crash/restart?</a></span> <span class="sender italic">Mark Phillips</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06636.html">Re: Bucket properties persist across crash/resta...</a></span> <span class="sender italic">Anthony Molinaro</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Nodes missing primary partitions">
<input type="hidden" name="msgid" value="BE143E21-33BD-451D-A872-1D06A6205A37@alumni.caltech.edu">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06626.html">
<input type="submit" value=" Anthony Molinaro ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Nodes+missing+primary+partitions%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06625.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06628.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">BE143E21-33BD-451D-A872-1D06A6205A37@alumni.caltech.edu</li>
</ul>
</div>
</body>
</html>
