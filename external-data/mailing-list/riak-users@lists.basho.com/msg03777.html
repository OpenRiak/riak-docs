<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Riak async PB client based on Grizzly</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#03777" id="c">
<link rel="index" href="maillist.html#03777" id="i">
<link rel="prev" href="msg03775.html" id="p">
<link rel="next" href="msg03780.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg03777.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+async+PB+client+based+on+Grizzly%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Riak async PB client based on Grizzly</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Russell+Brown%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Russell Brown</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110622" rel="nofollow">Wed, 22 Jun 2011 05:13:31 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>
On 22 Jun 2011, at 12:32, Jon Brisbin wrote:

&gt; I should have thought of that before. It would have saved me some time. :) 
&gt; There's several things in there I can use to help (like RiakResponse, 
&gt; IRiakObject, etc...).
&gt; 
&gt; The only thing I would say is that I was wanting to return Futures for 
&gt; everything, rather than the responses themselves (and/or take a callback). 
&gt; Maybe introduce a RiakResponseCallback based on the CompletionHandler 
&gt; (success/failed/error, etc...) and also have an RawAsyncClient that returns 
&gt; Future&lt;RiakResponse&gt; and has a void method version that takes said 
&gt; RiakResponseCallback? The synchronous client can just call get() on 
&gt; everything.</pre><pre>

Well, you have 2 choices

1) Abstract away the fact that your client is async, so you can implement 
RiakResponse etc as wrappers around a Future, first call to a method calls get 
on the Future
2) You can require your users to think aysnc and code callbacks

If you do the latter (or both) you might be best extending the RawClient 
interface (or just defining a new one (your RawAsyncClient)) if you re-use 
stuff like RiakResponse/IRiakObject etc then it would be awesome and much 
easier to integrate into the Basho library. It would be great to offer library 
users the option to go async without changing their higher-level code.

Whichever, get it up on github and we can start playing around with it! :D

&gt; 
&gt; Thanks!
&gt; 
&gt; Jon Brisbin
&gt; http//jbrisbin.com
&gt; 
&gt; 
&gt; From: &quot;Russell Brown&quot; &lt;russell.br...@me.com&gt;
&gt; To: &quot;Jon Brisbin&quot; &lt;j...@jbrisbin.com&gt;
&gt; Cc: &quot;riak-users Users&quot; &lt;riak-users@lists.basho.com&gt;
&gt; Sent: Wednesday, June 22, 2011 2:27:17 AM
&gt; Subject: Re: Riak async PB client based on Grizzly
&gt; 
&gt; Hey Jon, 
&gt; Any chance you want to implement the RawClient interface 
&gt; (<a  rel="nofollow" href="https://github.com/basho/riak-java-client/blob/master/src/main/java/com/basho/riak/client/raw/RawClient.java">https://github.com/basho/riak-java-client/blob/master/src/main/java/com/basho/riak/client/raw/RawClient.java</a>)
&gt;  from the basho riak-java-client library? That way your client can be swapped 
&gt; straight into the basho lib?
&gt; 
&gt; If not, let me know when you get a repo up on github and I'll write an 
&gt; adapter so that the basho riak-java-client can make use of your Grizzly 
&gt; client, which I guess means I'll pitch in a little (time permitting) to help 
&gt; shape the Grizzly client so it is RawClient shaped.
&gt; 
&gt; Cheers
&gt; 
&gt; Russell
&gt; 
&gt; On 21 Jun 2011, at 17:58, Jon Brisbin wrote:
&gt; 
&gt; I'm trying to get my feet wet with Grizzly on another project, so I've been 
&gt; spending some late(ish) nights also working on a Grizzly-based asynchronous 
&gt; PB client for Riak. I'm dropping all the way down to the protobuf level and 
&gt; using Grizzly's NIO abstractions to implement a completely non-blocking 
&gt; client. I'm writing the low-level stuff in Java and I'd really like to build 
&gt; a Scala layer on top of this, which uses the nice Scala idioms (operators, 
&gt; case classes, etc...). But I can't write code as fast in Scala as I can in 
&gt; Java and some of the Java APIs inside Grizzly aren't all that Scala-friendly 
&gt; and make the code pretty ugly. I figured it would be better to implement a 
&gt; fairly low-level PB client in Java and flesh out the user-facing API in Scala 
&gt; and/or Java.
&gt; 
&gt; My question is basically, if I seed this project on GitHub with what I've got 
&gt; so far, would anyone else be interested in helping complete it? I'm just 
&gt; working on this after my other Grizzly work, so I can't devote full time to 
&gt; it. It might take me a little while to implement things like links and 
&gt; mapreduce.
&gt; 
&gt; I think it shows some real promise because it is completely non-blocking. It 
&gt; uses Futures and CompletionHandlers to do the dirty work. A Grizzly filter is 
&gt; responsible for the actual encoding/decoding of protobuf data. Right now, it 
&gt; will marshall JSON using Jackson if your content-type is set to 
&gt; &quot;application/json&quot;, otherwise it uses JDK serialization to encode the entry 
&gt; (or just passes a String straight through, of course).
&gt; 
&gt; Since it's a first pass, there is no real attempt to separate the protobuf 
&gt; stuff from the client. That's a v2 thing. Since I have limited time, I'm 
&gt; interested in speed to completion of features rather than good-looking and 
&gt; properly abstracted code. :)
&gt; 
&gt; Thanks!
&gt; 
&gt; Jon Brisbin
&gt; http//jbrisbin.com
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt; 
&gt; 
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>

</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg03775.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#03777">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#03777">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg03780.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg03763.html">Riak async PB client based on Grizzly</a></span> <span class="sender italic">Jon Brisbin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03771.html">Re: Riak async PB client based on Grizzly</a></span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03773.html">Re: Riak async PB client based on Grizzly</a></span> <span class="sender italic">Mark Wolfe</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03776.html">Re: Riak async PB client based on Grizzly</a></span> <span class="sender italic">Jon Brisbin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03778.html">Re: Riak async PB client based on Grizzly</a></span> <span class="sender italic">Mark Wolfe</span></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg03775.html">Re: Riak async PB client based on Grizzly</a></span> <span class="sender italic">Jon Brisbin</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Riak async PB client based on Grizzly</span> <span class="sender italic">Russell Brown</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03780.html">Re: Riak async PB client based on Grizzly</a></span> <span class="sender italic">Jon Brisbin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg03781.html">Re: Riak async PB client based on Griz...</a></span> <span class="sender italic">Russell Brown</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Riak async PB client based on Grizzly">
<input type="hidden" name="msgid" value="4F6270A6-1558-4C70-9253-33D7F1DC8DC3@me.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg03777.html">
<input type="submit" value=" Russell Brown ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Riak+async+PB+client+based+on+Grizzly%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg03775.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg03780.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">4F6270A6-1558-4C70-9253-33D7F1DC8DC3@me.com</li>
</ul>
</div>
</body>
</html>
