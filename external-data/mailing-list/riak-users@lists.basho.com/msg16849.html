<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Two quick questions about X-RIak-Meta-* headers....</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#16849" id="c">
<link rel="index" href="maillist.html#16849" id="i">
<link rel="prev" href="msg16834.html" id="p">
<link rel="next" href="msg16850.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg16849.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Two+quick+questions+about+X%5C-RIak%5C-Meta%5C-%5C%2A+headers....%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Two quick questions about X-RIak-Meta-* headers....</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Dmitri+Zagidulin%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Dmitri Zagidulin</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20151207" rel="nofollow">Mon, 07 Dec 2015 09:36:19 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Joe,

1. Yes, it's possible (with the HTTP HEAD request, or the client library
equivalent (I'm pretty sure all the client libraries expose the 'return
only the headers' part of the object fetch -- see the Optional Parameters
head=true section of the PB API
<a  rel="nofollow" href="http://docs.basho.com/riak/latest/dev/references/protocol-buffers/fetch-object/">http://docs.basho.com/riak/latest/dev/references/protocol-buffers/fetch-object/</a>
)).</pre><pre>

However, this is not going to be very helpful in your case. Behind the
scenes, a HEAD request still requests all replicas of an object -- *full*
replicas, including the value. It's just that the node coordinating the
request drops the actual object value before returning the metadata/headers
to the client.
So, if you use this 'just give me the metadata' request, you're only saving
on the cost of shipping the object value down the wire from the cluster to
the client. But you're still incurring the cost of all 3 copies of the
object (so, 3-4MB, in your case) being transferred over the network between
the nodes, as a result of that HEAD request.

2. I don't know that there is a specific size limit on the object header
values. However, this question is definitely a red flag -- it's very likely
that you're trying to use the custom headers in a way that they weren't
intended for.

Can you describe in more detail what's your use case? (As in, what are you
trying to store as metadata, and why would retrieving just the headers be
useful to you.)

Don't forget, that if you need to store a LOT of metadata on an object, and
you can't do it within the object value itself (for example, when storing
binary images), you can simply store a separate metadata object, in a
different bucket, using the same key as the object.
For example, if I'm storing my primary objects in the 'blobs' bucket, I can
also store a JSON object with corresponding metadata in a 'blobs-meta'
object, like so:

/buckets/blobs/keys/blob123   --&gt;  binary object value
/buckets/blobs-meta/keys/blob123   --&gt; json metadata object

The downsides of this setup is that you're now doing 2 writes for each
object (one to the blobs bucket, and one to the meta bucket).
But the benefits are considerable:

- You can store arbitrarily large metadata object (you're not abusing
object headers by stuffing large values into them)
- Since the metadata object is likely to be much smaller than the object
it's referring to, you can use the metadata object to check for an object's
existence (or to get the actual headers that you care about) without the
cost of requesting the full giant blob.

Dmitri



On Mon, Nov 30, 2015 at 12:18 PM, Joe Olson &lt;technol...@nododos.com&gt; wrote:

&gt; Two quick questions about X-RIak-Meta-* headers:
&gt;
&gt; 1. Is it possible to pull the headers for a key without pulling the key
&gt; itself? The reason I am interested in this is because the values for our
&gt; keys are in the 1.2-1.6 MB range, so the headers are a lot smaller in
&gt; comparison. I know I can index the headers using Solr or 2i, but I am
&gt; trying to involve the overhead of doing that.
&gt;
&gt; 2. What are the size limits on the headers values that are strings?
&gt;
&gt; As always, thanks in advance!
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg16834.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#16849">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#16849">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg16850.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg16834.html">Two quick questions about X-RIak-Meta-* headers....</a></span> <span class="sender italic">Joe Olson</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Two quick questions about X-RIak-Meta-* headers....</span> <span class="sender italic">Dmitri Zagidulin</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16850.html">Re: Two quick questions about X-RIak-Meta-* head...</a></span> <span class="sender italic">Damien Krotkine</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg16853.html">Re: Two quick questions about X-RIak-Meta-* ...</a></span> <span class="sender italic">Joe Olson</span></li>
<li class="icons-email"><span class="subject"><a href="msg16854.html">Re: Two quick questions about X-RIak-Meta-* ...</a></span> <span class="sender italic">Dmitri Zagidulin</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Two quick questions about X-RIak-Meta-* headers....">
<input type="hidden" name="msgid" value="CA+TO3kWygFiQYofvd1AQhQSX+6OQGWg8Ov0+g8sGJx5ZtesGBg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg16849.html">
<input type="submit" value=" Dmitri Zagidulin ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Two+quick+questions+about+X%5C-RIak%5C-Meta%5C-%5C%2A+headers....%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg16834.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg16850.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CA+TO3kWygFiQYofvd1AQhQSX+6OQGWg8Ov0+g8sGJx5ZtesGBg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
