<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Yokozuna - inconsistent number of documents found for the same	query</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#15288" id="c">
<link rel="index" href="maillist.html#15288" id="i">
<link rel="prev" href="msg15287.html" id="p">
<link rel="next" href="msg15291.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15288.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Yokozuna+%5C-+inconsistent+number+of+documents+found+for+the+same%09query%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Yokozuna - inconsistent number of documents found for the same	query</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Eric+Redmond%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Eric Redmond</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20141201" rel="nofollow">Mon, 01 Dec 2014 21:14:05 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>
On Dec 1, 2014, at 8:57 PM, Ryan Zezeski &lt;r...@zinascii.com&gt; wrote:

&gt; 
&gt; Eric Redmond writes:
&gt; 
&gt;&gt; This is a known issue, and we're still working on a fix.
&gt;&gt; 
&gt;&gt; <a  rel="nofollow" href="https://github.com/basho/yokozuna/issues/426">https://github.com/basho/yokozuna/issues/426</a>
&gt;&gt; 
&gt; 
&gt; I don't see how this issue is related to Oleksiy's problem. There is no
&gt; mention of removing or adding nodes. I think the key part of Oleksiy's
&gt; report is the association of an index _after_ data had already been
&gt; written. That data is sometimes missing. These two issues could be
&gt; related but I don't see anything in that GitHub report to indicate why.</pre><pre>

The issue, sadly, hasn't been updated with what we know. It's mentioned in 
Zeeshan's gist, which should be moved to the main issue. But the issue is 
surrounding the AAE tree dropping documents, though we still aren't sure why. 
It initially appeared when adding/removing nodes, but noticed it could be 
reproduced by simply running AAE.

We'll update the issue.

&gt;&gt; 
&gt;&gt; On Nov 29, 2014, at 9:26 AM, Oleksiy Krivoshey &lt;oleks...@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt; 1. Create a bucket, insert some keys (10 keys -  KeysA)
&gt;&gt;&gt; 2. Create Yokozuna Index, associate it with the bucket
&gt;&gt;&gt; 3. Add or update some new keys in the bucket (10 keys - KeysB)
&gt;&gt;&gt; 4. Wait for Search AAE to build and exchange the trees
&gt;&gt;&gt; 
&gt;&gt;&gt; Now when I issue a search query I will always get all 10 KeysB but a random 
&gt;&gt;&gt; amount of KeysA, for example the same query repeated 5 times may return:
&gt;&gt;&gt; 
&gt;&gt;&gt; 10 KeysB + 2 KeysA
&gt;&gt;&gt; 10 KeysB + 0 KeysA
&gt;&gt;&gt; 10 KeysB + 7 KeysA
&gt;&gt;&gt; 10 KeysB + 1 KeysA
&gt;&gt;&gt; 10 KeysB + 10 KeysA
&gt;&gt;&gt; 
&gt; 
&gt; Are there any errors in the logs? Does the count go up if you wait
&gt; longer? What does `riak-admin search aae-status` show?
&gt; 
&gt; -Z


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15287.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#15288">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#15288">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15291.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg15268.html">Yokozuna - inconsistent number of documents found for th...</a></span> <span class="sender italic">Oleksiy Krivoshey</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15283.html">Re: Yokozuna - inconsistent number of documents fou...</a></span> <span class="sender italic">Eric Redmond</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg15284.html">Re: Yokozuna - inconsistent number of documents...</a></span> <span class="sender italic">Oleksiy Krivoshey</span></li>
<li class="icons-email"><span class="subject"><a href="msg15287.html">Re: Yokozuna - inconsistent number of documents...</a></span> <span class="sender italic">Ryan Zezeski</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Yokozuna - inconsistent number of docum...</span> <span class="sender italic">Eric Redmond</span></li>
<li class="icons-email"><span class="subject"><a href="msg15291.html">Re: Yokozuna - inconsistent number of docum...</a></span> <span class="sender italic">Oleksiy Krivoshey</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Yokozuna - inconsistent number of documents found for the same	query">
<input type="hidden" name="msgid" value="A200D680-D95B-4DAE-8EE7-DC33971F5610@basho.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15288.html">
<input type="submit" value=" Eric Redmond ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Yokozuna+%5C-+inconsistent+number+of+documents+found+for+the+same%09query%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15287.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15291.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">A200D680-D95B-4DAE-8EE7-DC33971F5610@basho.com</li>
</ul>
</div>
</body>
</html>
