<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Bigger data than disk space?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#10441" id="c">
<link rel="index" href="maillist.html#10441" id="i">
<link rel="prev" href="msg10439.html" id="p">
<link rel="next" href="msg10442.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg10441.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Bigger+data+than+disk+space%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Bigger data than disk space?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Alexander+Sicular%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Alexander Sicular</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20130314" rel="nofollow">Thu, 14 Mar 2013 14:17:52 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>You have to think at the cluster level. If you have 10 GB of data and if your 
replication factor is three then your total data across the cluster will be </pre><pre>

10 GB x 3 replicas = 30 GB across the cluster

Now, if you have four physical machines in your cluster each will be 
responsible for 1/4 that data. 

0.25 x 30 GB = 7.5 GB

That is because the vnodes are evenly divided amongst physical machines in the 
cluster. 

-Alexander Sicular

@siculars

On Mar 14, 2013, at 5:08 PM, &quot;Kevin Burton&quot; &lt;rkevinbur...@charter.net&gt; wrote:

&gt; Then that is not quite as bad but still if I have 10 GB of data and to
&gt; support replication that requires 30 GB of disk space, what if I only have
&gt; 20 GB of disk space per physical node?
&gt; 
&gt; -----Original Message-----
&gt; From: Mark Phillips [<a  rel="nofollow" href="mailto:m...@basho.com">mailto:m...@basho.com</a>] 
&gt; Sent: Thursday, March 14, 2013 4:05 PM
&gt; To: Kevin Burton
&gt; Cc: Alexander Sicular; riak-users@lists.basho.com
&gt; Subject: Re: Bigger data than disk space?
&gt; 
&gt; Kevin,
&gt; 
&gt; On Thu, Mar 14, 2013 at 1:56 PM, Kevin Burton &lt;rkevinbur...@charter.net&gt;
&gt; wrote:
&gt;&gt; So that is what I am missing. If each vnode keeps an entire copy of my 
&gt;&gt; data and I have 4 physical node then there are 16 vnodes per physical 
&gt;&gt; node. That would mean I have the data replicated 16 times per physical 
&gt;&gt; node. 10 GB turns into 160GB etc. Right? So won’t I run out of disk space?
&gt;&gt; 
&gt; 
&gt; Your raw data set is replicated 3 times by default. Three different vnodes
&gt; of your total (by default 64) will be responsible for each replica. So, 10GB
&gt; raw  = 30GB replicated.
&gt; 
&gt; Mark
&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; From: Alexander Sicular [<a  rel="nofollow" href="mailto:sicul...@gmail.com">mailto:sicul...@gmail.com</a>]
&gt;&gt; Sent: Thursday, March 14, 2013 3:51 PM
&gt;&gt; 
&gt;&gt; 
&gt;&gt; To: Kevin Burton
&gt;&gt; Cc: riak-users@lists.basho.com
&gt;&gt; Subject: Re: Bigger data than disk space?
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Each vnode keeps _an entire copy_ of your data. There is no striping, 
&gt;&gt; which I think you are conflating with RAID. Default replication (also 
&gt;&gt; configured in etc/app.config) is set to three. In which case, three 
&gt;&gt; entire copies of your data are kept on three different vnodes and if 
&gt;&gt; you indeed have five physical nodes in your cluster you are guaranteed 
&gt;&gt; to have each of those three vnodes on different physical machines.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -Alexander Sicular
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; @siculars
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Mar 14, 2013, at 4:42 PM, &quot;Kevin Burton&quot; &lt;rkevinbur...@charter.net&gt;
&gt;&gt; wrote:
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Thank you. Let me get it straight. I have a 4 node cluster (4 physical 
&gt;&gt; machines). If I have not made any changes to the ring size then I have 
&gt;&gt; 16
&gt;&gt; (64/4) vnodes. Each physical node stores the actual data (the value) 
&gt;&gt; of about ¼ of the data size. So when querying the data with a key 
&gt;&gt; given the number of vnodes it can be determined which physical machine the
&gt; data is on.
&gt;&gt; There must be enough redundancy built in so that if one or more of the 
&gt;&gt; physical machines go down the remaining physical machines can 
&gt;&gt; reconstruct the values lost by the lost vnodes. Correct so far? Now 
&gt;&gt; where does replication some in? The documentation indicates that there 
&gt;&gt; are 3 copies of the data (default) made. How is this changed and how 
&gt;&gt; can this replication of the data be taken advantage of?
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; From: Alexander Sicular [<a  rel="nofollow" href="mailto:sicul...@gmail.com">mailto:sicul...@gmail.com</a>]
&gt;&gt; Sent: Thursday, March 14, 2013 3:28 PM
&gt;&gt; To: Kevin Burton
&gt;&gt; Cc: riak-users@lists.basho.com
&gt;&gt; Subject: Re: Bigger data than disk space?
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Hi Kevin,
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; The Riak distribution model is not based on &quot;buckets&quot; but rather the 
&gt;&gt; hash of the bucket/key combination. That hash (and associated data) is 
&gt;&gt; then allocated against a &quot;vnode&quot;. A vnode, in turn, is one of n where 
&gt;&gt; n is the ring_creation_size (default is 64, modify in etc/app.config). 
&gt;&gt; Each physical machine in a Riak cluster claims an equal share of the 
&gt;&gt; ring. For example, a cluster with five machines (the recommended 
&gt;&gt; minimum for a production
&gt;&gt; cluster) and the default ring_creation_size will have 64/5 vnodes per 
&gt;&gt; physical machine (not sure if they round down or up but all machines 
&gt;&gt; will have about the same number of vnodes). What you would do to make 
&gt;&gt; more data available is either add a machine to the cluster whose 
&gt;&gt; available disk space is equal or greater than the cluster member with 
&gt;&gt; the least amount of total space or increase the space on all machines
&gt; already in the cluster.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; tl;dr add a machine to your cluster.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; -Alexander Sicular
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; @siculars
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Mar 14, 2013, at 3:41 PM, Kevin Burton &lt;rkevinbur...@charter.net&gt;
&gt; wrote:
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; I am relatively new to Riak so forgive me if this has been asked 
&gt;&gt; before. I have a very thin understanding of a Riak cluster and 
&gt;&gt; understand somewhat about replication. In planning I foresee a time 
&gt;&gt; when the amount of data exceeds the disk space that is available to a 
&gt;&gt; single node. What facilities are there to essentially “split” a bucket 
&gt;&gt; across several servers? How is this handled?
&gt;&gt; 
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt; 
&gt; 


_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg10439.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#10441">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#10441">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg10442.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg10433.html">Bigger data than disk space?</a></span> <span class="sender italic">Kevin Burton</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10434.html">Re: Bigger data than disk space?</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10435.html">RE: Bigger data than disk space?</a></span> <span class="sender italic">Kevin Burton</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10436.html">Re: Bigger data than disk space?</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10437.html">RE: Bigger data than disk space?</a></span> <span class="sender italic">Kevin Burton</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10438.html">Re: Bigger data than disk space?</a></span> <span class="sender italic">Mark Phillips</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg10439.html">RE: Bigger data than disk spac...</a></span> <span class="sender italic">Kevin Burton</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Bigger data than disk ...</span> <span class="sender italic">Alexander Sicular</span></li>
<li class="icons-email"><span class="subject"><a href="msg10442.html">RE: Bigger data than disk ...</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg10443.html">RE: Bigger data than disk ...</a></span> <span class="sender italic">Kevin Burton</span></li>
<li class="icons-email"><span class="subject"><a href="msg10445.html">Re: Bigger data than disk ...</a></span> <span class="sender italic">Jeremiah Peschka</span></li>
<li class="icons-email"><span class="subject"><a href="msg10446.html">Re: Bigger data than disk ...</a></span> <span class="sender italic">Alexander Sicular</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Bigger data than disk space?">
<input type="hidden" name="msgid" value="1BF6B6ED-1D35-4E77-9B7F-3702C3E53E55@gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg10441.html">
<input type="submit" value=" Alexander Sicular ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Bigger+data+than+disk+space%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg10439.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg10442.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">1BF6B6ED-1D35-4E77-9B7F-3702C3E53E55@gmail.com</li>
</ul>
</div>
</body>
</html>
