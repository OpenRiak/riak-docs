<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Conflict Resolution</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#00733" id="c">
<link rel="index" href="maillist.html#00733" id="i">
<link rel="prev" href="msg00732.html" id="p">
<link rel="next" href="msg00739.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg00733.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Conflict+Resolution%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Conflict Resolution</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Justin+Sheehy%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Justin Sheehy</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100714" rel="nofollow">Wed, 14 Jul 2010 06:01:04 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>On Wed, Jul 14, 2010 at 5:25 AM, Misha Gorodnitzky &lt;mis...@pobox.com&gt; wrote:</pre><pre>

&gt; I don't suppose there are any examples anywhere of how people have
&gt; approached conflict resolution with RIak? That would be useful to help
&gt; people understand how to approach it ... maybe a section on the wiki
&gt; could be dedicated to it.

This is a great idea.  We'll find a right place to present this that's
easier to find.

&gt; In our particular case, we're trying to store transactions in Riak and
&gt; need to guard against a transaction being placed on a balance that has
&gt; reached 0. The problem we keep running into is race conditions between
&gt; when we record the transaction and when we update the cached balance
&gt; value. Any suggestions on how this has been, or can, be solved would
&gt; be appreciated.

I suggest that you solve this similarly to the way that banks have
been doing so for far longer than there have even been computers
involved.  Each transaction should be (at least) a unique identifier,
a time, and the amount being added or subtracted to the balance.  This
way (in addition to storing what you believe the balance to be at any
time) you can reconcile balances even if you get some transactions
late or multiple times.

More specifics than that will depend a lot on your application, but
the key here is that you can make things much neater in situations
where your actions can be commutative and idempotent.  That's why you
store the transaction itself instead of just the balance, and a unique
id so that you don't repeat yourself.

Best of luck,

-Justin

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg00732.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#00733">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#00733">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg00739.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg00722.html">Conflict Resolution</a></span> <span class="sender italic">Misha Gorodnitzky</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00723.html">Re: Conflict Resolution</a></span> <span class="sender italic">Justin Sheehy</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00732.html">Re: Conflict Resolution</a></span> <span class="sender italic">Misha Gorodnitzky</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Conflict Resolution</span> <span class="sender italic">Justin Sheehy</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00739.html">Re: Conflict Resolution</a></span> <span class="sender italic">Misha Gorodnitzky</span></li>
</ul></li>
</ul></li>
</ul></li>
<li class="icons-email"><span class="subject"><a href="msg00724.html">Re: Conflict Resolution</a></span> <span class="sender italic">Alexander Sicular</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Conflict Resolution">
<input type="hidden" name="msgid" value="AANLkTinZ-11WV2tL4P9qEWO54ev9gXuMv_GNFA67MjIb@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg00733.html">
<input type="submit" value=" Justin Sheehy ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Conflict+Resolution%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg00732.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg00739.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">AANLkTinZ-11WV2tL4P9qEWO54ev9gXuMv_GNFA67MjIb@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
