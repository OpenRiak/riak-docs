<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Adding new indexed (2i) fields</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#09696" id="c">
<link rel="index" href="maillist.html#09696" id="i">
<link rel="prev" href="msg09681.html" id="p">
<link rel="next" href="msg09686.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg09696.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Adding+new+indexed+%5C%282i%5C%29+fields%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Adding new indexed (2i) fields</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Thomas+Santero%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Thomas Santero</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121228" rel="nofollow">Fri, 28 Dec 2012 10:23:00 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hey Joshua,

Do you know all your keys, or are they predictable? If so, you can read
them in batches and write them back with the new indicies, which will not
put the strain of list_keys on your cluster.</pre><pre>

That said, just wanted to point out that Option #2 necessitates Option #1,
indexing of object for Search happens at write time, so enabling search
would require a read/write on all the keys of your bucket before the values
were searchable.

Tom

On Thu, Dec 27, 2012 at 12:54 PM, Joshua Barratt &lt;j...@mediatemple.net&gt;wrote:

&gt; Good day the list,
&gt;
&gt; We're getting ready to launch a riak-backed application, and starting to
&gt; need to evolve things already. We're leaning on 2i quite a bit.
&gt;
&gt; The use case would be something like an 'account' object:
&gt;
&gt; { &quot;id&quot;: ..., &quot;first_name&quot;: ..., }
&gt;
&gt; .. where we have indexes on various fields. Now our customer service
&gt; department wants account records to magically pop up when people call, and
&gt; we want to add another field ('phone_number') that we'll need to do 2i on.
&gt;
&gt; So far the options seem to be:
&gt;
&gt; 1. List all the keys in the bucket (eew, I'm told) and re-save them with
&gt; the new index
&gt; 2. Have search enabled, and find all the objects that have that field
&gt; defined, then re-save them with the index
&gt; 3. I'm doing it wrong at the data modeling layer
&gt;
&gt; I apologize if this is an RTFM thing, I searched the list archives etc and
&gt; found no clear suggestions.
&gt;
&gt;
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
&gt;


-- 
@tsantero &lt;<a  rel="nofollow" href="https://twitter.com/#!/tsantero">https://twitter.com/#!/tsantero</a>&gt;
Technical Evangelist
Basho Technologies
347-571-3995
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg09681.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#09696">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#09696">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg09686.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg09681.html">Adding new indexed (2i) fields</a></span> <span class="sender italic">Joshua Barratt</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Adding new indexed (2i) fields</span> <span class="sender italic">Thomas Santero</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Adding new indexed (2i) fields">
<input type="hidden" name="msgid" value="CAPFHwQAPRQx2u1MzL4GecPk7SQNkSNUi0P3Zyazg_Gu5Dcvy=g@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg09696.html">
<input type="submit" value=" Thomas Santero ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Adding+new+indexed+%5C%282i%5C%29+fields%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg09681.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg09686.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAPFHwQAPRQx2u1MzL4GecPk7SQNkSNUi0P3Zyazg_Gu5Dcvy=g@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
