<!DOCTYPE html>
<html lang="en">
<head>
<title></title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04477" id="c">
<link rel="index" href="maillist.html#04477" id="i">
<link rel="prev" href="msg04475.html" id="p">
<link rel="next" href="msg04481.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04477.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22%22&amp;o=newest" rel="nofollow"><span itemprop="name"></span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Joel+R.+Berendzen%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Joel R. Berendzen</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110826" rel="nofollow">Fri, 26 Aug 2011 12:10:04 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>&lt;delurk&gt;

I've been reading about riak and started testing it, and I have some
questions. Apologies in advance for length.</pre><pre>

First, a word about my application and its data flow.  I'm doing
bioinformatics for data streams that employ next-generation
sequencing.  A typical data set for me consists of 35 million 100-base
records (reads), and I work with about 100 of them (~3 billion
records) at any given time.  If an entire sequencing center were run
through my application, and if each read were a bucket that would
amount to about a terabyte of data each day and half a billion buckets
per hour.  I've been developing analysis methods that can scale to
this size, taking web search technology (lucene, so far) as the basis.
Indexing has worked so well that I now have to take the database
portion more seriously.  I care a lot about scaling and flow, not
so much about reliability, and very little about downtime.

Questions about riak:

1.  In terms of number of buckets, what's the largest riak database
that the list has seen? How were the individual servers sized?

2. Expiring and deleting data is a critical function for me.  The
current docs say &quot;there is no straightforward way of deleting a
bucket&quot;.  Does anybody had experience with large-scale deletions?
Would deletion just leave a compaction issue anyway?

3. As an alternative to deleting buckets, I could segment databases
into pieces that could be retired en bloc.  Does anybody have
experience with running multiple (10, say) riak instances per machine?

4. How can I estimate the memory footprint per key when using bitcask
for, say, a 16-byte bucket and 2-byte key IDs?

5. It would be helpful to make estimates of but also the optimal
storage (RAM/Memory Appliance/SSD/spinning metal) balance.
  (a) Does anybody have estimates of performance improvements using SSDs?
      I haven't been able to find them on the blog or mailing list,
      despite comments left saying that such estimates were being made.
  (b) Does anybody have numbers about tradeoffs in performance
      versus RAM size? Aside from one brief discussion on this list,
      
(<a  rel="nofollow" href="http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-May/004287.html">http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-May/004287.html</a>)
      I haven't been able to find much.
  (c) RAM cacheing of specific files? HugeTLB?

Comments:

1. Key filters look great, do more of that.  I'd love to see javascript
   filters.  It would also be great to have a dynamic component to key
   filtering by putting a limited amount (say, 64 bits) of information
   from each bucket into memory that could be accessed by the key filters,
   even if the consistency of the information weren't guaranteed.

2. Secondary indices also look good for my use case.  Features that I'd
   like to see: ability to plug in user-specified analyzers, indexer
   support for integer values, ability to read the index directly (for
   histogramming and linking), ability to delete an index.

3. Python client: seems to throw errors in most tests with riak 0.14.2
   under erlang 13.  This does not inspire confidence.

4. Bucket and key listing via the HTTP interface hang for me on 0.14.2
   under erlang 13, even with only 2 or zero buckets.  This does not
   inspire confidence.

5. I was able to find patches for 0.14.2 to run under erlang 14 that
   enabled riak to compile, but it had run-time errors related to
   NIFs when I ran the python tests, perhaps because I made the
   NIF compat header files all be the same.  /riak/tests worked,
   but I gave up on 0.14.2.

6. It took me some searching to find the source head, although later
   I realized it was on the top menu at the basho site.  Perhaps
   it would be a good thing to put in the install instructions for
   the curious and menu-challenged.  No problems building, bucket
   and key listings work, but the python client tests still throw
   lots of errors.  Basic operations in python seem to work, though.

7. Building: &quot;make&quot; and &quot;make install&quot; &gt; &quot;make rel&quot;, IMHO.

8. Filesystem layout: It's pointless to argue about filesystem layout,
   but modifying the build to put things where my distro (gentoo) and
   I think they should go seems more daunting than it ought to be.
   There were several barricades here, from the version number and
   the separate filesystem layout in the erts directory to uncertainties
   about whether choices in app.config are compile-time or run-time
   or both.  &quot;make devrel&quot; ought to give some clues, but it doesn't
   separate out things which need to be shared from those that don't.

9. Docs: Depending on which page I stumbled across first, it seemed that
   I should start by either doing &quot;make rel&quot; or &quot;make devrel&quot;.  The latter
   starts riak at a different port than the former and I wasted
   some time before I found the correct port. It would be good to
   point the new user to a riak browser so that they can see a different
   view of the changes they are making than the one they get from reading
   curl output.

-- 
Joel Berendzen
Applied Modern Physics Group (P-21), MS D454
Los Alamos National Laboratory
Los Alamos, NM 87545

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04475.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04477">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04477">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04481.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">[no subject]</span> <span class="sender italic">Joel R. Berendzen</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04481.html">Re: newbie questions and comments [NT]</a></span> <span class="sender italic">Ian Plosker</span></li>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="[no subject]">
<input type="hidden" name="msgid" value="43787.130.55.116.38.1314385790.squirrel@webmail.lanl.gov">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04477.html">
<input type="submit" value=" Joel R. Berendzen ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04475.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04481.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">43787.130.55.116.38.1314385790.squirrel@webmail.lanl.gov</li>
</ul>
</div>
</body>
</html>
