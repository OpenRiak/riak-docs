<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: riak_core questions</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#04113" id="c">
<link rel="index" href="maillist.html#04113" id="i">
<link rel="prev" href="msg04109.html" id="p">
<link rel="next" href="msg04114.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg04113.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak_core+questions%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: riak_core questions</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Dmitry+Demeshchuk%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Dmitry Demeshchuk</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20110728" rel="nofollow">Thu, 28 Jul 2011 09:22:09 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi, Justin.

Unfortunately, the application should behave like that, though I don't
like it myself. During any outage, we should be completely sure that
all the vnodes are up, and we cannot use any kind of replication in
our case. It is just the way to ensure that we don't access the same
resource at the same time from different nodes, while being able to
access any resource, even when some nodes are down.</pre><pre>

And in case of any partitions, that are much less likely to happen,
we'll just shut down all the lesser partitions, while only the largest
one will remain running, until the outage is resolved manually.

By master node, I mean the one that is used when we are joining new
nodes using riak-admin (as far as I remember, only one node can be
used for this). I believe, it's the one that is is returned by
riak_core_ring:owner_node/1.
Maybe, I'm wrong and when we call riak_core_gossip:send_ring(RingNode,
node()), we can use any node from the cluster
as RingNode?

Thank you.

On Thu, Jul 28, 2011 at 5:20 PM, Justin Sheehy &lt;jus...@basho.com&gt; wrote:
&gt; Hi, Dmitry.
&gt;
&gt; A couple of suggestions...
&gt;
&gt; The reason that you're not seeing an easy way to automatically have nodes be 
&gt; added or removed from the cluster upon going down or coming up is that we 
&gt; recommend strongly against such behavior.
&gt;
&gt; The idea is that intentional (administrative) outages are very different in 
&gt; nature from unintentional and potentially transitory outages. We have 
&gt; explicit administrative commands such as &quot;join&quot; and &quot;leave&quot; for the 
&gt; administrative cases, making it very easy to add or remove hosts to a 
&gt; cluster. When a node is unreachable, you often can't automatically tell 
&gt; whether it is a host problem or a network problem and can't automatically 
&gt; tell if it is a long-term or short-term outage. This is why mechanisms such 
&gt; as quorums and hinted handoff exist: to ensure proper operation of the 
&gt; cluster as a whole throughout such outages. Consider the case where you have 
&gt; a network problem such that several of your nodes lose visibility to each 
&gt; other for brief and distinct periods of time. If nodes are auto-added and 
&gt; auto-removed then you will have quite a bit of churn and potentially a very 
&gt; harmful feedback scenario. Instead of auto-adding and auto-removing, consider 
&gt; using things like
&gt; riak_core_node_watcher to decide which nodes to interact with on a 
&gt; per-operation basis.
&gt;
&gt; I'm also not sure what you mean by &quot;if the master node goes down&quot; since in 
&gt; most riak_core applications there is no master node. Of course you can create 
&gt; such a mechanism if you need it, but (e.g.) Riak KV and the accompanying 
&gt; applications do not have any notion of a master node and thus do not have any 
&gt; such concern.
&gt;
&gt; I hope that this is useful.
&gt;
&gt; Best regards,
&gt;
&gt; -Justin
&gt;
&gt;
&gt;



-- 
Best regards,
Dmitry Demeshchuk

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg04109.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#04113">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#04113">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg04114.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg04107.html">riak_core questions</a></span> <span class="sender italic">Dmitry Demeshchuk</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04109.html">Re: riak_core questions</a></span> <span class="sender italic">Justin Sheehy</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: riak_core questions</span> <span class="sender italic">Dmitry Demeshchuk</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg04114.html">Re: riak_core questions</a></span> <span class="sender italic">Justin Sheehy</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: riak_core questions">
<input type="hidden" name="msgid" value="CANH2pzsUwc9wwtyT5Uet_9M+WroK_SVde-QpKCuxaJ2u+RW51w@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg04113.html">
<input type="submit" value=" Dmitry Demeshchuk ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+riak_core+questions%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg04109.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg04114.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CANH2pzsUwc9wwtyT5Uet_9M+WroK_SVde-QpKCuxaJ2u+RW51w@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
