<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: setting search schema</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#08935" id="c">
<link rel="index" href="maillist.html#08935" id="i">
<link rel="prev" href="msg08928.html" id="p">
<link rel="next" href="msg08910.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg08935.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+setting+search+schema%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: setting search schema</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Ryan+Zezeski%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ryan Zezeski</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20121016" rel="nofollow">Tue, 16 Oct 2012 06:45:53 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>David,

Yes, Riak Search is not the most friendly thing to remotely control.</pre><pre>

I know we warn against writing to the _rs_schema directly but I never did
care much for warnings.  I tested the following and it worked fine.  I
don't know Python.  The content-type isn't necessary but seemed like a good
thing to add.

curl -XPUT -H 'content-type: application/x-erlang' '
<a  rel="nofollow" href="http://localhost:8091/riak/_rs_schema/test">http://localhost:8091/riak/_rs_schema/test</a>' --data-binary @test.schema

This is only half the problem.  If you have run show-schema even _once_ on
the bucket  you wish to change the schema for then the previous schema has
been stored in the local cache for that node.  In this case you need to run
`search-cmd clear-schema-cache`, that will clear the cache on _all_ nodes.
 I realize that is what you are trying to avoid but I don't see an easy way
around it.  If you know Erlang you could make a remsh connection but not
sure that is any less of a pain.

Note that show-schema will give you the impression the cache is correct but
show-schema shows you what is stored in KV and not what is in the cache.
 As of Riak Search 1.2.0 the set-schema command will clear the cache for
you.  I know, this is all kind of silly.  It should be easy.  It's not.

FWIW, before I worked for Basho and was running Riak Search at my previous
job I did use a script which set the various schemas and installed the
commit hooks.  All I needed was a one-time setup so it worked fine for me.

-Z
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg08928.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#08935">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#08935">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg08910.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg08904.html">setting search schema</a></span> <span class="sender italic">David Lowell</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08905.html">Re: setting search schema</a></span> <span class="sender italic">Alexander Sicular</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg08928.html">Re: setting search schema</a></span> <span class="sender italic">David Lowell</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: setting search schema</span> <span class="sender italic">Ryan Zezeski</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: setting search schema">
<input type="hidden" name="msgid" value="CACZcpekrOOiFbw855B2aVVva99ZoM-KFeU0C4JPPm1yZDT2w_g@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg08935.html">
<input type="submit" value=" Ryan Zezeski ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+setting+search+schema%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg08928.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg08910.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CACZcpekrOOiFbw855B2aVVva99ZoM-KFeU0C4JPPm1yZDT2w_g@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
