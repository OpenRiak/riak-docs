<!DOCTYPE html>
<html lang="en">
<head>
<title>Use of fallback nodes for get requests?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#00824" id="c">
<link rel="index" href="maillist.html#00824" id="i">
<link rel="prev" href="msg00821.html" id="p">
<link rel="next" href="msg00826.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg00824.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Use+of+fallback+nodes+for+get+requests%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Use of fallback nodes for get requests?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Nico+Meyer%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Nico Meyer</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100802" rel="nofollow">Mon, 02 Aug 2010 10:19:22 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi!

I have a question regarding the use of fallback nodes for get requests.</pre><pre>

As I read the code, get requests use fallback nodes if any of the nodes
normally holding the key are not reachable. Also a simple test seemed to
confirm this.
What I mean is, if I do a get request for a key with R=N, and one of the
first N nodes in the preflist is down the request will still succeed.
Why is that? Doesn't that undermine the purpose of seting R to a high
number (specifically setting it to N)? That way a request might succeed
even if all primary nodes responsible for the key are unavailable.

I can see that behaviour might make sense if a node is down for a long
time, but in that case it should just be removed from the cluster.

On a similar note, why is the riak_kv_get_fsm waiting for at least
(N/2)+1 responses, if there are only not_found responses, effectively
ignoring a smaller R value of the request if the key does not exists?
My guess was, that this also has to do with the use of fallback nodes:
Since the partition will usually be very small on the fallback/handoff
node, it is likely to be the first to answer. So to avoid returning
false not_found responses, a basic quorum is required.
Am I on the right track here?

The problem is, this is imposed even for the case that all nodes are up.
If one requires very low latency or very high availability (that's why
one uses a small R value in the first place) and does a lot of gets for
non existent keys, riak silently screws you over by raising R for those
keys.

I most likely missed something here, but some ad hoc test I did seem to
be consistent with my understanding of the code.


Thanks,
Nico







_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg00821.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#00824">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#00824">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg00826.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email tSliceCur"><span class="subject">Use of fallback nodes for get requests?</span> <span class="sender italic">Nico Meyer</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00826.html">Re: Use of fallback nodes for get requests?</a></span> <span class="sender italic">Justin Sheehy</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00840.html">Re: Use of fallback nodes for get requests?</a></span> <span class="sender italic">Nico Meyer</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00841.html">Re: Use of fallback nodes for get requests?</a></span> <span class="sender italic">Nico Meyer</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Use of fallback nodes for get requests?">
<input type="hidden" name="msgid" value="1280769566.22742.44.camel@erdnuss1.virtualminds-office.de">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg00824.html">
<input type="submit" value=" Nico Meyer ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Use+of+fallback+nodes+for+get+requests%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg00821.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg00826.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">1280769566.22742.44.camel@erdnuss1.virtualminds-office.de</li>
</ul>
</div>
</body>
</html>
