<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Configuring Riak 2.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd7.html#12854" id="c">
<link rel="index" href="mail7.html#12854" id="i">
<link rel="prev" href="msg12852.html" id="p">
<link rel="next" href="msg12855.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg12854.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Configuring+Riak+2.0%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Configuring Riak 2.0</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Joe+DeVivo%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Joe DeVivo</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20131105" rel="nofollow">Tue, 05 Nov 2013 10:15:04 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Chris,

That’s a great question, and unfortunately there’s not a simple answer. I am 
happy to get into the complex answer.</pre><pre>

At this point I would actually say that there is no way to get the true running 
configuration of a Riak node. That’s because Riak has two types of 
configuration settings: those that are read every time they’re used, and those 
that are read once when some process starts. Both types live in application 
context, so you can change any of them while running, but those changes might 
not take effect ever.

An example would be when configuring lager. If you were to change the lager 
handlers of a running node to [], you would expect logging to stop because you 
changed the configuration of lager. Lager has actually already set up all the 
handlers at launch, and you’d need to interact with Lager’s API to change them. 
So, now you’re operating in a state where the application configuration has 
changed, but the effective configuration has not. In this case, 
application:get_all_env() won’t return the true running configuration of Riak. 
In my opinion, this is an edge case, but not edgy enough to ignore. 

There are other settings like riak_core’s handoff_concurrency, which can be 
changed at runtime by attaching and calling application:set_env. So what we 
know is that you can change the running configuration, but that doesn’t always 
change what Riak is actually doing.

Now, if we were to ignore this case, and make the assumption that people aren’t 
attaching and changing settings, then we have a couple of options in the 2.0 
world. Every setting mapped by Cuttlefish has an explicit default value (unless 
that default is supposed to be ‘undefined’). When the app.config is generated 
it is generated as a “complete” app.config. What I mean is that every possible 
configuration setting will be defined, which means you don’t have to dig 
through source to find out what a specific application environment variable 
defaulted to. It will all be in one place. Here’s an example generated 
app.config: <a  rel="nofollow" href="https://gist.github.com/joedevivo/7320800">https://gist.github.com/joedevivo/7320800</a>

Actually, that’s the best you can do right now to see the “start time” 
configuration in Riak 2.0. Unfortunately, that’s still an Erlang configuration 
file, which goes against the spirit of Cuttlefish. I’m hoping to add some 
command line tools in the near future that will make reading your configuration 
easier. One would be to output the “start time” config in Cuttlefish’s syntax. 
The second I am considering is a kind of man-page looking thing, but it would 
output the documentation for a setting and include the default value and your 
value if you have changed it in your riak.conf file.

I hope that’s enough to answer your question. Follow up questions welcome, as 
well as opinions on the command line interface that’s still in the design phase.

—joe



On November 5, 2013 at 7:39:30 AM, Chris Read (chris.r...@gmail.com) wrote:

Glad someone there is thinking about configuration :D

Question - are you planning on making it just as easy to find out what the 
_running_ configuration is? Currently I have to resort to the:

riak-attach
application:get_all_env(...).

incantation to find out settings riak is actually using at the time. While I 
don't mind using attach, it's not always obvious what env you should be asking 
for in the first place...

Thanks,

Chris


On Mon, Nov 4, 2013 at 11:36 AM, Joe DeVivo &lt;jdev...@basho.com&gt; wrote:
Riak Users,

We've been kind of tiptoeing around the configuration changes for Riak 2.0. 
Mostly it was because I wanted to have a dramatic reveal at RICON|West. Now 
that you can see that here (<a  rel="nofollow" href="http://ricon.io/west2013.html">http://ricon.io/west2013.html</a> Day 1, Track 1, 
7:08:22), it's time for me to talk to you all about configuration.

A lot of what I want to say, I've already written in a cool blog post with 
fancy features like &quot;syntax highlighting&quot; and &quot;hyperlinks&quot;. I encourage you to 
read my story here: <a  rel="nofollow" href="https://github.com/joedevivo/ricon/blob/master/cuttlefish.md">https://github.com/joedevivo/ricon/blob/master/cuttlefish.md</a>

The biggest issue I have with the state of configuration in the 2.0 tech 
preview is the lack of documentation. Changing how we do configuration is going 
to affect almost all of the documentation. We're working on that already, but 
in the interim, here's a gist of mappings from old config style to new style: 
<a  rel="nofollow" href="https://gist.github.com/joedevivo/7305410">https://gist.github.com/joedevivo/7305410</a> I'll do my best to keep updating that 
gist as we make changes to the configuration settings.

As you thumb through that gist, please note that some variable names in the 2.0 
configuration file may change before release. Cuttlefish makes changing the 
names of these variables easy, and some names were just transposed from their 
Erlang counterparts. If you have a better name for some setting in Riak, please 
reach out to me. While I can't promise to use your suggestion, I'm always 
interested in how people are actually thinking about configuration.

Stay rad,
--joe

---
Software Engineer at Basho
@joedevivo
jdev...@basho.com
irc: joedevivo

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>


</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg12852.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd7.html#12854">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail7.html#12854">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg12855.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg12835.html">Configuring Riak 2.0</a></span> <span class="sender italic">Joe DeVivo</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12852.html">Re: Configuring Riak 2.0</a></span> <span class="sender italic">Chris Read</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Configuring Riak 2.0</span> <span class="sender italic">Joe DeVivo</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg12855.html">Re: Configuring Riak 2.0</a></span> <span class="sender italic">Chris Read</span></li>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Configuring Riak 2.0">
<input type="hidden" name="msgid" value="etPan.52793540.1befd79f.a25c@Black13.local">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg12854.html">
<input type="submit" value=" Joe DeVivo ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Configuring+Riak+2.0%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg12852.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg12855.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">etPan.52793540.1befd79f.a25c@Black13.local</li>
</ul>
</div>
</body>
</html>
