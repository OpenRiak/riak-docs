<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: is there easy way to transfer mongo collections to riak?</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#06713" id="c">
<link rel="index" href="maillist.html#06713" id="i">
<link rel="prev" href="msg06705.html" id="p">
<link rel="next" href="msg06715.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg06713.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+is+there+easy+way+to+transfer+mongo+collections+to+riak%5C%3F%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: is there easy way to transfer mongo collections to riak?</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Will+Moss%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Will Moss</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20120223" rel="nofollow">Thu, 23 Feb 2012 10:23:25 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hey Dominik,

To answer the question in your subject line, no. To quote one of the guys I
work with, &quot;You're the bitch of data.&quot; That said, I'm extremely happy we
did it. Riak does what it says it's going to do when it says it will and
doesn't seem to really ever go down. I can't say the same for Mongo.</pre><pre>

We did this for some of the data we have in Mongo (and are planning to move
the rest in the near future) and it certainly wasn't painless. What we did
that worked reasonably well was:
1. Change all our mongo query patterns so that we were effectively using it
a key-value store (i.e. no secondary indexes or other complex queries).
2. Write code that read an existing record from Mongo and wrote it to Riak.
The actual schema stayed about the same, but we decided to go with protocol
buffers in Riak since they are much more efficient at representing data. We
mapped a single collection to a single bucket in Riak.
3. Change all the queries to Riak instead of Mongo.
4. Then, when we were ready to actually kick off the migration, we migrated
uses as the logged in. So, if they had not been migrated, we delayed their
login slightly while we copied the necessary data out of mongo and into
Riak.

The biggest problem we ran into was conflict resolution. We did a few
things wrong with our resolution function early on that caused our cluster
to get very angry (read: tap out gigabit between the nodes). The best
advice I can give you when your new cluster starts running is to watch the
object size and sibling count numbers like a hawk. If either of those look
like they are consistently rising, I'll wager most anything that you've got
a problem is your resolution code.

Happy to provide more lessons learned if you have specific questions once
you get started.

Will


2012/2/23 Dominik Magoń &lt;domi...@magon.pl&gt;

&gt; Hi,
&gt;
&gt; I'm considering to change mongo to riak - was trying to find what's the
&gt; best way to get data from mongo collections and put them to the riak?
&gt;
&gt; Thanks,
&gt; Dominik
&gt; _______________________________________________
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg06705.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#06713">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#06713">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg06715.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg06705.html">is there easy way to transfer mongo collections to riak?</a></span> <span class="sender italic">Dominik Magoń</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: is there easy way to transfer mongo collections t...</span> <span class="sender italic">Will Moss</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg06715.html">Re: is there easy way to transfer mongo collectio...</a></span> <span class="sender italic">John E. Vincent</span></li>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: is there easy way to transfer mongo collections to riak?">
<input type="hidden" name="msgid" value="CAFqJMcO=LZjjiHOHBavdLhWto=bbfd394PWNnCsW4ySgaCX9MQ@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg06713.html">
<input type="submit" value=" Will Moss ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+is+there+easy+way+to+transfer+mongo+collections+to+riak%5C%3F%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg06705.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg06715.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAFqJMcO=LZjjiHOHBavdLhWto=bbfd394PWNnCsW4ySgaCX9MQ@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
