<!DOCTYPE html>
<html lang="en">
<head>
<title>Riak 1.4.12 and siblings</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="thrd2.html#15399" id="c">
<link rel="index" href="mail2.html#15399" id="i">
<link rel="prev" href="msg15397.html" id="p">
<link rel="next" href="msg15402.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg15399.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+1.4.12+and+siblings%22&amp;o=newest" rel="nofollow"><span itemprop="name">Riak 1.4.12 and siblings</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Henning+Verbeek%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Henning Verbeek</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20141222" rel="nofollow">Mon, 22 Dec 2014 03:04:01 -0800</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>We're using a number of Riak 1.4 nodes in a cluster. In front of it is
our java-based &quot;Storage-Backend&quot; (our own version of Riak-CS, custom
built to our requirements), which connects to localhost Riak. The Riak
nodes are linked over IPSec-links. All of this is running on cheap
commodity hardware, and thanks to the nature of Riak we can deal with
node failures. We're learning to embrace the concept of enventual
consistency and are using conflict resolvers to deal with siblings.</pre><pre>

Recently we upgraded from 1.4.10 to 1.4.12, and we're having the
impression that this version performs worse. The rate of sibling
creation feels much higher (but I don't have solid data to back this
up).

We've also noticed a few occasions where our conflict resolver was
unable to do its job. Manual investigation showed that an object had
siblings with *identical vtags*, but only sometimes!! From memory,
this is what happened:

- Storage-Backend throws Unresolved Conflict Exception with object
&quot;abc123&quot; of bucket &quot;chunks&quot;
- Repeatedly issuing 'curl --head
<a  rel="nofollow" href="http://localhost:8087/buckets/chunks/keys/abc123">http://localhost:8087/buckets/chunks/keys/abc123</a>' returns half the
time HTTP 200 and half the time HTTP 300
- When getting the HTTP 300 response, the output of  'curl
<a  rel="nofollow" href="http://localhost:8087/buckets/chunks/keys/abc123">http://localhost:8087/buckets/chunks/keys/abc123</a>' was something like
this:
Siblings:
4BaLvqdDSd8qYicDsn3DS4
4BaLvqdDSd8qYicDsn3DS4

The solution was to manually retrieve the object (specifying the vtag)
and uploading it again (specifying the Vclock).


My questions:
- Is anyone else experiencing similar issues, maybe even with 1.4.12?
- Is it possible (or even worthwhile) to downgrade to 1.4.10?

Thanks a bunch!
Cheers,
Henning

_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg15397.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="thrd2.html#15399">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="mail2.html#15399">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg15402.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">

</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Riak 1.4.12 and siblings">
<input type="hidden" name="msgid" value="CAOVDbHY_3c8+L-Y-NwK9M=kVDxj-bxETo+wkRVmipQKz1UJjCg@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg15399.html">
<input type="submit" value=" Henning Verbeek ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Riak+1.4.12+and+siblings%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg15397.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg15402.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">CAOVDbHY_3c8+L-Y-NwK9M=kVDxj-bxETo+wkRVmipQKz1UJjCg@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
