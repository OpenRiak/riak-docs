---
title: "Re: High Memory Utilization"
description: ""
project: community
lastmod: 2012-07-30T08:03:53-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08124"
mailinglist_parent_id: "msg08122"
author_name: "Antonio Ye"
project_section: "mailinglistitem"
sent_date: 2012-07-30T08:03:53-07:00
---


So I set cache\_size to 8388608 or 8 MB which according to the
documentation is the default but Riak still uses 4.1 GB of RAM. I
loaded 20 million records this time instead of the original 10
million. Does anyone know if replicas are also cached in elevelDB?


On Mon, Jul 30, 2012 at 7:49 AM, Reid Draper  wrote:
> I'd recommend lowering some of the leveldb configuration
> defaults [1]. I'd start with the cache size. You'll notice that
> most of these settings are \_per\_ \_vnode\_, which means
> for your single-node cluster with 64 partitions (vnodes),
> the defaults are likely a bit high for 10MM values.
>
> It's also worth mentioning that Riak is not intended to be run
> on a single node.
>
> Reid
>
> On Jul 29, 2012, at 2:01 PM, Antonio Ye wrote:
>
>> this is on a single node and my ring\_creation\_size is 64.
>>
>> ring\_num\_partitions : 64
>> ring\_ownership : <<"[{'riak@127.0.0.1',64}]">>
>> ring\_creation\_size : 64
>>
>> Thanks,
>> Tony
>>
>>
>> On Sun, Jul 29, 2012 at 9:12 AM, Reid Draper  wrote:
>>> Hi Antonio,
>>>
>>> How many nodes do you have in your cluster? What is
>>> the ring size ({ring\_creation\_size, N} in app.config)?
>>> Are you seeing 3.6GB of memory used \_per\_ machine,
>>> or total across the cluster?
>>>
>>> Reid
>>>
>>>
>>> On Jul 29, 2012, at 2:37 AM, Antonio Ye wrote:
>>>
>>>> I am using Riak as the persistence data store for a distributed data
>>>> grid so I really do not care to use Riak's or in my case eLevelDb's
>>>> cache. The problem I have is that when I load 10 million keys into
>>>> Riak it is taking 3.6g of memory. I have not set any of the eLevelDb
>>>> backend configuration parameters therefore I expect Riak to use the
>>>> defaults specified in the documentation. My bucket name is 7
>>>> characters and my keys are 7 characters. Any ideas on how to make
>>>> Riak/eLevelDb use as little memory as possible?
>>>>
>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>>> riak-users mailing list
>>>> riak-users@lists.basho.com
>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

