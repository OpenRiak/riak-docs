---
title: "Re: Corruption of leveldb database files"
description: ""
project: community
lastmod: 2012-01-26T04:34:19-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06426"
mailinglist_parent_id: "msg06425"
author_name: "Kresten Krab Thorup"
project_section: "mailinglistitem"
sent_date: 2012-01-26T04:34:19-08:00
---


FYI, The LevelDB bug we observed when running out of disk space (bug ID #63 in 
leveldb's issue list) is also reported fixed now. 

Kresten

On 26/01/2012, at 13.26, "Thomas Bakketun"  wrote:

> Hello,
> 
> A fix for this bug in leveldb has been released now. I would recommend
> that a service release of Riak with this fix included is done as soon as
> possible.
> 
> 
> On 2012-01-16 17:52, David Smith wrote:
>> Thomas,
>> 
>> Thanks for the heads up -- I saw that bug report on the Level repo this 
>> morning.
>> 
>> D.
>> 
>> On Mon, Jan 16, 2012 at 9:50 AM, Thomas Bakketun
>>  wrote:
>>> Hello,
>>> 
>>> We have found a bug in leveldb that causes corruption of the CURRENT
>>> file of leveldb databases. A bug report has been filed:
>>> http://code.google.com/p/leveldb/issues/detail?id=68
>>> 
>>> This bug can easily be reproduced by restarting restarting Riak and
>>> force of the computer within 30 to 60 seconds. After reboot at least one
>>> corrupt leveldb database can be expected. When this happens Riak fails
>>> to start and logs this message:
>>> 
>>> Failed to start riak\_kv\_eleveldb\_backend Reason: {db\_open,"Corruption:
>>> CURRENT file does not end with newline"}
>>> 
>>> Switching on the sync flag for leveldb has no effect.
>>> 
>>> --
>>> Thomas Bakketun, Senior software developer
>>> T. +47 21 53 69 40
>>> Copyleft Solutions
>>> www.copyleftsolutions.com
>>> 
>>> 
>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>> riak-users mailing list
>>> riak-users@lists.basho.com
>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>> 
>> 
> 
> 
> -- 
> Thomas Bakketun, Senior software developer
> T. +47 21 53 69 40
> Copyleft Solutions
> www.copyleftsolutions.com
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

