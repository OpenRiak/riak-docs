---
title: "RE: Riak 1.3 YCSB Read Time Out"
description: ""
project: community
lastmod: 2013-07-13T09:07:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11513"
mailinglist_parent_id: "msg11512"
author_name: "Nika Abramova"
project_section: "mailinglistitem"
sent_date: 2013-07-13T09:07:56-07:00
---


Greetings,Thank you for help. I changed what you said but it was not enough. 
However, I noticed a Warning about "ulimit -n" is being low, 4096 is 
recommended. So I increased mine to max value I can and was able to load 
100.000 records. Now I have to load 200.000 and 600.000 records but if 
something goes wrong I know the reason.Once again, thanks for help.
Have a nice day.Regards, Veronika

Date: Fri, 12 Jul 2013 21:10:11 -0400
Subject: Re: Riak 1.3 YCSB Read Time Out
From: dparf...@basho.com
To: ni...@hotmail.com
CC: riak-users@lists.basho.com

Hello Veronika -

It looks like you are out of memory. You could try turning active anti-entropy 
off via:

 {anti\_entropy, {off, []}},

in app.config [0].
Some other docs that you may find useful are the operations guide [1], choosing 
a backend [2], Linux performance tuning [3], and file system tuning [4].

Cheers -Dave
[0] http://docs.basho.com/riak/latest/references/Configuration-Files/

[1] http://docs.basho.com/riak/latest/operators.html
[2] http://docs.basho.com/riak/latest/tutorials/choosing-a-backend/
[3] http://docs.basho.com/riak/latest/cookbooks/Linux-Performance-Tuning/[4] 
http://docs.basho.com/riak/latest/cookbooks/File-System-Tuning/




On Fri, Jul 12, 2013 at 4:39 PM, Nika Abramova  wrote:




Hello,I have got logs and error. So what I got from log was (part of it since 
it goes all same):2013-07-12 06:33:35.674 [error] <0.1048.0> gen\_server 
<0.1048.0> terminated with reason: no match of right hand value 
{error,{db\_write,"IO error: 
./data/anti\_entropy/639406966332270026714112114313373821099470487552/000003.log:
 Cannot allocate memory"}} in hashtree:flush\_buffer/1 line 302
2013-07-12 06:33:35.683 [error] <0.1048.0> CRASH REPORT Process <0.1048.0> with 
0 neighbours exited with reason: no match of right hand value 
{error,{db\_write,"IO error: 
./data/anti\_entropy/639406966332270026714112114313373821099470487552/000003.log:
 Cannot allocate memory"}} in hashtree:flush\_buffer/1 line 302 in 
gen\_server:terminate/6 line 747
2013-07-12 06:33:35.688 [error] <0.28642.0> CRASH REPORT Process <0.28642.0> 
with 0 neighbours exited with reason: no match of right hand value 
{error,{db\_open,"IO error: lock 
./data/anti\_entropy/639406966332270026714112114313373821099470487552/LOCK: 
Resource temporarily unavailable"}} in hashtree:new\_segment\_store/2 line 499 in 
gen\_server:init\_it/6 line 328
2013-07-12 06:33:36.150 [error] <0.968.0> gen\_server <0.968.0> terminated with 
reason: no match of right hand value {error,{db\_write,"IO error: 
./data/anti\_entropy/525227150915793236229449236757414210188850757632/000003.log:
 Cannot allocate memory"}} in hashtree:flush\_buffer/1 line 302
2013-07-12 06:33:36.158 [error] <0.968.0> CRASH REPORT Process <0.968.0> with 0 
neighbours exited with reason: no match of right hand value 
{error,{db\_write,"IO error: 
./data/anti\_entropy/525227150915793236229449236757414210188850757632/000003.log:
 Cannot allocate memory"}} in hashtree:flush\_buffer/1 line 302 in 
gen\_server:terminate/6 line 747
2013-07-12 06:33:36.164 [error] <0.29013.0> CRASH REPORT Process <0.29013.0> 
with 0 neighbours exited with reason: no match of right hand value 
{error,{db\_open,"IO error: lock 
./data/anti\_entropy/525227150915793236229449236757414210188850757632/LOCK: 
Resource temporarily unavailable"}} in hashtree:new\_segment\_store/2 line 499 in 
gen\_server:init\_it/6 line 328
2013-07-12 06:33:36.261 [error] <0.1436.0> gen\_server <0.1436.0> terminated 
with reason: no match of right hand value {error,{db\_write,"IO error: 
./data/anti\_entropy/1187470080331358621040493926581979953470445191168/000003.log:
 Cannot allocate memory"}} in hashtree:flush\_buffer/1 line 302
2013-07-12 06:33:36.268 [error] <0.1436.0> CRASH REPORT Process <0.1436.0> with 
0 neighbours exited with reason: no match of right hand value 
{error,{db\_write,"IO error: 
./data/anti\_entropy/1187470080331358621040493926581979953470445191168/000003.log:
 Cannot allocate memory"}} in hashtree:flush\_buffer/1 line 302 in 
gen\_server:terminate/6 line 747
2013-07-12 06:33:36.317 [error] <0.29134.0> CRASH REPORT Process <0.29134.0> 
with 0 neighbours exited with reason: no match of right hand value 
{error,{db\_open,"IO error: lock 
./data/anti\_entropy/1187470080331358621040493926581979953470445191168/LOCK: 
Resource temporarily unavailable"}} in hashtree:new\_segment\_store/2 line 499 in 
gen\_server:init\_it/6 line 328
2013-07-12 06:33:36.878 [error] <0.29259.0> CRASH REPORT Process <0.29259.0> 
with 0 neighbours exited with reason: no match of right hand value 
{error,{db\_open,"IO error: 
./data/anti\_entropy/890602560248518965780370444936484965102833893376/000004.dbtmp:
 Cannot allocate memory"}} in hashtree:new\_segment\_store/2 line 499 in 
gen\_server:init\_it/6 line 328
2013-07-12 06:33:37.024 [error] <0.29263.0> CRASH REPORT Process <0.29263.0> 
with 0 neighbours exited with reason: no match of right hand value 
{error,{db\_open,"IO error: 
./data/anti\_entropy/159851741583067506678528028578343455274867621888/000004.dbtmp:
 Cannot allocate memory"}} in hashtree:new\_segment\_store/2 line 499 in 
gen\_server:init\_it/6 line 328
2013-07-12 06:33:37.041 [error] <0.29260.0> CRASH REPORT Process <0.29260.0> 
with 0 neighbours exited with reason: no match of right hand value 
{error,{db\_open,"IO error: 
./data/anti\_entropy/867766597165223607683437869425293042920709947392/000004.dbtmp:
 Cannot allocate memory"}} in hashtree:new\_segment\_store/2 line 499 in 
gen\_server:init\_it/6 line 328
2013-07-12 06:33:37.095 [error] <0.29265.0> CRASH REPORT Process <0.29265.0> 
with 0 neighbours exited with reason: no match of right hand value 
{error,{db\_open,"IO error: 
./data/anti\_entropy/639406966332270026714112114313373821099470487552/000004.dbtmp:
 Cannot allocate memory"}} in hashtree:new\_segment\_store/2 line 499 in 
gen\_server:init\_it/6 line 328

Exception I get is that:Loading workload...Starting 
test.java.net.SocketTimeoutException: Read timed out
 at java.net.SocketInputStream.socketRead0(Native Method) at 
java.net.SocketInputStream.read(SocketInputStream.java:150)
 at java.net.SocketInputStream.read(SocketInputStream.java:121) at 
java.io.BufferedInputStream.fill(BufferedInputStream.java:235)
 at java.io.BufferedInputStream.read(BufferedInputStream.java:254) 
at java.io.DataInputStream.readInt(DataInputStream.java:387)
 at com.basho.riak.pbc.RiakConnection.receive(RiakConnection.java:110) 
at com.basho.riak.pbc.RiakClient.store(RiakClient.java:581)
 at 
com.basho.riak.client.raw.pbc.PBClientAdapter.store(PBClientAdapter.java:177) 
 at 
com.basho.riak.client.raw.pbc.PBClientAdapter.store(PBClientAdapter.java:197)
 at 
com.basho.riak.client.raw.ClusterClient.store(ClusterClient.java:139) at 
com.yahoo.ycsb.db.RiakClient13.insert(RiakClient13.java:184)
 at com.yahoo.ycsb.DBWrapper.insert(DBWrapper.java:148) at 
com.yahoo.ycsb.workloads.CoreWorkload.doInsert(CoreWorkload.java:461)
 at com.yahoo.ycsb.ClientThread.run(Client.java:269)Any ideas?
Regards, Veronika
Date: Fri, 12 Jul 2013 11:31:36 -0400

Subject: Re: Riak 1.3 YCSB Read Time Out
From: dparf...@basho.com
To: ni...@hotmail.com
CC: riak-users@lists.basho.com


Hello Veronika -
 We're actively working on the YCSB project located at [0]. It should work 
fine with Riak 1.4. Since the existing implementation of YCSB is a 
work-in-progress, you can't trust any results it gives you until we get it 
merged upstream with the official YCSB repo. I'm not sure what's causing the 
"Read timed Out" exception, can you provide any logs?


Cheers -Dave
[0] https://github.com/basho-labs/YCSB





On Fri, Jul 12, 2013 at 11:23 AM, Nika Abramova  wrote:




Thank you for reply. Of course I can try new version but will I be able to run 
YCSB for 1.3 over 1.4? This is my concern. What is the minimal RAM required for 
Riak to work correctly? I mean, what I am doing is inserting 100.000 records at 
once. 


Regards, Veronika

Date: Fri, 12 Jul 2013 16:07:23 +0100
From: guido.med...@temetra.com
To: riak-users@lists.basho.com


Subject: Re: Riak 1.3 YCSB Read Time Out


 
 
 
 
 Hi Veronika,

 

 Riak 1.4.0 was released yesterday, with the new streaming features
 nodes will stream keys to you instead of working with the whole
 result in memory, which will probably avoid the timeout.

 

 Though your RAM and specially using a VM could be a limiting factor,
 still worthy a try.

 Once your node is up type riak-admin diag and see if some parameters
 need to be adjusted.

 

 For more information on tuning:
 http://docs.basho.com/riak/latest/cookbooks/Linux-Performance-Tuning/

 

 HTH,

 

 Guido.

 

 On 12/07/13 14:58, Nika Abramova wrote:

 
 
 
 Greetings,
 I am currently testing different NoSQL databases and now I
 was starting Riak. I downloaded and installed Riak 1.3 and was
 executing YCSB over it. But after some time (40 sec) of
 loading data, I got "Read timed Out" exception. 
 How can I solve it? I am working locally, on same machine
 so my connection is to localhost. Is that lack of RAM that
 causing that? Since I am using VM and I only have 2GB RAM for
 it. Or it is something else I can configure?
 

 
 Regards, Veronika
 
 

 
 

 \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

 
 

 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

riak-users mailing list

riak-users@lists.basho.com

http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

riak-users mailing list

riak-users@lists.basho.com

http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



 \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

