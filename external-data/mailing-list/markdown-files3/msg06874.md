---
title: "Re: Search and Erlang client"
description: ""
project: community
lastmod: 2012-03-05T03:30:57-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06874"
mailinglist_parent_id: "msg06762"
author_name: "Doug Selph"
project_section: "mailinglistitem"
sent_date: 2012-03-05T03:30:57-08:00
---


Hi Dan,

It took me several days to get back to this issue; my apologies. I was able
to track down what was happening. Bottom line is this: I was creating a new
Riak object with the desired content type. I was then updating the metadata
on the new object before saving it in order to add 2i information. The
updated metadata did not include the content type, so I was clobbering it
before saving. The resulting content type was 'application/octet-stream'

Thanks for your replies.
Doug


On Mon, Feb 27, 2012 at 5:52 PM, Dan Reverri  wrote:

> Hi Doug,
>
> The Erlang client will use whatever content-type is set by the user. Can
> you provide an example of how you are creating your objects?
>
> The following worked for me:
> {ok, Pid} = riakc\_pb\_socket:start\_link("127.0.0.1", 8087).
> O = riakc\_obj:new(<<"bucket">>, <<"key">>, <<"{\"foo\":\"bar\"}">>,
> <<"application/json">>).
> riakc\_pb\_socket:put(Pid, O).
>
> Thanks,
> Dan
>
> Daniel Reverri
> Developer Advocate
> Basho Technologies, Inc.
> d...@basho.com
>
>
> On Mon, Feb 27, 2012 at 11:17 AM, Doug Selph  wrote:
>
>> Hi Dan,
>>
>> Well, I'm stumped. When creating the object, I pass "application/json" as
>> content-type, but all my objects have content-type set to
>> "application/octet-stream"
>>
>> Does the erlang client save everything as a binary?
>>
>> Thanks,
>> Doug
>>
>>
>> On Mon, Feb 27, 2012 at 12:10 PM, Dan Reverri  wrote:
>>
>>> Hi Doug,
>>>
>>> Can you confirm the "Content-Type" header is set to "application/json"
>>> by reading the JSON objects you stored?
>>>
>>> Can you share an example JSON object as well as an example query you are
>>> running with "search-cmd"?
>>>
>>> Thank you,
>>> Dan
>>>
>>> Daniel Reverri
>>> Developer Advocate
>>> Basho Technologies, Inc.
>>> d...@basho.com
>>>
>>>
>>> On Sun, Feb 26, 2012 at 9:01 PM, Doug Selph  wrote:
>>>
>>>> I'm having trouble with riak-search. If I use the seach-cmd command
>>>> line tool to index text files, I can search the index using both search-cmd
>>>> and the sold interface. However, when I store JSON objects via the erlang
>>>> protocol buffers client, in a bucket which has the search pre-commit
>>>> trigger installed, searches in that index always return 0 matches for
>>>> search terms which have matches in the bucket. (I have saved these objects
>>>> to the bucket after the pre-commit trigger was installed.)
>>>>
>>>> Is there a trick to this? It is my understanding that there is a
>>>> default schema for JSON objects, which should be sufficient as a starting
>>>> point.
>>>>
>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>>> riak-users mailing list
>>>> riak-users@lists.basho.com
>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>>
>>>>
>>>
>>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

