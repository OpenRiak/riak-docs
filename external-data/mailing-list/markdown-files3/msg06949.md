---
title: "Re: preflist_exhausted with map-reduce and riak-js"
description: ""
project: community
lastmod: 2012-03-13T18:17:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06949"
mailinglist_parent_id: "msg06945"
author_name: "Matthew Tovbin"
project_section: "mailinglistitem"
sent_date: 2012-03-13T18:17:57-07:00
---


Hi,

I got the same problem today on 1.1.0.

As suggested, I updated all the nodes to 1.1.1. The error remains the same:

{ stack: [Getter/Setter],
 arguments: undefined,
 type: undefined,
 message: 'HTTP error 500:
{"phase":0,"error":"[preflist\_exhausted]","input":"{ok,{r\_object ....."}}}


-Matthew



On Tue, Mar 13, 2012 at 06:48, Jon Meredith  wrote:

> Hi Arne,
>
> Could you try with 1.1.1 please. We've fixed a number of bugs with how
> MapReduce handles errors that could explain some of what you are seeing.
>
> Jon
>
>
> On Tue, Mar 13, 2012 at 12:55 AM, Arne Claassen wrote:
>
>> I'm running 1.1.0 built from source on Centos 6. I set up two nodes on
>> localhost following the instructions on the basho site for testing and
>> everything was going fine until i needed to fetch all items in a bucket.
>>
>> For this i was using node.js with riak-js and it's db.getAll call,which
>> from the debug logs looks like it uses /mapred
>>
>> The bucket only has about 1200 items in it, each a json payload of about
>> 3KB. Initially, it'd keep getting inconsistent results, sometimes the data
>> would come back, sometimes data would be undefined. So i kept running it,
>> trying to see if there was a pattern, adding more debugging code, etc. But
>> still it would be about a request every couple of seconds. Then it just
>> stopped working altogether and now i always get:
>>
>> { [Error: HTTP error 500:
>> {"phase":0,"error":"[preflist\_exhausted]","input":"{ok,{r\_object,<<\"tweets\_15368536\">>,<<\"178528155714330620\">>,[{r\_content,{dict,6,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[[<<\"Links\">>]],[],[],[],[],[],[],[],[[<<\"content-type\">>,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110],[<<\"X-Riak-VTag\">>,49,76,115,54,70,75,74,71,119,65,111,70,88,73,117,84,98,88,79,69,52,116]],[[<<\"index\">>]],[],[[<<\"X-Riak-Last-Modified\">>|{1331,487523,218968}]],[],[[<<\"X-Riak-Meta\">>]]}}},<<\"{\"coordinates\":null,\"create...\">>}],...},...}","type":"forward\_preflist","stack":"[]"}]
>> statusCode: 500 }
>>
>> in the console. I haven't tried restarting riak, just because i'd rather
>> find out what's happening than it going away and coming back later when i
>> don't expect it.
>>
>> Any suggestions on how to troubleshoot this? I can still access items
>> individually and i can even list the keys via ?keys=true, it's just he map
>> reduce that seems to be busted.
>>
>> cheers,
>> arne
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>
>
>
> --
> Jon Meredith
> Platform Engineering Manager
> Basho Technologies, Inc.
> jmered...@basho.com
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

