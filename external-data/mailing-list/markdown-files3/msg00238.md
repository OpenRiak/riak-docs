---
title: "Re: keys=stream"
description: ""
project: community
lastmod: 2010-05-04T06:28:33-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00238"
mailinglist_parent_id: "msg00237"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-05-04T06:28:33-07:00
---


Are you using curb or net/http?

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On May 4, 2010, at 9:26 AM, Adam Hunter wrote:

> The problem I was running into was some of the chunks were only part of the 
> json object. Decoded it would be something like this:
> 
> chunk 1: {'keys':[1,2,3,4
> chunk 2: 5,6,7,8,9]}
> 
> I was running this on a bucket with about 11k keys. Using ripple I could 
> only get about 150 keys back this way because all the other chunks were not 
> valid json. I hacked around this for now by checking to see if the chunk 
> ends in ]}, otherwise I accumulate chunks until I have a full json object.
> 
> Thanks,
> 
> Adam
> 
> 
> On May 4, 2010, at 9:22 AM, Sean Cribbs wrote:
> 
>> This behavior is unchanged since its implementation in 0.8 or 0.9. To 
>> better demonstrate what that statement means, here's the joined output of a 
>> streamed keys response:
>> 
>> {"props":{"name":"foo","n\_val":3,"allow\_mult":false,"precommit":[],"postcommit":[],"chash\_keyfun":{"mod":"riak\_core\_util","fun":"chash\_std\_keyfun"},"linkfun":{"mod":"riak\_kv\_wm\_link\_walker","fun":"mapreduce\_linkfun"},"old\_vclock":86400,"young\_vclock":20,"big\_vclock":50,"small\_vclock":10}}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}{"keys":[]}
>> 
>> If your client library supports per-chunk processing, each of those 
>> {"keys":[]} objects will be an encoded chunk. The Ruby client and most of 
>> the other clients support this.
>> 
>> Sean Cribbs 
>> Developer Advocate
>> Basho Technologies, Inc.
>> http://basho.com/
>> 
>> On May 3, 2010, at 9:28 PM, Adam Hunter wrote:
>> 
>>> Hi All,
>>> 
>>> I apologize if this has been covered already.
>>> 
>>> In the wiki it says "If keys=stream, the response will be transferred using 
>>> chunked-encoding, where each chunk is a JSON object" (on 
>>> http://wiki.basho.com/display/RIAK/REST+API)
>>> 
>>> This doesn't seem to be the case, sometimes a json object is broken into 
>>> several chunks. Is this behavior correct?
>>> 
>>> Thanks,
>>> 
>>> Adam
>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>> riak-users mailing list
>>> riak-users@lists.basho.com
>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>> 
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

