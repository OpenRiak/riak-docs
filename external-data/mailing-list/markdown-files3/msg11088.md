---
title: "Re: Receiving ulimit warning despite setting it"
description: ""
project: community
lastmod: 2013-05-15T21:56:07-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11088"
mailinglist_parent_id: "msg11087"
author_name: "Toby Corkindale"
project_section: "mailinglistitem"
sent_date: 2013-05-15T21:56:07-07:00
---



On 16/05/13 14:39, Toby Corkindale wrote:

On 16/05/13 14:24, Jared Morrow wrote:

Well the riak-cs / riak / stanchion scripts all drop privileges using
sudo. On RHEL/Centos this sudo exec carries the settings from the
calling user (in the case of init.d, root) so things are fine there. On
Ubuntu/Debian that does not always work. So if you set the ulimit for
the root user, it might not propagate through to the riak-cs / riak /
stanchion users.

So to change that, you should try to change it in
/etc/security/limits.conf.


My understanding is that only sessions opened through PAM will be
effected by the limits.d/\* config files. ie. Not daemon processes.
(I've checked this anyway with the following
/etc/security/limits.d/riakcs.conf:
riak-cs hard nofile 32002
riak-cs soft nofile 32001
)

As noted previously, this problem was not occurring on the current
Ubuntu LTS nodes; just the Debian Squeeze ones. Which makes it
particularly odd.

Thanks for your help so far; I'll continue to investigate and report
back if I find a solution.


I realised that the Riak CS user was called "riakcs" and not "riak-cs".
Once I changed that in the limits.d/riakcs.conf file, riakcs started 
working without the file warning.


I also added in a line for the regular "riak" user while I was there.

May I suggest you add this to the debian/ubuntu packages by default?
(ie. a file in /etc/security/limits.d/ )


Cheers,
Toby

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

