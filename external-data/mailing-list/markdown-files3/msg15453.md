---
title: "RE: Deleting a strongly consistent key"
description: ""
project: community
lastmod: 2015-01-09T01:56:27-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15453"
mailinglist_parent_id: "msg15450"
author_name: "Zsolt Laky"
project_section: "mailinglistitem"
sent_date: 2015-01-09T01:56:27-08:00
---


Hello Drew,

Thinking through the delete operation on a strong consistent bucket, a
question popped up for me.

Should not we use delete\_object instead to keep strong consistency? The
delete function takes a key and does not care about the current state/value
of the object itself. If in the meantime another process changes the value
of an object, delete will simply delete it. So is there a benefit using
delete on strongly consistent bucket other than swipe the bucket not caring
about other processes store their state info?

Thanks for your thoughts,
Zsolt

-----Eredeti üzenet-----
Feladó: riak-users [mailto:riak-users-boun...@lists.basho.com] Meghatalmazó
Drew Pirrone-Brusse
Küldve: Thursday, January 08, 2015 12:32 AM
Címzett: Igor Birman
Másolatot kap: riak-users@lists.basho.com
Tárgy: Re: Deleting a strongly consistent key

Hello Igor,

Deletions should be a strongly consistent operation, yes. If after a
successful strongly consistent delete a GET of that key returns stale data
something is likely wrong, be it with your application, the cluster, or Riak
itself.

That said, deletions don't actually remove keys from Riak. Strongly
consistent deletions should behave identically to conditional PUTs, where
the value put is a tombstone. When Riak is running in an eventually
consistent mode, those tombstones are (sometimes) eventually harvested and
removed from disk. In the strongly consistent mode (as with `delete\_mode =
keep`) Riak will never harvest those tombstones, so they will remain on disk
indefinitely.
Our documentation has lots of good information, if you're looking for some
implementation details[1].

Generally speaking, if you know you're going to immediately re-use a key,
it's better to simply overwrite values than issuing an intermittent delete.

Best regards,
-Drew

[1]:
http://docs.basho.com/riak/latest/ops/advanced/strong-consistency/#Implement
ation-Details

On Wed, Jan 7, 2015 at 10:01 AM, Igor Birman  wrote:
> Is deleting a strongly consistent key a consistent operation? I have 
> found in testing that if I delete a key and then attempt to 
> immediately reuse it, sometimes the delete completes after I have 
> reused it. Should I expect that when I get a 204 from a delete that I 
> can immediately create a new key with the same id?
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


---
This email has been checked for viruses by Avast antivirus software.
http://www.avast.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

