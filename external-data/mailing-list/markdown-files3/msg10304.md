---
title: "Re: Wiping data directory break vnodes with read_block_error"
description: ""
project: community
lastmod: 2013-03-01T11:48:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10304"
mailinglist_parent_id: "msg10291"
author_name: "Jonas Lindmark"
project_section: "mailinglistitem"
sent_date: 2013-03-01T11:48:11-08:00
---


Thanks for the advice, I'll be sure to try it out soon and report back.

/jonas
On Feb 28, 2013 7:01 PM, "Brian Shumate"  wrote:

> Hello Jonas,
>
> I think the issue is that you actually wiped out too much by removing
> the entire /var/lib/riak directory.
>
> Typically when resetting the data directories on a Riak node, you'd remove
> the contents of only those backend directories which correspond to the ones
> defined in your app.config.
>
> For example, if you are using the Bitcask backend, you'd want to only do
> something like:
>
> riak stop
> sudo rm -rf /var/lib/riak/bitcask/\*
> riak start
>
> This removes all Bitcask data but preserves the node's ring state.
>
> If you wanted to reset \_both\_ the Bitcask data and the ring state you'd do:
>
> riak stop
> sudo rm -rf /var/lib/riak/bitcask/\*
> sudo rm -rf /var/lib/riak/ring/\*
> riak start
>
> This would essentially reset the node back to a new state while retaining
> any configuration changes you already specified in app.config or vm.args.
>
> I hope this helps.
>
> Regards,
>
> Brian Shumate
>
> On Feb 28, 2013, at 2:55 AM, Jonas Lindmark wrote:
>
> > Hi,
> >
> > I'm looking for a way to manually wipe the data off of a single-node
> riak installation. I'm using riak (1.3.0 2013-02-19) Debian x86\_64 with the
> riak\_kv\_eleveldb\_backend.
> >
> > What I'm currently doing is:
> >
> > • riak stop
> > • rm -rf /var/lib/riak
> > • mkdir riak
> > • chown riak:riak riak
> > • start riak
> > Riak starts ok but a riak-admin vnode-status gives me:
> >
> > Backend: riak\_kv\_eleveldb\_backend
> > Status:
> > [{stats,<<" Compactions\nLevel Files
> Size(MB) Time(sec) Read(MB)
> Write(MB)\n--------------------------------------------------\n">>},
> > {read\_block\_error,<<"0">>}]
> >
> > For each vnode.
> >
> > It seems to me that there is something more I need to wipe for this to
> work but I can't find which files that would be.
> >
> > /Jonas
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

