---
title: "Re: Riak search querying"
description: ""
project: community
lastmod: 2010-12-06T06:44:36-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01732"
mailinglist_parent_id: "msg01720"
author_name: "Rusty Klophaus"
project_section: "mailinglistitem"
sent_date: 2010-12-06T06:44:36-08:00
---


Hi Artem, The main problem is that your schema is using the
DefaultAnalyzerFactory, which (roughly speaking) tokenizes based on
punctuation, discards any tokens less than three characters in length, and
converts the tokens to lowercase. I'd recommend that you use the
WhitespaceAnalyzerFactory, which (as the name suggests) tokenizes based on
whitespace. (You can do this by setting the 'analyzer\_factory' schema
setting to "com.basho.search.analysis.WhitespaceAnalyzerFactor"). This will
cause your queries to act in the way you expect.

Once the next release of Riak Search is out, I'd recommend that you set
field-level analyzers according to the values you expect to put in the
different fields. So the "title" and "summary" fields should use the Default
analyzer, "storylink" and "fieldlink" should use the Whitespace analyzer,
and any integer fields should use the Integer analyzer. The reason I say to
do that after installing the \*next\* release is because there is a bug in the
\*current\* version of Riak Search whereby field-level analyzer settings are
not respected. This is fixed in the next release.

One last thing to mention: wildcards are only supported at the end of a
word. (So your query for "\*www.toolboxrecords.com\*" isn't working the way
you expect, and is probably returning results because it is getting split
into three separate queries for "www", "toolboxrecords", and "com".)

Best,
Rusty

On Sun, Dec 5, 2010 at 5:32 AM, Artem Golovinsky
wrote:

> Hi,
> I have some questions about Riak Search.
>
> I stored just one entry to RS: http://pastebin.com/2b5tybD1
>
> My bucket has following schema: http://pastebin.com/dtnM3diL
>
> 1. I need to get all objects where "storylink": "
> http://www.toolboxrecords.com/fr/product/12834/dubstep-grime-ukg/ruff-11/
> "
> When I try to get it by query -
> http://localhost:8098/solr/myfeed13/select?wt=json&q=storylink:"http://www.toolboxrecords.com/fr/product/12834/dubstep-grime-ukg/ruff-11/"
> , I get nothing.
> When I try to make query
> http://localhost:8098/solr/myfeed13/select?wt=json&q=storylink:"\*www.toolboxrecords.com\*"
> , all works correctly and I get content.
> Could you please describe how can I get content through first query?
>
> 2. I get my object by query
> http://localhost:8098/solr/myfeed13/select?wt=json&q=knownentities\_type:"Country"
> or
> http://localhost:8098/solr/myfeed13/select?wt=json&q=knownentities\_relevance:"0.914286
> "
> But I can't get they by 
> http://localhost:8098/solr/myfeed13/select?wt=json&q=knownentities\_count:
> "1"
> or http://localhost:8098/solr/myfeed13/select?wt=json&q=knownentities\_text:
> "UK"
>
> Why does it happen? However, all these fields are described similar in
> schema.
>
> 3. I try to get my entry -
> http://localhost:8098/solr/myfeed13/select?wt=json&q=categoryscores\_business:"0.\*
> "
> But result is nothing.
>
> As you can see "business" is nested field for "categoryscores" field.
> How can I get this entry?
>
>
> --
> Best regards,
> Artem Golovinsky
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

