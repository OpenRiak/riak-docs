---
title: "Re: Riak HTTPS listener hangs"
description: ""
project: community
lastmod: 2014-04-21T10:53:20-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14118"
mailinglist_parent_id: "msg14117"
author_name: "Adam Leko"
project_section: "mailinglistitem"
sent_date: 2014-04-21T10:53:20-07:00
---



On 4/21/14, 11:25 AM, Luke Bakken wrote:

If possible, could you please mail me directly your app.config,
vm.args and archive of log files (/var/log/riak) from one node, and
HAProxy configuration?


Let me check into this, I might be able to get you a copy of these after 
they have been appropriately cleaned up.



Have you tried having HAProxy as the SSL endpoint and then use
unencrypted HTTP traffic between HAProxy and Riak? I believe it's
typical to use HAProxy as the HTTPS endpoint rather than proxy the SSL
connection to the back-end services. I'm wondering if there's
something about using it in this manner that is contributing to this
scenario. Just a thought.


That's essentially the workaround we settled on. Since switching the 
connection between haproxy and Riak to HTTP instead of HTTPS we haven't 
had any other issues with hung requests to the Riak cluster.


I checked through the logs again and I did notice a few messages of the 
form '\*\* State machine <0.X.0> terminating' in the crash.log files, 
which I originally thought were due to server restarts. It seems very 
likely that the way haproxy is multiplexing traffic over SSL is causing 
the hangs. (Odd that it generally works for a while, though.)


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

