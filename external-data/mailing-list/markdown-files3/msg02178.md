---
title: "Re: Riak Cluster Setup on EC2"
description: ""
project: community
lastmod: 2011-02-02T12:22:14-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02178"
mailinglist_parent_id: "msg02176"
author_name: "John D. Rowell"
project_section: "mailinglistitem"
sent_date: 2011-02-02T12:22:14-08:00
---


You need to open the extra erlang ports in your security group. We do the
following:

In the security group, open up TCP port 4369 to 10.0.0.0/8, and ports
8000-8089 (or other range) to 10.0.0.0/8 also. This would allow any instance
(even those that are not yours) to access those ports, so we block those
outside of our cluster in our firewall script:

 # epmd from other replicas
 allow\_tcp\_in\_from 4369 "$CLUSTER"
 allow\_tcp\_in\_from "8000:8089" "$CLUSTER"

Then in app.config we redefine the erlang ports:

 {kernel, [
 {inet\_dist\_listen\_min, 8000},
 {inet\_dist\_listen\_max, 8088}
 ]}

You need to make sure that all machines in your cluster have these same
settings (firewall and app.config).

Hope this helps.

-jd

2011/2/2 Abhishek Kona 

> Hey,
>
> epmd -name gives the following on the nodes.
>
> #node1
>
> ubuntu@node2:~$ sudo epmd -names
>
> epmd: up and running on port 4369 with data:
>
> name riak at port 34358
>
> #node2
>
> ubuntu@node1:~$ sudo epmd -names
>
> epmd: up and running on port 4369 with data:
>
> name riak at port 42643
>
>
> I can telnet to the 4369 port on both the machines (from each other).
>
> Any ideas.
>
> Thanks
> -Abhishek Kona
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

