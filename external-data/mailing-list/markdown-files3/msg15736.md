---
title: "Re: Riak 2.0.4 Search AAE"
description: ""
project: community
lastmod: 2015-02-18T11:18:47-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15736"
mailinglist_parent_id: "msg15735"
author_name: "Zeeshan Lakhani"
project_section: "mailinglistitem"
sent_date: 2015-02-18T11:18:47-08:00
---


Well, that means that it is storing AAE data. Are you have consistency issues 
between what’s in KV (the canonical source) and Search/Solr? 

You can remove the data on every node by using 
`riak\_core\_util:rpc\_every\_member\_ann(yz\_entropy\_mgr, clear\_trees, [], 
infinity)` as well and then try to initialize AAE again. As you can see in this 
part of Ryan’s vid, https://www.youtube.com/watch?v=ETJqu5SmwOc#t=2290 
 (and our constants in 
https://github.com/basho/yokozuna/blob/47214a66e07fdfd04bbaae6bdd18580f87693edf/include/yokozuna.hrl#L187
 
),
 you can, via `riak attach`, update the environment vars of entropy\_expire, 
tick, and concurrency to speed up AAE in your testing of this bug.


Zeeshan Lakhani
programmer | 
software engineer at @basho | 
org. member/founder of @papers\_we\_love |
twitter => @zeeshanlakhani

> On Feb 18, 2015, at 1:21 PM, Steve Garon  wrote:
> 
> Hey Zeeshan, 
> 
> There is tons of data in yz\_anti\_entropy. Should I delete it before running 
> your command? 
> 
> 
> 
> 
> Steve
> 
> On 18 February 2015 at 09:49, Zeeshan Lakhani  > wrote:
> Hey Steve, I’ve run AAE manually by running `riak attach` on a running node 
> and calling 
> https://github.com/basho/yokozuna/blob/develop/src/yz\_entropy\_mgr.erl#L142 
>  
> (yz\_entropy\_mgr:init([])).
> 
> Nonetheless, to take a closer look, is there any data within search’s 
> data-directory? You can find out by looking in ./data/yz\_anti\_entropy (on any 
> of nodes). You can find more info in our docs, 
> http://docs.basho.com/riak/latest/ops/advanced/configs/search/ 
> , about 
> search’s config settings.
> 
> Zeeshan Lakhani
> programmer | 
> software engineer at @basho | 
> org. member/founder of @papers\_we\_love |
> twitter => @zeeshanlakhani
> 
>> On Feb 18, 2015, at 9:03 AM, Steve Garon > > wrote:
>> 
>> Hi all, 
>> 
>> I seem to have trouble with aae on riak 2.0.4. Specifically the search aae. 
>> When I run the command 'riak-admin aae-status' everything seems fine but if 
>> I run the same command for search (riak-admin search aae-status) it seem 
>> like the search entropy trees have never been built and never do. All I get 
>> on every field is --. 
>> 
>> Any command I can run to force the trees to be built so I get consistent 
>> search results? 
>> 
>> Steve
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com 
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
>> 
> 
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

