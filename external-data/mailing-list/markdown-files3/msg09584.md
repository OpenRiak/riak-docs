---
title: "Re: I can't show a pdf from webmachine"
description: ""
project: community
lastmod: 2012-12-14T13:01:17-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09584"
mailinglist_parent_id: "msg09582"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-12-14T13:01:17-08:00
---


Julio,

You can't just give it the filename, you need to read the file. Something
like this should work:

to\_pdf(ReqData, Context) ->
 {ok, Body} = file:read\_file("/root/sicap-rpt/reports/javascript.pdf"),
 {Body, ReqData, Context}.

On Fri, Dec 14, 2012 at 1:47 PM, Julio Cesar RÃ­os Gutierrez <
jctau...@gmail.com> wrote:

> My source do not show a pdf in my page everything else is fine,
>
> This is the source code:
>
> ==============================================================
> -module(rptPedidos\_resource).
>
> -export([init/1, allowed\_methods/2, process\_post/2]).
> -export([content\_types\_provided/2]).
> -export([to\_json/2, json\_body/1]).
>
> -include\_lib("webmachine/include/webmachine.hrl").
>
> %%init([]) -> {ok, undefined}.
> init(Config)->
> {{trace, "/tmp"}, Config}.
>
> allowed\_methods ( RD, Ctx )->
> {['POST','GET','HEAD'], RD, Ctx}.
>
> %%content\_types\_provided ( RD, Ctx )->
> %% {[{"application/json",to\_json}],RD,Ctx}.
>
> content\_types\_provided ( RD, Ctx )->
> {[{"application/pdf",to\_pdf}], RD, Ctx }.
>
> to\_pdf(ReqData, Context)->
> Body = "/root/sicap-rpt/reports/javascript.pdf",
> {Body, ReqData, Context}.
>
> to\_json ( RD, Ctx )->
> {json\_body (wrq:req\_qs(RD)), RD, Ctx}.
>
> process\_post ( RD, Ctx )->
> Data = mochiweb\_util:parse\_qs ( wrq:req\_body ( RD ) ),
> Struct = mochijson2:decode ( proplists:get\_value ( "json", Data ) ),
> Struct2 = proplists:get\_value ( "json", Data ),
> {struct, [{<<"nombre">>, Nombre }]} = Struct,
> RD1 = wrq:set\_resp\_header("Content-Type","application/pdf", RD ),
> Ans = "attachment;filename=/root/sicap-rpt/reports/javascript.pdf",
> RD2 = wrq:append\_to\_resp\_body ( Ans, RD1 ),
> {true, RD2,Ctx}.
>
> json\_body ( QS )->
> mochijson:encode ( { struct, QS } ).
>
>
> ===============================================================
>
> any ideas why is wrong?
>
> --
> JCesar
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

