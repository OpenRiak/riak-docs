---
title: "Re: data modeling question"
description: ""
project: community
lastmod: 2012-09-26T02:54:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08701"
mailinglist_parent_id: "msg08696"
author_name: "Rune Skou Larsen"
project_section: "mailinglistitem"
sent_date: 2012-09-26T02:54:57-07:00
---



On 25-09-2012 23:18, Charlie Bowman wrote:
Can I load 10 messages in 1 call? similar to a sql call "select \* from 
messages where id in (1,2,3,4,5,6,7,8)"
You can specify an array of keys as inputs to a MapReduce job. 
http://wiki.basho.com/MapReduce-Implementation.html#Inputs
MR jobs can be slow - especially if they involve javascript. Link 
Walking also fires up a MR job so it has some of the same performance 
penalties.


Whether Link Walking/MR is faster than just getting all values 
individually depends on a lot of things. To name some: Your network 
latency between client and riak, how many values you get, how big they 
are, if you are able to parallelize retrieval of the individual values.


If you have 10ms latency between client and Riak and have to get 100 
Messages sequentially, then my money is on LW/MR to be faster.
If you have <1 ms latency, 10 messages and can get them in 1 + 10 
parallel calls, then I'm not so sure, which is fastest.


It would be interesting with some performance tests!
"If you need to read PlayerMessage and corresponding Messages in one 
go, you can model the relation from PlayerMessage to Message with Riak 
Links, and avoid a database roundtrip by using link walking."


 If I do this, would I need to keep a second array in the
 PlayerMessage object to then also map which messages have been
 read?

Link Walking doesn't care what's inside your JSON. Link walking is based 
on metadata that you specify, when you PUT the Riak object.
Here is a good example on how you can specify the links using HTTP 
headers, and walk them afterwards: 
http://basho.com/blog/technical/2010/02/24/link-walking-by-example/


As Links have "tags", you can add different link tags to Links for read 
and unread messages. Then you could get unread messages using a link 
walk like this:
curl 
http://localhost:8098/buckets/PlayerMessages/keys//Message,unread,1


And all messages (read and unread):
curl 
http://localhost:8098/buckets/PlayerMessages/keys//Message,\_,1


- Rune

Trifork

--
sdfd

Best regards / Venlig hilsen

\*Rune Skou Larsen\*
Trifork Public A/S / Team Riak
Margrethepladsen 4, 8000 Ã…rhus C, Denmark
Phone: +45 3160 2497 Skype: runeskoularsen twitter: @RuneSkouLarsen

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

