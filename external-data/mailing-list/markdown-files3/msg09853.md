---
title: "Re: Riak fails to start"
description: ""
project: community
lastmod: 2013-01-21T06:43:28-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09853"
mailinglist_parent_id: "msg09851"
author_name: "Jon Meredith"
project_section: "mailinglistitem"
sent_date: 2013-01-21T06:43:28-08:00
---


Thanks for reporting the issue and sorry you got bitten by it. We have 
committed a fix to master a couple of months ago and it will appear in the 1.3 
release. 

Jon

On Jan 21, 2013, at 3:58 AM, Daniel Iwan  wrote:

> THe issue was that one of the ring snapshot files had size 0
> 
> user@node1:~$ ls -la /var/lib/riak/ring/
> total 32
> drwxr-xr-x 2 riak riak 138 Jan 17 10:27 .
> drwxr-xr-x 7 riak riak 129 Jan 17 13:22 ..
> -rw-rw-r-- 1 riak riak 12584 Jan 15 17:19 
> riak\_core\_ring.default.20130115171955
> -rw-rw-r-- 1 riak riak 12584 Jan 17 10:27 
> riak\_core\_ring.default.20130117102756
> -rw-rw-r-- 1 riak riak 0 Jan 17 10:27 
> riak\_core\_ring.default.20130117102757
> 
> After deleting it riak process started correctly.
> I guess riak process should check if ring file is corrupted or 0 bytes long, 
> delete/rename it automatically
> and use previous version?
> 
> Regards
> Daniel
> 
> 
> 
> On 17 January 2013 14:00, Daniel Iwan  wrote:
>> One of our nodes fails to start
>> 
>> $ sudo riak console
>> Attempting to restart script through sudo -H -u riak
>> Exec: /usr/lib/riak/erts-5.9.1/bin/erlexec -boot 
>> /usr/lib/riak/releases/1.2.1/riak -embedded -config 
>> /etc/riak/app.config -pa /usr/lib/riak/lib/basho-patches 
>> -args\_file /etc/riak/vm.args -- console
>> Root: /usr/lib/riak
>> Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:4:4] [async-threads:64] 
>> [kernel-poll:true]
>> 
>> \*\* /usr/lib/riak/lib/basho-patches/etop\_txt.beam hides 
>> /usr/lib/riak/lib/observer-1.1/ebin/etop\_txt.beam
>> \*\* Found 1 name clashes in code paths
>> 13:22:47.424 [info] Application lager started on node 'riak@10.173.240.1'
>> 13:22:47.466 [error] CRASH REPORT Process <0.149.0> with 0 neighbours exited 
>> with reason: bad argument in call to erlang:binary\_to\_term(<<>>) in 
>> riak\_core\_ring\_manager:read\_ringfile/1 line 154 in gen\_server2:init\_it/6 
>> line 384
>> /usr/lib/riak/lib/os\_mon-2.2.9/priv/bin/memsup: Erlang has closed.
>> Erlang 
>> has closed
>> 
>> {"Kernel pid 
>> terminated",application\_controller,"{application\_start\_failure,riak\_core,{shutdown,{riak\_core\_app,start,[normal,[]]}}}"}
>> 
>> Crash dump was written to: /var/log/riak/erl\_crash.dump
>> Kernel pid terminated (application\_controller) 
>> ({application\_start\_failure,riak\_core,{shutdown,{riak\_core\_app,start,[normal,[]]}}})
>> 
>> 
>> Which suggest that something happened to ring files?
>> 
>> Any idea what and why it happened?
>> 
>> Dump file available at:
>> http://www.filedropper.com/erlcrash
>> 
>> Regards
>> Daniel
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

