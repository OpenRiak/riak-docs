---
title: "Setting content-type with Erlang PBC."
description: ""
project: community
lastmod: 2010-05-26T08:30:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00435"
author_name: "Mikl Kurkov"
project_section: "mailinglistitem"
sent_date: 2010-05-26T08:30:35-07:00
---



It seems that Erlang PBC has another issue with content-type setting.

There is inconsistency of types of content-type value in riakc\_obj module
and riakc\_pb.
The riakc\_obj assumes it binary while riakc\_pb waiting for string.

Because of that next code returns undefined while it definitely should
return "text/plain".
`{ok,O} = riakc_pb_socket:put(C, riakc_obj:new(<<"b">>, <<"k">>, <<"data">>,
<<"text/plain">>), [return_body]).
riakc_obj:get_content_type(O).`

After applying next patch to riakc\_obj.erl, the code above works as expected
(you should use "text/plain" string instead of binary).

@@ -176,7 +176,7 @@
 -spec update\_content\_type(#riakc\_obj{}, metadata()) -> #riakc\_obj{}.
 update\_content\_type(Object=#riakc\_obj{}, CT) ->
 M1 = get\_update\_metadata(Object),
- Object#riakc\_obj{updatemetadata=dict:store(?MD\_CTYPE,
riakc\_pb:to\_binary(CT), M1)}.
+ Object#riakc\_obj{updatemetadata=dict:store(?MD\_CTYPE, CT, M1)}.


Also because of problems with updating metadata without updating value the
update\_content\_type 
function doesn't work too. The only way to update content-type is by using
update\_value/3 function.

I think it is not very convienient to use different types for content-type
and other metadata values.
Maybe it would be better to stick with binaries for all of metadata values.

--
Mikl 
-- 
View this message in context: 
http://riak-users.197444.n3.nabble.com/Setting-content-type-with-Erlang-PBC-tp845155p845155.html
Sent from the Riak Users mailing list archive at Nabble.com.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

