---
title: "Re: Ideal Backend for keys that frequently get overwritten"
description: ""
project: community
lastmod: 2011-09-14T08:49:58-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04703"
mailinglist_parent_id: "msg04700"
author_name: "Jeremy Raymond"
project_section: "mailinglistitem"
sent_date: 2011-09-14T08:49:58-07:00
---


If I'm reading the docs correctly, only files smaller
than small\_file\_threshold will be included in a merge. So
if small\_file\_threshold must be bigger than max\_file\_size for a merge to
happen?

- Jeremy


On Wed, Sep 14, 2011 at 10:23 AM, Jeremy Raymond wrote:

> Maybe I just need to tweak the Bitcask parameters to merge more often?
>
> I have approx 17000 keys which get overwritten once an hour. After each
> updated the /var/lib/riak/bitcask folder grows by 20 MB (so about 1200 bytes
> per key). With the default frag\_merge\_trigger at 60 I should get a merge
> every 3 hours as I would have > 60% of the keys being dead? This would also
> meet the default frag\_threshold of 40 since > 40% of the keys are dead? I'm
> not seeing the merging happening.
>
> - Jeremy
>
>
>
> On Wed, Sep 14, 2011 at 9:28 AM, Jeremiah Peschka <
> jeremiah.pesc...@gmail.com> wrote:
>
>> I would think that the InnoDB backend would be a better backend for the
>> use case you're describing.
>> ---
>> Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
>> Microsoft SQL Server MVP
>>
>> On Sep 14, 2011, at 8:09 AM, Jeremy Raymond wrote:
>>
>> > Hi,
>> >
>> > I store data in Riak whose keys constantly get overwritten with new
>> data. I'm currently using Bitcask as the back-end and recently noticed the
>> Bitcask data folder grow to 24GB. After restarting the nodes, which I think
>> triggered Bitcask merge, the data went down to 96MB. Today the data dirs are
>> back up to around 500MB. Would an alternate backend better suit this type of
>> use case where keys are constantly being overwritten?
>> >
>> > - Jeremy
>> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> > riak-users mailing list
>> > riak-users@lists.basho.com
>> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

