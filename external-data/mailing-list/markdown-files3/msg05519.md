---
title: "Re: configurable prefix for consistent hashing?"
description: ""
project: community
lastmod: 2011-11-09T12:25:45-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05519"
mailinglist_parent_id: "msg05514"
author_name: "Elias Levy"
project_section: "mailinglistitem"
sent_date: 2011-11-09T12:25:45-08:00
---


On Wed, Nov 9, 2011 at 12:00 PM,  wrote:

> From: Nate Lawson 
>
> We have been looking into ways to cluster keys to benefit from the LevelDB
> backend's prefix compression. If we were doing a batch of lookups and the
> keys from a given document could be grouped on a partition, they could be
> read with less disk IO. However, consistent hashing in Riak currently
> spreads keys randomly, based on SHA-1.
>
> What I think we could really use is a per-bucket configurable prefix
> length for consistent hashing. We would then create keys of the form
> "DocumentID:" and tell Riak to only hash DocumentID to get the
> partition. This way, keys from the same document would be clustered on the
> same partition.
>
> Is this on your roadmap already? It seems like it wouldn't require too
> many changes to Riak.
>

If you look at the bucket properties by fetching them, you'll notice that
there is already an entry for specifying a key hashing function. Its not
documented, but you can read the Erlang code for the existing function
(pretty much just a call to SHA1), and create your own to do whatever
partitioning you want.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

