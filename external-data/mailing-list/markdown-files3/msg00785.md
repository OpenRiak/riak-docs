---
title: "Running multiple Riak instances."
description: ""
project: community
lastmod: 2010-07-25T07:00:20-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00785"
author_name: "Misha Gorodnitzky"
project_section: "mailinglistitem"
sent_date: 2010-07-25T07:00:20-07:00
---


Hi all,

I'm trying to run multiple instances of Riak on my server with the
goal to run both the staging environment and eventually the production
environment on the same server (I only have one for this project).
This is an Ubuntu server and if at all possible I'd prefer not to
build Riak from source, although I understand that it would be easier
to have multiple instances running that way. I would rather keep
software managed with the package manager here.

What I've done is I've modified /usr/sbin/riak to allow specifying the
config files to use (app.config, vm.args), the log dir, run dir (for
the pipe) and the home dir, and I can startup an instance of Riak
using my "staging" environment. However, when I try to start up the
second Riak instance, it fails with just a couple of things
out-of-the-ordinary in it's logs:

 =INFO REPORT==== 25-Jul-2010::13:54:35 ===
 application: riak\_kv
 exited: {shutdown,{riak\_kv\_app,start,[normal,[]]}}
 type: permanent
 =INFO REPORT==== 25-Jul-2010::13:54:35 ===
 alarm\_handler: {clear,system\_memory\_high\_watermark}
 {"Kernel pid 
terminated",application\_controller,"{application\_start\_failure,riak\_kv,{shutdown,{riak\_kv\_app,start,[normal,[]]}}}"}^M
 Kernel pid terminated (application\_controller)
({application\_start\_failure,riak\_kv,{shutdown,{riak\_kv\_app,start,[normal,[]]}}})^M

And the Riak process that's already running logs this:

 \*\* Connection attempt from disallowed node 'riak\_stag...@127.0.0.1' \*\*

Any ideas what this might be? Has anyone managed to do this using the
Riak .deb package?

Thanks,

--Misha

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

