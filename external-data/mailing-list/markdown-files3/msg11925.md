---
title: "WARNING: Not all replicas will be on distinct nodes (with 5 nodes)"
description: ""
project: community
lastmod: 2013-08-07T02:19:27-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11925"
author_name: "Guillermo"
project_section: "mailinglistitem"
sent_date: 2013-08-07T02:19:27-07:00
---


Hi. I saw before this warning with clusters with not enough nodes.

On this case, the environment is amazon ec2 c1.xlarge machines in the same
availability zone. 5 machines. Manage with chef and the oficial riak
cookbook 2.2.0 that installs riak 1.4.0 build 1.

The process:


knife ssh "roles:riak" "riak-admin cluster join riak@node01"
ssh node01 riak-admin cluster plan
ssh node01 riak-admin cluster commit


In the plan face, it already says:


WARNING: Not all replicas will be on distinct nodes


And after commit, riak-admin diag confirms that:

[warning] The following preflists do not satisfy the n\_val: [[{0,
 'riak@node02
'},

{2854495385411919762116571938898990272765493248,
 'riak@node02
'},

{5708990770823839524233143877797980545530986496,

 [....] (with
metions to all the nodes)


The solution I found was:

In node01 (or probably any). riak-admin cluster leave. Wait
till transfers finish, and join again.
After this tedious process (30 minuts every cluster commit), riak-diag no
longer mentions nothing.

I do this process to times, with the same result, and needing to apply the
same solution.
Any way to skip this? I am doing something wrong?

Thanks.


-- 
Guillermo √Ålvarez
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

