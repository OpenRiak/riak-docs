---
title: "Re: Memory Errors when using RiakCS"
description: ""
project: community
lastmod: 2015-11-24T09:02:25-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16804"
mailinglist_parent_id: "msg16801"
author_name: "Charlie Voiselle"
project_section: "mailinglistitem"
sent_date: 2015-11-24T09:02:25-08:00
---


Ben:

Awesome! Happy that that got you sorted out. 

-cv

 
> On Nov 24, 2015, at 11:57 AM, Ben Rudolph  wrote:
> 
> Right you are:
> 2015-11-23 18:11:19.260 [warning] 
> <0.142.0>@riak\_cs\_app:check\_bucket\_props:128 Unable to verify moss.access 
> bucket settings (disconnected).
> 2015-11-23 18:11:19.261 [warning] 
> <0.142.0>@riak\_cs\_app:check\_bucket\_props:128 Unable to verify moss.storage 
> bucket settings (disconnected).
> 2015-11-23 18:11:19.261 [warning] 
> <0.142.0>@riak\_cs\_app:check\_bucket\_props:128 Unable to verify moss.buckets 
> bucket settings (disconnected).
> 2015-11-23 18:11:19.261 [error] <0.142.0>@riak\_cs\_app:sanity\_check:70 Could 
> not verify bucket properties. Error was disconnected.
> 2015-11-23 18:11:19.261 [error] <0.141.0> CRASH REPORT Process <0.141.0> with 
> 0 neighbours exited with reason: 
> {error\_verifying\_props,{riak\_cs\_app,start,[normal,[]]}} in 
> application\_master:init/4 line 133
> 2015-11-23 18:11:19.262 [info] <0.7.0> Application riak\_cs exited with 
> reason: {error\_verifying\_props,{riak\_cs\_app,start,[normal,[]]}}
> 
> Dang, sorry I think I was misled by the `config OK` signal at the beginning 
> of the error.
> 
> On Tue, Nov 24, 2015 at 11:40 AM, Charlie Voiselle  > wrote:
> Ben:
> 
> It is not uncommon to see the 
>> [os\_mon] memory supervisor port (memsup): Erlang has closed 
> message when the Erlang VM shuts down. Would it be possible for you to 
> share your console.log file to the list? There is probably another 
> configuration error causing your riak-cs nodes to shut down automatically. 
> Misconfigured default bucket types is one such problem that will cause a 
> riak-cs node to start and then stop immediately.
> 
> Thanks,
> Charlie Voiselle
> Basho, Client Services.
> 
> 
>> On Nov 23, 2015, at 1:30 PM, Ben Rudolph > > wrote:
>> 
>> Hi,
>> 
>> We've been trying to setup RiakCS for storing files on our website, 
>> http://commcarehq.org/ . It's been difficult for us 
>> to deploy because we've been having issues with our servers not being able 
>> to start Riak due to memory errors. Here's what a traceback looks like when 
>> I try and start Riak with `riak-console`:
>> 
>> config is OK
>> -config /var/lib/riak-cs/generated.configs/app.2015.11.23.18.11.17.config 
>> -args\_file /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args 
>> -vm\_args /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args
>> Exec: /usr/lib/riak-cs/erts-5.10.3/bin/erlexec -boot 
>> /usr/lib/riak-cs/releases/2.0.1/riak-cs -config 
>> /var/lib/riak-cs/generated.configs/app.2015.11.23.18.11.17.config -args\_file 
>> /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args -vm\_args 
>> /var/lib/riak-cs/generated.configs/vm.2015.11.23.18.11.17.args 
>> -pa /usr/lib/riak-cs/lib/basho-patches -- console
>> Root: /usr/lib/riak-cs
>> Erlang R16B02\_basho8 (erts-5.10.3) [source] [64-bit] [smp:8:8] 
>> [async-threads:64] [kernel-poll:true] [frame-pointer]
>> 
>> =INFO REPORT==== 23-Nov-2015::18:11:18 ===
>> alarm\_handler: {set,{system\_memory\_high\_watermark,[]}}
>> =INFO REPORT==== 23-Nov-2015::18:11:18 ===
>> opening log file: "/var/log/riak-cs/access.log.2015\_11\_23\_18"
>> Eshell V5.10.3 (abort with ^G)
>> (\*\*)1> [os\_mon] memory supervisor port (memsup): Erlang has closed 
>> 
>> The machines we are trying to deploy to have 8GB of RAM and also running a 
>> few other services, but have 3-4GB of RAM available. Are there any 
>> configuration params we can use so it consumes less memory? I've taken a 
>> look at the `system\_memory\_high\_watermark` which is the error we see 
>> (http://docs.basho.com/riak/latest/ops/running/recovery/errors/ 
>> ). Our 
>> configs can be found here in case that's useful:
>> 
>> https://github.com/dimagi/commcarehq-ansible/tree/riak/ansible/roles/riakcs/templates
>> 
>> 
>> 
>> Any insight would be useful! Thank you!
>> 
>> Ben
>> 
>> 
>> 
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com 
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
>> 
> 
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

