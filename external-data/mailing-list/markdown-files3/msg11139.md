---
title: "Upgrade Riak 1.2.1 to 1.3.1.  Install from source."
description: ""
project: community
lastmod: 2013-05-21T12:41:00-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11139"
author_name: "ageemoore"
project_section: "mailinglistitem"
sent_date: 2013-05-21T12:41:00-07:00
---


Hi,

I'm currently running 1.2.1 in production and I'm looking to upgrade to
1.3.1. I install from source and everything runs nicely out of //riak/. I happen to use /db/riak/...

# ls /db/riak/
bin data erts-5.9.1 etc lib log releases
#

I came across these two pages when trying to figure out my upgrade plan:

http://docs.basho.com/riak/latest/cookbooks/Rolling-Upgrades/#RHEL-CentOS
http://riak-users.197444.n3.nabble.com/Reformatting-2i-in-Riak-1-3-1-td4027781.html

It all seems pretty straight forward, but the docs.basho.com page does not
mention the "riak-admin reformat-indexes" command as mentioned on the other
page. I want to know if it is necessary for most typical upgrades? I'm not
sure if it's something you do only when you are using secondary indexes or
what? If it doesn't hurt to run regardless, then I have no problem doing
so.

Assuming I make a backup of /data (which contains the following: bitcask 
kv\_vnode mr\_queue ring ssl\_distribution.args\_file), here's what I think
my plan will be (the various commands to run) on each of the hosts during
the rolling upgrade:

/db/riak/bin/riak stop
<>
/db/riak/bin/riak start
/db/riak/bin/riak-admin status
/db/riak/bin/riak-admin wait-for-service riak\_kv riak@`hostname`
/db/riak/bin/riak-admin transfers
/db/riak/bin/riak-admin reformat-indexes <--- maybe?

Does that seem about right?

Thanks!




--
View this message in context: 
http://riak-users.197444.n3.nabble.com/Upgrade-Riak-1-2-1-to-1-3-1-Install-from-source-tp4027935.html
Sent from the Riak Users mailing list archive at Nabble.com.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

