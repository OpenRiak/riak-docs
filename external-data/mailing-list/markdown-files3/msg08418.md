---
title: "Re: How to search objects using riak_search method"
description: ""
project: community
lastmod: 2012-08-31T00:14:47-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08418"
mailinglist_parent_id: "msg08417"
author_name: "郎咸武"
project_section: "mailinglistitem"
sent_date: 2012-08-31T00:14:47-07:00
---


Creating object like this:
 f(O),O=riakc\_obj:new(<<"user">>, <<"jason">>,
list\_to\_binary("[{\"name\":\"jason\"},{\"sex\":\"male\"}]"),
"application/json").


72> riakc\_pb\_socket:search(Pid, <<"user2">>,
list\_to\_binary("\"sex\":\"male\"")).
{ok,{search\_results,[{<<"user2">>,
 [{<<"id">>,<<"jason">>},
 {<<"name">>,<<"jason">>},
 {<<"sex">>,<<"male">>}]}],
 0.35355299711227417,1}}
73> riakc\_pb\_socket:search(Pid, <<"user2">>,
list\_to\_binary("\"sex\":\"mal\*\"")). \*%% But this is empty. Why?\*
{ok,{search\_results,[],0.0,0}}
74> riakc\_pb\_socket:search(Pid, <<"user2">>,
list\_to\_binary("\"sex\":\"male\"")).
{ok,{search\_results,[{<<"user2">>,
 [{<<"id">>,<<"jason">>},
 {<<"name">>,<<"jason">>},
 {<<"sex">>,<<"male">>}]}],
 0.35355299711227417,1}}


2012/8/31 郎咸武 

> anyone may reply me,thanks a lot.
>
> 在 2012年8月30日星期四，郎咸武 写道：
>
>> who can give me some idea
>>
>> 在 2012年8月30日星期四，郎咸武 写道：
>>
>> Hi guys,
>> I need your help.
>>
>> Version:
>> 1)riak-erlang-client-1.3
>> 2)riak-1.2
>> 3)Erlang R14B04 (erts-5.8.5) [source] [64-bit]
>>
>> This is my bucket attributs in the following
>>
>> (riak@127.0.0.1)52> {ok,C} = riak:local\_client().
>>
>> {ok,{riak\_client,'riak@127.0.0.1',undefined}}
>> (riak@127.0.0.1)53> C:set\_bucket(<<"user">>,[{precommit,
>> [{struct,[{<<"mod">>,<<"riak\_search\_kv\_hook">>},{<<"fun">>,<<"precommit">>}]}]}]).
>> ok
>> (riak@127.0.0.1)54> C:get\_bucket(<<"user">>).
>>
>> [{search,true},
>> {allow\_mult,false},
>> {basic\_quorum,false},
>> {big\_vclock,50},
>> {chash\_keyfun,{riak\_core\_util,chash\_std\_keyfun}},
>> {dw,quorum},
>> {last\_write\_wins,false},
>> {linkfun,{modfun,riak\_kv\_wm\_link\_walker,mapreduce\_linkfun}},
>> {n\_val,3},
>> {name,<<"user">>},
>> {notfound\_ok,true},
>> {old\_vclock,86400},
>> {postcommit,[]},
>> {pr,0},
>> \* {precommit,[{struct,[{<<"mod">>,<<"riak\_search\_kv\_hook">>},\*
>> \* {<<"fun">>,<<"precommit">>}]}]},\*
>> {pw,0},
>> {r,quorum},
>> {rw,quorum},
>> {small\_vclock,50},
>> {w,quorum},
>> {young\_vclock,20}]
>>
>> \*------------------\*
>> \*In the client\*
>> \*To new a object and search it\*
>> 147> f(O),O=riakc\_obj:new(<<"user">>, <<"jason">>, <<"jasonlang">>)
>> 147> .
>> {riakc\_obj,<<"user">>,<<"jason">>,undefined,[],undefined,
>> <<"jasonlang">>}
>>
>> 150> riakc\_pb\_socket:put(Pid,O).
>> ok
>> 151> riakc\_pb\_socket:search(Pid, <<"user">>, "jason\*")
>> 151> .
>> {ok,{search\_results,[{<<"user">>,
>>
>> [{<<"id">>,<<"jason">>},{<<"value">>,<<"jasonlang">>}]}],
>> 0.0,1}}
>> 152>
>>
>> \*This search operator is ok\*
>>
>> \*TO new another object and search it\*
>>
>> 152> f(O),O=riakc\_obj:new(<<"user">>, <<"lang">>, <<"langzhe">>)
>> 152> .
>> {riakc\_obj,<<"user">>,<<"lang">>,undefined,[],undefined,
>> <<"langzhe">>}
>> 153> riakc\_pb\_socket:put(Pid,O).
>> ok
>> 154> riakc\_pb\_socket:search(Pid, <<"user">>, "langzh\*")
>> 154> .
>> {ok,{search\_results,[{<<"user">>,
>>
>> [{<<"id">>,<<"lang">>},{<<"value">>,<<"langzhe">>}]}],
>> 0.0,1}}
>> \*This is ok too\*
>> \*
>> \*
>> \*Search the objects:\*
>> 157> riakc\_pb\_socket:search(Pid, <<"user">>, "langzh\*\"\"jason\*")
>> 157> .
>> {ok,{search\_results,[{<<"user">>,
>>
>> [{<<"id">>,<<"jason">>},{<<"value">>,<<"jasonlang">>}]},
>> {<<"user">>,
>>
>> [{<<"id">>,<<"lang">>},{<<"value">>,<<"langzhe">>}]}],
>> 0.0,2}}
>> 158>
>> This is ok too.
>> -------------------------------------------------------------------
>> \*In the above is ok.\*
>>
>> --
>> 只为成功找方法，不为失败找理由
>>
>
>
> --
> 只为成功找方法，不为失败找理由
>



-- 
只为成功找方法，不为失败找理由
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

