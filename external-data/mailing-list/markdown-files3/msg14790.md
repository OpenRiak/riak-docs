---
title: "Re: duplicate keys in Riak secondary index"
description: ""
project: community
lastmod: 2014-08-22T10:55:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14790"
mailinglist_parent_id: "msg14788"
author_name: "Chaim Peck"
project_section: "mailinglistitem"
sent_date: 2014-08-22T10:55:44-07:00
---


Could you please explain how that might be?

Just to give some more informationâ€¦ At this point, I am trying to simply purge 
the bucket and start fresh

I am using the python client, basically like this:

for keys in streaming\_bucket.stream\_index('$bucket', bucket\_name):
 for key in keys:
 delete\_bucket.delete(key)

I have been running this over and over, but the objects still persist in the 
bucket even hours after running it.

Last night I set "delete\_mode" to "immediately" so these are probably not 
tombstonesâ€¦

I noticed that if I set the bucket's n\_val to 1, I get an error 400 for each 
delete operation, whereas if I leave it at the default then it reports back 
that the delete operation didn't fail. In either case, the keys do not seem to 
be deleted from the index.

So, in addition to their being duplicates, it seems that I cannot delete items.

---

I should not that last night, I tried deleting keys from a specific index (not 
the general "$bucket" index) and that appeared to work.

If anybody has some tips on how to effectively purge the bucket and start over 
that would be greatly appreciated. (I cannot delete the in the file-system 
because we have other buckets that cannot be deleted).

Thanks,
Jeff



On Aug 22, 2014, at 11:39 AM, Alex De la rosa  wrote:

> Might be siblings?
> 
> Thanks,
> Alex
> 
> 
> On Thu, Aug 21, 2014 at 10:29 PM, Chaim Peck  wrote:
> I am looking for some clues as to why there might be duplicate keys in a Riak 
> Secondary Index. I am using version 1.4.0.
> 
> Thanks,
> Chaim
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

