---
title: "Re: use Siblings to implement a message queue?"
description: ""
project: community
lastmod: 2013-09-11T16:56:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12243"
mailinglist_parent_id: "msg12240"
author_name: "Dmitry Demeshchuk"
project_section: "mailinglistitem"
sent_date: 2013-09-11T16:56:18-07:00
---


That doesn't seem bad at all. I think there even were some attempts to make
a Riak backend for RabbitMQ.

I'd say, keep messages as separate objects, and keep their IDs ordered
inside a sibling-based structure, built on top of statebox[1] or
riak\_dt[2]. The downsides are: two writes and reads every time, potential
data leaks if you don't make sure the consumed message is deleted. But
storing an entire queue in a single object sounds like a dangerous idea â€“
one might grow too much.

Also, keep in mind that your queues will be eventually consistent.


Or, as Jeremiah says, you can really wait till Riak 2.0, it might have most
of the implementation problems solved, you'll just need to write a bit of
code.


[1] https://github.com/mochi/statebox
[2] https://github.com/basho/riak\_dt


On Wed, Sep 11, 2013 at 4:29 PM, Alex Rice  wrote:

> Hi I'm very new to Riak. The allow\_mult = true / Siblings feature is
> very interesting. Could it be used to implement a high performance
> collection like a Queue or Set, in a lock free manner? The Riak docs
> make it sound like allow\_mult is mainly for confict resolution and
> degenerate cases, rather than a feature which a data structure could
> be designed around. Does anyone have any links to share, or thoughts
> about this broader issue?
> Thanks much!
> Alex
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>



-- 
Best regards,
Dmitry Demeshchuk
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

