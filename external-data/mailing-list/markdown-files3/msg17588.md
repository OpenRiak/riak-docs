---
title: "riak-cs on riak cluster with multi storage backend"
description: ""
project: community
lastmod: 2016-08-21T03:21:07-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17588"
author_name: "Ali Rıza KELEŞ"
project_section: "mailinglistitem"
sent_date: 2016-08-21T03:21:07-07:00
---


Hi,

I have a 7 node riak cluster. On each node, riak.conf has values below:

```
search=on
strong\_consistency=on
storage\_backend=multi
last\_write\_wins=true
buckets.default.allow\_mult=true
buckets.default.r = 3
multi\_backend.leveldb\_mult.storage\_backend=leveldb
multi\_backend.bitcask\_mult.storage\_backend=bitcask
multi\_backend.default=bitcask\_mult
```

I prefered multi backend because I use different type of buckets. Some
are suitable for leveldb, while some others are for bitcask. All is OK
and everything works well with this configuration.

My problem is that I want to use 3 of these 7 nodes for RiakCS
backend. As documented RiakCS requires its own backend and want me to
define it in advanced.config like below:

```
{riak\_kv,
 [
 {add\_paths, ["/usr/lib/riak-cs/lib/riak\_cs-{{VERSION}}/ebin"]},
 {storage\_backend, riak\_cs\_kv\_multi\_backend},
 {multi\_backend\_prefix\_list, [{<<"0b:">>, be\_blocks}]},
 {multi\_backend\_default, be\_default},
 {multi\_backend,
 [
 {be\_default, riak\_kv\_eleveldb\_backend,
 [
 {data\_root, "/var/lib/riak/leveldb"}
 ]
 },
 {be\_blocks, riak\_kv\_bitcask\_backend,
 [
 {data\_root, "/var/lib/riak/bitcask"}
 ]
 }
 ]
 },
 ]
}
```

I am not sure, It seems that `storage\_backend,
riak\_cs\_kv\_multi\_backend` settings overwrites my settings which I
define in riak.conf.

So how should I change my riak.conf settings to fit riakcs and my riak
cluster needing all at once?

Or isn't it possible to have a cluster such that?

Thanks.

--
Ali Rıza Keleş

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

