---
title: "Re: Bucket properties not updated"
description: ""
project: community
lastmod: 2013-10-10T15:38:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12597"
mailinglist_parent_id: "msg12595"
author_name: "Jordan West"
project_section: "mailinglistitem"
sent_date: 2013-10-10T15:38:31-07:00
---


On Thu, Oct 10, 2013 at 2:09 PM, Daniel Iwan  wrote:

> There is no coordination between servers so concurrent update of
> properties is possible.
> That would certainly explain a lot.
>
> In my case though I'm setting allow\_mult back to true so eventually that
> should win? Or would propagation through ring potentially break that logic
> and allow\_multi = false could win?
>

It really depends on when the writes occur, if they are all to the same
node, etc. Things are a bit busy right now but if you could make a sample
application I'd be happy to run it and take a look when I get a chance.
I've also been meaning to look at Jeremiah's issue.


> Also could clock drift on the servers be problematic here?
>

Yes


> It's good to hear you plan to solve that. I'm assuming it's going to be
> some sort of vclock causality applied to properties?
>

Pretty much. In the next release, buckets defined under non-default types
[1] will be resolved with some sort of conflict resolver built into Riak
(e.g. if there is a conflict resolve to allow\_mult to be safe). Buckets in
the default type will be addressed in a subsequent release.

[1] https://github.com/basho/riak/issues/362

Jordan


> D.
>
>
> On 10 October 2013 21:06, Jordan West  wrote:
>
>> Hi Daniel,
>>
>> You mentioned this was running on three servers simultaneously. Is it
>> possible that two of the bucket property updates were truly concurrent? If
>> so, an implementation detail of bucket properties: they are last-write-wins
>> (and unfortunately the resolution is in milliseconds)\*. So its feasible
>> that in some cases the allow\_mult=false would win.
>>
>> Cheers,
>> Jordan
>>
>> \*this is something we plan to address in future releases.
>>
>>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

