---
title: "Re: Using MapReduce with Counters"
description: ""
project: community
lastmod: 2013-08-02T14:13:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11873"
mailinglist_parent_id: "msg11872"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2013-08-02T14:13:40-07:00
---



On 2 Aug 2013, at 16:56, João Machado  wrote:

> Hi Sean,
> 
> Thanks for your quick response. If I follow the steps from Sam, it works as 
> expected. I tried the same steps but with my own bucket (and data) and it 
> worked too. The difference between what I was trying and what Sam did was 
> because I used JavaScript and Sam Erlang.
> 
> Is there any trick to use Javascript?
Hi João,

Not right now, sorry, the internal representation is a binary format stored in 
a regular riak\_object, that requires the riak\_kv\_counter module to decode.

Russell

> 
> 
> []'s
> 
> 
> 
> João Machado
> joao.mach...@ideais.com.br
> Tel.: 55 21 3553 1301 R: 215
> Cel.: 55 21 8124 3531
> Site: www.ideais.com.br
> 
> 
> On Fri, Aug 2, 2013 at 5:09 PM, Sean Cribbs  wrote:
> Hi João,
> 
> You might want to try the steps shown in Sam Elliott's "cookbook": 
> https://github.com/basho/riak\_crdt\_cookbook/blob/master/counters/README.md
> 
> 
> On Fri, Aug 2, 2013 at 2:56 PM, João Machado  
> wrote:
> Hello,
> 
> Anyone tried to use MR with counters?
> 
> I'm trying with the following steps:
> 
> Increment the counter:
> -> curl -X POST http://localhost:8098/buckets/BUCKET/counters/MY\_COUNTER -d 1
> 
> Confirm the actual value:
> -> curl http://localhost:8098/buckets/BUCKET/counters/MY\_COUNTER 
> 1
> 
> Execute mapreduce:
> -> curl -X POST -H "content-type: application/json" 
> http://127.0.0.1:8098/mapred -d @map\_red.js
> {"error":"bad\_utf8\_character\_code"}
> 
> Where the map\_red.js is:
> 
> {
> "inputs":"BUCKET",
> "query":[
> {"map":{"language":"javascript","name":"Riak.mapValues"}}
> ,{"reduce":{"language":"javascript","name":"Riak.reduceSum"}}
> 
> ]
> }
> 
> 
> 
> 
> 
> []'s
> 
> 
> 
> João Machado
> joao.mach...@ideais.com.br
> Tel.: 55 21 3553 1301 R: 215
> Cel.: 55 21 8124 3531
> Site: www.ideais.com.br
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> 
> 
> 
> 
> -- 
> Sean Cribbs 
> Software Engineer
> Basho Technologies, Inc.
> http://basho.com/
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

