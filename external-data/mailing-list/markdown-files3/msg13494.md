---
title: "Re: Riak Search and Yokozuna Backup Strategy"
description: ""
project: community
lastmod: 2014-01-27T11:59:30-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13494"
mailinglist_parent_id: "msg13493"
author_name: "Matthew Von-Maszewski"
project_section: "mailinglistitem"
sent_date: 2014-01-27T11:59:30-08:00
---



On Jan 27, 2014, at 2:40 PM, Elias Levy  wrote:

> Will Riak detect a LevelDB that was not cleanly shutdown when it starts up 
> and start repair on its own?
> 
> 

Google's designed leveldb to always assume it was not cleanly shutdown. If the 
startup can read the most recent MANIFEST file, leveldb cleans up the rest of 
the mess.

However, using the backup strategy previously discussed (backup sst\_? 
directories numerically … rsync or tar) creates a scenario where the MANIFEST 
file is likely incorrect in a manner that leveldb will not detect (hmm … maybe 
it could detect it but no one thought to add a test). That is why we always 
recommend (require!) that you manually run repair after a restore.

Matthew\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

