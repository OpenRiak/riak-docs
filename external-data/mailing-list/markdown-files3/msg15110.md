---
title: "Re: how to run riak_core (and consequently riak pg)"
description: ""
project: community
lastmod: 2014-11-01T08:09:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15110"
mailinglist_parent_id: "msg15109"
author_name: "Hristo Asenov"
project_section: "mailinglistitem"
sent_date: 2014-11-01T08:09:45-07:00
---


yeah, thanks Chris, its working now on my system.

- Hristo

On Oct 31, 2014, at 6:48 PM, Christopher Meiklejohn  
wrote:

> On Oct 29, 2014, at 10:28 AM, Hristo Asenov  wrote:
>> 
>> Hi everyone,
>> 
>> I stumbled upon an application, Riak PG 
>> (https://github.com/basho/webmachine.git), that I want to run on my boxes. 
>> It's main dependancy is riak\_core, which needs to be started before riak\_pg 
>> runs. When I make a release with "./rebar generate" and then try to run 
>> ",/riak\_pg console" in the rel folder, I get the following error output when 
>> I try to create a new group: 
>> 
>> riak\_pg hctrl-hsa01% rel/riak\_pg/bin/riak\_pg console -smp enable
>> Exec: /home/hasenov/riak\_pg/rel/riak\_pg/erts-5.10.4/bin/erlexec -boot 
>> /home/hasenov/riak\_pg/rel/riak\_pg/releases/1/riak\_pg -embedded -config 
>> /home/hasenov/riak\_pg/rel/riak\_pg/etc/app.config -args\_file 
>> /home/hasenov/riak\_pg/rel/riak\_pg/etc/vm.args -- console -smp enable
>> Root: /home/hasenov/riak\_pg/rel/riak\_pg
>> Erlang R16B03 (erts-5.10.4) [source] [64-bit] [smp:1:1] [async-threads:5] 
>> [kernel-poll:true]
>> 
>> 13:15:11.333 [info] Application lager started on node 'riak\_pg@127.0.0.1'
>> 13:15:11.334 [info] Application crypto started on node 'riak\_pg@127.0.0.1'
>> 13:15:11.339 [info] Application riak\_sysmon started on node 
>> 'riak\_pg@127.0.0.1'
>> 13:15:11.348 [info] Application os\_mon started on node 'riak\_pg@127.0.0.1'
>> 13:15:11.350 [info] Application basho\_stats started on node 
>> 'riak\_pg@127.0.0.1'
>> 13:15:11.350 [info] Application eleveldb started on node 'riak\_pg@127.0.0.1'
>> 13:15:11.351 [info] alarm\_handler: {set,{system\_memory\_high\_watermark,[]}}
>> 13:15:11.351 [info] Application pbkdf2 started on node 'riak\_pg@127.0.0.1'
>> 13:15:11.351 [info] Application poolboy started on node 'riak\_pg@127.0.0.1'
>> 13:15:11.581 [info] New capability: {riak\_core,vnode\_routing} = proxy
>> 13:15:11.584 [info] New capability: {riak\_core,staged\_joins} = true
>> 13:15:11.589 [info] New capability: {riak\_core,resizable\_ring} = true
>> 13:15:11.591 [info] New capability: {riak\_core,fold\_req\_version} = v2
>> 13:15:11.593 [info] New capability: {riak\_core,security} = true
>> 13:15:11.595 [info] New capability: {riak\_core,bucket\_types} = true
>> 13:15:11.597 [info] New capability: {riak\_core,net\_ticktime} = true
>> Eshell V5.10.4 (abort with ^G)
>> (riak\_pg@127.0.0.1)1> 13:15:21.525 [info] Waiting for application 
>> riak\_pg\_memberships to start (0 seconds).
>> 
>> (riak\_pg@127.0.0.1)1> riak\_pg:create(newpg).
>> 13:16:15.299 [error] riak\_pg\_memberships\_vnode command failed 
>> {undef,[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{file,"src/riak\_pg\_memberships\_vnode.erl"},{line,143}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]},{gen\_fsm,handle\_msg,7,[{file,"gen\_fsm.erl"},{line,505}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
>> 13:16:15.299 [error] riak\_pg\_memberships\_vnode command failed 
>> {undef,[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{file,"src/riak\_pg\_memberships\_vnode.erl"},{line,143}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]},{gen\_fsm,handle\_msg,7,[{file,"gen\_fsm.erl"},{line,505}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
>> 13:16:15.299 [error] riak\_pg\_memberships\_vnode command failed 
>> {undef,[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{file,"src/riak\_pg\_memberships\_vnode.erl"},{line,143}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]},{gen\_fsm,handle\_msg,7,[{file,"gen\_fsm.erl"},{line,505}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
>> 13:16:15.299 [error] gen\_fsm <0.637.0> in state waiting terminated with 
>> reason: no function clause matching 
>> riak\_pg\_create\_fsm:waiting({vnode\_error,{undef,[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{...},...]},...]}},
>> 
>> {state,[{388211372416021087647853783690262677096107081728,'riak\_pg@127.0.0.1'},{411047335499316445744786359201454599278231027712,...},...],...})
>> line 119
>> 13:16:15.300 [error] CRASH REPORT Process <0.637.0> with 0 neighbours exited 
>> with reason: no function clause matching 
>> riak\_pg\_create\_fsm:waiting({vnode\_error,{undef,[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{...},...]},...]}},
>> 
>> {state,[{388211372416021087647853783690262677096107081728,'riak\_pg@127.0.0.1'},{411047335499316445744786359201454599278231027712,...},...],...})
>> line 119 in gen\_fsm:terminate/7 line 622
>> 13:16:15.300 [error] Supervisor riak\_pg\_create\_fsm\_sup had child 
>> riak\_pg\_create\_fsm started with {riak\_pg\_create\_fsm,start\_link,undefined} at 
>> <0.637.0> exit with reason no function clause matching 
>> riak\_pg\_create\_fsm:waiting({vnode\_error,{undef,[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{...},...]},...]}},
>> 
>> {state,[{388211372416021087647853783690262677096107081728,'riak\_pg@127.0.0.1'},{411047335499316445744786359201454599278231027712,...},...],...})
>> line 119 in context child\_terminated
>> 13:16:15.300 [error] gen\_fsm <0.487.0> in state active terminated with 
>> reason: {'module could not be 
>> loaded',[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{file,"src/riak\_pg\_memberships\_vnode.erl"},{line,143}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]},{gen\_fsm,handle\_msg,7,[{file,"gen\_fsm.erl"},{line,505}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
>> 13:16:15.301 [error] CRASH REPORT Process <0.487.0> with 0 neighbours exited 
>> with reason: call to undefined function riak\_dt\_vvorset:new() in 
>> gen\_fsm:terminate/7 line 622
>> 13:16:15.301 [error] gen\_fsm <0.489.0> in state active terminated with 
>> reason: {'module could not be 
>> loaded',[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{file,"src/riak\_pg\_memberships\_vnode.erl"},{line,143}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]},{gen\_fsm,handle\_msg,7,[{file,"gen\_fsm.erl"},{line,505}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
>> 13:16:15.301 [error] CRASH REPORT Process <0.489.0> with 0 neighbours exited 
>> with reason: call to undefined function riak\_dt\_vvorset:new() in 
>> gen\_fsm:terminate/7 line 622
>> 13:16:15.302 [error] gen\_fsm <0.491.0> in state active terminated with 
>> reason: {'module could not be 
>> loaded',[{riak\_dt\_vvorset,new,[],[]},{riak\_pg\_memberships\_vnode,handle\_command,3,[{file,"src/riak\_pg\_memberships\_vnode.erl"},{line,143}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]},{gen\_fsm,handle\_msg,7,[{file,"gen\_fsm.erl"},{line,505}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
>> 13:16:15.302 [error] CRASH REPORT Process <0.491.0> with 0 neighbours exited 
>> with reason: call to undefined function riak\_dt\_vvorset:new() in 
>> gen\_fsm:terminate/7 line 622
>> 13:16:15.302 [error] Supervisor riak\_core\_vnode\_sup had child undefined 
>> started with {riak\_core\_vnode,start\_link,undefined} at <0.487.0> exit with 
>> reason call to undefined function riak\_dt\_vvorset:new() in context 
>> child\_terminated
>> 13:16:15.302 [error] Supervisor riak\_core\_vnode\_sup had child undefined 
>> started with {riak\_core\_vnode,start\_link,undefined} at <0.489.0> exit with 
>> reason call to undefined function riak\_dt\_vvorset:new() in context 
>> child\_terminated
>> 13:16:15.302 [error] Supervisor riak\_core\_vnode\_sup had child undefined 
>> started with {riak\_core\_vnode,start\_link,undefined} at <0.491.0> exit with 
>> reason call to undefined function riak\_dt\_vvorset:new() in context 
>> child\_terminated
>> {error,timeout}
>> 
>> It looks like riak\_dt is not defined, however it is in the deps folder. I 
>> tried passing "-pa deps/riak\_dt/ebin" in the command line arguments but that 
>> has no effect. I was wondering if someone knows how to go about getting this 
>> working, or have an idea where to post my problem to.
> 
> The version of Riak PG that was used when publishing the paper depended on 
> riak\_dt having a vvorset on the master branch. I discussed with Hristo 
> offline and updated the application to use the orswot and pushed the changes 
> to riak\_pg master.
> 
> Thanks!
> 
> - Chris


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

