---
title: "riak search indexing arrays of integers"
description: ""
project: community
lastmod: 2011-02-13T22:21:30-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02311"
author_name: "Joseph Lambert"
project_section: "mailinglistitem"
sent_date: 2011-02-13T22:21:30-08:00
---


Hi,

If I want to put a json object which has an array of integers, like:

{
 "users" : [ 1971, 7844 ]
}

and index that as integers with the schema:

{field, [
 {name, "users"},
 {type, integer},
 {analyzer\_factory, {erlang, text\_analyzers, integer\_analyzer\_factory}}
]},

The indexing works (I am assuming correctly) and I have these values in the
index document:

{<<"users">>,<<"1971 7844">>, [{<<"1971">>,[0]},{<<"7844">>,[1]}]}

However, in my schema I have the type as integer for this index, and when I
get the object I get an error for riak\_search\_utils:to\_integer is failing,
because this is not valid:

list\_to\_integer("1971 7844")

I patched the to\_integer function so that if it is a single integer, it just
returns list\_to\_integer("1971"), but if there is more than one integer, it
will return a list of integers, like so:

1) single integer values: 1971
2) list of integer values: [1971, 7844]

My question now is, is that acceptable behavior to return a list of integers
in this case? It seems to work fine with search and all, but I haven't
tested it extensively. Also, it's kind of hacky and only applies to the
to\_integer function.

- Joe Lambert

joseph.g.lamb...@gmail.com
+86 13656213284
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

