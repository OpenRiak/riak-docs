---
title: "Re: Riak behind a Load Balancer"
description: ""
project: community
lastmod: 2012-08-31T02:07:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08420"
mailinglist_parent_id: "msg08419"
author_name: "Guido Medina"
project_section: "mailinglistitem"
sent_date: 2012-08-31T02:07:16-07:00
---



Hi,

 We use HA proxy on a 4 nodes cluster for a J2EE application, before 
using HA proxy we delegated on the Java Riak cluster client config to 
handle the 4 nodes, but too many errors were generated, once we switched 
to HA proxy and a single Java Riak client config, the errors were 
reduced dramatically.


 I don't know how accurate an article can be, but my experience comes 
from transferring 10+ millions records from PostgreSQL to Riak several 
times, running processes for 48 to 72 hours continuously, so IMHO, HA 
proxy + new client client (The one that comes with Protobuf 2.4.1+, not 
the old 2.3.0) is the way to go. To add more, we have autossh tunnels on 
the Java application server connected to each Riak node and behind it, 
HA proxy.


With the new protobuf I have the transferring running for the last 48 
hours and not a single error.


Regards,

Guido.

On 31/08/12 09:55, Dave Brady wrote:
There's a reference to an article on Basho's site, written by Amazon, 
about Dynamo:


 http://features.basho.com/entries/20535121-weighted-nodes

Section 6.4 explains why they do not use load balancers.

The rest of the article is good reading, too.

------------------------------------------------------------------------
\*From: \*"Sean Carey" 
\*To: \*"Matt Black" 
\*Cc: \*"riak-users" 
\*Sent: \*Thursday, August 30, 2012 11:09:00 PM
\*Subject: \*Re: Riak behind a Load Balancer

Matt,
Haproxy is my load balancer of choice. You can always run multiple 
copies of haproxy and use some type of dynamic dns with it.


We do this in many cases. Haproxy scales well. I've seen a single node 
sustain multiple gigabits per second with almost no sweat.



Thanks.


Sean

On Monday, June 25, 2012 at 7:36 AM, Matt Black wrote:

 Dear list,

 Does anyone have an opinion on the concept of putting a Riak
 cluster behind a load balancer?

 We wish to be able to automatically add/remove nodes from the
 cluster, so adding an extra layer at the front is desirable. We
 should also benefit for incoming requests behind shared across all
 nodes.

 Can anyone see any drawbacks / problems with doing this?

 Thanks
 Matt

 \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
 riak-users mailing list
 riak-users@lists.basho.com 
 http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

