---
title: "Re: Need help with Mapreduce"
description: ""
project: community
lastmod: 2011-10-06T06:36:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05070"
mailinglist_parent_id: "msg05062"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-10-06T06:36:18-07:00
---


You're also missing a comma between your map and reduce phases.

On Wed, Oct 5, 2011 at 8:23 PM, Aphyr  wrote:

> Like it says, the request that you submitted isn't JSON. MR functions
> belong in the source attribute of the JSON document, not floating outside
> it.
>
> --Kyle
>
>
> On 10/05/2011 05:19 PM, urvi wrote:
>
>> I am trying to use this fuctntion to get the highest number from given
>> date. My map is working fine but reduce function is giving me error.
>> Please help me
>>
>> curl -X POST http://x:8098/mapred -H "Content-Type: application/json" -d
>> @-
>> function(value, keyData, arg){
>> var data = Riak.map.ValuesJson(value) [0];
>> return [data.High];
>> }
>>
>> {"inputs":[["symc","2011-10-\*\*04"],
>> ["symc","2011-09-02"],
>> ["symc","2011-10-03"]],
>> "query":[{"map":{"language":"\*\*javascript",
>> "source":"function(value, keyData, arg) { var data =
>> Riak.mapValuesJson(value)[0]; return [data.High];}"
>> }}
>> {"reduce":{"language":"\*\*javascript","name":"Riak.\*\*
>> reduceMax","keep":true}}]
>> }
>> --Ctrl-D to submit it
>>
>> Output :
>>
>> The POST body was not valid JSON.
>> The error from the parser was:
>> {{case\_clause,<<"function(\*\*value, keyData, arg){ var data =
>> Riak.map.ValuesJson(value) [0]; return
>> [data.High];}{\"inputs\":[[\"\*\*symc\",\"2011-10-04\"],
>> [\"symc\",\"2011-09-02\"], [\"symc\",\"2011-10-03\"]],
>> \"query\":[{\"map\":{\"\*\*language\":\"javascript\",
>> \"source\":\"function(value, keyData, arg) { var data =
>> Riak.mapValuesJson(value)[0]; return [data.High];}\" }}
>> {\"reduce\":{\"language\":\"\*\*javascript\",\"name\":\"Riak.\*\*
>> reduceMax\",\"keep\":true}}]}"\*\*>>},
>> [{mochijson2,tokenize,2},
>> {mochijson2,decode1,2},
>> {mochijson2,json\_decode,2},
>> {riak\_kv\_mapred\_json,parse\_\*\*request,1},
>> {riak\_kv\_wm\_mapred,verify\_\*\*body,2},
>> {riak\_kv\_wm\_mapred,malformed\_\*\*request,2},
>> {webmachine\_resource,resource\_\*\*call,3},
>> {webmachine\_resource,do,3}]}
>>
>>
>> ------------------------------\*\*------------------------------\*\*
>> ------------
>>
>> View this message in context: Need help with Mapreduce
>> > Mapreduce-tp3398423p3398423.\*\*html
>> >
>>
>> Sent from the Riak Users mailing list archive
>> >
>> at Nabble.com.
>>
>>
>>
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\*\*\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/\*\*mailman/listinfo/riak-users\_\*\*lists.basho.com
>>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\*\*\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/\*\*mailman/listinfo/riak-users\_\*\*lists.basho.com
>



-- 
Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://www.basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

