---
title: "Re: Unable to configure Riak-CS-Control to manage users"
description: ""
project: community
lastmod: 2013-10-09T09:24:32-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12569"
mailinglist_parent_id: "msg12568"
author_name: "Siddhu Warrier (siwarrie)"
project_section: "mailinglistitem"
sent_date: 2013-10-09T09:24:32-07:00
---


Hi Dmitri,

Sorry I failed to attach the s3cfg file.

Cheers,

Siddhu

From: Dmitri Zagidulin >
Date: Wednesday, 9 October 2013 16:51
To: Siddhu Warrier >
Cc: "riak-users@lists.basho.com" 
>
Subject: Re: Unable to configure Riak-CS-Control to manage users

Ok, I suspect it has to do with a mismatch between cs\_root\_host setting in 
riakcs.app.config and the corresponding setting in riak-cs-control.app.config. 
Can you attach your .s3cfg, so I can confirm?

Dmitri


On Wed, Oct 9, 2013 at 11:16 AM, Siddhu Warrier (siwarrie) 
> wrote:
Hi Dmitri,

Thanks again for your rapid reply!

1, 2) I have attached my riak, stanchion, riak-cs and riak-cs-control 
app.config files here
3)
Things that work with s3cmd (s3 config attached):

 \* Create a bucket, upload a file, download a file, delete buckets 
recursively, list contents of buckets

[root@cpn-int-store-03 ~]# s3cmd mb s3://cloudcuckooland
Bucket 's3://cloudcuckooland/' created
[root@cpn-int-store-03 ~]# s3cmd put cobbler.ks s3://cloudcuckooland/shoemaker
cobbler.ks -> s3://cloudcuckooland/shoemaker [1 of 1]
 6964 of 6964 100% in 0s 114.14 kB/s done
[root@cpn-int-store-03 ~]# s3cmd la
2013-10-09 14:47 6964 s3://cloudcuckooland/shoemaker

[root@cpn-int-store-03 ~]# s3cmd get s3://cloudcuckooland/shoemaker 
/tmp/shoemaker.tmp
s3://cloudcuckooland/shoemaker -> /tmp/shoemaker.tmp [1 of 1]
 6964 of 6964 100% in 0s 659.50 kB/s done
[root@cpn-int-store-03 ~]# s3cmd rb --force s3://cloudcuckooland
WARNING: Bucket is not empty. Removing all the objects from it first. This may 
take some time...
File s3://cloudcuckooland/shoemaker deleted
Bucket 's3://cloudcuckooland/' removed

Things that do not work:

 \* Riak CS Control: Create user
 \* Riak CS Control: List users

Note: With anonymous user creation set to true, I was able to view information 
about users and modify them.

I was however able to view the information about a particular user.
[root@cpn-int-store-03 ~]# s3cmd get s3://riak-cs/user -
s3://riak-cs/user ->  [1 of 1]
xml version="1.0" 
encoding="UTF-8"?x...@cisco.comxxxxxRory
 Irvine5VI-NIFLNIHKRNGKPBVXc26c71a140f18b6853b45fd3ce4a672e0471b62a04920c2a77def7a0bfbcde0denabled
[root@cpn-int-store-03 ~]# s3cmd get s3://riak-cs/user/9UND62Q1-EIDE9YO1GI0 -
s3://riak-cs/user/9UND62Q1-EIDE9YO1GI0 ->  [1 of 1]
xml version="1.0" 
encoding="UTF-8"?foo...@example.comfoobarfoo
 bar9UND62Q1-EIDE9YO1GI04o 333 of 333 100% 
in 0s 43.04 kB/s 
doneet>6057fd7d3a7c43b06f839441585d35de197baa57a4696318803afd81c5887aecdisabled

Thanks,

Siddhu

From: Dmitri Zagidulin >
Date: Wednesday, 9 October 2013 16:02

To: Siddhu Warrier >
Cc: "riak-users@lists.basho.com" 
>
Subject: Re: Unable to configure Riak-CS-Control to manage users

Thanks Siddhu,
Couple more questions.

1) Can you include a couple more sections from the Riak CS config 
(specifically, the anonymous\_user\_creation section and the admin\_key).

2) Just to double-check, can you re-include the Riak CS Control config? (the 
whole riak\_cs\_control section).

3) Describe again exactly which parts are working and which aren't. What do you 
see when you open the Riak CS Control web interface? (And which commands are 
working with s3cmd?)



On Wed, Oct 9, 2013 at 10:50 AM, Siddhu Warrier (siwarrie) 
> wrote:
Hi Dimitri,

Thank you for your email. I just tried this. I still have the same problem, 
except that I no longer get 403 errors in my Riak CS error log (as a matter of 
fact, I get nothing at all in my Riak CS, Riak CS Control, Stanchion, and Riak 
error logs).

I've put the basic config section of my riak-cs/app.config here for your 
reference.

 %% Riak CS http/https port and IP address to listen at
 %% for object storage activity
 {cs\_ip, "10.0.1.202"},
 {cs\_port, 8080 } ,

 %% Riak node to which Riak CS accesses
 {riak\_ip, "10.0.1.202"},
 {riak\_pb\_port, 8087 } ,

 %% Configuration for access to request
 %% serialization service
 {stanchion\_ip, "10.0.1.202"},
 {stanchion\_port, 8085 },
 {stanchion\_ssl, false },

Thanks,

Siddhu

From: Dmitri Zagidulin >
Date: Wednesday, 9 October 2013 15:38
To: Siddhu Warrier >
Cc: "riak-users@lists.basho.com" 
>
Subject: Re: Unable to configure Riak-CS-Control to manage users

(Just to be extra clear, that's meant to be a comma at the end of that 
directive, not a period. Also, don't forget to restart Riak CS Control, after 
changing the proxy host).


On Wed, Oct 9, 2013 at 10:36 AM, Dmitri Zagidulin 
> wrote:
Hi Siddhu,

Can you try changing 'cs\_proxy\_host' to localhost? So:

 {cs\_proxy\_host, "127.0.0.1" }.

and retry.




On Wed, Oct 9, 2013 at 9:55 AM, Siddhu Warrier (siwarrie) 
> wrote:
Hi,

I have a two node Riak CS (1.4) cluster set up on two nodes (node-1 and node-2 
henceforth). Node-1 is the headnode. Both node-1 and node-2 are running 
CentOS-6.4.

Node-1

 \* Riak 1.4.2
 \* Stanchion 1.4.1
 \* Riak-CS 1.4.1
 \* Riak-CS-Control 1.0.2

Node-2

 \* Riak 1.4.2
 \* Riak-CS 1.4.1

I have got Riak CS working, and have created admin credentials that I've set 
correctly on stanchion, riak-cs, and riak-cs-control on node 1, and on riak-cs 
on node 2. I am able to use the admin credentials to perform operations on the 
bucket using s3cmd.

However, when I try to list riak-cs users using the riak-cs-control, I get no 
results. The error that comes up in /var/log/riak-cs.log is:

10.0.1.202 - - [09/Oct/2013:13:09:31 +0000] "GET /buckets/users/objects 
HTTP/1.1" 403 160 "" ""

I also receive a 403 when I try to create an admin user.

I saw https://github.com/basho/riak\_cs\_control/issues/31 and set my 
/etc/riak-cs-control/app.config file up to use the cs\_proxy\_host parameter as 
well, though I'm not using proxies, but to no avail. I have reproduced the 
relevant section of my riak-cs-control/app.config here:
 {riak\_cs\_control, [
 %% What port to run the application on.
 {port, 8000 },

 %% Instance of Riak CS you wish to talk to.
 {cs\_hostname, "10.0.1.202" },
 {cs\_port, 8080 },
 {cs\_protocol, "http" },

 %% Proxy information; necessary if you are using 
s3.amazonaws.com as
 %% your hostname.
 {cs\_proxy\_host, "10.0.1.202" },
 {cs\_proxy\_port, 8080 },

 %% Credentials you want the application to run as.
 {cs\_admin\_key, "5VI-NIFLNIHKRNGKPBVX" },
 {cs\_admin\_secret, "xxxxxxx" },

 %% Specify the bucket name for administration options.
 {cs\_administration\_bucket, "riak-cs" }
 ]},

Is there something I am missing/doing wrong?

Thanks,

Siddhu

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com







s3cfg
Description: s3cfg
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

