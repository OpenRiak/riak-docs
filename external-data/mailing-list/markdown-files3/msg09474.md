---
title: "Re: Deleted objects"
description: ""
project: community
lastmod: 2012-12-07T10:28:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09474"
mailinglist_parent_id: "msg09472"
author_name: "Evan Vigil-McClanahan"
project_section: "mailinglistitem"
sent_date: 2012-12-07T10:28:06-08:00
---


That error is from a riak object tombstone being included in the
results stream. You need to check the object metadata for the
<<"X-Riak-Deleted">> header being true, and then ignore that object in
your map function.

On Fri, Dec 7, 2012 at 10:01 AM, Daniil Churikov  wrote:
> Hello, recently we have had an issue with deleted objects in Riak.
>
> We use erlang mapreduce to access some buckets, and few days ago we discover
> error report, our mapreduce
> failed with function\_clause. Input was this:
>
> {input,{{ok,{r\_object,<<"superbucket">>,<<"superkey">>,[{r\_content,{dict,4,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[],[],[],[],[],[],[],[],[[<<"X-Riak-VTag">>,49,115,99,102,120,103,69,82,73,99,84,100,119,119,49,119,50,49,105,81,89,57]],[[<<"index">>]],[[<<"X-Riak-Deleted">>,116,114,117,101]],[[<<"X-Riak-Last-Modified">>|{1354,752824,36644}]],[],[]}}},<<>>}],[{<<190,21,164,158,80,133,79,1>>,{3,63521972024}}],{dict,1,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[clean|true]],[]}}},undefined},undefined},[{1450083655789255239155218544960687058564870569984,'riak@10.0.1.192'}]}}
>
> This error was reproducible several days, before i try to read this object
> without mapreduce.
> Read gave me {error,notfound}, after that mapreduce error disappear.
>
> I suppose that this is some kind of read-repair, which was not triggered by
> mapreduce, but we didnt have any riak failures in the past.
>
> P.S. riak-1.2.1-1 on ubuntu 12.04 and bitcask backend.
>
>
>
> --
> View this message in context: 
> http://riak-users.197444.n3.nabble.com/Deleted-objects-tp4026208.html
> Sent from the Riak Users mailing list archive at Nabble.com.
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

