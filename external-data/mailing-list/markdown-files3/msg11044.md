---
title: "Re: RIAK use in VMs"
description: ""
project: community
lastmod: 2013-05-08T15:50:28-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11044"
mailinglist_parent_id: "msg10934"
author_name: "Mark Phillips"
project_section: "mailinglistitem"
sent_date: 2013-05-08T15:50:28-07:00
---


Hi Yan,

Sorry about being late to the game here, but, to paraphrase the great
Brian Sparrow [0], if you bring up the node with the same ip and node
name, "force remove" isn't your best option here. You'll want to do a
riak\_kv repair [1] on the partitions that node owns.

Hope that helps.

Mark

[0] https://twitter.com/bsparrow435
[1] http://docs.basho.com/riak/latest/cookbooks/Repairing-KV-Indexes/

On Wed, Apr 17, 2013 at 5:18 PM, Yan Martins  wrote:
> I know it's not good to use RIAK in VMs, but even so I would like to get
> some support in one scenario:
>
> We have a 4 node RIAK cluster, each one in different VMs. In case one of the
> VMs goes down and needs to be restarted in a different machine (so it won't
> have the same data as the node it's replacing), what's the best strategy to
> add the new node in the cluster? It may possibly have the same IP as the
> node that went down. What I thought was:
>
> 1. force remove the node down from the cluster;
>
> 2. bring up new VM with the new node;
>
> 3. cluster join the new node.
>
> Is there a better way to do this, especially because the new node have the
> same IP as the old one. Also, is it possible to do something like a
> riak-admin cluster join from one of the clients or it's from the CLI only?
>
> Thanks
>
> Yan
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

