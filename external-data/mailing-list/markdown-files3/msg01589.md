---
title: "Re: riak / riaksearch fails and returns with "badarg,	universaltime_to_localtime" on any mapreduce function"
description: ""
project: community
lastmod: 2010-11-21T08:00:38-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01589"
author_name: "Michal Zajda"
project_section: "mailinglistitem"
sent_date: 2010-11-21T08:00:38-08:00
---


Hi,
 this is erlang issue.

According to documentation (
http://erlang.org/doc/man/calendar.html#local\_time\_to\_universal\_time\_dst-1):
"This function converts from local time to Universal Coordinated Time (UTC).
Date1 must refer to a local date after Jan 1, 1970." 5>

And here my shell:

calendar:local\_time\_to\_universal\_time\_dst({{1969,12,31},{23,59,59}}).
\*\* exception error: bad argument
 in function erlang:localtime\_to\_universaltime/2
 called as
erlang:localtime\_to\_universaltime({{1969,12,31},{23,59,59}},
 true)
 in call from calendar:local\_time\_to\_universal\_time\_dst/1

6> calendar:local\_time\_to\_universal\_time\_dst({{1970,1,1},{23,59,59}}).
[{{1970,1,1},{22,59,59}}]

Track down date generator and handle the case.

--
Michal

On 21 November 2010 11:10, A. Sebastian Dietzel wrote:

> Hi,
>
> I've trouble getting the mapreduce functions to work in riak and
> riaksearch.
> It fails with some sort of timestamp error, unfortunately I'm not good
> enough in
> Erlang to fix it, but I've attached the error logs and riaksearch-admin
> status output - hope that helps.
>
> So far, I've tried it on my local dev machine (osx - riak/riaksearch source
> installation, tarball and github master branch),
> on centos 5.3 (github master) and on ubuntu,
> the .deb packaged version on ubuntu works and doesn't fail in my test
> cases.
>
> The attached test is written in python based on the test cases in the
> library
> and utilizes the http client from the python library for riak.
> But that shouldn't matter, it also fails via the pbc-python client (I've
> attached logs for that as well),
> as well as in ruby (using the official client) and via curl too.
> I didn't attach any logs for ruby or curl, as they're similar to the http
> based python client.
>
> Since no one else is having these issues, I presume I'm doing something
> wrong
> but I don't know what exactly.
>
> I'm running riak/riaksearch from the console like this:
> ulimit -n 1024
> $PATH\_TO\_RIAKS\_SRC/rel/bin/riaksearch start
>
> or for regular riak:
> $PATH\_TO\_RIAK\_SRC/rel/bin/riak start
>
> This works and starts riak / riaksearch, but as soon as I start doing
> anything mapreduce with the servers they fail with:
>
> ...
> {badarg,[{erlang,universaltime\_to\_localtime,[{{1969,12,31},{23,59,59}}]},{calendar,local\_time\_to\_universal\_time\_dst,1}
> ...
>
> I'm using Erlang R13B04.
>
> Please let me know if I can provide anything else to help solving this
> issue.
>
> Thank you in advance,
> Sebastian
> --
> A. Sebastian Dietzel (el mariachi)
> sebast...@dubizzle.com
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

