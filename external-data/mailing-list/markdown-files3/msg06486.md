---
title: "Re: error: undef done()"
description: ""
project: community
lastmod: 2012-02-01T08:43:47-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06486"
mailinglist_parent_id: "msg06485"
author_name: "Matthew A. Brown"
project_section: "mailinglistitem"
sent_date: 2012-02-01T08:43:47-08:00
---


Hi Bryan,

Thanks much for the info. We're running Riak 1.0.3. I think in our
case what would've made this easier to track down would have been not
having the error output cut off in the log -- since the inputs to the
reduce comprised a pretty large set, the output cut off before the
call trace, which appears after the dump of the inputs. It was pretty
easy to track down once I narrowed down the inputs to a manageable
size that still reproduced the error.

Thanks!
Mat

On Wed, Feb 1, 2012 at 10:53, Bryan Fink  wrote:
> On Tue, Jan 31, 2012 at 1:46 PM, Matthew A. Brown  
> wrote:
>> [error] error:undef done()
>>
>> The error message is followed by a dump of the reduce inputs which is,
>> sadly, truncated before the bit where it would give the call trace.
>>
>> Our Erlang reduce code does not define or reference a function done(),
>> but I do note that this function is defined in riak\_kv:
>>
>> https://github.com/basho/riak\_kv/blob/master/src/riak\_kv\_w\_reduce.erl#L163
>
> The "done()" you're seeing comes from 6 lines below where you were looking:
>
> https://github.com/basho/riak\_kv/blob/master/src/riak\_kv\_w\_reduce.erl#L169
>
> It is intended to give an idea of what stage the reduce fitting was in
> when the error happened. Other strings you'll find are "reducing",
> "riak\_kv\_w\_reduce init", and "reducing handoff".
>
> I would be interested in knowing what version of Riak you were using
> when you encountered this error message. Â Improving MapReduce errors
> is something we're always working on.
>
> -Bryan

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

