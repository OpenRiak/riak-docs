---
title: "Re: Waiting for riak to handoff ?"
description: ""
project: community
lastmod: 2014-08-22T02:30:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14784"
mailinglist_parent_id: "msg14773"
author_name: "Marcel Koopman"
project_section: "mailinglistitem"
sent_date: 2014-08-22T02:30:13-07:00
---


Hello, we upgraded to 1.4.10 on all nodes. Please see below:

 riak-admin transfers

'riak@newnode5 waiting to handoff 11 partitions

'riak@newnode4' waiting to handoff 11 partitions

'riak@newnode3' waiting to handoff 11 partitions

'riak@newnode2' waiting to handoff 11 partitions

'riak@newnode1' waiting to handoff 11 partitions

'riak@oldnode2' waiting to handoff 11 partitions

'riak@oldnode3' waiting to handoff 11 partitions


Active Transfers:



$ riak-admin transfer-limit

=============================== Transfer Limit
================================

Limit Node

-------------------------------------------------------------------------------

 2 'riak@oldnode3'

 2 'riak@oldnode2'

 2 'riak@oldnode1'

 2 'riak@newnode1'

 2 'riak@newnode2'

 2 'riak@newnode3'

 2 'riak@newnode4'

 2 'riak@newnode5'

-------------------------------------------------------------------------------

Note: You can change transfer limits with 'riak-admin transfer\_limit
'

 and 'riak-admin transfer\_limit  '

$ riak-admin status

1-minute stats for 'riak@newnode1'

-------------------------------------------

riak\_kv\_stat\_ts : 1408692262

vnode\_gets : 0

vnode\_gets\_total : 374554

vnode\_puts : 0

vnode\_puts\_total : 11795

vnode\_index\_refreshes : 0

vnode\_index\_refreshes\_total : 0

vnode\_index\_reads : 0

vnode\_index\_reads\_total : 683394

vnode\_index\_writes : 0

vnode\_index\_writes\_total : 11715

vnode\_index\_writes\_postings : 0

vnode\_index\_writes\_postings\_total : 10449

vnode\_index\_deletes : 0

vnode\_index\_deletes\_total : 0

vnode\_index\_deletes\_postings : 0

vnode\_index\_deletes\_postings\_total : 675

node\_gets : 0

node\_gets\_total : 117806

node\_get\_fsm\_siblings\_mean : 0

node\_get\_fsm\_siblings\_median : 0

node\_get\_fsm\_siblings\_95 : 0

node\_get\_fsm\_siblings\_99 : 0

node\_get\_fsm\_siblings\_100 : 0

node\_get\_fsm\_objsize\_mean : 0

node\_get\_fsm\_objsize\_median : 0

node\_get\_fsm\_objsize\_95 : 0

node\_get\_fsm\_objsize\_99 : 0

node\_get\_fsm\_objsize\_100 : 0

node\_get\_fsm\_time\_mean : 0

node\_get\_fsm\_time\_median : 0

node\_get\_fsm\_time\_95 : 0

node\_get\_fsm\_time\_99 : 0

node\_get\_fsm\_time\_100 : 0

node\_puts : 0

node\_puts\_total : 4575

node\_put\_fsm\_time\_mean : 0

node\_put\_fsm\_time\_median : 0

node\_put\_fsm\_time\_95 : 0

node\_put\_fsm\_time\_99 : 0

node\_put\_fsm\_time\_100 : 0

read\_repairs : 0

read\_repairs\_total : 129

coord\_redirs\_total : 1427

executing\_mappers : 0

precommit\_fail : 0

postcommit\_fail : 0

index\_fsm\_create : 0

index\_fsm\_create\_error : 0

index\_fsm\_active : 0

list\_fsm\_create : 0

list\_fsm\_create\_error : 0

list\_fsm\_active : 0

pbc\_active : 56

pbc\_connects : 60

pbc\_connects\_total : 163594

node\_get\_fsm\_active : 0

node\_get\_fsm\_active\_60s : 10

node\_get\_fsm\_in\_rate : 0

node\_get\_fsm\_out\_rate : 0

node\_get\_fsm\_rejected : 0

node\_get\_fsm\_rejected\_60s : 0

node\_get\_fsm\_rejected\_total : 0

node\_put\_fsm\_active : 0

node\_put\_fsm\_active\_60s : 0

node\_put\_fsm\_in\_rate : 0

node\_put\_fsm\_out\_rate : 0

node\_put\_fsm\_rejected : 0

node\_put\_fsm\_rejected\_60s : 0

node\_put\_fsm\_rejected\_total : 0

read\_repairs\_primary\_outofdate\_one : 0

read\_repairs\_primary\_outofdate\_count : 104

read\_repairs\_primary\_notfound\_one : 0

read\_repairs\_primary\_notfound\_count : 61

read\_repairs\_fallback\_notfound\_one : 0

read\_repairs\_fallback\_notfound\_count : 40

leveldb\_read\_block\_error : 0

riak\_pipe\_stat\_ts : 1408692262

pipeline\_active : 0

pipeline\_create\_count : 0

pipeline\_create\_one : 0

pipeline\_create\_error\_count : 0

pipeline\_create\_error\_one : 0

cpu\_nprocs : 263

cpu\_avg1 : 20

cpu\_avg5 : 23

cpu\_avg15 : 33

mem\_total : 8374890496

mem\_allocated : 7878340608

disk : [{"/",5766260,42},

 {"/dev",4080488,1},

 {"/run",1635724,1},

 {"/run/lock",5120,0},

 {"/run/shm",4089300,0},

 {"/var/log",1922060,4},

 {"/data",258030980,69}]

nodename : 'riak@ \*oldnode2\*'

connected\_nodes :
['newnode1','newnode2','newnode3','newnode4',newnode5','oldnode1','oldnode3',

 'riak@oldnode2']

sys\_driver\_version : <<"2.0">>

sys\_global\_heaps\_size : 0

sys\_heap\_type : private

sys\_logical\_processors : 2

sys\_otp\_release : <<"R15B01">>

sys\_process\_count : 1175

sys\_smp\_support : true

sys\_system\_version : <<"Erlang R15B01 (erts-5.9.1) [source] [64-bit]
[smp:2:2] [async-threads:64] [kernel-poll:true]">>

sys\_system\_architecture : <<"x86\_64-unknown-linux-gnu">>

sys\_threads\_enabled : true

sys\_thread\_pool\_size : 64

sys\_wordsize : 8

ring\_members :
 ['newnode1','newnode2','newnode3','newnode4',newnode5','oldnode1','oldnode3',

 'riak@oldnode2']

ring\_num\_partitions : 64

ring\_ownership : <<"[{'riak@oldnode1',16},\n {'riak@oldnode2',32},\n
{'riak@oldnode3',16}]">>

ring\_creation\_size : 64

storage\_backend : riak\_kv\_eleveldb\_backend

erlydtl\_version : <<"0.7.0">>

riak\_control\_version : <<"1.4.10-0-g73c43c3">>

cluster\_info\_version : <<"1.2.4">>

riak\_search\_version : <<"1.4.10-0-g6e548e7">>

merge\_index\_version : <<"1.3.2-0-gcb38ee7">>

riak\_kv\_version : <<"1.4.10-0-g64b6ad8">>

sidejob\_version : <<"0.2.0">>

riak\_api\_version : <<"1.4.10-0-gc407ac0">>

riak\_pipe\_version : <<"1.4.10-0-g9353526">>

riak\_core\_version : <<"1.4.10">>

bitcask\_version : <<"1.6.6-0-g230b6d6">>

basho\_stats\_version : <<"1.0.3">>

webmachine\_version : <<"1.10.4-0-gfcff795">>

mochiweb\_version : <<"1.5.1p6">>

inets\_version : <<"5.9">>

erlang\_js\_version : <<"1.2.2">>

runtime\_tools\_version : <<"1.8.8">>

os\_mon\_version : <<"2.2.9">>

riak\_sysmon\_version : <<"1.1.3">>

ssl\_version : <<"5.0.1">>

public\_key\_version : <<"0.15">>

crypto\_version : <<"2.1">>

sasl\_version : <<"2.2.1">>

lager\_version : <<"2.0.1">>

goldrush\_version : <<"0.1.5">>

compiler\_version : <<"4.8.1">>

syntax\_tools\_version : <<"1.6.8">>

stdlib\_version : <<"1.18.1">>

kernel\_version : <<"2.15.1">>

memory\_total : 222011368

memory\_processes : 29166010

memory\_processes\_used : 29165996

memory\_system : 192845358

memory\_atom : 545377

memory\_atom\_used : 519982

memory\_binary : 133403072

memory\_code : 11477147

memory\_ets : 7076680


2014-08-21 17:53 GMT+02:00 Luke Bakken :

> Hi Marcel -
>
> What version of Riak are you using?
>
> What is the output of "riak-admin transfer-limit" ?
> --
> Luke Bakken
> CSE
> lbak...@basho.com
>
>
> On Wed, Aug 20, 2014 at 8:02 AM, Marcel Koopman
>  wrote:
> > Hello,
> >
> > It seems that adding new nodes does not have any effect.
> >
> > Why it Riak waiting for transfers? When does it start handoff the new
> nodes?
> >
> >
> > riak-admin member-status
> >
> > ================================= Membership
> > ==================================
> >
> > Status Ring Pending Node
> >
> >
> -------------------------------------------------------------------------------
> >
> > valid 25.0% 34.4% 'riak@oldnode1'
> >
> > valid 25.0% 32.8% 'riak@oldnode2'
> >
> > valid 50.0% 32.8% 'riak@oldnode3
> >
> > valid 0.0% 0.0% 'riak@newnode1'
> >
> > valid 0.0% 0.0% 'riak@newnode2'
> >
> > valid 0.0% 0.0% 'riak@newnode3'
> >
> > valid 0.0% 0.0% 'riak@newnode4'
> >
> > valid 0.0% 0.0% 'riak@newnode5'
> >
> >
> -------------------------------------------------------------------------------
> >
> > Valid:8 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
> >
> >
> > riak-admin transfers
> >
> > 'riak@newnode5' waiting to handoff 11 partitions
> >
> > 'riak@newnode4' waiting to handoff 11 partitions
> >
> > 'riak@newnode3' waiting to handoff 11 partitions
> >
> > 'riak@newnode2' waiting to handoff 11 partitions
> >
> > 'riak@newnode1' waiting to handoff 11 partitions
> >
> > 'riak@oldnode1' waiting to handoff 11 partitions
> >
> > 'riak@oldnode2' waiting to handoff 11 partitions
> >
> > Active Transfers:
> >
> > (nothing here)
> >
> >
> >
> >
> >
> > --
> > Met vriendelijke groet,
> >
> > Marcel Koopman
> >
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >
>



-- 
Met vriendelijke groet,

Marcel Koopman
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

