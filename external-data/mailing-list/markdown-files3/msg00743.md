---
title: "Re: Riak 0.11.0 hanging on OSX 10.6"
description: ""
project: community
lastmod: 2010-07-19T06:40:34-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00743"
mailinglist_parent_id: "msg00742"
author_name: "Shane Holloway"
project_section: "mailinglistitem"
sent_date: 2010-07-19T06:40:34-07:00
---


Thanks -- ulimit -n 1024 fixed my problem. It's wonderfully stable now -- even 
under high load.


On Jul 19, 2010, at 2:30 AM, Daniel Reverri wrote:

> Hi Shane,
> 
> Can you try increasing the number of allowed open file handles on your system?
> ulimit -n 1024
> 
> You can check this setting from a riak console by typing:
> os:cmd("ulimit -a").
> 
> Thanks,
> Dan
> 
> Sent from my iPhone
> 
> On Jul 18, 2010, at 10:32 PM, Shane Holloway  wrote:
> 
>> I'm having a bit of a problem with Riak. When I keep my new documents to 
>> about 10 per second, Riak works fine. But as I increase my speed to about 
>> 100 docs per second, Riak gets dramatically slow. After a while, the beam 
>> process takes 100% of my CPU and no longer responds to ping/stop or any 
>> other command from the bin folder. I end up sending kill TERM to stop the 
>> process. 
>> 
>> If I restart Riak, the bitcask backend seems to be limited to about 1-2 
>> document stores per second, but read seems fairly responsive still. I'd 
>> appreciate any thoughts or troubleshooting tips you may have. It's an 
>> in-development database with demo data, so I can run any experiments you'd 
>> like to see.
>> 
>> Thanks,
>> -Shane
>> 
>> 
>> 
>> Riak/riakOne% ./bin/riak-admin status
>> 1-minute stats for 'r...@172.20.0.49'
>> -------------------------------------------
>> vnode gets : 104
>> vnode\_puts : 103
>> vnode\_gets\_total : 136
>> vnode\_puts\_total : 127
>> node\_gets : 36
>> node\_gets\_total : 47
>> node\_get\_fsm\_time\_mean : 2635.1111111111113
>> node\_get\_fsm\_time\_median : 667
>> node\_get\_fsm\_time\_95 : 9156
>> node\_get\_fsm\_time\_99 : 40652
>> node\_get\_fsm\_time\_100 : 40652
>> node\_puts : 36
>> node\_puts\_total : 44
>> node\_put\_fsm\_time\_mean : 1670575.611111111
>> node\_put\_fsm\_time\_median : 1157
>> node\_put\_fsm\_time\_95 : 23900
>> node\_put\_fsm\_time\_99 : 60000511
>> node\_put\_fsm\_time\_100 : 60000511
>> cpu\_nprocs : 0
>> cpu\_avg1 : 0
>> cpu\_avg5 : 0
>> cpu\_avg15 : 0
>> mem\_total : 0
>> mem\_allocated : 0
>> disk : [{"none",0,0}]
>> nodename : 'r...@172.20.0.49'
>> connected\_nodes : ['riak\_maint\_61...@172.20.0.49']
>> sys\_driver\_version : <<"1.5">>
>> sys\_global\_heaps\_size : 0
>> sys\_heap\_type : private
>> sys\_logical\_processors : 2
>> sys\_otp\_release : <<"R13B04">>
>> sys\_process\_count : 167
>> sys\_smp\_support : true
>> sys\_system\_version : <<"Erlang R13B04 (erts-5.7.5) [source] [64-bit] 
>> [smp:2:2] [rq:2] [async-threads:5] [hipe] [kernel-poll:true]\n">>
>> sys\_system\_architecture : <<"i386-apple-darwin9.4.0">>
>> sys\_threads\_enabled : true
>> sys\_thread\_pool\_size : 5
>> sys\_wordsize : 8
>> ring\_members : ['r...@172.20.0.49']
>> ring\_num\_partitions : 64
>> ring\_ownership : <<"[{'r...@172.20.0.49',64}]">>
>> ring\_creation\_size : 64
>> storage\_backend : riak\_kv\_bitcask\_backend
>> pbc\_connects\_total : 0
>> pbc\_connects : 0
>> pbc\_active : 0
>> 
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

