---
title: "Re: riak restart does not restart yokozuka well"
description: ""
project: community
lastmod: 2015-09-14T08:45:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16520"
mailinglist_parent_id: "msg16519"
author_name: "Alexander Popov"
project_section: "mailinglistitem"
sent_date: 2015-09-14T08:45:13-07:00
---


Yes there is plenty of errors there like
Committed before 500 {msg=GC overhead limit
exceeded,trace=java.lang.OutOfMemoryError: GC overhead limit exceeded
 null:org.eclipse.jetty.io.EofException

and so on, this is reason why I try to restart node

My concerns is:
\* search on this node come to un-working state and not repaired itself
\* halted node, requires manual actions
\* false positive report or\* riak restart \*


On Mon, Sep 14, 2015 at 6:22 PM, Fred Dushin  wrote:

> Check the solr logs to see why it failed to shut down. If necessary, find
> the pid bound to port 8985 and kill it.
>
> -Fred
>
> On Sep 14, 2015, at 5:28 AM, Alexander Popov  wrote:
>
> i'm doing riak restart
> and got 'ok' in answer, but node appears in shutdown state.
>
> in proccess list i found that solr is still running, and in logs found :
>
> 2015-09-14 09:21:03.939 [info] <0.579.0>@yz\_solr\_proc:init:96 Starting
> solr: "/usr/bin/java"
> ["-Djava.awt.headless=true","-Djetty.home=/usr/lib/riak/lib/yokozuna-2.1.0-0-gcb41c27/priv/solr","-Djetty.port=80
> 2015-09-14 09:21:04.006 [warning] <0.6.0> lager\_error\_logger\_h dropped 6
> messages in the last second that exceeded the limit of 100 messages/sec
> 2015-09-14 09:21:04.006 [info] <0.7.0> Application yokozuna started on
> node 'riak@ip-10-0-0-147.ec2.internal'
> 2015-09-14 09:21:04.010 [info] <0.7.0> Application cluster\_info started on
> node 'riak@ip-10-0-0-147.ec2.internal'
> 2015-09-14 09:21:04.047 [info]
> <0.209.0>@riak\_core\_capability:process\_capability\_changes:555 New
> capability: {riak\_control,member\_info\_version} = v1
> 2015-09-14 09:21:04.051 [info] <0.7.0> Application riak\_control started on
> node 'riak@ip-10-0-0-147.ec2.internal'
> 2015-09-14 09:21:04.051 [info] <0.7.0> Application erlydtl started on node
> 'riak@ip-10-0-0-147.ec2.internal'
> 2015-09-14 09:21:04.062 [info] <0.7.0> Application riak\_auth\_mods started
> on node 'riak@ip-10-0-0-147.ec2.internal'
> 2015-09-14 09:21:04.156 [info] <0.579.0>@yz\_solr\_proc:handle\_info:135 solr
> stdout/err: Error: Exception thrown by the agent.
> 2015-09-14 09:21:04.156 [info] <0.579.0>@yz\_solr\_proc:handle\_info:135 solr
> stdout/err: : java.rmi.server.ExportException: Port already in use: 8985;
> nested exception is:.
> <------>java.net.BindException: Address already in use
>
> 2015-09-14 09:21:04.476 [error] <0.579.0> gen\_server yz\_solr\_proc
> terminated with reason: {"solr OS process exited",1}
> 2015-09-14 09:21:04.476 [error] <0.579.0> CRASH REPORT Process
> yz\_solr\_proc with 0 neighbours exited with reason: {"solr OS process
> exited",1} in gen\_server:terminate/6 line 744
> 2015-09-14 09:21:04.476 [error] <0.578.0> Supervisor yz\_solr\_sup had child
> yz\_solr\_proc started with yz\_solr\_proc:start\_link("/var/lib/riak/yz", 8093,
> 8985) at <0.579.0> exit with reason {"solr OS process e
> 2015-09-14 09:21:04.477 [info] <0.622.0>@yz\_solr\_proc:init:96 Starting
> solr: "/usr/bin/java"
> ["-Djava.awt.headless=true","-Djetty.home=/usr/lib/riak/lib/yokozuna-2.1.0-0-gcb41c27/priv/solr","-Djetty.port=80
> 2015-09-14 09:21:04.710 [info] <0.622.0>@yz\_solr\_proc:handle\_info:135 solr
> stdout/err: Error: Exception thrown by the agent.
> 2015-09-14 09:21:04.710 [info] <0.622.0>@yz\_solr\_proc:handle\_info:135 solr
> stdout/err: : java.rmi.server.ExportException: Port already in use: 8985;
> nested exception is:.
> <------>java.net.BindException: Address already in use
>
> 2015-09-14 09:21:05.029 [error] <0.622.0> gen\_server yz\_solr\_proc
> terminated with reason: {"solr OS process exited",1}
> 2015-09-14 09:21:05.029 [error] <0.622.0> CRASH REPORT Process
> yz\_solr\_proc with 0 neighbours exited with reason: {"solr OS process
> exited",1} in gen\_server:terminate/6 line 744
> 2015-09-14 09:21:05.030 [error] <0.578.0> Supervisor yz\_solr\_sup had child
> yz\_solr\_proc started with yz\_solr\_proc:start\_link("/var/lib/riak/yz", 8093,
> 8985) at <0.622.0> exit with reason {"solr OS process e
> 2015-09-14 09:21:05.030 [error] <0.578.0> Supervisor yz\_solr\_sup had child
> yz\_solr\_proc started with yz\_solr\_proc:start\_link("/var/lib/riak/yz", 8093,
> 8985) at <0.622.0> exit with reason reached\_max\_restart
> 2015-09-14 09:21:05.030 [error] <0.577.0> Supervisor yz\_sup had child
> yz\_solr\_sup started with yz\_solr\_sup:start\_link() at <0.578.0> exit with
> reason shutdown in context child\_terminated
> 2015-09-14 09:21:05.030 [error] <0.577.0> Supervisor yz\_sup had child
> yz\_solr\_sup started with yz\_solr\_sup:start\_link() at <0.578.0> exit with
> reason reached\_max\_restart\_intensity in context shutdown
> 2015-09-14 09:21:05.031 [info] <0.7.0> Application yokozuna exited with
> reason: shutdown
> 2015-09-14 09:21:05.033 [info] <0.340.0>@riak\_kv\_app:prep\_stop:232
> Stopping application riak\_kv - marked service down.
> 2015-09-14 09:21:05.034 [info] <0.340.0>@riak\_kv\_app:prep\_stop:236
> Unregistered pb services
> 2015-09-14 09:21:05.034 [info] <0.340.0>@riak\_kv\_app:prep\_stop:241
> unregistered webmachine routes
> 2015-09-14 09:21:05.037 [info] <0.340.0>@riak\_kv\_app:prep\_stop:243 all
> active put FSMs completed
> 2015-09-14 09:21:05.038 [info] <0.415.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_hook) host stopping (<0.415.0>)
> 2015-09-14 09:21:05.038 [info] <0.416.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_hook) host stopping (<0.416.0>)
> 2015-09-14 09:21:05.038 [info] <0.408.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (<0.408.0>)
> 2015-09-14 09:21:05.038 [info] <0.410.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (<0.410.0>)
> 2015-09-14 09:21:05.038 [info] <0.409.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (<0.409.0>)
> 2015-09-14 09:21:05.038 [info] <0.412.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (<0.412.0>)
> 2015-09-14 09:21:05.038 [info] <0.413.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (<0.413.0>)
> 2015-09-14 09:21:05.038 [info] <0.411.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_reduce) host stopping (<0.411.0>)
> 2015-09-14 09:21:05.039 [info] <0.404.0>@riak\_kv\_js\_vm:terminate:237
> Spidermonkey VM (pool: riak\_kv\_js\_map) host stopping (<0.404.0>)
> 2015-09-14 09:21:05.039 [info] <0.340.0>@riak\_kv\_app:stop:254 Stopped
> application riak\_kv.
> 2015-09-14 09:21:05.043 [info] <0.165.0>@riak\_core\_app:stop:114 Stopped
> application riak\_core.
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

