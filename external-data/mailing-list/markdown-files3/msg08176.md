---
title: "Re: riak-erlang-client search changes"
description: ""
project: community
lastmod: 2012-08-03T08:18:04-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08176"
mailinglist_parent_id: "msg08170"
author_name: "Dave Parfitt"
project_section: "mailinglistitem"
sent_date: 2012-08-03T08:18:04-07:00
---


Hello -
 
Instead of returning a tuple for Riak Search results, we'll return a record 
instead:

-record(search\_results, {
 docs :: [search\_doc()], %% Result documents
 max\_score :: float(), %% Maximum score
 num\_found :: non\_neg\_integer() %% Number of results
 }).

Cheers -
Dave

On Aug 2, 2012, at 11:08 PM, Andrew Berman wrote:

> The more fields the better. I like this change.
> 
> Andrew
> 
> On Aug 2, 2012 8:17 AM, "Dave Parfitt"  wrote:
> Hello -
> We're considering some changes to the Riak Search functionality in 
> riak-erlang-client for the upcoming Riak 1.2 release. The current behavior of 
> the riakc\_pb\_socket:search/\* functions return a list in the form: [[Index, 
> Id],[Index2,Id2],...]
> 
> With the new Riak Search protobuffs messages, we have the ability to also 
> return fields from the search doc in the results (as additional values in the 
> tuple). Also, it's possible to return the search results "max score", and 
> "number found". Does anyone have any objections to returning additional 
> fields? To maintain semi-compatible behavior, it's possible to use the fl 
> (field limit) search option to just return the id.
> 
> Current behavior:
> riakc\_pb\_socket:search(Pid, <<"phrases\_custom">>, <<"phrase:fox">>). 
> 
> {ok,[[<<"phrases\_custom">>,<<"5">>],
> [<<"phrases\_custom">>,<<"1">>]]}
> 
> Proposed behavior:
> riakc\_pb\_socket:search(Pid, <<"phrases\_custom">>, <<"phrase:fox">>).
> {ok,[{<<"phrases\_custom">>,
> [{<<"id">>,<<"1">>}, 
> {<<"phrase">>,<<"The quick brown fox jumps over the lazy dog">>}],
> {<<"phrases\_custom">>,
> [{<<"id">>,<<"5">>},
> {<<"phrase">>,<<"The quick brown fox jumps over the lazy dog">>}],
> 0.0,2}
> %% Note the last two fields of the result are Max Score and Number Found.
> 
> Semi-compatible behavior by specifying the fl (with the exception of max 
> score and number found):
> riakc\_pb\_socket:search(Pid, <<"phrases\_custom">>, <<"phrase:fox">>, 
> [{fl,[<<"id">>]}], 5000, 5000).
> {ok,[{<<"phrases\_custom">>,[{<<"id">>,<<"1">>}]},
> {<<"phrases\_custom">>,[{<<"id">>,<<"5">>}]},
> 0.0,2}
> 
> Cheers -
> Dave
> 
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

