---
title: "Re: distributed basho bench"
description: ""
project: community
lastmod: 2016-01-17T20:05:00-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16976"
mailinglist_parent_id: "msg16515"
author_name: "Kinson Chan 陳傑信"
project_section: "mailinglistitem"
sent_date: 2016-01-17T20:05:00-08:00
---


Sorry for pumping the thread, but it looks much less trivial than anticipated. 
Without a single line of error, the benchmark program (bhead) simply started 
everything by itself. I have watched login records of the remote nodes, and 
there has not been a single login attempt. Could anyone give me some hints? 
Thanks...

[root@iZ94zaby5xkZ basho\_bench]# basho\_bench -N bhead@10.44.90.29 -C mycookies 
-d /root/basho\_bench/results /root/basho\_bench/basho\_cluster.config 
 
 
11:58:02.157 [debug] Lager installed handler {lager\_file\_backend,
 
"/root/basho\_bench/results/20160118\_115802/console.log"} into lager\_event
11:58:02.157 [debug] Lager installed handler {lager\_file\_backend,
 
"/root/basho\_bench/results/20160118\_115802/error.log"} into lager\_event
11:58:02.157 [debug] Lager installed handler error\_logger\_lager\_h into 
error\_logger
11:58:02.173 [debug] Supervisor gr\_param\_sup started 
gr\_param:start\_link(gr\_lager\_default\_tracer\_params) at pid <0.67.0>
11:58:02.173 [debug] Supervisor gr\_counter\_sup started 
gr\_counter:start\_link(gr\_lager\_default\_tracer\_counters) at pid <0.68.0>
11:58:02.173 [debug] Supervisor gr\_manager\_sup started 
gr\_manager:start\_link(gr\_lager\_default\_tracer\_params\_mgr, 
gr\_lager\_default\_tracer\_params, []) at pid <0.69.0>
11:58:02.173 [debug] Supervisor gr\_manager\_sup started 
gr\_manager:start\_link(gr\_lager\_default\_tracer\_counters\_mgr, 
gr\_lager\_default\_tracer\_counters, [{input,0},{filter,0},{output,0}]) at pid 
<0.70.0>
11:58:02.309 [info] Application lager started on node 'bhead@10.44.90.29'
11:58:02.312 [notice] Changed loglevel of 
/root/basho\_bench/results/20160118\_115802/console.log to debug
11:58:02.320 [debug] Supervisor inet\_gethost\_native\_sup started undefined at 
pid <0.80.0>
11:58:02.320 [debug] Supervisor kernel\_safe\_sup started 
inet\_gethost\_native:start\_link() at pid <0.79.0>
11:58:02.642 [debug] Lager installed handler lager\_backend\_throttle into 
lager\_event
11:58:02.712 [info] No dimension available for key generator: 
{int\_to\_bin\_bigendian,{uniform\_int,200000}}
11:58:02.727 [debug] Supervisor sasl\_safe\_sup started 
alarm\_handler:start\_link() at pid <0.93.0>
11:58:02.728 [debug] Supervisor sasl\_safe\_sup started overload:start\_link() at 
pid <0.94.0>
11:58:02.732 [debug] Supervisor sasl\_sup started 
supervisor:start\_link({local,sasl\_safe\_sup}, sasl, safe) at pid <0.92.0>
11:58:02.738 [debug] Supervisor sasl\_sup started release\_handler:start\_link() 
at pid <0.95.0>
11:58:02.738 [info] Application sasl started on node 'bhead@10.44.90.29'
11:58:02.745 [debug] Supervisor crypto\_sup started crypto\_server:start\_link() 
at pid <0.101.0>
11:58:02.746 [info] Application crypto started on node 'bhead@10.44.90.29'
11:58:02.746 [debug] Supervisor folsom\_sup started 
folsom\_sample\_slide\_sup:start\_link() at pid <0.111.0>
11:58:02.746 [debug] Supervisor folsom\_sup started 
folsom\_meter\_timer\_server:start\_link() at pid <0.112.0>
11:58:02.747 [debug] Supervisor folsom\_sup started 
folsom\_metrics\_histogram\_ets:start\_link() at pid <0.113.0>
11:58:02.747 [info] Application folsom started on node 'bhead@10.44.90.29'
11:58:02.748 [info] Random source: calling crypto:rand\_bytes(100663296) 
(override with the 'value\_generator\_source\_size' config option
11:58:02.748 [debug] Supervisor basho\_bench\_sup started 
basho\_bench\_stats:start\_link() at pid <0.106.0>
11:58:05.655 [info] Random source: finished crypto:rand\_bytes(100663296)
11:58:05.658 [info] Using target {10,44,90,29}:8087 for worker 1
11:58:05.659 [debug] Supervisor basho\_bench\_sup started 
basho\_bench\_worker:start\_link(basho\_bench\_worker\_1, 1) at pid <0.116.0>
11:58:05.660 [info] Using target {10,116,145,71}:8087 for worker 2
11:58:05.660 [info] Using target {10,44,90,29}:8087 for worker 3
11:58:05.661 [info] Using target {10,116,145,71}:8087 for worker 4
11:58:05.661 [debug] Supervisor basho\_bench\_sup started 
basho\_bench\_worker:start\_link(basho\_bench\_worker\_2, 2) at pid <0.120.0>
11:58:05.661 [debug] Supervisor basho\_bench\_sup started 
basho\_bench\_worker:start\_link(basho\_bench\_worker\_3, 3) at pid <0.123.0>
11:58:05.662 [info] Starting max worker: <0.127.0> on 'bhead@10.44.90.29'
11:58:05.662 [info] Starting max worker: <0.124.0> on 'bhead@10.44.90.29'
11:58:05.662 [debug] Supervisor basho\_bench\_sup started 
basho\_bench\_worker:start\_link(basho\_bench\_worker\_4, 4) at pid <0.126.0>
11:58:05.662 [info] Starting max worker: <0.121.0> on 'bhead@10.44.90.29'
11:58:05.663 [info] Starting max worker: <0.118.0> on 'bhead@10.44.90.29'
11:58:05.663 [debug] Supervisor kernel\_safe\_sup started timer:start\_link() at 
pid <0.129.0>
11:58:05.663 [info] Application basho\_bench started on node 'bhead@10.44.90.29'

In the basho\_cluster.config:
{mode, max}.
{duration, 5}.
{report\_interval,1}.
{concurrent, 4}.
{driver, basho\_bench\_driver\_riakc\_pb}.
{key\_generator, {int\_to\_bin\_bigendian, {uniform\_int, 200000}}}.
{value\_generator, {fixed\_bin, 1000}}.
{riakc\_pb\_ips, [{10,44,90,29},{10,116,145,71}]}.
{riakc\_pb\_replies, 1}.
{operations, [{get, 1}, {update, 1}]}.
%% Use {auto\_reconnect, false} to get "old" behavior (prior to April 2013).
%% See deps/riakc/src/riakc\_pb\_socket.erl for all valid socket options.
{pb\_connect\_options, [{auto\_reconnect, true}]}.
%% Overrides for the PB client's default 60 second timeout, on a
%% per-type-of-operation basis. All timeout units are specified in
%% milliseconds. The pb\_timeout\_general config item provides a
%% default timeout if the read/write/listkeys/mapreduce timeout is not
%% specified.
{pb\_timeout\_general, 30000}.
{pb\_timeout\_read, 5000}.
{pb\_timeout\_write, 5000}.
{pb\_timeout\_listkeys, 50000}.
%% The general timeout will be used because this specific item is commented:
%% {pb\_timeout\_mapreduce, 50000}.
%% Remote\_nodes must be in the format of [{fqdn, nodename}]
%% basho\_bench / distributed Erlang use longnames
{remote\_nodes, [{'head.local', 'bb'}, {'head2.local', 'bb'}]}.
{distribute\_work, true}.

Regards,
Kinson

On 14 Sep, 2015, at 11:23 am, Sargun Dhillon  wrote:

> So, the way it should work is pretty simple:
> Run the command a la: ./basho\_bench -N nodeA@10.0.1.123 -C basho\_bench\_cookie 
>  
> (It's key that the IP address be the external IP, and not the internal IP of 
> the box, a la loopback)
> 
> In addition, nodeB must have the same version of Erlang installed as Node A. 
> So, typically, you should install ESL Erlang (my recommendation is R16, 
> https://www.erlang-solutions.com/downloads/download-erlang-otp) on both 
> boxes, and compile your own Basho bench.
> 
> -Thanks,
> Sargun!
> 
> On Thu, Sep 10, 2015 at 9:15 AM, Jens V. Fischer  
> wrote:
> Hi,
> 
> I'm trying to use basho bench in distributed mode, that is to say to use more 
> than one machine for load generation. The documentation and the "--join" 
> param of the basho\_bench seem to indicate that this should be possible. But 
> so far I failed to set it up. Let's say I want to start basho bench on two 
> nodes, lets call them Node A and B. What parameters to basho\_bench are needed 
> on A and B respectively? 
> 
> I also saw the previous mail exchange on the topic (How to run bash bench 
> distributed, 18.5.2015). From there I gathered that I need to use something 
> like the following (for Node A):
> 
> Start command:
> ./basho\_bench -N nodeA@127.0.0.1 -C basho\_bench\_cookie 
> 
> Also I need in my config (on Node A):
> {remote\_nodes, [{, 'nodeB'}]}.
> {distribute\_work, true}.
> 
> Do I need to do anything on Node B? Like starting basho\_bench with "--join"? 
> What would the command look like? What do I need to put into my config on 
> Node B? In what order do I have to execute the commands on A and B? 
> 
> Additionally, as I am trying to use the distributed setup with a custom 
> driver: Does distributed mode only works with certain drivers, i.e. does the 
> driver need to support it? For what exactly is the passwordless SSH needed? 
> Because I don't have SSH access on the particular cluster, I do however have 
> access over TCP and are, for example, able to setup distributed Erlang 
> between the nodes. Any chance to get basho\_bench working in this setup?
> 
> Any help is greatly appreciated. I'm glad to provide more information if 
> needed. 
> 
> Best regards
> Jens
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

--
Kinson Chan, PhD
Senior System Engineer
Direct Line: +852 2655 6113 Tel: +852 2655 6100 Email:
kinsonc...@clustertech.com

ClusterTech Limited
Modernize Your Business with Advanced Computing Technologies
Cloud + High Performance Computing + Big Data + FPGA
Business Intelligence ∙ Financial Engineering ∙ Environmental Science ∙ Smart 
City

Website: www.clustertech.com/ Fax: +852 2994 2101
Hong Kong Address: Units 211 - 213, Lakeside 1, No. 8 Science Park West
Ave., Science Park, N.T. Hong Kong
Hong Kong ∙ Beijing ∙ Shanghai ∙ Guangzhou ∙ Shenzhen ∙ Wuhan ∙ Xi'an ∙ Sydney
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
The information contained in this e-mail and its attachments is
confidential and intended solely for the specified addressees. If you
have received this email in error, please do not read, copy, distribute,
disclose or use any information of this email in any way and please
immediately notify the sender and delete this email. Thank you for your
cooperation.
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

