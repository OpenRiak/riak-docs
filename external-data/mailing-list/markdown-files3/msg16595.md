---
title: "Re: Re: Yokozuna indexes too slow"
description: ""
project: community
lastmod: 2015-10-01T23:24:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16595"
mailinglist_parent_id: "msg16581"
author_name: "ilyas"
project_section: "mailinglistitem"
sent_date: 2015-10-01T23:24:44-07:00
---




It looks like this issues

https://github.com/basho/yokozuna/issues/320

I try to set

 \* |maxThreads| to |150|
 \* |Acceptors| to |10|
 \* |lowResourcesMaxIdleTime| to |50000|

in /usr/lib/riak/lib/yokozuna/priv/solr/etc/jetty.xml as recommended in 
https://github.com/basho/yokozuna/issues/330


but it has no effect

On 10/01/2015 11:53 PM, Fred Dushin wrote:

Is there any more information in these logs that you can share? For example, 
is this the only entry with this exception? Or are there more? Are there any 
associated stack traces? An EOF exception can come from many different 
scenarios.

Is there anything in the Riak console.log that looks suspicious?

Finally, you might want to take a look at what is going on inside of riak when 
you get into this state (slow writes to Solr), by looking at Riak stats.

You get get to Riak stats via curl, e.g.,

 curlhttp://localhost:8098/stats | python -m json.tool

ok, output is attached


Stats you might want to pay special attention to:

riak\_kv\_vnodeq (min, max, median, etc) -- the aggregate length of the vnode 
queues. Long vnode queues may mean your vnode is locked waiting on Solr
vnode\_put\_fsm\_time (mean, media, percentile, etc) The amount of time spent on 
average waiting for a vnode put to complete. Long times may also be indicative 
of waits writing into Solr.

"riak\_kv\_vnodeq\_max": 0,
"riak\_kv\_vnodeq\_mean": 0.0,
"riak\_kv\_vnodeq\_median": 0,
"riak\_kv\_vnodeq\_min": 0,
"riak\_kv\_vnodeq\_total": 0,


{
 "asn1\_version": "2.0.3",
 "basho\_stats\_version": "1.0.3",
 "bitcask\_version": "1.7.0",
 "clique\_version": "0.2.6-0-g40072d2",
 "cluster\_info\_version": "2.0.2-0-ge231144",
 "compiler\_version": "4.9.3",
 "connected\_nodes": [
 "riak@10.31.0.68",
 "riak@10.31.0.67",
 "riak@10.31.0.66",
 "riak@10.31.0.65"
 ],
 "consistent\_get\_objsize\_100": 0,
 "consistent\_get\_objsize\_95": 0,
 "consistent\_get\_objsize\_99": 0,
 "consistent\_get\_objsize\_mean": 0,
 "consistent\_get\_objsize\_median": 0,
 "consistent\_get\_time\_100": 0,
 "consistent\_get\_time\_95": 0,
 "consistent\_get\_time\_99": 0,
 "consistent\_get\_time\_mean": 0,
 "consistent\_get\_time\_median": 0,
 "consistent\_gets": 0,
 "consistent\_gets\_total": 0,
 "consistent\_put\_objsize\_100": 0,
 "consistent\_put\_objsize\_95": 0,
 "consistent\_put\_objsize\_99": 0,
 "consistent\_put\_objsize\_mean": 0,
 "consistent\_put\_objsize\_median": 0,
 "consistent\_put\_time\_100": 0,
 "consistent\_put\_time\_95": 0,
 "consistent\_put\_time\_99": 0,
 "consistent\_put\_time\_mean": 0,
 "consistent\_put\_time\_median": 0,
 "consistent\_puts": 0,
 "consistent\_puts\_total": 0,
 "converge\_delay\_last": 0,
 "converge\_delay\_max": 0,
 "converge\_delay\_mean": 0,
 "converge\_delay\_min": 0,
 "coord\_redirs\_total": 5066,
 "counter\_actor\_counts\_100": 0,
 "counter\_actor\_counts\_95": 0,
 "counter\_actor\_counts\_99": 0,
 "counter\_actor\_counts\_mean": 0,
 "counter\_actor\_counts\_median": 0,
 "cpu\_avg1": 82,
 "cpu\_avg15": 123,
 "cpu\_avg5": 108,
 "cpu\_nprocs": 552,
 "crypto\_version": "3.1",
 "disk": [
 {
 "id": "/",
 "size": 474203304,
 "used": 2
 },
 {
 "id": "/dev",
 "size": 10240,
 "used": 0
 },
 {
 "id": "/run",
 "size": 3285280,
 "used": 10
 },
 {
 "id": "/dev/shm",
 "size": 8213192,
 "used": 0
 },
 {
 "id": "/run/lock",
 "size": 5120,
 "used": 0
 },
 {
 "id": "/sys/fs/cgroup",
 "size": 8213192,
 "used": 0
 },
 {
 "id": "/tmp",
 "size": 1933648,
 "used": 1
 },
 {
 "id": "/boot",
 "size": 457760,
 "used": 12
 },
 {
 "id": "/var/lib/riak",
 "size": 468361760,
 "used": 1
 },
 {
 "id": "/run/user/1004",
 "size": 1642640,
 "used": 0
 },
 {
 "id": "/run/user/1001",
 "size": 1642640,
 "used": 0
 }
 ],
 "dropped\_vnode\_requests\_total": 0,
 "eleveldb\_version": "2.1.0-0-ga36dbd6",
 "erlang\_js\_version": "1.3.0-0-g07467d8",
 "erlydtl\_version": "0.7.0",
 "executing\_mappers": 0,
 "exometer\_core\_version": "1.0.0-basho2-0-gb47a5d6",
 "goldrush\_version": "0.1.6",
 "gossip\_received": 7,
 "handoff\_timeouts": 0,
 "ibrowse\_version": "4.0.2",
 "ignored\_gossip\_total": 0,
 "index\_fsm\_active": 0,
 "index\_fsm\_create": 0,
 "index\_fsm\_create\_error": 0,
 "inets\_version": "5.9.6",
 "kernel\_version": "2.16.3",
 "lager\_version": "2.0.3",
 "late\_put\_fsm\_coordinator\_ack": 0,
 "leveldb\_read\_block\_error": 0,
 "list\_fsm\_active": 0,
 "list\_fsm\_create": 0,
 "list\_fsm\_create\_error": 0,
 "list\_fsm\_create\_error\_total": 0,
 "list\_fsm\_create\_total": 0,
 "map\_actor\_counts\_100": 0,
 "map\_actor\_counts\_95": 0,
 "map\_actor\_counts\_99": 0,
 "map\_actor\_counts\_mean": 0,
 "map\_actor\_counts\_median": 0,
 "mem\_allocated": 7542112256,
 "mem\_total": 16820621312,
 "memory\_atom": 752537,
 "memory\_atom\_used": 745783,
 "memory\_binary": 68929880,
 "memory\_code": 16809458,
 "memory\_ets": 8286048,
 "memory\_processes": 114315184,
 "memory\_processes\_used": 114277960,
 "memory\_system": 115784256,
 "memory\_total": 230099440,
 "merge\_index\_version": "2.0.0-0-gb701dde",
 "mochiweb\_version": "2.9.0",
 "node\_get\_fsm\_active": 0,
 "node\_get\_fsm\_active\_60s": 0,
 "node\_get\_fsm\_counter\_objsize\_100": 0,
 "node\_get\_fsm\_counter\_objsize\_95": 0,
 "node\_get\_fsm\_counter\_objsize\_99": 0,
 "node\_get\_fsm\_counter\_objsize\_mean": 0,
 "node\_get\_fsm\_counter\_objsize\_median": 0,
 "node\_get\_fsm\_counter\_siblings\_100": 0,
 "node\_get\_fsm\_counter\_siblings\_95": 0,
 "node\_get\_fsm\_counter\_siblings\_99": 0,
 "node\_get\_fsm\_counter\_siblings\_mean": 0,
 "node\_get\_fsm\_counter\_siblings\_median": 0,
 "node\_get\_fsm\_counter\_time\_100": 0,
 "node\_get\_fsm\_counter\_time\_95": 0,
 "node\_get\_fsm\_counter\_time\_99": 0,
 "node\_get\_fsm\_counter\_time\_mean": 0,
 "node\_get\_fsm\_counter\_time\_median": 0,
 "node\_get\_fsm\_errors": 0,
 "node\_get\_fsm\_errors\_total": 0,
 "node\_get\_fsm\_in\_rate": 0,
 "node\_get\_fsm\_map\_objsize\_100": 0,
 "node\_get\_fsm\_map\_objsize\_95": 0,
 "node\_get\_fsm\_map\_objsize\_99": 0,
 "node\_get\_fsm\_map\_objsize\_mean": 0,
 "node\_get\_fsm\_map\_objsize\_median": 0,
 "node\_get\_fsm\_map\_siblings\_100": 0,
 "node\_get\_fsm\_map\_siblings\_95": 0,
 "node\_get\_fsm\_map\_siblings\_99": 0,
 "node\_get\_fsm\_map\_siblings\_mean": 0,
 "node\_get\_fsm\_map\_siblings\_median": 0,
 "node\_get\_fsm\_map\_time\_100": 0,
 "node\_get\_fsm\_map\_time\_95": 0,
 "node\_get\_fsm\_map\_time\_99": 0,
 "node\_get\_fsm\_map\_time\_mean": 0,
 "node\_get\_fsm\_map\_time\_median": 0,
 "node\_get\_fsm\_objsize\_100": 0,
 "node\_get\_fsm\_objsize\_95": 0,
 "node\_get\_fsm\_objsize\_99": 0,
 "node\_get\_fsm\_objsize\_mean": 0,
 "node\_get\_fsm\_objsize\_median": 0,
 "node\_get\_fsm\_out\_rate": 0,
 "node\_get\_fsm\_rejected": 0,
 "node\_get\_fsm\_rejected\_60s": 0,
 "node\_get\_fsm\_rejected\_total": 0,
 "node\_get\_fsm\_set\_objsize\_100": 0,
 "node\_get\_fsm\_set\_objsize\_95": 0,
 "node\_get\_fsm\_set\_objsize\_99": 0,
 "node\_get\_fsm\_set\_objsize\_mean": 0,
 "node\_get\_fsm\_set\_objsize\_median": 0,
 "node\_get\_fsm\_set\_siblings\_100": 0,
 "node\_get\_fsm\_set\_siblings\_95": 0,
 "node\_get\_fsm\_set\_siblings\_99": 0,
 "node\_get\_fsm\_set\_siblings\_mean": 0,
 "node\_get\_fsm\_set\_siblings\_median": 0,
 "node\_get\_fsm\_set\_time\_100": 0,
 "node\_get\_fsm\_set\_time\_95": 0,
 "node\_get\_fsm\_set\_time\_99": 0,
 "node\_get\_fsm\_set\_time\_mean": 0,
 "node\_get\_fsm\_set\_time\_median": 0,
 "node\_get\_fsm\_siblings\_100": 0,
 "node\_get\_fsm\_siblings\_95": 0,
 "node\_get\_fsm\_siblings\_99": 0,
 "node\_get\_fsm\_siblings\_mean": 0,
 "node\_get\_fsm\_siblings\_median": 0,
 "node\_get\_fsm\_time\_100": 0,
 "node\_get\_fsm\_time\_95": 0,
 "node\_get\_fsm\_time\_99": 0,
 "node\_get\_fsm\_time\_mean": 0,
 "node\_get\_fsm\_time\_median": 0,
 "node\_gets": 0,
 "node\_gets\_counter": 0,
 "node\_gets\_counter\_total": 0,
 "node\_gets\_map": 0,
 "node\_gets\_map\_total": 0,
 "node\_gets\_set": 0,
 "node\_gets\_set\_total": 0,
 "node\_gets\_total": 500,
 "node\_put\_fsm\_active": 1,
 "node\_put\_fsm\_active\_60s": 27,
 "node\_put\_fsm\_counter\_time\_100": 0,
 "node\_put\_fsm\_counter\_time\_95": 0,
 "node\_put\_fsm\_counter\_time\_99": 0,
 "node\_put\_fsm\_counter\_time\_mean": 0,
 "node\_put\_fsm\_counter\_time\_median": 0,
 "node\_put\_fsm\_in\_rate": 0,
 "node\_put\_fsm\_map\_time\_100": 0,
 "node\_put\_fsm\_map\_time\_95": 0,
 "node\_put\_fsm\_map\_time\_99": 0,
 "node\_put\_fsm\_map\_time\_mean": 0,
 "node\_put\_fsm\_map\_time\_median": 0,
 "node\_put\_fsm\_out\_rate": 0,
 "node\_put\_fsm\_rejected": 0,
 "node\_put\_fsm\_rejected\_60s": 0,
 "node\_put\_fsm\_rejected\_total": 0,
 "node\_put\_fsm\_set\_time\_100": 0,
 "node\_put\_fsm\_set\_time\_95": 0,
 "node\_put\_fsm\_set\_time\_99": 0,
 "node\_put\_fsm\_set\_time\_mean": 0,
 "node\_put\_fsm\_set\_time\_median": 0,
 "node\_put\_fsm\_time\_100": 26949207,
 "node\_put\_fsm\_time\_95": 23320347,
 "node\_put\_fsm\_time\_99": 26949207,
 "node\_put\_fsm\_time\_mean": 6500451,
 "node\_put\_fsm\_time\_median": 960480,
 "node\_puts": 30,
 "node\_puts\_counter": 0,
 "node\_puts\_counter\_total": 0,
 "node\_puts\_map": 0,
 "node\_puts\_map\_total": 0,
 "node\_puts\_set": 0,
 "node\_puts\_set\_total": 0,
 "node\_puts\_total": 35224,
 "nodename": "riak@10.31.0.69",
 "object\_counter\_merge": 0,
 "object\_counter\_merge\_time\_100": 0,
 "object\_counter\_merge\_time\_95": 0,
 "object\_counter\_merge\_time\_99": 0,
 "object\_counter\_merge\_time\_mean": 0,
 "object\_counter\_merge\_time\_median": 0,
 "object\_counter\_merge\_total": 0,
 "object\_map\_merge": 0,
 "object\_map\_merge\_time\_100": 0,
 "object\_map\_merge\_time\_95": 0,
 "object\_map\_merge\_time\_99": 0,
 "object\_map\_merge\_time\_mean": 0,
 "object\_map\_merge\_time\_median": 0,
 "object\_map\_merge\_total": 0,
 "object\_merge": 0,
 "object\_merge\_time\_100": 0,
 "object\_merge\_time\_95": 0,
 "object\_merge\_time\_99": 0,
 "object\_merge\_time\_mean": 0,
 "object\_merge\_time\_median": 0,
 "object\_merge\_total": 9926,
 "object\_set\_merge": 0,
 "object\_set\_merge\_time\_100": 0,
 "object\_set\_merge\_time\_95": 0,
 "object\_set\_merge\_time\_99": 0,
 "object\_set\_merge\_time\_mean": 0,
 "object\_set\_merge\_time\_median": 0,
 "object\_set\_merge\_total": 0,
 "os\_mon\_version": "2.2.13",
 "pbc\_active": 0,
 "pbc\_connects": 0,
 "pbc\_connects\_total": 8,
 "pbkdf2\_version": "2.0.0-0-g7076584",
 "pipeline\_active": 0,
 "pipeline\_create\_count": 0,
 "pipeline\_create\_error\_count": 0,
 "pipeline\_create\_error\_one": 0,
 "pipeline\_create\_one": 0,
 "poolboy\_version": "0.8.1p3-0-g8bb45fb",
 "postcommit\_fail": 0,
 "precommit\_fail": 0,
 "protobuffs\_version": "0.8.1p5-0-gf88fc3c",
 "public\_key\_version": "0.20",
 "read\_repairs": 0,
 "read\_repairs\_counter": 0,
 "read\_repairs\_counter\_total": 0,
 "read\_repairs\_fallback\_notfound\_count": "undefined",
 "read\_repairs\_fallback\_notfound\_one": "undefined",
 "read\_repairs\_fallback\_outofdate\_count": "undefined",
 "read\_repairs\_fallback\_outofdate\_one": "undefined",
 "read\_repairs\_map": 0,
 "read\_repairs\_map\_total": 0,
 "read\_repairs\_primary\_notfound\_count": 146,
 "read\_repairs\_primary\_notfound\_one": 0,
 "read\_repairs\_primary\_outofdate\_count": 32,
 "read\_repairs\_primary\_outofdate\_one": 0,
 "read\_repairs\_set": 0,
 "read\_repairs\_set\_total": 0,
 "read\_repairs\_total": 123,
 "rebalance\_delay\_last": 0,
 "rebalance\_delay\_max": 0,
 "rebalance\_delay\_mean": 0,
 "rebalance\_delay\_min": 0,
 "rejected\_handoffs": 32,
 "riak\_api\_version": "2.1.1-2-g94a9485",
 "riak\_auth\_mods\_version": "2.0.1-0-g31b8b30",
 "riak\_control\_version": "2.1.1-0-g5898c40",
 "riak\_core\_version": "2.1.1-0-g429c22d",
 "riak\_dt\_version": "2.1.0-2-ga2986bc",
 "riak\_kv\_version": "2.1.0-0-g6e88b24",
 "riak\_kv\_vnodeq\_max": 0,
 "riak\_kv\_vnodeq\_mean": 0.0,
 "riak\_kv\_vnodeq\_median": 0,
 "riak\_kv\_vnodeq\_min": 0,
 "riak\_kv\_vnodeq\_total": 0,
 "riak\_kv\_vnodes\_running": 16,
 "riak\_pb\_version": "2.1.0.2-0-g620bc70",
 "riak\_pipe\_version": "2.1.0-2-gc2d7d28",
 "riak\_pipe\_vnodeq\_max": 0,
 "riak\_pipe\_vnodeq\_mean": 0.0,
 "riak\_pipe\_vnodeq\_median": 0,
 "riak\_pipe\_vnodeq\_min": 0,
 "riak\_pipe\_vnodeq\_total": 0,
 "riak\_pipe\_vnodes\_running": 16,
 "riak\_search\_version": "2.0.2-0-g8fe4a8c",
 "riak\_sysmon\_version": "2.0.0",
 "ring\_creation\_size": 64,
 "ring\_members": [
 "riak@10.31.0.65",
 "riak@10.31.0.66",
 "riak@10.31.0.67",
 "riak@10.31.0.68",
 "riak@10.31.0.69"
 ],
 "ring\_num\_partitions": 64,
 "ring\_ownership": "[{'riak@10.31.0.65',12},\n {'riak@10.31.0.66',12},\n 
{'riak@10.31.0.67',12},\n {'riak@10.31.0.68',12},\n {'riak@10.31.0.69',16}]",
 "rings\_reconciled": 0,
 "rings\_reconciled\_total": 96,
 "runtime\_tools\_version": "1.8.12",
 "sasl\_version": "2.3.3",
 "search\_index\_fail\_count": 0,
 "search\_index\_fail\_one": 0,
 "search\_index\_latency\_95": 20666433,
 "search\_index\_latency\_99": 24443579,
 "search\_index\_latency\_999": 26953345,
 "search\_index\_latency\_max": 26953345,
 "search\_index\_latency\_mean": 3000132,
 "search\_index\_latency\_median": 63194,
 "search\_index\_latency\_min": 797,
 "search\_index\_throughput\_count": 139189,
 "search\_index\_throughput\_one": 180,
 "search\_query\_fail\_count": 0,
 "search\_query\_fail\_one": 0,
 "search\_query\_latency\_95": 0,
 "search\_query\_latency\_99": 0,
 "search\_query\_latency\_999": 0,
 "search\_query\_latency\_max": 0,
 "search\_query\_latency\_mean": 0,
 "search\_query\_latency\_median": 0,
 "search\_query\_latency\_min": 0,
 "search\_query\_throughput\_count": 0,
 "search\_query\_throughput\_one": 0,
 "set\_actor\_counts\_100": 0,
 "set\_actor\_counts\_95": 0,
 "set\_actor\_counts\_99": 0,
 "set\_actor\_counts\_mean": 0,
 "set\_actor\_counts\_median": 0,
 "sidejob\_version": "2.0.0-0-gc5aabba",
 "skipped\_read\_repairs": 0,
 "skipped\_read\_repairs\_total": 0,
 "ssl\_version": "5.3.1",
 "stdlib\_version": "1.19.3",
 "storage\_backend": "riak\_kv\_multi\_backend",
 "syntax\_tools\_version": "1.6.11",
 "sys\_driver\_version": "2.2",
 "sys\_global\_heaps\_size": "deprecated",
 "sys\_heap\_type": "private",
 "sys\_logical\_processors": 8,
 "sys\_monitor\_count": 666,
 "sys\_otp\_release": "R16B02\_basho8",
 "sys\_port\_count": 170,
 "sys\_process\_count": 1347,
 "sys\_smp\_support": true,
 "sys\_system\_architecture": "x86\_64-unknown-linux-gnu",
 "sys\_system\_version": "Erlang R16B02\_basho8 (erts-5.10.3) [source] [64-bit] 
[smp:8:8] [async-threads:64] [kernel-poll:true] [frame-pointer]",
 "sys\_thread\_pool\_size": 64,
 "sys\_threads\_enabled": true,
 "sys\_wordsize": 8,
 "vnode\_counter\_update": 0,
 "vnode\_counter\_update\_time\_100": 0,
 "vnode\_counter\_update\_time\_95": 0,
 "vnode\_counter\_update\_time\_99": 0,
 "vnode\_counter\_update\_time\_mean": 0,
 "vnode\_counter\_update\_time\_median": 0,
 "vnode\_counter\_update\_total": 0,
 "vnode\_get\_fsm\_time\_100": 238,
 "vnode\_get\_fsm\_time\_95": 238,
 "vnode\_get\_fsm\_time\_99": 238,
 "vnode\_get\_fsm\_time\_mean": 220,
 "vnode\_get\_fsm\_time\_median": 216,
 "vnode\_gets": 3,
 "vnode\_gets\_total": 3710,
 "vnode\_index\_deletes": 0,
 "vnode\_index\_deletes\_postings": 0,
 "vnode\_index\_deletes\_postings\_total": 0,
 "vnode\_index\_deletes\_total": 0,
 "vnode\_index\_reads": 0,
 "vnode\_index\_reads\_total": 0,
 "vnode\_index\_refreshes": 0,
 "vnode\_index\_refreshes\_total": 0,
 "vnode\_index\_writes": 180,
 "vnode\_index\_writes\_postings": 180,
 "vnode\_index\_writes\_postings\_total": 120120,
 "vnode\_index\_writes\_total": 139258,
 "vnode\_map\_update": 0,
 "vnode\_map\_update\_time\_100": 0,
 "vnode\_map\_update\_time\_95": 0,
 "vnode\_map\_update\_time\_99": 0,
 "vnode\_map\_update\_time\_mean": 0,
 "vnode\_map\_update\_time\_median": 0,
 "vnode\_map\_update\_total": 0,
 "vnode\_put\_fsm\_time\_100": 26953961,
 "vnode\_put\_fsm\_time\_95": 20667408,
 "vnode\_put\_fsm\_time\_99": 24444125,
 "vnode\_put\_fsm\_time\_mean": 3016580,
 "vnode\_put\_fsm\_time\_median": 63517,
 "vnode\_puts": 180,
 "vnode\_puts\_total": 139403,
 "vnode\_set\_update": 0,
 "vnode\_set\_update\_time\_100": 0,
 "vnode\_set\_update\_time\_95": 0,
 "vnode\_set\_update\_time\_99": 0,
 "vnode\_set\_update\_time\_mean": 0,
 "vnode\_set\_update\_time\_median": 0,
 "vnode\_set\_update\_total": 0,
 "webmachine\_version": "1.10.8-0-g7677c24",
 "write\_once\_merge": 0,
 "write\_once\_put\_objsize\_100": 0,
 "write\_once\_put\_objsize\_95": 0,
 "write\_once\_put\_objsize\_99": 0,
 "write\_once\_put\_objsize\_mean": 0,
 "write\_once\_put\_objsize\_median": 0,
 "write\_once\_put\_time\_100": 0,
 "write\_once\_put\_time\_95": 0,
 "write\_once\_put\_time\_99": 0,
 "write\_once\_put\_time\_mean": 0,
 "write\_once\_put\_time\_median": 0,
 "write\_once\_puts": 0,
 "write\_once\_puts\_total": 0,
 "xmerl\_version": "1.3.4",
 "yokozuna\_version": "2.1.0-0-gcb41c27"
}


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

