---
title: "Riak claim & wants funs."
description: ""
project: community
lastmod: 2014-01-28T09:25:47-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13517"
author_name: "Guido Medina"
project_section: "mailinglistitem"
sent_date: 2014-01-28T09:25:47-08:00

---



Hi,

I'm trying to get different distributions on the ring and I used before 
the following Erlang code, which for Riak 1.4.7 is not re-triggering a 
re-calculation:


 \* What is the latest algorithm version? v3? And is there a list of the
 last 2 or 3 versions? Sometimes depending on the keys one algorithm
 can fit better than the other (From what I have learned)

 \*Changes algorithm:\*

 rpc:multicall(application, set\_env, [riak\_core, wants\_claim\_fun,
 {riak\_core\_claim, wants\_claim\_v3}]).
 rpc:multicall(application, set\_env, [riak\_core, choose\_claim\_fun,
 {riak\_core\_claim, choose\_claim\_v3}]).

 \* Not working in Riak 1.4.7, any Riak/Erlang expert know why?

 \*Triggers a recalculation:\*

 fun() ->
 Node = node(),
 riak\_core\_ring\_manager:ring\_trans(
 fun(Ring, []) ->
 case riak\_core\_ring:claimant(Ring) of
 Node ->
 %% Set next to []
 NewRing1 = setelement(7, Ring, []),
 %% Increment ring version
 RVsn1 = element(11, NewRing1),
 RVsn2 = vclock:increment(Node, RVsn1),
 NewRing2 = setelement(11, NewRing1, RVsn2),
 {new\_ring, NewRing2};
 \_ ->
 io:format("Failed. This node is not the
 claimant~n"),
 ignore
 end
 end, []),
 ok
 end().


Regards,

Guido.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

