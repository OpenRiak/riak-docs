---
title: "Brokenness specific to nginx and jets3t with Riak CS"
description: ""
project: community
lastmod: 2014-09-24T23:00:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14917"
author_name: "Toby Corkindale"
project_section: "mailinglistitem"
sent_date: 2014-09-24T23:00:05-07:00

---


Hi,
I've hit an issue that only seems to occur when using the Jets3t
client library and Nginx as a load balancer in front of Riak CS.
The issue is NOT present when using other S3 libraries, nor is it
present if I switch out Nginx for haproxy.

Unfortunately, in this instance it is desirable to use both, unless it
turns out to be \*really\* troublesome.
I wondered if anyone here can offer advice?

The problem is that reads and writes to objects results in Riak CS,
apparently, disconnecting the client prematurely.
Nginx reports "connection reset by peer" and retries upstream Riak CS
servers several times before giving up.
The Riak CS access logs indicate what look like valid URLs, with a 403
status indicated.


Accessing the same buckets with the same auth and transferring the
same files is fine when done with s3cmd, and we have other apps that
have been running through nginx for a while using other S3 client
libraries.

A simple "check if bucket exists" command through jets3t seems to work OK.

Any thoughts on what could be going on, or is this all just a bit too vague?

Toby

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

