---
title: "Very slow acquisition time (99 percentile) while fast median times"
description: ""
project: community
lastmod: 2016-05-02T04:48:25-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17267"
author_name: "Guillaume Boddaert"
project_section: "mailinglistitem"
sent_date: 2016-05-02T04:48:25-07:00

---



Hi,

I'm trying to setup a production environment with Riak as backend. 
Unfortunately I have very slow write times that bottleneck my whole system.


Here is a sample of one of my node (riak-admin status | grep -e 
'^node\_put\_fsm\_time'):

node\_put\_fsm\_time\_100 : 3305516
node\_put\_fsm\_time\_95 : 230589
node\_put\_fsm\_time\_99 : 1694593
node\_put\_fsm\_time\_mean : 79864
node\_put\_fsm\_time\_median : 14973

As you can see, I have really good times for most of my writes, yet the 
mean time is not so good because a few writes are taking long (Up to 3 
seconds)

How can I get rid of those slow insert ? Is that intended/normal ?

My setup is the following:
5 hosts (2CPU, %Cpu(s): 47,1 us, 1,3 sy, 0,0 ni, 51,3 id, 0,0 wa, 
0,0 hi, 0,2 si, 0,0 st) , ring\_size: 128, aae disabled.

Writes are w=1 dw=0
each host has 32go of ram, that is almost used for system caching only.
My data are stored on an openstack volume that support up to 3000IOPS.

Here is an iostat sample for 1 minute:
avg-cpu: %user %nice %system %iowait %steal %idle
 38.00 0.00 1.81 0.03 0.08 60.07

Device: tps kB\_read/s kB\_wrtn/s kB\_read kB\_wrtn
vda 0.37 0.00 2.27 0 136
vdb 9.60 0.00 294.53 0 17672

Thanks,

Guilaume BODDAERT

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

