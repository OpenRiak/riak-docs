---
title: "Getting multiple values: is iterating or MapReduce preferred?"
description: ""
project: community
lastmod: 2013-03-25T15:09:19-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10590"
author_name: "Rob Speer"
project_section: "mailinglistitem"
sent_date: 2013-03-25T15:09:19-07:00

---


I've looked at the archives of this mailing list to find a way to implement
a "multi-get" using Riak, for the very common case where there are multiple
keys to look up. Making a separate round-trip to the server for each key
seems inefficient, after all.

I came across the suggestion to use MapReduce, so I tried implementing it
this way (using riak-python-client):

 def multi\_get(self, bucket\_name, ids):
 if len(ids) == 0:
 return []
 mr = RiakMapReduce(self.riak)
 for uid in ids:
 mr.add(bucket\_name, uid)
 query = mr.map\_values\_json()
 return query.run()

After this I noticed significant load on the Riak servers, and the client
code would sometimes stall for a long time, even on a multi\_get that was
only returning 6 documents. Is this actually an inappropriate use of
MapReduce? (And are there appropriate uses of MapReduce in NoSQL databases
besides stress-testing them?)

Is it better to make a separate request for each ID, to use MapReduce, or
to use some other method I haven't thought of?
-- Rob
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

