---
title: "Re: Can't delete objects being on an indexed bucket_type"
description: ""
project: community
lastmod: 2014-11-16T11:03:12-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15180"
mailinglist_parent_id: "msg15177"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2014-11-16T11:03:12-08:00
---


Hi Alex,

That's a bug in the Python client. There's an existing issue on the repo
for it: https://github.com/basho/riak-python-client/issues/365

In the meantime, here's a workaround:

from riak.riak\_object import RiakObject

RiakObject(bucket, 'testkey').delete()

Sorry for the inconvenience.

On Sat, Nov 15, 2014 at 5:54 PM, Alex De la rosa 
wrote:

> Hi there,
>
> I created an index and a MAP bucket-type in the following way:
>
> curl -XPUT "http://x.x.x.x:8098/search/index/ix\_users"
> riak-admin bucket-type create tp\_users '{"props":
> {"allow\_mult":true,"search\_index":"ix\_users","datatype":"map"}}'
> riak-admin bucket-type activate tp\_users
>
> Then I saved some data and is working fine; but when I try to delete a
> key, I get a nasty error; what am I doing wrong?:
>
> import riak
>
> client = riak.RiakClient(protocol = 'pbc', nodes = [{'host': 'x.x.x.x',
> 'http\_port': 8098, 'pb\_port': 8087}])
> bucket = client.bucket\_type('tp\_users').bucket('users')
> bucket.delete('testkey')
>
> Output of the script:
>
> Traceback (most recent call last):
> File "x.py", line 6, in 
> bucket.delete('testkey')
> File "/usr/local/lib/python2.7/dist-packages/riak/bucket.py", line 539,
> in delete
> return self.new(key).delete(\*\*kwargs)
> AttributeError: 'Map' object has no attribute 'delete'
>
> This are my riak and python client versions:
>
> ~ # pip show riak
> ---
> Name: riak
> Version: 2.1.0
> Location: /usr/local/lib/python2.7/dist-packages
> Requires: riak-pb, pyOpenSSL
>
> ~ # riak version
> 2.0.2
>
> Thanks,
> Alex
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>


-- 
Sean Cribbs 
Sr. Software Engineer
Basho Technologies, Inc.
http://basho.com/
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

