---
title: "load balance problem among riakc_pb_socket processes when get objects?"
description: ""
project: community
lastmod: 2013-07-06T23:03:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11406"
author_name: "Wu Ray"
project_section: "mailinglistitem"
sent_date: 2013-07-06T23:03:14-07:00

---


Hi, guys,

It looks like there is a load balance problem when client app try to
parallel get objects(each object size is about 2MB) using multi-
riakc\_pb\_socket processes. some process work fine, which get object in two
hundred ms at most, but some processes always timeout(get\_timeout=60000ms).

It behave like only few riakc\_pb\_socket process can get objects well. if
there are 2 or more, things go bad.

I used riakpool to pool the riakc\_pb\_socket process, check-out one
riakc\_pb\_socket, get-object, check-in. I also used riakc\_pb\_socket:start/2
directly. There's no difference.

I adjust riak\_api config: set pb\_backlog=64, nothing changed.
I also tried some old riak-erlang-client version, such as 1.3.0, nothing
changed.

my riak is official riak-1.3.2\_amd64.deb for ubuntu 12.04 server,
riak-erlang-client is 1.4.0.x
there's 5 riak-nodes in 5 physical intel-atom PC, client app is located
with riak-node, which means client app only connect to local riak-node.

By comparison, put operation has no this problem. I'm a little annoyed
about this problem. Did I do something wrong, is there something i can do
to improve the parallel get operation?

Best regards.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

