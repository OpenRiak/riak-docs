---
title: "Re: Riak on VM's"
description: ""
project: community
lastmod: 2014-04-03T00:29:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13981"
mailinglist_parent_id: "msg13831"
author_name: "Seth Thomas"
project_section: "mailinglistitem"
sent_date: 2014-04-03T00:29:31-07:00
---


John,

Forgive the late reply but I do have something of a strong point of view on
this one.

For the case you've proposed it seems like Riak in EC2 is a great fit but
you are rightly concerned about the IO costs, especially in EC2. For me
it's about achieving predictable performance as high into your 95th and
99th percentiles as possible. With EC2 the best thing you can do with
regard to controlling IO latency is paying for the Provisioned IOPS. If
you're getting acceptable speeds without that is awesome but for my money
I'd pay for the IOPS sooner than I'd pay for other machine attributes. I
see you've got a ring size of 256 partitions - are you planning to grow the
cluster (adding more nodes) in the future? I ask because that is, very
generally, a high ratio of partitions to physical nodes so reducing the #
of partitions or adding more nodes to the existing configuration could also
help alleviate any performance issues, especially in the case of one node
failures. We've got plenty of large customers running very happily in EC2
so you're certainly not alone there. We've got some recommendations on our
docs site specifically for AWS[1] that covers some of the nuance in more
detail but feel free to poke more on specifics and I'll see what I can dig
up.

As you said, no hard and fast answers here but that is how I feel.

Cheers,
Seth Thomas

[1] http://docs.basho.com/riak/latest/ops/tuning/aws/


On Tue, Mar 18, 2014 at 5:04 AM, John Kavanagh  wrote:

> Hi Basho people,
>
> I need to get some info about user Riak on VM's .
>
> We intend to use Riak as the backed for a user session store . We have
> tested on EC2 and determined the following :
>
> Using a cluster of 5 x EC2's m1.xlarge instances. (4 cores, 15GB memory).
> w /256 partitions w/ Bitcask :
>
> At 100K RPM. CPU utilization is at 200%.
> At 300K RPM, 300%. median time is still acceptable, but we see some
> requeststaking 20ms.
>
> Since it's a small dataset, and responsiveness is important here, I think
> we
> should keep our entire working set in memory. 4GB per node allows us to do
> that for up to 10 million keys. In reality , in production , we would peak
> at 1 million keys.
>
> Our tests on VM's (EC2) have been quite successful . However I'm
> concerned about the IO cost of using VM's in production .
>
> "Riak is already virtualized, so let it handle that instead of running it
> on yet another virtualisation"
>
> I know there are no hard and fast answers here , but I'm wondering if
> anyone had any strong points of view.
>
> Thanks,
>
> John
>
>
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

