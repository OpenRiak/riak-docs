---
title: "Re: Any optimizations related to small and bit clock?"
description: ""
project: community
lastmod: 2011-10-03T08:38:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04992"
mailinglist_parent_id: "msg04990"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2011-10-03T08:38:45-07:00
---


Sounds great. If you are performing a rolling upgrade make sure to
modify/add vnode\_vclocks after all nodes have transitioned to 1.0 [1].

[1]: http://wiki.basho.com/Rolling-Upgrades.html

On Mon, Oct 3, 2011 at 11:22 AM, Gordon Tillman  wrote:

> Morning Ryan,
>
> Hey thanks for the info. I'm testing with 1.0 right now (great job with
> that by the way) and I hope to be able to switch our deployment package over
> to 1.0 soon.
>
> As always I appreciate your time and trouble.
>
> --gordon
>
>
> On Oct 3, 2011, at 10:02 , Ryan Zezeski wrote:
>
> Gordon,
>
> It's worth pointing out that in 1.0 this should be greatly improved because
> now we have changed vclock behavior in relation to PUTs [1]. Essentially,
> client id now comes from the vnode, not externally, which leads to
> smaller/static vclock sizes even in the face of frequent updates.
>
> I can't say with complete certainty that reducing the small/big vclock
> won't change your perf characteristics but I will say it is probably better
> to have smaller vclocks which in turn leads to smaller objects. Since
> pruning will happen more often I would imagine your PUT latencies could
> potentially go up a little. The best way to know is to measure.
>
> Another option is setting last\_write\_wins to true but this should only be
> used as a last effort and only if you truly don't care about siblings [2].
>
> -Ryan
>
> [1]: Checkout the section titled "Get/Put Improvements" in the release
> notes. https://github.com/basho/riak/blob/riak-1.0.0/RELEASE-NOTES.org
>
> [2]: http://wiki.basho.com/Vector-Clocks.html#Siblings
>
> On Fri, Sep 2, 2011 at 11:33 AM, Gordon Tillman wrote:
>
>> Morning All,
>>
>> I have noticed that with the default vclock settings the size of the
>> X-Riak-Vclock header gets really big really fast for certain objects that
>> are updated frequently. I am considering setting small\_vclock to 4 and
>> big\_vclock to 16 instead of the default values of 10 and 50, respectivly.
>>
>> I know that that are various performance optimizations that are based upon
>> certain default bucket settings and was wondering if this change would
>> adversely affect any of those.
>>
>> Many thanks!
>>
>> --gordon tillman
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

