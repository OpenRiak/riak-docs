---
title: "Re: documentation for allow_mult=false"
description: ""
project: community
lastmod: 2011-11-02T08:18:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05420"
mailinglist_parent_id: "msg05415"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2011-11-02T08:18:56-07:00
---


On Tue, Nov 1, 2011 at 5:51 PM, Justin Karneges  wrote:

> Are you saying that allow\_mult=false + last\_write\_win=false is the same as
> allow\_mult=false + last\_write\_win=true ?
>
> False/false may be the default behavior, but I want to know what that
> behavior
> is. :)
>
>
Justin,

No, last\_write\_wins=true doesn't care about the value of allow\_mult. Only
one should be true at the same time, and the default is to have both set to
false. Perhaps making an imaginary setting to displace these two would
help. Lets call this imaginary setting "conflict\_resolution\_method" which
can take on the three mutually exclusive values "stomp", "most\_recent" and
"siblings".

stomp - overwrite the current value with the new value regardless of vector
clocks, just mutate the value with no regard, thus "stomp"

most\_recent - use vclocks to monitor for conflicts, create siblings, and
pick the most recent write when a conflict does occur (i.e. let Riak handle
the conflict for you based on time)

siblings - use vclocks to monitor for conflicts, create siblings, and
return the siblings to the client when a conflict occurs for it to be
resolved by some application dependent logic

Now lets map my imaginary field to the actual fields

stomp = last\_write\_wins=true + allow\_mult=false

most\_recent = last\_write\_wins=false + allow\_mult=false

siblings = last\_write\_wins=false + allow\_mult=true

Notice that setting both to true has undefined semantics as they
are necessarily mutually exclusive.

Also notice that stomp and most\_recent might seem like the same thing on
the surface but they may have different outcomes in different situations.
 For example, stomp would prove to be non-deterministic during the healing
of a split-brain because it will depend on the order of the hinted handoff
transfers. Honestly, you're best avoiding last\_write\_wins at this point
because it can cause non-obvious behavior and there is potential it may be
removed in the future.

HTH,
-Ryan
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

