---
title: "MR Timeout"
description: ""
project: community
lastmod: 2012-08-03T07:50:59-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08175"
author_name: "Yousuf Fauzan"
project_section: "mailinglistitem"
sent_date: 2012-08-03T07:50:59-07:00

---


Hello,

My Riak setup is like following:
1. Riak 1.1.4
2. Ubuntu 12.04
3. 3 nodes (EC2 large instance)

I am using secondary index for input. The size of input is around 15k
records

The query fails with the following error
<<"{\"phase\":1,\"error\":\"{{{badmatch,[]},[{riak\_kv\_js\_manager,needs\_reload,2},{riak\_kv\_js\_manager,handle\_call,3},{gen\_server,handle\_msg,5},{proc\_lib,init\_p\_do\_apply,3}]},{gen\_server,call,[riak\_kv\_js\_map,{reserve\_vm,<0.9908.0>},infinity]}}\",\"input\":\"{ok,{r\_object,<<\\\"username\\\">>,<<\\\"4SH57586280\\\">>,[{r\_content,{dict,4,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[[<<\\\"Links\\\">>,{{<<\\\"contacts|20120723\\\">>,<<\\\"user5|user1|Contacted|20120724001854\\\">>},<<\\\"contacts|20120723\\\">>},{{<<\\\"contacts|20120723\\\">>,<<\\\"user8|user2|Contacted|20120724003218\\\">>},<<\\\"contacts|20120723\\\">>},{{<<\\\"contacts|20120729\\\">>,<<\\\"user10|user3|Declined|20120729093511\\\">>},<<\\\"contacts|20120729\\\">>},{{<<\\\"contact...\\\">>,...},...},...]],...}}},...}],...},...}\",\"type\":\"exit\",\"stack\":\"[{gen\_server,call,3},{riak\_kv\_js\_manager,blocking\_dispatch,4},{riak\_kv\_mrc\_map,map\_js,3},{riak\_kv\_mrc\_map,process,3},{riak\_pipe\_vnode\_worker,process\_input,3},{riak\_pipe\_vnode\_worker,wait\_for\_input,2},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]\"}">>

However, if I re-run the query a couple of times, it eventually succeeds.

Some of the parameters of app.config that I changed:
 {map\_js\_vm\_count, 128 },
 {reduce\_js\_vm\_count, 32 },

 {js\_max\_vm\_mem, 16},

Also, MR is quite slow. Is there a way to speed things up?

Please help.

--
Yousuf Fauzan
http://fauzism.com
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

