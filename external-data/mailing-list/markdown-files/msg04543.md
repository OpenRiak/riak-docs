---
title: "Re: object not stored"
description: ""
project: community
lastmod: 2011-08-31T10:30:06-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04543"
mailinglist_parent_id: "msg04542"
author_name: "Jonathan Langevin"
project_section: "mailinglistitem"
sent_date: 2011-08-31T10:30:06-07:00
---


To avoid inconsistencies with your specific set up, I would change n\_val to
1, set r/w/dw to 1, which is what we actually have for our dev instance.
I don't know what issues this could cause specifically with any test data
that you've already stored, so my initial thought would be to
remove/reinstall Riak, apply new configuration, start service. Otherwise you
may be able to simply drop/delete whatever you've already stored currently,
change Riak config, restart service, and not have issues. I haven't
experimented in that area to find out.

Again, keep in mind, growing that instance to a proper cluster has it's own
issues (if you attempt to grow while retaining existing data). Also the
caveat exists that your development would not consider possible data
conflicts that you would experience in a proper cluster environment, so keep
that in mind. If you continue with a single instance, you should plan for a
second phase of development where you create a 3+ node cluster, so that you
can test object conflicts, and see other possible issues that would arise in
a cluster that you wouldn't see on your single node.
\*

 
 Jonathan Langevin
Systems Administrator
Loom Inc.
Wilmington, NC: (910) 241-0433 - jlange...@loomlearning.com -
www.loomlearning.com - Skype: intel352
\*


On Wed, Aug 31, 2011 at 12:30 PM, Giancarlo Frison wrote:

> Previously I caught not found in HTTP interface and in PB client as well.
>
> Now I set w/dw to 2 (leaving n\_val=3 as default) and I didn't see the
> problem again, but a delay from the store and a successful fetch (after a 1
> sec).
> If I fetch the obj immediately after the store I caught not found again
> (sometimes).
>
> How can I find it soon after the store?
>
> But I think it's better to set n\_val =1 with a this development-1node
> setup, isn't it?
>
>
> Giancarlo Frison
>
>
>
> On Wed, Aug 31, 2011 at 5:45 PM, Mark Steele wrote:
>
>> I would think that one of the following would work:
>>
>> Make your n\_val = 1 on the bucket and set or R/W/DW = 1 on
>> reads/writes/deletes
>>
>> OR
>>
>> Leave the n\_val at 3 (the default), make the R/W/DW = 2 (quorum) on
>> reads/writes/deletes.
>>
>>
>>
>> On Wed, Aug 31, 2011 at 11:36 AM, Giancarlo Frison wrote:
>>
>>> This is the bucket conf:
>>>
>>> gfrison@gfw:~$ curl http://localhost:8098/riak/user
>>>
>>> {"props":{"name":"user","n\_val":3,"allow\_mult":false,"last\_write\_wins":false,"precommit":[],"postcommit":[],"chash\_keyfun":{"mod":"riak\_core\_util","fun":"chash\_std\_keyfun"},"linkfun":{"mod":"riak\_kv\_wm\_link\_walker","fun":"mapreduce\_linkfun"},"old\_vclock":86400,"young\_vclock":20,"big\_vclock":50,"small\_vclock":10,"r":"quorum","w":"quorum","dw":"quorum","rw":"quorum"}}
>>>
>>> the server is single instance, the configuration is the default, no
>>> changes.
>>>
>>> I store the object as:
>>>
>>> rc.store(ob, new StoreMeta(1, 1, true))
>>> w=1,dw=1,returnbody=true
>>>
>>>
>>> Can you help me?
>>>
>>> Giancarlo Frison
>>>
>>>
>>>
>>> On Wed, Aug 31, 2011 at 4:01 PM, Jonathan Langevin <
>>> jlange...@loomlearning.com> wrote:
>>>
>>>> That could occur, depending on how many nodes are in your cluster, what
>>>> your r/w/dw settings are set to when fetching the object, how soon after
>>>> storing you attempt to fetch.
>>>> What is your configuration? i.e. - how many nodes in your cluster, what
>>>> settings are you using for reading & writing to Riak (r/w/dw, etc), what 
>>>> are
>>>> your bucket settings set to?
>>>>
>>>> I'm not advanced enough to help, but that info should hopefully help the
>>>> others on the list ;-)
>>>> \*
>>>>
>>>> 
>>>> Jonathan Langevin
>>>> Systems Administrator
>>>> Loom Inc.
>>>> Wilmington, NC: (910) 241-0433 - jlange...@loomlearning.com -
>>>> www.loomlearning.com - Skype: intel352
>>>> \*
>>>>
>>>>
>>>> On Wed, Aug 31, 2011 at 9:29 AM, Giancarlo Frison 
>>>> wrote:
>>>>
>>>>> Hi all,
>>>>>
>>>>> Sometimes happen that storing object with PB client doesn't work, the
>>>>> snippet is:
>>>>>
>>>>> IRiakObject ob =
>>>>> RiakObjectBuilder.newBuilder(bucket,key).withContentType("application/json").withValue(json).build();
>>>>> return rc.store(ob, new StoreMeta(1, 1,
>>>>> true)).getVclock().getBytes();
>>>>>
>>>>> below it is the snoop of storing action. As you can see the riak server
>>>>> is invoked by the client and return the object:
>>>>>
>>>>> T 127.0.0.1:52015 -> 127.0.0.1:8087 [AP]
>>>>> .....
>>>>> .user..gfrison"..
>>>>>
>>>>> G{"name":"Giancarlo","id":"gfrison","password":"pwd","surname":"frison"}..application/json;charset=utf-82"
>>>>> .eclass-general\_domain..User..iof(.0.8.
>>>>> ##
>>>>> T 127.0.0.1:8087 -> 127.0.0.1:52015 [AP]
>>>>> .....
>>>>> ..
>>>>>
>>>>> G{"name":"Giancarlo","id":"gfrison","password":"pwd","surname":"frison"}..application/json;charset=utf-8\*.4fXUimzXj3g0ukJHcpuxm32"
>>>>> .eclass-general\_domain..User..iof8.....@
>>>>> ..).\*k.a```.`..R,..E..L..y....W..A....L.
>>>>> ?..g..
>>>>>
>>>>>
>>>>> but when I try to get such object, I got not found:
>>>>>
>>>>> gfrison@ttw:~$ curl http://localhost:8098/riak/user/gfrison
>>>>> not found
>>>>>
>>>>> Have you any hint on it?
>>>>>
>>>>> thanks!
>>>>>
>>>>>
>>>>>
>>>>> Giancarlo Frison
>>>>> @gfrison
>>>>>
>>>>>
>>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>>>> riak-users mailing list
>>>>> riak-users@lists.basho.com
>>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>>>
>>>>>
>>>>
>>>
>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>> riak-users mailing list
>>> riak-users@lists.basho.com
>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>
>>>
>>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

