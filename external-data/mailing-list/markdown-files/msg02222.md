---
title: "Re: Ripple one Association Troubles"
description: ""
project: community
lastmod: 2011-02-08T10:48:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02222"
mailinglist_parent_id: "msg02221"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-02-08T10:48:11-08:00
---


Stephen,

Was your User object saved before you added it the journal entry?

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Feb 8, 2011, at 1:46 PM, Stephen Allred wrote:

> Sean,
> 
> $ puts journal\_entry.robject.links.inspect
> #; riaktag="user", 
> ; riaktag="up"}>
> => nil 
> 
> $ journal\_entry
> =>  created\_at=2011-02-07 22:47:17 UTC updated\_at=2011-02-08 18:08:47 UTC>
> 
> $ journal\_entry.user
> (Object doesn't support #inspect)
> =>
> 
> $ journal\_entry.user.inspect
> NoMethodError: undefined method `key' for nil:NilClass
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/activesupport-3.0.3/lib/active\_support/whiny\_nil.rb:48:in
> `method\_missing'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:122:in
> `block in instantiate'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
> `tap'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
> `instantiate'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/one\_linked\_proxy.rb:25:in
> `find\_target'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:113:in
> `load\_target'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:41:in
> `inspect'
> from (irb):17
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:44:in
> `start'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:8:in
> `start'
> from 
> /Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands.rb:23:in
> `'
> from script/rails:6:in `require'
> from script/rails:6:in `'
> 
> Hopefully those are useful,
> Thanks for the quick response!
> Steve
> 
> On 8 Feb 2011, at 6:37 PM, Sean Cribbs wrote:
> 
>> Stephen,
>> 
>> Sounds like you've either found a bug. When you have saved the journal 
>> entry in irb, what is the output of this command?
>> 
>> puts journal\_entry.robject.links.inspect
>> 
>> Sean Cribbs 
>> Developer Advocate
>> Basho Technologies, Inc.
>> http://basho.com/
>> 
>> On Feb 8, 2011, at 1:23 PM, Stephen Allred wrote:
>> 
>>> Hi all,
>>> 
>>> I'm having trouble setting up a one association in a ripple document. I'm 
>>> trying to setup an association between a user and a journal entry, such 
>>> that the journal has one user, that the user created.
>>> 
>>> My JournalEntry document:
>>> 
>>> --- journal\_entry.rb ---
>>> require 'ripple'
>>> 
>>> class JournalEntry
>>> include Ripple::Document
>>> 
>>> property :short\_title, String, :presence => true
>>> property :title, String, :presence => true
>>> property :entry, String, :presence => true
>>> 
>>> timestamps!
>>> 
>>> one :user
>>> 
>>> key\_on :short\_title
>>> end
>>> ---
>>> 
>>> My User document:
>>> 
>>> --- user.rb ---
>>> require 'ripple'
>>> require 'digest'
>>> 
>>> class User
>>> include Ripple::Document
>>> 
>>> devise :registerable, :confirmable, :database\_authenticatable, 
>>> :recoverable, :validatable
>>> 
>>> property :email, String, :presence => true
>>> property :password, String
>>> property :password\_confirmation, String
>>> timestamps!
>>> 
>>> key\_on :email
>>> 
>>> def key
>>> email
>>> end
>>> 
>>> def id
>>> email
>>> end
>>> end
>>> ---
>>> 
>>> I've tried in the rails console to associate a user with journal\_entry 
>>> (journal\_entry.user = user), save it and reload it. The resulting reloaded 
>>> journal\_entry does not have a user (calling journal\_entry.user prints 
>>> "(Object doesn't support #inspect)").
>>> 
>>> My journal entry in riak loaded via the browser looks like:
>>> 
>>> {"short\_title":"test","title":"test","entry":"test","created\_at":"Mon, 07 
>>> Feb 2011 22:47:17 -0000","updated\_at":"Tue, 08 Feb 2011 18:08:47 
>>> -0000","\_type":"JournalEntry"}
>>> 
>>> Does anyone know what I'm doing wrong?
>>> Cheers!
>>> Steve
>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>> riak-users mailing list
>>> riak-users@lists.basho.com
>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>> 
> 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

