---
title: "Problem with keys filter in erlang pb client"
description: ""
project: community
lastmod: 2011-07-24T13:27:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04050"
author_name: "Dimitry D"
project_section: "mailinglistitem"
sent_date: 2011-07-24T13:27:16-07:00

---


Hello.

I totally lost my mind with this, but I have to finish it.

I have simple app: it extracts data from txt file (data like "timestamp
 value"), push it to Riak and make some range queries.
The problem is when I make key filter query I get \*{error,disconnected}\*.
I strore data in riak in this way: key – timestamp (like 0.43), value –
value (like 1.14), bucket – time of adding data (like
"2011-07-24-23-39-45").
Here's the code of request:

(dca\_db.erl)

handle\_call({range\_query, Bucket, From, To}, \_, #state{db\_pid = Pid} = State)
->

Query = [{map, %query type

 {modfun, riak\_kv\_mapreduce, map\_object\_value}, %function from riak erlang
built-in module

 none, true}],

Inputs = {Bucket, [["between", 0, 1]]},

Result = riakc\_pb\_socket:mapred(Pid, Inputs, Query),

{reply, Result, State};



(test/dca\_db\_tests.erl)

 range\_request(Pid) ->

Bucket = <<"2011-07-24-23-39-45">>,

Result = gen\_server:call(Pid, {range\_query, Bucket, 0, 1}),

error\_logger:info\_msg("RESULT:~p~n",[Result]).



You can find my code in github –
https://github.com/DimitryDushkin/distributed\_calc\_riak\_matlab


Thank you.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

