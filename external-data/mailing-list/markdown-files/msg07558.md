---
title: "Upgrade from 0.14 to 1.1 riak problems!"
description: ""
project: community
lastmod: 2012-05-29T06:38:00-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07558"
author_name: "Denis Barishev"
project_section: "mailinglistitem"
sent_date: 2012-05-29T06:38:00-07:00

---



Hello everybody!

Maybe some of you has faced my problem before. I would be glad to 
receive any ideas.

I'm trying to perform a rolling upgrade of nodes one by one.

I'm stopping one node and update configuration file to meet 
compatibility with riak 0.14. Namely I set

the following options in riak\_kv section:

 {legacy\_keylisting, true},
 {mapred\_system, legacy},
 {vnode\_vclocks, false},

Then I install riak 1.1 and start it. But with no success as I 
understood the newly updated node can't bring up its vnodes...

The error log tells me the following:

11:20:36.096 [error] Supervisor riak\_kv\_sup had child 
riak\_kv\_vnode\_master started with 
riak\_core\_vnode\_master:start\_link(riak\_kv\_vnode, riak\_kv\_legacy\_vnode, 
riak\_kv) at <0.491.0> exit with reason bad argument in call to 
ets:lookup(riak\_core\_node\_watcher, {by\_node,'riak@192.168.154.50'}) in 
riak\_core\_node\_watcher:internal\_get\_services/1 in context child\_terminated
11:20:36.104 [error] gen\_server riak\_kv\_vnode\_master terminated with 
reason: bad argument in call to ets:lookup(riak\_core\_node\_watcher, 
{by\_node,'riak@192.168.154.50'}) in 
riak\_core\_node\_watcher:internal\_get\_services/1



11:20:36.132 [error] CRASH REPORT Process riak\_kv\_vnode\_master with 0 
neighbours crashed with reason: bad argument in call to 
ets:lookup(riak\_core\_node\_watcher, {by\_node,'riak@192.168.154.50'}) in 
riak\_core\_node\_watcher:internal\_get\_services/1
11:20:36.132 [error] Supervisor riak\_kv\_sup had child 
riak\_kv\_vnode\_master started with 
riak\_core\_vnode\_master:start\_link(riak\_kv\_vnode, riak\_kv\_legacy\_vnode, 
riak\_kv) at <0.1474.0> exit with reason bad argument in call to 
ets:lookup(riak\_core\_node\_watcher, {by\_node,'riak@192.168.154.50'}) in 
riak\_core\_node\_watcher:internal\_get\_services/1 in context child\_terminated
11:20:36.133 [error] gen\_server riak\_kv\_vnode\_master terminated with 
reason: bad argument in call to ets:lookup(riak\_core\_node\_watcher, 
{by\_node,'riak@192.168.154.50'}) in 
riak\_core\_node\_watcher:internal\_get\_services/1
11:20:36.134 [error] CRASH REPORT Process riak\_kv\_vnode\_master with 0 
neighbours crashed with reason: bad argument in call to 
ets:lookup(riak\_core\_node\_watcher, {by\_node,'riak@192.168.154.50'}) in 
riak\_core\_node\_watcher:internal\_get\_services/1
11:20:36.134 [error] Supervisor riak\_kv\_sup had child 
riak\_kv\_vnode\_master started with 
riak\_core\_vnode\_master:start\_link(riak\_kv\_vnode, riak\_kv\_legacy\_vnode, 
riak\_kv) at <0.1475.0> exit with reason bad argument in call to 
ets:lookup(riak\_core\_node\_watcher, {by\_node,'riak@192.168.154.50'}) in 
riak\_core\_node\_watcher:internal\_get\_services/1 in context child\_terminated
11:20:36.136 [error] Supervisor riak\_kv\_sup had child 
riak\_kv\_vnode\_master started with 
riak\_core\_vnode\_master:start\_link(riak\_kv\_vnode, riak\_kv\_legacy\_vnode, 
riak\_kv) at <0.1475.0> exit with reason reached\_max\_restart\_intensity in 
context shutdown



PS. I tuned up all the limits and open ports values...

Waiting for you help and
thank you!

Denis

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

