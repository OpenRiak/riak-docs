---
title: "Another approach for pooling riak pb client connections"
description: ""
project: community
lastmod: 2011-04-14T13:23:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03048"
author_name: "Seth Falcon"
project_section: "mailinglistitem"
sent_date: 2011-04-14T13:23:35-07:00

---


Hi all,

Given the recent discussion around David's riakpool project, I thought
I would share the connection pooling solution that I cooked up. It's
called pooler and you can find it here:

 https://github.com/seth/pooler

It is not tightly coupled to Riak's protocol buffer client, but was
designed with Riak in mind. Key features:

- Exclusive access to pool members. The interface does not use a
 higher order function (HOF), but this could be added. Consumers
 call take\_member and return\_member. Short-lived processes, such as
 Webmachine resources, don't need to call return\_member; the pool
 manager will see the exit and return the client to the pool.

- Specify an initial and maximum pool size. Mantains pool size if
 pool members crash. Does not yet reduce pool size.

- Manages multiple pools. For Riak, each pool would contain clients
 for a single node. The take\_member function randomly selects a pool
 to draw from giving simple load-balancing among Riak nodes.

- Written as an OTP application. To use it, you add config for the
 pooler application and call application:start(pooler).

Feedback most welcome.

+ seth

-- 
Seth Falcon | @sfalcon | http://userprimary.net/

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

