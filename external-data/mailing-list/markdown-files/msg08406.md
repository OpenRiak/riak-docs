---
title: "Re: How to search objects using riak_search method"
description: ""
project: community
lastmod: 2012-08-30T07:43:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08406"
author_name: "郎咸武"
project_section: "mailinglistitem"
sent_date: 2012-08-30T07:43:29-07:00

---


who can give me some idea

在 2012年8月30日星期四，郎咸武 写道：

> Hi guys,
> I need your help.
>
> Version:
> 1)riak-erlang-client-1.3
> 2)riak-1.2
> 3)Erlang R14B04 (erts-5.8.5) [source] [64-bit]
>
> This is my bucket attributs in the following
>
> (riak@127.0.0.1 )52> {ok,C}
> = riak:local\_client().
>
> {ok,{riak\_client,'riak@127.0.0.1  'riak@127.0.0.1');>',undefined}}
> (riak@127.0.0.1 )53>
> C:set\_bucket(<<"user">>,[{precommit,
> [{struct,[{<<"mod">>,<<"riak\_search\_kv\_hook">>},{<<"fun">>,<<"precommit">>}]}]}]).
> ok
> (riak@127.0.0.1 )54>
> C:get\_bucket(<<"user">>).
>
> [{search,true},
> {allow\_mult,false},
> {basic\_quorum,false},
> {big\_vclock,50},
> {chash\_keyfun,{riak\_core\_util,chash\_std\_keyfun}},
> {dw,quorum},
> {last\_write\_wins,false},
> {linkfun,{modfun,riak\_kv\_wm\_link\_walker,mapreduce\_linkfun}},
> {n\_val,3},
> {name,<<"user">>},
> {notfound\_ok,true},
> {old\_vclock,86400},
> {postcommit,[]},
> {pr,0},
> \* {precommit,[{struct,[{<<"mod">>,<<"riak\_search\_kv\_hook">>},\*
> \* {<<"fun">>,<<"precommit">>}]}]},\*
> {pw,0},
> {r,quorum},
> {rw,quorum},
> {small\_vclock,50},
> {w,quorum},
> {young\_vclock,20}]
>
> \*------------------\*
> \*In the client\*
> \*To new a object and search it\*
> 147> f(O),O=riakc\_obj:new(<<"user">>, <<"jason">>, <<"jasonlang">>)
> 147> .
> {riakc\_obj,<<"user">>,<<"jason">>,undefined,[],undefined,
> <<"jasonlang">>}
>
> 150> riakc\_pb\_socket:put(Pid,O).
> ok
> 151> riakc\_pb\_socket:search(Pid, <<"user">>, "jason\*")
> 151> .
> {ok,{search\_results,[{<<"user">>,
>
> [{<<"id">>,<<"jason">>},{<<"value">>,<<"jasonlang">>}]}],
> 0.0,1}}
> 152>
>
> \*This search operator is ok\*
>
> \*TO new another object and search it\*
>
> 152> f(O),O=riakc\_obj:new(<<"user">>, <<"lang">>, <<"langzhe">>)
> 152> .
> {riakc\_obj,<<"user">>,<<"lang">>,undefined,[],undefined,
> <<"langzhe">>}
> 153> riakc\_pb\_socket:put(Pid,O).
> ok
> 154> riakc\_pb\_socket:search(Pid, <<"user">>, "langzh\*")
> 154> .
> {ok,{search\_results,[{<<"user">>,
>
> [{<<"id">>,<<"lang">>},{<<"value">>,<<"langzhe">>}]}],
> 0.0,1}}
> \*This is ok too\*
> \*
> \*
> \*Search the objects:\*
> 157> riakc\_pb\_socket:search(Pid, <<"user">>, "langzh\*\"\"jason\*")
> 157> .
> {ok,{search\_results,[{<<"user">>,
>
> [{<<"id">>,<<"jason">>},{<<"value">>,<<"jasonlang">>}]},
> {<<"user">>,
>
> [{<<"id">>,<<"lang">>},{<<"value">>,<<"langzhe">>}]}],
> 0.0,2}}
> 158>
> This is ok too.
> -------------------------------------------------------------------
> \*In the above is ok.\*
> \*
> \*
> \*I am sorry ,\*\*the question in the following\*
> \*
> \*
> 159> f(O),O=riakc\_obj:new(<<"user">>, <<"mine">>,
> term\_to\_binary([{"name\_","jason"},{"sex\_", "male"}])).
> {riakc\_obj,<<"user">>,<<"mine">>,undefined,[],undefined,
> <<131,108,0,0,0,2,104,2,107,0,5,110,97,109,101,95,107,0,
> 5,106,97,115,...>>}
> 160> riakc\_pb\_socket:put(Pid,O).
>
> ok
> 161> riakc\_pb\_socket:search(Pid, <<"user">>,
> term\_to\_binary([{"name\_","jason"},{"sex\_", "male"}])).
> {ok,{search\_results,[{<<"user">>,
> [{<<"id">>,<<"mine">>},
> {<<"value">>,
>
> <<131,108,0,0,0,2,104,2,107,0,5,110,97,109,101,95,107,
> 0,...>>}]}],
> 0.35355299711227417,1}}
> 162> riakc\_pb\_socket:search(Pid, <<"user">>,
> term\_to\_binary([{"name\_","jason"}])).
> {ok,{search\_results,[],0.0,0}}
> 163>
> \*How to get the object by the {"name\_", "jason"} ?\*
> \*Is there another way to solve the question?\*
>
>
>
> I need your help, thanks very much.
>
> Jason
>
>
>
>
>
>
>
>
>
>
>
>
>
> --
> 只为成功找方法，不为失败找理由
>


-- 
只为成功找方法，不为失败找理由
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

