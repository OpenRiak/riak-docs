---
title: "Performance Issues with LevelDB Backend on 1.0.0RC1"
description: ""
project: community
lastmod: 2011-09-26T11:40:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04881"
mailinglist_parent_id: "msg04878"
author_name: "JB Smith"
project_section: "mailinglistitem"
sent_date: 2011-09-26T11:40:15-07:00
---


We are seeing similar issues using levelDB with 1.0.0RC1

We run a 6 way cluster on EC2 64bit micro instances.

Initially we had assumed that there may be some issue with small memory 
environments.

on 0.14.2 things would seem to balance out and stabilize.

on 1.0.0RC1, once this sort of report starts showing up, it tends to run out of 
control until the node crashes.

We also use a multi backend configuration as follows:

{storage\_backend, riak\_kv\_multi\_backend},
{multi\_backend\_default, <<"eleveldb">>},
{multi\_backend, [
 {<<"eleveldb">>, riak\_kv\_eleveldb\_backend, []},
 {<<"sessions">>, riak\_kv\_bitcask\_backend, [
 {expiry\_secs, 7200},
 {data\_root, "/riak/data/bitcask\_sessions"}]}
]},

We are now storing over 150,000 keys in the levelDB buckets

17:17:03.282 [error] CRASH REPORT Process [] with 0 neighbours crashed with 
reason: 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,122743301572712549771012593372656581728916209664,'riak...@riak004.xx.com','riak...@riak005.xx.com',riak\_pipe\_vnode}]}}
17:17:04.299 [error] Supervisor riak\_core\_vnode\_sup had child undefined started 
with {riak\_core\_vnode,start\_link,undefined} at <0.16220.0> exit with reason 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,122743301572712549771012593372656581728916209664,'riak...@riak004.xx.com','riak...@riak005.xx.com',riak\_pipe\_vnode}]}}
 in context child\_terminated
17:17:05.814 [info] monitor long\_gc <0.44.0> 
[{name,lager\_crash\_log},{initial\_call,{lager\_crash\_log,init,1}},{almost\_current\_function,{gen,do\_call,4}}]
 
[{timeout,1501},{old\_heap\_block\_size,0},{heap\_block\_size,1597},{mbuf\_size,0},{stack\_size,285},{old\_heap\_size,0},{heap\_size,1179}]
17:17:07.349 [error] gen\_fsm <0.16589.0> in state active terminated with 
reason: 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,161992613122126446500115457532517697979441741824,'riak...@riak004.xx.com','riak...@riak006.xx.com',riak\_pipe\_vnode}]}}
17:17:07.351 [info] monitor long\_gc <0.101.0> 
[{name,riak\_core\_ring\_manager},{initial\_call,{gen,init\_it,7}},{almost\_current\_function,{erl\_syntax,is\_tree,1}}]
 
[{timeout,1510},{old\_heap\_block\_size,0},{heap\_block\_size,317811},{mbuf\_size,0},{stack\_size,2363},{old\_heap\_size,0},{heap\_size,275697}]
17:17:10.345 [error] CRASH REPORT Process [] with 0 neighbours crashed with 
reason: 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,161992613122126446500115457532517697979441741824,'riak...@riak004.xx.com','riak...@riak006.xx.com',riak\_pipe\_vnode}]}}
17:17:10.348 [info] monitor long\_gc <0.17891.0> 
[{initial\_call,{erlang,apply,2}},{almost\_current\_function,{erl\_scan,set\_attribute,3}}]
 
[{timeout,1481},{old\_heap\_block\_size,0},{heap\_block\_size,121393},{mbuf\_size,0},{stack\_size,99},{old\_heap\_size,0},{heap\_size,116704}]
17:17:11.847 [error] gen\_server <0.16590.0> terminated with reason: 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,161992613122126446500115457532517697979441741824,'riak...@riak004.xx.com','riak...@riak006.xx.com',riak\_pipe\_vnode}]}}
17:17:13.339 [info] monitor long\_gc <0.17891.0> 
[{initial\_call,{erlang,apply,2}},{almost\_current\_function,{erl\_expand\_records,expr,2}}]
 
[{timeout,1473},{old\_heap\_block\_size,0},{heap\_block\_size,317811},{mbuf\_size,0},{stack\_size,1364},{old\_heap\_size,0},{heap\_size,151085}]
17:17:13.342 [error] CRASH REPORT Process [] with 0 neighbours crashed with 
reason: 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,161992613122126446500115457532517697979441741824,'riak...@riak004.xx.com','riak...@riak006.xx.com',riak\_pipe\_vnode}]}}
17:17:14.842 [error] Supervisor riak\_core\_vnode\_sup had child undefined started 
with {riak\_core\_vnode,start\_link,undefined} at <0.16589.0> exit with reason 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,161992613122126446500115457532517697979441741824,'riak...@riak004.xx.com','riak...@riak006.xx.com',riak\_pipe\_vnode}]}}
 in context child\_terminated
17:17:14.857 [error] gen\_fsm <0.15083.0> in state active terminated with 
reason: 
{timeout,{gen\_server,call,[riak\_core\_gossip,{finish\_handoff,72076008481650973993443441457199504387328704512,'riak...@riak004.xx.com','riak...@riak006.xx.com',riak\_kv\_vnode}]}}
17:17:16.338 [info] monitor long\_gc <0.17891.0> 
[{initial\_call,{erlang,apply,2}},{almost\_current\_function,{zlib,deflateInit,2}}]
 
[{timeout,1470},{old\_heap\_block\_size,0},{heap\_block\_size,75025},{mbuf\_size,0},{stack\_size,34},{old\_heap\_size,0},{heap\_size,36434}]

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

