---
title: "Low PUT throughput using Riak"
description: ""
project: community
lastmod: 2012-02-02T16:33:34-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06514"
author_name: "Hussam Abu-Libdeh"
project_section: "mailinglistitem"
sent_date: 2012-02-02T16:33:34-08:00

---


Hello,

I am trying to benchmark Riak on a local cluster. I have Riak v1.0.2
compiled from source. I am benchmarking using Basho's benchmarking
tool, and I used Riaknostic to help me with configuration. My machines
are all Dual Xeon with 2GB of RAM and 1Gb ethernet. I get about 50MB/s
write throughput on the local disks, and the local disks are mounted
with the noatime flag as Riaknostic suggested.

I benchmarked the write throughput of Bitcask by running a local
experiment where 1 worker was continuously writing 10K fixed\_binary
objects ( {value\_generator, {fixed\_bin, 10000}}. ) with the only
bitcask-specific flag being: {bitcask\_flags, [{sync\_strategy, none}]}.
I got about 50 MB/s write throughput from Bitcask, so that is good.

Then I tried to benchmark Riak. I setup a cluster of 8 Riak nodes with
the same configuration as used for Bitcask. I used the riakclient
driver from the benchmarking suite, and set the required riak\_client
replies to 1. The client was generating PUT operations continuously
with 10K binaries as before. I only got a throughput of about 4 MB/s.
I thought this might be an issue of storing extra copies due to
replication, so I modified the app.config file on all the nodes to
specify that N, R, and W are all set to 1. No improvement. I thought
this could be an issue in the network, so I benchmarked a single-node
cluster, with the client being local to the same machine (and N,R,W
all set to 1), and I still got the same low throughput. Finally, out
of desperation, I even modified the target\_n\_val parameter to 1 and
the ring\_creation\_size to 1 so there is only 1 Bitcask directory, ran
the experiment with 1 local client, and I still got the same very low
throughput.

Any help would be greatly appreciated. I have been stuck at this for a
while now.

Thanks,

--Hussam

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

