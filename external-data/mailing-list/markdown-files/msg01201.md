---
title: "Re: Pervasive replication"
description: ""
project: community
lastmod: 2010-10-05T09:54:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01201"
mailinglist_parent_id: "msg01200"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-10-05T09:54:54-07:00
---


Make sure you set ulimit -n before starting Riak. A value of 1024 or larger is 
recommended (on OS/X the default is 256). Example:

$ ulimit -a
core file size (blocks, -c) 0
data seg size (kbytes, -d) unlimited
file size (blocks, -f) unlimited
max locked memory (kbytes, -l) unlimited
max memory size (kbytes, -m) unlimited
open files (-n) 256
pipe size (512 bytes, -p) 1
stack size (kbytes, -s) 8192
cpu time (seconds, -t) unlimited
max user processes (-u) 266
virtual memory (kbytes, -v) unlimited

$ ulimit -n 1024

This is a common cause of timeouts and connection failures on OS/X.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Oct 5, 2010, at 12:43 PM, Alex Wolfe wrote:

> I've run into a problem with Riak on my development machine, and I can't 
> quite sort out what's happening. I've tried stopping the riak processes and 
> restarting it back up again, but it will not service any requests.
> 
> Has anyone seen this before?
> 
> 
> $ curl -v -X POST http://riak:8098/riak/test -d'{"foo":"bar"}' -H 
> 'Content-Type:application/json'
> \* About to connect() to riak port 8098 (#0)
> \* Trying ::1... Connection refused
> \* Trying fe80::1... Connection refused
> \* Trying 127.0.0.1... connected
> \* Connected to riak (127.0.0.1) port 8098 (#0)
>> POST /riak/test HTTP/1.1
>> User-Agent: curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 
>> OpenSSL/0.9.8l zlib/1.2.3
>> Host: riak:8098
>> Accept: \*/\*
>> Content-Type:application/json
>> Content-Length: 13
>> 
> < HTTP/1.1 500 Internal Server Error
> < Vary: Accept-Encoding
> < Server: MochiWeb/1.1 WebMachine/1.7.1 (participate in the frantic)
> < Location: /riak/test/RmfYZCM8LtBPRu4gqZivu8pfVoh
> < Date: Tue, 05 Oct 2010 16:36:57 GMT
> < Content-Type: text/html
> < Content-Length: 713
> < 
> 500 Internal Server ErrorInternal 
> Server Error
========================

The server encountered an error while processing this 
> request:  

```
{error,{error,{case_clause,{error,timeout}},
>              [{riak_kv_wm_raw,accept_doc_body,2},
>               {webmachine_resource,resource_call,3},
>               {webmachine_resource,do,3},
>               {webmachine_decision_core,resource_call,1},
>               {webmachine_decision_core,accept_helper,0},
>               {webmachine_decision_core,decision,1},
>               {webmachine_decision_core,handle_request,2},
> * Connection #0 to host riak left intact
> * Closing connection #0
>               
> {webmachine_mochiweb,loop,1}]}}
```


---

mochiweb+webmachine web 
> server


> 
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

