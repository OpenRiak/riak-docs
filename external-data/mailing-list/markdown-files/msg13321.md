---
title: "Re: design a read-only data storage cluster"
description: ""
project: community
lastmod: 2013-12-21T06:52:54-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13321"
mailinglist_parent_id: "msg13318"
author_name: "Matthew Von-Maszewski"
project_section: "mailinglistitem"
sent_date: 2013-12-21T06:52:54-08:00
---



On Dec 21, 2013, at 4:12 AM, Damien Krotkine  wrote:

> First option is to use leveldb as storage backend. And use an external
> script to expire (delete) keys that are too old (one of the secondary
> index being the timestamp, it's easy). However it seems that deleted
> keys in leveldb may not be claimed before a very long time, and some
> tests showed that real space used by the ring tend to always grow (space
> never reclamied?) and I've seen some threads about this lately.

The issue about leveldb not reclaiming disk space for a very long time is true. 
 This is the way Google wrote leveldb. Basho has recently added code to 
leveldb to address the problem. Basho's change is discussed here:

https://github.com/basho/leveldb/wiki/mv-aggressive-delete

The new code is part of the mv-agrressive-delete branch in the basho/leveldb 
repository at github. The branch is available now if you wish to manually 
include it within your Riak build. The branch is also part of the upcoming 
Riak 2.0 release.

Matthew

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

