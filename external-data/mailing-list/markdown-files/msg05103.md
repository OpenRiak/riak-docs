---
title: "Re: Riak 1.0, Clojure and the Java Client"
description: ""
project: community
lastmod: 2011-10-07T16:23:35-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05103"
mailinglist_parent_id: "msg05102"
author_name: "Tim Robinson"
project_section: "mailinglistitem"
sent_date: 2011-10-07T16:23:35-07:00
---


Hi Russell,

Thanks for the response and the history (which is always the hardest
part in understanding a current state).

Here are some thoughts/response to your write up:

> Let me know why not, please

I think you misread my statement here, as I said I do believe I can
use it.

> [link...] give a more realistic comparison..

I had read that previously, however, I had not realized the history
of the client, so I didn't know that represented an apples to apples
comparison. Now I know... thanx.

> it would be great to create a Statebox

I just read the Satebox page you linked as an example and have a hard
time thinking I would want to use this. While automation is always
nice, the overhead is an unnecessary burden. Since Clojure provides
coordinated/transactional data structures, it's already easy \*enough\*
to resolve conflicts within your natural code flow without having to
resort to the rationalizing of queued values. Also, I can only speak
for myself, but I believe most people would only want this to apply in
selective cases such that a performance hit is not taken for the other
90% of data where last write winning is just fine. 

Does that make sense to you? I could be completely off considering I
only read the 5 minute 'read-me' blurb.

Thanks again.
Tim

At Friday, 10/07/2011 on 4:08 pm Russell Brown wrote:

Hi Tim,
On 7 Oct 2011, at 22:45, Tim Robinson wrote:

Hello,

I have been slowly learning & evaluating Riak for a product I am
developing. Originally I gave Riak a whirl about 6 months back, but
stopped due to some missing features. With the recent release of 1.0
I've decided to give it another chance.

So here are a few kick off questions I hope you can help answer to
get me started again:

1.  Since I am back to square one, I am looking at the clients
again.... Currently my programming language of choice is Clojure, and
initially I had been playing around with the Clj-Riak library
(https://github..com/mmcgrana/clj-riak) which I had believed was a thin
wrapper around the standard Java protocol buffer client maintained by
Basho, however in looking at the source I notice clj-riak actually
uses an alternative client, linked
here:  https://github.com/krestenkrab/riak-java-pb-client, written
by some fellow at trifork (isn't trifork Basho's primary investor?).
Anyways it looks as though this Kresten fellow has been able to
improve the java client's performance by a factor of 10. Has anyone
upgraded this alternate version, or have an opinion to its alignment
with Riak 1.0?

So, (Dr.) Kresten's PB client was integrated into the Basho client
about 0.14. Basho fixed some minor bugs in it for our 0.14.1 release.
As of now (1.0rc1) it is one of the two bedrock APIs of the
riak-java-client, although it is somewhat smoothed over by a
compatibility layer that allows you to use either HTTP or PB with the
same API. The Basho repo has fixes to Kresten's repo, so, bottom line,
if you want raw speed and can sacrifice API parity, use the
pbc.RiakClient from the 1.0rc1 release of Basho's riak-java-client, it
is basically Trifork code with some fixes.

Note: I'm sure I can use the new java client,

Let me know why not, please.

 but a 10x speed up sounds pretty appealing and I'm wondering why
it's not already a topic here.

Figures here (http://wiki.basho.com/Java-Client-Benchmark.html) give
a more realistic comparison, I am seeing 2.5x-4x speed up, still not
to be ignored.

I would really like to be able to mould the riak-java-client to
clojure. Better still, it would be great to create a Statebox
(https://github.com/mochi/statebox) like clojure client for Riak. Greg
Burd (at Basho) and I have already talked about this, and if you're
interested, collaboration would be cool.

I'll leave your other question to someone better informed.

Cheers

Russell

2. Are there any known plans for a Riak cloud service? I know about
Joyent, but frankly I don't like their business model and can't see
using them. Just curious if there's anything in the works. 

Note: as a preemptive answe: I'm looking for a service which is 1.
more reasonably priced, 2. has an initial free tier and 3. automates
the upgrades and the linking/start-up process... so really, I'm
looking for the MongoHQ of Riak (https://mongohq.com/pricing).

Thanks,
Tim Robinson  

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho..com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

