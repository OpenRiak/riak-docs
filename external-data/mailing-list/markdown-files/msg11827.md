---
title: "Re: setting ACL in a put request, riak cs 1.3.1-1"
description: ""
project: community
lastmod: 2013-07-30T19:17:15-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11827"
mailinglist_parent_id: "msg11825"
author_name: "Hector Castro"
project_section: "mailinglistitem"
sent_date: 2013-07-30T19:17:15-07:00
---


Hey Eugene,

I believe I reproduced the issue you are seeing. I went ahead and
created an issue for the Riak CS team to review. [0]

--
Hector

[0] https://github.com/basho/riak\_cs/issues/631

On Tue, Jul 30, 2013 at 9:41 PM, Kota Uenishi  wrote:
> Eugene,
>
> Congratulations, and thank you! You have found a bug X'(
> Could you open an issue on github issues[1] ? Your report is very nice
> and sufficient so just copy and pasting your mail will work. We will
> be working on that.
>
> [1] https://github.com/basho/riak\_cs
>
> Cheers,
> Kota
>
> On Mon, Jul 29, 2013 at 11:47 AM, Eugene Doudine  wrote:
>> Greetings,
>>
>> I'm trying to set object ACL in the put request using the
>> x-amz-grant-\* headers as described in the docs:
>> http://docs.basho.com/riakcs/latest/references/apis/storage/RiakCS-PUT-Object/
>>
>> The server creates objects, but neither sets the ACL nor
>> returns any warnings or errors.
>>
>> Setting same ACL in a separate request (PUT /test1.txt?acl=) works as
>> expected.
>>
>> Is this a bug, or not yet implemented or I simply miss something?
>> I'm pretty new to Riak-CS and the cloud API's.
>>
>> Thanks!
>>
>> Here is dump of the put request and server's responce :
>>
>> PUT /test1.txt HTTP/1.1
>> Host: bucketsys1.localhost.localhost:8080
>> x-amz-grant-full-control: emailAddress="sys1@localhost"
>> x-amz-meta-testkey1: testvar1
>> Authorization: AWS \_BZLP5L3UTR\_UYZRDZY6:xNSHzb7VUlHothQx+e1dTYjN0HU=
>> Date: Mon, 29 Jul 2013 02:30:49 GMT
>> Content-MD5: 65wr8Otj86e8DqN+8YrrpQ==
>> User-Agent: aws-sdk-java/1.4.5 Linux/3.2.0-48-generic
>> Java\_HotSpot(TM)\_Server\_VM/19.1-b02
>> x-amz-grant-write: emailAddress="sys3@localhost"
>> x-amz-meta-test-key2: testval2
>> Content-Type: application/json
>> x-amz-grant-read: emailAddress="sys2@localhost"
>> Content-Length: 13
>> Connection: Keep-Alive
>> Expect: 100-continue
>>
>> HTTP/1.1 100 Continue
>>
>> some content
>> HTTP/1.1 200 OK
>> Server: Riak CS
>> ETag: "eb9c2bf0eb63f3a7bc0ea37ef18aeba5"
>> Date: Mon, 29 Jul 2013 02:30:50 GMT
>> Content-Type: text/plain
>> Content-Length: 0
>>
>>
>> Here is info on the created object as given by s3cmd, only
>> owners has the requested rights:
>>
>> s3://bucketsys1.localhost/test1.txt (object):
>> File size: 13
>> Last mod: Mon, 29 Jul 2013 02:30:50 GMT
>> MIME type: application/json
>> MD5 sum: eb9c2bf0eb63f3a7bc0ea37ef18aeba5
>> policy: none
>> ACL: sys1: FULL\_CONTROL
>>
>>
>> Here is the separate acl modification request which works as expected:
>>
>>
>> PUT /test1.txt?acl= HTTP/1.1
>> Host: bucketsys1.localhost.localhost:8080
>> Authorization: AWS \_BZLP5L3UTR\_UYZRDZY6:aLXe+A5bQFIft2ELJLLWob0AAAE=
>> Date: Mon, 29 Jul 2013 02:33:27 GMT
>> User-Agent: aws-sdk-java/1.4.5 Linux/3.2.0-48-generic
>> Java\_HotSpot(TM)\_Server\_VM/19.1-b02
>> Content-Type: text/plain
>> Content-Length: 793
>> Connection: Keep-Alive
>> Expect: 100-continue
>>
>> HTTP/1.1 100 Continue
>>
>> > xmlns="http://s3.amazonaws.com/doc/2006-03-01/">\_BZLP5L3UTR\_UYZRDZY6sys1> xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>> xsi:type="AmazonCustomerByEmail">sys1@localhostFULL\_CONTROL> xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>> xsi:type="AmazonCustomerByEmail">sys3@localhostWRITE> xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>> xsi:type="AmazonCustomerByEmail">sys2@localhostREAD
>>
>> HTTP/1.1 200 OK
>> Server: Riak CS
>> Date: Mon, 29 Jul 2013 02:33:27 GMT
>> Content-Type: text/plain
>> Content-Length: 0
>>
>> Now the object has the requested ACL:
>>
>> s3://bucketsys1.localhost/test1.txt (object):
>> File size: 13
>> Last mod: Mon, 29 Jul 2013 02:30:50 GMT
>> MIME type: application/json
>> MD5 sum: eb9c2bf0eb63f3a7bc0ea37ef18aeba5
>> policy: none
>> ACL: sys1: FULL\_CONTROL
>> ACL: sys3: WRITE
>> ACL: sys2: READ
>>
>>
>> Regards,
>> Eugene
>>
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>
>
>
> --
> Kota UENISHI / @kuenishi
> Basho Japan KK
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

