---
title: "Error On Riak Search"
description: ""
project: community
lastmod: 2014-09-24T10:14:24-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14916"
author_name: "Jorge Garrido gomez"
project_section: "mailinglistitem"
sent_date: 2014-09-24T10:14:24-07:00

---


Hello, 

Recenlty we experiment an error on our riak cluster related to riak search:

2014-09-20 14:25:36 =ERROR REPORT====
\*\* Generic server <0.29307.896> terminating 
\*\* Last message in was 
{tcp,#Port<0.16938821>,<<0,0,0,128,27,10,115,40,112,104,97,115,101,58,112,104,97,115,101,49,32,65,78,68,32,116,121,112,101,95,112,114,111,102,105,108,101,58,78,111,116,101,115,32,65,78,68,32,97,99,116,105,118,101,58,116,114,117,101,32,65,78,68,32,105,115,95,99,111,108,117,109,110,58,116,114,117,101,32,65,78,68,32,98,114,111,111,116,58,100,56,100,98,56,51,102,53,55,100,99,49,52,99,51,49,56,55,101,56,55,98,102,55,56,48,48,52,97,51,55,99,41,18,6,115,101,97,114,99,104,24,20>>}
\*\* When Server state == 
{state,#Port<0.16938821>,undefined,[{riak\_api\_basic\_pb\_service,undefined},{riak\_core\_pb\_bucket,undefined},{riak\_kv\_pb\_bucket,{state,{riak\_client,'riakliveprod1@10.136.89.100',undefined},undefined,undefined}},{riak\_kv\_pb\_counter,{state,{riak\_client,'riakliveprod1@10.136.89.100',undefined}}},{riak\_kv\_pb\_csbucket,{state,{riak\_client,'riakliveprod1@10.136.89.100',undefined},undefined,undefined,undefined,0}},{riak\_kv\_pb\_index,{state,{riak\_client,'riakliveprod1@10.136.89.100',undefined},undefined,undefined,undefined,0}},{riak\_kv\_pb\_mapred,{state,undefined,undefined}},{riak\_kv\_pb\_object,{state,{riak\_client,'riakliveprod1@10.136.89.100',undefined},undefined,undefined,<<0,0,0,0>>}},{riak\_search\_pb\_query,{state,{riak\_search\_client,{riak\_client,'riakliveprod1@10.136.89.100',undefined}}}}],<<0,0,0,128,27,10,115,40,112,104,97,115,101,58,112,104,97,115,101,49,32,65,78,68,32,116,121,112,101,95,112,114,111,102,105,108,101,58,78,111,116,101,115,32,65,78,68,32,97,99,116,105,118
 
,101,58,116,114,117,101,32,65,78,68,32,105,115,95,99,111,108,117,109,110,58,116,114,117,101,32,65,78,68,32,98,114,111,111,116,58,100,56,100,98,56,51,102,53,55,100,99,49,52,99,51,49,56,55,101,56,55,98,102,55,56,48,48,52,97,51,55,99,41,18,6,115,101,97,114,99,104,24,20>>,{buffer,[],0,1024}}
\*\* Reason for termination == 
\*\* 
{error,function\_clause,[{riak\_indexed\_doc,to\_pairs,[<<"id">>,{error,timeout},all],[{file,"src/riak\_indexed\_doc.erl"},{line,110}]},{riak\_search\_pb\_query,'-encode\_results/3-lc$^1/1-0-',3,[{file,"src/riak\_search\_pb\_query.erl"},{line,110}]},{riak\_search\_pb\_query,'-encode\_results/3-lc$^1/1-0-',3,[{file,"src/riak\_search\_pb\_query.erl"},{line,112}]},{riak\_search\_pb\_query,encode\_results,3,[{file,"src/riak\_search\_pb\_query.erl"},{line,109}]},{riak\_search\_pb\_query,process,2,[{file,"src/riak\_search\_pb\_query.erl"},{line,81}]},{riak\_api\_pb\_server,process\_message,4,[{file,"src/riak\_api\_pb\_server.erl"},{line,223}]},{riak\_api\_pb\_server,handle\_message,3,[{file,"src/riak\_api\_pb\_server.erl"},{line,200}]},{riak\_api\_pb\_server,decode\_buffer,1,[{file,"src/riak\_api\_pb\_server.erl"},{line,172}]}]}
2014-09-20 14:25:36 =CRASH REPORT====
 crasher:
 initial call: riak\_api\_pb\_server:init/1
 pid: <0.29307.896>
 registered\_name: []
 exception exit: 
{{error,function\_clause,[{riak\_indexed\_doc,to\_pairs,[<<"id">>,{error,timeout},all],[{file,"src/riak\_indexed\_doc.erl"},{line,110}]},{riak\_search\_pb\_query,'-encode\_results/3-lc$^1/1-0-',3,[{file,"src/riak\_search\_pb\_query.erl"},{line,110}]},{riak\_search\_pb\_query,'-encode\_results/3-lc$^1/1-0-',3,[{file,"src/riak\_search\_pb\_query.erl"},{line,112}]},{riak\_search\_pb\_query,encode\_results,3,[{file,"src/riak\_search\_pb\_query.erl"},{line,109}]},{riak\_search\_pb\_query,process,2,[{file,"src/riak\_search\_pb\_query.erl"},{line,81}]},{riak\_api\_pb\_server,process\_message,4,[{file,"src/riak\_api\_pb\_server.erl"},{line,223}]},{riak\_api\_pb\_server,handle\_message,3,[{file,"src/riak\_api\_pb\_server.erl"},{line,200}]},{riak\_api\_pb\_server,decode\_buffer,1,[{file,"src/riak\_api\_pb\_server.erl"},{line,172}]}]},[{gen\_server,terminate,6,[{file,"gen\_server.erl"},{line,747}]},{proc\_lib,init\_p\_do\_apply,3,[{file,"proc\_lib.erl"},{line,227}]}]}
 ancestors: [riak\_api\_pb\_sup,riak\_api\_sup,<0.272.0>]
 messages: []
 links: [<0.276.0>,#Port<0.16938821>]
 dictionary: [{random\_seed,{29569,23547,27895}}]
 trap\_exit: false
 status: running
 heap\_size: 4181
 stack\_size: 24
 reductions: 5449716722
 neighbours:
2014-09-20 14:25:36 =SUPERVISOR REPORT====
 Supervisor: {local,riak\_api\_pb\_sup}
 Context: child\_terminated
 Reason: 
{error,function\_clause,[{riak\_indexed\_doc,to\_pairs,[<<"id">>,{error,timeout},all],[{file,"src/riak\_indexed\_doc.erl"},{line,110}]},{riak\_search\_pb\_query,'-encode\_results/3-lc$^1/1-0-',3,[{file,"src/riak\_search\_pb\_query.erl"},{line,110}]},{riak\_search\_pb\_query,'-encode\_results/3-lc$^1/1-0-',3,[{file,"src/riak\_search\_pb\_query.erl"},{line,112}]},{riak\_search\_pb\_query,encode\_results,3,[{file,"src/riak\_search\_pb\_query.erl"},{line,109}]},{riak\_search\_pb\_query,process,2,[{file,"src/riak\_search\_pb\_query.erl"},{line,81}]},{riak\_api\_pb\_server,process\_message,4,[{file,"src/riak\_api\_pb\_server.erl"},{line,223}]},{riak\_api\_pb\_server,handle\_message,3,[{file,"src/riak\_api\_pb\_server.erl"},{line,200}]},{riak\_api\_pb\_server,decode\_buffer,1,[{file,"src/riak\_api\_pb\_server.erl"},{line,172}]}]}
 Offender: 
[{pid,<0.29307.896>},{name,undefined},{mfargs,{riak\_api\_pb\_server,start\_link,undefined}},{restart\_type,temporary},{shutdown,brutal\_kill},{child\_type,worker}]


After that, our riak erlang client throw an error on each search, 

 the next are the configuration for our cluster:

Riak version 1.4.2.
Cluster with 4 nodes.
Enable search on all nodes.
All default settings on vm.args and app.config

I hope you can help us!

Thanks 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

