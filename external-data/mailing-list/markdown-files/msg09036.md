---
title: "Re: riak fails to start on Ubtunu Precise"
description: ""
project: community
lastmod: 2012-10-24T10:30:03-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09036"
author_name: "Evan Vigil-McClanahan"
project_section: "mailinglistitem"
sent_date: 2012-10-24T10:30:03-07:00

---


This is an issue with our packaging.

https://github.com/basho/node\_package/issues/26

Riak starts without being configured, which writes ring file with the
defaults. When you restart it with your proper config, you get this
error.

There's also a core issue to make the error more clear:

https://github.com/basho/riak\_core/issues/243

If you kill your ring directory and restart, everything should work correctly.

On Wed, Oct 24, 2012 at 9:26 AM, brian.thoma...@gmail.com
 wrote:
> I installed enstratus which makes use of riak and unfortunately, i can't get
> riak to start. Here is the console output:
>
> Attempting to restart script through sudo -H -u riak
> Exec: /usr/lib/riak/erts-5.9.1/bin/erlexec -boot
> /usr/lib/riak/releases/1.2.0/riak -embedded -config
> /etc/riak/app.config -pa /usr/lib/riak/basho-patches
> -args\_file /etc/riak/vm.args -- console
> Root: /usr/lib/riak
> Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:2:2] [async-threads:64]
> [kernel-poll:true]
>
>
> =INFO REPORT==== 24-Oct-2012::12:25:46 ===
> alarm\_handler: {set,{system\_memory\_high\_watermark,[]}}
> \*\* /usr/lib/riak/lib/observer-1.1/ebin/etop\_txt.beam hides
> /usr/lib/riak/lib/basho-patches/etop\_txt.beam
> \*\* Found 1 name clashes in code paths
> 12:25:46.667 [info] Application lager started on node 'riak@127.0.0.1'
> 12:25:46.762 [info] Upgrading legacy ring
> 12:25:46.991 [error] gen\_server riak\_core\_capability terminated with reason:
> no function clause matching orddict:fetch('riak@127.0.0.1', []) line 72
> Erlang has closed
>
> =INFO REPORT==== 24-Oct-2012::12:25:47 ===
> alarm\_handler: {clear,system\_memory\_high\_watermark}
> /usr/lib/riak/lib/os\_mon-2.2.9/priv/bin/memsup: Erlang has closed.
> {"Kernel
> pid
> terminated",application\_controller,"{application\_start\_failure,riak\_core,{bad\_return,{{riak\_core\_app,start,[normal,[]]},{'EXIT',{{function\_clause,[{orddict,fetch,['riak@127.0.0.1',[]],[{file,[111,114,100,100,105,99,116,46,101,114,108]},{line,72}]},{riak\_core\_capability,renegotiate\_capabilities,1,[{file,[115,114,99,47,114,105,97,107,95,99,111,114,101,95,99,97,112,97,98,105,108,105,116,121,46,101,114,108]},{line,414}]},{riak\_core\_capability,handle\_call,3,[{file,[115,114,99,47,114,105,97,107,95,99,111,114,101,95,99,97,112,97,98,105,108,105,116,121,46,101,114,108]},{line,208}]},{gen\_server,handle\_msg,5,[{file,[103,101,110,95,115,101,114,118,101,114,46,101,114,108]},{line,588}]},{proc\_lib,init\_p\_do\_apply,3,[{file,[112,114,111,99,95,108,105,98,46,101,114,108]},{line,227}]}]},{gen\_server,call,[riak\_core\_capability,{register,{riak\_core,vnode\_routing},{capability,[proxy,legacy],legacy,{riak\_core,legacy\_vnode\_routing,[{true,legacy},{false,proxy}]}}},infinity]}}}}}}"}
>
> Crash dump was written to: /var/log/riak/erl\_crash.dump
> Kernel pid terminated (application\_controller)
> ({application\_start\_failure,riak\_core,{bad\_return,{{riak\_core\_app,start,[normal,[]]},{'EXIT',{{function\_clause,[{orddict,fetch,['riak@127.0.0.1',[]],[{
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

