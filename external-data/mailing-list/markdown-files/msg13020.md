---
title: "hard time with Riak 2.0.0pre5 features"
description: ""
project: community
lastmod: 2013-11-19T09:34:01-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13020"
author_name: "Valter Balegas"
project_section: "mailinglistitem"
sent_date: 2013-11-19T09:34:01-08:00

---


Hello,
I’ve been trying to use a couple features of Riak 2, but i cannot get things to 
work.
I’m kinda new to Riak, but i’d like to try these features for a project.

CRDTs:
I’m trying to run this code: 
https://gist.github.com/russelldb/5da7d895cebc77dd38b8

First i create the type, which i do not exactly understand what it means, but i 
believe i’m creating a bucket that supports maps.

./riak-admin bucket-type create maps '{"props": {"datatype":"map", 
"allow\_mult":true}}'
./riak-admin bucket-type activate maps

and then i run the following operations:

f(Pid), {ok, Pid} = riakc\_pb\_socket:start\_link("localhost", 8087).
user:create\_user(Pid, <<"Key">>, <<"Bob">>, <<"Dobalina">>, <<"bodo">>). 

but always receive the error:
\*\* exception exit: function\_clause
 in function riak\_pb\_dt\_codec:decode\_map\_field/2
 called as riak\_pb\_dt\_codec:decode\_map\_field({mapentry,
 
{mapfield,<<"views">>,
 'COUNTER'},
 
0,[],undefined,undefined,
 []},
 [])
 in call from 
riak\_pb\_dt\_codec:'-decode\_update\_response/3-lc$^0/1-0-'/1 
(src/riak\_pb\_dt\_codec.erl, line 500)
 in call from riak\_pb\_dt\_codec:decode\_update\_response/3 
(src/riak\_pb\_dt\_codec.erl, line 500)
 in call from riakc\_pb\_socket:process\_response/3 
(src/riakc\_pb\_socket.erl, line 1770)
 in call from riakc\_pb\_socket:handle\_info/2 
(src/riakc\_pb\_socket.erl, line 1303)
 in call from gen\_server:handle\_msg/5 (gen\_server.erl, line 607)
 in call from proc\_lib:init\_p\_do\_apply/3 (proc\_lib.erl, line 227)


Strong consistency:
How does one activate this? As i understand, either the pb or the http clients 
do not accept the consistent property.

Details about my environment:
-I’m running Mac OSX 10.9
-Erlang R15B01
-Compiling riak “develop” branch, from basho github 
-Compiling riak-erlang-client “master” branch, from basho github.
-recompiled the latest versions of the branches just before writing this email.


Thank you for your help,
Valter\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

