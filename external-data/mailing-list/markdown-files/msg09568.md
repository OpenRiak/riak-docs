---
title: "Re: nebie with volumes and best practices with /var/lib/riak	data directory"
description: ""
project: community
lastmod: 2012-12-12T15:10:02-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09568"
mailinglist_parent_id: "msg09534"
author_name: "Sean Carey"
project_section: "mailinglistitem"
sent_date: 2012-12-12T15:10:02-08:00
---


Hey David, 
My comments are inline. 


On Wednesday, December 12, 2012 at 3:38 AM, David Montgomery wrote:

> Thanks.,that helps...
> 
> So..what happens if I have in existing path on a smaller drive and I attach 
> a new volume and switch? 

- Stop riak. 
- Copy the data out. 
- Mount the new volume with the same permissions. 
- Copy the data in. 
- Start riak. 
- Things should work. 
> In essence looking for best practice on how ot handle this. 
> 

> 
> Is it better to do a rolling upgrade where I start new machines fresh with 1T 
> then remove the smaller nodes 1 by one? So...I have three nodes with 20 gigs 
> each. Increase to 6 nodes. Then one one by remove the old nod and now back 
> to three with 1T each. It does seem that a rolling upgrade involves much 
> less risk.
> 
If you don't have enough disk space. Mount a temporary volume somewhere and 
back the data up (make sure riak is stopped. I would not focus on leaves and 
joins. 

 Make sure to do the copy process 1 node at a time.. 


Please let me know if you need more details. This should work fine and we do 
this all the time. 


> Thanks
> 
> 
> 
> 
> 
> 
> 
> 
> 
> On Wed, Dec 12, 2012 at 2:13 PM, Sean Carey  (mailto:ca...@basho.com)> wrote:
> > Hey David, 
> > You are correct. You can do 1 of two things here: 
> > 
> > 1) Mount your 1TB volume to /var/lib/riak. All ring, and backend data will 
> > be stored there. 
> > 
> > 2) Mount your volume somewhere like /data/riak and switch the 
> > platform\_data\_dir config option to reflect that mounted path. 
> > 
> > If you wanted to snapshot your riak data, it all lives in platform\_data\_dir 
> > 
> > 
> > Hope this helps, 
> > 
> > 
> > Sean 
> > @densone
> > 
> > 
> > 
> > On Wednesday, December 12, 2012 at 12:32 AM, David Montgomery wrote:
> > 
> > 
> > 
> > > Hi,
> > > 
> > > I use datapipe for by cloud provider. An I am rather new from a sysadmin 
> > > perspective of having to attach volumes. I am using ubuntu 12.04 64.
> > > 
> > > So...now that I can attach a 1T volume on machine boot....by question is 
> > > this.
> > > 
> > > When I mount the new volume.....should I mount /var/lib/riak? I see 
> > > that the data directory is {platform\_data\_dir, "/var/lib/riak"}, from 
> > > the app.config file. Thus data will be written to the new drive solely 
> > > this making use of the 1T? Data will not be stored on the default volume 
> > > which is 20 gigs on datapipe. Then at this point I can snapshot the 
> > > volume to capture all data?
> > > 
> > > Thanks
> > > 
> > > David
> > > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > > riak-users mailing list
> > > riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
> > > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> > > 
> > > 
> > > 
> > 
> > 
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

