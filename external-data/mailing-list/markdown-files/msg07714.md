---
title: "Re: Link walking with Erlang riak client"
description: ""
project: community
lastmod: 2012-06-19T10:48:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07714"
mailinglist_parent_id: "msg07713"
author_name: "Eric Moritz"
project_section: "mailinglistitem"
sent_date: 2012-06-19T10:48:54-07:00
---


Links may not be the most appropriate way to model a set of associated
users. They have a limited length and both the user data and the
links have to be saved at the same time.

What you can do is emulate a set using a separate bucket and secondary indexes.

So basically the bucket would look like this:

So if I'm a friend of yours,

PUT /buckets/friends/keys/eric-morgan
x-riak-index-friend\_id\_bin: morgan
x-riak-index-user\_id\_bin: eric
Content-Type: application/json

{"user\_id": "eric", "friend\_id": "morgan"}

Then you can fetch a set of my friends by doing a 2i query for the
bucket friends and the index
user\_id.

If you want to a set of all the people that have friended you, do a 2i
query on friend\_id with the value "morgan".

You can quickly see if we're mutual friends by fetching:

/buckets/friends/keys/eric-morgan and /buckets/friends/keys/morgan-eric.

If both are found, then we're mutual friends.

Eric.

On Tue, Jun 19, 2012 at 12:35 PM, Morgan Segalis  wrote:
> Hi everyone !
>
> I'm looking for a NoSQL solution to get ride of MySQL.
> In this particular issue, I think that Riak is one of the top of my choices 
> in order to do what I'm looking for.
>
> I would like to store all my users into Riak.
> I understand that Riak is document oriented, so that's great for getting 
> every information really fast from one user.
> One of the feature I'm really interested in, are Links.
>
> Links seems to be a great way for me to create association between usersâ€¦
>
> When A adds B, I create a link from A to B.
> When B accepts A's invitation, I create a link from B to A.
>
> If links are not both ways, e.g. A to B to A, message can not go through (B 
> who didn't accept A should not get its message yet)
>
> My server is coded in Erlang, I have checked the Erlang riak client, and I 
> didn't see something as simple as the HTTP use of Links in the demo.
>
> 1 - Are Link walking in Erlang fast & easy ?
> 2 - Is it possible to check fast if A -> B -> A (still in Erlang)? ('->' 
> represents Links)
>
> Thank you for your help !
>
> Morgan.
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

