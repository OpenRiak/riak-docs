---
title: "Re: Mac OS X install error"
description: ""
project: community
lastmod: 2010-06-11T14:57:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00575"
mailinglist_parent_id: "msg00562"
author_name: "Allen Kim"
project_section: "mailinglistitem"
sent_date: 2010-06-11T14:57:56-07:00
---


1. installed tsung
~$sudo port installed tsung
Password:
None of the specified ports are installed.
~$sudo port install tsung
---> Computing dependencies for tsung
---> Fetching tsung
---> Verifying checksum(s) for tsung
---> Extracting tsung
---> Configuring tsung
---> Building tsung
---> Staging tsung into destroot
---> Installing tsung @1.3.1\_0
---> Activating tsung @1.3.1\_0
---> Cleaning tsung
~$sudo port installed tsung
The following ports are currently installed:
 tsung @1.3.1\_0 (active)

2. extract riak
~$tar xvzf riak-0.11.0.tar.gz

3. make rel
==> rel (generate)
ERROR: Failed to generate target from spec: "copy file 
/opt/local/lib/erlang/lib/tsung-1.3.1/ebin/ts\_client\_proxy.beam -> 
/Users/allen/riak-0.11.0/rel/riak/lib/tsung-1.3.1/ebin/ts\_client\_proxy.beam: no 
such file or directory\n"
make: \*\*\* [rel] Error 1

4. verify failure.(as shown above)

5. remove .erlang
~/riak-0.11.0$cd ~
~$mv .erlang .erlangbak
~$cat .erlang
cat: .erlang: No such file or directory

6. repeat 2 and 3
~$rm -rf riak-0.11.0
~$tar xvzf riak-0.11.0.tar.gz
~$cd riak-0.11.0
~/riak-0.11.0$make rel
abort: There is no Mercurial repository here (.hg not found)
./rebar get-deps
==> luke (get-deps)
...
Compiled src/riak\_object.erl
WARNING: 'generate' command does not apply to directory 
/Users/allen/riak-0.11.0/apps/riak\_kv
==> rel (compile)
==> rel (generate)
ERROR: Failed to generate target from spec: "copy file 
/opt/local/lib/erlang/lib/tsung-1.3.1/ebin/ts\_client\_proxy.beam -> 
/Users/allen/riak-0.11.0/rel/riak/lib/tsung-1.3.1/ebin/ts\_client\_proxy.beam: no 
such file or directory\n"
make: \*\*\* [rel] Error 1

The same error. it is looking for wrong directory again.
For me, tsung is the cause.

Allen kim


On 2010-06-11, at 5:43 PM, Dan Reverri wrote:

Hi Allen,

To accurately verify that ".erlang" is not the cause:
1. install tsung
2. extract riak
3. run make rel
4. verify failure (ERROR: Failed to generate target from spec)
5. Remove the .erlang file
6. Repeat steps 2 and 3

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Fri, Jun 11, 2010 at 2:21 PM, Allen Kim 
> wrote:
Removed ~/.erlang file and it works good!!!!!!

~/riak-0.11.0$ls ~/.erlang
ls: /Users/allen/.erlang: No such file or directory
~/riak-0.11.0$make rel
abort: There is no Mercurial repository here (.hg not found)
./rebar get-deps
==> luke (get-deps)
==> mochiweb (get-deps)
==> webmachine (get-deps)
...
Compiled src/riak\_kv\_wm\_stats.erl
Compiled src/riak\_kv\_wm\_raw.erl
Compiled src/riak\_object.erl
WARNING: 'generate' command does not apply to directory 
/Users/allen/riak-0.11.0/apps/riak\_kv
==> rel (compile)
==> rel (generate)
==> riak-0.11.0 (compile)
WARNING: 'generate' command does not apply to directory /Users/allen/riak-0.11.0

To verify it, put .erlang file back
~$cat ~/.erlang
code:load\_abs("/Users/allen/user\_default").
~$tar xvzf riak-0.11.0.tar.gz
~/riak-0.11.0$make rel
abort: There is no Mercurial repository here (.hg not found)
./rebar get-deps
==> luke (get-deps)
==> mochiweb (get-deps)
==> webmachine (get-deps)
...
Compiled src/riak\_kv\_wm\_link\_walker.erl
Compiled src/riak\_object.erl
Compiled src/riak\_kv\_wm\_raw.erl
WARNING: 'generate' command does not apply to directory 
/Users/allen/riak-0.11.0/apps/riak\_kv
==> rel (compile)
==> rel (generate)
==> riak-0.11.0 (compile)
WARNING: 'generate' command does not apply to directory /Users/allen/riak-0.11.0

Huh?.. it's the same as before. (.erlang is NOT the cause)

I might have been mistaken. Sorry about the misleading then.

1. I had R13B02 or R13B03(not sure) with tsung installed
2. I installed erlang R13B04, installed riak, and failed because of tsung.
3. So I tried to install tsung, but failed
4. I removed all tsung files manually and ran 'sudo port uninstall tsung && 
sudo port clean tsung'
5. Checked all tsung files are gone, and installed riak(it worked)

Hope this helps.

Allen Kim

On 2010-06-11, at 4:47 PM, Dan Reverri wrote:

Hi Allen,

Can you try temporarily removing the ".erlang" file in your home directory and 
testing the build again?

We have not been able to reproduce the error with tsung installed via port.

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Fri, Jun 11, 2010 at 1:26 PM, Allen Kim 
> wrote:
Dan,

try "sudo port install tsung", it will install all tsung modules into your 
erlang lib directory.
I think it will reproduce the error.(hope so)

Yes, I have .erlang to use lm(),to load all module updated.
Here are the contents

~$cat .erlang
code:load\_abs("/Users/allen/user\_default").
~$

Here is my path to erl.

/opt/local$which erl
/opt/local/bin/erl
/opt/local$ls -al /opt/local/bin/er\*
-rwxr-xr-x 2 root admin 3882 8 Dec 2009 /opt/local/bin/erb
lrwxr-xr-x 1 root admin 21 4 Jun 18:11 /opt/local/bin/erl -> 
../lib/erlang/bin/erl
lrwxr-xr-x 1 root admin 22 4 Jun 18:11 /opt/local/bin/erlc -> 
../lib/erlang/bin/erlc

erlang directory is not a sym link
/opt/local/lib$ls -al
total 460128
drwxr-xr-x 719 root admin 24446 11 Jun 14:18 .
drwxr-xr-x 15 root admin 510 4 Jan 14:10 ..
-rw-r--r-- 1 root admin 0 28 Sep 2009 .turd\_MacPorts
drwxr-xr-x 4 root admin 136 4 Jan 16:02 ImageMagick-6.5.8
drwxr-xr-x 3 root admin 102 4 Jun 18:28 X11
drwxr-xr-x 3 root admin 102 20 Oct 2009 ao
drwxr-xr-x 14 root admin 476 20 Oct 2009 apr-util-1
-rw-r--r-- 2 root admin 8367 4 Jun 17:50 apr.exp
-rw-r--r-- 2 root admin 5165 20 Oct 2009 aprutil.exp
-rwxr-xr-x 2 root admin 9040 4 Jun 18:16 bindtextdomain.so
drwxr-xr-x 3 root admin 102 3 Dec 2009 bjam
drwxr-xr-x 21 root admin 714 4 Jan 14:42 db46
drwxr-xr-x 3 root admin 102 21 Oct 2009 dbus-1.0
drwxr-xr-x 12 root admin 408 3 Dec 2009 engines
drwxr-xr-x 14 root admin 476 4 Jun 18:11 erlang
...

Let me know if you need more.

Allen kim


On 2010-06-11, at 2:54 PM, Dan Reverri wrote:

Hi Allen,

Is there anything of note about your system that might help us reproduce the 
build error here? Are you using an symlinks in your Erlang libs folder? Do you 
have a ".erlang" file defined in your home directory?

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Fri, Jun 11, 2010 at 11:35 AM, Sean Cribbs 
> wrote:
Allen,

The best answer we've come up with internally is that reltool (what's used 
internally to rebar for part of the build process) tends to follow certain 
symlinks blindly. If it's not critical for you to stay on Riak tip, you should 
be able to use the binary packages without a hitch.

Sean Cribbs >
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Jun 11, 2010, at 2:29 PM, Allen Kim wrote:

I removed tsung
$>sudo port uninstall tsung
$>sudo port clean tsung

then, ran "make rel" command, it WORKS

...
Compiled src/riak\_kv\_wm\_stats.erl
Compiled src/riak\_kv\_wm\_link\_walker.erl
Compiled src/riak\_object.erl
Compiled src/riak\_kv\_wm\_raw.erl
WARNING: 'generate' command does not apply to directory 
/Users/allen/riak-0.11.0/apps/riak\_kv
==> rel (compile)
==> rel (generate)
==> riak-0.11.0 (compile)
WARNING: 'generate' command does not apply to directory /Users/allen/riak-0.11.0
~/riak-0.11.0$

However when I installed tsung(which installs tsung, tsung\_recorder, and 
tsung\_controller) again, a part of erlang, it does not work(the same error)

I personally use tsung for load testing and riak will be the perfect example of 
it, and I will need to install tsung later.

I will not use tsung for a while until you fix it, and please let me know when 
it is fixed.

Thanks for your hard work

Allen Kim

On 2010-06-11, at 1:40 PM, Dan Reverri wrote:

Hi Allen,

When generating a release package with rebar the intention is to create a fully 
independent release package that runs without any external dependencies. During 
the release generation rebar will analyze the specification of an application 
to determine dependencies. The tool will then collect all the dependencies 
(including those from the system level Erlang installation) and package them 
into a release. Tsung is not part of the riak dependency specification and 
should not be pulled into the release. My guess is that macports has configured 
Erlang in such a way that the Tsung library is included in all releases. We 
have to look into this a bit further and try to reproduce the issue locally.

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Fri, Jun 11, 2010 at 10:11 AM, Allen Kim 
> wrote:
If it helps, ts\_client\_proxy.beam file is not in tsung-1.3.1 folder but in 
tsung\_recorder-1.3.1, Don't know how to fix it though

/opt/local/lib/erlang/lib/tsung\_recorder-1.3.1/ebin$ls
ts\_client\_proxy.beam ts\_client\_proxy\_sup.beam ts\_proxy\_http.beam 
ts\_proxy\_listener.beam ts\_proxy\_pgsql.beam ts\_proxy\_recorder.beam 
ts\_proxy\_webdav.beam ts\_recorder\_sup.beam tsung\_recorder.app 
tsung\_recorder.beam

Allen Kim

==> rel (generate)
ERROR: Failed to generate target from spec: "copy file 
/opt/local/lib/erlang/lib/tsung-1.3.1/ebin/ts\_client\_proxy.beam -> 
/Users/allen/riak-0.11.0/rel/riak/lib/tsung-1.3.1/ebin/ts\_client\_proxy.beam: no 
such file or directory\n"

On 2010-06-11, at 12:31 PM, Allen Kim wrote:

information of erlang installed if helps

/opt/local/lib/erlang/bin$port installed erlang
The following ports are currently installed:
 erlang @R13B02\_2+darwin\_10
 erlang @R13B02\_3+darwin\_10
 erlang @R13B03\_0+darwin\_10
 erlang @R13B04\_0+darwin\_10 (active)

On 2010-06-11, at 12:20 PM, Dan Reverri wrote:

Hi Allen,

Sorry for not being more clear. You have to run the generate command against a 
compiled folder.
make all
./rebar -v generate

Thanks,
Dan

Daniel Reverri >
Developer Advocate
Basho Technologies, Inc.
http://basho.com/




\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com







\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

