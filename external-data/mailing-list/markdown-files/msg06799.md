---
title: "Re: Error: HTTP error 500: Error:"
description: ""
project: community
lastmod: 2012-03-01T01:17:48-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06799"
mailinglist_parent_id: "msg06798"
author_name: "Norman Khine"
project_section: "mailinglistitem"
sent_date: 2012-03-01T01:17:48-08:00
---


hi thanks for the reply, that was the issue, the search was put to false.

On Thu, Mar 1, 2012 at 10:05 AM, Russell Brown  wrote:
>
> On 1 Mar 2012, at 07:52, Norman Khine wrote:
>
> I hade created a bucket 'users', which i then deleted through the
> 'recon' interface (well i deleted all the keys within that bucket),
> but now every time i try to push a new key, i get this error:
>
> { [Error: HTTP error 500: Error:
> {precommit\_fail,{hook\_crashed,{riak\_search\_kv\_hook,precommit,error,badarg}}}
> ] statusCode: 500 }
>
>
> What is the output of
>
>         curl localhost:8098/riak/users


☺ curl localhost:8098/riak/users

 ""
{"props":{"allow\_mult":false,"basic\_quorum":false,"big\_vclock":50,"chash\_keyfun":{"mod":"riak\_core\_util","fun":"chash\_std\_keyfun"},"dw":"quorum","last\_write\_wins":false,"linkfun":{"mod":"riak\_kv\_wm\_link\_walker","fun":"mapreduce\_linkfun"},"n\_val":3,"name":"users","notfound\_ok":true,"old\_vclock":86400,"postcommit":[],"pr":0,"precommit":[{"mod":"riak\_search\_kv\_hook","fun":"precommit"}],"pw":0,"r":"quorum","rw":"quorum","small\_vclock":10,"w":"quorum","young\_vclock":20}}%


>
> ?
>
> Is search enabled? Do you mean for it to be enabled? You can get this error
> if you have the search precommit hook installed but search is not turned on
> in your app.config.
>
> What does it say in your app.config for the setting
>
> %% Riak Search Config
>  {riak\_search, [
>                 %% To enable Search functionality set this 'true'.
>                 {enabled, false}
>                ]},
> ?

Search in my /usr/local/Cellar/riak/1.0.3/libexec/etc/app.config was
set to false, i have changed this to true

>
> Cheers
>
> Russell
>
> here is the code:
>
>
> origin = /\/(.\*)\.gif/.exec(request.url);
> if (origin) {
> var ip = request.connection.remoteAddress;
> city = new City(\_\_dirname + "/GeoLiteCity.dat");
> city.lookup(ip, function(err, location) {
> obj = {
> city: location.city
>                                                      , latitude:
> location.latitude
>                                                      , longitude:
> location.longitude
>                                                      , ip: ip
>                                              , timestamp: time
> }
> self.bayeux.getClient().publish('/stat', obj);
> // write to riak cluster
> db.save('users', 'username', obj, { index: {timestamp: time} });
> console.log('was saved in the riak cluster');
>
> if i change the bucket name 'users' to anything else this works, even
> if i then delete all the records from that ne bucket, i can still add
> records to that new named bucket. the only problem is with this
> 'users' bucket.
>
> is there a way to check what is going on and clean up the database?
>
>
> What is the output of
>
>         curl localhost:8098/riak/users
>
> ?
>
> Is there a value in the 'precommit' array? I don't know if recon would add a
> hook to the bucket (or if you did?), if there are hooks that you don't want
> it, you can remove all hooks with a post like
>
>      curl -X PUT localhost:8098/riak/b -d'{"props": {"precommit":[]}}'
> -H'Content-Type: application/json'
>
> Cheers
>
> Russell
>
>
> i have a single node on my local machine, running OSX.
>
> thanks
>
> norman
>
> --
> %>>> "".join( [ {'\*':'@','^':'.'}.get(c,None) or
> chr(97+(ord(c)-83)%26) for c in ",adym,\*)&uzq^zqf" ] )
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>



-- 
%>>> "".join( [ {'\*':'@','^':'.'}.get(c,None) or
chr(97+(ord(c)-83)%26) for c in ",adym,\*)&uzq^zqf" ] )

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

