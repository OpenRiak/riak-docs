---
title: "Re: Riak search q.op=and misunderstanding"
description: ""
project: community
lastmod: 2012-07-25T06:57:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08057"
mailinglist_parent_id: "msg08014"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2012-07-25T06:57:44-07:00
---


Mick,

This is a bug. At one time I fixed it but it had to be reverted because it
broke rolling upgrade [1]. It has languished ever since. To work around
explicitly put AND in the query. E.g.
q=nickname:Ring%20AND%20breed:Shepherd

-Z

[1]:
https://github.com/basho/riak\_search/commit/67ca6efca7cd0a92c4d7e323aa3fd7a37df27315

On Sat, Jul 21, 2012 at 9:13 AM, Mick Brooks  wrote:

> Hi,
>
> I'm playing with Riak thanks to working through the Seven DBs in Seven
> Weeks book: <
> http://pragprog.com/book/rwdata/seven-databases-in-seven-weeks>.
> One of the examples has left me confused, and I wondered if anyone could
> spot where I'm going wrong.
>
> I've got a dev cluster running Riak 1.1.4, and have turned on Riak search.
> I've
> created a bucket named new\_animals and added the following 3 objects:
>
> $ curl -X PUT http://localhost:8091/riak/new\_animals/dragon \
> -H "Content-Type: application/json" \
> -d '{"nickname" : "Dragon", "breed" : "Briard", "score" : 1 }'
> $ curl -X PUT http://localhost:8091/riak/new\_animals/ace \
> -H "Content-Type: application/json" \
> -d '{"nickname" : "The Wonder Dog", "breed" : "German Shepherd",
> "score" : 3 }'
> $ curl -X PUT http://localhost:8091/riak/new\_animals/rtt \
> -H "Content-Type: application/json" \
> -d '{"nickname" : "Rin Tin Tin", "breed" : "German Shepherd", "score" :
> 4 }'
>
> Now I try to search using the and operator:
>
> $ curl '
> http://localhost:8091/solr/new\_animals/select?q=nickname:Rin%20breed:Shepherd&q.op=and
> '
> xml version="1.0" encoding="UTF-8"?
> 
> 
> 0
> 4
> 
> on
> 0
> nickname:Rin breed:Shepherd
> and
> 
> value
> standard
> 1.1
> 2
> 
> 
> 
> 
> rtt
> 
> German Shepherd
> 
> Rin Tin Tin
> 
> 4
> 
> 
> 
> ace
> 
> German Shepherd
> 
> The Wonder Dog
> 
> 3
> 
> 
> 
> 
>
> I expected only one result to match, but have two. 'ace' should fail
> to match the nickname:Rin term, so does it make sense that it's returned
> for this query?
>
> Cheers,
>
> Mick
>
> --
> Mick Brooks
> ACCU Membership Secretary - accumembers...@accu.org
> http://www.accu.org/ - Professionalism in Programming
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

