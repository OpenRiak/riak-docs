---
title: "Re: riak 2 - how much space is needed for online resizing?"
description: ""
project: community
lastmod: 2014-09-02T14:18:36-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14836"
mailinglist_parent_id: "msg14833"
author_name: "Jordan West"
project_section: "mailinglistitem"
sent_date: 2014-09-02T14:18:36-07:00
---


Hi Max,

A ring resize won't make things much better. It is intended to change the
number of partitions from 64, in your case, to 32 or 256, for example.
While these rings sizes may have better distributions with 5 nodes they
will not be perfect. The quickest solution using the existing cluster and
settings would be to add 3 nodes (for a total of 8) or remove one (for a
total of 4) -- we don't suggest the latter, you can read more about why in
[1], but decide based on your application's needs. There are a few other
options but they are more complicated. Somewhat related, since you are
using a pre-build, is this development/test data? Do you have the option of
re-building the cluster? If you would like to stick with 5 nodes and can
re-build the cluster from scratch, another alternative is to try "claim\_v3"
(the default is v2). See wants\_claim\_fun and choose\_claim\_fun in [2].
You'll want to set these to wants\_claim\_v3 and choose\_claim\_v3,
repsectively, in the riak\_core section of your advanced.config. It may
result in a better, albeit not perfect, balance.

To answer your original question about capacity, a conservative rule is,
below 50% capacity on every node.

I would also suggest upgrading to a more recent build.

Jordan


[1] http://basho.com/why-your-riak-cluster-should-have-at-least-five-nodes/
[2]
http://docs.basho.com/riak/1.4.10/ops/advanced/configs/configuration-files/


On Tue, Sep 2, 2014 at 5:21 AM, Max Vernimmen 
wrote:

> Hi,
>
>
>
> We have 5 riak nodes running riak-2.0.0pre20-1.el6.x86\_64 with a ringsize
> of 64. We would like to do a ring resize because the distribution of
> content is very uneven (64/5 has a left over of 4 parts that all end up on
> the same node). The documentation says riak-2 can do this online (
> http://docs.basho.com/riak/2.0.0/ops/advanced/ring-resizing/) and warns
> 'Make sure that you have sufficient storage to complete the resize
> operation'.
>
>
>
> Could anyone tell me how much is â€˜sufficientâ€™?
>
> And in addition, some of the nodes in the cluster have more free space
> available than other nodes (some are at 40% used disk, others at 60%). Is
> the location of the space important?
>
>
>
> Thank you,
>
>
>
>
>
> Max
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

