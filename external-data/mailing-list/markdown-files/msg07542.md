---
title: "Re: Running riak from launchd?"
description: ""
project: community
lastmod: 2012-05-26T08:34:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07542"
mailinglist_parent_id: "msg07541"
author_name: "Kelly McLaughlin"
project_section: "mailinglistitem"
sent_date: 2012-05-26T08:34:45-07:00
---


Hi Izzy. Use riak start and then you can use riak attach if you need to attach 
a console to the running instance.

Kelly

Sent from my iPhone

On May 26, 2012, at 8:38 AM, Izzy Alanis  wrote:

> Has anyone gotten riak to run under launchd?
> 
> Or, is there a way to run riak in console mode without the interactive
> erlang shell?
> 
> Launchd doesn't want its subprocesses to daemonize themselves. If I
> set up a launch file to run riak in the foreground with "riak
> console", its the same as running "riak console < /dev/null" from the
> command line, and (I'm guessing here:) the interactive shell sees the
> end of stream and ends the console session.
> 
> I expect you'd have the same problem using supervisor as your process
> controller. Supervisor has a pixproxy program to help in these sort of
> situations, but riak is not writing out a pid file either(?!).
> 
> Things I've tried:
> 
> Piping input from /dev/zero is understandably disastrous:
>> riak console < /dev/zero
> 
> Piping input from a fifo just hangs:
>> mkfifo < /tmp/myfifo
>> riak console < /tmp/myfifo
> 
> This seems to mostly work (or might really work well with some extra
> bash scripting):
>> mkfifo < /tmp/myfifo
>> echo > /tmp/myfifo &
>> riak console < /tmp/myfifo
> I have that last one in a wrapper script. I could add the bells and
> whistles to make the fifo a random filename and make sure it gets
> cleaned up after the script end, etc, etc, etc.
> 
> Here's my launch config (below), FYI. I'm running it out of
> /Library/LaunchDaemons, and errang \*really\* wants a HOME environment
> variable which is a gotcha for anybody else out there!:
> 
> Anybody else get something like this working?
> 
> xml version="1.0" encoding="UTF-8"?
>  "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
> 
> 
> Label
> com.basho.riak
> OnDemand
> 
> Program
> /opt/riak/bin/riak-wrapper
> EnvironmentVariables
> 
> HOME
> /opt/riak/
> 
> StandardOutPath
> /opt/riak/log/console.log
> StandardErrorPath
> /opt/riak/log/error.log
> SoftResourceLimits
> 
> NumberOfFiles
> 4096
> 
> HardResourceLimits
> 
> NumberOfFiles
> 4096
> 
> 
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

