---
title: "Re: Riak Clustering Changes in 1.0"
description: ""
project: community
lastmod: 2011-09-11T11:34:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04656"
mailinglist_parent_id: "msg04647"
author_name: "Joseph Blomstedt"
project_section: "mailinglistitem"
sent_date: 2011-09-11T11:34:56-07:00
---


Rolling upgrades is even simplifier than the approach mentioned by
Sean, although that would work just fine as well.

In short, upgrading one cluster to another should "just work". New
versus legacy gossip is auto-negotiated across a cluster.

The legacy\_gossip setting that Sean mentioned exists to allow users to
force a 1.0 cluster into the legacy behavior.

In general, a cluster of 1.0 nodes will automatically use the new
gossip behavior. If a 0.14.2 node or legacy\_gossip mode joins the
cluster, than the entire cluster will downgrade to the legacy mode. If
the old/legacy nodes lead, the cluster upgrades back to the new mode.
Rolling upgrades work similar. Each 0.14.2 is upgraded to a 1.0 node
one by one, each 1.0 node sees other 0.14.2 nodes in the cluster and
uses legacy gossip, but once the last 0.14.2 node is upgraded, the
cluster switches to the new gossip protocol.

-Joe

On Sat, Sep 10, 2011 at 8:06 AM, Sean Cribbs  wrote:
> Matt,
> Yes you will. The majority of our new/deeply refactored features have
> "legacy" modes. As you do your rolling upgrade, keep legacy\_gossip as true
> on the 1.0 nodes, then when all are up on 1.0, you can switch them over to
> using the new gossip protocol in a similar fashion. Â Joe can comment on
> whether it is necessary to restart them to change the gossip protocol.
> On Sat, Sep 10, 2011 at 3:40 AM, Matt Ranney  wrote:
>>
>> These new clustering changes sounds excellent.
>> Will we still be able to do a rolling upgrade from 0.14.2?
>>
>> On Wed, Sep 7, 2011 at 5:12 PM, Joseph Blomstedt  wrote:
>>>
>>> Given that 1.0 prerelease packages are now available, I wanted to
>>> mention some changes to Riak's clustering capabilities in 1.0. In
>>> particular, there are some subtle semantic differences in the
>>> riak-admin commands. More complete docs will be updated in the near
>>> future, but I hope a quick email suffices for now.
>>
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>
>
>
> --
> Sean Cribbs 
> Developer Advocate
> Basho Technologies, Inc.
> http://www.basho.com/
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>



-- 
Joseph Blomstedt 
Software Engineer
Basho Technologies, Inc.
http://www.basho.com/

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

