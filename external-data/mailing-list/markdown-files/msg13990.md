---
title: "Re: very slow write speed to riak-cs"
description: ""
project: community
lastmod: 2014-04-03T09:55:51-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13990"
mailinglist_parent_id: "msg13989"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2014-04-03T09:55:51-07:00
---


Hi Anton,

Thanks for letting us know that changing s3cmd settings won't work.

Before you go down the path of changing proxies, could you provide logs
from one instance of your proxy server? They may provide more insight into
what's going on here. In addition, the config and logs from one Riak CS
node would be helpful - the command I gave earlier didn't have the final
arguments:

tar -czf /tmp/riak-cs-$(hostname).tgz /etc/riak-cs /var/log/riak-cs

--
Luke Bakken
CSE
lbak...@basho.com


On Thu, Apr 3, 2014 at 8:51 AM, Anton Khalikov  wrote:

> Luke,
>
> it would be quite difficult to connect directly to riak cs nodes because
> riak cs is set up to run in DMZ so it would take us to reconfigure the
> whole network. So let's assume you are right in your thinking and it is
> proxy (tengine) causing our problems. What would you recommend to use as a
> proxy instead? Original nginx? haproxy? May be specific version of them?
>
> We decided to use tengine because of proxy\_request\_buffering feature which
> bypasses the original nginx behavior and allows it to pass PUT requests
> directly to backend nodes instead of buffering entire request body in a
> temp file before passing it to backend (http://wiki.nginx.org/
> HttpProxyModule). So tengine had twice as fast PUT performance comparing
> to nginx.
>
> About pt\_backlog value: got it, thank you.
>
>
> --
> Best regards
> Anton Khalikov
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

