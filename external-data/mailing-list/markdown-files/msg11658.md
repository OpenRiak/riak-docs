---
title: "Re: Dangling keys/objects after a batch of sequential inserts (for	going on 3 days)"
description: ""
project: community
lastmod: 2013-07-21T04:26:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11658"
mailinglist_parent_id: "msg11656"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2013-07-21T04:26:14-07:00
---


Hi,

On 21 Jul 2013, at 02:09, Siraaj Khandkar  wrote:

> I (sequentially) made 146204 inserts of unique objects to a single bucket. 
> Several secondary indices (most with unique values) were set for each object, 
> one of which was "bucket" = BucketName (to use 2i for listing all keys).

There is a special $bucket index for this already, please see the docs here 
http://docs.basho.com/riak/latest/dev/using/2i/

> 
> 6 of the objects appear to have been lost - they're consistently not found by 
> GETs (by key) and are not found by 2i queries to the indices with unique 
> values.

Are you sure they were inserted? Was there an error during your batch insert?

> 
> However, the "bucket" index search returns them \_sometimes\_.

Oh. Erm. Have you deleted some keys? 2i is essentially an r=1 query.

> 
> Now, I understand there may be a replication lag, but this state has remained 
> for over 3 days now.
> 
> "What is fucked, and why?" :)

Good question.

Could you provide some more details to help me figure it out: How many nodes 
are you running? Can you provide an example of the 2i queries you're running? 
If this is just a dev cluster, can you verify the keys are present / absent 
using either a range 2i $keys query, or a key list, please?

Cheers

Russell

> 
> 
> System info:
> 
> OS: Ubuntu 12.04
> Riak: 1.4
> N: 3
> W: 2
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

