---
title: "Evaluating Riak for search"
description: ""
project: community
lastmod: 2013-12-14T23:57:41-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13246"
author_name: "Cristian Bichis"
project_section: "mailinglistitem"
sent_date: 2013-12-14T23:57:41-08:00

---



Hello,

I have an application which is based on mysql + sphinx (for search) + 
PHP + caching. I am running the mysql part on a multi server 
master-slave and currently sphinx is over one box only.


Currently I have performance issues with writes 
(INSERT/DELETE/UPDATE/REPLACE) on Sphinx and I am looking for an 
alternative on search part. I was checking by 1+ year for some 
alternative solutions (when I didn't had current issues with sphinx) and 
on the short list is Riak and Mark Logic.


The app I am currently handing has about 130-170 search queries (SELECT 
with full text) at peak time (but occasionally can go to 200-500 qps) 
and 5-20 writes per second (INSERT/DELETE/UPDATE/REPLACE). The "bucket" 
size is close to 1 million. I am handling through sphinx mainly the 
search part, with only some non-search queries been sent to Sphinx 
because would take more to run on mysql.


The reads/searches are fine, average is 0.04/query. But currently I am 
having issues because of the way Sphinx is handling writes (it seems 
writes are waiting for all reads to complete), a write can even take 7 
seconds to finish. Beside some momentary optimizations, as the traffic 
goes up I only have the solution to bring more capacity (which is not 
impossible but wont help so much based on my tests, the performance/box 
is decreasing as we add more boxes). So I am ending up checking for Riak 
for search part of the app.


My questions:
\* what capacity/server specs could I start ? Can I start with just one 
box (the app will grow so definetly I will benefit from scaling features 
of Riak at later moment) for the above specs (200+ search queries, 5-20 
write queries, 1 Million bucket size) ?


\* what response times should I expect for search requests ? How about 
the write requests ? I don't have lined up here the queries and the data 
so this is impossible to know but I have no idea now how Riak works on 
performance. As you see for the moment scaling is not my focus. I plan 
to use the bench tool to do some testing but some overall insights still 
are helping.


\* high offset (eg: list 10 items from a search located at offset 
200,000) search requests how are expected to work ?


Thank you!
Cristian
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

