---
title: "Re: Slow bucket create/delete in Riak CS"
description: ""
project: community
lastmod: 2014-08-18T08:06:52-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14693"
mailinglist_parent_id: "msg14655"
author_name: "David Whittington"
project_section: "mailinglistitem"
sent_date: 2014-08-18T08:06:52-07:00
---


Ah, yeah, that was it. I thought GC had already run, but it hadn't. After
GC it went back to normal. Thanks!


On Thu, Aug 14, 2014 at 10:54 PM, Kota Uenishi  wrote:

> David,
>
> I'm sure your version of Riak CS is 1.5.0. At 1.5.0 we fixed bug #475
> by traversing whole bucket in creation and deletion [1]. This traverse
> reads all objects in the bucket, even if it is already deleted.
> Deleted objects remains physically for a while - (called leeway
> seconds) - with it's manifests. Checking bucket before deletion or
> creation reads manifests in a scheduled\_delete state. That's why it's
> slow. If you wait for leeway seconds and make sure GC cleaned up all
> of them, bucket creation or deletion will be as fast as before
> creating many objects.
>
> [2] is a little bit deeper description of how object chunking and
> garbage collection work, for further reading.
>
> [1]
> https://github.com/basho/riak\_cs/blob/release/1.5/RELEASE-NOTES.md#incomplete-multipart-uploads
> [2]
> https://github.com/basho/riak\_cs/wiki/Object-Chunking-and-Garbage-Collection
>
> On Fri, Aug 15, 2014 at 5:12 AM, David Whittington 
> wrote:
> > In testing Riak CS I've noticed that buckets that have had a lot of
> object
> > updates take a while to delete even if they're empty at the time of
> > deletion. Also, after deletion, creating a new bucket with the same name
> > takes a similar amount of time. This effect seems to persist
> indefinitely.
> >
> > Here's an example: https://gist.github.com/djwhitt/9480a1adb52a4b87d246
> >
> > While this isn't a huge problem since the operation ultimately succeeds
> and
> > it doesn't need to be super fast for my use case, it does make me
> curious.
> > What is going on here? Is something not getting cleaned up properly?
> Anyone
> > else experiencing anything like this?
> >
> > --
> > David Whittington
> >
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >
>
>
>
> --
> Kota UENISHI / @kuenishi
> Basho Japan KK
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

