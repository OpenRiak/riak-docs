---
title: "Problem with listkeys operation in Riak 1.0"
description: ""
project: community
lastmod: 2011-10-12T10:04:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05138"
author_name: "Sylvain Niles"
project_section: "mailinglistitem"
sent_date: 2011-10-12T10:04:57-07:00

---


We recently upgraded to 1.0 via a rolling upgrade per the instructions
on basho.com. Since then we've encountered a problem with some of our
data and wanted to wipe the bucket from Ripple but we're seeing an
error that does not make sense:


irb(main):001:0> bucket = Riak::Client.new["pinged\_urls"]
=> #
irb(main):002:0> bucket.keys do |keys|
irb(main):003:1\* keys.each { |k| bucket.delete k }
irb(main):004:1> end
Riak::HTTPFailedRequest: Expected [204, 404] from Riak but received
503. R-value unsatisfied: 1/2


I'm seeing no errors in the logs on either node in our cluster and the
bucket's properties are:

curl http://127.0.0.1:8098/riak/pinged\_urls
{"props":{"allow\_mult":false,"basic\_quorum":true,"big\_vclock":50,"chash\_keyfun":{"mod":"riak\_core\_util","fun":"chash\_std\_keyfun"},"dw":"quorum","last\_write\_wins":false,"linkfun":{"mod":"riak\_kv\_wm\_link\_walker","fun":"mapreduce\_linkfun"},"n\_val":3,"name":"pinged\_urls","notfound\_ok":false,"old\_vclock":86400,"postcommit":[],"pr":0,"precommit":[{"mod":"riak\_search\_kv\_hook","fun":"precommit"}],"pw":0,"r":"quorum","rw":"quorum","search":true,"small\_vclock":10,"w":"quorum","young\_vclock":20}}


And the health of the cluster looks perfect:


bin/riak-admin member\_status
================================= Membership ==================================
Status Ring Pending Node
-------------------------------------------------------------------------------
valid 50.0% -- 'r...@web1.getspontaneous.com'
valid 50.0% -- 'r...@web2.getspontaneous.com'
-------------------------------------------------------------------------------
Valid:2 / Leaving:0 / Exiting:0 / Joining:0 / Down:0


We're really stumped so any pointers on where we can look would be
greatly appreciated!


Thanks,
Sylvain

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

