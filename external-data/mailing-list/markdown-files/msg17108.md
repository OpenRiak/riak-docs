---
title: "Re: Continuous HTTP POSTs to Riak"
description: ""
project: community
lastmod: 2016-03-03T19:08:39-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17108"
mailinglist_parent_id: "msg17107"
author_name: "Qiang Cao"
project_section: "mailinglistitem"
sent_date: 2016-03-03T19:08:39-08:00
---


Thanks, Sargun and Alexander! I tried setting pr, pw, and sloppy\_quorum. It
looks that these help. I got less stale values. But the issue wasn't
completely resolved. I'm using Riak 2.1.2.

-Qiang


On Thu, Mar 3, 2016 at 9:46 PM, Sargun Dhillon  wrote:

> So, if you pass back the vclock while pr=pw=quorum, and sloppy\_quorum
> = false you should get RYOW consistency.
>
> On Thu, Mar 3, 2016 at 6:25 PM, Christopher Mancini 
> wrote:
> > If you don't need strong consistency for all Riak requests, just certain
> > ones, then explore the use of R and N vals that can be passed along with
> the
> > request or on a bucket-type level.
> >
> > On Thu, Mar 3, 2016 at 9:23 PM Mark Schmidt 
> wrote:
> >>
> >> Hi Qiang,
> >>
> >>
> >>
> >> Other more skilled folks can correct me if I am wrong, but I believe you
> >> can enforce strong consistency on your nodes:
> >> http://docs.basho.com/riak/latest/theory/concepts/strong-consistency/
> >>
> >>
> >>
> >> If I recall, you will take a performance hit as all nodes must receive
> the
> >> data.
> >>
> >>
> >>
> >> Thanks,
> >>
> >>
> >>
> >> - Mark Schmidt
> >>
> >>
> >>
> >> From: riak-users [mailto:riak-users-boun...@lists.basho.com] On Behalf
> Of
> >> Qiang Cao
> >> Sent: Thursday, March 03, 2016 6:13 PM
> >> To: Dave King 
> >> Cc: riak-users 
> >> Subject: Re: Continuous HTTP POSTs to Riak
> >>
> >>
> >>
> >> Thanks, Dave! I'm aware of Riak's eventual consistency. I wonder how I
> can
> >> get Riak work in the way as I need. I'm in a situation where I expect
> the
> >> immediate GET reads the value I've just posted. And the GET request
> isn't
> >> sent out until the POST is done.
> >>
> >>
> >>
> >> Thanks,
> >>
> >> -Qiang
> >>
> >>
> >>
> >> On Thu, Mar 3, 2016 at 6:53 PM, Dave King  wrote:
> >>
> >> You need to google 'Eventual consistency'.
> >>
> >>
> >>
> >> - Peace
> >>
> >> Dave
> >>
> >>
> >>
> >>
> >>
> >> On Thu, Mar 3, 2016 at 4:23 PM, Qiang Cao 
> wrote:
> >>
> >> Hi All,
> >>
> >>
> >>
> >> I use Riak as a KV store and send http requests to its REST API to
> update
> >> entries. Instead of using curl, I use Apache HttpClient to send
> requests.
> >>
> >>
> >>
> >> One thing bothering me is that sometimes I find the entry isn't properly
> >> updated after an HTTP POST/PUT. For example, if I do an HTTP GET on the
> same
> >> key immediately after an HTTP POST, the chance is good that I get a
> stale
> >> value. This happens when I continuously POST to a multi-node Riak, and
> some
> >> of the posts target the same key.
> >>
> >>
> >>
> >> Also, I find I don't have this issue if I use a single-node Riak. So I
> >> think something wasn't correct with my multi-node Riak cluster (I set
> >> "allow\_mult" to false). Any thoughts?
> >>
> >>
> >>
> >> Thanks in advance!
> >>
> >>
> >>
> >> Qiang
> >>
> >>
> >>
> >> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> >> riak-users mailing list
> >> riak-users@lists.basho.com
> >> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >>
> >>
> >>
> >>
> >>
> >> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> >> riak-users mailing list
> >> riak-users@lists.basho.com
> >> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >
> > --
> > Sincerely,
> >
> > Christopher Mancini
> > -----------------------------
> >
> > employee = {
> > purpose: solve problems with code,
> > phone: 7164625591,
> > email: cmanc...@basho.com,
> > github: http://www.github.com/christophermancini
> > }
> >
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

