---
title: "Re: Questions about ring state management."
description: ""
project: community
lastmod: 2010-08-09T15:08:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00862"
mailinglist_parent_id: "msg00834"
author_name: "Dan Reverri"
project_section: "mailinglistitem"
sent_date: 2010-08-09T15:08:14-07:00
---


Hi Mark,

The option "default\_gossip\_seed" is not a Riak option; at least not one I
have seen. You are correct that it does not appear in the Riak source code.
If this was an option it has been removed.

To form a Riak cluster you must tell a node about another node in the
cluster using the "riak-admin join" command. A node only needs to be told
about one other node in a cluster; Riak learns about other cluster nodes via
gossip.The seeding process would look as follows:
riak start
riak-admin join ot...@node


Currently, removing a node must be done via Erlang. Bug 571 has been filed
to request a "remove" command:
https://issues.basho.com/show\_bug.cgi?id=571

Removing a node via Erlang:
1. Attach to a riak node
riak attach

2. Get a local client
{ok, C} = riak:local\_client().

3. Remove the node
C:remove\_from\_cluster('n...@host').

4 Detach from the node using CTRL+D
^D


Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Tue, Aug 3, 2010 at 9:58 AM, Mark Anderson  wrote:

> I'm playing around with setting up and tearing down clusters and I had
> a few questions:
>
> Looking at the chef recipe for riak sets an option in riak\_core
> 'default\_gossip\_seed'; apparently this is intended to cue a newly spun
> up node where to look to join the cluster. But for the life of me I
> can't get it to work, and I can't find any mention of it in the
> source.
> What's the recommended way to seed a freshly spun up node with a seed
> machine?
>
> I'm also trying to figure out how to evict a node from the ring. If
> you have access to the machine, you can do 'riak-admin leave' but what
> can you do if you don't? I'm imagining a usage pattern where you are
> running a bunch of vhosted machines. One dies, and you spin up a new
> machine, with a new node name to replace it. How do you get that old
> machine out of the ring?
>
> The natural way to name nodes in ec2 is to do something like
> r...@ec2\_internal\_ip. But once an instance is terminated, there is no
> way to get that ip back. I suspect I'm doing things wrong here, so
> suggestions for better configuration patterns are very welcome.
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

