---
title: "Re: Riak Search Issue"
description: ""
project: community
lastmod: 2014-08-18T22:47:23-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14728"
author_name: "tele"
project_section: "mailinglistitem"
sent_date: 2014-08-18T22:47:23-07:00

---


Hi,

I had the same issue while playing with the latest python client and
riak search 2.0 but i checked the code and sorted it out.
In the new documentation fulltext\_search() is not mentioned, it uses
search()
http://basho.github.io/riak-python-client/query.html#fulltext-search

If you dig in the code basically search() calls fulltext\_search()

 def search(self, query, \*\*params):
 """
 Queries a search index over objects in this bucket/index. See
 :meth:`RiakClient.fulltext\_search()
 ` for more details.
 """
 return self.\_client.fulltext\_search(self.name, query, \*\*params)

As you can see the first arg of fulltext\_search uses as index
self.name. In this case self.name is the name of the bucket because the
method is implemented on the Bucket object.

So if you add an index on the bucket that has a different name from the
bucket and you use search(), it will give you the error of index not
found. This is because the name of the index has to match with the name
of the bucket.

I believe it's worth to mention it in the documentation, so
people don't freak out when following instructions and getting an index
error from search() :)

Or maybe just add back the possibility of specifying the index on the
search(). Up to you

:tele



On Mon, 18 Aug 2014 23:38:51 +0200
Alex De la rosa  wrote:

> Hi Eric,
> 
> Cool! This new syntax really worked :) even on different bucket
> names :) It has been driving me crazy all day... haha, glad is
> finally sorted out.
> 
> PYTHON:
> results = client.fulltext\_search('famoso', 'name\_s:Lio\*')
> print results
> 
> OUTPUT:
> {'num\_found': 2, 'max\_score': 1.0, 'docs': [{u'age\_i': u'30',
> u'name\_s': u'Lionel', u'\_yz\_rk': u'lionel', u'\_yz\_rb': u'fcb',
> u'score': u'1.00000000000000000000e+00', u'leader\_b': u'true',
> u'\_yz\_id': u'1\*futbolistas\*fcb\*lionel\*59', u'\_yz\_rt':
> u'futbolistas'}, {u'age\_i': u'30', u'name\_s': u'Lionel', u'\_yz\_rk':
> u'lionel', u'\_yz\_rb': u'famoso', u'score':
> u'1.00000000000000000000e+00', u'leader\_b': u'true', u'\_yz\_id':
> u'1\*futbolistas\*famoso\*lionel\*8', u'\_yz\_rt': u'futbolistas'}]}
> 
> Thanks!
> Alex
> 
> 
> On Mon, Aug 18, 2014 at 11:33 PM, Eric Redmond 
> wrote:
> 
> > Alex,
> >
> > I was mistaken about the bucket search. The documentation is wrong,
> > and the API is weirded for backward compatibility reasons. You
> > should be able to search by index name this way.
> >
> > client.fulltext\_search(index, query, \*\*params)
> >
> > We'll update the docs to match.
> >
> > Eric
> >
> >
> > On Aug 18, 2014, at 2:29 PM, Alex De la rosa
> >  wrote:
> >
> > Hi Sean,
> >
> > Yeah, I opted to follow that pattern on my latest attempt as I see
> > it more clear that the way in the documentation. Still same issue
> > although with Eric we saw it works fine when index and bucket has
> > the same name.
> >
> > Thanks!
> > Alex
> >
> >
> > On Mon, Aug 18, 2014 at 11:27 PM, Sean Cribbs 
> > wrote:
> >
> >> Don't use bucket with 2 arguments, use
> >> client.bucket\_type('futbolistas').bucket('fcb'). This makes your
> >> intent more clear. The 2-arity version of bucket() was for
> >> backwards-compatibility.
> >
> >
> >
> >


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

