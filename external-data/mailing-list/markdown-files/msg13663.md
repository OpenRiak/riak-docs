---
title: "Re: RIAK 1.4.6 - Mass key deletion"
description: ""
project: community
lastmod: 2014-02-18T08:12:18-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13663"
mailinglist_parent_id: "msg13662"
author_name: "Edgar Veiga"
project_section: "mailinglistitem"
sent_date: 2014-02-18T08:12:18-08:00
---


The only/main purpose is to free disk space..

I was a little bit concerned regarding this operation, but now with your
feedback I'm tending to don't do nothing, I can't risk the growing of
space...
Regarding the overhead I think that with a tight throttling system I could
control and avoid overloading the cluster.

Mixed feelings :S



On 18 February 2014 15:45, Matthew Von-Maszewski  wrote:

> Edgar,
>
> The first "concern" I have is that leveldb's delete does not free disk
> space. Others have executed mass delete operations only to discover they
> are now using more disk space instead of less. Here is a discussion of the
> problem:
>
> https://github.com/basho/leveldb/wiki/mv-aggressive-delete
>
> The link also describes Riak's database operation overhead. This is a
> second "concern". You will need to carefully throttle your delete rate or
> the overhead will likely impact your production throughput.
>
> We have new code to help quicken the actual purge of deleted data in Riak
> 2.0. But that release is not quite ready for production usage.
>
>
> What do you hope to achieve by the mass delete?
>
> Matthew
>
>
>
>
> On Feb 18, 2014, at 10:29 AM, Edgar Veiga  wrote:
>
> Sorry, forgot that info!
>
> It's leveldb.
>
> Best regards
>
>
> On 18 February 2014 15:27, Matthew Von-Maszewski wrote:
>
>> Which Riak backend are you using: bitcask, leveldb, multi?
>>
>> Matthew
>>
>>
>> On Feb 18, 2014, at 10:17 AM, Edgar Veiga  wrote:
>>
>> > Hi all!
>> >
>> > I have a fairly trivial question regarding mass deletion on a riak
>> cluster, but firstly let me give you just some context. My cluster is
>> running with riak 1.4.6 on 6 machines with a ring of 256 nodes and 1Tb ssd
>> disks.
>> >
>> > I need to execute a massive object deletion on a bucket, I'm talking of
>> ~1 billion keys (The object average size is ~1Kb). I will not retrive the
>> keys from riak because a I have a file with all of them. I'll just start a
>> script that reads them from the file and triggers an HTTP DELETE for each
>> one.
>> > The cluster will continue running on production with a quite high load
>> serving all other applications, while running this deletion.
>> >
>> > My question is simple, do I need to have any kind of extra concerns
>> regarding this action? Do you advise me on taking special attention to any
>> kind of metrics regarding riak or event the servers where it's running?
>> >
>> > Best regards!
>> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> > riak-users mailing list
>> > riak-users@lists.basho.com
>> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>>
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

