---
title: "Re: Test Environment"
description: ""
project: community
lastmod: 2012-12-20T08:08:10-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09651"
mailinglist_parent_id: "msg09648"
author_name: "Evan Vigil-McClanahan"
project_section: "mailinglistitem"
sent_date: 2012-12-20T08:08:10-08:00
---


To get the owner of a particular partition in a given cluster, attach
to one of its nodes (always be sure to disconnect with control-d!) or
use a remsh, then enter the following:

{ok, Ring} = riak\_core\_ring\_manager:get\_my\_ring().
riak\_core\_ring:index\_owner(Ring, 0).

replacing 0 here with the index identifier for the partition that
you're interested in.

On Thu, Dec 20, 2012 at 10:21 AM, Shane McEwan  wrote:
> G'day!
>
> I'm currently trying to set up a test environment mimicking our production
> environment by copying the leveldb directory from each production node onto
> the corresponding test node. By carefully matching the node's partition
> ownerships to determine where I copy the data I can start up Riak on the
> test nodes and not have any partition handoffs and it seems like I have a
> working snapshot of my production data.
>
> The questions I have are:
>
> 1: Is copying the leveldb directory from one cluster node to a node in a
> completely different cluster a sane thing to do? It seems to work. I don't
> get any errors in the Riak or LevelDB logs and my data is there when I query
> it.
>
> 2: Is there a simple way to determine which node owns which LevelDB
> partition? Currently I just guess. It looks like partitions are allocated to
> nodes alphabetically by node name. So I can copy the leveldb directory from
> production node "apple" to test node "pear", production "banana" to test
> "quince" and so on and it works. If I copy "apple" to "quince" and "banana"
> to "pear" then I see partition handoffs between "pear" and "quince" when I
> start Riak. It would be good to know, empirically, that partition
> "1234...789" on "apple" belongs on "pear" and not "quince".
>
> 3: Is there a better way to do this? "riak-admin reip" is deprecated.
> "riak-admin force-replace" doesn't work because the production node doesn't
> exist in the test cluster.
>
> Thanks!
>
> Shane.
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

