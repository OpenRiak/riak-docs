---
title: "FYI: How to do secondary indexing with Riak behind Nginx"
description: ""
project: community
lastmod: 2011-10-06T06:32:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05069"
author_name: "Mårten Gustafson"
project_section: "mailinglistitem"
sent_date: 2011-10-06T06:32:29-07:00

---


Howdy,

= Background

During the Riak 1.0 webinar I played around with Nginx and encountered
a problem with secondary indexing when accessing Riak (over HTTP)
through Nginx. I had a quick chat with Sean about it on IRC[1] and
then I forgot it. The problem is that Nginx won't handle header names
with underscores "properly".

AFAICT it's perfectly legal with underscores in headers according to
RFC 2616[2], I also found a discussion on StackOverflow[3] that came
to the same conclusion.


= Solution

In your nginx.conf in the relevant server-section add the following:
underscores\_in\_headers on;



/mårten.

[1] http://irclogger.com/.riak/2011-09-21 @ 14:33
[2] http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2
[3] http://stackoverflow.com/questions/964519/php-http-post-incorrect-headers

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

