---
title: "Ruby riak client: timeout and retry?"
description: ""
project: community
lastmod: 2013-12-18T13:10:17-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13294"
author_name: "Adam Greene"
project_section: "mailinglistitem"
sent_date: 2013-12-18T13:10:17-08:00

---


hey folks,

We have an issue where one of the nodes is taking > 5 secs to respond to a
ping request. This caused (on our side) haproxy health check to time out,
and... well... a cascade of issues.

So we are fixing that up on our end, but it raised questions about Riak
timeouts on the client side and retry logic. In ruby riak-client 1.4.2 as
well as master, there doesn't seem to be any timeout logic for protocol
buffers. Am I mistaken? A lot of the logic seems to be there
(Riak::Client#recover\_from as well as your extensions to TCPSocket), but
not wired together.

Ideally we could set this globally and then override on a per-call basis
(ie, have ping return in < 250ms or error).

Does a feature like this make sense from your perspective and is it on the
road map? This also may be something that we can help with (in the form of
a PR on github).

Thanks for your time,
adam

-- 

------------------------------
CONFIDENTIALITY NOTICE:
This electronic transmission, and any documents attached hereto, may 
contain confidential and/or privileged information. The information is 
intended only for use by the recipient named above. If you are not the 
named addressee, you are not authorized to read, print, retain, copy or 
disseminate this message or any part of it. If you have received this 
electronic message in error, please notify the sender and delete the 
electronic message. Any disclosure, copying, distribution, or use of the 
contents of information received in error is strictly prohibited.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

