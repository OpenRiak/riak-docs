---
title: "Use of fallback nodes for get requests?"
description: ""
project: community
lastmod: 2010-08-02T10:19:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00824"
author_name: "Nico Meyer"
project_section: "mailinglistitem"
sent_date: 2010-08-02T10:19:22-07:00

---


Hi!

I have a question regarding the use of fallback nodes for get requests.

As I read the code, get requests use fallback nodes if any of the nodes
normally holding the key are not reachable. Also a simple test seemed to
confirm this.
What I mean is, if I do a get request for a key with R=N, and one of the
first N nodes in the preflist is down the request will still succeed.
Why is that? Doesn't that undermine the purpose of seting R to a high
number (specifically setting it to N)? That way a request might succeed
even if all primary nodes responsible for the key are unavailable.

I can see that behaviour might make sense if a node is down for a long
time, but in that case it should just be removed from the cluster.

On a similar note, why is the riak\_kv\_get\_fsm waiting for at least
(N/2)+1 responses, if there are only not\_found responses, effectively
ignoring a smaller R value of the request if the key does not exists?
My guess was, that this also has to do with the use of fallback nodes:
Since the partition will usually be very small on the fallback/handoff
node, it is likely to be the first to answer. So to avoid returning
false not\_found responses, a basic quorum is required.
Am I on the right track here?

The problem is, this is imposed even for the case that all nodes are up.
If one requires very low latency or very high availability (that's why
one uses a small R value in the first place) and does a lot of gets for
non existent keys, riak silently screws you over by raising R for those
keys.

I most likely missed something here, but some ad hoc test I did seem to
be consistent with my understanding of the code.


Thanks,
Nico







\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

