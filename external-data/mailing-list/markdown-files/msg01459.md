---
title: "Date format for Riak Search and its JSON output"
description: ""
project: community
lastmod: 2010-11-04T09:17:33-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01459"
author_name: "Nicolas FouchÃ©"
project_section: "mailinglistitem"
sent_date: 2010-11-04T09:17:33-07:00

---


Hi,

I can't find the right format for dates in Riak Search, for fields
suffixed with "\_dt". I tried rfc822 (e.g. "Thu, 04 Nov 2010 16:02:59
-0000"), and xmlschema/iso8601 (e.g. "2010-11-04T16:07:43Z"), but I
get an {unhandled\_type,date} error when requesting my data in JSON. No
problem with XML.

Here are the HTTP queries to reproduce the error:

# Get the bucket props

GET http://127.0.0.1:8098/riak/models?keys=false
 {"Accept"=>"multipart/mixed, application/json;q=0.7, \*/\*;q=0.5",
"X-Riak-ClientId"=>"A1Q9KQ=="}

# Set the pre-commit search hook

PUT http://127.0.0.1:8098/riak/models
 {"Accept"=>"multipart/mixed, application/json;q=0.7, \*/\*;q=0.5",
"X-Riak-ClientId"=>"A1Q9KQ==", "Content-Type"=>"application/json"}
 
{"props":{"precommit":[{"mod":"riak\_search\_kv\_hook","fun":"precommit"}]}}

# Check if there are any keys to delete

GET http://127.0.0.1:8098/riak/models?props=false&keys=true
 {"Accept"=>"multipart/mixed, application/json;q=0.7, \*/\*;q=0.5",
"X-Riak-ClientId"=>"A1Q9KQ=="}

# Post a JSON document with a date in rfc822 (day-of-week, DD
month-name CCYY hh:mm:ss zone)

POST http://127.0.0.1:8098/riak/models?returnbody=true
 {"Accept"=>"multipart/mixed, application/json;q=0.7, \*/\*;q=0.5",
"X-Riak-ClientId"=>"A1Q9KQ==", "Content-Type"=>"application/json"}
 {"time\_dt":"Thu, 04 Nov 2010 16:02:59 -0000","value":"a value like
any other value","\_type":"Model"}

# Search for the object and request a JSON ouput => KO

GET http://127.0.0.1:8098/solr/models/select?q=value%3Aother&wt=json
 {"Accept"=>"multipart/mixed, application/json;q=0.7, \*/\*;q=0.5",
"X-Riak-ClientId"=>"A1Q9KQ=="}

 500 Internal Server
ErrorInternal Server Error
=====================

The server
encountered an error while processing this
request:  

```
{error,{throw,{unhandled_type,date},
                [{riak_solr_output,convert_type,2},
                 {riak_indexed_doc,'-to_mochijson2/2-lc$^0/1-0-',2},
                 {riak_indexed_doc,'-to_mochijson2/2-lc$^0/1-0-',2},
                 {riak_indexed_doc,to_mochijson2,2},
                 {riak_solr_output,'-json_response/7-lc$^0/1-0-',2},
                 {riak_solr_output,json_response,7},
                 {riak_solr_searcher_wm,to_json,2},

{webmachine_resource,resource_call,3}]}}
```


---

mochiweb+webmachine
web server

[nfo@
17:13:46]~/Code/tests/riak/search

# Search for the object and request a XML ouput => OK

GET http://127.0.0.1:8098/solr/models/select?q=value%3Aother&wt=xml

 xml version="1.0" encoding="UTF-8"?


0
1

on
0
value:other
or
value
standard
1.1
2




67rGKh9XJSZBsPeet0LpdCzi1hz
 
Model
 
Thu, 04 Nov 2010 16:02:59 -0000
 
a value like any other value
 




-- Nicolas

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

