---
title: "Re: riak_core and crashed FSM vnode"
description: ""
project: community
lastmod: 2011-04-06T20:46:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02911"
mailinglist_parent_id: "msg02909"
author_name: "Mike Oxford"
project_section: "mailinglistitem"
sent_date: 2011-04-06T20:46:21-07:00
---


Good call, that was it.

Seems dangerous.

-mox


On Wed, Apr 6, 2011 at 5:24 PM, Ryan Zezeski  wrote:

> Lemme guess, sync\_spawn\_command? If so it sets timeout to infinity so your
> shell process is locked in a receive.
>
> [Sent from my iPhone]
>
> On Apr 6, 2011, at 7:41 PM, Mike Oxford  wrote:
>
> > When you crash a riak\_cord vnode with a console attached, what is the
> expected behaviour (ba-dum, dump)?
> >
> > I ran a riak\_core vnode with some bad code (1/0) to cause a bad arith
> crash in the FSM, initiated from the a console (via node "attach").
> >
> > It crashed as expected, obviously, "\*\* State machine <0.85.0>
> terminating" Good.
> > The attached console was then hung. I could ^C and break out of it...but
> I chose ^D to close the connection. Okay, now reattach.
> >
> > I would expect that the vnode\_master supervisor would have restarted the
> FSM, as it's set to start\_link in the supervisor's init.
> >
> > However, when I reattached it was in a "dead" state. I could not execute
> any command, including "2+2."
> > ^C-q to quit out, reattach, node is down (obviously.)
> >
> > Is this "hang status" because I took it down while a shell was attached,
> or is there something else which may prevent the vnode\_master from
> > restarted the crashed vnode/FSM?
> >
> > Thanks!
> >
> > -mox
> >
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

