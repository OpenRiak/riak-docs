---
title: "Re: Setting up a Riak + Mongrel2 Stack"
description: ""
project: community
lastmod: 2011-08-24T20:16:26-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04454"
mailinglist_parent_id: "msg04452"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-08-24T20:16:26-07:00
---


haproxy is a proxy server, nothing more. It would let your client libraries 
assume that there's only 1 Riak node. That makes life easier because you don't 
have to implement your own load balancing algorithm.

You'll have something like this awful ASCII art:

Application Programming Language
Web Server

HAProxy

Riak Riak Riak Riak Riak Riak â€¦ Riak
---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Aug 24, 2011, at 10:06 AM, trevor stanhope wrote:

> In terms of haproxy, would you say that is that a good platform for web
> service development (ie would I be able code a service site, like
> github, on that platform in place of another webserver) or is that
> purely to handle requests to and from the kvstore? From their
> description it seems that HAProxy would feed connections either to the
> datastore or the webserver (then back through to the datastore) but that
> would mean I'd still be in need of some webserver to host the browser
> based application.
> 
> Being able to easily put together a user service on top of a http
> browser front end is an important (albeit secondary to the mobile
> application) feature that I'd like to test out.
> 
> On Wed, 2011-08-24 at 09:49 -0700, Jeremiah Peschka wrote: 
>> Use whatever language on the server-side that you're comfortable working 
>> with. If you're into Ruby, Ripple is quite mature. The Java client is nice. 
>> I personally like the .NET client (of course I'm slightly biased on that 
>> front). I'd avoid exposing Riak to the open internet, even if it is through 
>> a proxy of some sort. Use a set of APIs so that you can abstract your data 
>> storage away from the calling application. A lot of people are reporting 
>> success with haproxy as the proxy for their Riak instances. 
>> 
>> OJ Reeves put together a bit of a tutorial on haproxy and Riak: 
>> http://buffered.io/2010/09/12/webmachine-erlydtl-and-riak-part-2/
>> 
>> You can drastically improve performance by avoiding the HTTP interface and 
>> using the Protocol Buffers interfaces to Riak, but that depends more on your 
>> language of choice than anything else (some libraries may not support the PB 
>> interface).
>> ---
>> Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
>> Microsoft SQL Server MVP
>> 
>> On Aug 24, 2011, at 9:43 AM, trevor stanhope wrote:
>> 
>>> Beyond using Mongrel2 as a proxy, which webserver might be best suited
>>> to work with Riak.
>>> 
>>> Also, let me give you a basic idea of the system I'm planning to test.
>>> More or less I'm trying to set-up the proxy in front of the riak kvs and
>>> will be making calls to the datastore from a mobile phone application,
>>> that will be doing some basic JSON MPqueries on the system (I'm debating
>>> the merit of link walking for new db information, though I hear that
>>> riak get is faster for objects that are known to exists). These will be
>>> either parsed and returned to the mobile app, or returned to the
>>> webserver to view in an online application.
>>> 
>>> Otherwise, the webserver needs to make simple authenticated writes to
>>> the kvs, mostly to add links to existing objects, which will ideally be
>>> populated into the db via scripts built into the webserver front-end
>>> (but for testing purposes I was planning to use bash scripts, or some
>>> faster equivalent).
>>> 
>>> 
>>> On Wed, 2011-08-24 at 11:38 -0400, Jonathan Langevin wrote:
>>>> I dunno about mongrel, but I know some of the guys at basho have
>>>> personally used a proxy in front of Riak (Matt Heitzenroder is one
>>>> that's mentioned it before, I've CC'd him).
>>>> 
>>>> 
>>>> My thought is that if you can find out the general configuration
>>>> method of how to set up a proxy in front of Riak (such as how it may
>>>> differ from a typical proxy, if there's any special headers you have
>>>> to pass, what settings to apply regarding caching, etc), you could
>>>> then take that info to the Mongrel community and get some specific
>>>> help there for implementing the proxy configuration with the general
>>>> information you've gleamed from the Basho guys.
>>>> 
>>>> 
>>>> 
>>>> Jonathan Langevin
>>>> Systems Administrator
>>>> 
>>>> Loom Inc.
>>>> Wilmington, NC: (910) 241-0433
>>>> - jlange...@loomlearning.com - www.loomlearning.com - Skype: intel352
>>>> 
>>>> 
>>>> 
>>>> On Tue, Aug 23, 2011 at 5:28 PM, trevor stanhope
>>>>  wrote:
>>>> exactly. I'm looking to setup mongrel2 as front-end to a Riak
>>>> kvs.
>>>> 
>>>> 
>>>> On Tue, 2011-08-23 at 14:25 -0400, Jonathan Langevin wrote:
>>>>> Is your intention to use mongrel as a proxy for Riak?
>>>>> 
>>>>> 
>>>>> 
>>>>> Jonathan Langevin
>>>>> Systems Administrator
>>>>> 
>>>>> Loom Inc.
>>>>> Wilmington, NC: (910) 241-0433
>>>>> - jlange...@loomlearning.com - www.loomlearning.com - Skype:
>>>> intel352
>>>>> 
>>>>> 
>>>>> 
>>>>> On Thu, Aug 18, 2011 at 2:01 AM, trevor stanhope
>>>>>  wrote:
>>>>> Hey, I've been probing around for any existing
>>>> examples of a
>>>>> Riak +
>>>>> Mongrel2 stack being deployed and haven't had any
>>>> luck. I'm
>>>>> not familiar
>>>>> with Mongrel2 but it was recommended to me and I'm
>>>> very
>>>>> interested in
>>>>> deploying on that platform. What recommendations or
>>>> who would
>>>>> be best to
>>>>> speak with on that subject?
>>>>> 
>>>>> Best Regards,
>>>>> Trev Stanhope
>>>>> 
>>>>> 
>>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>>>> riak-users mailing list
>>>>> riak-users@lists.basho.com
>>>>> 
>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>> 
>>> 
>>> 
>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>> riak-users mailing list
>>> riak-users@lists.basho.com
>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>> 
> 
> 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

