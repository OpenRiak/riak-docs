---
title: "Re: Poor write performance with Perl"
description: ""
project: community
lastmod: 2011-04-14T08:45:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03031"
mailinglist_parent_id: "msg03030"
author_name: "Robin Edwards"
project_section: "mailinglistitem"
sent_date: 2011-04-14T08:45:29-07:00
---


Hello Brian,

I am one of the maintainers of Net::Riak, the next version will
support the ProtocolBuffers interface,the write performance of this is
naturally a lot faster.

Theres a trial release ready for download, I am planning to release
this to CPAN next week sometime.

https://github.com/downloads/robinedwards/net-riak/Net-Riak-0.15-TRIAL.tar.gz

Net::Riak is currently using LWP::UserAgent which is known to be quite
slow. ( see here
http://ivan-bg.org/2008/08/lwp-vs-httplite-vs-wwwcurl.html )

I have thought about re-engineering it to make use of one of the more
faster HTTP clients. If you have any patches or suggestions in regard
to this I would be interested in hearing them.

https://github.com/robinedwards

R

On 14 April 2011 16:13, Brian Lycett  wrote:
> Hello.
>
> I've set up a three node Riak cluster on some decent hardware as
> specified in the basic cluster setup guide.
>
> I wanted to get a rough idea of performance before tuning the cluster to
> my needs, so I've written a Perl script that inserts a sample set of the
> sort of data I might be using Riak for; a compressed email body of a few
> KB in size each, going into one of two buckets.
> I'm using the Net::Riak Perl module to insert the data.
>
> The trouble is, I'm getting very bad performance.  Using three threads
> and writing to all three nodes at the same time, I might be able to
> insert 100 rows/second.  Using a single thread & server, I'm lucky to
> get 25 rows/second.
>
> The servers themselves are hardly doing anything - barely any CPU load
> or disk activity.
>
> Is this a problem with the Net::Riak module?  Or is there something I
> need to do outside of the basic setup guide that'll vastly improve the
> write speed?
>
> Regards,
>
> Brian
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

