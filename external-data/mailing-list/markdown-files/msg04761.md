---
title: "Re: Problem running riak-1.0.0pre2 list_buckets"
description: ""
project: community
lastmod: 2011-09-16T09:16:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04761"
mailinglist_parent_id: "msg04760"
author_name: "Kelly McLaughlin"
project_section: "mailinglistitem"
sent_date: 2011-09-16T09:16:21-07:00
---


Antoine,

I've been able to reproduce this problem and I've created a bugzilla ticket to 
fix the issue: https://issues.basho.com/show\_bug.cgi?id=1202. Thanks for the 
report and we'll get it fixed asap.

Kelly


On Sep 16, 2011, at 9:29 AM, Antoine wrote:

> Kelly,
> 
> I tried checking out the pre3 tag and with a subset of the data I used 
> before. If I try to add a few keys (simple empty objects) it's ok I can list 
> the buckets. The error arise for example after the following objects have 
> been saved:
> 
> curl -v 
> http://localhost:8098/riak/internal:schemas:schemas/loaded:1316018615776810
> \* About to connect() to localhost port 8098 (#0)
> \* Trying 127.0.0.1... connected
> \* Connected to localhost (127.0.0.1) port 8098 (#0)
> > GET /riak/internal:schemas:schemas/loaded:1316018615776810 HTTP/1.1
> > User-Agent: curl/7.21.3 (x86\_64-pc-linux-gnu) libcurl/7.21.3 OpenSSL/0.9.8o 
> > zlib/1.2.3.4 libidn/1.18
> > Host: localhost:8098
> > Accept: \*/\*
> > 
> < HTTP/1.1 200 OK
> < X-Riak-Vclock: a85hYGBgzGDKBVIcypz/fvoVp8/OYEpkzGNlUH3y/DhfFgA=
> < X-Riak-Meta-user\_id: idmog
> < X-Riak-Meta-source: asusci7-loader
> < X-Riak-Meta-occured\_at: 1316018615776810
> < X-Riak-Meta-noticed\_at: 1316018615776812
> < X-Riak-Meta-mogbox\_id: asusci7
> < X-Riak-Meta-event\_type\_id: loaded
> < X-Riak-Meta-event\_type\_cat: internal
> < X-Riak-Meta-client\_ip: 192.168.0.10
> < X-Riak-Meta-aggr\_schema\_id: schemas
> < X-Riak-Meta-aggr\_id: schemas
> < x-riak-index-occured\_at\_int: 1316018615776810
> < x-riak-index-noticed\_at\_int: 1316018615776812
> < x-riak-index-mogbox\_id\_bin: asusci7
> < x-riak-index-event\_type\_id\_bin: loaded
> < x-riak-index-event\_type\_cat\_bin: internal
> < x-riak-index-aggr\_schema\_id\_bin: schemas
> < x-riak-index-aggr\_id\_bin: schemas
> < Vary: Accept-Encoding
> < Server: MochiWeb/1.1 WebMachine/1.9.0 (participate in the frantic)
> < Link: ; riaktag="aggregate", 
> ; rel="up"
> < Last-Modified: Fri, 16 Sep 2011 15:15:49 GMT
> < ETag: "51h3q7RjTNaHWYpO4P0MJj"
> < Date: Fri, 16 Sep 2011 15:20:17 GMT
> < Content-Type: application/x-erlang-term
> < Content-Length: 353
> 
> and 
> 
> curl -v http://localhost:8098/riak/schemas/schemas
> \* About to connect() to localhost port 8098 (#0)
> \* Trying 127.0.0.1... connected
> \* Connected to localhost (127.0.0.1) port 8098 (#0)
> > GET /riak/schemas/schemas HTTP/1.1
> > User-Agent: curl/7.21.3 (x86\_64-pc-linux-gnu) libcurl/7.21.3 OpenSSL/0.9.8o 
> > zlib/1.2.3.4 libidn/1.18
> > Host: localhost:8098
> > Accept: \*/\*
> > 
> < HTTP/1.1 200 OK
> < X-Riak-Vclock: a85hYGBgzGDKBVIcypz/fvoVp8/IYEpkzGNlUHny/DhfFgA=
> < X-Riak-Meta-$rev: AUEOhgAHc9MSA2MHOvC-M4uLIDc=
> < Vary: Accept-Encoding
> < Server: MochiWeb/1.1 WebMachine/1.9.0 (participate in the frantic)
> < Link: ; rel="up"
> < Last-Modified: Fri, 16 Sep 2011 15:15:48 GMT
> < ETag: "51h3q7RjTNaHWYpO4P0MJj"
> < Date: Fri, 16 Sep 2011 15:22:07 GMT
> < Content-Type: application/json
> < Content-Length: 629
> 
> It was working fine some time ago on master but I cannot remember exactly at 
> which commit.
> I suspect I try to put objects with some badly formatted/configured headers? 
> However I still manage to put and get the objects.
> 
> Regards,
> Antoine
> 
> On 16 September 2011 16:45, Kelly McLaughlin  wrote:
> Antoine,
> 
> I don't have 1.0.0pre2 installed anywhere handy at the moment, but I do have 
> pre3 installed and I tested with eleveldb and it works fine for me. Could you 
> download pre3 and see if that resolves the issue for you? Thanks.
> 
> Kelly
> 
> 
> On Sep 16, 2011, at 8:08 AM, t3h wrote:
> 
> > Hello all,
> >
> > I got these errors after having upgraded to riak-1.0.0pre2 when using list 
> > buckets:
> >
> > {ok, C} = riak:local\_client().
> > C:list\_buckets().
> >
> > gives:
> >
> > 2011-09-16 15:01:32.613 [error] <0.971.0> gen\_server <0.971.0> terminated 
> > with reason: bad return value: {break,{buffer,[ ...part of my list of 
> > buckets... ],#Fun,999,4}}
> > 2011-09-16 15:01:32.711 [error] <0.971.0> CRASH REPORT Process [] with 0 
> > neighbours crashed with reason: bad return value: {break,{buffer,[...other 
> > part of my list of buckets... ],#Fun,999,4}}
> > 2011-09-16 15:01:32.767 [error] <0.427.0> gen\_server <0.427.0> terminated 
> > with reason: bad return value: {break,{buffer,[...other part of my list of 
> > buckets... ],#Fun,999,10}}
> > 2011-09-16 15:01:32.842 [error] <0.427.0> CRASH REPORT Process [] with 0 
> > neighbours crashed with reason: bad return value: {break,{buffer,[...other 
> > part of my list of buckets... ],#Fun,999,10}}
> > 2011-09-16 15:01:32.937 [error] <0.426.0> Supervisor poolboy\_sup had child 
> > riak\_core\_vnode\_worker started with 
> > {riak\_core\_vnode\_worker,start\_link,undefined} at <0.427.0> exit with reason 
> > bad return value: {break,{buffer,[...other part of my list of buckets... 
> > ],#Fun,999,10}} in context child\_terminated
> >
> > and so on for each poolboy supervisor...
> >
> > I tested it against a new empty cluster to be sure not to mix legacy key 
> > listing with new key listing.
> > I use the eleveldb\_backend and objects stored have indexes.
> > I can list the keys in a bucket without any issue.
> > Am I missing something I should have changed upgrading to 1.0.0?
> >
> > As well, riak objects used to have x-riak-index-$bucket and 
> > x-riak-index-$key indexes when I first attempted to use secondary indexes. 
> > I do not see this anymore. What is the reason for this change and should I 
> > be careful not to override any "built-in" indexes when writting my index 
> > headers (using the PBC api)?
> >
> > Thanks,
> > Antoine
> >
> >
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> 
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

