---
title: "Re: Cloning a cluster / copying all cluster data"
description: ""
project: community
lastmod: 2012-09-11T17:18:52-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08508"
mailinglist_parent_id: "msg08507"
author_name: "Matthew Tovbin"
project_section: "mailinglistitem"
sent_date: 2012-09-11T17:18:52-07:00
---


Matt,

We copied all the data key by key, since we used incorrect
'ring\_creation\_size' value.
(
http://riak-users.197444.n3.nabble.com/Cluster-migration-due-to-incorrect-quot-ring-creation-size-quot-value-td4024509.html
)

So, you can use this copy tool - https://github.com/tovbinm/riak-tools,
which proved itself copying 200m+ items for us.

-Matthew



On Tue, Sep 11, 2012 at 5:09 PM, Kresten Krab Thorup wrote:

> Simply copying the riak/data and riak/etc directories should do the trick.
> You can use tar, rsync or simply cp as you feel like, and you can do all
> that while Riak is running at full throttle. The beauty of log structured
> storage (Bitcask, LevelDB, HainoiDB)
>
> At least that's the idea. I seem to remember that there was an issue with
> LevelDB that made basho recommend that you stop a node before doing backup,
> I dunno if that was fixed.
>
> If its just for debugging/dev purposes you can just stop sending requests
> to riak while doing the backup and you should definitively be fine.
>
> Kresten, Trifork
>
> Den 12/09/2012 kl. 01.59 skrev "Matt Black" :
>
> > Hey again list,
> >
> > Can anyone recommend a process for either cloning a cluster, or backing
> up a whole cluster's data to restore elsewhere? This would be incredibly
> useful for creating a new environment to test upgrades and run application
> regression testing.
> >
> > In the dark old days, it would be a simple combination of mysqldump &
> mysql..
> >
> > Cheers
> > Matt
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

