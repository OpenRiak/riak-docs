---
title: "Re: Riak search on an index limited to only 1 bucket"
description: ""
project: community
lastmod: 2016-05-13T12:32:07-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17351"
mailinglist_parent_id: "msg17350"
author_name: "Alex De la rosa"
project_section: "mailinglistitem"
sent_date: 2016-05-13T12:32:07-0700
---


Oh, nice snippets! thanks Drew!

Alex

On Fri, May 13, 2016 at 11:28 PM, Drew Kerrigan  wrote:

> @Alex please kindly take a look at the default solr schema for Riak
> Search. You should have based your custom schema on this (if you've created
> a custom schema):
> https://docs.basho.com/riak/kv/2.1.4/developing/usage/search-schemas/ ->
> https://raw.githubusercontent.com/basho/yokozuna/develop/priv/default\_schema.xml
>
> Specifically take a look at these lines:
> https://github.com/basho/yokozuna/blob/develop/priv/default\_schema.xml#L124-L131
> (This
> is where the \_yz\_rt/rb/rk are defined to be indexed)
>
> And these:
> https://github.com/basho/yokozuna/blob/develop/priv/default\_schema.xml#L101-L104
> -
> These dynamic fields catch all Riak DTs because the solr field names of
> data types automatically get their type name appended to the end (as you
> noticed with your reference to "\*likes\_counter" \*in your own index).
>
> As you can see in the default schema, all sets are automatically indexed
> as multivalued.
>
> Hopefully this info takes away some of the magic for you ;-)
>
> Drew
>
> On Fri, May 13, 2016 at 12:16 PM Vitaly <13vitam...@gmail.com> wrote:
>
>> In general, Riak/Solr is capable of indexing multi-valued properties
>> (i.g. lists). You're right thinking that multiValued = "true" should be
>> used for it. That said, check if it works with your client library (it's
>> Python, isn't it?). I believe it does.
>>
>> Regards,
>> Vitaly
>>
>> On Fri, May 13, 2016 at 9:59 PM, Alex De la rosa > > wrote:
>>
>>> Another question... if I have a set of tags for the elements... like
>>> photo.set['tags'] with things like: ["holidays", "Hawaii", "2016"]... will
>>> it be indexed like this?
>>>
>>> >> multiValued="true" />
>>>
>>> Thanks,
>>> Alex
>>>
>>> On Fri, May 13, 2016 at 10:52 PM, Alex De la rosa <
>>> alex.rosa....@gmail.com> wrote:
>>>
>>>> Oh!! silly me... \*\_yz\_rb\* and \*\_yz\_rt\*... how didn't I think of
>>>> that?...
>>>>
>>>> thanks also for the "\*:\*" tip ; )
>>>>
>>>> Thanks!
>>>> Alex
>>>>
>>>> On Fri, May 13, 2016 at 10:50 PM, Vitaly <13vitam...@gmail.com> wrote:
>>>>
>>>>> Hi Alex,
>>>>>
>>>>> 'likes\_counter:[100 TO \*] AND \_yz\_rb:photos' will limit query results
>>>>> to the photos bucket only. Similarly, "\_yz\_rt" is for a bucket type.
>>>>>
>>>>> Searching for anything in an index can be done with "\*:\*" (any field,
>>>>> any value).
>>>>>
>>>>> Regards,
>>>>> Vitaly
>>>>>
>>>>> On Fri, May 13, 2016 at 9:40 PM, Alex De la rosa <
>>>>> alex.rosa....@gmail.com> wrote:
>>>>>
>>>>>> Hi all,
>>>>>>
>>>>>> Imaging I have an index called "\*posts\*" where I index the following
>>>>>> fields
>>>>>>
>>>>>> 
>>>>>> >>>>> />
>>>>>> >>>>> stored="false" />
>>>>>>
>>>>>> and I reuse the index in 3 buckets: "status", "photos" and
>>>>>> "videos"... then I do the following:
>>>>>>
>>>>>> \*results = client.fulltext\_search('posts', 'likes\_counter:[100 TO
>>>>>> \*]', sort='likes\_counter desc', rows=10)\*
>>>>>>
>>>>>> This query would give me the top10 most liked items (can be statuses,
>>>>>> photos or videos) with at least 100 likes. But how could I limit the
>>>>>> resultset to only the "photos" bucket?? The goal is to get the Top10 
>>>>>> liked
>>>>>> photos without creating an index for itself... as is good to also be able
>>>>>> to query the top10 items in general. Any way to do it?
>>>>>>
>>>>>> In another hand... does somebody know how to do the same query but
>>>>>> without the [100 TO \*]?? I leave it empty?
>>>>>>
>>>>>> \*results = client.fulltext\_search('\*\*posts\*\*', '',
>>>>>> sort='likes\_counter desc', rows=10)\*
>>>>>>
>>>>>> Thanks,
>>>>>> Alex
>>>>>>
>>>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>>>>> riak-users mailing list
>>>>>> riak-users@lists.basho.com
>>>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>>>>
>>>>>>
>>>>>
>>>>
>>>
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

