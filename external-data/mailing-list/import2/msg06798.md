---
title: "Re: Error: HTTP error 500: Error:"
description: ""
project: community
lastmod: 2012-03-01T01:06:01-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06798"
mailinglist_parent_id: "msg06797"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2012-03-01T01:06:01-08:00
---



On 1 Mar 2012, at 07:52, Norman Khine wrote:

> I hade created a bucket 'users', which i then deleted through the
> 'recon' interface (well i deleted all the keys within that bucket),
> but now every time i try to push a new key, i get this error:
> 
> { [Error: HTTP error 500: Error:
> {precommit\_fail,{hook\_crashed,{riak\_search\_kv\_hook,precommit,error,badarg}}}
> ] statusCode: 500 }
> 

What is the output of
 
 curl localhost:8098/riak/users

?

Is search enabled? Do you mean for it to be enabled? You can get this error if 
you have the search precommit hook installed but search is not turned on in 
your app.config.

What does it say in your app.config for the setting 

%% Riak Search Config
 {riak\_search, [
 %% To enable Search functionality set this 'true'.
 {enabled, false}
 ]},
?

Cheers

Russell

> here is the code:
> 
> 
> origin = /\/(.\*)\.gif/.exec(request.url);
> if (origin) {
> var ip = 
> request.connection.remoteAddress;
> city = new City(\_\_dirname + 
> "/GeoLiteCity.dat");
> city.lookup(ip, function(err, location) 
> {
> obj = {
> city: 
> location.city
> , latitude:
> location.latitude
> , longitude:
> location.longitude
> , ip: ip
> , timestamp: time
> }
> 
> self.bayeux.getClient().publish('/stat', obj);
> // write to riak cluster
> db.save('users', 
> 'username', obj, { index: {timestamp: time} });
> console.log('was saved 
> in the riak cluster');
> 
> if i change the bucket name 'users' to anything else this works, even
> if i then delete all the records from that ne bucket, i can still add
> records to that new named bucket. the only problem is with this
> 'users' bucket.
> 
> is there a way to check what is going on and clean up the database?

What is the output of
 
 curl localhost:8098/riak/users

?

Is there a value in the 'precommit' array? I don't know if recon would add a 
hook to the bucket (or if you did?), if there are hooks that you don't want it, 
you can remove all hooks with a post like

 curl -X PUT localhost:8098/riak/b -d'{"props": {"precommit":[]}}' 
-H'Content-Type: application/json'

Cheers

Russell

> 
> i have a single node on my local machine, running OSX.
> 
> thanks
> 
> norman
> 
> -- 
> %>>> "".join( [ {'\*':'@','^':'.'}.get(c,None) or
> chr(97+(ord(c)-83)%26) for c in ",adym,\*)&uzq^zqf" ] )
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

