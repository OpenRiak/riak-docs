---
title: "Re: secondary indexes: how to know the saved indexes for a key?"
description: ""
project: community
lastmod: 2011-10-20T21:39:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05224"
author_name: "Nate Lawson"
project_section: "mailinglistitem"
sent_date: 2011-10-20T21:39:14-07:00
---



On Oct 20, 2011, at 8:35 PM, Antonio Rohman Fernandez wrote:

> Hi All,
> 
> Imagine that I store "some\_item" with key "some\_key" into a "products" bucket 
> with a category "whatever" and a price "300".
> I save it using cURL like this:
> 
> $data = 'some\_item';
> $key = 'some\_key';
> $bucket = 'products';
> curl\_setopt($curl, CURLOPT\_HTTPHEADER, array("x-riak-index-price\_int: 
> 300", "x-riak-index-categroy\_bin: whatever"));
> curl\_setopt($curl, CURLOPT\_URL, 
> "http://{$riakserver}:8098/riak/{$bucket}/{$key}");
> $method = 'PUT';
> [...]
> 
> It works great and "GET 
> http://{$riakserver}:8098/buckets/products/index/category\_bin/whatever" give 
> the correct data:
> 
> {"keys": ["some\_key"]}
> 
> Now my question is... if i want to UPDATE the "price" from 300 to 400 but at 
> this moment i don't know the "category"... how do i retrieve which indexes 
> are set for a key? so I can update "price" and don't lose "category".
> 
> If I do "GET http://{$riakserver}:8098/riak/products/some\_key" I just get 
> "some\_item" that is the data stored in the object, but I'm unable to see its 
> indexes.

I don't know if there's a better way, but you can always store the secondary 
index items in the value for that key. Use JSON or something to aggregate 
multiple items for the value, then looking up the key gives you the price in 
addition to "some\_item".

-Nate


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

