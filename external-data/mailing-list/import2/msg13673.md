---
title: "Re: Couple a few questions about searching"
description: ""
project: community
lastmod: 2014-02-19T13:46:31-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13673"
mailinglist_parent_id: "msg13668"
author_name: "Eric Redmond"
project_section: "mailinglistitem"
sent_date: 2014-02-19T13:46:31-08:00
---



On Feb 15, 2014, at 5:25 AM, EmiNarcissus  wrote:

> Hi,
> 
> I’ve been using riak as backend storage engine since it starts support search 
> syntax, and it really helps me a lot during my development. But still there 
> are quite a lot of questions bothers me a lot and cannot find a answer 
> anywhere.
> 
> 1: During my develop period(single node,single instance, set to n\_val = 1), 
> sometimes my machine crashes during code testing, when I fire up riak again, 
> search index is partly not available, which is what I can expect, any I tried 
> to use repair search index, and most of the repairing were failed(that is 
> also expected), but is there anyway to reindex the full bucket? (I didn’t 
> use search-cmd before, also I didn’t real how does search api implemented in 
> Riak 1, what I know is to index a doc by using search-cmd index  
> , so how do I exactly rebuild the search index for a specific bucket, 
> or how do I rebuild the search index for a specific object by bucket/key ?)

To repair an index in Riak Search prior to 2.0, you can follow this guide.

http://docs.basho.com/riak/latest/ops/running/recovery/repairing-indexes/

If you're looking to repair a specific object prior to 2.0, just reindex it.

If you use 2.0, you don't need to do anything, since indexes auto-repair 
themselves.

> 2: I’ve bean noticed there’s a question asking about riak search will not 
> release the space after the content itself is being deleted, or the bucket 
> search is being disabled, is this bug? have it fixed yet?

Disabling search will not free up index space.

> 3: During my development period I can only test the code on single node, 
> which might increase in the real production environment. so can I get a 
> better expectation on avoid of discrepancy by running 3 riak instances on the 
> single node?(and also, if I deploy it in a cluster, does search index can be 
> destroyed when one of the node is out of response? because I’ve noticed 
> search index is being distributed by term, and have a r\_val set to 1)

Generally speaking, if you can't run 5 physical servers, Riak is probably not a 
good fit for you. Running multiple installations on a single server adds no 
value at all, and is only wasted overhead. The point of running multiple 
servers is to survive crashes.

> 4:Riak will start get into Riak 2.0 which directly use solr as its backend 
> search engine, I do really love to see how does it performs on the real 
> production environment. I also have interest in porting the driver for python 
> support, and indeed I found riak-pb is under development right now. So is all 
> of these questions can be resolved by update to 2.0?

The repair issues are resolved in 2.0, but you still need to run more than1 
physical server, not matter the Riak version. This is not a bug in Riak, it's a 
feature.

> I do really love the speed and convenience what riak brought to me, and since 
> I didn’t read the source yet so my questions might be confusing here, but any 
> suggestions are really appreciated.
> 
> Best,
> Tim Lee
> 
> 
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

