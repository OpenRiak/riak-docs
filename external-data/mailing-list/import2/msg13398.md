---
title: "Re: riak-2.0.0 preview refuses to start when nodename is changed to	the ip or hostname of the machine"
description: ""
project: community
lastmod: 2014-01-17T04:08:52-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13398"
mailinglist_parent_id: "msg13397"
author_name: "John Shen"
project_section: "mailinglistitem"
sent_date: 2014-01-17T04:08:52-08:00
---


Hector, thanks a lot! I figured it out. It does not like the hostname, but
fqdn when I retested. With fqdn it works now.

John Shen


On Fri, Jan 17, 2014 at 3:55 AM, John Shen  wrote:

> Hector, thanks for getting back to me. Sorry I did not make it clear.
>
> If I start clean, with the only difference in riak.conf being listening to
> all ips (0.0.0.0 instead of 127.0.0.1) and nodename changed to the server
> name or ip, it does not work. It is not a matter of old data. If I start
> with the default nodename 127.0.0.1 it works.
>
> It is a fresh install and there was no previous clustering configuration.
> I tried to uninstall riak, remove all riak-related directories, and start
> over, the result is the same.
>
> Please let me know what else I should look at.
>
> Thanks!
>
> John Shen
>
>
> On Thu, Jan 16, 2014 at 3:24 PM, Hector Castro  wrote:
>
>> Hi John,
>>
>> Did you start this Riak instance successfully with `riak@127.0.0.1`
>> before changing `nodename`? If you did, changing the `nodename` can
>> cause a failure similar to what you're seeing.
>>
>> From here your options are:
>>
>> 1. Discard the existing ring metadata by removing the contents of the
>> ring directory. This will require rejoining all nodes into a cluster
>> again.
>> 2. Rename the node using the riak-admin cluster replace command. This
>> will not work if you have previously only started riak with a single
>> node.
>>
>> More details on this (although it references the < 2.0 configuration
>> file format) can be found here:
>>
>> http://docs.basho.com/riak/latest/ops/building/basic-cluster-setup/
>>
>> --
>> Hector
>>
>>
>> On Thu, Jan 16, 2014 at 3:11 PM, John Shen  wrote:
>> > i downloaded riak-2.0.0pre5-1.el6.x86\_64.rpm
>> > riak node starts fine with
>> >
>> > ## Name of the riak node
>> > # this fails
>> > #nodename = riak@myhost.mydomain
>> > #this works
>> > #nodename = riak@127.0.0.1
>> > #this also fails
>> > nodename = riak@10.10.10.10
>> >
>> > the riak processes seem to start still despite the FAILED message, but
>> > riak-admin says node is not running.
>> >
>> > this is RHEL 6
>> >
>> > thanks for any hint as how to debug
>> >
>> > Starting riak: riak failed to start within 15 seconds,
>> > see the output of 'riak console' for more information.
>> > If you want to wait longer, set the environment variable
>> > WAIT\_FOR\_ERLANG to the number of seconds to wait.
>> > [FAILED]
>> >
>> > # ps -ef | grep ria[k]
>> > riak 28771 1 0 11:53 ? 00:00:00
>> > /usr/lib64/riak/erts-5.10.3/bin/epmd -daemon
>> > riak 28779 1 0 11:53 ? 00:00:00
>> > /usr/lib64/riak/erts-5.10.3/bin/run\_erl -daemon /var/run/riak//
>> > /var/log/riak exec /usr/sbin/riak console
>> > riak 28782 28779 2 11:53 pts/1 00:01:36
>> > /usr/lib64/riak/erts-5.10.3/bin/beam.smp -W w -K true -A 64 -P 256000 --
>> > -root /usr/lib64/riak -progname riak -- -home /var/lib/riak -- -boot
>> > /usr/lib64/riak/releases/2.0.0pre5/riak -config
>> > /var/lib/riak/generated.configs/app.2014.01.16.11.53.05.config -smp
>> enable
>> > -name riak@10.10.10.10 -setcookie riak -vm\_args
>> > /var/lib/riak/generated.configs/vm.2014.01.16.11.53.05.args -pa
>> > /usr/lib64/riak/lib/basho-patches -- console
>> > riak 28999 28782 0 11:53 ? 00:00:00 sh -s disksup
>> > riak 29001 28782 0 11:53 ? 00:00:00
>> > /usr/lib64/riak/lib/os\_mon-2.2.13/priv/bin/memsup
>> > riak 29002 28782 0 11:53 ? 00:00:00
>> > /usr/lib64/riak/lib/os\_mon-2.2.13/priv/bin/cpu\_sup
>> >
>> > # riak console
>> > 13:10:15.193 [info] Application lager started on node nonode@nohost
>> > 13:10:15.193 [info] Checking /etc/riak/app.config exists... false
>> > 13:10:15.193 [info] Checking /etc/riak/vm.args exists... false
>> > 13:10:15.193 [info] No app.config or vm.args detected in /etc/riak,
>> > activating cuttlefish
>> > 13:10:15.385 [info] Adding Defaults
>> > 13:10:15.387 [info] Applying Datatypes
>> > 13:10:15.404 [info] Validation
>> > 13:10:15.407 [info] Applied 1:1 Mappings
>> > 13:10:15.408 [info] Applied Translations
>> > config is OK
>> > -config /var/lib/riak/generated.configs/app.2014.01.16.13.10.15.config
>> > -args\_file /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args
>> > -vm\_args /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args
>> > Exec: /usr/lib64/riak/erts-5.10.3/bin/erlexec -boot
>> > /usr/lib64/riak/releases/2.0.0pre5/riak -config
>> > /var/lib/riak/generated.configs/app.2014.01.16.13.10.15.config
>> -args\_file
>> > /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args -vm\_args
>> > /var/lib/riak/generated.configs/vm.2014.01.16.13.10.15.args
>> -pa
>> > /usr/lib64/riak/lib/basho-patches -- console
>> > Root: /usr/lib64/riak
>> > Erlang R16B02-basho3 (erts-5.10.3) [source] [64-bit] [smp:2:2]
>> > [async-threads:64] [kernel-poll:true]
>> >
>> > Eshell V5.10.3 (abort with ^G)
>> > (riak@10.10.10.10)1>
>> >
>> > not sure how to proceed at this point.
>> >
>> > Thanks!
>> >
>> > John Shen
>> >
>> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> > riak-users mailing list
>> > riak-users@lists.basho.com
>> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>> >
>>
>>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

