---
title: "Re: map-db"
description: ""
project: community
lastmod: 2015-01-21T03:42:08-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15546"
mailinglist_parent_id: "msg15542"
author_name: "Ildar Alishev"
project_section: "mailinglistitem"
sent_date: 2015-01-21T03:42:08-0800
---


Hi Christopher,

thank you for your answer.
Honestly we work with ugameDb and order is next

we start executing code (using C# in Unity3d), it goes to ugame db, than after 
ugamedb it goes to Riak(i think ugameDB use RIAK), and after this it sends us 
answer.

What code should i send you??? 
it is first time we are working with ugamedb and riak at all, so we are some 
sort of noobs)


here is some code that i’m using in Unity3d (C#)

public IEnumerator eMapQuery()
 {
 var map = buck.MapReduce(new ErlangMapPhase("unity", "map\_phase"), new 
ErlangReducePhase("unity", "reduce\_phase"));
 Debug.Log("Start");
 yield return map.WaitUntilDone();
 if(map.isSuccessful)
 foreach (var item in map.GetResult())
 {
 Debug.Log("Ok");
 foreach (var pair in item.Fields) Debug.Log(pair.Key + " = " + 
pair.Value.ToString());
 }
 else
 {
 Debug.Log("Fail");
 }
 }

Erlang code here

>> module(unity).
>> -export([map\_phase/3, reduce\_phase/2]).
>> 
>> map\_phase(Value, KeyData, Arg) ->
>> [dict:from\_list([{I, 1}
>> || I <- binary\_to\_term(riak\_object:get\_value(Value))])].
>> 
>> 
>> reduce\_phase(ValueList, \_Arg) ->
>> [lists:foldl(fun(Value, Acc) ->
>> dict:merge(fun(\_, X, Y) -> X+Y end,
>> Value, Acc)
>> end,
>> dict:new(),
>> ValueList)].




ugameDB i don’t know it is their own code. 

Ildar.



> 21 янв. 2015 г., в 13:37, Christopher Meiklejohn 
>  написал(а):
> 
> On Wed, Jan 21, 2015 at 10:28 AM, Ildar Alishev  > wrote:
>> Hello everyone.
>> 
>> Have a few questions concerning connecting Erlang (it is client) and Riak 
>> 2.0.2
>> 
>> so question is.
>> 
>> i have created and compiled two functions using erlang
>> 
>> -module(unity).
>> -export([map\_phase/3, reduce\_phase/2]).
>> 
>> map\_phase(Value, KeyData, Arg) ->
>> [dict:from\_list([{I, 1}
>> || I <- binary\_to\_term(riak\_object:get\_value(Value))])].
>> 
>> 
>> reduce\_phase(ValueList, \_Arg) ->
>> [lists:foldl(fun(Value, Acc) ->
>> dict:merge(fun(\_, X, Y) -> X+Y end,
>> Value, Acc)
>> end,
>> dict:new(),
>> ValueList)].
>> 
>> 
>> so, now, since i’m using it for uGameDb (want to connect Unity3d and 
>> ugameDb), i cannot connect it.
>> Using Unity3d i’m calling MapReduce and… nothing happens. Really, nothing, 
>> no errors, nothing.
> 
> Hi Ildar,
> 
> Can you share the code you are using to execute the MapReduce job to
> allow us to debug further?
> 
> Thanks,
> - Chris

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

