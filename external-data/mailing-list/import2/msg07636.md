---
title: "Re: Node will not leave cluster"
description: ""
project: community
lastmod: 2012-06-07T10:21:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07636"
mailinglist_parent_id: "msg07626"
author_name: "David Greenstein"
project_section: "mailinglistitem"
sent_date: 2012-06-07T10:21:29-07:00
---



As it turns out, this is a known issue with 1.0.x. It is documented with a 
workaround in the release note named riak-1.0.org under "Ownership Handoff 
Stall".

Dave

\_\_\_\_
David Greenstein : Founder & CTO : Kibits Labs : d...@kibits.com : 617-901-9473 
: www.kibits.com
Get the iPhone or Android app now: http://www.kibits.com/app



On Jun 6, 2012, at 12:50 PM, David Greenstein wrote:

> 
> Thanks Austin.
> 
> Interestingâ€¦ after running the ring\_status command it seems there are several 
> handoffs that are either hung or not completing. The database is fairly small 
> and running the ring\_status command over several minutes reveals the same 
> output.
> 
> The member\_status is 25% for ring and pending for the node leaving.
> 
> So, I think something is wrong with the handoff, but, as far as I can tell, 
> there's no indication as to what is wrong in the logs or in the output of 
> these commands.
> 
> ============================== Ownership Handoff 
> ==============================
> Owner: riak@10.0.1.14
> Next Owner: riak@10.0.1.15
> 
> Index: 479555224749202520035584085735030365824602865664
> Waiting on: []
> Complete: [riak\_kv\_vnode,riak\_pipe\_vnode]
> 
> Index: 1027618338748291114361965898003636498195577569280
> Waiting on: []
> Complete: [riak\_kv\_vnode,riak\_pipe\_vnode]
> 
> Index: 1301649895747835411525156804137939564381064921088
> Waiting on: []
> Complete: [riak\_kv\_vnode,riak\_pipe\_vnode]
> 
> -------------------------------------------------------------------------------
> Owner: riak@10.0.1.15
> Next Owner: riak@10.0.1.14
> 
> Index: 913438523331814323877303020447676887284957839360
> Waiting on: []
> Complete: [riak\_kv\_vnode,riak\_pipe\_vnode]
> 
> -------------------------------------------------------------------------------
> Owner: riak@10.0.1.16
> Next Owner: riak@10.0.1.15
> 
> Index: 936274486415109681974235595958868809467081785344
> Waiting on: []
> Complete: [riak\_kv\_vnode,riak\_pipe\_vnode]
> 
> -------------------------------------------------------------------------------
> 
> 
> ============================== Unreachable Nodes 
> ==============================
> All nodes are up and reachable
> 
> [root@ip-10-0-1-20 ec2-user]# /db/riak/bin/riak-admin member\_status
> ================================= Membership 
> ==================================
> Status Ring Pending Node
> -------------------------------------------------------------------------------
> leaving 25.0% 25.0% 'riak@10.0.1.20'
> valid 28.1% 25.0% 'riak@10.0.1.14'
> valid 20.3% 25.0% 'riak@10.0.1.15'
> valid 26.6% 25.0% 'riak@10.0.1.16'
> -------------------------------------------------------------------------------
> Valid:3 / Leaving:1 / Exiting:0 / Joining:0 / Down:0
> 
> 
> 
> 
> 
> Any other clues would be appreciated. Thank you!
> 
> Dave
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

