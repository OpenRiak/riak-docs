---
title: "Re: Riak CS from Erlang"
description: ""
project: community
lastmod: 2014-04-07T15:46:39-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14016"
mailinglist_parent_id: "msg13964"
author_name: "Lee Sylvester"
project_section: "mailinglistitem"
sent_date: 2014-04-07T15:46:39-07:00
---


Hi Kelly,

I’ve got Riak CS working with erlcloud, so thanks for that. It would have 
taken a lot longer without your help. However, I wanted to change from using 
erlcloud:put\_object to using erlcloud:put\_multipart\_object. However, when I 
make the change, I get the following error:

{error,
 {error,
 {aws\_error,
 {http\_error,403,[],
 "AccessDeniedAccess Denied/tmp-files/test.png"}},
 [{erlcloud\_s3,s3\_request,9,[{file,"src/erlcloud\_s3.erl"},{line,899}]},
 {erlcloud\_s3,s3\_xml\_request,8,
 [{file,"src/erlcloud\_s3.erl"},{line,834}]},
 {erlcloud\_s3,put\_multipart\_object,6,
 [{file,"src/erlcloud\_s3.erl"},{line,662}]},
 {builder\_web\_fileupload\_resource,process\_post,2,
 [{file,"src/builder\_web\_fileupload\_resource.erl"},{line,43}]},
 {webmachine\_resource,resource\_call,3,
 [{file,"src/webmachine\_resource.erl"},{line,186}]},
 {webmachine\_resource,do,3,
 [{file,"src/webmachine\_resource.erl"},{line,142}]},
 {webmachine\_decision\_core,resource\_call,1,
 [{file,"src/webmachine\_decision\_core.erl"},{line,48}]},
 {webmachine\_decision\_core,decision,1,
 [{file,"src/webmachine\_decision\_core.erl"},{line,486}]}]}}


I tried adding an acl item to the Options list, but that didn’t seem to help. 
Do you have any idea what may be causing this?

Thanks,
Lee




On 1 Apr 2014, at 16:11, Kelly McLaughlin  wrote:

> Lee,
> 
> The erlcloud usage in the riak\_test test modules might be easier to follow. 
> Take a look at ./riak\_test/tests/object\_get\_test.erl for a simple example. 
> Also take a look at setup/2 in ./riak\_test/src/rtcs.erl to see how the 
> erlcloud configuration record is created. Hope that helps.
> 
> Kelly
> 
> On March 31, 2014 at 11:47:52 AM, Lee Sylvester (lee.sylves...@gmail.com) 
> wrote:
> 
>> Hi Kelly,
>> 
>> Thank you for the information. I took a look at the client test, but as it 
>> uses an FSM, the continuous looping gave me a headache :-) Is there a 
>> simpler test that demos this? If not, can you highlight the lines that make 
>> the calls to Riak CS etc? That part evades me.
>> 
>> Thanks,
>> Lee
>> 
>> 
>> 
>> On 31 Mar 2014, at 16:09, Kelly McLaughlin  wrote:
>> 
>>> Lee,
>>> 
>>> We have a fork of erlcloud (https://github.com/basho/erlcloud) we use for 
>>> testing and it can be made to work with your Riak CS cluster with 
>>> relatively little pain. Look in the riak\_cs repo under 
>>> client\_tests/erlang/ercloud\_eqc.erl for some example usage. You'll probably 
>>> want to set the proxy host and port and perhaps the host name if you're not 
>>> using the default "s3.amazonaws.com". 
>>> 
>>> Kelly
>>> 
>>> On March 31, 2014 at 8:44:03 AM, Lee Sylvester (lee.sylves...@gmail.com) 
>>> wrote:
>>> 
>>>> Hi guys, 
>>>> 
>>>> I’m setting up my own Riak CS cluster and wanted to know what the best way 
>>>> to interact with that cluster would be from an Erlang app? I’ve taken a 
>>>> look at ErlCloud, but it seems I’d need to butcher it to get it to work 
>>>> with a custom cluster (not Amazon’s setup). 
>>>> 
>>>> Thanks, 
>>>> Lee 
>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ 
>>>> riak-users mailing list 
>>>> riak-users@lists.basho.com 
>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

