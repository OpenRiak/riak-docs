---
title: "preflists do not satisfy the n_val on 5 nodes"
description: ""
project: community
lastmod: 2016-05-08T07:27:44-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17311"
author_name: "Vladimir Shabanov"
project_section: "mailinglistitem"
sent_date: 2016-05-08T07:27:44-0700
---


Hi,

Recently I upgraded my servers and migrated Riak from 5 old servers to 5
new ones (new servers are running Riak 2.1.4, old were on 2.1.1).

After running 'riak-admin diag' I got
[warning] The following preflists do not satisfy the n\_val:
[[{1450083655789255239155218544960687058564870569984,
 'riak@z...'},
 {1455792646560079078679451688838485039110401556480,
 'riak@a...'},
 {0,
 'riak@a...'}],
 [{1455792646560079078679451688838485039110401556480,
 'riak@a...'},
 {0,
 'riak@a...'},
 {5708990770823839524233143877797980545530986496,
 'riak@b...'}]]

As I understand it means that no all replicas are located on the same nodes.

I suspect that I can run 'riak-admin cluster leave/join' on some node to
get correct rebalancing. But I remember that few years ago I ran 'riak
attach' and executed some magic Erlang code to make rebalancing. It was on
the same cluster, 4 nodes, Riak 1.x.

Is there a way to do rebalancing without node leave/join in Riak 2.x?
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

