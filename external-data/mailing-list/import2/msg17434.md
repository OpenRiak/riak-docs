---
title: "Re: Riak Search and custom Solr components"
description: ""
project: community
lastmod: 2016-05-31T08:56:47-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17434"
mailinglist_parent_id: "msg17433"
author_name: "Steve Garon"
project_section: "mailinglistitem"
sent_date: 2016-05-31T08:56:47-0700
---


Hey Guillaume,

We had to alter the solrconfig.xml in our deployment because the default
solrconfig.xml does not give good search throughput with a large amount of
documents updating often. I've opened a ticket at basho to get the
solrconfig.xml save into the buckets settings that way they would be the
same across the cluster. I'm not sure when and if they'll have it in. I
guess the more ppl that ask for this, the sooner we'll get it.

In the meantime, what we did is that during our riak node installation
procedure, we create the index using curl then we override the
solrconfig.xml and then restart riak which in turn restarts solr. From
then, the solrconfig.xml should remain intact. There is one more thing
though. Sometimes, for unknown reasons, riak decides to recreate the
solrconfig.xml. So you might wanna have a script that runs on the node to
validate the solrconfig.xml has not changed and to fix it automatically if
it does.

I know this is not ideal, solrconfig.xml really needs to be saved in bucket
settings like the schema.xml. Lets just hope the Basho works on fixing this
ASAP because for big deployments this is kind of crutial.



Steve

On 30 May 2016 at 13:18, Guillaume Boddaert <
guilla...@lighthouse-analytics.co> wrote:

> Please allow me to bump this previous message that was sent late last
> friday and that didn't attract much attention due to a well deserved
> week-end.
>
>
> On 27/05/2016 19:14, Guillaume Boddaert wrote:
>
> Hi there,
>
> I'm currently testing custom Component in my Riak Search system. As I need
> a suggestion mechanism from the Solr index, I implemented the Suggester
> component (https://wiki.apache.org/solr/Suggester).
> It seems to work correctly, yet I have some question regarding the usage
> of custom Solr configuration inside of Riak. The only caveat is that Riak
> commits too often and that the suggestion index must be build manually and
> not on commit. That's fine for me, i'll cron that once per day.
>
> First of all, how do stop/start/reload the solr instance without
> disturbing the Riak core ? For the time being I'm stuck with service
> start/stop. How can I reload my solr cores configuration without stopping
> riak ?
>
> Secondly, is that a good pattern to start tweaking defaults from my solr
> cores (solrconfig.xml) ? Should I stop that right now and consider to use a
> distinct Solr instance if I require those modifications ? Or should I
> consider safe to alter cache/performance settings as well for Solr to match
> my needs ? Can I play with other solr files such as stopwords and stuff
> like that ?
>
> Finally, is there a proper way to alter default solrconfig.xml ? It is
> auto-generated at index creation by Riak, yet that's a BIG and complex file
> that may evolve between Riak releases. I'm creating indexes programatically
> sending my index through Riak interface ( RiakClient.create\_search\_index in
> Riak Python lib), but if I start to alter configuration I guess I need more
> than that.
> How do you guys would handle this ?
>
> Thanks,
>
> Guillaume
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing 
> listriak-users@lists.basho.comhttp://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

