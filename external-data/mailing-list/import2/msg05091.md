---
title: "Re: Riak 1.0 pre2 legacy_keylisting crash"
description: ""
project: community
lastmod: 2011-10-06T22:50:58-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05091"
mailinglist_parent_id: "msg04651"
author_name: "Fyodor Yarochkin"
project_section: "mailinglistitem"
sent_date: 2011-10-06T22:50:58-07:00
---


I am running 1.0 release snapshot right now and for certain mapreduce
functions, I am getting many errors like that as well on some (but not
all) mapreduce queries.
 any hints on where to start looking to trouble-shoot this issue?



Here's one of the queries that consistently generates series of
'fitting\_died' log messages:

{
 "inputs":{
 "bucket":"test",
 "index":"integer\_int",
 "start":20000000001,
 "end":200000000200
 },
 "query":[
 {"map":{"language":"javascript",
 "source":"function(v) {
 if (v.values){
 data = Riak.mapValuesJson(v)[0];
 return [data];
 }else{
 return[];
 }
 }",
 "keep":true
 }
 },
 {"reduce":{"language":"javascript",
 "source": "function(v){ return v;}"}},
 {"reduce":{"language":"javascript",
 "source":"function(v) {

 v.sort(function(a,b) {return
b.integer < a.integer});
 return v;
 }"
 }
 }
 ],"timeout": 9000
}

produces over hundred of " "Supervisor riak\_pipe\_vnode\_worker\_sup had
child at module undefined at <0.28835.0> exit with reason fitting\_died
in context child\_terminated" entries in log file and returns 'timeout'


On Sun, Sep 11, 2011 at 3:38 PM, Ryan Caught  wrote:
> Hi,
> I'm testing out a rolling upgrade with 1.0 pre2 and found that when I turn
> off legacy\_keylisting Riak crashes on me.  Things work fine when
> legacy\_keylisting is turned on.
> Here is what I found in the crash log.
>>
>> 2011-09-11 07:15:44 =SUPERVISOR REPORT====
>>      Supervisor: {local,riak\_pipe\_fitting\_sup}
>>      Context:    child\_terminated
>>      Reason:     killed
>>      Offender:
>> [{pid,<0.2725.0>},{name,undefined},{mfargs,{riak\_pipe\_fitting,start\_link,undefined}},{restart\_type,temporary},{shutdown,2000},{child\_type,worker}]
>
> I'm using Ubuntu with Ripple (0.9.5).
>
> Ryan
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

