---
title: "Re: Moving mapred* functions out of riak_client?"
description: ""
project: community
lastmod: 2011-06-10T08:19:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03641"
mailinglist_parent_id: "msg03639"
author_name: "Kresten Krab Thorup"
project_section: "mailinglistitem"
sent_date: 2011-06-10T08:19:56-07:00
---


We are using those APIs in our new stuff for riak sync/mobile. My problem with 
your change would be that we have a mock riak\_client which is super convenient 
for unit testing, and it would be good to still be able to have that somehow. 
Our mock is just an eta-backed parameterized module which has 
put/get/mapred\_bucket/etc. .... 

Kresten 

On 10/06/2011, at 12.33, "Bryan Fink"  wrote:

> Hello, Community.
> 
> I'd like to know how many of you are directly using the mapred\*
> functions in the riak\_client module (riak\_client:mapred/2,3,4,
> :mapred\_stream/2,3,4, :mapred\_bucket/2,3,4, etc.). Of those that are,
> how many of you would mind if they moved out of riak\_client and into a
> separate module?
> 
> Just to be clear: if you're accessing Riak's MapReduce system over
> HTTP or ProtocolBuffers, this change would not affect you. My search
> is only for people using the native distributed Erlang client
> (https://github.com/basho/riak\_kv/blob/master/src/riak\_client.erl).
> 
> I'm doing some other work on Riak's MapReduce system, and as part of
> the cleanup, I'd like to deprecate the riak\_client:mapred\* functions,
> and replace them with functions in another module. Basically, any
> code you had like this:
> 
> {ok, C} = riak:local\_client(),
> {ok, Results} = C:mapred(Inputs, Query).
> 
> would need to be converted to this:
> 
> {ok, Results} = riak\_kv\_mapred\_iface:mapred(Inputs, Query).
> 
> Additionally, remote connections that looked like this:
> 
> {ok, C} = riak:client\_connect(RiakNode),
> {ok, Results} = C:mapred(Inputs, Query).
> 
> would need to be converted to something like this:
> 
> {ok, Results} = rpc:call(RiakNode, riak\_kv\_mapred\_iface, mapred,
> [Inputs, Query]).
> 
> Would this change be distasteful or unbearable for any of you?
> 
> Thanks,
> 
> Bryan Fink
> Senior Software Engineer
> Basho Technologies
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

