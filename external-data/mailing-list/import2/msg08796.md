---
title: "Re: riak failure on concurrent writes"
description: ""
project: community
lastmod: 2012-10-03T09:08:36-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08796"
mailinglist_parent_id: "msg08795"
author_name: "Evan Vigil-McClanahan"
project_section: "mailinglistitem"
sent_date: 2012-10-03T09:08:36-07:00
---


For fastest loading, you might try hitting more than one node, just
round-robining around the cluster should work.

Additionally, make sure that you've done basic tunings to the cluster,
and try adjusting max\_open\_files in the eleveldb config section to a
higher value (but not too high, as you don't have a lot of memory on
those nodes). Once you get past the first level in leveldb, you can
run into file handle contention at low values.

Basic sysctl tuning values:

net.core.wmem\_default=8388608
net.core.rmem\_default=8388608
net.core.wmem\_max=8388608
net.core.rmem\_max=8388608
net.core.netdev\_max\_backlog=10000
net.core.somaxconn=4000
net.ipv4.tcp\_max\_syn\_backlog=40000
net.ipv4.tcp\_fin\_timeout=15
net.ipv4.tcp\_tw\_reuse=1
vm.swappiness=0

Also try changing your scheduler to deadline or noop (noop is for SSDs, mostly):

http://doc.opensuse.org/products/draft/SLES/SLES-tuning\_sd\_draft/cha.tuning.io.html

On Wed, Oct 3, 2012 at 5:42 AM, Venki Yedidha
 wrote:
> Hi All,
>
> Now that I have a 5 node riak cluster of which all are running on
> eleveldb backend(4 GB ram for each node), I am trying to insert appr: 34000
> objects on one of the riak node in the cluster through riak-erlang client
> asynchronously...Its failing after some time to accept inserts...Do I need
> to change any settings in the config files so that riak runs stable to
> handle concurrent writes upto 35k with out failure?
>
>
> Please help me on the above..
>
> Thanks,
> Venkatesh
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

