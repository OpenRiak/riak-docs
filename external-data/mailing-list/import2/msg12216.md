---
title: "Re:"
description: ""
project: community
lastmod: 2013-09-09T16:55:02-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12216"
mailinglist_parent_id: "msg12211"
author_name: "Brady Wetherington"
project_section: "mailinglistitem"
sent_date: 2013-09-09T16:55:02-07:00
---


I've been working with Basho to get those documents updated - in short - I
have a pull request that makes using Riak with EIP's in Classic-EC2 much,
much easier. They have accepted it, but it has not been merged with the
mainline yet. I'm assuming you are \*not\* on VPC, is that correct?

If so, you should use the ec2 public DNS name as your node identifier
instead. For the IP you listed above, that's:

ec2-54-247-68-179.eu-west-1.compute.amazonaws.com

If you find that name ungainly - go head and make a CNAME that points to it
-

riak-1.yourcompany.com CNAME
ec2-54-247-68-179.eu-west-1.compute.amazonaws.com

Once you've done this, you can use that shortname (riak-1.yourcompany.com)
as your node identifier - and it will survive a node restart (so long as
you reassociate the EIP with the instance).

The reason \*why\* this works is that that public DNS name (
ec2-54-247-68-179.eu-west-1.compute.amazonaws.com) resolves to the \_inside\_
IP address of your node when you're inside of amazon. So your server can
figure out whether or not it's talking to itself.

-B.


On Mon, Sep 9, 2013 at 7:38 AM, David Montgomery
wrote:

> Why do I get errors restarting riak when i use aws EIP's?
>
> I change the ip address per this doc.
> http://docs.basho.com/riak/1.2.1/cookbooks/Basic-Cluster-Setup/ I am
> using the latest version of riak for ubuntu 12.04
>
> I change the 127.0.0.1 to the EIP. It should work. Yet....riak will not
> work. Any issues I am missing? How do I resolve?
>
>
> console.log
> 2013-09-09 11:28:28.211 [info] <0.7.0> Application webmachine started on
> node 'riak@54.247.68.179'
> 2013-09-09 11:28:28.211 [info] <0.7.0> Application basho\_stats started on
> node 'riak@54.247.68.179'
> 2013-09-09 11:28:28.229 [info] <0.7.0> Application bitcask started on node
> 'riak@54.247.68.179'
> 2013-09-09 11:28:29.385 [error] <0.172.0> CRASH REPORT Process <0.172.0>
> with 0 neighbours exited with reason: eaddrnotavail in gen\_server:init\_it/6
> line 320
> 2013-09-09 11:28:29.385 [error] <0.138.0> Supervisor riak\_core\_sup had
> child "http\_54.247.68.179:8098" started with
> webmachine\_mochiweb:start([{name,"http\_54.247.68.179:8098"},{ip,"54.247.68.179"},{p$
> 2013-09-09 11:28:29.387 [info] <0.7.0> Application riak\_core exited with
> reason: {shutdown,{riak\_core\_app,start,[normal,[]]}}
>
> error.log
> 013-09-09 11:08:13.109 [error] <0.138.0> Supervisor riak\_core\_sup had
> child riak\_core\_capability started with riak\_core\_capability:start\_link()
> at <0.156.0> exit with reason no function clause match$
> 2013-09-09 11:08:13.110 [error] <0.136.0> CRASH REPORT Process <0.136.0>
> with 0 neighbours exited with reason: {{function\_clause,[{orddict,fetch,['
> riak@10.239.130.225',[{'riak@127.0.0.1',[{{riak\_cont$
> 2013-09-09 11:08:34.956 [error] <0.156.0> gen\_server riak\_core\_capability
> terminated with reason: no function clause matching orddict:fetch('
> riak@10.239.130.225', [{'riak@127.0.0.1',[{{riak\_control,m$
> 2013-09-09 11:08:34.957 [error] <0.156.0> CRASH REPORT Process
> riak\_core\_capability with 0 neighbours exited with reason: no function
> clause matching orddict:fetch('riak@10.239.130.225', [{'riak@127.$
> 2013-09-09 11:08:34.957 [error] <0.140.0> Supervisor riak\_core\_sup had
> child riak\_core\_capability started with riak\_core\_capability:start\_link()
> at <0.156.0> exit with reason no function clause match$
> 2013-09-09 11:08:34.958 [error] <0.138.0> CRASH REPORT Process <0.138.0>
> with 0 neighbours exited with reason: {{function\_clause,[{orddict,fetch,['
> riak@10.239.130.225',[{'riak@127.0.0.1',[{{riak\_cont$
> 2013-09-09 11:10:56.863 [error] <0.154.0> gen\_server riak\_core\_capability
> terminated with reason: no function clause matching orddict:fetch('
> riak@54.247.68.179', []) line 72
> 2013-09-09 11:10:56.864 [error] <0.154.0> CRASH REPORT Process
> riak\_core\_capability with 0 neighbours exited with reason: no function
> clause matching orddict:fetch('riak@54.247.68.179', []) line 72 i$
>
> [ Read 32 lines ]
>
>
>
>
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

