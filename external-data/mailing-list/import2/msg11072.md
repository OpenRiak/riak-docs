---
title: "Re: Riak crashing on Map Reduce"
description: ""
project: community
lastmod: 2013-05-15T06:11:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11072"
mailinglist_parent_id: "msg11071"
author_name: "Christian Dahlqvist"
project_section: "mailinglistitem"
sent_date: 2013-05-15T06:11:05-07:00
---


Hi Kurt,

In order to be able to provide some feedback on why the mapreduce job might be 
timing out and try to help you address this, I will need some additional 
information:

- Which version of Riak are you running on?
- What does your app.config file look like?
- What does you data look like?
- What does your mapreduce job look like? How many phases are there and what do 
they do?

Best regards,

Christian



On 15 May 2013, at 13:02, kurt campher  wrote:

> Hi People
> 
> Im running Map Reduce on a bucket with more than 100 000 items.
> 
> The MR runs for 10 seconds then stops with this error in the logs:
> @riak\_pipe\_vnode:new\_worker:766 Pipe worker startup failed:fitting was gone 
> before startup
> 
> And this errror in the Python shell:
> Error running MapReduce operation. Headers: {'date': 'Tue, 14 May 2013 
> 15:07:27 GMT', 'content-length': '623', 'content-type': 'application/json', 
> 'http\_code': 500, 'server': 'MochiWeb/1.1 WebMachine/1.9.0 (someone had 
> painted it blue)'} Body: 
> '{"phase":0,"error":"[preflist\_exhausted]","input":"{ok,{r\_object,<<\\"real\_raw\_logs\\">>,<<\\"8a4986cc235ec8690123677460ac05e6:2013-05-14
> 
> 12:11:08.178628:0.184912287858\\">>,[{r\_content,{dict,6,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[[<<\\"Links\\">>]],[],[],[],[],[],[],[],[[<<\\"content-type\\">>,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110],[<<\\"X-Riak-VTag\\">>,49,89,48,122,98,99,66,53,120,86,120,50,90,67,101,51,115,120,79,85,65,79]],[[<<\\"index\\">>]],[],[[<<\\"X-Riak-Last-Modified\\">>|{1368,533468,242947}]],[],[...]}}},...}],...},...}","type":"forward\_preflist","stack":"[]"}'
> 
> Also, I cant list the keys on the bucket. A timeout error occurs.
> 
> 
> I have Riak running on 2 nodes with 7 Gigs of RAM each.
> Map Reduce runs fine over 2000 items.
> I have increased the js\_vm count multiple times.
> Also increased the js\_max\_vm\_mem to 2048
> Also increased the Map Reduce query's timeout but never lasts longer than 10 
> seconds
> 
> Thanks to anyone who looks at this
> 
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

