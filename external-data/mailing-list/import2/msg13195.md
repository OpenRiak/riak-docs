---
title: "Re: riak nagios script"
description: ""
project: community
lastmod: 2013-12-10T12:00:41-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13195"
mailinglist_parent_id: "msg13193"
author_name: "Alex Moore"
project_section: "mailinglistitem"
sent_date: 2013-12-10T12:00:41-08:00
---


Hi Kathleen,

If you’d like to run riak\_nagios from the erl command line, you’ll need to 
compile everything in src and include it in the path along with the getopt 
library.   

You can compile everything with a simple call to make, and then include it in 
the path with "erl -pa deps/\*/ebin ebin”.  
Once everything is loaded, you can call "check\_node:main(["--node", 
"dev1@127.0.0.1", "riak\_kv\_up"]).” or something similar to run it.  The last 
parameter in the Args array will be the check to make.  

Is there a reason you’re running it this way instead of compiling it to an 
escript and running it from bash? 

Thanks,
Alex Moore

On December 10, 2013 at 1:26:20 PM, kzhang (kzh...@wayfair.com) wrote:

Thanks Hector. 

Here is how I executed the script. 

I downloaded and installed the erlang shell from 
http://www.erlang.org/documentation/doc-5.3/doc/getting\_started/getting\_started.html
 

started erlang OTP: 

root@MYRIAKNODE otp\_src\_R16B02]# erl -s toolbar 
Erlang R16B02 (erts-5.10.3) [source] [64-bit] [async-threads:10] [hipe] 
[kernel-poll:false] 

Eshell V5.10.3 (abort with ^G) 

grabbed the source code 
(https://github.com/basho/riak\_nagios/blob/master/src/check\_node.erl), 
compiled it: 
c(check\_node). 

ran it: 
check\_node:main([{node, 'xx.xx.xx.xx'}]). 

then got: 

\*\* exception error: undefined function getopt:parse/2 
in function check\_node:main/2 (check\_node.erl, line 15) 

Here is where I am. I found this: 

https://github.com/jcomellas/getopt 

I grabbed the source code, compiled it under otp\_src\_R16B02. 

ran it again: 
2> check\_node:main([{node, 'xx.xx.xx.xx'}]). 
UNKNOWN: invalid\_option\_arg {check,{node,'xx.xx.xx.xx'}} 

Am I on the right path? 

Thanks, 

Kathleen 












-- 
View this message in context: 
http://riak-users.197444.n3.nabble.com/riak-nagios-script-tp4030025p4030037.html
 
Sent from the Riak Users mailing list archive at Nabble.com. 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ 
riak-users mailing list 
riak-users@lists.basho.com 
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com 
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

