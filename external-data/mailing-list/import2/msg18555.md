---
title: "Re: Partitions repair isn't working anymore?"
description: ""
project: community
lastmod: 2018-06-01T02:08:22-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg18555"
mailinglist_parent_id: "msg18536"
author_name: "Guido Medina"
project_section: "mailinglistitem"
sent_date: 2018-06-01T02:08:22-0700
---



The last command should have been like the following:

 \* {ok, Ring} = riak\_core\_ring\_manager:get\_my\_ring().
 \* Partitions = [P || {P, 'r...@node4.domain.com'} <-
 riak\_core\_ring:all\_owners(Ring)].
 \* \*[riak\_kv\_vnode:repair(P) || P <- Partitions].\*

My bad, I think I copied the command from the wrong instructions before.

Guido.

On 01/06/18 09:37, Russell Brown wrote:

I don’t see a call to `riak\_search\_vnode:repair` in those docs

Do you still run legacy riak search (i.e. not yokozuna/solr)?


On 1 Jun 2018, at 09:35, Guido Medina  wrote:

Sorry, not repairing a single partition but all partitions per node:
https://docs.basho.com/riak/kv/2.2.3/using/repair-recovery/repairs/#repairing-all-partitions-on-a-node

On 01/06/18 09:34, Guido Medina wrote:

Hi Russell,

I was repairing each node as specified in this guide 
https://docs.basho.com/riak/kv/2.2.3/using/repair-recovery/repairs/#repairing-a-single-partition

Guido.

On 01/06/18 09:16, Russell Brown wrote:

riak\_search has been removed from riak-2.2.5. Looks like some vestige survived.

Can you tell me what command you ran, it looks to me from the output below that 
you’re connected to node and typing commands in the console?

Is this some snippet that you attach and run?

Cheers

Russell



On 1 Jun 2018, at 09:07, Guido Medina 
 wrote:

Hi all,

We started the partitions repair a couple of weeks ago, so far so good (3 nodes 
out of 7 done), then we started getting this error:


(r...@node4.domain.com
)3> [riak\_search\_vnode:repair(P) || P <- Partitions].
\*\* exception error: undefined function riak\_search\_vnode:repair/1


The first two steps for the node repair executed fine:


{ok, Ring} = riak\_core\_ring\_manager:get\_my\_ring().
Partitions = [P || {P, '
r...@node4.domain.com
'} <- riak\_core\_ring:all\_owners(Ring)].


We are running on 2.2.5
Guido.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list

riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com




\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

