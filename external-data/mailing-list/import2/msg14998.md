---
title: "Re: Creating a new object immediately after deleting one with the	same key"
description: ""
project: community
lastmod: 2014-10-09T01:36:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14998"
mailinglist_parent_id: "msg14997"
author_name: "Sargun Dhillon"
project_section: "mailinglistitem"
sent_date: 2014-10-09T01:36:45-07:00
---


Distributed deletion, and garbage collection is a really hard problem.
Riak has a couple different ways to do it talked about here:
http://docs.basho.com/riak/latest/ops/advanced/deletion/

The default mechanism tombstones the key, and then waits 3 seconds
after the write has reached stable state (on all the primary vnodes of
the preflist), and then blows it away. Although, this is configurable,
it's probably not what you want to change. You should pass the
deletedvclock=true, when doing the get, and then pass back the vclock
on write. There is more information in the linked doc.

On Thu, Oct 9, 2014 at 1:23 AM,  wrote:
> Hi all,
>
> While testing a simple go / protobuf driver I encountered following
> behaviour:
> After deleting an object and creating a new one with the same key
> immediately afterwards Riak creates a sibling of the new object. Trying to
> fetch an object with the key directly before creating the new one fails.
>
> If the timespan between delete and create is greater than ~3 seconds
> everything works as expected.
>
> Is this behaviour documented somewhere? Does the required minimal timespan
> depend on the cluster setup or is it configurable?
> I'm currently using Riak v2.0.0 on OS X locally, allow\_mult is set to true.
>
> Best regards,
> Tilo Soenke
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

