---
title: "Re: riak-erlang-client issue with Riak EE 1.2"
description: ""
project: community
lastmod: 2012-09-07T07:55:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08468"
mailinglist_parent_id: "msg08307"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2012-09-07T07:55:55-07:00
---


Julian,

On Thu, Aug 16, 2012 at 6:51 PM, Julian  wrote:
>
>
> One of the intriguing things I find is that the exception is listed as
> occuring in one of my own processes that is doing json decoding, however I
> have checked the json by saving it to a file and it does not contain the
> data shown inside the 'struct' in the exception. The only explanation I can
> come up with is that the badmatch is occurring within riakc\_pb socket and
> was triggered by my call to riakc\_pb\_socket:search/6, and the process link
> is somehow influencing the crash report.
>

Links don't influence crash reports. They create a dependency among
processes so that if one crashes the other knows.

That struct in your trace is a Riak Search result which has already been
decoded. It is wrapped in a 2-tuple which you are passing to be decoded.
 This seems like a blatant error. What I can't explain is why you are
seeing badmatch and not case\_clause, but maybe mochijson code has changed.


> =CRASH REPORT==== 16-Aug-2012::21:44:52 ===
> crasher:
> initial call: xx\_acl\_query:init/1
> pid: <0.159.0>
> registered\_name: []
> exception exit: {{badmatch,
> {not\_found,
>
> {<<"a65796222ea26bb7b355bf140dbd5b72e81efee1">>,
> <<"000018e5-accf-fff1-8123-1efee1">>},
> {struct,
> [{p,[0]},
> {<<"account\_id">>,[<<"0000005427">>]},
> {<<"account\_type\_id">>,[<<"3">>]},
> {<<"id">>,[<<"6373">>]},
> {<<"status">>,[<<"Deleted">>]},
> {<<"type">>,[<<"account">>]},
> {score,[1.0]}]}}},
> [{mochijson2,tokenize,2},
> {mochijson2,decode1,2},
> {mochijson2,json\_decode,2},
> {lists,map,2},
> {lists,map,2},
> {xx\_acl\_tree,from\_json,2},
> {xx\_acl\_query,load\_instance\_,2},
> {xx\_acl\_query,bootstrap\_accounts,1}]}
> in function gen\_server:init\_it/6
> ancestors: [xx\_cache\_sup,xx\_acl\_sup,<0.108.0>]
> messages: []
> links: [<0.132.0>]
> dictionary: []
> trap\_exit: true
> status: running
> heap\_size: 832040
> stack\_size: 24
> reductions: 30690459
> neighbours:
>
>
-Z
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

