---
title: "Re: riak-cs fails to start after reimporting Docker container"
description: ""
project: community
lastmod: 2017-02-15T13:14:57-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17986"
mailinglist_parent_id: "msg17946"
author_name: "Jean-Marc Le Roux"
project_section: "mailinglistitem"
sent_date: 2017-02-15T13:14:57-0800
---


Hi,

I'll try to send the log archive ASAP.
Here is what I get in /var/log/riak/error.log after running riak-admin
repair-2i :

2017-02-15 22:09:06.535 [error]
<0.3287.0>@riak\_kv\_2i\_aae:repair\_partition:297 Failed to acquire hashtree
lock on partition 1255977969581244695331291653115555720016817029120
2017-02-15 22:09:06.535 [error]
<0.3288.0>@riak\_kv\_2i\_aae:repair\_partition:297 Failed to acquire hashtree
lock on partition 1278813932664540053428224228626747642198940975104
2017-02-15 22:09:06.535 [error]
<0.3289.0>@riak\_kv\_2i\_aae:repair\_partition:297 Failed to acquire hashtree
lock on partition 479555224749202520035584085735030365824602865664
2017-02-15 22:09:06.535 [error]
<0.3290.0>@riak\_kv\_2i\_aae:repair\_partition:297 Failed to acquire hashtree
lock on partition 502391187832497878132516661246222288006726811648
2017-02-15 22:09:06.535 [error]
<0.3291.0>@riak\_kv\_2i\_aae:repair\_partition:297 Failed to acquire hashtree
lock on partition 1118962191081472546749696200048404186924073353216

I tried to remove all "LOCK" files in /var/lib/riak but to no avail...
I'm guessing there is something here...

Any idea ?

2017-02-09 17:37 GMT+01:00 Luke Bakken :

> Hi Jean-Marc -
>
> Can you provide a complete archive of the log directory? I wonder if
> another file might have more information.
>
> --
> Luke Bakken
> Engineer
> lbak...@basho.com
>
> On Thu, Feb 9, 2017 at 1:58 AM, Jean-Marc Le Roux
>  wrote:
> >
> > Hello,
> >
> > here is the original github issue :
> >
> > https://github.com/basho/riak\_cs/issues/1329
> >
> > I'm using riak-cs 2.1.1-1.el6 with stanchion 1.5.0-1.el6 on CentOS 6.8
> in a Docker container.
> > To make the data persistent, the following directories are mounted from
> outside the container :
> >
> > /var/log
> > /var/lib/riak/
> >
> > Everything works fine except when I remove/reimport the container.
> > Even when it's the same container.
> > The riak data is here in /var/lib/riak (bitcask and leveldb stuff). ACLs
> look fine on those files.
> >
> > Riak starts. Stanchion starts. But riak-cs won't start.
> > With a riak-cs concole, it looks like the problem is here :
> >>
> >> (riak-cs@127.0.0.1)1> [os\_mon] memory supervisor port (memsup): Erlang
> has closed
> >>
> >> =INFO REPORT==== 18-Jan-2017::09:38:31 ===
> >> alarm\_handler: {clear,system\_memory\_high\_watermark}
> >> [os\_mon] cpu supervisor port (cpu\_sup): Erlang has closed
> >> {"Kernel pid terminated",application\_controller,"{application\_
> start\_failure,riak\_cs,{notfound,{riak\_cs\_app,start,[normal,[]]}}}"}
> >
> > var/log/riak-cs/access.log.2017\_01\_18\_09 is empty.
> > Here is what /var/log/riak-cs/crash.log says:
> >>
> >> 2017-01-18 09:38:31 =CRASH REPORT====
> >> crasher:
> >> initial call: application\_master:init/4
> >> pid: <0.148.0>
> >> registered\_name: []
> >> exception exit: {{notfound,{riak\_cs\_app,start,
> [normal,[]]}},[{application\_master,init,4,[{file,"
> application\_master.erl"},{line,133}]},{proc\_lib,init\_p\_
> do\_apply,3,[{file,"proc\_lib.erl"},{line,239}]}]}
> >> ancestors: [<0.147.0>]
> >> messages: [{'EXIT',<0.149.0>,normal}]
> >> links: [<0.147.0>,<0.7.0>]
> >> dictionary: []
> >> trap\_exit: true
> >> status: running
> >> heap\_size: 376
> >> stack\_size: 27
> >> reductions: 119
> >> neighbours:
>



-- 
\*Jean-Marc Le Roux\*


Founder and CEO of Aerys (http://aerys.in)

Blog: http://blogs.aerys.in/jeanmarc-leroux
Cell: (+33)6 20 56 45 78
Phone: (+33)9 72 40 17 58
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

