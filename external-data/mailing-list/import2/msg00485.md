---
title: "Re: 400 on idle connection"
description: ""
project: community
lastmod: 2010-06-01T19:16:33-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00485"
mailinglist_parent_id: "msg00484"
author_name: "Jonathan Lee"
project_section: "mailinglistitem"
sent_date: 2010-06-01T19:16:33-07:00
---


Ah, I missed that. Thanks for the quick response! I just re-cloned riak
and ran make, and the mochiweb pulled contains that changeset. However, it
is not checked out for me:

[~/riak]> cd deps/mochiweb
[~/riak/deps/mochiweb]> hg parents
changeset: 115:5ccf25b213fc
user: Bryan Fink 
date: Thu Apr 08 16:33:24 2010 -0400
summary: copy riak/apps/mochiweb to external mochiweb repo

Running hg up and rebuilding fixes this. Is this a config issue?

- Jonathan

On Tue, Jun 1, 2010 at 10:00 PM, Sean Cribbs  wrote:

> Jonathan,
>
> This has already been fixed on tip and should be released with 0.11. See:
> http://hg.basho.com/mochiweb/changeset/6cc943959128
>
> Sean Cribbs 
> Developer Advocate
> Basho Technologies, Inc.
> http://basho.com/
>
> On Jun 1, 2010, at 9:57 PM, Jonathan Lee wrote:
>
> > Here's a question regarding idle connection handling. Riak (actually,
> mochiweb:request/2) automatically resets idle connections after 30 seconds.
> But, before closing the connection, it sends a 400 response. For example:
> >
> > > time telnet 127.0.0.1 8091
> > Trying 127.0.0.1...
> > Connected to localhost.
> > Escape character is '^]'.
> > HTTP/1.1 400 Bad Request
> > Server: MochiWeb/1.0 (Any of you quaids got a smint?)
> > Date: Wed, 02 Jun 2010 01:39:41 GMT
> > Content-Length: 0
> >
> > Connection closed by foreign host.
> >
> > real 0m30.010s
> > user 0m0.002s
> > sys 0m0.004s
> >
> > Is this expected behavior? At first glance, I don't see anything in the
> HTTP RFC that requires or recommends this. Is there a specific reason for
> sending the 400?
> >
> > My reason for asking this question is that the Java client misinterprets
> this final 400 and returns it for the wrong request! This can be fixed by
> having a separate thread actively evict idle connections, but if this is
> unexpected behavior on the server side, it'd make more sense to change it
> there.
> >
> > Thanks,
> > Jonathan
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

