---
title: "Re: Anti-Entropy Sudden Exchange"
description: ""
project: community
lastmod: 2014-01-02T16:51:23-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13353"
mailinglist_parent_id: "msg13352"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2014-01-02T16:51:23-08:00
---


Hi Justin,

Could you run "riak-debug" on each node of this cluster and email me
the generated archives directly? I'm wondering what has caused so much
AAE to become necessary.

Thanks!
--
Luke Bakken
CSE
lbak...@basho.com


On Thu, Jan 2, 2014 at 4:39 PM, Justin Long  wrote:
> Ok here’s an update on the issue, I’m really hoping someone can chime in. I
> disabled Anti-Entropy, restarted Riak, and then tried to run a repair on
> indexes. After running the command [riak\_kv\_vnode:repair(P) || P <-
> Partitions]. Riak then returned the error
>
> \*\* exception exit: {timeout,{gen\_server,call,
>
> [{riak\_core\_vnode\_manager,'riak@192.168.3.2'},
> {repair,riak\_kv,
>
> {riak\_kv\_vnode,22835963083295358096932575511191922182123945984},
>
> {riak\_kv\_vnode,repair\_filter}}]}}
> in function gen\_server:call/2 (gen\_server.erl, line 180)
>
> We then tried to use the Basho Riak Data Migrator tool to back up the most
> recent data on the node, but it takes 2 minutes to export a simple KV object
> (and these are less than 32kb in size). Thanks for your help.
>
> FYI Using Riak 1.4.6
>
>
>
> On Jan 2, 2014, at 11:31 AM, Justin Long  wrote:
>
> Hi everyone,
>
> Experiencing some weird behaviour in a cluster of 3 nodes. As of this
> morning, we noticed a massive performance lag and when checking the logs
> Active Anti-Entropy Exchange suddenly began initiating a huge series of
> transfers. Here’s what we see in the logs:
>
> 2014-01-02 19:26:34.396 [info]
> <0.1571.1800>@riak\_kv\_exchange\_fsm:key\_exchange:206 Repaired 882 keys during
> active anti-entropy exchange of
> {228359630832953580969325755111919221821239459840,3} between
> {228359630832953580969325755111919221821239459840,'riak@192.168.3.2'} and
> {251195593916248939066258330623111144003363405824,'riak@192.168.3.3’}
>
> When we check the logs on all 3 nodes we only had a few process crashes 10
> hours ago, nothing in between that time and now. It all came on suddenly.
> Any idea if this is normal and will fix itself or if we need to intervene?
>
> Thanks!
>
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

