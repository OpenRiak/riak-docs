---
title: "Re: Unable to create anonymous user"
description: ""
project: community
lastmod: 2015-11-25T07:14:12-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16813"
mailinglist_parent_id: "msg16812"
author_name: "Dmitri Zagidulin"
project_section: "mailinglistitem"
sent_date: 2015-11-25T07:14:12-0800
---


Hi Ben,

Just to double-check:
1) is Stanchion installed and running, when you try to create the user?
(and the stanchion\_host entry is pointing to it, in cs config?)

2) is anonymous\_user\_creation = on in the config file?

3) do you have 'buckets.default.allow\_mult = true' in the Riak config file?

4) (this is likely to be yes, but just to check) Have you restarted Riak
since configuring the advanced.config backend?

Dmitri

On Tue, Nov 24, 2015 at 6:40 PM, Ben Rudolph  wrote:

> Hi,
>
> I've almost completed the cluster setup but am running into issues with
> anonymous user creation. All machines ping/pong and their IPs are matching.
> When I run the curl command to create an anonymous user:
>
> curl -H 'Content-Type: application/json' -XPOST http://\*\*:8080/riak-cs/user
> --data '{"email":"em...@email.com", "name":"admin\_user"}'
>
> And I get an XML response that says Internal Server Error. The console.log
> file looks like this:
>
> 2015-11-24 23:16:35.572 [error] <0.439.0> Webmachine error at path
> "/riak-cs/user" :
> {error,{error,{badmatch,{error,malformed\_xml}},[{riak\_cs\_s3\_response,xml\_error\_code,1,[{file,"src/riak\_cs\_s3\_response.erl"},{line,335}]},{riak\_cs\_s3\_response,error\_response,1,[{file,"src/riak\_cs\_s3\_response.erl"},{line,249}]},{riak\_cs\_wm\_user,accept\_json,2,[{file,"src/riak\_cs\_wm\_user.erl"},{line,119}]},{webmachine\_resource,resource\_call,3,[{file,"src/webmachine\_resource.erl"},{line,186}]},{webmachine\_resource,do,3,[{file,"src/webmachine\_resource.erl"},{line,142}]},{webmachine\_decision\_core,resource\_call,...},...]}}
> in riak\_cs\_s3\_response:xml\_error\_code/1 line 335
>
> Which led me to this issue here
> . However my advanced.config
> already looks like this (which is what is suggested in the issue):
> [
> {riak\_kv, [
> {add\_paths, ["/usr/lib/riak-cs/lib/riak\_cs-2.0.1/ebin"]},
> {storage\_backend, riak\_cs\_kv\_multi\_backend},
> {multi\_backend\_prefix\_list, [{<<"0b:">>, be\_blocks}]},
> {multi\_backend\_default, be\_default},
> {multi\_backend, [
> {be\_default, riak\_kv\_eleveldb\_backend, [
> {total\_leveldb\_mem\_percent, 30},
> {data\_root, "/opt/data/riak/leveldb"}
> ]},
> {be\_blocks, riak\_kv\_bitcask\_backend, [
> {data\_root, "/opt/data/riak/bitcask"}
> ]}
> ]}
> ]}
> ].
>
> Any insight would be useful!
>
> Thanks,
> Ben
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

