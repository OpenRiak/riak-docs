---
title: "RE: missing keys?"
description: ""
project: community
lastmod: 2012-09-14T08:09:01-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08539"
mailinglist_parent_id: "msg08538"
author_name: "Pat Lynch"
project_section: "mailinglistitem"
sent_date: 2012-09-14T08:09:01-07:00
---


Hi Sean,
thanks for the very quick response :) - much appreciated. No, I didn't put any 
retries in the code at all.

So, if I write a key to a cluster and then try to query that key, it may not 
find it unless I retry? Even if r=2 & w=2 ? I thought that at least 2 systems 
had to have that key (either in memory or disk) for the write to have succeeded 
with those settings? If I had w=3, would you expect any missed keys ?? (note 
that I didn't try that because I expected performance issues).

Is it possible that I'd need to retry more than once? I guess the issue I have 
is (when it comes to real world usage) when do I give up checking if a key is 
there - it might genuinely not be there, or just not replicated yet?

I'll be running the tests again after the w/e (probably Monday or Tuesday), so 
hopefully I'll get more information there (and add a retry :))

thanks again,

Pat.


> Date: Fri, 14 Sep 2012 10:50:06 -0400
> Subject: Re: missing keys?
> From: s...@basho.com
> To: plynch1...@hotmail.com
> CC: riak-users@lists.basho.com
> 
> Pat,
> 
> Does your test use retries when it gets "not found" responses? You
> might not encounter that small % of missing keys if you retry at least
> once when they are missing. Because of the eventually consistent
> design of Riak, writes you make might not be readable immediately.
> 
> On Fri, Sep 14, 2012 at 10:17 AM, Pat Lynch  wrote:
> > Hi all,
> > I was just wondering if you could give me some feedback on my usage of RIAK.
> > I'm currently testing a number of datastores and am trying to come up with
> > pros/ cons of each.
> >
> > I have a variety of tests (write speed 1 client, write speed 10 clients,
> > read speed 1 client, read speed 10 clients, read while writing, write while
> > reading etc). The data set is tiny for this phase (10k, 50k, 100k).
> >
> > I have 3 machines in the cluster (each with 12GB RAM, quadcore CPUs, 500GB
> > drives), each cache setup to use 128MB memory (eleveldb). Each key is 64
> > bytes. and each value is 512 bytes.
> >
> >
> > The write speed I'm getting is around 260.0440791 per second (using 1
> > client), scaling to 2281.1662 writes per second (using 10 clients).
> > The read speed I'm getting is around 397.2291042 per second (using 1
> > client), scaling to 3316.089445 reads per second (using 10 clients).
> >
> > One very worrying thing I noticed is that I sometimes miss keys? i.e. I
> > write 100k keys to disk, then read them all back in and check the value
> > matches expected. This would only happen for 1 or 2 keys out of 100k, but
> > (1 or 2 keys is enoughâ€¦)
> >
> > This is using the latest version of RIAK with the python client (python
> > client is running on a 4th machine).
> >
> > Any help would be greatly appreciated.
> >
> > thanks,
> > Pat.
> >
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >
> 
> 
> 
> -- 
> Sean Cribbs 
> Software Engineer
> Basho Technologies, Inc.
> http://basho.com/
 \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

