---
title: "Re: Monitoring protobuffs and CPU usage on a Riak KV cluster"
description: ""
project: community
lastmod: 2015-08-06T05:20:08-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16369"
mailinglist_parent_id: "msg16365"
author_name: "Matthew Von-Maszewski"
project_section: "mailinglistitem"
sent_date: 2015-08-06T05:20:08-0700
---


Two ideas about lots of cpu with nothing happening:

- is Riak entropy setting "active". Weekly it will rebuild hash trees

- does this activity occur after a handoff? Sometimes leveldb needs time to 
catch up afterward in current releases (fix coming soon). 

Matthew

Sent from my iPad

> On Aug 5, 2015, at 7:16 PM, Matthew Brender  wrote:
> 
> Hey all, I'm practicing what I preach and asking a question to others
> here. A community member pinged me with a couple questions:
> 
> "I'm looking into an issue with Riak on our test environment (we
> basically let devs spin up a copy of our prod stack on a giant box in
> ec2).
> 
> We've gotten some complaints that riak seems to be using a lot of CPU,
> even when "nothing" is happening (something is always happening with
> the # of apps and services on the box, even when no one is poking it).
> 
> Is there a way to turn on an "access" log, so I could see what
> requests are being made against riak, to try and correlate with? It
> would have to be able to tell me about pbuffs usage, not just http."
> 
> Could anyone help with these questions. I see a couple separate ones:
> 
> 1. How to monitor what is causing higher CPU usage on a Riak cluster
> 2. How to view an access log of protobuff and http requests, or just
> the \*most helpful\* counters for them
> 
> I know a ton of statistics are visible [1] through riak-admin, but I'd
> like to hear what others recommend in particular.
> 
> [1] http://docs.basho.com/riak/latest/ops/running/stats-and-monitoring/
> 
> Thanks,
> 
> Matt Brender | Developer Advocacy Lead
> Basho Technologies
> t: @mjbrender
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

