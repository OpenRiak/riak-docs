---
title: "Re: Using apache as a reverse proxy"
description: ""
project: community
lastmod: 2015-01-15T09:16:16-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15505"
mailinglist_parent_id: "msg15498"
author_name: "Fred Grim"
project_section: "mailinglistitem"
sent_date: 2015-01-15T09:16:16-0800
---


So actually yeah and the problem was the same. However if I hit riak
directly then there is no issue. Are there http settings for riak that
cause the streaming behavior to change when being proxied?

F

On 1/14/15, 10:31 PM, "Toby Corkindale"  wrote:

>Just a thought, but have you tried to replicate the problem when using
>haproxy (with the example configs provided on basho's site)?
>That might let you discover if the problem really IS with Apache, or
>if it's something to do with your Riak config instead.
>
>On 15 January 2015 at 11:05, Fred Grim  wrote:
>> Hello List,
>>
>> So I am using apache on ubuntu as a reverse proxy to a riak cluster.
>>Everything seems to work fine except for largish streaming map reduce
>>queries. The config is:
>> 
>> ServerAdmin aper...@acompany.com
>> 
>> BalancerMember
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_&d=AwICAg&c=Sqcl0Ez6M
>>0X8aeM67LKIiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7
>>PMnXQSchCb1a36y\_3o9wCTLFVK8KJSs0&s=KekvofgBdK\_OC9kN2fd0pOMp3lPUDQsQwu4fRr
>>kc9WU&e= :8098
>> BalancerMember
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_&d=AwICAg&c=Sqcl0Ez6M
>>0X8aeM67LKIiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7
>>PMnXQSchCb1a36y\_3o9wCTLFVK8KJSs0&s=KekvofgBdK\_OC9kN2fd0pOMp3lPUDQsQwu4fRr
>>kc9WU&e= :8098
>> BalancerMember
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_&d=AwICAg&c=Sqcl0Ez6M
>>0X8aeM67LKIiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7
>>PMnXQSchCb1a36y\_3o9wCTLFVK8KJSs0&s=KekvofgBdK\_OC9kN2fd0pOMp3lPUDQsQwu4fRr
>>kc9WU&e= :8098
>> BalancerMember
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_&d=AwICAg&c=Sqcl0Ez6M
>>0X8aeM67LKIiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7
>>PMnXQSchCb1a36y\_3o9wCTLFVK8KJSs0&s=KekvofgBdK\_OC9kN2fd0pOMp3lPUDQsQwu4fRr
>>kc9WU&e= :8098
>> BalancerMember
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_&d=AwICAg&c=Sqcl0Ez6M
>>0X8aeM67LKIiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7
>>PMnXQSchCb1a36y\_3o9wCTLFVK8KJSs0&s=KekvofgBdK\_OC9kN2fd0pOMp3lPUDQsQwu4fRr
>>kc9WU&e= :8098
>> BalancerMember
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_&d=AwICAg&c=Sqcl0Ez6M
>>0X8aeM67LKIiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7
>>PMnXQSchCb1a36y\_3o9wCTLFVK8KJSs0&s=KekvofgBdK\_OC9kN2fd0pOMp3lPUDQsQwu4fRr
>>kc9WU&e= :8098
>> BalancerMember
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_&d=AwICAg&c=Sqcl0Ez6M
>>0X8aeM67LKIiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7
>>PMnXQSchCb1a36y\_3o9wCTLFVK8KJSs0&s=KekvofgBdK\_OC9kN2fd0pOMp3lPUDQsQwu4fRr
>>kc9WU&e= :8098
>> 
>> 
>> ProxyPass balancer://riak\_cluster/
>> ProxyPassReverse balancer://riak\_cluster/
>> 
>> 
>>
>> What happens is that my streamed queries seem to partially come in
>>which makes me think that the load balancer is switching them or
>>something. I know I am missing some config value in here but I cannot,
>>for the life of me, figure out what it is. Does anyone have an example
>>config they could through up?
>>
>> F
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> 
>>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_lists.basho.com\_mailm
>>an\_listinfo\_riak-2Dusers-5Flists.basho.com&d=AwICAg&c=Sqcl0Ez6M0X8aeM67LK
>>IiDJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7PMnXQSchCb
>>1a36y\_3o9wCTLFVK8KJSs0&s=MsEIDP9hnsHgV-B\_0DwIZR4xJbEmFwP3M1b3ULbDXiU&e=
>
>
>
>-- 
>Turning and turning in the widening gyre
>The falcon cannot hear the falconer
>Things fall apart; the center cannot hold
>Mere anarchy is loosed upon the world
>
>\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>riak-users mailing list
>riak-users@lists.basho.com
>https://urldefense.proofpoint.com/v2/url?u=http-3A\_\_lists.basho.com\_mailma
>n\_listinfo\_riak-2Dusers-5Flists.basho.com&d=AwICAg&c=Sqcl0Ez6M0X8aeM67LKIi
>DJAXVeAw-YihVMNtXt-uEs&r=SlFhcqa96v6kZtniOwCKZQ&m=ZJFOfauLKn7PMnXQSchCb1a3
>6y\_3o9wCTLFVK8KJSs0&s=MsEIDP9hnsHgV-B\_0DwIZR4xJbEmFwP3M1b3ULbDXiU&e= 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

