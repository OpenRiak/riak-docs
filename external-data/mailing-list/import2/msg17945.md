---
title: "Re: cluster clear without stopping node"
description: ""
project: community
lastmod: 2017-02-09T06:47:44-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17945"
mailinglist_parent_id: "msg17944"
author_name: "Daniel Miller"
project_section: "mailinglistitem"
sent_date: 2017-02-09T06:47:44-0800
---


Hi Magnus,

Thanks, this is great news! I was worried that clearing a planned node
removal would stop the node from which I was issuing the clear command,
which would be bad. Sounds like I have nothing to worry about in that case.

On running cluster plan multiple times to generate a new plan: this is a
little surprising since I think I’ve done that before but I haven’t
observed it generating a new plan. I’ll try it again.

Thanks for very quick response.
Daniel
​

On Thu, Feb 9, 2017 at 9:27 AM, Magnus Kessler  wrote:

> On 8 February 2017 at 21:33, Daniel Miller  wrote:
>
>> According to the docs
>> 
>> “Running [riak-admin cluster clear] will also stop the current node in
>> addition to clearing any staged changes.
>>
>> Is there a way to clear the current cluster plan without stopping the
>> current node?
>>
> Hi Daniel,
>
> That statement from the docs is wrong. [riak-admin cluster clear] does
> not stop the current node in general. It may stop the node if the command
> is run on a joining node, and the join is cancelled, but should be safe to
> run on all other nodes. I have reached out to the documentation team to get
> this fixed.
>
> Even better (shameless feature request) would be to have a way to “replan”
>> the current plan. That is, clear the plan and then redo the currently
>> planned actions with a single command. Often I have a plan that ends up
>> with an uneven ring allocation and I’ve noticed that I can sometimes get a
>> better allocation if I clear and re-plan several times, but this is tedious.
>>
> You can run [riak-admin cluster plan] more than once before [riak-admin
> cluster commit], and it may generate a different transition plan every
> time depending on cluster state.
>
>
>> Thanks!
>> Daniel​
>>
> Kind Regards,
>
> Magnus
>
>
> --
> Magnus Kessler
> Client Services Engineer
> Basho Technologies Limited
>
> Registered Office - 8 Lincoln’s Inn Fields London WC2A 3BP Reg 07970431
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

