---
title: "The riak-contrib reduce phase to delete Bucket/Key pairs returns	many "not_found" exceptions"
description: ""
project: community
lastmod: 2013-03-24T09:03:10-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10573"
author_name: "thefosk"
project_section: "mailinglistitem"
sent_date: 2013-03-24T09:03:10-07:00
---


I'm trying to delete keys across multiple buckets in a Riak cluster made of
two machines (n\_val = 2). I'm using the Erlang map and reduce scripts that I
found at:

Map: http://contrib.basho.com/get\_keys.html
Reduce: http://contrib.basho.com/delete\_keys.html

Because I don't want to delete every key, I'm executing the map/reduce job
on top of a Secondary Index query. The SI query filters a subset of keys
that I want to delete. When executing the map/reduce job I get many
"not\_found" errors, like:

{"phase":0,"error":"function\_clause","input":"{{error,notfound},{<<\"my\_bucket\">>,<<\"item\_key\">>},undefined}","type":"error","stack":"[{riak\_object,bucket,[{error,notfound}],[{file,\"src/riak\_object.erl\"},{line,251}]},{delete\_map\_function,get\_keys,3,[{file,\"delete\_map\_function.erl\"},{line,7}]},{riak\_kv\_mrc\_map,map,3,[{file,\"src/riak\_kv\_mrc\_map.erl\"},{line,164}]},{riak\_kv\_mrc\_map,process,3,[{file,\"src/riak\_kv\_mrc\_map.erl\"},{line,140}]},{riak\_pipe\_vnode\_worker,process\_input,3,[{file,\"src/riak\_pipe\_vnode\_worker.erl\"},{line,444}]},{riak\_pipe\_vnode\_worker,wait\_for\_input,2,[{file,\"src/riak\_pipe\_vnode\_worker.erl\"},{line,376}]},{gen\_fsm,...},...]"}

This is really weird to me. If the Map function finds an object and properly
returns it to the reduce function, why then the reduce function can't find
the object again? Makes no sense at all.

Thanks



--
View this message in context: 
http://riak-users.197444.n3.nabble.com/The-riak-contrib-reduce-phase-to-delete-Bucket-Key-pairs-returns-many-not-found-exceptions-tp4027353.html
Sent from the Riak Users mailing list archive at Nabble.com.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

