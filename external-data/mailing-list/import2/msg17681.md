---
title: "Re: High number of Riak buckets"
description: ""
project: community
lastmod: 2016-09-30T12:24:37-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17681"
mailinglist_parent_id: "msg17679"
author_name: "Vikram Lalit"
project_section: "mailinglistitem"
sent_date: 2016-09-30T12:24:37-0700
---


Hi Luke - many thanks... actually I was planning to have different bucket
types have a different n\_val. Or I might end up doing so... the thinking
being that I intend to start my production workloads with fewer
replications, but as the system matures / stabilizes (and also increases in
userbase!), I would want to increase n\_val.

In my testing that I had done a few weeks ago, each time I tried to
increase the n\_val of an existing bucket, I've found conflicting results
(prior question here:
http://lists.basho.com/pipermail/riak-users\_lists.basho.com/2016-July/018631.html)
- perhaps due to read-repair taking time - not sure. Understood though from
various Riak papers that decreasing n\_val should not be done, but couldn't
conclude yet as to why would increasing be an issue...

So to avoid the scenario, I've been thinking that as the system criticality
increases, I would create a new bucket (with a higher n\_val) and then start
pushing newer conversations on to that bucket. Still not sure how this
would behave, but let me test further with bucket types as you suggest...

Do let know please if there's something glaring I'm missing as am trying to
clarify the thought-process to myself as well!!!

Cheers.

On Fri, Sep 30, 2016 at 12:07 PM, Luke Bakken  wrote:

> Hi Vikram,
>
> If all of your buckets use the same bucket type with your custom
> n\_val, there won't be a performance issue. Just be sure to set n\_val
> on the bucket type, and that all buckets are part of that bucket type.
>
> http://docs.basho.com/riak/kv/2.1.4/developing/usage/bucket-types/
>
> --
> Luke Bakken
> Engineer
> lbak...@basho.com
>
> On Thu, Sep 29, 2016 at 4:42 PM, Vikram Lalit 
> wrote:
> > Hi - I am creating a messaging platform wherein am modeling each topic to
> > serve as a separate bucket. That means there can potentially be millions
> of
> > buckets, with each message from a user becoming a value on a distinct
> > timestamp key.
> >
> > My question is there any downside to modeling my data in such a manner?
> Or
> > can folks advise a better way of storing the same in Riak?
> >
> > Secondly, I would like to modify the default bucket properties (n\_val) -
> I
> > understand that such 'custom' buckets have a higher performance overhead
> due
> > to the extra load on the gossip protocol. Is there a way the default
> n\_val
> > of newly created buckets be changed so that even if I have the above said
> > high number of buckets, there is no performance degrade? Believe there
> was
> > such a config allowed in app.config but not sure that file is leveraged
> any
> > more after riak.conf was introduced.
> >
> > Thanks much.
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

