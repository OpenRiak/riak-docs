---
title: "Pipe worker startup failed:fitting was gone before startup"
description: ""
project: community
lastmod: 2013-03-31T00:14:03-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10630"
mailinglist_parent_id: "msg09287"
author_name: "郎咸武"
project_section: "mailinglistitem"
sent_date: 2013-03-31T00:14:03-07:00
---


Hi:
This is my code[1]. The error log is [2] and[3].
May be this is \* [{<<"}~\bgQU&\331">>\*,{1,63531874791}}] cause error. I am
not sure.
Please give some idea. Thanks all.

Jason

[1]
 62 map(Record, undefined, {get\_bucket\_and\_key, Bucket, Key}) ->
 63 ?DEBUG("~p:map ~p Record=~p~n", [?MODULE, ?LINE, Record]),
 64 case riak\_kv\_util:is\_x\_deleted(Record) of
 65 false ->
 66 ?DEBUG("~p:map ~p Record=~p~n", [?MODULE, ?LINE, record]),

 67 {struct, List} =
mochijson:decode(riak\_object:get\_value(Record)),
 68 ?DEBUG("~p:map ~p List=~p~n", [?MODULE, ?LINE, List]),
 69 case proplists:get\_value(Key, List, null) of
 70 null -> [];
 71 Id when is\_list(Id)->
 72 ?DEBUG("~p:map ~p Id=~p~n", [?MODULE, ?LINE, Id]),
 73 case re:split(Id, "-") of
 74 [NewKey] ->NewKey;
 75 [\_, NewKey] ->NewKey
 76 end,
 77 ?DEBUG("~p:map ~p Id=~p~n", [?MODULE, ?LINE, Id]),
 78 R = [{Bucket, NewKey,
proplists:get\_value("time\_int", List, "")}],
 79 ?DEBUG("~p:map ~p R=~p~n", [?MODULE, ?LINE, R]),
 80 R;
 81 \_ -> []
 82 end;
 83 \_ -> []
 84 end;



[2]
4:45:29.391 [error] Pipe worker startup failed:fitting was gone before
startup
14:45:29.392 [error] Pipe worker startup failed:fitting was gone before
startup
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1233142006497949337234359077604363797834693083136,<0.960.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1335903840372778448670555667404727447654250840064,<0.978.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1438665674247607560106752257205091097473808596992,<0.996.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1096126227998177188652763624537212264741949407232,<0.936.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1370157784997721485815954530671515330927436759040,<0.984.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1267395951122892374379757940871151681107879002112,<0.966.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1404411729622664522961353393938303214200622678016,<0.990.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1198888061873006300088960214337575914561507164160,<0.954.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1301649895747835411525156804137939564381064921088,<0.972.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.392 [error] Pipe worker startup failed:

 
exit:{shutdown,{gen\_fsm,sync\_send\_event,[<11751.9518.122>,{get\_details,#Ref<11751.0.118.27604>,1130380172623120225798162487804000148015135326208,<0.942.0>}]}}

 
[{gen\_fsm,sync\_send\_event,2},{riak\_pipe\_fitting,get\_details,2},{riak\_pipe\_vnode,new\_worker,2},{riak\_pipe\_vnode,enqueue\_internal,3},{riak\_core\_vnode,vnode\_coverage,4},{gen\_fsm,handle\_msg,7},{proc\_lib,init\_p\_do\_apply,3}]
14:45:29.484 [error] Pipe worker startup failed:fitting was gone before
startup
14:45:39.018 [info] Receiving handoff data for partition
riak\_kv\_vnode:342539446249430371453988632667878832731859189760
14:45:39.129 [info] Handoff receiver for partition
342539446249430371453988632667878832731859189760 exited after processing 1
objects
14:45:39.134 [info] Receiving handoff data for partition
riak\_kv\_vnode:993364394123348077216567034736848614922391650304
14:45:39.134 [info] Receiving handoff data for partition
riak\_kv\_vnode:1255977969581244695331291653115555720016817029120
14:45:39.235 [info] Handoff receiver for partition
993364394123348077216567034736848614922391650304 exited after processing 3
objects
14:45:39.235 [info] Handoff receiver for partition
1255977969581244695331291653115555720016817029120 exited after processing 4
objects
14:45:39.262 [info] Receiving handoff data for partition
riak\_kv\_vnode:1198888061873006300088960214337575914561507164160
14:45:39.270 [info] Receiving handoff data for partition
riak\_kv\_vnode:1255977969581244695331291653115555720016817029120
14:45:39.367 [info] Handoff receiver for partition
1198888061873006300088960214337575914561507164160 exited after processing 4
objects
14:45:39.379 [info] Handoff receiver for partition
1255977969581244695331291653115555720016817029120 exited after processing 4
objects
14:45:39.421 [info] Receiving handoff data for partition
riak\_kv\_vnode:57089907708238395242331438777979805455309864960
14:45:39.422 [info] Receiving handoff data for partition
riak\_kv\_vnode:867766597165223607683437869425293042920709947392
14:45:39.527 [info] Handoff receiver for partition
57089907708238395242331438777979805455309864960 exited after processing 3
objects
14:45:39.528 [info] Handoff receiver for partition
867766597165223607683437869425293042920709947392 exited after processing 4
objects
14:45:39.537 [info] Receiving handoff data for partition
riak\_kv\_vnode:605153021707326989568713251046585937826284568576
14:45:39.537 [info] Receiving handoff data for partition
riak\_kv\_vnode:148433760041419827630061740822747494183805648896
14:45:39.638 [info] Handoff receiver for partition
148433760041419827630061740822747494183805648896 exited after processing 1
objects
14:45:39.641 [info] Handoff receiver for partition
605153021707326989568713251046585937826284568576 exited after processing 2
objects
trend\_riak:map 63 Record={r\_object,<<"friendships">>,
 <<"YbSXPLlPLiWThAwXi1zkqIfRj5H">>,
 [{r\_content,
 {dict,4,16,16,8,80,48,

{[],[],[],[],[],[],[],[],[],[],[],[],[],
 [],[],[]},
 {{[],[],[],[],[],[],[],[],[],[],
 [[<<"content-type">>,97,112,112,108,
 105,99,97,116,105,111,110,47,106,
 115,111,110],

 [<<"X-Riak-VTag">>,54,117,121,55,65,
 112,118,55,117,81,57,71,73,115,97,
 112,110,55,67,106,119,108]],
 [[<<"index">>,
 {<<"followed\_id\_bin">>,

 <<131,107,0,33,117,115,101,114,115,

 45,75,84,103,71,89,105,83,71,67,

 88,100,105,110,119,52,90,53,112,

 122,119,88,108,99,55,119,72,107>>},
 {<<"follower\_id\_bin">>,
 <<131,107,0,33,117,115,101,114,
 115,45,73,82,88,67,54,105,116,
 68,101,80,84,101,69,107,77,73,
 90,79,67,51,116,97,103,88,114,
 65,109>>}]],
 [],
 [[<<"X-Riak-Last-Modified">>|
 {1364,655591,424108}]],
 [],[]}}},
 <<"{\"timestamp\":\"2013-01-22
15:10:31\",\"time\_int\":63526086631,\"followed\_id\":\"users-KTgGYiSGCXdinw4Z5pzwXlc7wHk\",\"follower\_id\":\"users-IRXC6itDePTeEkMIZOC3tagXrAm\",\"type\":\"0\"}">>}],
 \* [{<<"}~\bgQU&\331">>\*,{1,63531874791}}], \* Why
is this?\*
 {dict,1,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],[],[],
 [],[]},

 {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],
 [[clean|true]],
 []}}},
 undefined}
14:45:41.333 [error] Pipe worker startup failed:fitting was gone before
startup
14:45:41.335 [error] Pipe worker startup failed:fitting was gone before
startup
14:46:39.020 [info] Receiving handoff data for partition
riak\_kv\_vnode:548063113999088594326381812268606132370974703616
14:46:39.130 [info] Handoff receiver for partition
548063113999088594326381812268606132370974703616 exited after processing 1
objects
14:46:39.136 [info] Receiving handoff data for partition
riak\_kv\_vnode:239777612374601260017792042867515182912301432832
14:46:39.136 [info] Receiving handoff data for partition
riak\_kv\_vnode:765004763290394496247241279624929393101152190464
14:46:39.237 [info] Handoff receiver for partition
239777612374601260017792042867515182912301432832 exited after processing 3
objects
14:46:39.242 [info] Handoff receiver for partition
765004763290394496247241279624929393101152190464 exited after processing 4
objects
14:46:39.266 [info] Receiving handoff data for partition
riak\_kv\_vnode:1301649895747835411525156804137939564381064921088
14:46:39.266 [info] Receiving handoff data for partition
riak\_kv\_vnode:559481095540736273374848100024202093462036676608
14:46:39.373 [info] Handoff receiver for partition
1301649895747835411525156804137939564381064921088 exited after processing 2
objects
14:46:39.373 [info] Handoff receiver for partition
559481095540736273374848100024202093462036676608 exited after processing 5
objects
14:46:39.423 [info] Receiving handoff data for partition
riak\_kv\_vnode:68507889249886074290797726533575766546371837952
14:46:39.423 [info] Receiving handoff data for partition
riak\_kv\_vnode:525227150915793236229449236757414210188850757632
14:46:39.529 [info] Handoff receiver for partition
68507889249886074290797726533575766546371837952 exited after processing 3
objects
14:46:39.530 [info] Handoff receiver for partition
525227150915793236229449236757414210188850757632 exited after processing 4
objects
14:46:39.538 [info] Receiving handoff data for partition
riak\_kv\_vnode:570899077082383952423314387779798054553098649600
14:46:39.539 [info] Receiving handoff data for partition
riak\_kv\_vnode:331121464707782692405522344912282871640797216768
14:46:39.646 [info] Handoff receiver for partition
570899077082383952423314387779798054553098649600 exited after processing 4
objects
14:46:39.646 [info] Handoff receiver for partition
331121464707782692405522344912282871640797216768 exited after processing 4
objects




[3]
(trends@192.168.0.77)1> b
=ERROR REPORT==== 31-Mar-2013::14:47:20 ===
{{case\_clause,{error,<<"{\"phase\":0,\"error\":\"function\_clause\",\"input\":\"{ok,{r\_object,<<\\\"friendships\\\">>,<<\\\"Z2gCucdDpBw91TEPQBaIm1zBvA6\\\">>,[{r\_content,{dict,4,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[],[],[],[],[],[],[],[],[[<<\\\"content-type\\\">>,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110],[<<\\\"X-Riak-VTag\\\">>,53,69,88,108,104,114,74,112,111,79,73,78,101,102,56,67,118,114,90,121,52,75]],[[<<\\\"index\\\">>,{<<\\\"followed\_id\_bin\\\">>,<<131,107,0,33,117,115,101,114,115,45,52,118,104,109,72,50,111,112,57,98,51,70,77,119,70,55,84,...>>},...]],...}}},...}],...},...}\",\"type\":\"error\",\"stack\":\"[{trend\_riak,map,[{r\_object,<<\\\"friendships\\\">>,<<\\\"Z2gCucdDpBw91TEPQBaIm1zBvA6\\\">>,[{r\_content,{dict,4,16,16,8,80,48,{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},{{[],[],[],[],[],[],[],[],[],[],[[<<\\\"content-type\\\">>,97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110],[<<\\\"X-Riak-VTag\\\">>,53,69,88,108,104,114,74,112,111,79,73,78,101,102,56,67,118,114,90,121,52,75]],[[<<\\\"index\\\">>,{<<\\\"followed\_id\_bin\\\">>,<<131,107,0,33,117,115,101,114,115,45,52,118,104,109,72,50,111,112,57,98,51,70,...>>},...]],...}}},...}],...},...]},...]\"}">>}},
 [{trends\_utils,get\_user\_bucket\_key,3},
 {trends\_db,get\_followers\_count,1},
 {trends\_utils,'-get\_ext\_columns/2-fun-0-',3},
 {lists,foldr,3},
 {trends\_statuses\_controller,rankings,3},
 {boss\_web\_controller,execute\_action,5},
 {boss\_web\_controller,process\_request,5},
 {timer,tc,3}]}


-- 
只为成功找方法，不为失败找理由
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

