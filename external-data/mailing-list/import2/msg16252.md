---
title: "Strong consistency only for missing keys?"
description: ""
project: community
lastmod: 2015-06-18T17:14:19-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16252"
author_name: "Ilya Kutukov"
project_section: "mailinglistitem"
sent_date: 2015-06-18T17:14:19-0700
---


Hi!

I am planning to maintain session storage over Riak KV.

Core case: when user is signing in to the service session token with some
meta is returning to the client and then saving for further usage. At the
back-end side this session key is placing to the session storage.

Riak could response false "not found" when user is providing client-side
token on next request, what following instantly after the session record is
placed to Riak.

>From the end-user POV you log in, than you surprisingly not logged in, then
you are refreshing/restarting client and everything is back to normal. Bad
glitchy case.

Riak have typical distributed DB problems when you are reading after write
instantly. Also there is a high consistency mode with performance
trade-offs.

Is it possible to configure or modify Riak cluster to act hybrid way:

Normally cluster is working in HA mode. E.g. on secondary index searches,
updates, deletions of the existing keys.

But when you are directly asking for the key that seems to be missing the
full quorum is required to claim that there is really no such key on all
nodes in according partition to say "No". Any other case is "Yes" after
long or a short delay.
In theory, such behaviour will make deletion of keys slower, but situation
with false "not found" will be better.

Or i'm missing some obvious way to resolve read-after-write problem like
proxying requests to the session storage through the single instance 3-rd
party cache?


-- 
Best regards,
Ilya Kutukov

+7 962 909 10 35
post.i...@gmail.com
skype: blinkedeye
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

