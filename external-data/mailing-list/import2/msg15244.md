---
title: "Re: How to update existed schema"
description: ""
project: community
lastmod: 2014-11-25T09:46:21-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg15244"
mailinglist_parent_id: "msg15243"
author_name: "Eric Redmond"
project_section: "mailinglistitem"
sent_date: 2014-11-25T09:46:21-0800
---


Yes, to be clear, there are currently a few options to reindex a schema change. 
After you update the schema, you can:

1. create a new index and reattach
2. rewrite every value inline
3. delete the index directories on every node and let AAE rebuild them

The new change will create a 4th option:

4. update the schema and let AAE fix the index.

Then, we're working on a 5th option:

5. modify schemas via command-line, and start an inline, eventually consistent 
index update

And potentially a 6th option:

6. modify schemas via command-line, and force an atomic index update

I can't post any ETAs, but "soon".

Eric



On Nov 25, 2014, at 9:35 AM, Alexander Sicular  wrote:

> You basically need to read and re-write each key as Geoff says. Hopefully 
> this gets automated in the future in some fashion. 
> 
> -Alexander 
> 
> @siculars
> http://siculars.posthaven.com
> 
> Sent from my iRotaryPhone
> 
> On Nov 25, 2014, at 12:31, Geoff Garbers  wrote:
> 
>> Hey Zhenguo.
>> 
>> I've actually just gone through something similar myself recently.​ ​I found 
>> that the most reliable way to do this is as follows:
>> 
>> 1. Update the schema (as you have shown)
>> 2. Attach to the Erlang console on each node, and run 
>> rp(yz\_index:reload(<<"index\_name">>)).
>> ​3. List all keys in the buckets with your bucket type, and pull and put 
>> each of the objects in those buckets.
>> 
>> It's not the most ideal way, but it's the most effective (from what I've 
>> found) until the new sear​ch administration functionality becomes available.
>> 
>> Regards,
>> Geoff
>> 
>> 
>> 
>> Geoffrey Garbers
>> Senior Developer
>> 
>> 
>> 
>> Cell: +27 (0)766 476 920
>> Skype: geoff.garbers
>> ge...@totalsend.com
>> www.totalsend.com
>> 
>> +1 347-431-0494
>> +44 (0)203 519 1082
>> +61 (0)3 9111 5760
>> +27 (0)21 200 6981
>> 
>> On Tue, Nov 25, 2014 at 6:46 PM, Yang Zhenguo  wrote:
>> Any other options? :)
>> 
>> 2014-11-26 0:42 GMT+08:00 Eric Redmond :
>> Yes, that is one of the options.
>> 
>> Eric
>> 
>> 
>> On Nov 25, 2014, at 8:40 AM, Yang Zhenguo  wrote:
>> 
>>> Hi Eric,
>>> 
>>> Any suggestion for my requirement? create a new search index?
>>> 
>>> Regards,
>>> Zhenguo
>>> 
>>> 
>>> 2014-11-26 0:24 GMT+08:00 Eric Redmond :
>>> Automatic updating of indexes due to schema changes doesn't exist yet. 
>>> It'll be added soon:
>>> 
>>> https://github.com/basho/yokozuna/pull/427
>>> 
>>> Eric
>>> 
>>> 
>>> On Nov 25, 2014, at 8:21 AM, Yang Zhenguo  wrote:
>>> 
>>>> I have an existed schema and I want to add one column in it, such as 
>>>> 
>>>> 
>>>> 
>>>> What's the steps to update it?
>>>> 
>>>> Since there is the search\_index related to the schema and a bucket type 
>>>> related to the search\_index.
>>>> 
>>>> I tried to update the schema by the following commands:
>>>> {ok, SchemaData} = file:read\_file("cartoons.xml"),
>>>> riakc\_pb\_socket:create\_search\_schema(Pid, <<"cartoons">>, SchemaData).
>>>> 
>>>> However, I can not search the object with new field.
>>>> 
>>>> Thanks in advance.
>>>> 
>>>> Regards,
>>>> -- 
>>>> Zhenguo Yang
>>>> www.prinbit.com
>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>>> riak-users mailing list
>>>> riak-users@lists.basho.com
>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>> 
>>> 
>>> 
>>> 
>>> -- 
>>> Zhenguo Yang
>>> MSN: zgyang...@hotmail.com
>> 
>> 
>> 
>> 
>> -- 
>> Zhenguo Yang
>> MSN: zgyang...@hotmail.com
>> 
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>> 
>> 
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

