---
title: "Re: Deleting items from search index increases disk usage"
description: ""
project: community
lastmod: 2012-11-01T08:25:32-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09105"
mailinglist_parent_id: "msg09090"
author_name: "Jeremy Raymond"
project_section: "mailinglistitem"
sent_date: 2012-11-01T08:25:32-07:00
---


I reindexed a bunch of items that are still in the search index but no
disk space was reclaimed. Is there any Riak console Erlang voodoo I
can do to convince Riak Search that now would be a good time to
compact the merge\_index?

--
Jeremy


On Tue, Oct 30, 2012 at 4:26 PM, Jeremy Raymond  wrote:
> I've posted the list of buffer files [1] and segment files [2].
>
> The current data set I have in Riak is static, so no new items are
> being written. So this looks like the reason as to why compaction
> isn't happening since there is no time based trigger on the merge
> index. To get compaction to kick in, I should be able to to just
> reindex (by reading and rewriting) some of the existing items in
> buckets that are still indexed? Earlier today I upgraded to Riak 1.2
> and ran a Search read repair [3] in an attempt to kick of compaction.
> Compaction didn't kick in, but instead disk consumption increased
> again. Should Search Repair trigger compaction or only writing objects
> to the KV store?
>
> [1]:https://gist.github.com/3982718
> [2]:https://gist.github.com/3982730
> [3]:http://docs.basho.com/riak/latest/cookbooks/Repairing-Search-Indexes/#Running-a
> Repair
>
> --
> Jeremy
>
>
> On Tue, Oct 30, 2012 at 3:47 PM, Ryan Zezeski  wrote:
>> find /var/lib/riak/merge\_index -name 'buffer.\*' | xargs ls -lah
>>
>> find /var/lib/riak/merge\_index -name 'segment.\*' | xargs ls -lah

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

