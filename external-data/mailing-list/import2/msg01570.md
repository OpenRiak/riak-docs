---
title: "Re: riak hangs"
description: ""
project: community
lastmod: 2010-11-18T12:49:47-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01570"
mailinglist_parent_id: "msg01569"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-11-18T12:49:47-08:00
---


{error,emfile} generally means that you don't have enough file descriptors 
available to the process. Set `ulimit -n` higher when starting Riak or use 
sysctl to increase the limit.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Nov 18, 2010, at 3:47 PM, Andrea Campolonghi wrote:

> Hi,
> 
> I am testing riak on an ubuntu 64 bit (10.10).
> After few operations riak hangs and I find this log report:
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> application: mochiweb
> "Accept failed error"
> "{error,emfile}"
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: ./lib.beam. Function: get\_file. 
> Process: code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/kernel-2.13.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/stdlib-1.16.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/sasl-2.1.9/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/os\_mon-2.2.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/crypto-1.6.4/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/runtime\_tools-1.8.3/ebin/lib.beam. Function: get\_file. 
> Process: code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/erlang\_js-0.4.1/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/mochiweb-1.7.1/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/webmachine-1.7.2/ebin/lib.beam. Function: get\_file. 
> Process: code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/luke-0.2.1/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/bitcask-1.1.4/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/riak\_core-0.13.0/ebin/lib.beam. Function: get\_file. 
> Process: code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/riak\_kv-0.13.0/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/skerl-0.1/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/luwak-1.0/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/xmerl-1.2.4/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/webtool-0.8.6/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/tools-2.6.5.1/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/syntax\_tools-1.6.5/ebin/lib.beam. Function: get\_file. 
> Process: code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/ssl-3.10.8/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/snmp-4.16/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/riakc-1.0.1/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/public\_key-0.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/protobuffs-0.5.0/ebin/lib.beam. Function: get\_file. 
> Process: code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/otp\_mibs-1.0.6/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/mnesia-4.4.13/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/inets-5.3/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/hipe-3.7.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/eunit-2.1.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/erts-5.7.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/ebloom-1.0.2/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: 
> /usr/lib/riak/lib/compiler-4.6.5/ebin/lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> File operation error: emfile. Target: lib.beam. Function: get\_file. Process: 
> code\_server.
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> \*\* gen\_event handler sasl\_report\_file\_h crashed.
> \*\* Was installed in error\_logger
> \*\* Last event was: {error\_report,<0.95.0>,
> {<0.1703.0>,crash\_report,
> [[{initial\_call,
> {mochiweb\_acceptor,init,
> ['Argument\_\_1','Argument\_\_2',
> 'Argument\_\_3']}},
> {pid,<0.1703.0>},
> {registered\_name,[]},
> {error\_info,
> {exit,
> {error,accept\_failed},
> [{mochiweb\_acceptor,init,3},
> {proc\_lib,init\_p\_do\_apply,3}]}},
> {ancestors,
> [webmachine\_mochiweb,riak\_core\_sup,<0.96.0>]},
> {messages,[]},
> {links,[<0.108.0>]},
> {dictionary,[]},
> {trap\_exit,false},
> {status,running},
> {heap\_size,233},
> {stack\_size,24},
> {reductions,207}],
> []]}}
> \*\* When handler state == {<0.40.0>,"/var/log/riak/sasl-error.log",error}
> \*\* Reason == {'module could not be loaded',
> [{lib,format\_exception,
> [5,exit,
> {error,accept\_failed},
> [{mochiweb\_acceptor,init,3},
> {proc\_lib,init\_p\_do\_apply,3}],
> #Fun,#Fun]},
> {proc\_lib,format\_exception,3},
> {proc\_lib,format\_rep,1},
> {proc\_lib,format\_rep,1},
> {proc\_lib,format\_rep,1},
> {proc\_lib,format,1},
> {sasl\_report,write\_report2,5},
> {sasl\_report\_file\_h,handle\_event,2}]}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:04 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> =ERROR REPORT==== 18-Nov-2010::21:42:05 ===
> {mochiweb\_socket\_server,256,{acceptor\_error,{error,accept\_failed}}}
> 
> 
> Any suggestion?
> 
> Thanks
> 
> Andrea
> 
> -- 
> Andrea Campolonghi
> 
> Cell : +39 347 2298435
> acampolon...@gmail.com
> and...@andreacfm.com
> http://www.andreacfm.com
> 
> Railo Team
> and...@getrailo.org
> http://getrailo.org
> 
> 
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

