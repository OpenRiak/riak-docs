---
title: "Re: Nodes neither leaving nor joining the cluster"
description: ""
project: community
lastmod: 2011-11-09T09:31:24-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05507"
mailinglist_parent_id: "msg05506"
author_name: "Nitish Sharma"
project_section: "mailinglistitem"
sent_date: 2011-11-09T09:31:24-08:00
---


Hi Alexandre,
Fortunately its a test cluster. Removing the ring files, stopping and
starting the nodes, and then again running \*join \*brought the cluster in
desirable state.
Name and IP of all the nodes was same all the time, still restarting a
single node brought the whole cluster in inconsistent state. Weird!

Thanks for the tip, though.

Regards
Nitish
On Wed, Nov 9, 2011 at 5:54 PM, Alexandre Ravey
wrote:

> Hi Nitish,
>
> Did you change the node name or IP at any point?
> If so, you need to reip your node(s).
>
> Run riak-admin status and check the node name in ring\_members, must be
> the same as your actual node. (ie, same ip and node name).
> Check also that you are not using xxx@127.0.0.1 if your nodes aren't
> on the same physical box.
>
> If it's a test cluster you may just rm /var/lib/riak/ring/\* (node
> down) and join again.
>
> Regards
>
> Alexandre
>
> On Wed, Nov 9, 2011 at 5:38 PM, Nitish Sharma
>  wrote:
> > Hi,
> > I've installed riak using pre-compiled Debian binary. I setup a Riak
> cluster
> > consisting of 3 nodes (name of each node in format: riak@). The
> > configuration file for all the nodes is same.
> > Just to clarify my problem, I'll be using node names as A, B, and C.
> > Initially, all three nodes were successfully able to form a cluster ( B
> and
> > C joined node A). To perform some tests, node A rebooted and after that
> its
> > ``status" is not showing all three nodes as ring\_members. While, running
> > ``riak-admin status" on nodes B and C was still stating ring\_members as
> A,
> > B, C.
> > Running ``riak-admin leave" on nodes B and C didnt help, since
> > running join command again was throwing "Failed: This node is already a
> > member of a cluster". Force removal of nodes also didnt do any good;
> still
> > the same inconsistent ring members status.
> > Any suggestions ?
> > Regards
> > Nitish
> >
> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> > riak-users mailing list
> > riak-users@lists.basho.com
> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >
> >
>
t
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

