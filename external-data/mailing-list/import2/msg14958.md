---
title: "replacing node results in error with diag"
description: ""
project: community
lastmod: 2014-09-30T12:41:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14958"
author_name: "Max Vernimmen"
project_section: "mailinglistitem"
sent_date: 2014-09-30T12:41:18-07:00
---


Hi,

Today I finished upgrading 2.0.0-pre20 to 2.0.0-1. Once that was done I did a 
node replace according to the instructions at 
http://docs.basho.com/riak/latest/ops/running/nodes/replacing/
Once the replacing was done, our monitoring notified us about a problem with 
the cluster. Our monitoring does a 'riak-admin diag' and each of the nodes is 
now giving the output I've posted here: 
https://gist.github.com/anonymous/a3133333a07b0cd1da1c
There is a node being referenced in the diag, which is the replaced node. It is 
no longer in the cluster. I confirmed the ring was settled and in the web 
interface of the cluster the replaced node is no longer listed neither is it in 
the `riak-admin status` output. Only a restart of the riak service on each of 
the nodes resolves the problem. Doing a restart on only one node fixes the diag 
status only for that node.

To me it seems like there is some state left in the cluster nodes after a node 
is replaced, causing the `riak-admin diag` command to fail. Has anyone else 
seen this? Would this classify as a bug or did I simply do something wrong ? :)

Best regards,


Max Vernimmen

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

