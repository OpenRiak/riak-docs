---
title: "Issues with search (2.0)"
description: ""
project: community
lastmod: 2014-08-11T04:16:37-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14638"
author_name: "Chaim Solomon"
project_section: "mailinglistitem"
sent_date: 2014-08-11T04:16:37-07:00
---


Hi,

I've been running into an issue with the yz search acting up.

I've been getting a lot of these:

2014-08-11 06:45:22.005 [error] <0.913.0>@yz\_kv:index:206 failed to index
object {<<"bucketname">>,<<"123">>} with error {"Failed to index
docs",{error,req\_timedout}} because [{yz\_solr,index,3,[{file,"s
rc/yz\_solr.erl"},{line,192}]},{yz\_kv,index,7,[{file,"src/yz\_kv.erl"},{line,258}]},{yz\_kv,index,3,[{file,
"src/yz\_kv.erl"},{line,193}]},{riak\_kv\_vnode,actual\_put,6,[{file,"src/riak\_kv\_vnode.erl"},{line,1416}]},
{riak\_kv\_vnode,perform\_put,3,[{file,"src/riak\_kv\_vnode.erl"},{line,1404}]},{riak\_kv\_vnode,do\_put,7,[{fil
e,"src/riak\_kv\_vnode.erl"},{line,1199}]},{riak\_kv\_vnode,handle\_command,3,[{file,"src/riak\_kv\_vnode.erl"}
,{line,485}]},{riak\_core\_vnode,vnode\_command,3,[{file,"src/riak\_core\_vnode.erl"},{line,345}]}]

and the Java process uses a lot of CPU and eventually runs out of memory or
something like that and gets stuck. Killing the process gets the cluster
back up and running.

I am guessing that it may be data corruption on the yz data on one node.

Clearing away the yz data on that node and restarting riak makes the system
work again - and I guess AAE will rebuild the index.

But I'm wondering why a crashing Java on one node practically takes down
the search on the cluster. Shouldn't Riak be more resilient than that?

Is there a explicit reindex command for the full text search subsystem?

Could Riak keep an eye on the java process and restart it if it crashes or
runs away?

Chaim Solomon
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

