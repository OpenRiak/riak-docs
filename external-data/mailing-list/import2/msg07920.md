---
title: "Re: About second parameter of riakc_pb_socket:mapred"
description: ""
project: community
lastmod: 2012-07-13T06:25:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07920"
mailinglist_parent_id: "msg07918"
author_name: "Bryan Fink"
project_section: "mailinglistitem"
sent_date: 2012-07-13T06:25:31-07:00
---


On Thu, Jul 12, 2012 at 11:10 PM, 郎咸武  wrote:
> But myself function is can not work(Inputs = {modfun, trend\_riak, test,
> [<<"a">>, <<"b">>]}). The "trend\_riak" module is added riak path.
> There are errors in the following:
> {error,<<"Error sending inputs: [{<<\"my\">>,<<\"bu\">>}]">>}
>
> The trend\_riak module code.
> 1 -module(trend\_riak).
> 2
> 3 -export([test/3]).
> 4 [{<<"my">>, <<"bu">>}].
>
> Where is wrong?

Hi, Jason. The "modfun" input type is not widely used outside of Riak,
so its documentation has not spread to most client libraries. A
description of it is available in riak\_kv:

https://github.com/basho/riak\_kv/blob/master/src/riak\_kv\_mrc\_pipe.erl#L39-60

A module implementing that interface looks like this:

 -module(trend\_riak).

 -export([test/3]).

 test(Pipe, \_Arg, \_Timeout) ->
 Inputs = [{<<"my">>, <<"bu">>}],
 [ ok = riak\_pipe:queue\_work(Pipe, Input) || Input <- Inputs ],
 riak\_pipe:eoi(Pipe).

And an example usage is:

 riakc\_pb\_socket:mapred(S,
 {modfun, trend\_riak, test, whatever},
 [{map, {modfun, riak\_kv\_mapreduce,
map\_object\_value}, none, true}]).

Hope that helps,
Bryan

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

