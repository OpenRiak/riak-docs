---
title: "Re: basho_bench crash using PB client"
description: ""
project: community
lastmod: 2010-08-09T14:06:34-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00861"
mailinglist_parent_id: "msg00860"
author_name: "Peter Herndon"
project_section: "mailinglistitem"
sent_date: 2010-08-09T14:06:34-07:00
---


Yes, indeed, that's taken care of it! Thanks very much, Sean.

---Peter
On Aug 9, 2010, at 5:02 PM, Sean Cribbs wrote:

> Try using the uniform\_int\_bin key generator. It looks like your key is an 
> integer and so it's not getting encoded correctly by protobuffs.
> 
> Sean Cribbs 
> Developer Advocate
> Basho Technologies, Inc.
> http://basho.com/
> 
> On Aug 9, 2010, at 4:54 PM, Peter Herndon wrote:
> 
>> Hi all,
>> 
>> I'm running into a crash every time I try to run a benchmark using the
>> PB client. The HTTP raw client works just fine. Can someone give me
>> an idea what the source of the problem might be? I'm a bit stumped as
>> to where to look.
>> 
>> Thanks very much!
>> 
>> Here's the error output from basho\_bench:
>> 
>> =ERROR REPORT==== 9-Aug-2010::16:26:03 ===
>> \*\* Generic server <0.72.0> terminating
>> \*\* Last message in was {req,{rpbgetreq,<<"test">>,15821,1}}
>> \*\* When Server state == {state,{127,0,0,1},
>> 8087,#Port<0.1287>,undefined,undefined,
>> undefined,undefined,
>> {[],[]}}
>> \*\* Reason for termination ==
>> \*\* {function\_clause,[{protobuffs,encode\_internal,[2,15821,bytes]},
>> {protobuffs,encode,3},
>> {riakclient\_pb,iolist,2},
>> {riakc\_pb,encode,1},
>> {riakc\_pb\_socket,send\_request,4},
>> {riakc\_pb\_socket,handle\_call,3},
>> {gen\_server,handle\_msg,5},
>> {proc\_lib,init\_p\_do\_apply,3}]}
>> 
>> 
>> And here's my config:
>> 
>> 
>> {mode, max}.
>> 
>> {duration, 10}.
>> 
>> {concurrent, 1}.
>> 
>> {driver, basho\_bench\_driver\_riakc\_pb}.
>> 
>> {code\_paths, ["deps/stats",
>> "deps/riakc",
>> "deps/protobuffs"]}.
>> 
>> {key\_generator, {uniform\_int, 35000}}.
>> 
>> {value\_generator, {fixed\_bin, 3}}.
>> 
>> {riakc\_pb\_ips, [{127,0,0,1}]}.
>> 
>> {riakc\_pb\_replies, 1}.
>> 
>> {operations, [{get, 1}, {update, 1}]}.
>> 
>> 
>> And here's the crash report from log.sasl.txt:
>> 
>> 
>> =CRASH REPORT==== 9-Aug-2010::16:44:44 ===
>> crasher:
>> initial call: riakc\_pb\_socket:init/1
>> pid: <0.63.0>
>> registered\_name: []
>> exception exit: {function\_clause,
>> [{protobuffs,encode\_internal,[2,15821,bytes]},
>> {protobuffs,encode,3},
>> {riakclient\_pb,iolist,2},
>> {riakc\_pb,encode,1},
>> {riakc\_pb\_socket,send\_request,4},
>> {riakc\_pb\_socket,handle\_call,3},
>> {gen\_server,handle\_msg,5},
>> {proc\_lib,init\_p\_do\_apply,3}]}
>> in function gen\_server:terminate/6
>> ancestors: [<0.62.0>]
>> messages: []
>> links: [<0.62.0>,#Port<0.1284>]
>> dictionary: []
>> trap\_exit: false
>> status: running
>> heap\_size: 377
>> stack\_size: 24
>> reductions: 340
>> neighbours:
>> neighbour: [{pid,<0.62.0>},
>> {registered\_name,[]},
>> {initial\_call,{erlang,apply,2}},
>> {current\_function,{gen,do\_call,4}},
>> {ancestors,[]},
>> {messages,[]},
>> {links,[<0.61.0>,<0.63.0>]},
>> {dictionary,[{random\_seed,{16334,12955,11824}}]},
>> {trap\_exit,false},
>> {status,waiting},
>> {heap\_size,610},
>> {stack\_size,23},
>> {reductions,139}]
>> 
>> 
>> Thanks very much for your assistance,
>> 
>> ---Peter
>> 
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

