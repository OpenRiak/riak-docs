---
title: "Re: basic question: initial server connection failover?"
description: ""
project: community
lastmod: 2010-08-17T09:18:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00910"
mailinglist_parent_id: "msg00908"
author_name: "Les Mikesell"
project_section: "mailinglistitem"
sent_date: 2010-08-17T09:18:18-07:00
---


It's not so much a matter of blocking as that it seems wrong to need to 
add the latency of a forwarding proxy with its own need for a failover 
mechanism in front of something inherently redundant. I sort of like 
the 'smart client', 'dumb server' approach of memcache, but that has the 
problem of needing to reconfigure all the clients when you add servers.


 -Les

On 8/17/2010 11:02 AM, Alexander Sicular wrote:

I can't imagine a circumstance where nginx would block before riak.


@siculars on twitter
http://siculars.posterous.com

Sent from my iPhone

On Aug 17, 2010, at 11:55, TJ Ninneman  wrote:


Les,


I've just glanced over the riak design overview and I think I am
missing something basic in the failover technique. The docs explain
that any node can process any query and that adding nodes will
re-balance the storage. My question is, how does the client know
which server node to contact initially and what happens if that node
is the one that has failed - particularly for the rest interface
where you don't have a special client? Do you typically put server
nodes on the same host as the clients so they can use a localhost
connection, use round robin DNS, put them behind a load balancer or
is there some unique way of handling this?


This really depends on your architecture.

You could elect to use a reverse proxy such as Nginx to automatically
handle request failover and load balancing. Even as fast and reliable
as Nginx is, you still need to be careful not to induce a bottle neck
or single point of failure.

More simply, you could create some sort of a simple connection object
which manages a pool of connections. In this I don't mean a pool of
persistent HTTP keep-alive connections but rather just a simple list
of possible servers which can be used one after another. Depending on
your app you could simply randomize list on each request or keep the
object around globally to round-robin the requests.

TJ
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com



\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

