---
title: "Re: Riak CS race condition at start-up (was: Riak-CS issues when Riak	endpoint fails-over to new server)"
description: ""
project: community
lastmod: 2017-01-20T08:20:43-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17873"
mailinglist_parent_id: "msg17872"
author_name: "Luke Bakken"
project_section: "mailinglistitem"
sent_date: 2017-01-20T08:20:43-0800
---


Hi Toby,

The process you use to run "riak-cs start" could use the "riak-admin
wait-for-service riak\_kv" command to ensure Riak is ready first:

http://docs.basho.com/riak/kv/2.2.0/using/admin/riak-admin/#wait-for-service

--
Luke Bakken
Engineer
lbak...@basho.com


On Thu, Jan 19, 2017 at 5:38 PM, Toby Corkindale  wrote:
> Hi guys,
> I've switched our configuration around, so that Riak CS now talks to
> 127.0.0.1:8087 instead of the haproxy version.
>
> We have immediately re-encountered the problems that caused us to move to
> haproxy.
> On start-up, riak takes slightly longer than riak-cs to get ready, and so
> riak-cs logs the following then exits.
> Restarting riak-cs again (so now 15 seconds after Riak started) results in a
> successful start-up, but obviously this is really annoying for our ops guys
> to have to remember to do after restarting riak or rebooting a machine.

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

