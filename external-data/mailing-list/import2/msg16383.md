---
title: "Re: Re: Riak shuts down itself after couple of minutes"
description: ""
project: community
lastmod: 2015-08-07T09:25:22-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16383"
mailinglist_parent_id: "msg16382"
author_name: "Cuyler Jones"
project_section: "mailinglistitem"
sent_date: 2015-08-07T09:25:22-0700
---


Hi Hao --

As Alex said, the error you're receiving is generally related to open file
limits set by your OS configuration. Riak requires a large number of
available open files handles. You can find information on how to up your
limits here: http://docs.basho.com/riak/latest/ops/tuning/open-files-limit/

Hope that helps!

Thanks!

Cuyler

On Fri, Aug 7, 2015 at 9:13 AM, Hao  wrote:

> Which one? I am bit of lost.
>
> [root@localhost riak\_data]# cat /proc/sys/fs/file-max
> 786810
> [root@localhost riak\_data]# ulimit -Hn
> 4096
> [root@localhost riak\_data]# ulimit -Sn
> 1024
>
> --Hao
>
>
>
> 在 2015-08-07 23:58:56，"Alex Moore"  写道：
>
> Hi Hao,
>
> Looks like you might be running into an EMFILE error:
> http://docs.basho.com/riak/latest/community/faqs/logs/#riak-logs-contain-error-emfile-in-the-message
>
> What’s the open files limit on your nodes?
>
> Thanks,
> Alex
>
> On Aug 7, 2015, at 11:55 AM, 王昊  wrote:
>
> I am running it on a single node.
>
> Using Erlang riak client. I added a map bucket type, create a new index,
> set the index on a bucket, saved a few map data into the bucket. Then I did
> some search. All good. Then I can remember I tried a invalid search query
> like "title\_s\_register:[New movie one]" which shuts down Riak. But it may
> or may not be the first time Riak starts to shut down. I can't remember.
>
> Now Riak itself shut down after running a few minutes. I must have done
> something really wrong. Any idea what I can do? I have tired to restore
> bitcask data folder from a backup from days ago. It didn't help. It still
> crashes.
>
> The console.log is here : http://www.pastebin.ca/3092510
> The error begins at Line 172
>
> Anyone can help? Much appreciated.
>
> -Hao
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

