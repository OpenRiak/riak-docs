---
title: "Re: Speed of linkwalking"
description: ""
project: community
lastmod: 2011-08-30T11:45:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04519"
mailinglist_parent_id: "msg04507"
author_name: "Kev Burns"
project_section: "mailinglistitem"
sent_date: 2011-08-30T11:45:56-07:00
---


Mark,

That's not just a link walk, you're also performing a map operation there.

$client->add($bucketname, 'linkkey1')->
 link()->
 map(array("riak\_kv\_mapreduce", "map\_object\_value")) ->
 run();


If the expected number of returned objects is small, performing the map
phase in PHP may be faster.

- Kev
c: +001 (650) 521-7791


On Tue, Aug 30, 2011 at 7:31 AM, Mark Steele wrote:

> Hi folks,
>
> Just want to know if I'm doing something obviously dumb here.
>
> First the (PHP) code (Sorry of the API is different from the official API,
> we're using a heavily modified version):
>
> 
> $obj1 = $bucket->newObject('linkkey1', array('link1'));
> $obj2 = $bucket->newObject('linkkey2', 'dataforlinkkey2');
> $obj1->addLink($obj2);
> $obj2->addLink($obj1);
> $obj1->store();
> $obj2->store();
>
> $start = microtime(true);
> $blargh = $bucket->get('linkkey2');
> $end = microtime(true);
> printf("Took : %04f\n",$end - $start);
>
> $start = microtime(true);
> $result =
> $client->add($bucketname, 'linkkey1')->
> link()->
> map(array("riak\_kv\_mapreduce", "map\_object\_value")) ->
> run();
> foreach ($result as $data) {
> //var\_dump($data);
> }
> $end = microtime(true);
> printf("Took : %04f\n",$end - $start);
> 
>
> So here's what I'm seeing:
>
> The simple key fetch takes 0.000661 seconds to execute, whereas the
> link-walk takes 0.042043. Ouch. Quite a bit slower. Any ways to speed this
> up?
>
> Cheers,
>
> Mark Steele
> Bering Media Inc.
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

