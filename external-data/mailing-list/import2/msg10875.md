---
title: "Re: Am I misunderstand read and write quorum? Or am I losing writes?"
description: ""
project: community
lastmod: 2013-04-12T10:26:38-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10875"
mailinglist_parent_id: "msg10862"
author_name: "Rob Speer"
project_section: "mailinglistitem"
sent_date: 2013-04-12T10:26:38-07:00
---


Oh hey, I think that was the issue.

What I was getting back was, in fact, an older version of the document. It
hadn't occurred to me that changing a value was a different operation from
just adding a new value that overwrites it. Now that I'm retrieving the
existing object and modifying it, I haven't encountered the problem again.

Thanks!


On Fri, Apr 12, 2013 at 2:30 AM, Erik SÃ¸e SÃ¸rensen  wrote:

> Is there any chance that the key in question exists in the bucket prior to
> the test? If so, then you should update the value (read+write) instead of
> trying to create it as a whole new object. This has to do with the nature
> of vector clocks.
>
> /Erik [not familiar with the Python client API]
>
>
>
> -------- Oprindelig meddelelse --------
> Fra: Rob Speer 
> Dato:
> Til: riak-users Users 
> Emne: Am I misunderstand read and write quorum? Or am I losing writes?
>
>
> My understanding is that if you write a document to a cluster of 4 riak
> servers with w='quorum', then read from that same cluster with r='quorum',
> that the read should reflect the result of the right.
>
> My understanding is also that, in the Python client (version 5525f4f3,
> from master), w = r = 'quorum' by default.
>
> And yet, the following check in my code fails occasionally:
>
> riak\_obj = bucket.new(docid, doc)
> riak\_obj.store()
> echo\_doc = bucket.get(docid).data
> for field in doc:
> assert doc[field] == echo\_doc[field], (doc, echo\_doc)
>
>
> I thought perhaps my W and R settings were wrong and I was just getting
> "eventual consistency", so I tried a very slow version where I waited five
> seconds before reading the updated document. This seems to fail just as
> often. So it doesn't just seem like I'm reading a write that hasn't
> happened yet; it seems that the occasional write may \_never happen at all\_.
>
> Have I misunderstood something? If not, why would this happen, and how can
> I track it down?
> -- Rob
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

