---
title: "Re: consistency impact on performance"
description: ""
project: community
lastmod: 2014-01-23T07:05:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg13459"
mailinglist_parent_id: "msg13437"
author_name: "Satoshi Yamada"
project_section: "mailinglistitem"
sent_date: 2014-01-23T07:05:06-08:00
---


Luke,

Yes, the load looks pretty small in our cluster and that explains what I
saw.
It is interesting to see the difference of the performance between NoSQL
with server-side sharding.

Anyway, thanks for your reply. I'm confident with the result now.

Satoshi



2014/1/22 Luke Bakken 

> Satoshi,
>
> The difference in performance between w=1 and w=3 depends a lot on
> your cluster setup and hardware, as well as cluster load.
>
> In your tests, your cluster is most likely under no load, and all
> vnodes are ready to process incoming messages. In this case w=1 and
> w=3 will have little difference in response time since vnodes will be
> able to respond immediately to the write message.
>
> A better test would be to increase cluster load with a tool like
> basho\_bench and benchmark Riak and Cassandra using that tool.
> --
> Luke Bakken
> CSE
> lbak...@basho.com
>
>
> On Sun, Jan 19, 2014 at 9:55 PM, Satoshi Yamada 
> wrote:
> > Luke,
> >
> > Thanks for your reply.
> >
> > Actually, the size of the data we use for our product is as small as
> > hundreds bytes.
> > I use such data as 330MB because I thought the difference of performance
> > gets clearer by
> > storing big data. I did test similarly when the data size is 1MB and
> 100B,
> > but did not
> > see much difference either.
> >
> > thanks,
> > Satoshi
> >
> >
> >
> >
> > 2014/1/20 Luke Bakken 
> >>
> >> Hi Satoshi,
> >>
> >> When using Riak, your object sizes should ideally be 1MB or less. A
> >> 330MB object will never result in acceptable Riak performance.
> >>
> >> If you intend to store large objects like this I strongly recommend
> >> using Riak CS, which will break up the object for you into chunks that
> >> can be managed by Riak. It also provides an S3-compatible API.
> >>
> >> Please read more about Riak CS here:
> http://docs.basho.com/riakcs/latest/
> >>
> >> Thanks
> >> --
> >> Luke Bakken
> >> CSE
> >> lbak...@basho.com
> >>
> >>
> >> On Sun, Jan 19, 2014 at 9:29 PM, Satoshi Yamada 
> >> wrote:
> >> > Hi, i'm Satoshi, new to riak.
> >> >
> >> > I would like to check how consistency changes impacts on the
> performance
> >> > of
> >> > riak cluster. I used w=1 and w=3, and I expected at least two times
> more
> >> > of
> >> > execution time, but there seems no significant change. I saw more
> >> > difference
> >> > in Cassandra, so I wonder if it's normal in riak or there is something
> >> > wrong
> >> > in my testing. Can anyone give me some advice on it?
> >> >
> >> > I simply checked as shown below.
> >> >
> >> > w=1
> >> > $ time curl -v -XPUT
> >> > http://mycluster.com:8098/buckets/w1/keys/data.tar.gz?w=1 -H
> >> > "X-Riak-Vclock:
> >> > a85hYGB.........." -H "Content-Type: text/plain" --data-binary
> >> > @data.tar.gz
> >> > ...
> >> > ...
> >> > ...
> >> > real 0m27.501s
> >> > user 0m0.378s
> >> > sys 0m0.674s
> >> >
> >> > w=3
> >> > $ time curl -v -XPUT
> >> > http://mycluster.com:8098/buckets/w3/keys/data.tar.gz?w=3 -H
> >> > "X-Riak-Vclock:
> >> > a85hYGB.........." -H "Content-Type: text/plain" --data-binary
> >> > @data.tar.gz
> >> > ...
> >> > ...
> >> > ...
> >> > real 0m29.278s
> >> > user 0m0.398s
> >> > sys 0m0.674s
> >> >
> >> > My cluster consists of 40, all active and healthy machines and running
> >> > riak-1.4.1.
> >> > The data I use is 330MB.
> >> >
> >> > Thanks in advance,
> >> > Satoshi
> >> >
> >> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> >> > riak-users mailing list
> >> > riak-users@lists.basho.com
> >> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >> >
> >
> >
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

