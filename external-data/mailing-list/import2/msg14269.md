---
title: "Re: how to change bucket property when node is down"
description: ""
project: community
lastmod: 2014-05-27T20:17:17-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg14269"
mailinglist_parent_id: "msg14268"
author_name: "Gavin Huang"
project_section: "mailinglistitem"
sent_date: 2014-05-27T20:17:17-07:00
---


Thanks Jordan, I've tried the first option and it works for me.
thanks again for all your help.

Gavin


On Wed, May 28, 2014 at 2:36 AM, Jordan West  wrote:

> Gavin,
>
> Are you able to stop all other traffic to Riak? Testing locally, the
> crashes only start occurring once the first request to a key in the
> mis-configured bucket is issued after restarting. Using curl I am able to
> change the property back to 3, as an integer, as long as no keys are
> requested in that bucket after restarting isn't made.
>
> Otherwise, if you can keep Riak running long enough, executing the
> following from `riak attach` should have the same end result:
>
> riak\_core\_bucket:set\_bucket(<<"b">>, lists:keystore(n\_val, 1,
> riak\_core\_bucket:get\_bucket(<<"b">>), {n\_val, 3})).
>
> A third option, I haven't tried, is to temporarily disable active
> anti-entropy (the subsystem where the error seems to be coming from), until
> you've had a chance to make the fix.
>
> Jordan
>
>
> On Fri, May 23, 2014 at 9:47 PM, Gavin Huang wrote:
>
>> Hi, Alexander
>>
>> Thanks for your reply. the problem I have is riak is down and can not
>> server any requests.
>> I'd like to see if there a solution to "repair" bucket, if the bucket
>> properties are stored in a file in some where.
>>
>> Thanks.
>> Gavin
>>
>>
>> On Sat, May 24, 2014 at 1:52 AM, agrytsenko <
>> alexander.grytse...@dev-pro.net> wrote:
>>
>>> just use curl to set the correct value, e.g.:
>>>
>>> > curl -v -XPUT http://127.0.0.1:8098/buckets/test/props -H
>>> "Content-Type:
>>> > application/json" -d '{"props":{"n\_val":3}}'
>>>
>>> more about bucket properties:
>>>
>>> http://docs.basho.com/riak/latest/dev/references/http/set-bucket-props/#Request
>>>
>>>
>>>
>>>
>>>
>>> --
>>> View this message in context:
>>> http://riak-users.197444.n3.nabble.com/how-to-change-bucket-property-when-node-is-down-tp4031160p4031161.html
>>> Sent from the Riak Users mailing list archive at Nabble.com.
>>>
>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>> riak-users mailing list
>>> riak-users@lists.basho.com
>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>
>>
>>
>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> riak-users mailing list
>> riak-users@lists.basho.com
>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>
>>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

