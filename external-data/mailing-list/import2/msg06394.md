---
title: "Re: Can't start second node in local machine"
description: ""
project: community
lastmod: 2012-01-24T15:49:38-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06394"
mailinglist_parent_id: "msg05682"
author_name: "Jim R. Wilson"
project_section: "mailinglistitem"
sent_date: 2012-01-24T15:49:38-08:00
---


Hi all,

I realize I'm waaaay late to this thread, but wanted to confirm. Yes,
Seven Databases in Seven Weeks[1] does indeed have a Riak chapter. It's
the first NoSQL database we discuss actually.

As a matter of experimentation, we show how to create a multi-node setup on
the same machine, but I concur with Jeremiah that Riak isn't meant to run
this way in production.

[1] http://pragprog.com/book/rwdata/seven-databases-in-seven-weeks

Cheers,

-- Jim R. Wilson (co-author)

On Sat, Nov 19, 2011 at 2:59 PM, Jeremiah Peschka <
jeremiah.pesc...@gmail.com> wrote:

> There are no books about Riak, yet. Mathias Meyer wrote a NoSQL handbook
> that has a chapter about Riak, but I've never read it. Seven Databases in
> Seven Weeks is rumored to contain a chapter about Riak, but it's just in a
> planning stage, I believe. You can search the mailing list archives through
> markmail: http://markmail.org/search/?q=list%3Acom.basho.lists.riak-users
>
> The Fast Track doesn't do anything hidden, it uses `make` and `rebar` to
> create a 4 node cluster by copying the configuration and binary folders.
> You can see what happens by looking in the Makefile for the devrel section.
> It's pretty dull and it just copies configuration around with some magic to
> change the port numbers.
>
> I can appreciate wanting to manually configure Riak and all, but keep in
> mind that having multiple Riak nodes on the same physical machine is not
> recommended for production use. The only thing that you're going to be
> change is the name you're using for the node. When in doubt, take the path
> of least resistance.
>
> If you're still intent on doing all of this by hand, you need to make sure
> that you also change the handoff\_port and pb\_port in the node configuration
> file. When I run a diff on my node1 and node2 config files, I see the
> following:
>
> $ diff dev1/etc/app.config dev2/etc/app.config
> 11c11
> < {http, [ {"0.0.0.0", 8091 } ]},
> ---
> > {http, [ {"0.0.0.0", 8092 } ]},
> 15c15
> < %{https, [{ "0.0.0.0", 8091 }]},
> ---
> > %{https, [{ "0.0.0.0", 8092 }]},
> 26c26
> < {handoff\_port, 8101 },
> ---
> > {handoff\_port, 8102 },
> 55c55
> < {pb\_port, 8081 },
> ---
> > {pb\_port, 8082 },
>
> HTH
>
> ---
> Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
> Microsoft SQL Server MVP
>
> On Nov 19, 2011, at 1:14 AM, yozloy wrote:
>
> > Hey Jeremiah,
> >
> > I change the port that RIak listening on by changing the {http,
> [{"127.0.0.1",8098}]} to {http, [{127.0.0.1}, 8099]} in the etc/app.config,
> but the Node 'riak2@127.0.0.1' not responding to pings.
> >
> > And the fast track seems to me use some sh file hidden some command, I
> want do manually configure RIak.
> >
> > Could you recommend some books or any reading material about Riak
> besides the online official documentation?
> >
> > Thanks
> >
> > On Nov 19, 2011, at 12:08 PM, Jeremiah Peschka wrote:
> >
> >>
> >> Did you change the ports that Risk is listening on for the second
> instance?
> >>
> >> If you follow the Riak fast track, it explains how to set up a 4 node
> cluster.
> >>
> >> Jeremiah Peschka
> >> Founder, Brent Ozar PLF
> >>
> >> On Nov 18, 2011 7:24 PM, "yozloy"  wrote:
> >> I copied the riak-1.0.2 folder, and change the node name to
> riak2@127.0.0.1 in the vm.args file. But the changed node refused to
> start, it returned
> >>
> >> Argo:bin yozloy$ ./riak start
> >> !!!!
> >> !!!! WARNING: ulimit -n is 256; 1024 is the recommended minimum.
> >> !!!!
> >> Riak failed to start within 15 seconds,
> >> see the output of 'riak console' for more information.
> >> If you want to wait longer, set the environment variable
> >> WAIT\_FOR\_ERLANG to the number of seconds to wait.
> >> Argo:bin yozloy$ ls
> >>
> >>
> >> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> >> riak-users mailing list
> >> riak-users@lists.basho.com
> >> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
> >
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

