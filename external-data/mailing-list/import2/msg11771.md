---
title: "Re: Riak 1.4.0: *Massive* disk space saving with eLevelDB"
description: ""
project: community
lastmod: 2013-07-26T08:18:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg11771"
mailinglist_parent_id: "msg11768"
author_name: "Jordan West"
project_section: "mailinglistitem"
sent_date: 2013-07-26T08:18:29-07:00
---


To clarify a bit further:

If you started with a fresh 1.4 cluster (or explicitly changed the
app.config setting) you are using a new on-disk format that applies to any
backend used by Riak, including LevelDB. There new format is more compact
but, like MvM said, the majority of savings here probably came from only
copying the most recent version of a key.

Cheers,
Jordan


On Fri, Jul 26, 2013 at 7:31 AM, Matthew Von-Maszewski
wrote:

> Dave,
>
> Glad you are happy.
>
> The truth is that you gained space via the backup/restore process. The
> data formats of 1.3.1 and 1.4 are the same.
>
> leveldb only removes dead / old key/values during its background
> compaction. It could be days, even weeks in some cases, between when you
> write fresh key/values and when their old version are discarded.
>
> Your restore process only put the fresh keys back into the database. The
> old versions were never part of the backup.
>
> Matthew
>
>
> On Jul 26, 2013, at 7:52 AM, Dave Brady  wrote:
>
> Thank you Basho for the new on-disk format changes to eLevelDB!
>
> We have just migrating from 1.3.1 to 1.4.0, and since we wanted to change
> the ring size too, we used Dan Kerrigan's Data Migrator to backup/restore
> our buckets.
>
> The space savings are very impressive! Each node went from using about
> 410 GB to about 250 GB.
>
> Terrific!
>
> --
> Dave Brady
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
>
> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
> riak-users mailing list
> riak-users@lists.basho.com
> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

