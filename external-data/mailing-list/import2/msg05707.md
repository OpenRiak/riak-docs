---
title: "Re: Counting the number of items in a bucket"
description: ""
project: community
lastmod: 2011-11-22T06:06:13-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05707"
mailinglist_parent_id: "msg05706"
author_name: "Fyodor Yarochkin"
project_section: "mailinglistitem"
sent_date: 2011-11-22T06:06:13-08:00
---


This depends on what riak version (1.x.x) and backend storage you're
using 2i indexes are supported by eleveldb ( bitcask is default), but
you can just specify inputs w/ key filters or just a bucket name,
i.e
"inputs": "yourbucket", or "inputs":{
 "bucket":"yourbucket",
 "key\_filters":[["ends\_with", "1234"]]
 }

etc(http://wiki.basho.com/Key-Filters.html)

On Tue, Nov 22, 2011 at 9:48 PM, Stephen Bennett  wrote:
> Thanks for that. I've tried to run this across my cluster but it just
> returns an error message. Do I need to include a key filter as well?
>
>   An error occurred parsing the "inputs" field.
>   Key filter expression missing filter list.
>
>
> On 22 November 2011 08:42, Fyodor Yarochkin  wrote:
>>
>> You can try to limit input by particular subset of ranges, if that
>> helps. Here's my count m-r snippet:
>>
>> {
>>   "inputs":{
>>       "bucket":"data",
>>       "index":"numero\_int",
>>       "start":0,
>>       "end":1212
>>   },
>>   "query":[
>>    {"map":
>> {"language":"erlang","module":"riak\_kv\_mapreduce","function":"map\_object\_value","arg":"filter\_notfound"}
>>    },
>>       {"reduce": {"language":"erlang",
>>
>> "module":"riak\_kv\_mapreduce","function":"reduce\_count\_inputs","arg":"filter\_notfound"}}
>>
>>    ], "timeout": 9000
>> }
>>
>> hope it helps,
>> -fyodor
>>
>>
>>
>> On Tue, Nov 22, 2011 at 3:26 AM, Stephen Bennett 
>> wrote:
>> > I have a bucket which contains images refernced by a key which is made
>> > up
>> > from a guid. I have a number of servers in my cluster and my bucket is
>> > set
>> > up to store 3 versions of every item in the bucket across the servers in
>> > the
>> > cluster. I'd like to understand a little bit more about how my cluster
>> > is
>> > performing in terms of data storage. I can find out how much space each
>> > bitcask is currently taking up on each server, but I'd like to compare
>> > reference this against the number of unique keys that are being stored
>> > in
>> > the system.
>> >
>> > I've tried to use map-reduce methods using the erlang methods defined in
>> > the
>> > riak\_kv\_mapreduce, calling them against the HTTP interface but my
>> > queries
>> > are timing out. I've tried to extend the timeout, but it's still timing
>> > out.
>> >
>> > What's the most efficient way to find out how many keys exist in a
>> > particular bucket?
>> > \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>> > riak-users mailing list
>> > riak-users@lists.basho.com
>> > http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>> >
>> >
>
>

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

