---
title: "Re: innostore and multi_backend"
description: ""
project: community
lastmod: 2010-11-24T00:34:13-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01621"
mailinglist_parent_id: "msg01619"
author_name: "Joseph Lambert"
project_section: "mailinglistitem"
sent_date: 2010-11-24T00:34:13-08:00
---


Ok,

Got it. It was a few system configuration problems, and one other big
problem, me :).

- Joe Lambert

joseph.g.lamb...@gmail.com
+86 13656213284


On Wed, Nov 24, 2010 at 11:11 AM, Joseph Lambert  wrote:

> Attached is app.config, below is copy/pasted the multi\_backend part
>
> {storage\_backend, riak\_kv\_multi\_backend},
>
> {multi\_backend\_default, <<"bitcask">>},
>
> {multi\_backend, [
> {<<"bitcask">>, riak\_kv\_bitcask\_backend, [{data\_root,
> "/var/lib/riak/bitcask"}]},
> {<<"dets">>, riak\_kv\_dets\_backend,
> [{riak\_kv\_dets\_backend\_root, "/var/lib/riak/dets"}]},
> {<<"ets">>, riak\_kv\_ets\_backend, []},
> {<<"fs">>, riak\_kv\_fs\_backend,
> [{riak\_kv\_fs\_backend\_root, "/var/lib/riak/fs"}]},
> {<<"cache">>, riak\_kv\_cache\_backend, [
> {riak\_kv\_cache\_backend\_memory, 100},
> {riak\_kv\_cache\_backend\_ttl, 600},
> {riak\_kv\_cache\_backend\_max\_ttl, 3600}
> ]},
> {<<"innostore">>, riak\_kv\_innostore\_backend, []}
> ]},
>
> Innostore config:
>
>
> {innostore, [
> {data\_home\_dir, "/var/lib/riak/innostore"},
> {log\_group\_home\_dir, "/var/lib/riak/inno-log"},
>
> {buffer\_pool\_size, 4294967296},
> {log\_files\_in\_group, 6},
> {log\_file\_size, 16777216}
> ]},
>
>
>
> - Joe Lambert
>
> joseph.g.lamb...@gmail.com
>
>
> On Wed, Nov 24, 2010 at 10:55 AM, Dan Reverri  wrote:
>
>> Can you provide the full app.config? I'd like to see if multi backend has
>> been setup correctly.
>>
>> Thanks,
>> Dan
>>
>> Daniel Reverri
>> Developer Advocate
>> Basho Technologies, Inc.
>> d...@basho.com
>>
>>
>> On Tue, Nov 23, 2010 at 6:35 PM, Joseph Lambert <
>> joseph.g.lamb...@gmail.com> wrote:
>>
>>> This:
>>>
>>> {riak\_kv, [
>>> ....
>>> {multi\_backend, [
>>> ....
>>> {<<"inno">>, riak\_kv\_innostore\_backend, []}
>>> ]}
>>> ]},
>>>
>>> ....
>>> {innostore, [
>>> {data\_home\_dir, "/var/lib/riak/innostore"},
>>> {log\_group\_home\_dir, "/var/lib/riak/inno-log"},
>>> {buffer\_pool\_size, 4294967296},
>>> {log\_files\_in\_group, 6},
>>> {log\_file\_size, 16777216}
>>> ]}
>>>
>>> Then this (without an entry for multi\_backend, definitely won't work,
>>> since it's not declared in multi\_backend):
>>> {riak\_kv, [
>>> ....
>>> {multi\_backend, [
>>> ....
>>> ]}
>>> ]},
>>>
>>> ....
>>> {innostore, [
>>> {data\_home\_dir, "/var/lib/riak/innostore"},
>>> {log\_group\_home\_dir, "/var/lib/riak/inno-log"},
>>> {buffer\_pool\_size, 4294967296},
>>> {log\_files\_in\_group, 6},
>>> {log\_file\_size, 16777216}
>>> ]}
>>>
>>>
>>> I also tried with {innostore, riak\_kv\_innostore\_backend, []} in
>>> multi\_backend. First one gives the error mentioned in the previous email.
>>>
>>>
>>> - Joe Lambert
>>>
>>> joseph.g.lamb...@gmail.com
>>>
>>>
>>> On Wed, Nov 24, 2010 at 10:18 AM, Dan Reverri  wrote:
>>>
>>>> Can you provide the different app.configs you are using?
>>>>
>>>> Thanks,
>>>> Dan
>>>>
>>>> Daniel Reverri
>>>> Developer Advocate
>>>> Basho Technologies, Inc.
>>>> d...@basho.com
>>>>
>>>>
>>>> On Tue, Nov 23, 2010 at 5:59 PM, Joseph Lambert <
>>>> joseph.g.lamb...@gmail.com> wrote:
>>>>
>>>>> Hi Dan,
>>>>>
>>>>> I'm using riak\_search 0.13.0 and innostore 1.0.2, btw.
>>>>>
>>>>> If I add the default innostore configuration like on the configuration
>>>>> page, and also add an entry for innostore in the multi\_backend I get this
>>>>> error on startup:
>>>>>
>>>>> {{{badmatch,
>>>>> {error,
>>>>> {eagain,
>>>>> [{erlang,open\_port,
>>>>> [{spawn,innostore\_drv},[binary]]},
>>>>> {innostore,connect,0},
>>>>> {riak\_kv\_innostore\_backend,start,2},
>>>>>
>>>>> {riak\_kv\_multi\_backend,'-start/2-lc$^0/1-0-',2},
>>>>>
>>>>> {riak\_kv\_multi\_backend,'-start/2-lc$^0/1-0-',2},
>>>>> {riak\_kv\_multi\_backend,start,2},
>>>>> {riak\_kv\_vnode,init,1},
>>>>> {riak\_core\_vnode,init,1}]}}},
>>>>> [{riak\_core\_vnode\_master,get\_vnode,2},
>>>>> {riak\_core\_vnode\_master,handle\_call,3},
>>>>> {gen\_server,handle\_msg,5},
>>>>> {proc\_lib,init\_p\_do\_apply,3}]},
>>>>> {gen\_server,call,
>>>>> [riak\_kv\_vnode\_master,
>>>>> {1096126227998177188652763624537212264741949407232,
>>>>> get\_vnode},
>>>>> infinity]}}
>>>>>
>>>>> If I take out the innostore configuration from multi\_backend, I get an
>>>>> error about the backend not existing.
>>>>>
>>>>>
>>>>> - Joe Lambert
>>>>>
>>>>> joseph.g.lamb...@gmail.com
>>>>>
>>>>>
>>>>>
>>>>> On Wed, Nov 24, 2010 at 2:34 AM, Dan Reverri  wrote:
>>>>>
>>>>>> You are correct, the innostore backend is not using the parameters
>>>>>> passed to it by multi\_backend:
>>>>>> https://issues.basho.com/show\_bug.cgi?id=890
>>>>>>
>>>>>> Rather than modifying the innostore.app file you can configure the
>>>>>> default innostore settings in your Riak app.config file:
>>>>>> [
>>>>>> {riak\_core, [...riak\_core settings...]},
>>>>>> {riak\_kv, [...riak\_kv settings...]},
>>>>>> {innostore, [{buffer\_pool\_size, 8589934592}, ...other settings...]}
>>>>>> ]
>>>>>>
>>>>>> Thanks,
>>>>>> Dan
>>>>>> 
>>>>>> Daniel Reverri
>>>>>> Developer Advocate
>>>>>> Basho Technologies, Inc.
>>>>>> d...@basho.com
>>>>>>
>>>>>>
>>>>>> On Tue, Nov 23, 2010 at 2:02 AM, Joseph Lambert <
>>>>>> joseph.g.lamb...@gmail.com> wrote:
>>>>>>
>>>>>>> Hello,
>>>>>>>
>>>>>>> Does anyone have innostore set up under multi\_backend? I can't seem
>>>>>>> to get it to work properly with multi\_backend.
>>>>>>>
>>>>>>> I tried adding it under the multi\_backend, but it won't use any
>>>>>>> parameters passed in in the third parameter. If I set it up as an
>>>>>>> application, you can't select it as a backend. If I use both, I get an 
>>>>>>> error
>>>>>>> with the erlang open\_port command (guess it's trying to spawn it twice 
>>>>>>> if I
>>>>>>> have it under multi\_backend and configured as an app).
>>>>>>>
>>>>>>> Is the solution here to modify the innostore.app file to give me the
>>>>>>> defaults I want, build it then install innostore (if I set it up only 
>>>>>>> under
>>>>>>> multi\_backend, it will work, but with the default app settings)?
>>>>>>>
>>>>>>> If I've just completely missed the mark, don't be afraid to mock me
>>>>>>> :).
>>>>>>>
>>>>>>> - Joe Lambert
>>>>>>>
>>>>>>> joseph.g.lamb...@gmail.com
>>>>>>>
>>>>>>>
>>>>>>> \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
>>>>>>> riak-users mailing list
>>>>>>> riak-users@lists.basho.com
>>>>>>> http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>
>>>
>>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

