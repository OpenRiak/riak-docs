---
title: "Re: Different results to same queries"
description: ""
project: community
lastmod: 2015-05-05T05:06:08-0700
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg16108"
mailinglist_parent_id: "msg16101"
author_name: "Sadykov Rustem"
project_section: "mailinglistitem"
sent_date: 2015-05-05T05:06:08-0700
---


Hi.
I've increased number of JS machines for map and reduce to 32 and now I don't 
get this strange behaviour (now on every query I get same results count), so it 
looks like the problem is solved on riak 1.4.10, but I still get different 
results when I try to use riak 2.1.0 (even if I increase number of JS machines 
there).
Looks like I have to stop using map-reduce in riak 2.1.0

On May 4, 2015, at 7:40 PM, Christopher Meiklejohn  
wrote:

> 
>> On Apr 22, 2015, at 6:45 PM, Sadykov Rustem  wrote:
>> 
>> Hello.
>> I'm testing riak 1.4.10 on 2 node cluster (on different servers), but result 
>> is same on 3 nodes cluster and on single node also.
>> 
>> I try to count records in my bucket and always get 3-4 different results.
>> Query is:
>> 
>> curl -XPOST http://localhost:8098/mapred -H 'Content-Type: application/json' 
>> -d '{"inputs":"account", "query":[{"reduce":{"language":"erlang", 
>> "module":"riak\_kv\_mapreduce", "function":"reduce\_count\_inputs", 
>> "arg":{"reduce\_phase\_batch\_size":1000} } }] }â€™
> 
> Hi Sadykov,
> 
> Map/Reduce chooses one replica for each value to execute the query on during 
> a distributed Map/Reduce job. Given that, subsequent executions might occur 
> on different replicas given the coverage plan chosen during that period.
> 
> That said, can you provide information on when you are writing the values you 
> are running the job against? For example, are you writing to a quorum of 
> nodes right before the query? Itâ€™s possible to see some staleness if you are 
> using majority quorums and you are executing against replicas that are 
> delayed due to network traffic.
> 
> - Chris
> 
> Christopher Meiklejohn
> Senior Software Engineer
> Basho Technologies, Inc.
> cmeiklej...@basho.com
> 

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

