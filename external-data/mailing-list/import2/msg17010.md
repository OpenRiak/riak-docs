---
title: "Cluster balance problem"
description: ""
project: community
lastmod: 2016-02-08T05:51:28-0800
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg17010"
author_name: "Stanislav Vlasov"
project_section: "mailinglistitem"
sent_date: 2016-02-08T05:51:28-0800
---


Hello!

We have riak cluster for riak-cs.
Failed node riak@192.168.0.133 has been replaced via 'riak-admin
replace' by riak@192.168.0.141 (new node), then cleaned up, prepared
and joined to cluster as new.
Member-status after last 'riak-admin cluster commit', when all
transfers complete:

================================= Membership ==================================
Status Ring Pending Node
-------------------------------------------------------------------------------
valid 8.6% -- 'riak@192.168.0.130'
valid 8.2% -- 'riak@192.168.0.131'
valid 8.2% -- 'riak@192.168.0.132'
valid 8.2% -- 'riak@192.168.0.133'
valid 8.2% -- 'riak@192.168.0.134'
valid 8.2% -- 'riak@192.168.0.135'
valid 8.2% -- 'riak@192.168.0.136'
valid 8.2% -- 'riak@192.168.0.137'
valid 8.2% -- 'riak@192.168.0.138'
valid 8.2% -- 'riak@192.168.0.139'
valid 8.2% -- 'riak@192.168.0.140'
valid 9.4% -- 'riak@192.168.0.141'
-------------------------------------------------------------------------------
Valid:12 / Leaving:0 / Exiting:0 / Joining:0 / Down:0

Every node have 3.6T raid.
Free place on disk and used %:

192.168.0.130 996G 73%
192.168.0.131 1.2T 69%
192.168.0.132 1.2T 68%
192.168.0.133 1.1T 70%
192.168.0.134 1.1T 70%
192.168.0.135 1.2T 69%
192.168.0.136 1.2T 68%
192.168.0.137 1.2T 69%
192.168.0.138 1.2T 69%
192.168.0.139 1.2T 69%
192.168.0.140 1.2T 68%
192.168.0.141 808G 78%

Problem: on 192.168.0.141 very little free space compared to rest,
which may affect in merges on this node after uploading some
additional data into cluster.

Software versions:
ii riak 2.1.3-1 amd64 Riak is a distributed data store
ii riak-cs 2.0.0-1 amd64 Riak CS

Can i rebalance riak without adding/removing nodes or any hardware changes?

-- 
Stanislav

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

