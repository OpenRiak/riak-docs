---
title: "Re: riak_kv_multi_backend + custom backend"
description: ""
project: community
lastmod: 2011-01-25T05:32:26-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02115"
mailinglist_parent_id: "msg02106"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-01-25T05:32:26-08:00
---


Yes, that's correct, but I don't see any reason you should make things harder 
on yourself. The overhead of a few binaries is not significant enough to weigh 
down operations.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Jan 25, 2011, at 5:08 AM, Nico Meyer wrote:

&gt; Hi,
&gt; 
&gt; maybe I am wrong here, but from looking at the code of
&gt; riak\\_kv\\_multi\\_backend I get the impression that the backend name can be
&gt; anything (binary, atom, integer, ...), as long as it is the same in the
&gt; multi\\_backend config and the 'backend' property of the bucket.
&gt; 
&gt; The limitation to binaries comes from the REST interface, right? If the
&gt; bucket properties are set via the native Erlang client one can still use
&gt; atoms, which should be (slightly) faster. Of course, people who only use
&gt; the REST interface don't care too much about performance, so the small
&gt; performance hit of using binaries for the backend name might not matter.
&gt; 
&gt; Cheers,
&gt; Nico
&gt; 
&gt; Am Montag, den 24.01.2011, 16:11 -0800 schrieb Anthony Molinaro:
&gt;&gt; On Mon, Jan 24, 2011 at 02:15:37PM -0500, Sean Cribbs wrote:
&gt;&gt;&gt; Default bucket properties are defined in riak\\_core, not riak\\_kv, so you 
&gt;&gt;&gt; can't really set the hash function as a result of setting something else. 
&gt;&gt;&gt; Furthermore, you really only have to set these once, so you could configure 
&gt;&gt;&gt; your application to check the bucket props on startup and set them 
&gt;&gt;&gt; appropriately.
&gt;&gt; 
&gt;&gt; Do you mean in the start/2 of the custom backend, or somewhere else? I 
&gt;&gt; thought
&gt;&gt; the start/2 function was passed the partition number (which in turn I thought
&gt;&gt; was a result of calling the hash), but that's just conjecture as I've not had
&gt;&gt; a chance to trace through the code. If that is the case it seems like it 
&gt;&gt; would
&gt;&gt; be too late, if you are talking about my application talking to riak, I 
&gt;&gt; thought
&gt;&gt; there was no way via the pb client to set these options. I'd like to avoid
&gt;&gt; using a mix of pb and HTTP in my application as it just seems to complicate
&gt;&gt; things. I'll probably just use curl when I first set things up for now, but
&gt;&gt; figured I'd put these issues out there in case others have these problems
&gt;&gt; or the basho developers are bored and looking for things to do ;)
&gt;&gt; 
&gt;&gt;&gt; "backend" is a property only used by the multi\\_backend (which isn't used 
&gt;&gt;&gt; that frequently), so it seems a little presumptuous to special-case that 
&gt;&gt;&gt; property (turning it into an atom). There are a few other technical 
&gt;&gt;&gt; reasons that you don't want to arbitrarily turn binaries into atoms. I 
&gt;&gt;&gt; agree that it's not especially intuitive but I think it's a small point of 
&gt;&gt;&gt; pain, especially if we fix the documentation.
&gt;&gt; 
&gt;&gt; Oh, I assumed since the documentation said atom it was meant to be that, and
&gt;&gt; most other parameters are either strings, integers or atoms. So binaries are
&gt;&gt; a bit surprising. But I don't have a strong opinion, so I'll just document
&gt;&gt; what's working.
&gt;&gt; 
&gt;&gt; -Anthony
&gt;&gt; 
&gt; 
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

