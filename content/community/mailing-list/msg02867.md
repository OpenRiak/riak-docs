---
title: "Re: Has-A vs Links-To"
description: ""
project: community
lastmod: 2011-04-03T21:07:49-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02867"
mailinglist_parent_id: "msg02866"
author_name: "Mike Oxford"
project_section: "mailinglistitem"
sent_date: 2011-04-03T21:07:49-07:00
---


Riak is known to be working on bucket-destruction, and we're using a sparse
keyspace/bucket-name.

The question is: Do we fill the bucket with users, or just use it as a
meta-concept to link to subscriber buckets?

Thanks!

-mox

On Sun, Apr 3, 2011 at 8:55 PM, Dmitry Demeshchuk wrote:

&gt; Something tells me that Riak's current design is not well-suited for
&gt; pub-sub, especially with frequent channels removing.
&gt;
&gt; However, I think innostore backend can give you such functionalities.
&gt; What you'll need is:
&gt;
&gt; 1. Add first\\_key and next\\_key functionalities to Riak itself (they'll
&gt; give you the first and the next keys from the given bucket, which
&gt; means first/next keys from the table on the InnoDB level)
&gt;
&gt; 2. Add remove\\_bucket functionality to Riak, which in fact will call
&gt; 'DROP TABLE' on the innostore level, giving you an ability to remove
&gt; buckets fast.
&gt;
&gt; So, your pub-sub design will look like the following:
&gt;
&gt; 1. Each channel has an associated bucket named "channel-ChannelName"
&gt;
&gt; 2. When trying to get the next message from the channel, you get the
&gt; first key from the bucket and then read its value.
&gt;
&gt; 3. Depending on your needs, you may want to read the next key
&gt; immediately or stop reading keys until the next subscriber query.
&gt;
&gt; 4. If you unsubscribe, you just remove the bucket using 'DROP TABLE'.
&gt;
&gt;
&gt; On Mon, Apr 4, 2011 at 2:46 AM, Mike Oxford  wrote:
&gt; &gt; Pub-sub style, with frequent unsub and channel destruction.
&gt; &gt;
&gt; &gt; -Mike
&gt; &gt;
&gt; &gt; On Sun, Apr 3, 2011 at 2:11 PM, Dan Reverri  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; Can you describe a bit more what you are trying to model?
&gt; &gt;&gt; Thanks,
&gt; &gt;&gt; Dan
&gt; &gt;&gt; Daniel Reverri
&gt; &gt;&gt; Developer Advocate
&gt; &gt;&gt; Basho Technologies, Inc.
&gt; &gt;&gt; d...@basho.com
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; On Fri, Apr 1, 2011 at 2:40 PM, Mike Oxford  wrote:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; In Riak design, with a given bucket of "subscribers" would it be better
&gt; &gt;&gt;&gt; to use the bucket as an actual container of users (denormallized) or
&gt; use
&gt; &gt;&gt;&gt; Riak's linking feature?
&gt; &gt;&gt;&gt; While both will work, there are surely some under-the-covers things to
&gt; &gt;&gt;&gt; consider...
&gt; &gt;&gt;&gt; Thanks!
&gt; &gt;&gt;&gt; -mox
&gt; &gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt;&gt;&gt; riak-users mailing list
&gt; &gt;&gt;&gt; riak-users@lists.basho.com
&gt; &gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Best regards,
&gt; Dmitry Demeshchuk
&gt;
