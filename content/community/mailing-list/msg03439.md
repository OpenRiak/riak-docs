---
title: "Re: riaksearch: using index docs in place of real objects"
description: ""
project: community
lastmod: 2011-05-26T12:33:49-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03439"
mailinglist_parent_id: "msg03417"
author_name: "Mathias Meyer"
project_section: "mailinglistitem"
sent_date: 2011-05-26T12:33:49-07:00
---


This behavior is specific to the Solr interface. It first fetches document IDs 
matching the criteria and then fetches the documents from Riak KV. Using the 
Erlang interface you can fetch just the IDs. It would certainly make sense to 
add an option like that, but it'd be inconsistent with Solr's interface.

As far as I know (and I tried to confirm this in the dark depths of the Solr 
wiki) you can tell Solr to store specifc indexed fields, but not specify an 
option at query time to omit stored fields. Correct me if I'm wrong though, 
would be more than reason (and probably also simple) enough to add something 
like that to the Riak Search Solr API.

Mathias Meyer
Developer Advocate, Basho Technologies


On Donnerstag, 26. Mai 2011 at 20:50, Greg Pascale wrote:

&gt; Thanks Mathias,
&gt; 
&gt; We'll continue to do that then.
&gt; 
&gt; It seems to me, though, that in the common case you aren't interested in the 
&gt; index docs when you do a search, so it's needlessly inefficient to retrieve 
&gt; them. Might it make sense to add a search option to not return the index docs 
&gt; if you don't care about them?
&gt; 
&gt; -Greg
&gt; 
&gt; On Thu, May 26, 2011 at 6:42 AM, Mathias Meyer  (mailto:math...@basho.com)&gt; wrote:
&gt; &gt; Greg,
&gt; &gt; 
&gt; &gt; Riak Search stores indexed documents in Riak KV too, as serialized Erlang 
&gt; &gt; terms. You can easily verify that by requesting a document from 
&gt; &gt; http://riak.host:8098/riak/\\_rsid\\_/key.
&gt; &gt; 
&gt; &gt; So whenever you query something through the Solr interface the documents 
&gt; &gt; you get back are fetched from these buckets, and therefore the same 
&gt; &gt; distribution and consistency properties apply to them as to objects stored 
&gt; &gt; directly in Riak KV. Bottom line is there's nothing wrong with just using 
&gt; &gt; them instead of fetching them again from Riak KV.
&gt; &gt; 
&gt; &gt; Mathias Meyer
&gt; &gt; Developer Advocate, Basho Technologies
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On Mittwoch, 25. Mai 2011 at 00:34, Greg Pascale wrote:
&gt; &gt; 
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; 
&gt; &gt; &gt; In our data model, our riak objects are flat JSON objects, and thus their 
&gt; &gt; &gt; corresponding index documents are nearly identical - the only difference 
&gt; &gt; &gt; is that a few fields which are ints in the riak objects are strings in 
&gt; &gt; &gt; the index doc.
&gt; &gt; &gt; 
&gt; &gt; &gt; Since they are so similar, we are directly using the index docs returned 
&gt; &gt; &gt; from our search call, skipping the second step of doing gets on the 
&gt; &gt; &gt; returned keys to retrieve the real objects.
&gt; &gt; &gt; 
&gt; &gt; &gt; Is this advisable? Are there any circumstances under which we might run 
&gt; &gt; &gt; into consistency issues?
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks,
&gt; &gt; &gt; -Greg
&gt; &gt; &gt; 
&gt; &gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com) 
&gt; &gt; &gt; (mailto:riak-users@lists.basho.com)
&gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

