---
title: "Re: couchdb performace 10x: using NIF for file io"
description: ""
project: community
lastmod: 2010-10-25T05:46:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01366"
mailinglist_parent_id: "msg01361"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-10-25T05:46:14-07:00
---


For what it's worth, Bitcask has a decent portion of its code as NIFs, and 
there are various other parts of the Riak codebase that use NIFs.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Oct 25, 2010, at 2:30 AM, Richard Heycock wrote:

&gt; Excerpts from Kirill A. Korinskiy's message of 2010-10-25 08:28:37 +1100:
&gt;&gt; Hi!
&gt;&gt; 
&gt;&gt; Cool story but you messages take a broken links :(
&gt; 
&gt; The links are valid from here:
&gt; 
&gt; 
&gt; http://groups.google.com/group/erlang-programming/browse\\_thread/thread/f667a9a87ada3e7d
&gt; 
&gt; rgh
&gt; 
&gt; 
&gt;&gt; On Mon, Oct 25, 2010 at 01:05, NevB  wrote:
&gt;&gt; 
&gt;&gt;&gt; Hi,
&gt;&gt;&gt; 
&gt;&gt;&gt; I came across this thread in the Erlang group and thought the Riak
&gt;&gt;&gt; team might find it interesting.
&gt;&gt;&gt; 
&gt;&gt;&gt; Please forgive me if its not relevant to Riak
&gt;&gt;&gt; 
&gt;&gt;&gt; Kind Regards
&gt;&gt;&gt; 
&gt;&gt;&gt; Neville
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; ---------- Forwarded message ----------
&gt;&gt;&gt; From: Joel Reymont 
&gt;&gt;&gt; Date: Oct 25, 12:56 am
&gt;&gt;&gt; Subject: couchdb performace 10x: using NIF for file io
&gt;&gt;&gt; To: Erlang Programming
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; Simply switching to NIFs for file IO seems to have improved CouchDB
&gt;&gt;&gt; write performance more than ten-fold.
&gt;&gt;&gt; 
&gt;&gt;&gt; Compare the old graph
&gt;&gt;&gt; 
&gt;&gt;&gt; http://graphs.mikeal.couchone.com/#/graph/62b286fbb7aa55a4b0c4cc913c0...
&gt;&gt;&gt; 
&gt;&gt;&gt; to the new graph
&gt;&gt;&gt; 
&gt;&gt;&gt; http://graphs.mikeal.couchone.com/#/graph/62b286fbb7aa55a4b0c4cc913c0...
&gt;&gt;&gt; 
&gt;&gt;&gt; I was under the impression that the Erlang IO subsystem was highly
&gt;&gt;&gt; optimized but there seems to be no limit to perfection.
&gt;&gt;&gt; 
&gt;&gt;&gt; NIFs are a giant black hole that will subsume Erlang code as
&gt;&gt;&gt; performance has to be improved. Start at the lowest level and keep
&gt;&gt;&gt; moving up. All that will be left of Erlang in the end is 99.99999%
&gt;&gt;&gt; uptime, fault tolerance and supervision... of optimized C code. It's
&gt;&gt;&gt; swell and I'm all for it!
&gt;&gt;&gt; 
&gt;&gt;&gt; Patch is here:
&gt;&gt;&gt; 
&gt;&gt;&gt; http://github.com/wagerlabs/couchdb/commit/23527eb8165f81e63d47b230f3...
&gt;&gt;&gt; 
&gt;&gt;&gt; ---http://twitter.com/wagerlabs
&gt;&gt;&gt; 
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; erlang-questions (at) erlang.org mailing list.
&gt;&gt;&gt; Seehttp://www.erlang.org/faq.html
&gt;&gt;&gt; To unsubscribe; mailto:erlang-questions-unsubscr...@erlang.org
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt; 
&gt; -- 
&gt; Richard Heycock
&gt; 
&gt; http://topikality.com
&gt; 
&gt; +61 (0) 410 646 369
&gt; [e]: r...@topikality.com
&gt; [im]: r...@topikality.com
&gt; 
