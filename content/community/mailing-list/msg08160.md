---
title: "riak-erlang-client search changes"
description: ""
project: community
lastmod: 2012-08-02T08:17:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08160"
author_name: "Dave Parfitt"
project_section: "mailinglistitem"
sent_date: 2012-08-02T08:17:13-07:00
---


Hello -
We're considering some changes to the Riak Search functionality in 
riak-erlang-client for the upcoming Riak 1.2 release. The current behavior of 
the riakc\\_pb\\_socket:search/\\* functions return a list in the form: [[Index, 
Id],[Index2,Id2],...]

With the new Riak Search protobuffs messages, we have the ability to also 
return fields from the search doc in the results (as additional values in the 
tuple). Also, it's possible to return the search results "max score", and 
"number found". Does anyone have any objections to returning additional fields? 
To maintain semi-compatible behavior, it's possible to use the fl (field limit) 
search option to just return the id.

Current behavior:
riakc\\_pb\\_socket:search(Pid, &lt;&lt;"phrases\\_custom"&gt;&gt;, &lt;&lt;"phrase:fox"&gt;&gt;). 
 
{ok,[[&lt;&lt;"phrases\\_custom"&gt;&gt;,&lt;&lt;"5"&gt;&gt;],
 [&lt;&lt;"phrases\\_custom"&gt;&gt;,&lt;&lt;"1"&gt;&gt;]]}

Proposed behavior:
riakc\\_pb\\_socket:search(Pid, &lt;&lt;"phrases\\_custom"&gt;&gt;, &lt;&lt;"phrase:fox"&gt;&gt;).
{ok,[{&lt;&lt;"phrases\\_custom"&gt;&gt;,
 [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"1"&gt;&gt;}, 
 {&lt;&lt;"phrase"&gt;&gt;,&lt;&lt;"The quick brown fox jumps over the lazy dog"&gt;&gt;}],
 {&lt;&lt;"phrases\\_custom"&gt;&gt;,
 [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"5"&gt;&gt;},
 {&lt;&lt;"phrase"&gt;&gt;,&lt;&lt;"The quick brown fox jumps over the lazy dog"&gt;&gt;}],
 0.0,2}
 %% Note the last two fields of the result are Max Score and Number Found.

Semi-compatible behavior by specifying the fl (with the exception of max score 
and number found):
riakc\\_pb\\_socket:search(Pid, &lt;&lt;"phrases\\_custom"&gt;&gt;, &lt;&lt;"phrase:fox"&gt;&gt;, 
[{fl,[&lt;&lt;"id"&gt;&gt;]}], 5000, 5000).
{ok,[{&lt;&lt;"phrases\\_custom"&gt;&gt;,[{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"1"&gt;&gt;}]},
 {&lt;&lt;"phrases\\_custom"&gt;&gt;,[{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"5"&gt;&gt;}]},
 0.0,2}

Cheers -
Dave
