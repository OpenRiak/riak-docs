---
title: "Re: Data model for microblogging-like service"
description: ""
project: community
lastmod: 2010-11-29T09:31:41-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01651"
mailinglist_parent_id: "msg01650"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2010-11-29T09:31:41-08:00
---


Inline:

On Mon, Nov 29, 2010 at 12:15, Gleb Peregud  wrote:
&gt; Hello all
&gt;
&gt; I'm considering Riak as a datastore for a service, which has a part
&gt; which looks like a microblog - i.e. each user will have his own feed
&gt; of events, status updates, links and liked items from other feeds.
&gt; Events on a feed are usually pretty small (avg. 500 bytes).
&gt;
&gt; What is the best way to store user's stream in Riak?
&gt;
&gt; Operations I'm most interested in are the following:
&gt; - append to "top" of the feed

There is no top or bottom in riak. The closest thing would be adding
links to a key via your client of choice. Depending on how that
client operates those links would prepend or append to the list of
links and will be returned in that order. Keep in mind that links,
which are part of the "header" info must be written with the value of
your key. Write your links without your value you lose your value.

&gt; - get items from the feed with offset and limit (i.e. pagination)

There is no offset in riak. Limit could be implemented in a reduce
after a sort, perhaps.

&gt;
&gt; As far as I can see after reading documentation (one user -&gt; multiple
&gt; events) links are the way to deal with such task. Would this scale
&gt; well? Service has to be able to serve tens of thousands of users with
&gt; ever-growing feeds for each user. Deletions will be pretty seldom.

The consideration with links is how many per key. A few hundred or
even a thousand could work, more or less. But beyond that you need to
change your model. For instance a twitter user with 100k followers
would not translate well to one user with 100k links hanging off the
key. But a user with links to say their last 200 messages in a capped
collection, filo sort of way would work, managed by your application
of course.

My recommendation to everyone who asks is to implement redis as
middleware for key management and periodically persist those keys to
riak. Read the keys back (either redis or riak) and pass those keys to
a m/r to get your values back from riak.

Best,
Alexander

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

