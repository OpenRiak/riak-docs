---
title: "Re: Running riak from launchd?"
description: ""
project: community
lastmod: 2012-05-26T08:34:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07542"
mailinglist_parent_id: "msg07541"
author_name: "Kelly McLaughlin"
project_section: "mailinglistitem"
sent_date: 2012-05-26T08:34:45-07:00
---


Hi Izzy. Use riak start and then you can use riak attach if you need to attach 
a console to the running instance.

Kelly

Sent from my iPhone

On May 26, 2012, at 8:38 AM, Izzy Alanis  wrote:

&gt; Has anyone gotten riak to run under launchd?
&gt; 
&gt; Or, is there a way to run riak in console mode without the interactive
&gt; erlang shell?
&gt; 
&gt; Launchd doesn't want its subprocesses to daemonize themselves. If I
&gt; set up a launch file to run riak in the foreground with "riak
&gt; console", its the same as running "riak console &lt; /dev/null" from the
&gt; command line, and (I'm guessing here:) the interactive shell sees the
&gt; end of stream and ends the console session.
&gt; 
&gt; I expect you'd have the same problem using supervisor as your process
&gt; controller. Supervisor has a pixproxy program to help in these sort of
&gt; situations, but riak is not writing out a pid file either(?!).
&gt; 
&gt; Things I've tried:
&gt; 
&gt; Piping input from /dev/zero is understandably disastrous:
&gt;&gt; riak console &lt; /dev/zero
&gt; 
&gt; Piping input from a fifo just hangs:
&gt;&gt; mkfifo &lt; /tmp/myfifo
&gt;&gt; riak console &lt; /tmp/myfifo
&gt; 
&gt; This seems to mostly work (or might really work well with some extra
&gt; bash scripting):
&gt;&gt; mkfifo &lt; /tmp/myfifo
&gt;&gt; echo &gt; /tmp/myfifo &
&gt;&gt; riak console &lt; /tmp/myfifo
&gt; I have that last one in a wrapper script. I could add the bells and
&gt; whistles to make the fifo a random filename and make sure it gets
&gt; cleaned up after the script end, etc, etc, etc.
&gt; 
&gt; Here's my launch config (below), FYI. I'm running it out of
&gt; /Library/LaunchDaemons, and errang \\*really\\* wants a HOME environment
&gt; variable which is a gotcha for anybody else out there!:
&gt; 
&gt; Anybody else get something like this working?
&gt; 
&gt; xml version="1.0" encoding="UTF-8"?
&gt;  "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&gt; 
&gt; 
&gt; Label
&gt; com.basho.riak
&gt; OnDemand
&gt; 
&gt; Program
&gt; /opt/riak/bin/riak-wrapper
&gt; EnvironmentVariables
&gt; 
&gt; HOME
&gt; /opt/riak/
&gt; 
&gt; StandardOutPath
&gt; /opt/riak/log/console.log
&gt; StandardErrorPath
&gt; /opt/riak/log/error.log
&gt; SoftResourceLimits
&gt; 
&gt; NumberOfFiles
&gt; 4096
&gt; 
&gt; HardResourceLimits
&gt; 
&gt; NumberOfFiles
&gt; 4096
&gt; 
&gt; 
&gt; 
&gt; 

