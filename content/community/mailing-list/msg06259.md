---
title: "broken values in luwak"
description: ""
project: community
lastmod: 2012-01-12T09:57:35-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06259"
author_name: "francisco treacy"
project_section: "mailinglistitem"
sent_date: 2012-01-12T09:57:35-08:00
---


Hi,

One of my users is preparing an exam but can't load an image because
Luwak is serving it broken (i.e. responds with HTTP 200; 0 bytes)

Visibly caused by a non-existing chunk of that file on that partition.
I would've expected read-repair to kick in and update the value. But
it keeps on serving 0 bytes.

Why is this happening and how can I fix it?

Thanks,

Francisco


=CRASH REPORT==== 12-Jan-2012::18:42:29 ===
 crasher:
 initial call: luke\\_flow:init/1
 pid: &lt;0.16316.2941&gt;
 registered\\_name: []
 exception exit:
{error,{phase\\_error,{error,{throw,{function\\_clause,[{riak\\_object,get\\_value,[{error,notfound}]},{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]},[{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]}}}}
 in function gen\\_fsm:terminate/7
 in call from proc\\_lib:init\\_p\\_do\\_apply/3
 ancestors: [luke\\_flow\\_sup,luke\\_sup,&lt;0.10483.536&gt;]
 messages: []
 links: [&lt;0.10485.536&gt;]
 dictionary: []
 trap\\_exit: true
 status: running
 heap\\_size: 610
 stack\\_size: 24
 reductions: 258
 neighbours:

=SUPERVISOR REPORT==== 12-Jan-2012::18:42:29 ===
 Supervisor: {local,luke\\_flow\\_sup}
 Context: child\\_terminated
 Reason:
{error,{phase\\_error,{error,{throw,{function\\_clause,[{riak\\_object,get\\_value,[{error,notfound}]},{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]},[{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]}}}}
 Offender:
[{pid,&lt;0.16316.2941&gt;},{name,undefined},{mfa,{luke\\_flow,start\\_link,[&lt;10351.27714.2432&gt;,18337056,[{riak\\_kv\\_map\\_phase,[],[{erlang,{map,{qfun,#Fun},{map,{riak\\_client,ri...@xx.165.253.xx,&lt;&lt;[2,139,139,84]&gt;&gt;},1000000,#Ref&lt;0.0.487.249801&gt;,&lt;0.16313.2941&gt;,0,76134},false}}]}],undefined,66000]}},{restart\\_type,temporary},{shutdown,brutal\\_kill},{child\\_type,worker}]

