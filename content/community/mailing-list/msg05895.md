---
title: "Re: Why is the data lost in luwak"
description: ""
project: community
lastmod: 2011-12-08T08:51:53-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05895"
mailinglist_parent_id: "msg05892"
author_name: "Kelly McLaughlin"
project_section: "mailinglistitem"
sent_date: 2011-12-08T08:51:53-08:00
---


Fisher, 

Yeah don't use flush. Make the calls to send to put the data and then call 
close and you should get the expected behavior.

Kelly

On Dec 7, 2011, at 11:13 PM, vuleetu wrote:

&gt; On Thu, Dec 8, 2011 at 1:57 PM, Kelly McLaughlin  wrote:
&gt;&gt; Fisher,
&gt;&gt; 
&gt;&gt; You need to call luwak\\_put\\_stream:close(Ps) to force the flush. That should
&gt;&gt; get it for you. Cheers.
&gt;&gt; 
&gt;&gt; Kelly
&gt; 
&gt; Hi, Kelly
&gt; 
&gt; RiakNode = 'riak@127.0.0.1'.
&gt; {ok, Riak} = riak:client\\_connect(RiakNode).
&gt; {ok, RiakFile} = luwak\\_file:create(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;, dict:new()).
&gt; Ps = luwak\\_put\\_stream:start(Riak, RiakFile, 0, 1000000).
&gt; luwak\\_put\\_stream:send(Ps, &lt;&lt;"1234"&gt;&gt;).
&gt; luwak\\_put\\_stream:flush(Ps).
&gt; {ok, RiakFile2} = luwak\\_file:get(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;).
&gt; luwak\\_file:length(Riak, RiakFile2). %% Length is 4
&gt; luwak\\_put\\_stream:send(Ps, &lt;&lt;"56789"&gt;&gt;).
&gt; luwak\\_put\\_stream:close(Ps).
&gt; {ok, RiakFile3} = luwak\\_file:get(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;).
&gt; luwak\\_file:length(Riak, RiakFile3). %% Length still 13
&gt; 
&gt; 
&gt; After i call close(), I still get the unexpected size(13bytes), is
&gt; this the expected behavior? Can I not call flush() manually on a
&gt; stream?
&gt; 
&gt; this is the version info:
&gt; luwak-1.1.0
&gt; riak\\_core-1.0.0 riak\\_kv-1.0.0 riak\\_pipe-1.0.0
&gt; riak\\_search-1.0.0 riak\\_sysmon-1.0.0 riakc-1.2.0
&gt; 
&gt; Thanks,
&gt; 
&gt; Fisher
&gt; 
&gt; 
&gt;&gt; 
&gt;&gt; On Dec 7, 2011, at 10:05 PM, vuleetu wrote:
&gt;&gt; 
&gt;&gt; luwak\\_put\\_stream:send(Ps, &lt;&lt;"56789"&gt;&gt;).
&gt;&gt; luwak\\_put\\_stream:flush(Ps).
&gt;&gt; {ok, RiakFile3} = luwak\\_file:get(Riak, &lt;&lt;"testabc22yeah3"&gt;&gt;).
&gt;&gt; luwak\\_file:length(Riak, RiakFile3).
&gt;&gt; 
&gt;&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

