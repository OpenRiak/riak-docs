---
title: "Re: riak-erlang segfault"
description: ""
project: community
lastmod: 2012-10-09T08:46:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08844"
mailinglist_parent_id: "msg08815"
author_name: "Tomas Charvat"
project_section: "mailinglistitem"
sent_date: 2012-10-09T08:46:29-07:00
---


We have manage to fix mentioned segfault byt disabling sysfs restriction 
in hardened Gentoo kernel.

It has fixed segfault issues.


 Sysfs/debugfs restriction

/Configuration option: CONFIG\\_GRKERNSEC\\_SYSFS\\_RESTRICT/
If you say Y here, sysfs (the pseudo-filesystem mounted at /sys) and any 
filesystem normally mounted under it (e.g. debugfs) will only be 
accessible by root. These filesystems generally provide access to 
hardware and debug information that isn't appropriate for unprivileged 
users of the system. Sysfs and debugfs have also become a large source 
of new vulnerabilities, ranging from infoleaks to local compromise.


There has been very little oversight with an eye toward security 
involved in adding new exporters of information to these filesystems, so 
their use is discouraged.


This option is equivalent to a chmod 0700 of the mount paths.

cheers
Tomas

On 10/07/2012 08:50 PM, Evan Vigil-McClanahan wrote:

The first thing that strikes me is that you have HIPE enabled on your
erlang, and the version isn't the one we build with. This isn't
something riak is usually happy with.

If you're doing 1.2, try rebuilding riak with R15B01 compiled with
--diable-hipe.

The config file is usually called app.config, as well, but that might
have been a typo on your part.

On Sun, Oct 7, 2012 at 3:28 AM, Tomas Charvat  wrote:

Hallo, I have fresh system and Im getting segfaults with riak/erlang.
erl\\_crash.dump attached
Any tip what could be possible wrong ?
Bin /usr/lib64/riak/erts-5.9/bin/erlexec has same problem as
/usr/lib64/erlang/erts-5.9/bin/erlexec
Result is that riak cant find /etc/riak/app.conf
erl, erlc are working without any problem

cheers
Tomas

smime.p7s
Description: S/MIME Cryptographic Signature
