---
title: "Re: broken values in luwak"
description: ""
project: community
lastmod: 2012-01-12T10:42:51-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06261"
mailinglist_parent_id: "msg06259"
author_name: "Kelly McLaughlin"
project_section: "mailinglistitem"
sent_date: 2012-01-12T10:42:51-08:00
---


Francisco,

Is it the case that you have already tried to force read repair on the file 
chunks and are still seeing these errors?

Kelly

On Jan 12, 2012, at 10:57 AM, francisco treacy wrote:

&gt; Hi,
&gt; 
&gt; One of my users is preparing an exam but can't load an image because
&gt; Luwak is serving it broken (i.e. responds with HTTP 200; 0 bytes)
&gt; 
&gt; Visibly caused by a non-existing chunk of that file on that partition.
&gt; I would've expected read-repair to kick in and update the value. But
&gt; it keeps on serving 0 bytes.
&gt; 
&gt; Why is this happening and how can I fix it?
&gt; 
&gt; Thanks,
&gt; 
&gt; Francisco
&gt; 
&gt; 
&gt; =CRASH REPORT==== 12-Jan-2012::18:42:29 ===
&gt; crasher:
&gt; initial call: luke\\_flow:init/1
&gt; pid: &lt;0.16316.2941&gt;
&gt; registered\\_name: []
&gt; exception exit:
&gt; {error,{phase\\_error,{error,{throw,{function\\_clause,[{riak\\_object,get\\_value,[{error,notfound}]},{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]},[{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]}}}}
&gt; in function gen\\_fsm:terminate/7
&gt; in call from proc\\_lib:init\\_p\\_do\\_apply/3
&gt; ancestors: [luke\\_flow\\_sup,luke\\_sup,&lt;0.10483.536&gt;]
&gt; messages: []
&gt; links: [&lt;0.10485.536&gt;]
&gt; dictionary: []
&gt; trap\\_exit: true
&gt; status: running
&gt; heap\\_size: 610
&gt; stack\\_size: 24
&gt; reductions: 258
&gt; neighbours:
&gt; 
&gt; =SUPERVISOR REPORT==== 12-Jan-2012::18:42:29 ===
&gt; Supervisor: {local,luke\\_flow\\_sup}
&gt; Context: child\\_terminated
&gt; Reason:
&gt; {error,{phase\\_error,{error,{throw,{function\\_clause,[{riak\\_object,get\\_value,[{error,notfound}]},{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]},[{luwak\\_get\\_stream,-map\\_fun/0-fun-0-,3},{riak\\_kv\\_mapper,run\\_map,9},{riak\\_kv\\_mapper,-do\\_map/2-fun-0-,9},{lists,foldl,3},{riak\\_kv\\_mapper,do\\_map,2},{gen\\_fsm,handle\\_msg,7},{proc\\_lib,init\\_p\\_do\\_apply,3}]}}}}
&gt; Offender:
&gt; [{pid,&lt;0.16316.2941&gt;},{name,undefined},{mfa,{luke\\_flow,start\\_link,[&lt;10351.27714.2432&gt;,18337056,[{riak\\_kv\\_map\\_phase,[],[{erlang,{map,{qfun,#Fun},{map,{riak\\_client,ri...@xx.165.253.xx,&lt;&lt;[2,139,139,84]&gt;&gt;},1000000,#Ref&lt;0.0.487.249801&gt;,&lt;0.16313.2941&gt;,0,76134},false}}]}],undefined,66000]}},{restart\\_type,temporary},{shutdown,brutal\\_kill},{child\\_type,worker}]
&gt; 
