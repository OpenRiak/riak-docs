---
title: "Ripple find_by_"
description: ""
project: community
lastmod: 2010-06-01T02:27:09-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00472"
author_name: "Samuel MORELLO"
project_section: "mailinglistitem"
sent_date: 2010-06-01T02:27:09-07:00
---


Hi,

Using Ripple, I wonder what is the best way to implement a simple
find\\_by\\_email function.
Since i don't want to use the email as a key, is there another way
that using a mapreduce function ?

Many thanks,

Samuel (newbie)


require 'ripple'
require 'digest/d5'

class User
 include Ripple::Document

 property :email, String, :presence =&gt; true
 property :hash\\_password, String, :presence =&gt; true

 def self.find\\_by\\_email(email)
 map = "
 function(v) {
 if (v.values) {
 var val = Riak.mapValuesJson(v)[0];
 return (val.email === '#{email}' ) ? v.key : null;
 } else return null;
 }
 "
 Riak::MapReduce.new(bucket.client).add(bucket).map(map,
:keep =&gt; true).run
 end

 def password=(pwd)
 self.hash\\_password = Digest::MD5.hexdigest(pwd)
 end
 def password
 self.hash\\_password
 end

end

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

