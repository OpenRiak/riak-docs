---
title: "Re: RiakSearch Reached Its Limit and gave below Error .."
description: ""
project: community
lastmod: 2010-10-31T02:38:59-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01421"
mailinglist_parent_id: "msg01418"
author_name: "Ulf Wiger"
project_section: "mailinglistitem"
sent_date: 2010-10-31T02:38:59-07:00
---



It looks as if it is the ets:new/2 operation that fails due to system\\_limit.

Like with the number of concurrently running processes, the system limit
is by default pretty low (1400 tables), but can be increased by setting the 
OS environment variable ERL\\_MAX\\_ETS\\_TABLES.

Now, I have no idea if Riak Search is supposed to need tons of ets 
tables. I know of situations where reaching the ets system limit can be a
symptom of growing backlog in the system - e.g. if mnesia is falling behind,
since every pending mnesia transaction keeps at least one ets table for 
the temporary transaction store.

BR,
Ulf W

On 31 Oct 2010, at 09:23, Prometheus WillSurvive wrote:

&gt; Hi,
&gt; 
&gt; We started a batch index test (wikipedia) when we reached around 600K docs 
&gt; system gave below error.. Any idea ? 
&gt; 
&gt; We can not index any more doc in this index.
&gt; 
&gt; 
&gt; 
&gt; =ERROR REPORT==== 31-Oct-2010::10:22:42 ===
&gt; \\*\\* Too many db tables \\*\\*
&gt; 
&gt; DEBUG: riak\\_search\\_dir\\_indexer:197 - "{ error , Type , Error , erlang : 
&gt; get\\_stacktrace ( ) }"
&gt; 
&gt; {error,error,system\\_limit,
&gt; [{ets,new,[batch,[protected,duplicate\\_bag]]},
&gt; {riak\\_search\\_client,process\\_terms\\_1,5},
&gt; {riak\\_search\\_client,process\\_terms\\_1,5},
&gt; {riak\\_search\\_client,index\\_docs,3},
&gt; {riak\\_search\\_client,index\\_docs,2},
&gt; {riak\\_solr\\_search\\_client,run\\_solr\\_command,4},
&gt; {solr\\_search,'-index\\_dir/2-lc$^0/1-0-',2},
&gt; {riak\\_search\\_dir\\_indexer,worker\\_loop,5}]}
&gt; 
&gt; 
&gt; =ERROR REPORT==== 31-Oct-2010::10:22:44 ===
&gt; Error in process &lt;0.22187.14&gt; on node 'riaksea...@192.168.250.154' with exit 
&gt; value: {system\\_limit,[{riak\\_search\\_dir\\_indexer,worker\\_loop,5}]}
&gt; 
&gt; RPC to 'riaksea...@192.168.250.154' failed: {'EXIT',
&gt; {system\\_limit,
&gt; [{riak\\_search\\_dir\\_indexer,
&gt; worker\\_loop,5}]}}
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

Ulf Wiger, CTO, Erlang Solutions, Ltd.
http://erlang-solutions.com




\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

