---
title: "Re: [newbie] riak performance - basics"
description: ""
project: community
lastmod: 2011-04-13T07:38:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02998"
mailinglist_parent_id: "msg02996"
author_name: "Kelly McLaughlin"
project_section: "mailinglistitem"
sent_date: 2011-04-13T07:38:56-07:00
---


MH,

Riak may not seem as fast in a single node configuration compared to things
like mongodb or others, but keep in mind the strengths of Riak are its
performance at scale and the ease with which it does scale. Nobody runs a
single node configuration in an actual production environment so keep that
in mind as you draw conclusions from your tests. I would encourage you to do
some testing on a cluster of nodes. Riak is written in Erlang and the
benefits of Erlang really become apparent when there is a lot of concurrent
load. The advantages of Riak specifically become apparent when you have a
few nodes crash, but don't lose any data and your cluster keeps humming
along. I would also point out the ease of administration with Riak. Scaling
either up or down is very simple I think when compared to other systems that
use shards or other schemes. Hope this helps some. Good luck and have fun!


-Kelly


On Wed, Apr 13, 2011 at 6:58 AM, M H  wrote:

&gt; Hi,
&gt;
&gt; I am new to Riak - just compiled it and trying it out. I have some
&gt; questions about performance.
&gt;
&gt; I am running a single riak node with default configuration (only
&gt; changed the IPs) on a core i7 machine (Ubuntu). I run a very simple
&gt; JMeter test (RESTful calls):
&gt; 1 .PUT a simple json object into riak (~30 bytes; key is static - so
&gt; DB has only one key)
&gt; 2. GET the object
&gt;
&gt; While the test is running riak seems to be using all the CPU it can
&gt; get - 'top' reports ~99.5% CPU usage (beam.smp is using ~780% so all 8
&gt; cores).
&gt;
&gt; Here are some results from the JMeter test:
&gt; \\* 5 threads:
&gt; 1.PUT avg: 458 ms Throughput 6.1/sec
&gt; 2.GET avg: 355 ms Throughput 6.1/sec
&gt;
&gt; \\* 50 threads:
&gt; 1.PUT avg: 5325 ms Throughput 6.1/sec
&gt; 2.GET avg: 2838 ms Throughput 6.1/sec
&gt;
&gt; The numbers are pretty disappointing. Is there something wrong with
&gt; the default configuration? Or I am misusing riak in some way? There is
&gt; only 1 key with simple value in the DB....
&gt;
&gt;
&gt; Here's some numbers from admin stats:
&gt;
&gt; vnode gets : 2118
&gt; vnode\\_puts : 1067
&gt; read\\_repairs : 1
&gt; vnode\\_gets\\_total : 224061
&gt; vnode\\_puts\\_total : 89045
&gt; node\\_gets : 680
&gt; node\\_gets\\_total : 74676
&gt; node\\_get\\_fsm\\_time\\_mean : 3047570
&gt; node\\_get\\_fsm\\_time\\_median : 2949500
&gt; node\\_get\\_fsm\\_time\\_95 : 4888000
&gt; node\\_get\\_fsm\\_time\\_99 : 5964050
&gt; node\\_get\\_fsm\\_time\\_100 : 6348870
&gt; node\\_puts : 339
&gt; node\\_puts\\_total : 29543
&gt; node\\_put\\_fsm\\_time\\_mean : 2433651
&gt; node\\_put\\_fsm\\_time\\_median : 2472125
&gt; node\\_put\\_fsm\\_time\\_95 : 4054512
&gt; node\\_put\\_fsm\\_time\\_99 : 4504152
&gt; node\\_put\\_fsm\\_time\\_100 : 4908213
&gt; read\\_repairs\\_total : 180
&gt; cpu\\_nprocs : 620
&gt; cpu\\_avg1 : 2104
&gt; cpu\\_avg5 : 2117
&gt; cpu\\_avg15 : 2099
&gt; storage\\_backend : riak\\_kv\\_bitcask\\_backend
&gt;
&gt; Any hints?
&gt;
&gt; --
&gt; MH
&gt;

