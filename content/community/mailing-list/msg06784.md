---
title: "Re: ideas on how to implement a page refresh to pull geo location	data stored in riak"
description: ""
project: community
lastmod: 2012-02-28T09:27:44-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06784"
mailinglist_parent_id: "msg06782"
author_name: "Norman Khine"
project_section: "mailinglistitem"
sent_date: 2012-02-28T09:27:44-08:00
---


yes, i have a map http://stats.zmgc.net

if you open a second window and http://stats.zmgc.net/stats/1.gif on
the first window you will get the person icon

i have not yet implemented the storage of the data in riak, i am doing
this now, but i was wondering how to deal witha page refresh, i would
like to for example, load all the unique visitors persons who have
been added to the db in the last one hour for example.

and then any new persons who 'hits' http://stats.zmgc.net/stats/1.gif
is added from that point in time.

thanks

On Tue, Feb 28, 2012 at 6:08 PM, Nicholas Young
 wrote:
&gt; Norman,
&gt;
&gt; Could you explain what you're attempting to do? I can probably help, but I'm 
&gt; not exactly sure what problem you're trying to solve, or what feature you're 
&gt; looking to implement.
&gt;
&gt; You mentioned a "page refresh" and "map". Do you need to construct a web page 
&gt; to display the results from your analytics system?
&gt;
&gt; Nicholas
&gt;
&gt; \\_\\_\\_
&gt;
&gt; Nicholas Young
&gt; http://nicholaswyoung.com
&gt;
&gt; On Feb 28, 2012, at 10:48 AM, Norman Khine  wrote:
&gt;
&gt;&gt; thanks for the advise.
&gt;&gt;
&gt;&gt; On Tue, Feb 28, 2012 at 5:07 PM, Jeremiah Peschka
&gt;&gt;  wrote:
&gt;&gt;&gt; You can create a secondary index 
&gt;&gt;&gt; (https://wiki.basho.com/Secondary-Indexes.html) on the timestamp and 
&gt;&gt;&gt; perform a secondary index query to pull back a range of data that matches 
&gt;&gt;&gt; what you are looking for.
&gt;&gt;&gt;
&gt;&gt;&gt; As far as the node.js portions, I have just as much of an idea as you. 
&gt;&gt;&gt; Perhaps someone else on this list can point you in the appropriate 
&gt;&gt;&gt; directino.
&gt;&gt;&gt; ---
&gt;&gt;&gt; Jeremiah Peschka - Managing Director, Brent Ozar PLF, LLC
&gt;&gt;&gt; Microsoft SQL Server MVP
&gt;&gt;&gt;
&gt;&gt;&gt; On Feb 28, 2012, at 7:57 AM, Norman Khine wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt; Not sure if this is the right forum to post this, but i am hoping you can 
&gt;&gt;&gt;&gt; help.
&gt;&gt;&gt;&gt; I have a livestats nodejs tracking site, code for it is here:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; https://github.com/nkhine/livestats
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; which is based on the peepcode screencast, with some updates.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; i am planning to extend the
&gt;&gt;&gt;&gt; https://github.com/nkhine/livestats/blob/master/lib/livestats.js to
&gt;&gt;&gt;&gt; include the riak-js library so as to store the data, something like:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; var db = require('riak-js').getClient({host: "riak.myhost", port: "8098" 
&gt;&gt;&gt;&gt; });
&gt;&gt;&gt;&gt; db.save('user', 'lat', 'lon', 'city', 'timestamp'});
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; but, i was wondering how to implement a page refresh and for the map
&gt;&gt;&gt;&gt; to load all entries within a set period of elapsed time. and place the
&gt;&gt;&gt;&gt; entries within the map.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; any pointers much appreciated.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; norman
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt; %&gt;&gt;&gt; "".join( [ {'\\*':'@','^':'.'}.get(c,None) or
&gt;&gt;&gt;&gt; chr(97+(ord(c)-83)%26) for c in ",adym,\\*)&uzq^zqf" ] )
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; %&gt;&gt;&gt; "".join( [ {'\\*':'@','^':'.'}.get(c,None) or
&gt;&gt; chr(97+(ord(c)-83)%26) for c in ",adym,\\*)&uzq^zqf" ] )
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com



-- 
%&gt;&gt;&gt; "".join( [ {'\\*':'@','^':'.'}.get(c,None) or
chr(97+(ord(c)-83)%26) for c in ",adym,\\*)&uzq^zqf" ] )

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

