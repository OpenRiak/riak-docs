---
title: "Re: riak stats maintenance?"
description: ""
project: community
lastmod: 2010-06-17T22:16:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00614"
mailinglist_parent_id: "msg00613"
author_name: "Dan Reverri"
project_section: "mailinglistitem"
sent_date: 2010-06-17T22:16:56-07:00
---


Hi Gareth,

If you are just looking for health checks you can use the "/ping" resource:
http://riak\\_server:riak\\_port/ping

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Thu, Jun 17, 2010 at 9:41 PM, Gareth Stokes
wrote:

&gt; Hey Dan,
&gt;
&gt; Sounds like i do need to check some things then.
&gt;
&gt; The load balancer does a health check every 30 seconds.
&gt; Going through the monitor logs, the cpu was peaking up to about 60% which
&gt; im not too sure if was caused by load or by the riak process doing whatever
&gt; it was doing.
&gt;
&gt; And, I do seem to be running pretty high on memory so ill see if i can
&gt; lower that by configuring the buffer size on the innostore backend.
&gt;
&gt; If i see it happening again, ill try and gather more information.
&gt;
&gt; gs
&gt;
&gt; On 18 June 2010 14:15, Dan Reverri  wrote:
&gt;
&gt;&gt; Hi Gareth,
&gt;&gt;
&gt;&gt; I'm not aware of any mechanism that turns the stats url off for any
&gt;&gt; reason. How often are you pinging the stats url? Do the timeouts correlate
&gt;&gt; with any other event on the system (higher load, cron job, etc.)?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Dan
&gt;&gt;
&gt;&gt; Daniel Reverri
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; d...@basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; On Thu, Jun 17, 2010 at 8:40 PM, Gareth Stokes &lt;
&gt;&gt; gar...@betechnology.com.au&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; hey guys,
&gt;&gt;&gt;
&gt;&gt;&gt; so i have a cluster of 4 physical machines with a load balancer sitting
&gt;&gt;&gt; in front to handle requests going into riak.
&gt;&gt;&gt; i thought it would be a good idea (not anymore) to use the /stats url to
&gt;&gt;&gt; ping the machines the cluster for their health. this is what i've noticed in
&gt;&gt;&gt; the logs every few days or so
&gt;&gt;&gt;
&gt;&gt;&gt; =ERROR REPORT==== 16-Jun-2010::03:48:37 ===
&gt;&gt;&gt; webmachine error: path="/stats"
&gt;&gt;&gt; {error,{exit,{timeout,{gen\\_server2,call,[riak\\_kv\\_stat,get\\_stats]}},
&gt;&gt;&gt; [{gen\\_server2,call,2},
&gt;&gt;&gt; {riak\\_kv\\_wm\\_stats,get\\_stats,0},
&gt;&gt;&gt; {riak\\_kv\\_wm\\_stats,produce\\_body,2},
&gt;&gt;&gt; {webmachine\\_resource,resource\\_call,3},
&gt;&gt;&gt; {webmachine\\_resource,do,3},
&gt;&gt;&gt; {webmachine\\_decision\\_core,resource\\_call,1},
&gt;&gt;&gt; {webmachine\\_decision\\_core,decision,1},
&gt;&gt;&gt; {webmachine\\_decision\\_core,handle\\_request,2}]}}
&gt;&gt;&gt;
&gt;&gt;&gt; it lasts anywhere between 5 - 40 minutes.
&gt;&gt;&gt; what im thinking is that a riak machine will enter "maintenance" mode
&gt;&gt;&gt; every now and then, when it does it turns the /stats url off.
&gt;&gt;&gt;
&gt;&gt;&gt; am i correct in thinking this, or should i be worried?
&gt;&gt;&gt;
&gt;&gt;&gt; regards,
&gt;&gt;&gt; gareth stokes
&gt;&gt;&gt;
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

