---
title: "Re: More Migration Questions"
description: ""
project: community
lastmod: 2012-11-13T17:21:30-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09316"
mailinglist_parent_id: "msg09315"
author_name: "Shane McEwan"
project_section: "mailinglistitem"
sent_date: 2012-11-13T17:21:30-08:00
---

G'day Tom and Matt. Thanks for your suggestions.

Even though our two cluster networks are separate it would theoretically 
be possible to have nodes from the new cluster join the old cluster and 
migrate data that way. However, we would prefer to leave the old cluster 
untouched as much as possible in case we need to abort the migration and 
continue to use the old cluster in production. Performing an upgrade on 
our currently working nodes and then essentially removing them from the 
cluster is an additional risk that we'd like to avoid.


I can certainly see how MDC would solve the problem but from a budget 
point of view it's not an option for us at the moment.


The backup-restore option is always a possibility however our database 
is currently around 80GB compressed and I'd hate to think how long it 
would take to dump and restore that. While we have a maintenance window 
I suspect it won't be long enough. :-(


We have a solution for now by using the 1.1.1 "reip" command which gets 
our migration and upgrade done. However, looking to the future it would 
be nice if there was a reliable way of moving data from one node to 
another "out of band".


Shane.

On 13/11/12 22:54, Matt Black wrote:

I still haven't really gotten to the bottom of the best way to do this
(short of paying for MDC
):

http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2012-October/009951.html

Previously, I've used backup/restore for situations like this, but our
backup has now grown to around 100GB - so it has become impractical.

Shane, in your maintenance window could you:
\\* create your new cluster
\\* stop any new data being added to the old cluster
\\* run a riak-admin backup
\\* run a riak-admin restore into the new one

The maintenance window here saves you a lot of trouble... Unfortunately,
most people won't get one ;)

Cheers
Matt

