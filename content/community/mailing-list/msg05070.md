---
title: "Re: Need help with Mapreduce"
description: ""
project: community
lastmod: 2011-10-06T06:36:18-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05070"
mailinglist_parent_id: "msg05062"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-10-06T06:36:18-07:00
---


You're also missing a comma between your map and reduce phases.

On Wed, Oct 5, 2011 at 8:23 PM, Aphyr  wrote:

&gt; Like it says, the request that you submitted isn't JSON. MR functions
&gt; belong in the source attribute of the JSON document, not floating outside
&gt; it.
&gt;
&gt; --Kyle
&gt;
&gt;
&gt; On 10/05/2011 05:19 PM, urvi wrote:
&gt;
&gt;&gt; I am trying to use this fuctntion to get the highest number from given
&gt;&gt; date. My map is working fine but reduce function is giving me error.
&gt;&gt; Please help me
&gt;&gt;
&gt;&gt; curl -X POST http://x:8098/mapred -H "Content-Type: application/json" -d
&gt;&gt; @-
&gt;&gt; function(value, keyData, arg){
&gt;&gt; var data = Riak.map.ValuesJson(value) [0];
&gt;&gt; return [data.High];
&gt;&gt; }
&gt;&gt;
&gt;&gt; {"inputs":[["symc","2011-10-\\*\\*04"],
&gt;&gt; ["symc","2011-09-02"],
&gt;&gt; ["symc","2011-10-03"]],
&gt;&gt; "query":[{"map":{"language":"\\*\\*javascript",
&gt;&gt; "source":"function(value, keyData, arg) { var data =
&gt;&gt; Riak.mapValuesJson(value)[0]; return [data.High];}"
&gt;&gt; }}
&gt;&gt; {"reduce":{"language":"\\*\\*javascript","name":"Riak.\\*\\*
&gt;&gt; reduceMax","keep":true}}]
&gt;&gt; }
&gt;&gt; --Ctrl-D to submit it
&gt;&gt;
&gt;&gt; Output :
&gt;&gt;
&gt;&gt; The POST body was not valid JSON.
&gt;&gt; The error from the parser was:
&gt;&gt; {{case\\_clause,&lt;&lt;"function(\\*\\*value, keyData, arg){ var data =
&gt;&gt; Riak.map.ValuesJson(value) [0]; return
&gt;&gt; [data.High];}{\\"inputs\\":[[\\"\\*\\*symc\\",\\"2011-10-04\\"],
&gt;&gt; [\\"symc\\",\\"2011-09-02\\"], [\\"symc\\",\\"2011-10-03\\"]],
&gt;&gt; \\"query\\":[{\\"map\\":{\\"\\*\\*language\\":\\"javascript\\",
&gt;&gt; \\"source\\":\\"function(value, keyData, arg) { var data =
&gt;&gt; Riak.mapValuesJson(value)[0]; return [data.High];}\\" }}
&gt;&gt; {\\"reduce\\":{\\"language\\":\\"\\*\\*javascript\\",\\"name\\":\\"Riak.\\*\\*
&gt;&gt; reduceMax\\",\\"keep\\":true}}]}"\\*\\*&gt;&gt;},
&gt;&gt; [{mochijson2,tokenize,2},
&gt;&gt; {mochijson2,decode1,2},
&gt;&gt; {mochijson2,json\\_decode,2},
&gt;&gt; {riak\\_kv\\_mapred\\_json,parse\\_\\*\\*request,1},
&gt;&gt; {riak\\_kv\\_wm\\_mapred,verify\\_\\*\\*body,2},
&gt;&gt; {riak\\_kv\\_wm\\_mapred,malformed\\_\\*\\*request,2},
&gt;&gt; {webmachine\\_resource,resource\\_\\*\\*call,3},
&gt;&gt; {webmachine\\_resource,do,3}]}
&gt;&gt;
&gt;&gt;
&gt;&gt; ------------------------------\\*\\*------------------------------\\*\\*
&gt;&gt; ------------
&gt;&gt;
&gt;&gt; View this message in context: Need help with Mapreduce
&gt;&gt; &gt; Mapreduce-tp3398423p3398423.\\*\\*html
&gt;&gt; &gt;
&gt;&gt;
&gt;&gt; Sent from the Riak Users mailing list archive
&gt;&gt; &gt;
&gt;&gt; at Nabble.com.
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\*\\*\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/\\*\\*mailman/listinfo/riak-users\\_\\*\\*lists.basho.com
&gt;&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\*\\*\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/\\*\\*mailman/listinfo/riak-users\\_\\*\\*lists.basho.com
&gt;

-- 
Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://www.basho.com/
