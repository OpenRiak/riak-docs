---
title: "Re: 'not found' after join"
description: ""
project: community
lastmod: 2011-05-02T20:14:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03195"
mailinglist_parent_id: "msg03191"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2011-05-02T20:14:54-07:00
---


Greg,

Your expectations are fair, just because you added a node doesn't mean Riak
should return notfounds. Unfortunately, we aren't quite there yet. This is
a side effect of how Riak currently implements handoff in that it
immediately updates/gossips the ring causing many partitions to handoff
immediately. If a request comes in that relies on these partitions then it
will get a notfound and perform read repair. You're situation is multiplied
by the fact that you are going from 3 nodes to 4. More vnode shuffling
occurs because of the small cluster size.

We're well aware of this and have it on our radar for improvement in a
future release.

All this said, you data will be eventually consistent. That is, all your
data will eventually be handed off and things will work as normal. It's
only during the handoff that you \\_may\\_ encounter notfounds. In this case it
would be best to add a new node to your cluster at lowest load times and if
you can spare additional hardware a few more nodes to start with is an even
easier option.

-Ryan

On Mon, May 2, 2011 at 9:48 PM, Greg Nelson  wrote:

&gt; Hello riak users!
&gt;
&gt; I have a 4 node cluster that started out as 3 nodes. ring\\_creation\\_size =
&gt; 2048, target\\_n\\_val is default (4), and all buckets have n\\_val = 3.
&gt;
&gt; When I joined the 4th node, for a few minutes some GETs were returning 'not
&gt; found' for data that was already in riak. Eventually the data was returned,
&gt; due to read repair I would assume. Is this expected? It seems that 'not
&gt; found' and read repairs should only happen when something goes wrong, like a
&gt; node goes down. Not when adding a node to the cluster, which is supposed to
&gt; be part of normal operation!
&gt;
&gt; Any help or insight is appreciated!
&gt;
&gt; Greg
&gt;

