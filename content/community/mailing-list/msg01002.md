---
title: "Ripple and formbuilding in rails 3"
description: ""
project: community
lastmod: 2010-09-01T11:48:47-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01002"
author_name: "John Axel Eriksson"
project_section: "mailinglistitem"
sent_date: 2010-09-01T11:48:47-07:00
---


I'm not exactly an expert on Rails but I've built a few simpler apps. Now
I'm working on an app using Ripple and I'm having a few issues, perhaps
I just haven't grasped riak/ripple yet...


Anyway...


class Client
 include Ripple::Document

 timestamps!
 
 property :name, String
 property :hostname, String
 property :url, String
 property :blocked, Boolean
 
 key\\_on :hostname
 
 one :web\\_server
 
 def id
 hostname
 end

 
end


class WebServer
 include Ripple::Document

 timestamps!
 
 property :name, String
 many :users
 many :clients
 
 key\\_on :name
 
 def id
 name
 end
 
end

in Rails console:

c = Client.new(:name =&gt; 'abc')
ws = WebServer.find('some.domain.name')

c.web\\_server = ws

c.save

the above works just fine (and doing curl -i against the resources in riak 
shows the links too) but...

in a (haml) form I do:
 
 .select
 %label= f.label :web\\_server
 = f.collection\\_select(:web\\_server, WebServer.all, :id, :name)
 
but here I get an error when saving saying:
 ArgumentError (Invalid value "some.domain.name" for association web\\_server of 
type WebServer on ):
 app/controllers/clients\\_controller.rb:63:in `update'


I ported the code over from a MongoDB-version of the app where these forms 
worked just fine. I'm having trouble seeing whats wrong with this, maybe I 
don't know rails
well enough...

Also, does ripple support accepts\\_nested\\_attributes\\_for (afaict it doesn't)?
