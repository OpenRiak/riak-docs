---
title: "Re: Integrating Riak"
description: ""
project: community
lastmod: 2011-11-23T08:26:06-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05725"
mailinglist_parent_id: "msg05724"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-11-23T08:26:06-08:00
---


On Wed, Nov 23, 2011 at 11:17 AM, Andy Skelton  wrote:

&gt; I will be embedding my commit hooks and MR functions in the database
&gt; VM. That's not unreasonable but that is most of my project right
&gt; there. The rest is just a tiny webmachine resource module which
&gt; provides a specialized interface for inputting data into Riak. I might
&gt; also want to embed some riak-distributed janitorial processes.
&gt;
&gt;
That's totally reasonable, and the fact that Riak exposes this
functionality (hooks and MR functions) is a risk in some ways. Call it the
"stored procedure" problem.


&gt; Maybe I've misrepresented it by calling this my "application" when
&gt; it's really only an extra part of the database that a client
&gt; application will use. I meant "application" in the Erlang/Rebar sense.
&gt; The real (exterior) application will absolutely use Riak's pb
&gt; interface.
&gt;
&gt;
Aha, now it's more clear.


&gt; Thank you for clarifying in your follow-up email. I understand your
&gt; concerns. Does my use case make more sense now? Can you point me in a
&gt; better direction as to how to make releases with my code embedded in
&gt; Riak?
&gt;
&gt;
Yes, and you might be able to make this simpler yet. Instead of building
releases, maintain your code separately (this will also let you evolve it
separately from Riak) and simply add it to the code path and start it using
switches in vm.args. Something like this:

%% Add my application's code to the path
-pz /path/to/myapp/ebin

%% Make init start my app, assuming the function myapp:start/0 exists
-s myapp

This will also allow you to roll out new versions without stopping Riak;
just send some commands to the console to reload changed modules.

Hope that helps,

Sean
