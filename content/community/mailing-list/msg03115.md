---
title: "Re: python-riak-client: 3 unit tests failed"
description: ""
project: community
lastmod: 2011-04-21T13:03:14-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03115"
mailinglist_parent_id: "msg03114"
author_name: "Mathias Meyer"
project_section: "mailinglistitem"
sent_date: 2011-04-21T13:03:14-07:00
---


Mikhail,

thanks for bringing it to our attention, I've been noticing that one particular 
error (...expected 4) myself, and I'm planning to look into and fix it asap.

As for the other two, they fail because they require Riak Search. You can 
disable them by setting the environment variable SKIP\\_SEARCH=1.

Mathias Meyer
Developer Advocate, Basho Technologies
On Donnerstag, 21. April 2011 at 21:49, Mikhail Sobolev wrote:
Hi,
&gt; 
&gt; (I'm not sure if this is a correct list for posting questions about
&gt; python-riak-client. If it's not, please direct me to the correct
&gt; forum.)
&gt; 
&gt; I downloaded:
&gt; \\* latest version of Riak (0.14.0-1 for Debian/32)
&gt; \\* the latest master of python-riak-client (git clone)
&gt; 
&gt; And run 'nosetests -v'. The outcome -- 3 failed test cases -- is a bit
&gt; alarming (see below). Could anyone suggest what to look at?
&gt; 
&gt; Kind Regards,
&gt; 
&gt; --
&gt; Misha
&gt; 
&gt; PS Just in case, it's python 2.6.6 on Ubuntu 10.10.
&gt; 
&gt; --- failed test cases ---
&gt; ======================================================================
&gt; ERROR: test\\_search\\_integration (riak.tests.test\\_all.RiakHttpTransportTestCase)
&gt; ----------------------------------------------------------------------
&gt; Traceback (most recent call last):
&gt; File "/home/mss/projects/derek/riak-python-client/riak/tests/test\\_all.py", 
&gt; line 395, in test\\_search\\_integration
&gt; results = self.client.search("searchbucket", "foo:one OR foo:two").run()
&gt; File "/home/mss/projects/derek/riak-python-client/riak/mapreduce.py", line 
&gt; 185, in run
&gt; result = t.mapred(self.\\_inputs, query, timeout)
&gt; File "/home/mss/projects/derek/riak-python-client/riak/transports/http.py", 
&gt; line 198, in mapred
&gt; result = json.loads(response[1])
&gt; File "/usr/lib/python2.6/json/\\_\\_init\\_\\_.py", line 307, in loads
&gt; return \\_default\\_decoder.decode(s)
&gt; File "/usr/lib/python2.6/json/decoder.py", line 319, in decode
&gt; obj, end = self.raw\\_decode(s, idx=\\_w(s, 0).end())
&gt; File "/usr/lib/python2.6/json/decoder.py", line 338, in raw\\_decode
&gt; raise ValueError("No JSON object could be decoded")
&gt; ValueError: No JSON object could be decoded
&gt; 
&gt; ======================================================================
&gt; ERROR: test\\_search\\_integration (riak.tests.test\\_all.RiakPbcTransportTestCase)
&gt; ----------------------------------------------------------------------
&gt; Traceback (most recent call last):
&gt; File "/home/mss/projects/derek/riak-python-client/riak/tests/test\\_all.py", 
&gt; line 395, in test\\_search\\_integration
&gt; results = self.client.search("searchbucket", "foo:one OR foo:two").run()
&gt; File "/home/mss/projects/derek/riak-python-client/riak/mapreduce.py", line 
&gt; 185, in run
&gt; result = t.mapred(self.\\_inputs, query, timeout)
&gt; File "/home/mss/projects/derek/riak-python-client/riak/transports/pbc.py", 
&gt; line 300, in mapred
&gt; msg\\_code, resp = self.recv\\_msg()
&gt; File "/home/mss/projects/derek/riak-python-client/riak/transports/pbc.py", 
&gt; line 349, in recv\\_msg
&gt; self.recv\\_pkt()
&gt; File "/home/mss/projects/derek/riak-python-client/riak/transports/pbc.py", 
&gt; line 390, in recv\\_pkt
&gt; format(nmsglen))
&gt; RiakError: Socket returned short packet length - expected 4
&gt; 
&gt; ======================================================================
&gt; ERROR: test\\_store\\_of\\_missing\\_object 
&gt; (riak.tests.test\\_all.RiakPbcTransportTestCase)
&gt; ----------------------------------------------------------------------
&gt; Traceback (most recent call last):
&gt; File "/home/mss/projects/derek/riak-python-client/riak/tests/test\\_all.py", 
&gt; line 369, in test\\_store\\_of\\_missing\\_object
&gt; o = o.store()
&gt; File "/home/mss/projects/derek/riak-python-client/riak/riak\\_object.py", line 
&gt; 277, in store
&gt; Result = t.put(self, w, dw, return\\_body)
&gt; File "/home/mss/projects/derek/riak-python-client/riak/transports/pbc.py", 
&gt; line 190, in put
&gt; msg\\_code, resp = self.recv\\_msg()
&gt; File "/home/mss/projects/derek/riak-python-client/riak/transports/pbc.py", 
&gt; line 349, in recv\\_msg
&gt; self.recv\\_pkt()
&gt; File "/home/mss/projects/derek/riak-python-client/riak/transports/pbc.py", 
&gt; line 390, in recv\\_pkt
&gt; format(nmsglen))
&gt; RiakError: Socket returned short packet length - expected 4
&gt; 
&gt; ----------------------------------------------------------------------
&gt; Ran 54 tests in 1.526s
&gt; 
&gt; FAILED (errors=3)
&gt; 
 
