---
title: "Re: Node will not leave cluster"
description: ""
project: community
lastmod: 2012-06-06T08:20:47-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07625"
mailinglist_parent_id: "msg07622"
author_name: "Swinney, Austin"
project_section: "mailinglistitem"
sent_date: 2012-06-06T08:20:47-07:00
---


Hi Dave,

I'm no expert, however, I using riak (1.1.1 2012-03-07) RedHat x86\\_64.

I typically issue the leave command for the node. When:

-- all it's Ownership Handoffs (riak-admin ring\\_status) are done
-- it is at 0.0% in both Ring and Pending in `riak-admin member\\_status`
-- tailing the log on the node ( /var/log/riak/console.log ) stops showing 
handoffs

Then I take it to be done leaving. The documentation says, "When all data is 
handed off, the Erlang VM process eventually exits." But in my experience with 
this version, that never happens. Maybe I'm just too impatient?

So I do that manually:

-- stop the node's riak on the node with `riak stop`
-- from another node, mark it as down (riak-admin down 
r...@xxx.x.x.xx)

Then it stays in the down list of hosts.

I'm probably doing this all wrong and just clarifying how NOT to do it. :-P

Best Regards,

Austin

On Jun 6, 2012, at 10:26 AM, David Greenstein wrote:


I've issued the riak-admin leave command on one of my nodes but it does not 
seem to ever leave the cluster of 4 nodes. I've opened up all firewall ports to 
make sure the repartitioning isn't being blocked. riak-admin status on all 
nodes shows the node in question it is still connected and a ring\\_member. If I 
issue the riak-admin leave command again the error states the node is already 
in the process of leaving. I've made sure no clients are connecting to the node 
that left as well. I'm also still seeing bit cast Merge log messages in the 
console.log of the node that left.

Has anyone experienced this issue and have some clues as to possible causes?

Thank you!
Dave Greenstein
