---
title: "Re: multiple map functions query"
description: ""
project: community
lastmod: 2011-10-28T07:13:12-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05340"
mailinglist_parent_id: "msg05338"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-10-28T07:13:12-07:00
---


I think you should reply-all to the list. Also, I can barely read Erlang so I 
can only tell you that your code looks like Erlang.

---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Oct 28, 2011, at 7:11 AM, Lyes zaiko wrote:

&gt; So! I think that I have to be more explicit
&gt; 
&gt; I have run a test mapred query using two simple map functions, each one 
&gt; returns the input object (in a list). but by runnin the query I get a 
&gt; badmatch error
&gt; 
&gt; Map1 = fun(O,\\_,\\_) -&gt; [O] end.
&gt; Map2 = fun(O, \\_,\\_) -&gt; [O] end.
&gt; 
&gt; 
&gt; C:mapred\\_bucket(&lt;&lt;"b7bc1418-198d-44a3-8835-8aa9cb416d5b"&gt;&gt;, [{map, {qfun, 
&gt; Map1}, none, false}, {map, {qfun, Map2}, none, true}]).
&gt; 
&gt; {{badmatch,{r\\_object,&lt;&lt;"b7bc1418-198d-44a3-8835-8aa9cb416d5b"&gt;&gt;,
&gt; &lt;&lt;255,230,193,167,254,7,246,64,154,190,36,236,32,232,189,
&gt; 169,161,124,23,86&gt;&gt;,
&gt; [{r\\_content,{dict,2,16,16,8,80,48,
&gt; {[],[],[],[],[],[],[],[],[],[],[],...},
&gt; {{[],[],[],[],[],[],[],[],[],...}}},
&gt; &lt;&lt;"12d33872-4c92-4da5-9d16-5036a8059253"&gt;&gt;}],
&gt; [{&lt;&lt;5,215,86,61&gt;&gt;,{1,63487018636}}],
&gt; {dict,1,16,16,8,80,48,
&gt; {[],[],[],[],[],[],[],[],[],[],[],[],...},
&gt; {{[],[],[],[],[],[],[],[],[],[],...}}},
&gt; undefined}},
&gt; [{riak\\_kv\\_map\\_phase,build\\_input,2},
&gt; {riak\\_kv\\_map\\_phase,'-handle\\_input/3-lc$^0/1-0-',2},
&gt; {riak\\_kv\\_map\\_phase,handle\\_input,3},
&gt; {luke\\_phase,executing,2},
&gt; {gen\\_fsm,handle\\_msg,7},
&gt; {proc\\_lib,init\\_p\\_do\\_apply,3}]}
&gt; 
&gt; I'm using riak\\_search-0.14.2
&gt; 
&gt; Erlang R14B03 (erts-5.8.4)
&gt; 
&gt; On Fri, Oct 28, 2011 at 3:02 PM, Jeremiah Peschka 
&gt;  wrote:
&gt; A list.
&gt; ---
&gt; Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
&gt; Microsoft SQL Server MVP
&gt; 
&gt; On Oct 28, 2011, at 6:59 AM, Lyes zaiko wrote:
&gt; 
&gt; &gt; Hi all!
&gt; &gt;
&gt; &gt; I want to execute a mapreduce query, in erlang, that contains two map 
&gt; &gt; phases such that the Map2 function takes the result of the Map1 function as 
&gt; &gt; input. Is it possible and if, what must be the return value of each map 
&gt; &gt; phase
&gt; &gt;
&gt; &gt; Thank you!
&gt; 
&gt; 
 
