---
title: "Clarification on key filters"
description: ""
project: community
lastmod: 2011-05-25T18:35:13-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03412"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-05-25T18:35:13-07:00
---


An MR job has 0 or more key filters. Adding a few transforms generates a
lovely list of lists:

{
 "inputs":{
 "bucket":"invoices"
 "key\\_filters":[["tokenize", "-", 1],
 ["to\\_lower"],
 ["matches", "solutions"]]
 },
 // ...}

That makes sense: we've got a list of key filters. And a key filter is, in
effect, a list of arguments.

The complex predicates are throwing me off. Looking at the spec from Ripple
in filter\\_builder\\_spec.rb [1] and it's showing that

subject.OR do
 starts\\_with "foo"
 ends\\_with "bar"
end

becomes

[[:or, [[:starts\\_with, "foo"],[:ends\\_with, "bar"]]]]

Which is not at all the same as what the wiki says an OR should look like:

["or", [["eq", "google"]], [["less\\_than", "g"]]]

Apart from the obvious difference in syntax, have I been drinking mouthwash
or did the wiki suddenly switch from showing a complete key filter condition
to showing an individual key filter command for AND, OR, and NOT?

Jeremiah
