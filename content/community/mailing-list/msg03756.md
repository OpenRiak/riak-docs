---
title: "Re: Benchmarks of backends"
description: ""
project: community
lastmod: 2011-06-21T06:29:52-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03756"
mailinglist_parent_id: "msg03742"
author_name: "Justin Sheehy"
project_section: "mailinglistitem"
sent_date: 2011-06-21T06:29:52-07:00
---


Hi, Anthony.

Most people using Riak today use either Bitcask or Innostore, as I suspect you 
know. Bitcask has excellent performance, but the limitation that you are aware 
of with a hard limit on number of keys per unit of available RAM. Innostore 
does not have that limitation, but is much harder to achieve equivalent 
performance on.

You've noticed that multiple people (including Basho's own Dizzy and also the 
estimable Paul Davis) have produced wrappers for LevelDB, and indeed we are 
currently evaluating this as another alternative storage engine behind Riak. 
We will be posting some performance thoughts on LevelDB shortly, and generally 
it looks promising. The main blocker at this point is portability; we would 
like for the backend to run well on all of Riak's existing main platforms.

Expect more from us on this soon. The short answer is that if you have too many 
keys for bitcask, the answer today is usually Innostore but soon might be 
LevelDB instead.

Best,

-Justin


On Jun 17, 2011, at 7:12 PM, Anthony Molinaro wrote:

&gt; Hi,
&gt; 
&gt; I'm wondering if anyone has done any testing with regards to memory
&gt; usage of various backends. After recent emails about the large overhead
&gt; of bitcask keydir indexes, and by comparing with my current production
&gt; nodes. I find that the overhead per key ends up being too large for
&gt; small keys.
&gt; 
&gt; So I'm in the market for a new backend, and was wondering if anyone
&gt; out there has done any measurements on memory overhead per key, and
&gt; access times.
&gt; 
&gt; I'm also wondering if there are any backends floating out there I haven't
&gt; found. I've done some google searches to come across
&gt; 
&gt; https://github.com/krestenkrab/riak\\_btree\\_backend
&gt; https://github.com/cstar/riak\\_redis\\_backend
&gt; 
&gt; but I'm assuming there might be others.
&gt; 
&gt; Also, I figure it would be interesting to understand the overhead for
&gt; the built in backends and innnostore and possibly look at other stores
&gt; I've found which seem to have erlang wrappers like
&gt; 
&gt; LevelDB:
&gt; https://github.com/basho/e\\_leveldb
&gt; https://github.com/davisp/erleveldb
&gt; Tokyo Cabinet:
&gt; https://github.com/rabbitmq/toke
&gt; Berkeley DB:
&gt; https://github.com/krestenkrab/bets
&gt; 
&gt; So anyone know anything about these backends or other k/v stores in terms
&gt; of memory versus disk for large datasets?
&gt; 
&gt; The thing prompting this is a cassandra cluster with about 14 billion
&gt; entries (7 billion with replication factor of 2), which uses 60 machines.
&gt; I was trying to determine how many bitcask backed machines it would take
&gt; to store this data and it ends up being about 150. This is mostly because
&gt; of the 84 bytes of overhead per key (43 bytes by calculations determined
&gt; on this list a few weeks ago, another 41 by measuring my current production
&gt; setup). Even with the keys of 17 bytes, thats 101 bytes of overhead,
&gt; so just wondering if there's anything better.
&gt; 
&gt; Anyway, I'm trying to get some hardware to run basho\\_bench with and will
&gt; try out some different things, but if anyone has done any of this work
&gt; already it might be interesting to know.
&gt; 
&gt; Thanks,
&gt; 
&gt; -Anthony
&gt; 
&gt; -- 
&gt; ------------------------------------------------------------------------
&gt; Anthony Molinaro 
&gt; 
