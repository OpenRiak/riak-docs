---
title: "Re: webmachine error"
description: ""
project: community
lastmod: 2011-01-06T08:33:04-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01908"
mailinglist_parent_id: "msg01907"
author_name: "Rusty Klophaus"
project_section: "mailinglistitem"
sent_date: 2011-01-06T08:33:04-08:00
---


Hi Bogdan,

It looks like you are running into two issues here:

The 0.13 release of Riak Search doesn't support the "application/x-erlang"
content type, so your document is getting parsed using the "raw" extractor.
(Basically, it is getting treated as plain text, and the entire document is
indexed under a single field name.)

Also, in 0.13, the raw extractor had a bug that caused it to always use a
field name of "value". I believe this is the source of the webmachine error
that you see. This is tracked here (
https://issues.basho.com/show\\_bug.cgi?id=840) and fixed in the upcoming 0.14
release of Riak Search.

Your options in the short term are to either use JSON or XML encoding for
your document, or wait for the 0.14 release of Riak Search. (This should be
very soon, barring any unseen problems.)

If you'd like, you can play with the latest release in the riak\\_search-0.14
branch on Github. (
https://github.com/basho/riak\\_search/tree/riak\\_search-0.14)

Best,
Rusty

On Thu, Jan 6, 2011 at 10:51 AM, BOG BOG  wrote:

&gt; Hello Riak Users,
&gt;
&gt; After a failed attempt to 'put' an object witk riakc\\_pb\\_socket api, into a
&gt; bucket enabled for indexing and the retrying the same operation with erlang
&gt; http
&gt; client I get the following error.
&gt;
&gt;
&gt; It seems to me that this error does not even suppose to appear here.
&gt; webmachine error: path="/riak/noi/0000159876/"
&gt; {error,{error,badarg,
&gt;
&gt; [{erlang,iolist\\_to\\_binary,[{error,missing\\_field,&lt;&lt;"value"&gt;&gt;}]},
&gt; {wrq,append\\_to\\_response\\_body,2},
&gt; {riak\\_kv\\_wm\\_raw,accept\\_doc\\_body,2},
&gt; {webmachine\\_resource,resource\\_call,3},
&gt; {webmachine\\_resource,do,3},
&gt; {webmachine\\_decision\\_core,resource\\_call,1},
&gt; {webmachine\\_decision\\_core,accept\\_helper,0},
&gt; {webmachine\\_decision\\_core,decision,1}]}}
&gt;
&gt;
&gt; The schema I am working with lokks like:
&gt;
&gt; {
&gt; schema,
&gt; [
&gt; {version, "1.1"},
&gt; {default\\_field, "index"},
&gt; {default\\_op, "or"},
&gt; {n\\_val, 3},
&gt; {analyzer\\_factory,
&gt; "com.basho.search.analysis.DefaultAnalyzerFactory"}
&gt; ],
&gt; [
&gt; {field, [{name, "index"},{type, string}]},
&gt;
&gt; {field, [{name, "period"},{type, integer}]},
&gt; {field, [{name, "request\\_date"},{type, string}]},
&gt; {field, [{name, "comment"},{type, string}]},
&gt; {field, [{name, "operator"},{type, string}]},
&gt; {field, [{name, "last\\_update"},{type, string}]},
&gt;
&gt; {field, [{name, "worker\\_name"},{type, string}]},
&gt; {field, [{name, "worker\\_street1"},{type, string}]},
&gt; {field, [{name, "worker\\_street2"},{type, string}]},
&gt; {field, [{name, "worker\\_street3"},{type, string}]},
&gt; {field, [{name, "worker\\_city"},{type, string}]},
&gt; {field, [{name, "worker\\_sp"},{type, string}]},
&gt; {field, [{name, "worker\\_pc"},{type, string}]},
&gt; {field, [{name, "worker\\_cc"},{type, string}]},
&gt; {field, [{name, "worker\\_phone"},{type, string}]},
&gt; {field, [{name, "worker\\_fax"},{type, string}]},
&gt; {field, [{name, "worker\\_email"},{type, string}]}
&gt; }.
&gt;
&gt; A working document would look like:
&gt; [{"index",&lt;&lt;"0000314871"&gt;&gt;},
&gt;
&gt;
&gt; {"period",1},
&gt;
&gt;
&gt; {"request\\_date",&lt;&lt;"2011-01-05 15:06:41"&gt;&gt;},
&gt;
&gt;
&gt; {"comment",&lt;&lt;&gt;&gt;},
&gt;
&gt;
&gt; {"operator",&lt;&lt;"requests\\_new"&gt;&gt;},
&gt;
&gt;
&gt; {"last\\_update",&lt;&lt;"2011-01-05 15:06:41"&gt;&gt;},
&gt;
&gt;
&gt; {"worker",
&gt;
&gt;
&gt; {struct,[{"name",&lt;&gt;},
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; {"street1",&lt;&lt;"Str. Muzeul Zambaccian 22B, Ap.1, Sector 1"&gt;&gt;},
&gt;
&gt;
&gt; {"street2",&lt;&lt;&gt;&gt;},
&gt;
&gt;
&gt; {"street3",&lt;&lt;&gt;&gt;},
&gt;
&gt;
&gt; {"city",&lt;&lt;"Bucuresti"&gt;&gt;},
&gt;
&gt;
&gt; {"sp",&lt;&lt;&gt;&gt;},
&gt;
&gt;
&gt; {"pc",&lt;&lt;&gt;&gt;},
&gt;
&gt;
&gt; {"cc",&lt;&lt;"RO"&gt;&gt;},
&gt;
&gt;
&gt; {"phone",&lt;&lt;"+40.723454529"&gt;&gt;},
&gt;
&gt;
&gt; {"fax",&lt;&lt;&gt;&gt;},
&gt;
&gt;
&gt; {"email",&lt;&lt;"ileana...@yahoo.com"&gt;&gt;}]}}]
&gt;
&gt; and I am using riak\\_search-0.13
&gt;
&gt; Best Wishes,
&gt; Bogdan
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

