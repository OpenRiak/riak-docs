---
title: "Re: innostore and multi_backend"
description: ""
project: community
lastmod: 2010-11-23T18:55:27-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01618"
mailinglist_parent_id: "msg01617"
author_name: "Dan Reverri"
project_section: "mailinglistitem"
sent_date: 2010-11-23T18:55:27-08:00
---


Can you provide the full app.config? I'd like to see if multi backend has
been setup correctly.

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Tue, Nov 23, 2010 at 6:35 PM, Joseph Lambert
wrote:

&gt; This:
&gt;
&gt; {riak\\_kv, [
&gt; ....
&gt; {multi\\_backend, [
&gt; ....
&gt; {&lt;&lt;"inno"&gt;&gt;, riak\\_kv\\_innostore\\_backend, []}
&gt; ]}
&gt; ]},
&gt;
&gt; ....
&gt; {innostore, [
&gt; {data\\_home\\_dir, "/var/lib/riak/innostore"},
&gt; {log\\_group\\_home\\_dir, "/var/lib/riak/inno-log"},
&gt; {buffer\\_pool\\_size, 4294967296},
&gt; {log\\_files\\_in\\_group, 6},
&gt; {log\\_file\\_size, 16777216}
&gt; ]}
&gt;
&gt; Then this (without an entry for multi\\_backend, definitely won't work, since
&gt; it's not declared in multi\\_backend):
&gt; {riak\\_kv, [
&gt; ....
&gt; {multi\\_backend, [
&gt; ....
&gt; ]}
&gt; ]},
&gt;
&gt; ....
&gt; {innostore, [
&gt; {data\\_home\\_dir, "/var/lib/riak/innostore"},
&gt; {log\\_group\\_home\\_dir, "/var/lib/riak/inno-log"},
&gt; {buffer\\_pool\\_size, 4294967296},
&gt; {log\\_files\\_in\\_group, 6},
&gt; {log\\_file\\_size, 16777216}
&gt; ]}
&gt;
&gt;
&gt; I also tried with {innostore, riak\\_kv\\_innostore\\_backend, []} in
&gt; multi\\_backend. First one gives the error mentioned in the previous email.
&gt;
&gt;
&gt; - Joe Lambert
&gt;
&gt; joseph.g.lamb...@gmail.com
&gt;
&gt;
&gt; On Wed, Nov 24, 2010 at 10:18 AM, Dan Reverri  wrote:
&gt;
&gt;&gt; Can you provide the different app.configs you are using?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Dan
&gt;&gt;
&gt;&gt; Daniel Reverri
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; d...@basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; On Tue, Nov 23, 2010 at 5:59 PM, Joseph Lambert &lt;
&gt;&gt; joseph.g.lamb...@gmail.com&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; Hi Dan,
&gt;&gt;&gt;
&gt;&gt;&gt; I'm using riak\\_search 0.13.0 and innostore 1.0.2, btw.
&gt;&gt;&gt;
&gt;&gt;&gt; If I add the default innostore configuration like on the configuration
&gt;&gt;&gt; page, and also add an entry for innostore in the multi\\_backend I get this
&gt;&gt;&gt; error on startup:
&gt;&gt;&gt;
&gt;&gt;&gt; {{{badmatch,
&gt;&gt;&gt; {error,
&gt;&gt;&gt; {eagain,
&gt;&gt;&gt; [{erlang,open\\_port,
&gt;&gt;&gt; [{spawn,innostore\\_drv},[binary]]},
&gt;&gt;&gt; {innostore,connect,0},
&gt;&gt;&gt; {riak\\_kv\\_innostore\\_backend,start,2},
&gt;&gt;&gt;
&gt;&gt;&gt; {riak\\_kv\\_multi\\_backend,'-start/2-lc$^0/1-0-',2},
&gt;&gt;&gt;
&gt;&gt;&gt; {riak\\_kv\\_multi\\_backend,'-start/2-lc$^0/1-0-',2},
&gt;&gt;&gt; {riak\\_kv\\_multi\\_backend,start,2},
&gt;&gt;&gt; {riak\\_kv\\_vnode,init,1},
&gt;&gt;&gt; {riak\\_core\\_vnode,init,1}]}}},
&gt;&gt;&gt; [{riak\\_core\\_vnode\\_master,get\\_vnode,2},
&gt;&gt;&gt; {riak\\_core\\_vnode\\_master,handle\\_call,3},
&gt;&gt;&gt; {gen\\_server,handle\\_msg,5},
&gt;&gt;&gt; {proc\\_lib,init\\_p\\_do\\_apply,3}]},
&gt;&gt;&gt; {gen\\_server,call,
&gt;&gt;&gt; [riak\\_kv\\_vnode\\_master,
&gt;&gt;&gt; {1096126227998177188652763624537212264741949407232,
&gt;&gt;&gt; get\\_vnode},
&gt;&gt;&gt; infinity]}}
&gt;&gt;&gt;
&gt;&gt;&gt; If I take out the innostore configuration from multi\\_backend, I get an
&gt;&gt;&gt; error about the backend not existing.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; - Joe Lambert
&gt;&gt;&gt;
&gt;&gt;&gt; joseph.g.lamb...@gmail.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Wed, Nov 24, 2010 at 2:34 AM, Dan Reverri  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; You are correct, the innostore backend is not using the parameters
&gt;&gt;&gt;&gt; passed to it by multi\\_backend:
&gt;&gt;&gt;&gt; https://issues.basho.com/show\\_bug.cgi?id=890
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Rather than modifying the innostore.app file you can configure the
&gt;&gt;&gt;&gt; default innostore settings in your Riak app.config file:
&gt;&gt;&gt;&gt; [
&gt;&gt;&gt;&gt; {riak\\_core, [...riak\\_core settings...]},
&gt;&gt;&gt;&gt; {riak\\_kv, [...riak\\_kv settings...]},
&gt;&gt;&gt;&gt; {innostore, [{buffer\\_pool\\_size, 8589934592}, ...other settings...]}
&gt;&gt;&gt;&gt; ]
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt; Dan
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Daniel Reverri
&gt;&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt; d...@basho.com
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Tue, Nov 23, 2010 at 2:02 AM, Joseph Lambert &lt;
&gt;&gt;&gt;&gt; joseph.g.lamb...@gmail.com&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Does anyone have innostore set up under multi\\_backend? I can't seem to
&gt;&gt;&gt;&gt;&gt; get it to work properly with multi\\_backend.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I tried adding it under the multi\\_backend, but it won't use any
&gt;&gt;&gt;&gt;&gt; parameters passed in in the third parameter. If I set it up as an
&gt;&gt;&gt;&gt;&gt; application, you can't select it as a backend. If I use both, I get an 
&gt;&gt;&gt;&gt;&gt; error
&gt;&gt;&gt;&gt;&gt; with the erlang open\\_port command (guess it's trying to spawn it twice if 
&gt;&gt;&gt;&gt;&gt; I
&gt;&gt;&gt;&gt;&gt; have it under multi\\_backend and configured as an app).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Is the solution here to modify the innostore.app file to give me the
&gt;&gt;&gt;&gt;&gt; defaults I want, build it then install innostore (if I set it up only 
&gt;&gt;&gt;&gt;&gt; under
&gt;&gt;&gt;&gt;&gt; multi\\_backend, it will work, but with the default app settings)?
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; If I've just completely missed the mark, don't be afraid to mock me :).
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; - Joe Lambert
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; joseph.g.lamb...@gmail.com
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;
