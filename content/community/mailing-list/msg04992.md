---
title: "Re: Any optimizations related to small and bit clock?"
description: ""
project: community
lastmod: 2011-10-03T08:38:45-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04992"
mailinglist_parent_id: "msg04990"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2011-10-03T08:38:45-07:00
---


Sounds great. If you are performing a rolling upgrade make sure to
modify/add vnode\\_vclocks after all nodes have transitioned to 1.0 [1].

[1]: http://wiki.basho.com/Rolling-Upgrades.html

On Mon, Oct 3, 2011 at 11:22 AM, Gordon Tillman  wrote:

&gt; Morning Ryan,
&gt;
&gt; Hey thanks for the info. I'm testing with 1.0 right now (great job with
&gt; that by the way) and I hope to be able to switch our deployment package over
&gt; to 1.0 soon.
&gt;
&gt; As always I appreciate your time and trouble.
&gt;
&gt; --gordon
&gt;
&gt;
&gt; On Oct 3, 2011, at 10:02 , Ryan Zezeski wrote:
&gt;
&gt; Gordon,
&gt;
&gt; It's worth pointing out that in 1.0 this should be greatly improved because
&gt; now we have changed vclock behavior in relation to PUTs [1]. Essentially,
&gt; client id now comes from the vnode, not externally, which leads to
&gt; smaller/static vclock sizes even in the face of frequent updates.
&gt;
&gt; I can't say with complete certainty that reducing the small/big vclock
&gt; won't change your perf characteristics but I will say it is probably better
&gt; to have smaller vclocks which in turn leads to smaller objects. Since
&gt; pruning will happen more often I would imagine your PUT latencies could
&gt; potentially go up a little. The best way to know is to measure.
&gt;
&gt; Another option is setting last\\_write\\_wins to true but this should only be
&gt; used as a last effort and only if you truly don't care about siblings [2].
&gt;
&gt; -Ryan
&gt;
&gt; [1]: Checkout the section titled "Get/Put Improvements" in the release
&gt; notes. https://github.com/basho/riak/blob/riak-1.0.0/RELEASE-NOTES.org
&gt;
&gt; [2]: http://wiki.basho.com/Vector-Clocks.html#Siblings
&gt;
&gt; On Fri, Sep 2, 2011 at 11:33 AM, Gordon Tillman wrote:
&gt;
&gt;&gt; Morning All,
&gt;&gt;
&gt;&gt; I have noticed that with the default vclock settings the size of the
&gt;&gt; X-Riak-Vclock header gets really big really fast for certain objects that
&gt;&gt; are updated frequently. I am considering setting small\\_vclock to 4 and
&gt;&gt; big\\_vclock to 16 instead of the default values of 10 and 50, respectivly.
&gt;&gt;
&gt;&gt; I know that that are various performance optimizations that are based upon
&gt;&gt; certain default bucket settings and was wondering if this change would
&gt;&gt; adversely affect any of those.
&gt;&gt;
&gt;&gt; Many thanks!
&gt;&gt;
&gt;&gt; --gordon tillman
&gt;&gt;
&gt;
&gt;
&gt;
