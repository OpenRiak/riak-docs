---
title: "Re: object not stored"
description: ""
project: community
lastmod: 2011-08-31T08:44:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04539"
mailinglist_parent_id: "msg04538"
author_name: "Jonathan Langevin"
project_section: "mailinglistitem"
sent_date: 2011-08-31T08:44:55-07:00
---


Your server is single instance? Meaning you have only 1 node in your
"cluster"?
In that case, first issue I see is that your n\\_val is set to 3. You need it
set to 1 to reflect that you only have 1 node.

Also, keep in mind that if you decide to add more servers to make a proper
cluster, you'll have to drop your current instance, reconfigure for 3+
nodes, and then you'll be able to work with additional nodes.
There's also apparently one or more ways to convert the single-node to work
in a proper cluster, but from what I gather, it's a royal pain, and much
simpler to start over.
\\*


 
 Jonathan Langevin
Systems Administrator
Loom Inc.
Wilmington, NC: (910) 241-0433 - jlange...@loomlearning.com -
www.loomlearning.com - Skype: intel352
\\*


On Wed, Aug 31, 2011 at 11:36 AM, Giancarlo Frison wrote:

&gt; This is the bucket conf:
&gt;
&gt; gfrison@gfw:~$ curl http://localhost:8098/riak/user
&gt;
&gt; {"props":{"name":"user","n\\_val":3,"allow\\_mult":false,"last\\_write\\_wins":false,"precommit":[],"postcommit":[],"chash\\_keyfun":{"mod":"riak\\_core\\_util","fun":"chash\\_std\\_keyfun"},"linkfun":{"mod":"riak\\_kv\\_wm\\_link\\_walker","fun":"mapreduce\\_linkfun"},"old\\_vclock":86400,"young\\_vclock":20,"big\\_vclock":50,"small\\_vclock":10,"r":"quorum","w":"quorum","dw":"quorum","rw":"quorum"}}
&gt;
&gt; the server is single instance, the configuration is the default, no
&gt; changes.
&gt;
&gt; I store the object as:
&gt;
&gt; rc.store(ob, new StoreMeta(1, 1, true))
&gt; w=1,dw=1,returnbody=true
&gt;
&gt;
&gt; Can you help me?
&gt;
&gt; Giancarlo Frison
&gt;
&gt;
&gt;
&gt; On Wed, Aug 31, 2011 at 4:01 PM, Jonathan Langevin &lt;
&gt; jlange...@loomlearning.com&gt; wrote:
&gt;
&gt;&gt; That could occur, depending on how many nodes are in your cluster, what
&gt;&gt; your r/w/dw settings are set to when fetching the object, how soon after
&gt;&gt; storing you attempt to fetch.
&gt;&gt; What is your configuration? i.e. - how many nodes in your cluster, what
&gt;&gt; settings are you using for reading & writing to Riak (r/w/dw, etc), what are
&gt;&gt; your bucket settings set to?
&gt;&gt;
&gt;&gt; I'm not advanced enough to help, but that info should hopefully help the
&gt;&gt; others on the list ;-)
&gt;&gt; \\*
&gt;&gt;
&gt;&gt; 
&gt;&gt; Jonathan Langevin
&gt;&gt; Systems Administrator
&gt;&gt; Loom Inc.
&gt;&gt; Wilmington, NC: (910) 241-0433 - jlange...@loomlearning.com -
&gt;&gt; www.loomlearning.com - Skype: intel352
&gt;&gt; \\*
&gt;&gt;
&gt;&gt;
&gt;&gt; On Wed, Aug 31, 2011 at 9:29 AM, Giancarlo Frison wrote:
&gt;&gt;
&gt;&gt;&gt; Hi all,
&gt;&gt;&gt;
&gt;&gt;&gt; Sometimes happen that storing object with PB client doesn't work, the
&gt;&gt;&gt; snippet is:
&gt;&gt;&gt;
&gt;&gt;&gt; IRiakObject ob =
&gt;&gt;&gt; RiakObjectBuilder.newBuilder(bucket,key).withContentType("application/json").withValue(json).build();
&gt;&gt;&gt; return rc.store(ob, new StoreMeta(1, 1, true)).getVclock().getBytes();
&gt;&gt;&gt;
&gt;&gt;&gt; below it is the snoop of storing action. As you can see the riak server
&gt;&gt;&gt; is invoked by the client and return the object:
&gt;&gt;&gt;
&gt;&gt;&gt; T 127.0.0.1:52015 -&gt; 127.0.0.1:8087 [AP]
&gt;&gt;&gt; .....
&gt;&gt;&gt; .user..gfrison"..
&gt;&gt;&gt;
&gt;&gt;&gt; G{"name":"Giancarlo","id":"gfrison","password":"pwd","surname":"frison"}..application/json;charset=utf-82"
&gt;&gt;&gt; .eclass-general\\_domain..User..iof(.0.8.
&gt;&gt;&gt; ##
&gt;&gt;&gt; T 127.0.0.1:8087 -&gt; 127.0.0.1:52015 [AP]
&gt;&gt;&gt; .....
&gt;&gt;&gt; ..
&gt;&gt;&gt;
&gt;&gt;&gt; G{"name":"Giancarlo","id":"gfrison","password":"pwd","surname":"frison"}..application/json;charset=utf-8\\*.4fXUimzXj3g0ukJHcpuxm32"
&gt;&gt;&gt; .eclass-general\\_domain..User..iof8.....@
&gt;&gt;&gt; ..).\\*k.a```.`..R,..E..L..y....W..A....L.
&gt;&gt;&gt; ?..g..
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; but when I try to get such object, I got not found:
&gt;&gt;&gt;
&gt;&gt;&gt; gfrison@ttw:~$ curl http://localhost:8098/riak/user/gfrison
&gt;&gt;&gt; not found
&gt;&gt;&gt;
&gt;&gt;&gt; Have you any hint on it?
&gt;&gt;&gt;
&gt;&gt;&gt; thanks!
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Giancarlo Frison
&gt;&gt;&gt; @gfrison
&gt;&gt;&gt;
&gt;&gt;&gt;

&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;

