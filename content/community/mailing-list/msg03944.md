---
title: "Re: db.save() vs. db.update()"
description: ""
project: community
lastmod: 2011-07-06T06:26:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03944"
mailinglist_parent_id: "msg03939"
author_name: "Mathias Meyer"
project_section: "mailinglistitem"
sent_date: 2011-07-06T06:26:21-07:00
---


Claus,

it looks you're mixing up metadata objects with actual data objects when 
calling update. update does a get/put cycle, where it fetches an object, merges 
its attributes with the ones you hand over to update() and save the result 
back. Any change you accidentally pass in the meta object from a different part 
of your code that's fetching the object initially?

Mathias Meyer
Developer Advocate, Basho Technologies


On Mittwoch, 6. Juli 2011 at 00:30, Claus Guttesen wrote:

&gt; Hi.
&gt; 
&gt; When saving a new record using db.update() getting the record using
&gt; curl has alot more info:
&gt; 
&gt; curl "localhost:8098/riak/users/RQC6seqRIKkBNKQt65QMko3W66"
&gt; {"props":{"w":"quorum","r":"quorum","big\\_vclock":50,"old\\_vclock":86400,"n\\_val":3,"postcommit":[],"last\\_write\\_wins":false,"small\\_vclock":10,"allow\\_mult":false,"young\\_vclock":20,"rw":"quorum","pw":0,"dw":"quorum","linkfun":{"mod":"riak\\_kv\\_wm\\_link\\_walker","fun":"mapreduce\\_linkfun"},"name":"users","chash\\_keyfun":{"mod":"riak\\_core\\_util","fun":"chash\\_std\\_keyfun"},"basic\\_quorum":true,"notfound\\_ok":false,"pr":0,"precommit":[]},"club":"BBIL","mname":"","year":"1967","gender":"male","fname":"Claus","lname":"Guttesen"}%
&gt; 
&gt; When doing a db.save() with the same data I get:
&gt; 
&gt; curl "localhost:8098/riak/users/RQC6seqRIKkBNKQt65QMko3W66"
&gt; {"fname":"Claus","mname":"","lname":"Guttesen","year":"1967","club":"BBIL","gender":"male"}
&gt; 
&gt; If I do a db.save() first and then a db.update() the information is
&gt; also terse. Why is db.update() more verbose?
&gt; 
&gt; I'm using riak-js v. 0.4.0.
&gt; 
&gt; My idea was to add more information in addtion to name, club, year
&gt; born, gender. But when I edit the user and save it the previous data
&gt; gets overwritten. So I changed db.save() to db.update(), saved a new
&gt; user and noticed alot more info.
&gt; 
&gt; -- 
&gt; regards
&gt; Claus
&gt; 
&gt; When lenity and cruelty play for a kingdom,
&gt; the gentler gamester is the soonest winner.
&gt; 
&gt; Shakespeare
&gt; 
&gt; twitter.com/kometen (http://twitter.com/kometen)
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

