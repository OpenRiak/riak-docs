---
title: "Re: pub/sub messaging e.g. worker queue on riak?"
description: ""
project: community
lastmod: 2012-11-28T20:50:46-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09406"
mailinglist_parent_id: "msg09404"
author_name: "Istvan Soos"
project_section: "mailinglistitem"
sent_date: 2012-11-28T20:50:46-08:00
---


Hi Mark,

The proposed design has only one major benefit: it reduces the number
of different technologies to work with / support. I haven't
implemented it myself (yet), but a friend of mine might do soon, I'll try
to get the results published.

Regards,
 Istvan

On Wed, Nov 28, 2012 at 12:33 PM, Mark Phillips  wrote:
&gt; Hi Istvan,
&gt;
&gt; I've not yet seen Riak hacked into a queue, and I suspect it's for
&gt; good reason. Your design sounds like a lot of work just to emulate the
&gt; functionality that something that like Kafka or RabbitMQ can do out of
&gt; the box (though I have to admit the "Riak as a Queue" headline on
&gt; HackerNews would be quite nice).
&gt;
&gt; Out of curiosity, any chance you made a pass at it over the last few weeks?
&gt;
&gt; Mark
&gt; twitter.com/pharkmillups
&gt;
&gt;
&gt; On Wed, Nov 7, 2012 at 11:58 PM, Istvan Soos  wrote:
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; I'm playing with the idea how Riak could be used to build a pub/sub
&gt;&gt; messaging on it. I know that there are specialized products for that,
&gt;&gt; I just find it an interesting problem to solve it with Riak only (+
&gt;&gt; not too much client code).
&gt;&gt;
&gt;&gt; The example scenario is the following:
&gt;&gt; - N producers create e.g. "task items", store it in Riak
&gt;&gt; - M workers/consumers try to complete them and after completion delete
&gt;&gt; the items from Riak
&gt;&gt; - workers choose from "one of the oldest" task items, e.g. there is a
&gt;&gt; close-to-fair scheduling (but no absolute ordering)
&gt;&gt; - workers try to not work on the same task
&gt;&gt;
&gt;&gt; In the first iteration, I'd use:
&gt;&gt; - secondary index with the actual timestamp to provide ordering
&gt;&gt; - the workers could use (hash modulo M) decision to work on a given task
&gt;&gt; - the workers periodically re-sync their status (e.g. number of active
&gt;&gt; workers) through a different bucket
&gt;&gt;
&gt;&gt; I'm not entirely convinced that this is a scalable design, but it
&gt;&gt; seems good on the design board. Does anyone have a working experience
&gt;&gt; with similar designs? Any hint that x/y/z could go wrong?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Istvan
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

