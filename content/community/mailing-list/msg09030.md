---
title: "Re: Riak secondary indexing 'Unknown field type for field' error"
description: ""
project: community
lastmod: 2012-10-23T15:19:26-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09030"
mailinglist_parent_id: "msg09028"
author_name: "Brian Roach"
project_section: "mailinglistitem"
sent_date: 2012-10-23T15:19:26-07:00
---


Without knowing exactly what you're doing, it's hard to tell. When
you're using an IRiakObject with StoreObject.store() without
specifying a Converter, there's not any JSON
serialization/deserialization occurring. It's simply storing whatever
you pass to withValue() in Riak.

If you can provide a short compilable example that exhibits the
behavior you're describing, I'll be happy to look into it.

Thanks!
Brian Roach

On Tue, Oct 23, 2012 at 3:08 PM, Hrishikesh More
 wrote:
&gt; Index preparation works but storing the JSON is not working. It complains
&gt; about 'sku1' (which is a 'object' type).
&gt;
&gt;
&gt; On Wed, Oct 24, 2012 at 2:33 AM, Hrishikesh More
&gt;  wrote:
&gt;&gt;
&gt;&gt; I have config with list of attributes and their types (e.g. string,
&gt;&gt; integer, boolean). Based on attribute I appropriately put it in RiakIndexes
&gt;&gt; object. It works if I do it with simple (non nested) JSON.
&gt;&gt;
&gt;&gt; e.g.
&gt;&gt; if (attrType.equals("String")) {
&gt;&gt; riakIndexes.add(fieldName, parser.getText()); ==&gt;
&gt;&gt; parser is JsonParser
&gt;&gt; }
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On Wed, Oct 24, 2012 at 2:27 AM, Brian Roach  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; How, exactly, are you creating 'indexes' ?
&gt;&gt;&gt;
&gt;&gt;&gt; A secondary index in Riak has to be an integer or a string.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Brian Roach
&gt;&gt;&gt;
&gt;&gt;&gt; On Tue, Oct 23, 2012 at 2:42 PM, Hrishikesh More
&gt;&gt;&gt;  wrote:
&gt;&gt;&gt; &gt; Hi,
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Using following JSON I am trying to create secondary indexes in
&gt;&gt;&gt; &gt; Riak.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; {
&gt;&gt;&gt; &gt; “Id” : “xxxx”,
&gt;&gt;&gt; &gt; “login” : “xxx”,
&gt;&gt;&gt; &gt; “context” : “xxx”,
&gt;&gt;&gt; &gt; “creationDate” : “xxxx”,
&gt;&gt;&gt; &gt; ...........
&gt;&gt;&gt; &gt; ...........
&gt;&gt;&gt; &gt; “sku1” : {
&gt;&gt;&gt; &gt; quantity : 1,
&gt;&gt;&gt; &gt; },
&gt;&gt;&gt; &gt; “sku2” : {
&gt;&gt;&gt; &gt; quantity : 2,
&gt;&gt;&gt; &gt; },
&gt;&gt;&gt; &gt; }
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; I prepare RiakIndexes by using above JSON and looping over it. When
&gt;&gt;&gt; &gt; I try
&gt;&gt;&gt; &gt; to store (the same json string) it in following way I get 'Unknown
&gt;&gt;&gt; &gt; field
&gt;&gt;&gt; &gt; type for field: 'sku1' error.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; IRiakObject riakObj = RiakObjectBuilder.newBuilder(bucketName, id)
&gt;&gt;&gt; &gt; .withIndexes(indexes)
&gt;&gt;&gt; &gt; .withValue(json)
&gt;&gt;&gt; &gt; .withContentType('application/json')
&gt;&gt;&gt; &gt; .build();
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; IRiakObject returnObject = bucket.store(riakObj);
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; Error:
&gt;&gt;&gt; &gt; com.basho.riak.client.http.response.RiakResponseRuntimeException:
&gt;&gt;&gt; &gt; Unknown field type for field: 'sku1'.
&gt;&gt;&gt; &gt; Unknown field type for field: 'sku2'.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; 1. If I don't define nested JSON it works, however it I put 'skuid'
&gt;&gt;&gt; &gt; using
&gt;&gt;&gt; &gt; objectMapper.createObjectNode() and add to parent object node (while
&gt;&gt;&gt; &gt; preparing JSON for testing), it gives above error.
&gt;&gt;&gt; &gt; Do I have to write custom serializer here?
&gt;&gt;&gt; &gt; 2. Is there a way to ignore this error through config in Riak?
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; thanx.
&gt;&gt;&gt; &gt;
&gt;&gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; &gt; riak-users mailing list
&gt;&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt; &gt;
&gt;&gt;
&gt;&gt;
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

