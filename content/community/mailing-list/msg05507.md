---
title: "Re: Nodes neither leaving nor joining the cluster"
description: ""
project: community
lastmod: 2011-11-09T09:31:24-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05507"
mailinglist_parent_id: "msg05506"
author_name: "Nitish Sharma"
project_section: "mailinglistitem"
sent_date: 2011-11-09T09:31:24-08:00
---


Hi Alexandre,
Fortunately its a test cluster. Removing the ring files, stopping and
starting the nodes, and then again running \\*join \\*brought the cluster in
desirable state.
Name and IP of all the nodes was same all the time, still restarting a
single node brought the whole cluster in inconsistent state. Weird!

Thanks for the tip, though.

Regards
Nitish
On Wed, Nov 9, 2011 at 5:54 PM, Alexandre Ravey
wrote:

&gt; Hi Nitish,
&gt;
&gt; Did you change the node name or IP at any point?
&gt; If so, you need to reip your node(s).
&gt;
&gt; Run riak-admin status and check the node name in ring\\_members, must be
&gt; the same as your actual node. (ie, same ip and node name).
&gt; Check also that you are not using xxx@127.0.0.1 if your nodes aren't
&gt; on the same physical box.
&gt;
&gt; If it's a test cluster you may just rm /var/lib/riak/ring/\\* (node
&gt; down) and join again.
&gt;
&gt; Regards
&gt;
&gt; Alexandre
&gt;
&gt; On Wed, Nov 9, 2011 at 5:38 PM, Nitish Sharma
&gt;  wrote:
&gt; &gt; Hi,
&gt; &gt; I've installed riak using pre-compiled Debian binary. I setup a Riak
&gt; cluster
&gt; &gt; consisting of 3 nodes (name of each node in format: riak@). The
&gt; &gt; configuration file for all the nodes is same.
&gt; &gt; Just to clarify my problem, I'll be using node names as A, B, and C.
&gt; &gt; Initially, all three nodes were successfully able to form a cluster ( B
&gt; and
&gt; &gt; C joined node A). To perform some tests, node A rebooted and after that
&gt; its
&gt; &gt; ``status" is not showing all three nodes as ring\\_members. While, running
&gt; &gt; ``riak-admin status" on nodes B and C was still stating ring\\_members as
&gt; A,
&gt; &gt; B, C.
&gt; &gt; Running ``riak-admin leave" on nodes B and C didnt help, since
&gt; &gt; running join command again was throwing "Failed: This node is already a
&gt; &gt; member of a cluster". Force removal of nodes also didnt do any good;
&gt; still
&gt; &gt; the same inconsistent ring members status.
&gt; &gt; Any suggestions ?
&gt; &gt; Regards
&gt; &gt; Nitish
&gt; &gt;
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;
&gt; &gt;
&gt;
t
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

