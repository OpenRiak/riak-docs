---
title: "Re: \"Failed to compact\" in RiakSearch"
description: ""
project: community
lastmod: 2011-04-18T04:01:49-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03069"
mailinglist_parent_id: "msg03057"
author_name: "Morten Siebuhr"
project_section: "mailinglistitem"
sent_date: 2011-04-18T04:01:49-07:00
---


On Fri, Apr 15, 2011 at 4:40 PM, Rusty Klophaus  wrote:
&gt; Hi Morten,
&gt; It looks like at least one of the offending fields is "photos\\_value", which,
&gt; as you said, should be skipped according to your schema. This makes me think
&gt; that either the schema isn't set correctly, or that one or more nodes is
&gt; caching an old value of the schema.
&gt; Can you try running "search-cmd show-schema INDEXNAME" on each node to
&gt; verify that the schema is set correctly? Also, you can run "search-cmd
&gt; clear-schema-cache" to clear the schema cache across all nodes.

Bingo!

It turned out \\*all\\* of the nodes were using the default schema...

(I the schema on the "nosql1" in the beginning, believing it would be
replicated to the other nodes.)

&gt; Also, the number of segments is \\*way\\* higher than it should be, and this is
&gt; the reason for the "too many DB tables" error. It appears that these
&gt; problems are linked, the compaction errors are preventing the system from
&gt; combining segments, leading to a large number of segments, so solving one
&gt; problem should solve the other.

We'll try to re-add our data and see what happens...

/Siebuhr

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

