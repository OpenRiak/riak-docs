---
title: "Re: Does Java client support querying large amounts of data from	Riak? What is the JSON parse/serialize overhead for such Queries?"
description: ""
project: community
lastmod: 2011-09-28T11:45:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04912"
mailinglist_parent_id: "msg04910"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-09-28T11:45:55-07:00
---


You can MapReduce search using the Module, Function, Args input mechanism. The 
Module is riak\\_search, the Function is mapred\\_search, and the args are your 
search query.

I have no idea what it looks like in the Java client, but in the C# client, it 
looks like this:

 var modFunArg = new RiakModuleFunctionArgInput
 {
 Module = "riak\\_search",
 Function = "mapred\\_search",
 Arg = new[] {"bucket\\_name", "name:Al\\*"}
 };
---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Sep 28, 2011, at 2:44 PM, Harshal Dhir wrote:

&gt; Hi Ryan,
&gt; 
&gt; Thanks for your response.
&gt; 
&gt; To answer your question. 
&gt; 
&gt; #1: mapreduce will not go thru the entire key list if you feed it a search 
&gt; query on input, only the matched objects [Understood, but the java client 
&gt; doesn’t have a mapreduce search function. We did a custom implementation of 
&gt; this but the response time was still "very" slow.]
&gt; #2: to rule out any funkiness in the java client have you tried the queries 
&gt; via curl as well? Have tried this as well, the response is significantly 
&gt; quicker than the above mapreduce but still not fast enough.
&gt; 
&gt; # of Objects: 10,000+ 
&gt; Backend Used: bitcask
&gt; # of nodes: 5
&gt; Machine Specs: Amazon EC2 (Large Instance)
&gt; 
&gt; 
&gt; Thanks
&gt; 
&gt; Harshal Dhir | Technical Architect
&gt; 
&gt; solutionset
&gt; P: 510-214-3519 Twitter: @harshaldhir 
&gt; 85 Second Street, San Francisco, CA 94105
&gt; Twitter: @harshaldhir MSN: hars...@solutionset.com Jabber: 
&gt; harshal.d...@gmail.com
&gt; www.solutionset.com
&gt; 
&gt; This message is intended for the addressee(s) only and may contain 
&gt; confidential or privileged 
&gt; information. Any use of this information by persons other than addressee(s) 
&gt; is prohibited. If you 
&gt; have received this message in error, please reply to the sender and delete or 
&gt; destroy all copies.
&gt; 
&gt; 
&gt; 
&gt; From: Ryan Zezeski 
&gt; Date: Wed, 28 Sep 2011 11:33:56 -0700
&gt; To: Harshal Dhir 
&gt; Cc: "riak-users@lists.basho.com" 
&gt; Subject: Re: Does Java client support querying large amounts of data from 
&gt; Riak? What is the JSON parse/serialize overhead for such Queries?
&gt; 
&gt; Harshal,
&gt; 
&gt; Harshal,
&gt; 
&gt; If I understand correctly you are trying to retrieve a set of objects that 
&gt; match a given search query?
&gt; 
&gt; 1: mapreduce will not go thru the entire key list if you feed it a search 
&gt; query on input, only the matched objects
&gt; 
&gt; 2: to rule out any funkiness in the java client have you tried the queries 
&gt; via curl as well?
&gt; 
&gt; The nominal latency is going to highly depend on many factors including 
&gt; network, # of objects matched, backend used, machine specs, # of nodes, # of 
&gt; concurrent queries, etc. My first question would be what is the average 
&gt; result set size coming back for these 4 second latencies (i.e. how many 
&gt; objects are matched by the query)?
&gt; 
&gt; 
&gt; -Ryan
&gt; 
&gt; On Wed, Sep 28, 2011 at 2:15 PM, Harshal Dhir  
&gt; wrote:
&gt;&gt; Hi,
&gt;&gt; 
&gt;&gt; We currently using riak java client 0.15.0-SNAPSHOT, but there is no better 
&gt;&gt; interface for RiakSearch at the moment. We are trying to fetch data from a 
&gt;&gt; bucket with million rows, here is a gist of issues we are facing with 
&gt;&gt; different approaches:
&gt;&gt; • MapReduce:
&gt;&gt; • Using mapreduce, the data response is just too slow due to 
&gt;&gt; the fact that this is a O(N) operation of going through the keys list.
&gt;&gt; • Solr Client:
&gt;&gt; • Using Solr Client, we are able to query but the response 
&gt;&gt; takes a long time about 4seconds to return a nominal result is still slow. 
&gt;&gt; [I heard the normal response time is approx 200ms]
&gt;&gt; Is there a way in the current java client to fetch large amount of data in 
&gt;&gt; nominal time. 
&gt;&gt; 
&gt;&gt; What is the recommended approach of saving / retrieving / querying this data 
&gt;&gt; in the fastest possible way?
&gt;&gt; 
&gt;&gt; Thanks
&gt;&gt; Harshal 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt; 
