---
title: "Re: batch adding of keys to LevelDB backend"
description: ""
project: community
lastmod: 2011-10-11T10:57:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05125"
mailinglist_parent_id: "msg05124"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-10-11T10:57:16-07:00
---


Have you done any tuning of your put options? I've seen significant
improvement by turning off ReturnBody and setting w to a low value.

Jeremiah Peschka
Founder, Brent Ozar PLF
On Oct 11, 2011 8:50 AM, "Nate Lawson"  wrote:

&gt; It's not just for testing. We found that loading/updating keys was somewhat
&gt; slow, even with a low replication count. So we're exploring routes of taking
&gt; a node down in an existing cluster, loading a large batch of keys, and then
&gt; bringing it up. It's ok if it takes the data a while to rebalance after we
&gt; rejoin the node.
&gt;
&gt; It sounds like this isn't as explored as I first thought, so we'll do our
&gt; own analysis.
&gt;
&gt; -Nate
&gt;
&gt; On Oct 10, 2011, at 9:18 AM, Ryan Zezeski wrote:
&gt;
&gt; &gt; Nate,
&gt; &gt;
&gt; &gt; You could do this but if you're just doing it for testing then it seems
&gt; like more work than necessary. If you insist on doing it this way you'll
&gt; want to write it in Erlang so you can make use of the preflist calculation,
&gt; riak\\_object, and eleveldb driver.
&gt; &gt;
&gt; &gt; You could do the following:
&gt; &gt;
&gt; &gt; 1. stand up a fresh cluster
&gt; &gt;
&gt; &gt; 2. use one of the clients to load the data
&gt; &gt;
&gt; &gt; 3. archive the data dir on all nodes
&gt; &gt;
&gt; &gt; Next time you want to stand up a cluster with the same data simply
&gt; unarchive the data dirs before starting the cluster.
&gt; &gt;
&gt; &gt; -Ryan
&gt; &gt;
&gt; &gt;
&gt; &gt; On Fri, Oct 7, 2011 at 9:29 PM, Nate Lawson  wrote:
&gt; &gt; We're working on a test where we want to add batches of keys to Riak.
&gt; We're using the LevelDB backend with 1.0. One suggestion we heard was to
&gt; take down a node, batch insert directly into the backing store, and then
&gt; bring the node up again.
&gt; &gt;
&gt; &gt; Could someone give us some more details on this? How would Riak know
&gt; which keys in LevelDB had not yet been redistributed to the rest of the
&gt; cluster?
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Nate
&gt; &gt;
&gt;
&gt;

