---
title: "Re: Specified w/dw/pw values invalid for bucket n value of 1"
description: ""
project: community
lastmod: 2012-09-24T05:38:11-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08665"
mailinglist_parent_id: "msg08592"
author_name: "Ingo Rockel"
project_section: "mailinglistitem"
sent_date: 2012-09-24T05:38:11-07:00
---



Hi,

I finally found the reason for this message: Although the bucket was 
initialized with r=1, the java client silently appended a "r=2" to all 
fetches which caused this message.


The combination of two things really cost me a lot of time to find the 
reason for this:
\\* the error message from riak complains about wrong write parameters but 
in fact the read parameter was wrong.
\\* the java client library silently attaches a "r=2" to all read queries 
and I didn't find anything in the documentation about this. Is this 
intended or a bug?


Setting the used apache http client into trace really helped a lot, 
maybe you should add something about this into the java client 
documentation.


Ingo

Am 19.09.2012 16:10, schrieb Ingo Rockel:

Hi Russell,

I'm using riak 1.2 and the client version is version 1.0.5 and
concerning HTTP and PB, I tried both.

Ingo

Am 19.09.2012 16:04, schrieb Russell Brown:


On 19 Sep 2012, at 14:54, Ingo Rockel wrote:


Hi Mark,

thanks for looking into this.

I'm using the riak-java-client for accessing riak,


Are you using HTTP or PB, please? And can you let me know the version,
too?

Thanks

Russell


the bucket is created with the following code:

msgBucket = riakClient.createBucket(MSG\\_BUCKET\\_ID).
 nVal(1).w(1).dw(1).pw(1).
 execute();

and the write operation is:

 msgBucket.store("Mailbox|" + messageDto.getReceptor(),
createMailbox(messageDto)).execute();

without doing any modification of w/dw/pw for the single write.

Ingo

Am 19.09.2012 07:56, schrieb Mark Phillips:

Hi Ingo

I just built a single node Riak 1.2 from source on my laptop, cranked
the n, w, dw, and pw values down to "1", and was able to write
successfully via curl. For the sake of completeness, I attempted to
write with "w=2" and was able to throw the "Specified w/dw/pw values
invalid for bucket n value of 1" error that you reported.

Any chance you have some app code that's changing the W value? Can you
share the specifics of the request that's failing?

Mark


On Tue, Sep 18, 2012 at 9:33 AM, Ingo Rockel
 wrote:

Hi Mark,

yes, I'm running 1.2.

Ingo

Am 18.09.2012 02:11, schrieb Mark Phillips:


Hi Ingo,

Sorry for the holdup here.

Riak shouldn't be throwing this error if all your R and W values are
set to "1". Are you running Riak 1.2?

Mark

On Mon, Sep 17, 2012 at 3:10 AM, Ingo Rockel
 wrote:


Anyone?

Am 30.08.2012 18:34, schrieb Ingo Rockel:


Hi List,

I'm trying to set the n-val to 1 for my single-node test server
but do
always fail with the following error:

Specified w/dw/pw values invalid for bucket n value of 1

This is my bucket configuration:



{"props":{"allow\\_mult":false,"basic\\_quorum":false,"big\\_vclock":50,"chash\\_keyfun":{"mod":"riak\\_core\\_util","fun":"chash\\_std\\_keyfun"},"dw":1,"last\\_write\\_wins":false,"linkfun":{"mod":"riak\\_kv\\_wm\\_link\\_walker","fun":"mapreduce\\_linkfun"},"n\\_val":1,"name":"messages","notfound\\_ok":true,"old\\_vclock":86400,"postcommit":[],"pr":1,"precommit":[],"pw":1,"r":1,"rw":1,"small\\_vclock":50,"w":1,"young\\_vclock":20}}



I can't see what's wrong with it, maybe someone can shed a light.

Regards,

 Ingo

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com






\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com




--
Software Architect

Blue Lion mobile GmbH
Tel. +49 (0) 221 788 797 14
Fax. +49 (0) 221 788 797 19
Mob. +49 (0) 176 24 87 30 89

ingo.roc...@bluelionmobile.com

qeep: Hefferwolf


www.bluelionmobile.com
www.qeep.net



--
Software Architect

Blue Lion mobile GmbH
Tel. +49 (0) 221 788 797 14
Fax. +49 (0) 221 788 797 19
Mob. +49 (0) 176 24 87 30 89

ingo.roc...@bluelionmobile.com

qeep: Hefferwolf


www.bluelionmobile.com
www.qeep.net

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com








--
Software Architect

Blue Lion mobile GmbH
Tel. +49 (0) 221 788 797 14
Fax. +49 (0) 221 788 797 19
Mob. +49 (0) 176 24 87 30 89

ingo.roc...@bluelionmobile.com
&gt;&gt;&gt; qeep: Hefferwolf

www.bluelionmobile.com
www.qeep.net

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

