---
title: "Re: Link or Secondary Indexes?"
description: ""
project: community
lastmod: 2012-03-29T09:22:47-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07080"
mailinglist_parent_id: "msg07079"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2012-03-29T09:22:47-07:00
---


Cache everything you can, even if you're persisting that cache in the database. 
Data duplication is important when you want to make queries faster. Doing a 
simple GET is going to be much faster than a MapReduce.

---
Jeremiah Peschka, Managing Director, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Mar 29, 2012, at 8:51 AM, Buri Arslon  wrote:

&gt; Kresten, Jeffrey: Thanks a lot for enlightenment!
&gt; 
&gt; This link was very helpful to understand what to use when.
&gt; http://wiki.basho.com/MapReduce-Search-2i-Comparison.html 
&gt; 
&gt; The information I obtained pushed me to another question :) . 
&gt; 
&gt; Q: Is it a good (or at least 'ok') practice to duplicate information in order 
&gt; to get cheaper/faster queries? 
&gt; 
&gt; i.e. If a user becomes a member of a group/fanpage I could store that 
&gt; information both in 'users' and 'groups' bucket. If I want to get the members 
&gt; of a particular group I query just one value/record in 'groups' bucket. The 
&gt; only drawback that came to my mind is when you delete that relationship you 
&gt; have to delete it from two buckets.
&gt; 
&gt; Another scenario might be to get last 20 comments by a user. Instead of 
&gt; searching all posts/comments by author\\_name, I could just store the post or 
&gt; comment key in the user object as a secondary index and set some limit, say, 
&gt; 20 for &lt;&lt;"index"&gt;&gt;, &lt;&lt;"last\\_posts\\_bin"&gt;&gt;.
&gt; 
&gt; What do you think?
&gt; 
&gt; Thanks again,
&gt; -- buriwoy
&gt; 
&gt; 
&gt; 
&gt; On Thu, Mar 29, 2012 at 8:52 AM, Jeffrey Massung  wrote:
&gt; Buriwoy,
&gt; 
&gt; Neither is better (or worse) for "storing" those bits of information. The 
&gt; question is how you expect to use that data once it is stored. Let's take a 
&gt; look at friend relationships (note: I don't use Facebook, so I might be 
&gt; missing a subtle feature with this example)...
&gt; 
&gt; Do you merely plan on following a list of friends to other pages quickly? For 
&gt; example, on your page, you see a list of your friends quickly, be able to 
&gt; click them, and go to their page? If so, the links are quite nice. Links are 
&gt; nice for being able to follow in a query as well. This is a good example of 
&gt; using links to perform link walking:
&gt; 
&gt; http://basho.com/blog/technical/2010/02/24/link-walking-by-example/
&gt; 
&gt; Or, do you plan on doing reverse lookups by friends? For example, do you want 
&gt; to say "find every who has Tony as a friend" and get a list of users? Note: 
&gt; this is not asking who is a friend of Tony (you'd just lookup Tony and get 
&gt; his list of friends). In this case 2i works nicely, as do other query 
&gt; methods: search, a general MapReduce, etc. But links would be an extremely 
&gt; poor choice.
&gt; 
&gt; Does this help? This page might also be applicable to your question:
&gt; 
&gt; http://wiki.basho.com/MapReduce-Search-2i-Comparison.html
&gt; 
&gt; If you plan on just doing MapReduce queries without 2i, and don't care about 
&gt; link walking, then just storing a typical JSON object and not using either is 
&gt; perfectly fine as well.
&gt; 
&gt; --
&gt; Jeffrey Massung
&gt; Software Engineer
&gt; j...@basho.com
&gt; 
&gt; On Mar 29, 2012, at 8:29 AM, Buri Arslon wrote:
&gt; 
&gt;&gt; Hi,
&gt;&gt; 
&gt;&gt; While developing my pet project few questions came to my mind and I decided 
&gt;&gt; to consult with you.
&gt;&gt; 
&gt;&gt; Which of them are more effective for recording relationships: Link or 
&gt;&gt; Secondary Indexes?
&gt;&gt; 
&gt;&gt; 1. Friend relationships: like Facebook friends?
&gt;&gt; 2. Followed/follower relationships like in Twitter?
&gt;&gt; 3. Member/Club relationship like fanpage in Facebook?
&gt;&gt; 4. Like in Facebook?
&gt;&gt; 
&gt;&gt; Thanks,
&gt;&gt; -- buriwoy
&gt; 
&gt; 
