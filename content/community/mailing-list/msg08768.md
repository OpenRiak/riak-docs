---
title: "Re: Using Riak as cache layer"
description: ""
project: community
lastmod: 2012-10-01T08:35:47-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08768"
mailinglist_parent_id: "msg08767"
author_name: "Pavel Kogan"
project_section: "mailinglistitem"
sent_date: 2012-10-01T08:35:47-07:00
---


Thanks Sean.

On Mon, Oct 1, 2012 at 4:48 PM, Sean Cribbs  wrote:

&gt; Yes, it will drop the oldest item until the size is less than max\\_memory.
&gt;
&gt; On Mon, Oct 1, 2012 at 9:38 AM, Pavel Kogan 
&gt; wrote:
&gt; &gt; Hi Sean,
&gt; &gt;
&gt; &gt; Thanks for quick reply. Your answers helped me a lot.
&gt; &gt; I just need small clarification.
&gt; &gt;
&gt; &gt; Memory backend has two parameters: (a) max\\_memory (b) ttl.
&gt; &gt; If I use only max\\_memory (without using ttl) and node reaches its
&gt; &gt; RAM limit would it drop oldest records upon new request as you said (or I
&gt; &gt; must set also ttl for that)?
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Pavel
&gt; &gt;
&gt; &gt; On Mon, Oct 1, 2012 at 3:14 PM, Sean Cribbs  wrote:
&gt; &gt;&gt;
&gt; &gt;&gt; In contrast to Yuri's claim, a number of groups have used Riak
&gt; &gt;&gt; successfully as a cache. Yes, it won't be as fast as Membase, but it
&gt; &gt;&gt; might be fast enough for your purposes. (This presentation by
&gt; &gt;&gt; Posterous might interest you:
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; http://basho.com/blog/technical/2012/01/30/Riak-in-Production-at-Posterous-Riak-Control-Preview/
&gt; )
&gt; &gt;&gt;
&gt; &gt;&gt; 1) Bitcask is going to be very fast. If your data never really exceeds
&gt; &gt;&gt; RAM, Bitcask will give you near-RAM speeds with the assurance that
&gt; &gt;&gt; your cache will also persist to disk. Normal Bitcask caveats apply
&gt; &gt;&gt; here, including the "keys-must-fit-in-RAM" one.
&gt; &gt;&gt; 2) For most persistent use-cases it is recommended to have &gt; 3 nodes,
&gt; &gt;&gt; preferably 5 or more. For a cache, the guarantees of per-key
&gt; &gt;&gt; availability are usually more lax, so perhaps &lt; 3 nodes is ok. It's
&gt; &gt;&gt; better to set up your desired configuration, run some benchmarks and
&gt; &gt;&gt; smoke-tests while stopping or killing nodes.
&gt; &gt;&gt; 3) If you are using the "memory" backend, you can configure this
&gt; &gt;&gt; behavior. If you do not configure it, the default is to use up to as
&gt; &gt;&gt; much memory as the operating system will allow it -- beyond that
&gt; &gt;&gt; limit, the Riak node will exit and leave a crash dump. If you
&gt; &gt;&gt; configure a size or TTL limit, then the memory backend will drop the
&gt; &gt;&gt; oldest item from its storage. More information on how to configure it
&gt; &gt;&gt; is here: http://wiki.basho.com/Memory.html
&gt; &gt;&gt;
&gt; &gt;&gt; I hope that helps!
&gt; &gt;&gt;
&gt; &gt;&gt; On Mon, Oct 1, 2012 at 8:57 AM, Yuri Lukyanov 
&gt; wrote:
&gt; &gt;&gt; &gt; I suggest that you use http://www.couchbase.com/ (ex-membase)
&gt; instead
&gt; &gt;&gt; &gt; as a cache layer. It's faster but less reliable than riak, which is ok
&gt; &gt;&gt; &gt; for cache layer.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; On Mon, Oct 1, 2012 at 12:47 AM, Pavel Kogan  &gt;
&gt; &gt;&gt; &gt; wrote:
&gt; &gt;&gt; &gt;&gt; Hi all experts,
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; I want to use Riak for caching and have few questions:
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; 1) How faster is using memory back-end over bitcask back-end (on
&gt; SSD)?
&gt; &gt;&gt; &gt;&gt; 2) If throughput satisfying, is there any reason to use more than two
&gt; &gt;&gt; &gt;&gt; nodes?
&gt; &gt;&gt; &gt;&gt; 3) When my memory reaches preset limit (lets say 4Gb) what is going
&gt; to
&gt; &gt;&gt; &gt;&gt; happen
&gt; &gt;&gt; &gt;&gt; on inserting the next element?
&gt; &gt;&gt; &gt;&gt; a) Random element will be dropped.
&gt; &gt;&gt; &gt;&gt; b) Oldest element will be dropped.
&gt; &gt;&gt; &gt;&gt; c) Next element insert will fail.
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; Thanks,
&gt; &gt;&gt; &gt;&gt; Pavel
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt;&gt; &gt;&gt; riak-users mailing list
&gt; &gt;&gt; &gt;&gt; riak-users@lists.basho.com
&gt; &gt;&gt; &gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;&gt; &gt;&gt;
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt;&gt; &gt; riak-users mailing list
&gt; &gt;&gt; &gt; riak-users@lists.basho.com
&gt; &gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; --
&gt; &gt;&gt; Sean Cribbs 
&gt; &gt;&gt; Software Engineer
&gt; &gt;&gt; Basho Technologies, Inc.
&gt; &gt;&gt; http://basho.com/
&gt; &gt;
&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Sean Cribbs 
&gt; Software Engineer
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

