---
title: "Riak Search 1.0 Bug - Inline Fields"
description: ""
project: community
lastmod: 2011-10-05T11:31:27-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05055"
author_name: "Greg Pascale"
project_section: "mailinglistitem"
sent_date: 2011-10-05T11:31:27-07:00
---


 Hi, 

I have uncovered what I think has to be a bug with inline field searches in 
Riak 1.0. In short, it seems that there are issues when including a field in 
both the query and filter query. I have a query in production that used to work 
with 14.2 but no longer does with 1.0.

I dove into the issue a bit and was able to come up with some simpler examples 
that illustrate what I'm seeing. I ran these on my dev box which only has about 
15 items in the clips bucket, so I'm nowhere close to the results limit. ctime 
is a field with inline set to true.

Example 1: Works

search-cmd search clips 'ctime:([98682333448080 TO 98682333448089])'

:: Searching for 'ctime:([98682333448080 TO 98682333448089])' / '' in clips...

------------------------------

index/id: clips/LR04QZTJS\\_wVDcb6
&lt;&lt;"ctime"&gt;&gt; -&gt; &lt;&lt;"98682333448084"&gt;&gt;
p -&gt; [0]
&lt;&lt;"ctime"&gt;&gt; -&gt; [&lt;&lt;"98682333448084"&gt;&gt;]
&lt;&lt;"private"&gt;&gt; -&gt; [&lt;&lt;"0"&gt;&gt;]
score -&gt; 0.0

------------------------------

Example 2: Times out (should return 0 results)

search-cmd search clips 'ctime:([98682333448080 TO 98682333448089])' 
'ctime:(99999999999999)' :: Searching for 'ctime:([98682333448080 TO 
98682333448089])' / 'ctime:(99999999999999)' in clips... 
------------------------------ :: ERROR: timeout 

Example 3: Times out (should return 1 result)

search-cmd search clips 'ctime:(98682333448084)' 'ctime:(98682333448084)'

:: Searching for 'ctime:(98682333448084)' / 'ctime:(98682333448084)' in clips...

------------------------------

:: ERROR: {badarg,[{lists,member,[&lt;&lt;"98682333448084"&gt;&gt;,&lt;&lt;"98682333448084"&gt;&gt;]},
 {riak\\_search\\_inlines,passes\\_inlines\\_1,3},
 {lists,all,2},
{mi\\_server,iterate,6},
 {mi\\_server,lookup,8}]}


Thanks

-- 
Greg
Clipboard
