---
title: "Re: Upgrading from 1.1.2 to 1.2.0"
description: ""
project: community
lastmod: 2012-09-17T10:00:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08575"
mailinglist_parent_id: "msg08572"
author_name: "Kresten Krab Thorup"
project_section: "mailinglistitem"
sent_date: 2012-09-17T10:00:31-07:00
---


It looks like your m/r request is missing a Content-Type header (probably 
should be application/json). Perhaps it is a new requirement/validator in 1.2, 
perhaps the old client library is not passing it along. 

Kresten
Trifork

On 17/09/2012, at 18.25, "Colin Alston"  
wrote:

&gt; Hi
&gt; 
&gt; I'm having serious issues trying to upgrade Riak from 1.1.2 to 1.2.0\\_1
&gt; on Ubuntu.
&gt; 
&gt; To upgrade I stop a cluster node, purge the old package and install
&gt; 1.2.0\\_1 but MapReduce fails on 1.2.
&gt; 
&gt; Exception: Error running MapReduce operation. Status: 500 :
&gt; 500 Internal Server
&gt; ErrorInternal Server Error
=====================

The server
&gt; encountered an error while processing this
&gt; request:  

```
{error,function_clause,
&gt;       [{string,tokens1,[undefined,";",[]],[{file,"string.erl"},{line,202}]},
&gt;        {mochiweb_util,parse_header,1,
&gt;                       [{file,"src/mochiweb_util.erl"},{line,367}]},
&gt;        {riak_kv_wm_mapred,base_type,1,
&gt;                           [{file,"src/riak_kv_wm_mapred.erl"},{line,110}]},
&gt;        {riak_kv_wm_mapred,ctype_ok,1,
&gt;                           [{file,"src/riak_kv_wm_mapred.erl"},{line,99}]},
&gt;        {riak_kv_wm_mapred,known_content_type,2,
&gt;                           [{file,"src/riak_kv_wm_mapred.erl"},{line,62}]},
&gt;        {webmachine_resource,resource_call,3,
&gt;                             [{file,"src/webmachine_resource.erl"},
&gt;                              {line,169}]},
&gt;        {webmachine_resource,do,3,
&gt;                             [{file,"src/webmachine_resource.erl"},
&gt;                              {line,128}]},
&gt;        {webmachine_decision_core,resource_call,1,
&gt;                                  [{file,"src/webmachine_decision_core.erl"},
&gt; 
&gt; {line,48}]}]}
```


---

mochiweb+webmachine web
&gt; server


&gt; 
&gt; What is the real upgrade procedure supposed to be? Do I need to kill
&gt; the Riak store directories as well (/var/lib/riak) and let them
&gt; re-replicate one at a time? A fresh install of 1.2 elsewhere does
&gt; work, with a totally new store, but spouts failures with a 1.1.2
&gt; store.
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

