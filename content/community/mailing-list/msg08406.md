---
title: "Re: How to search objects using riak_search method"
description: ""
project: community
lastmod: 2012-08-30T07:43:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08406"
author_name: "郎咸武"
project_section: "mailinglistitem"
sent_date: 2012-08-30T07:43:29-07:00
---


who can give me some idea

在 2012年8月30日星期四，郎咸武 写道：

&gt; Hi guys,
&gt; I need your help.
&gt;
&gt; Version:
&gt; 1)riak-erlang-client-1.3
&gt; 2)riak-1.2
&gt; 3)Erlang R14B04 (erts-5.8.5) [source] [64-bit]
&gt;
&gt; This is my bucket attributs in the following
&gt;
&gt; (riak@127.0.0.1 )52&gt; {ok,C}
&gt; = riak:local\\_client().
&gt;
&gt; {ok,{riak\\_client,'riak@127.0.0.1  'riak@127.0.0.1');&gt;',undefined}}
&gt; (riak@127.0.0.1 )53&gt;
&gt; C:set\\_bucket(&lt;&lt;"user"&gt;&gt;,[{precommit,
&gt; [{struct,[{&lt;&lt;"mod"&gt;&gt;,&lt;&lt;"riak\\_search\\_kv\\_hook"&gt;&gt;},{&lt;&lt;"fun"&gt;&gt;,&lt;&lt;"precommit"&gt;&gt;}]}]}]).
&gt; ok
&gt; (riak@127.0.0.1 )54&gt;
&gt; C:get\\_bucket(&lt;&lt;"user"&gt;&gt;).
&gt;
&gt; [{search,true},
&gt; {allow\\_mult,false},
&gt; {basic\\_quorum,false},
&gt; {big\\_vclock,50},
&gt; {chash\\_keyfun,{riak\\_core\\_util,chash\\_std\\_keyfun}},
&gt; {dw,quorum},
&gt; {last\\_write\\_wins,false},
&gt; {linkfun,{modfun,riak\\_kv\\_wm\\_link\\_walker,mapreduce\\_linkfun}},
&gt; {n\\_val,3},
&gt; {name,&lt;&lt;"user"&gt;&gt;},
&gt; {notfound\\_ok,true},
&gt; {old\\_vclock,86400},
&gt; {postcommit,[]},
&gt; {pr,0},
&gt; \\* {precommit,[{struct,[{&lt;&lt;"mod"&gt;&gt;,&lt;&lt;"riak\\_search\\_kv\\_hook"&gt;&gt;},\\*
&gt; \\* {&lt;&lt;"fun"&gt;&gt;,&lt;&lt;"precommit"&gt;&gt;}]}]},\\*
&gt; {pw,0},
&gt; {r,quorum},
&gt; {rw,quorum},
&gt; {small\\_vclock,50},
&gt; {w,quorum},
&gt; {young\\_vclock,20}]
&gt;
&gt; \\*------------------\\*
&gt; \\*In the client\\*
&gt; \\*To new a object and search it\\*
&gt; 147&gt; f(O),O=riakc\\_obj:new(&lt;&lt;"user"&gt;&gt;, &lt;&lt;"jason"&gt;&gt;, &lt;&lt;"jasonlang"&gt;&gt;)
&gt; 147&gt; .
&gt; {riakc\\_obj,&lt;&lt;"user"&gt;&gt;,&lt;&lt;"jason"&gt;&gt;,undefined,[],undefined,
&gt; &lt;&lt;"jasonlang"&gt;&gt;}
&gt;
&gt; 150&gt; riakc\\_pb\\_socket:put(Pid,O).
&gt; ok
&gt; 151&gt; riakc\\_pb\\_socket:search(Pid, &lt;&lt;"user"&gt;&gt;, "jason\\*")
&gt; 151&gt; .
&gt; {ok,{search\\_results,[{&lt;&lt;"user"&gt;&gt;,
&gt;
&gt; [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"jason"&gt;&gt;},{&lt;&lt;"value"&gt;&gt;,&lt;&lt;"jasonlang"&gt;&gt;}]}],
&gt; 0.0,1}}
&gt; 152&gt;
&gt;
&gt; \\*This search operator is ok\\*
&gt;
&gt; \\*TO new another object and search it\\*
&gt;
&gt; 152&gt; f(O),O=riakc\\_obj:new(&lt;&lt;"user"&gt;&gt;, &lt;&lt;"lang"&gt;&gt;, &lt;&lt;"langzhe"&gt;&gt;)
&gt; 152&gt; .
&gt; {riakc\\_obj,&lt;&lt;"user"&gt;&gt;,&lt;&lt;"lang"&gt;&gt;,undefined,[],undefined,
&gt; &lt;&lt;"langzhe"&gt;&gt;}
&gt; 153&gt; riakc\\_pb\\_socket:put(Pid,O).
&gt; ok
&gt; 154&gt; riakc\\_pb\\_socket:search(Pid, &lt;&lt;"user"&gt;&gt;, "langzh\\*")
&gt; 154&gt; .
&gt; {ok,{search\\_results,[{&lt;&lt;"user"&gt;&gt;,
&gt;
&gt; [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"lang"&gt;&gt;},{&lt;&lt;"value"&gt;&gt;,&lt;&lt;"langzhe"&gt;&gt;}]}],
&gt; 0.0,1}}
&gt; \\*This is ok too\\*
&gt; \\*
&gt; \\*
&gt; \\*Search the objects:\\*
&gt; 157&gt; riakc\\_pb\\_socket:search(Pid, &lt;&lt;"user"&gt;&gt;, "langzh\\*\\"\\"jason\\*")
&gt; 157&gt; .
&gt; {ok,{search\\_results,[{&lt;&lt;"user"&gt;&gt;,
&gt;
&gt; [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"jason"&gt;&gt;},{&lt;&lt;"value"&gt;&gt;,&lt;&lt;"jasonlang"&gt;&gt;}]},
&gt; {&lt;&lt;"user"&gt;&gt;,
&gt;
&gt; [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"lang"&gt;&gt;},{&lt;&lt;"value"&gt;&gt;,&lt;&lt;"langzhe"&gt;&gt;}]}],
&gt; 0.0,2}}
&gt; 158&gt;
&gt; This is ok too.
&gt; -------------------------------------------------------------------
&gt; \\*In the above is ok.\\*
&gt; \\*
&gt; \\*
&gt; \\*I am sorry ,\\*\\*the question in the following\\*
&gt; \\*
&gt; \\*
&gt; 159&gt; f(O),O=riakc\\_obj:new(&lt;&lt;"user"&gt;&gt;, &lt;&lt;"mine"&gt;&gt;,
&gt; term\\_to\\_binary([{"name\\_","jason"},{"sex\\_", "male"}])).
&gt; {riakc\\_obj,&lt;&lt;"user"&gt;&gt;,&lt;&lt;"mine"&gt;&gt;,undefined,[],undefined,
&gt; &lt;&lt;131,108,0,0,0,2,104,2,107,0,5,110,97,109,101,95,107,0,
&gt; 5,106,97,115,...&gt;&gt;}
&gt; 160&gt; riakc\\_pb\\_socket:put(Pid,O).
&gt;
&gt; ok
&gt; 161&gt; riakc\\_pb\\_socket:search(Pid, &lt;&lt;"user"&gt;&gt;,
&gt; term\\_to\\_binary([{"name\\_","jason"},{"sex\\_", "male"}])).
&gt; {ok,{search\\_results,[{&lt;&lt;"user"&gt;&gt;,
&gt; [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"mine"&gt;&gt;},
&gt; {&lt;&lt;"value"&gt;&gt;,
&gt;
&gt; &lt;&lt;131,108,0,0,0,2,104,2,107,0,5,110,97,109,101,95,107,
&gt; 0,...&gt;&gt;}]}],
&gt; 0.35355299711227417,1}}
&gt; 162&gt; riakc\\_pb\\_socket:search(Pid, &lt;&lt;"user"&gt;&gt;,
&gt; term\\_to\\_binary([{"name\\_","jason"}])).
&gt; {ok,{search\\_results,[],0.0,0}}
&gt; 163&gt;
&gt; \\*How to get the object by the {"name\\_", "jason"} ?\\*
&gt; \\*Is there another way to solve the question?\\*
&gt;
&gt;
&gt;
&gt; I need your help, thanks very much.
&gt;
&gt; Jason
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; 只为成功找方法，不为失败找理由
&gt;


-- 
只为成功找方法，不为失败找理由
