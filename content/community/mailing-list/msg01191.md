---
title: "Re: new to riak, unsure of data model for comment system"
description: ""
project: community
lastmod: 2010-10-04T16:58:01-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01191"
mailinglist_parent_id: "msg01182"
author_name: "Dan Reverri"
project_section: "mailinglistitem"
sent_date: 2010-10-04T16:58:01-07:00
---


Hi Zak,

I believe the practical limits you are referring to occur when you have
around 1000 links on an object. Also note, these limitations only apply to
the REST API.

Regarding the linked list idea, this would be difficult to implement since
there is no way to serialize your writes. If multiple comments are added to
an object the tail of the list may updated with several links concurrently.

Another method for storing a large number of links is to keep a list of
related keys in a separate object. The related keys would be stored as the
objects value rather than using headers. This method would require you to
write a custom map/reduce function to parse out the links and "walk" to the
related items. This method would only avoid the header issue seen in the
REST API. You would still have to collect all linked items and truncate to
20 in a reduce phase to emulate a "LIMIT" query.


Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Sun, Oct 3, 2010 at 7:04 PM, Zak Fenton  wrote:

&gt; Hi. I've recently been using Riak to prototype a website. The data model
&gt; for media objects and articles is a no-brainer, but I'm wondering about
&gt; the best way to implement a comment system.
&gt;
&gt; This is my current plan:
&gt; Media objects/articles are in the media or article buckets. Each such
&gt; object can have any number of links to comments (the tag for these links
&gt; is unimportant - does a link actually \\*need\\* a tag?). Comments go in the
&gt; comments bucket, so to retrieve all comments for an object is a simple
&gt; link walk of all links to that bucket.
&gt;
&gt; I read that there is no "artificial" limit on the number of links, but
&gt; am I likely to run into practical limits if an object has hundreds of
&gt; comments? Would I be better off having each object link only to the
&gt; latest comment, and store comments in a linked list? The usual request
&gt; for comments is something like "give me the last 20 comments for object
&gt; Foo", so is there a more effective way of doing this than requesting all
&gt; comments at a time (and probably cacheing the last 20 in the frontend or
&gt; in a single Riak object)?
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

