---
title: "Re: Large ring_creation_size"
description: ""
project: community
lastmod: 2011-04-14T06:09:38-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03023"
mailinglist_parent_id: "msg03015"
author_name: "Dave Barnes"
project_section: "mailinglistitem"
sent_date: 2011-04-14T06:09:38-07:00
---


Sorry I feel compelled to chime in.

Maybe you could assess your physical node limits and start with a small
configuration, then increase it and increase it until you hit a limit.

Work small to large.

Once you find the pain point, lets us know what resource ran out.

You will learn a lot along the way on how your servers behave and we'll
discover a lot when you share the results.

Thanks for digging in,

Dave

On Wed, Apr 13, 2011 at 5:11 PM, Greg Nelson  wrote:

&gt; Ok, how about in this case I described? It runs out of memory with a
&gt; single pair of nodes...
&gt;
&gt; (Or did you mean there's a connection between each pair of vnodes?)
&gt;
&gt; On Wednesday, April 13, 2011 at 1:56 PM, Jon Meredith wrote:
&gt;
&gt; Hi Greg et al,
&gt;
&gt; As you say largest known is not largest possible. Internally within Basho,
&gt; the largest cluster we've experimented with so far had 50 nodes.
&gt;
&gt; Going beyond that it's speculation from me about pain points.
&gt;
&gt; 1) It is true that you need enough file descriptors to start up all
&gt; partitions when a node restarts - Riak checks if there is any handoff data
&gt; pending for each partition. We have work scheduled to address that in the
&gt; medium term. The plan is to only spin up partitions the node owns and any
&gt; that have been started as fallbacks that handoff has not completed for.
&gt; Until that work is done you will need a high ulimit with large ring sizes.
&gt;
&gt; 2) It is also true that Erlang runs a fully connected network, so there
&gt; will be connections between each node pair in the cluster. We haven't
&gt; determined the point at which it becomes a problem.
&gt;
&gt; So it looks like you'll be pushing the known limits. Basho will do our
&gt; very best to help overcome any obstacles as you encounter them.
&gt;
&gt; Jon Meredith
&gt; Basho Technologies.
&gt;
&gt; On Wed, Apr 13, 2011 at 1:41 PM, Greg Nelson  wrote:
&gt;
&gt; The largest known riak cluster != the largest possible riak cluster. ;-)
&gt;
&gt; The inter node communication of the cluster depends on the data set and
&gt; usage pattern, doesn't it? Or is there some constant overhead that tops out
&gt; at a few hundred nodes? I should point out that we'll have big data, but
&gt; not a huge number of keys.
&gt;
&gt; The number of vnodes in the cluster should be equal to the
&gt; ring\\_creation\\_size under normal circumstances, shouldn't it? So when I have
&gt; a one node cluster, that node is running ring\\_creation\\_size vnodes... File
&gt; descriptors probably isn't a problem -- these machines won't be doing
&gt; anything else, and the limits are set to 65536.
&gt;
&gt; Thinking about the internode communication you mentioned, that's probably
&gt; where the resource hog is.. socket buffers, etc.
&gt;
&gt; Anyway, I'd also love to hear more from basho. :)
&gt;
&gt; On Wednesday, April 13, 2011 at 12:33 PM, sicul...@gmail.com wrote:
&gt;
&gt; Ill just chime in and say that this is not practical for a few reasons. The
&gt; largest known riak cluster has like 50 or 60 nodes. Afaik, inter node
&gt; communication of erlang clusters top out at a few hundred nodes. I'm also
&gt; under the impression that each physical node has to have enough file
&gt; descriptors to accommodate every virtual node in the cluster.
&gt;
&gt; I'd love to hear more from basho.
&gt;
&gt; -alexander
&gt;
&gt;
&gt; Sent from my Verizon Wireless BlackBerry
&gt;
&gt; -----Original Message-----
&gt; From: Greg Nelson 
&gt; Sender: riak-users-boun...@lists.basho.com
&gt; Date: Wed, 13 Apr 2011 12:13:34
&gt; To: 
&gt; Subject: Large ring\\_creation\\_size
&gt;


&gt;

