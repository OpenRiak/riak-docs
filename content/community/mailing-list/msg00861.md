---
title: "Re: basho_bench crash using PB client"
description: ""
project: community
lastmod: 2010-08-09T14:06:34-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00861"
mailinglist_parent_id: "msg00860"
author_name: "Peter Herndon"
project_section: "mailinglistitem"
sent_date: 2010-08-09T14:06:34-07:00
---


Yes, indeed, that's taken care of it! Thanks very much, Sean.

---Peter
On Aug 9, 2010, at 5:02 PM, Sean Cribbs wrote:

&gt; Try using the uniform\\_int\\_bin key generator. It looks like your key is an 
&gt; integer and so it's not getting encoded correctly by protobuffs.
&gt; 
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 
&gt; On Aug 9, 2010, at 4:54 PM, Peter Herndon wrote:
&gt; 
&gt;&gt; Hi all,
&gt;&gt; 
&gt;&gt; I'm running into a crash every time I try to run a benchmark using the
&gt;&gt; PB client. The HTTP raw client works just fine. Can someone give me
&gt;&gt; an idea what the source of the problem might be? I'm a bit stumped as
&gt;&gt; to where to look.
&gt;&gt; 
&gt;&gt; Thanks very much!
&gt;&gt; 
&gt;&gt; Here's the error output from basho\\_bench:
&gt;&gt; 
&gt;&gt; =ERROR REPORT==== 9-Aug-2010::16:26:03 ===
&gt;&gt; \\*\\* Generic server &lt;0.72.0&gt; terminating
&gt;&gt; \\*\\* Last message in was {req,{rpbgetreq,&lt;&lt;"test"&gt;&gt;,15821,1}}
&gt;&gt; \\*\\* When Server state == {state,{127,0,0,1},
&gt;&gt; 8087,#Port&lt;0.1287&gt;,undefined,undefined,
&gt;&gt; undefined,undefined,
&gt;&gt; {[],[]}}
&gt;&gt; \\*\\* Reason for termination ==
&gt;&gt; \\*\\* {function\\_clause,[{protobuffs,encode\\_internal,[2,15821,bytes]},
&gt;&gt; {protobuffs,encode,3},
&gt;&gt; {riakclient\\_pb,iolist,2},
&gt;&gt; {riakc\\_pb,encode,1},
&gt;&gt; {riakc\\_pb\\_socket,send\\_request,4},
&gt;&gt; {riakc\\_pb\\_socket,handle\\_call,3},
&gt;&gt; {gen\\_server,handle\\_msg,5},
&gt;&gt; {proc\\_lib,init\\_p\\_do\\_apply,3}]}
&gt;&gt; 
&gt;&gt; 
&gt;&gt; And here's my config:
&gt;&gt; 
&gt;&gt; 
&gt;&gt; {mode, max}.
&gt;&gt; 
&gt;&gt; {duration, 10}.
&gt;&gt; 
&gt;&gt; {concurrent, 1}.
&gt;&gt; 
&gt;&gt; {driver, basho\\_bench\\_driver\\_riakc\\_pb}.
&gt;&gt; 
&gt;&gt; {code\\_paths, ["deps/stats",
&gt;&gt; "deps/riakc",
&gt;&gt; "deps/protobuffs"]}.
&gt;&gt; 
&gt;&gt; {key\\_generator, {uniform\\_int, 35000}}.
&gt;&gt; 
&gt;&gt; {value\\_generator, {fixed\\_bin, 3}}.
&gt;&gt; 
&gt;&gt; {riakc\\_pb\\_ips, [{127,0,0,1}]}.
&gt;&gt; 
&gt;&gt; {riakc\\_pb\\_replies, 1}.
&gt;&gt; 
&gt;&gt; {operations, [{get, 1}, {update, 1}]}.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; And here's the crash report from log.sasl.txt:
&gt;&gt; 
&gt;&gt; 
&gt;&gt; =CRASH REPORT==== 9-Aug-2010::16:44:44 ===
&gt;&gt; crasher:
&gt;&gt; initial call: riakc\\_pb\\_socket:init/1
&gt;&gt; pid: &lt;0.63.0&gt;
&gt;&gt; registered\\_name: []
&gt;&gt; exception exit: {function\\_clause,
&gt;&gt; [{protobuffs,encode\\_internal,[2,15821,bytes]},
&gt;&gt; {protobuffs,encode,3},
&gt;&gt; {riakclient\\_pb,iolist,2},
&gt;&gt; {riakc\\_pb,encode,1},
&gt;&gt; {riakc\\_pb\\_socket,send\\_request,4},
&gt;&gt; {riakc\\_pb\\_socket,handle\\_call,3},
&gt;&gt; {gen\\_server,handle\\_msg,5},
&gt;&gt; {proc\\_lib,init\\_p\\_do\\_apply,3}]}
&gt;&gt; in function gen\\_server:terminate/6
&gt;&gt; ancestors: [&lt;0.62.0&gt;]
&gt;&gt; messages: []
&gt;&gt; links: [&lt;0.62.0&gt;,#Port&lt;0.1284&gt;]
&gt;&gt; dictionary: []
&gt;&gt; trap\\_exit: false
&gt;&gt; status: running
&gt;&gt; heap\\_size: 377
&gt;&gt; stack\\_size: 24
&gt;&gt; reductions: 340
&gt;&gt; neighbours:
&gt;&gt; neighbour: [{pid,&lt;0.62.0&gt;},
&gt;&gt; {registered\\_name,[]},
&gt;&gt; {initial\\_call,{erlang,apply,2}},
&gt;&gt; {current\\_function,{gen,do\\_call,4}},
&gt;&gt; {ancestors,[]},
&gt;&gt; {messages,[]},
&gt;&gt; {links,[&lt;0.61.0&gt;,&lt;0.63.0&gt;]},
&gt;&gt; {dictionary,[{random\\_seed,{16334,12955,11824}}]},
&gt;&gt; {trap\\_exit,false},
&gt;&gt; {status,waiting},
&gt;&gt; {heap\\_size,610},
&gt;&gt; {stack\\_size,23},
&gt;&gt; {reductions,139}]
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Thanks very much for your assistance,
&gt;&gt; 
&gt;&gt; ---Peter
&gt;&gt; 
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

