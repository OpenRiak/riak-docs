---
title: "Re: 403 forbidden from Riak 1.2.0 when referer header is set"
description: ""
project: community
lastmod: 2012-08-15T06:56:06-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08295"
mailinglist_parent_id: "msg08292"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-08-15T06:56:06-07:00
---


Fredrik,

This is intentional -- in 1.2 we added some measures to counteract
cross-site scripting and request-forgery attacks. For your application, it
would be best to have a reverse-proxy remove the Referer header (as long as
the request is a GET to allowed resources, like your images).

On Wed, Aug 15, 2012 at 8:24 AM, Fredrik Lindstr√∂m &lt;
fredrik.lindst...@qbranch.se&gt; wrote:

&gt; Hi everyone,
&gt; One of the things we use Riak for is to serve images straight to the
&gt; browser (obviously via a firewall etc etc). These images are displayed on
&gt; our webpages so when the browser loads the page it will fire off GET
&gt; requests for the image URLs and for good measure it will include a referer
&gt; header when doing this. This works fine in production since we're still on
&gt; Riak 1.0.2 but our dev and stage clusters have been upgraded to 1.2.0 and
&gt; the story is a bit different there.
&gt; Riak will respond with 403 Forbidden if the referer header is set, the
&gt; same is also logged in the access.log files.
&gt;
&gt; I found this while digging around:
&gt;
&gt; https://github.com/basho/riak\\_kv/commit/3cd75e76c20b77dec2be0cb36892f5cc79dbec0b
&gt; \\*"\\*Validate that the Referer matches up with scheme, host and port of the
&gt; machine that received the request"
&gt;
&gt; Since the referer (http://mysupderduperwebapp.xyz/snazzypage.html) will
&gt; not match the scheme, host and port of the riak node that received the
&gt; request no image will be served.
&gt; Is there any way to configure riak 1.2.0 to allow any referer header value?
&gt;
&gt; /F
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

