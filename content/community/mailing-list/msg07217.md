---
title: "Re: Riak Disk Usage"
description: ""
project: community
lastmod: 2012-04-17T08:27:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07217"
mailinglist_parent_id: "msg07214"
author_name: "Fábio Sato"
project_section: "mailinglistitem"
sent_date: 2012-04-17T08:27:16-07:00
---


The default value for max\\_file\\_size is "16#8000000". Is this hexadecimal
format?

Isn't this 128MB? The documentation says that this is 2GB but I can't
reproduce this value converting this to decimal...

Thanks,
---
Fábio Sato

2012/4/17 Fábio Sato 

&gt; Thanks Sean!
&gt;
&gt; I'll change the max\\_file\\_size and monitor disk usage.
&gt;
&gt; I hope that does the trick!
&gt; ---
&gt; Fábio Sato
&gt;
&gt; 2012/4/17 Sean Cribbs 
&gt;
&gt;&gt; Fabio,
&gt;&gt;
&gt;&gt; If you are using Bitcask (the default storage engine), it won't compact
&gt;&gt; its data files until they reach the 2GB default max file size. Since your
&gt;&gt; disk space is constrained, I suggest you tune the max\\_file\\_size down
&gt;&gt; (128-256MB should be sufficient for your purposes) and merging
&gt;&gt; threshold/triggers. More info about those settings can be found on this
&gt;&gt; page: http://wiki.basho.com/Bitcask.html#Disk-Usage-and-Merging-Settings
&gt;&gt;
&gt;&gt; Hope that helps!
&gt;&gt;
&gt;&gt; On Tue, Apr 17, 2012 at 9:20 AM, Fábio Sato  wrote:
&gt;&gt;
&gt;&gt;&gt; Hello all,
&gt;&gt;&gt;
&gt;&gt;&gt; I've started using Riak as a data store for images and documents and I'm
&gt;&gt;&gt; having trouble understanding its disk usage behaviour.
&gt;&gt;&gt;
&gt;&gt;&gt; We developed a web system and unfortunately it went into production
&gt;&gt;&gt; without the appropriate hardware infrastructure, and we are currently
&gt;&gt;&gt; running only one instance of Riak right now (I know this is dead wrong but
&gt;&gt;&gt; I'm waiting for more hardware).
&gt;&gt;&gt;
&gt;&gt;&gt; Currently we have like 100 keys and update their content every 5
&gt;&gt;&gt; minutes. Every image has approximately 300kB so I would expect a disk usage
&gt;&gt;&gt; around 300MB-1GB and also that riak would keep it constant. But every 2
&gt;&gt;&gt; weeks we get a full filesystem (10GB) and have to restart Riak (or
&gt;&gt;&gt; temporally add another instance) to make it release space.
&gt;&gt;&gt;
&gt;&gt;&gt; To me it seems like it is maintaining the previous values for each key
&gt;&gt;&gt; like a versioning system, but can't confirm that based on what I've read on
&gt;&gt;&gt; the documentation.
&gt;&gt;&gt;
&gt;&gt;&gt; Could someone give me a hint why the disk space grows even if I'm not
&gt;&gt;&gt; adding no new keys?
&gt;&gt;&gt;
&gt;&gt;&gt; Any feedback would be appreciated.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt; --
&gt;&gt;&gt; Fábio Sato
&gt;&gt;&gt;

&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Sean Cribbs 
&gt;&gt; Software Engineer
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;&gt;
&gt;&gt;
&gt;
&gt;
&gt; --
&gt; Fábio Sato
&gt;

-- 
Fábio Sato
