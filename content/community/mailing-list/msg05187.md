---
title: "Re: Hey, Python client users"
description: ""
project: community
lastmod: 2011-10-18T08:12:29-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05187"
mailinglist_parent_id: "msg05181"
author_name: "Greg Stein"
project_section: "mailinglistitem"
sent_date: 2011-10-18T08:12:29-07:00
---


On Mon, Oct 17, 2011 at 15:13, Russell Brown  wrote:
&gt;
&gt; On 16 Oct 2011, at 06:18, Greg Stein wrote:
&gt;
&gt;&gt; Hey all,
&gt;&gt;
&gt;&gt; The Basho folks have been slow to integrate changes, given their busy
&gt;&gt; schedule with the 1.0 release.
&gt;
&gt; This is true. Sorry. But we are now putting some time into the client 
&gt; libraries in general and the python client in particular.

No need to apologize! I'd much rather you work on the 1.0 release than
the libraries! I can fix the libraries to my needs; I have \\*no\\* idea
how to fix Riak itself. Go wild :-)

&gt;&gt; I've had a couple branches hanging out
&gt;&gt; for a while to deal with HTTP problems and to deal with Issue #53.
&gt;&gt; They've been separate for better review/merging by Basho, but it
&gt;&gt; finally created too many problems for my own work to keep them
&gt;&gt; separate. I've just now merged them into a single branch so that I can
&gt;&gt; get my own work done.
&gt;
&gt; Yeah, I started merging your P/Rs in a while back, but then the last 2 
&gt; conflict with a couple of P/Rs from Brett Hoerner. I guess at the point  we 
&gt; stalled as there is some decision to be made about the best way to handle 
&gt; pooling.

RIght. Timeouts are needed; Brett is spot-on with that. They're
definitely needed for a production system. The open question is how to
work them into the client, and that depends upon the development
direction.

&gt; I'm reading over both Brett and your changes today.
&gt;
&gt; There is quite some work to merge the commits you've been doing into the 
&gt; official repo, but I'd like to get that done rather than have a competing 
&gt; fork.

To be clear: I'm not attempting to create a long-term competing fork.
I've been using my 'newhttp' branch for proper connections to Riak,
but then I smashed into the lack of .store() returning an identifier.
In the past, I kinda switched branches based on whether I needed good
http work, or .store to work... but I got tired of that. So I created
a new branch and merged it all. And I like to share my work, I like to
help people, and I like feedback. If my fully-merged branch can help
people? Great. Win.

But no... I expect that when you guys (Basho) have cycles, that we'll
figure out the right approach for connection management and get the
committed, and my branches will disappear.

&gt;...
&gt;&gt; Anyhow, enough description. If you're using Python, then I'd highly 
&gt;&gt; recommend:
&gt;&gt;  https://github.com/gstein/riak-python-client/tree/proper
&gt;&gt;
&gt;&gt; I hope that helps, and let me know if you run into any problems with it.
&gt;
&gt; Would you recommend taking this fork and merging it with the 
&gt; basho/riak-python-client?

I'm building a business based on that branch. So yeah: I have complete
faith in it. I fully believe it is the correct direction to go for the
Python client.

But: I also sent the P/R to create a discussion on the approach (since
Brett has a different approach, I felt discussion was warranted). I
think it is the right approach, but I did not want to invest time in
full documentation if it was to be rejected. So a merge would be
great, but further documentation would be needed before the next
client release. There will be some test updates since my code
simplifies the set of transports. There is some deprecation of the old
APIs that needs to happen, and I set up the prep-work for that, but
didn't bother with all of that since I was waiting on selection.

The short answer: my branch puts connection management into the
transport, and Brett's patches puts that into the client. A decision
needs to be made, and that will determine future work. I've previously
emailed with an explanation for why I believe the transport class
should handle this (via a connection manager), and why (IMO) the
client should not be worrying about it. Making this decision removes
blocks for future changes (eg. timeouts).

Anyway... I'd merge 'proper' into the upstream master branch (to fix
http and issue 53), and then I'd be on the hook for documentation,
test changes, backwards compat work, etc. I believe it is totally the
right direction.

Cheers,
-g

