---
title: "Re: Bitcask with sync_strategy o_sync seem to have no effect"
description: ""
project: community
lastmod: 2011-08-31T06:02:37-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04533"
mailinglist_parent_id: "msg04532"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-08-31T06:02:37-07:00
---


This bug was recently fixed -- although the option was available to bitcask
it was not applied when started by the KV backend. (
https://github.com/basho/riak\\_kv/commit/51290526d1e3c0408e6238a55b676809e1b0c840)
However, it may be possible that somewhere inside Bitcask, the osync
strategy is not enacted, but I'll leave that determination to Dizzy.

On Wed, Aug 31, 2011 at 12:22 AM, David Smith  wrote:

&gt; On Tue, Aug 30, 2011 at 8:57 PM, Tatsuya Kawano 
&gt; wrote:
&gt;
&gt; &gt; The current behavior could be dangerous if someone rely on
&gt; {sync\\_strategy, o\\_sync} for durability.
&gt; &gt;
&gt; &gt; My colleague checked Bitcask implementation and found that it uses "fcntl
&gt; (2)" system call to set O\\_SYNC flag to the file descriptor. Unfortunately,
&gt; O\\_SYNC being set by this way will be ignored by kernel and has no effect. To
&gt; make it work, Betcask should call "open" system call with O\\_SYNC option.
&gt;
&gt; Tatsuya, thanks for the pointer on this. I will take a look into this
&gt; more carefully tomorrow.
&gt;
&gt; D.
&gt;
&gt; --
&gt; Dave Smith
&gt; Director, Engineering
&gt; Basho Technologies, Inc.
&gt; diz...@basho.com
&gt;


-- 
Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://www.basho.com/
