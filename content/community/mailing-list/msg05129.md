---
title: "Re: Riak Search Error - Zero Results"
description: ""
project: community
lastmod: 2011-10-11T18:37:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05129"
mailinglist_parent_id: "msg05123"
author_name: "Todd Cullen"
project_section: "mailinglistitem"
sent_date: 2011-10-11T18:37:08-07:00
---


The plot thickens, here's an error we're getting out of what appears to be
the search pre-commit hook:

2011-10-11 20:01:12 =SUPERVISOR REPORT====
 Supervisor: {local,riak\\_kv\\_put\\_fsm\\_sup}
 Context: child\\_terminated
 Reason:
{{{badmatch,{error,{{badmatch,{error,{badarg,[{erlang,binary\\_to\\_term,[&lt;&lt;131,108,0,0,0,7,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,22,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,117,114,108,109,0,0,0,140,104,116,116,112,58,47,47,119,119,119,46,100,97,105,108,121,109,97,105,108,46,99,111,46,117,107,47,110,101,119,115,47,97,114,116,105,99,108,101,45,50,48,52,55,49,54,56,47,79,99,99,117,112,121,45,87,97,108,108,45,83,116,114,101,101,116,45,0,0,0,182,131,108,0,0,0,1,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,24,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,100,111,119,110,115,109,0,0,0,1,48,109,0,0,0,88,37,50,70,114,37,50,70,80,117,109,112,107,105,110,115,37,50,70,99,111,109,109,101,110,116,115,37,50,70,108,54,104,52,107,37,50,70,102,114,101,101,95,104,117,110,103,101,114,95,103,97,109,101,115,95,109,111,99,107,105,110,103,106,97,121,95,112,117,109,112,107,105,110,95,115,116,101,110,99,105,108,95,112,100,102,37,50,70,110,7,1,161,232,176,105,15,175,4,108,0,0,0,1,104,2,100,0,1,112,107,0,1,0,106,106,0,0,18,0,131,108,0,0,0,25,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,24,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,116,105,116,108,101,109,0,0,0,8,40,82,101,115,116,105,110,103,109,0,0,0,83,37,50,70,114,37,50,70,110,101,117,114,111,37,50,70,99,111,109,109,101,110,116,115,37,50,70,108,54,104,100,48,37,50,70,115,117,112,95,110,101,117,114,111,95,105,95,97,110,105,109,97,116,101,100,95,97,95,100,105,103,105,116,97,108,95,115,104,111,114,116,95,97,98,111,117,116,95,116,104,101,37,50,70,110,7,1,163,167,26,107,15,175,4,108,0,0,0,1,104,2,100,0,1,112,107,0,1,11,106,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,55,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,114,101,112,108,105,101,115,95,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,98,111,100,121,95,104,116,109,108,109,0,0,0,4,73,39,118,101,109,0,0,0,83,37,50,70,114,37,50,70,110,101,117,114,111,37,50,70,99,111,109,109,101,110,116,115,37,50,70,108,54,104,100,48,37,50,70,115,117,112,95,110,101,117,114,111,95,105,95,97,110,105,109,97,116,101,100,95,97,95,100,105,103,105,116,97,108,95,115,104,111,114,116,95,97,98,111,117,116,95,116,104,101,37,50,70,110,7,1,163,167,26,107,15,175,4,108,0,0,0,1,104,2,100,0,1,112,107,0,1,11,106,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,37,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,109,101,100,105,97,95,111,101,109,98,101,100,95,116,105,116,108,101,109,0,0,0,7,78,101,116,119,111,114,107,109,0,0,0,83,37,50,70,114,37,50,70,110,101,117,114,111,37,50,70,99,111,109,109,101,110,116,115,37,50,70,108,54,104,100,48,37,50,70,115,117,112,95,110,101,117,114,111,95,105,95,97,110,105,109,97,116,101,100,95,97,95,100,105,103,105,116,97,108,95,115,104,111,114,116,95,97,98,111,117,116,95,116,104,101,37,50,70,110,7,1,163,167,26,107,15,175,4,108,0,0,0,1,104,2,100,0,1,112,107,0,1,7,106,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,24,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,100,111,119,110,115,109,0,0,0,1,48,109,0,0,0,83,37,50,70,114,37,50,70,110,101,117,114,111,37,50,70,99,111,109,109,101,110,116,115,37,50,70,108,54,104,100,48,37,50,70,115,117,112,95,110,101,117,114,111,95,105,95,97,110,105,109,97,116,101,100,95,97,95,100,105,103,105,116,97,108,95,115,104,111,114,116,95,97,98,111,117,116,95,116,104,101,37,50,70,110,7,1,163,167,26,107,15,175,4,108,0,0,0,1,104,2,100,0,1,112,107,0,6,0,1,2,4,5,6,106,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,26,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,99,114,101,97,116,101,100,109,0,0,0,12,49,51,49,56,50,53,52,57,50,57,46,48,109,0,0,0,83,37,50,70,114,37,50,70,110,101,117,114,111,37,50,70,99,111,109,109,101,110,116,115,37,50,70,108,54,104,100,48,37,50,70,115,117,112,95,110,101,117,114,111,95,105,95,97,110,105,109,97,116,101,100,95,97,95,100,105,103,105,116,97,108,95,115,104,111,114,116,95,97,98,111,117,116,95,116,104,101,37,50,70,110,7,1,163,167,26,107,15,175,4,108,0,0,0,1,104,2,100,0,1,112,107,0,1,5,106,104,4,104,3,109,0,0,0,12,114,101,100,100,105,116,95,112,111,115,116,115,109,0,0,0,28,100,97,116,97,95,99,104,105,108,100,114,101,110,95,100,97,116,97,95,98,111,100,121,95,104,116,109,108,109,0,0,0,4,106,117,115,116,109,0,0,0,83,37,50,70,114,37,50,70,110,101,117,114,111,37,50,70,99,111,109,109,101,110,116,115,37,50,70,108,54,104,100,48,37,50,70,115,117,112,95,110,101,117,114,111,95,105,95,97,110,105,109,97&gt;&gt;]},{mi\\_buffer,read\\_value,2},{mi\\_buffer,open\\_inner,3},{mi\\_buffer,new,1},{mi\\_server,read\\_buffers,4},{mi\\_server,read\\_buf\\_and\\_seg,1},{mi\\_server,init,1},{gen\\_server,init\\_it,6}]}}},[{merge\\_index\\_backend,start,2},{riak\\_search\\_vnode,init,1},{riak\\_core\\_vnode,init,1},{gen\\_fsm,init\\_it,6},{proc\\_lib,init\\_p\\_do\\_apply,3}]}}},[{riak\\_core\\_vnode\\_master,get\\_vnode,2},{riak\\_core\\_vnode\\_master,handle\\_call,3},{gen\\_server,handle\\_msg,5},{proc\\_lib,init\\_p\\_do\\_apply,3}]},{gen\\_server,call,[{riak\\_search\\_vnode\\_master,'riak@IP\\_ADDRESS
'},{'riak\\_vnode\\_req\\_v1',981946412581700398168100746981252653831329677312,{server,undefined,undefined},{'index\\_v1',[{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_subreddit"&gt;&gt;,&lt;&lt;"Austin"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[0]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body\\_html"&gt;&gt;,&lt;&lt;"this"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"
"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body\\_html"&gt;&gt;,&lt;&lt;"completely"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[3]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"look"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[16]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_downs"&gt;&gt;,&lt;&lt;"0"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[1,2]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"I'd"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"%"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_thumbnail"&gt;&gt;,&lt;&lt;"/static/noimage.png"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[0]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_name"&gt;&gt;,&lt;&lt;"t1\\_c2q7zwt"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[0]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_name"&gt;&gt;,&lt;&lt;"t1\\_c2qac7h"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[1]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body\\_html"&gt;&gt;,&lt;&lt;"Lake"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[14]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_body\\_html"&gt;&gt;,&lt;&lt;"class="md"&gt;&lt;p&gt;Just"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"%"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"p.m.,"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[21]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"sad"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[4]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"I"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[1,4,29,36]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body\\_html"&gt;&gt;,&lt;&lt;"seems"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"&"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"comes"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"""}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"any"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"6"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"why"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"1"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_replies\\_data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"be"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"&5"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_body\\_html"&gt;&gt;,&lt;&lt;"chaps"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,"4"}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_body\\_html"&gt;&gt;,&lt;&lt;"near"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[23]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"down"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[31]}],1318381272350848},{&lt;&lt;"reddit\\_posts"&gt;&gt;,&lt;&lt;"data\\_children\\_data\\_body"&gt;&gt;,&lt;&lt;"by"&gt;&gt;,&lt;&lt;"%2Fr%2FAustin%2Fcomments%2Fl6hoj%2Fhelp\\_find\\_mark\\_bosworth%2F"&gt;&gt;,[{p,[5]}],1318381272350848}]}},infinity]}}
 Offender:
[{pid,&lt;0.3996.0&gt;},{name,undefined},{mfargs,{riak\\_kv\\_put\\_fsm,start\\_link,undefined}},{restart\\_type,temporary},{shutdown,5000},{child\\_type,worker}]

We have very recursive data structures being stored. Could that be the cause
of the issues?

@Ryan - I'll try your issues ideas next.

On Tue, Oct 11, 2011 at 6:19 AM, Ryan Zezeski  wrote:

&gt; Todd,
&gt;
&gt; Just to humor me can you please paste the result of getting the bucket
&gt; props for `my\\_bucket`.
&gt;
&gt; Did you enable the search flag for all nodes in the cluster?
&gt;
&gt; Did you restart the nodes after flipping the config?
&gt;
&gt; You can check to see if the index is growing via `du -hs  dir&gt;/merge\\_index`. If that number is not going up while indexing then
&gt; something is definitely wrong.
&gt;
&gt; Another sanity check you could try is indexing a local file in another
&gt; bucket like so;
&gt;
&gt; search-cmd index other\\_bucket 
&gt;
&gt; -Ryan
&gt;
&gt; On Tue, Oct 11, 2011 at 12:54 AM, Todd Cullen wrote:
&gt;
&gt;&gt; Hey all,
&gt;&gt;
&gt;&gt; I've been bashing my head against the wall most of the day trying to
&gt;&gt; figure this out. I can't get search to return me any results even when it
&gt;&gt; should have some positives -&gt; http://pastebin.com/Tu6F2FEG.
&gt;&gt;
&gt;&gt; I've just upgraded my Riak install from v0.14 -&gt; v1.0. I wasn't using Riak
&gt;&gt; Search previously but have just decided to turn it on and try to get it
&gt;&gt; working with the latest release. I actually need to analyze some data
&gt;&gt; sitting in there via search (needless to say I'm very behind on jamming out
&gt;&gt; a report). I tried to track down an answer on IRC earlier today with no luck
&gt;&gt; in finding a result.
&gt;&gt;
&gt;&gt; Here's the steps I've gone through today:
&gt;&gt;
&gt;&gt; - Flipped the search configuration to true in the app.config file
&gt;&gt; - Added the precommit hook to the bucket (lets call it "my\\_bucket" for
&gt;&gt; the time being) and verified them via cURL
&gt;&gt; - Setup a script to GET and rePUT all of the KV's in the my\\_bucket and
&gt;&gt; have verified this works
&gt;&gt; - Checked the logs folder for any error/warning messages (crash.log,
&gt;&gt; error.log, console.log, erlang.log, sasl.log, etc)
&gt;&gt; - Tested search via the commandline (e.g. search-cmd search my\\_bucket
&gt;&gt; attribute\\_name:term\\_that\\_should\\_be\\_here)
&gt;&gt; - Tested search via browser -&gt;
&gt;&gt; 
&gt;&gt; http://my.awesome.site:8098/solr/my\\_bucket/select?q=attribute\\_name:term\\_that\\_should\\_be\\_here
&gt;&gt;
&gt;&gt; I'm not really sure what else I can do to fix the issue. Any suggestions
&gt;&gt; on what else I should check/verify/double check/triple check? Thanks in
&gt;&gt; advance!
&gt;&gt;
&gt;&gt; --
&gt;&gt; Cheers,
&gt;&gt; Todd Cullen
&gt;&gt; CTO & Co-Founder
&gt;&gt; ThoughtLeadr
&gt;&gt;
&gt;&gt; email: t...@thoughtleadr.com
&gt;&gt; phone: 415-254-0787
&gt;&gt; skype: todd.cullen
&gt;&gt;
&gt;


-- 
Cheers,
Todd Cullen
CTO & Co-Founder
ThoughtLeadr

email: t...@thoughtleadr.com
phone: 415-254-0787
skype: todd.cullen
