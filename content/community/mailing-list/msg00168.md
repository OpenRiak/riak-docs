---
title: "Re: http 400 while addings links(and python client bug)"
description: ""
project: community
lastmod: 2010-04-25T08:51:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00168"
mailinglist_parent_id: "msg00167"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-04-25T08:51:40-07:00
---


Correct, protobuffs is not limited in this fashion. However, since we use 
Erlang messages for transport inside the cluster, there might be a limitation 
on the overall size of an object. Further investigation needed.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Apr 25, 2010, at 11:48 AM, Alexander Sicular wrote:

&gt; Ther is no similar limitation in protobuffs, is there?
&gt; 
&gt; 
&gt; @siculars on twitter
&gt; http://siculars.posterous.com
&gt; 
&gt; Sent from my iPhone
&gt; 
&gt; On Apr 25, 2010, at 9:40, Sean Cribbs  wrote:
&gt; 
&gt;&gt; Alexander,
&gt;&gt; 
&gt;&gt; The solution is to send multiple instances of the same header, which is 
&gt;&gt; valid HTTP. Split your long headers (I'm guessing "Link"?) into &lt; 8K 
&gt;&gt; chunks.
&gt;&gt; 
&gt;&gt; Sean Cribbs 
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;&gt; 
&gt;&gt; On Apr 25, 2010, at 6:28 AM, alexander krohn wrote:
&gt;&gt; 
&gt;&gt;&gt; hi.
&gt;&gt;&gt; 
&gt;&gt;&gt; sorry for replying myself ;)
&gt;&gt;&gt; 
&gt;&gt;&gt; the header hits the 8k size mark, that causes the 400.
&gt;&gt;&gt; 
&gt;&gt;&gt; is there a way to configure the max header length for the rest api's http 
&gt;&gt;&gt; server? like apache's LimitRequestFieldsize?
&gt;&gt;&gt; 
&gt;&gt;&gt; also there's a bug in the python client lib, the links are qouted but not 
&gt;&gt;&gt; unquoted. this leads to "growing" and wrong tag names.
&gt;&gt;&gt; 
&gt;&gt;&gt; patch for \\_\\_init\\_\\_.py:
&gt;&gt;&gt; 
&gt;&gt;&gt; 1650c1650,1653
&gt;&gt;&gt; &lt; link = RiakLink(matches.group(2), 
&gt;&gt;&gt; matches.group(3), matches.group(4))
&gt;&gt;&gt; ---
&gt;&gt;&gt;&gt; bucket = 
&gt;&gt;&gt;&gt; urllib.unquote\\_plus(matches.group(2))
&gt;&gt;&gt;&gt; key = urllib.unquote\\_plus(matches.group(3))
&gt;&gt;&gt;&gt; tag = urllib.unquote\\_plus(matches.group(4))
&gt;&gt;&gt;&gt; link = RiakLink(bucket, key, tag)
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; cheers,
&gt;&gt;&gt; 
&gt;&gt;&gt; alexander
&gt;&gt;&gt; 
&gt;&gt;&gt; alexander krohn wrote:
&gt;&gt;&gt;&gt; hi.
&gt;&gt;&gt;&gt; (i already posted this yesterday in irc, mailing-list subscribe was 
&gt;&gt;&gt;&gt; pending)
&gt;&gt;&gt;&gt; i'm using python to insert several items to riak. the code i'm using[1] 
&gt;&gt;&gt;&gt; receives an http 400 exactly while inserting the 238th link to an object.
&gt;&gt;&gt;&gt; the response tells no additional errors, also the erlang-log doesn't show 
&gt;&gt;&gt;&gt; anything.
&gt;&gt;&gt;&gt; something wrong on my side or bug?
&gt;&gt;&gt;&gt; can anyone reproduce this 400?
&gt;&gt;&gt;&gt; thanks in advance.
&gt;&gt;&gt;&gt; cheers,
&gt;&gt;&gt;&gt; alexander
&gt;&gt;&gt;&gt; [1] used code:
&gt;&gt;&gt;&gt; import riak
&gt;&gt;&gt;&gt; client = riak.RiakClient('127.0.0.1',
&gt;&gt;&gt;&gt; 8098,
&gt;&gt;&gt;&gt; transport\\_class=riak.RiakHttpTransport)
&gt;&gt;&gt;&gt; print "client alive: ", client.is\\_alive()
&gt;&gt;&gt;&gt; bucket = client.bucket('t1')
&gt;&gt;&gt;&gt; a = bucket.new('a', (1, 2, 3))
&gt;&gt;&gt;&gt; for i in range(1000):
&gt;&gt;&gt;&gt; x = bucket.new('x\\_%i' % i, i)
&gt;&gt;&gt;&gt; x.store()
&gt;&gt;&gt;&gt; print "stored", i + 1, "items"
&gt;&gt;&gt;&gt; a.add\\_link(x, 'dings').store()
&gt;&gt;&gt;&gt; print "stored", i + 1, "links"
&gt;&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt; 
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

