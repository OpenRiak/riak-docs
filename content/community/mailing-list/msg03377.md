---
title: "Re: Streaming a binary file from riak via node.js to client"
description: ""
project: community
lastmod: 2011-05-21T04:02:06-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03377"
mailinglist_parent_id: "msg03376"
author_name: "francisco treacy"
project_section: "mailinglistitem"
sent_date: 2011-05-21T04:02:06-07:00
---


and which node.js version?


2011/5/21 francisco treacy :
&gt; That should work, but i'll take a look at it. Which versions of
&gt; riak-js and Riak are you using?
&gt;
&gt;
&gt; 2011/5/21 Max :
&gt;&gt; After watching the presentation about how to use node.js with riak, I
&gt;&gt; built some small application on node.js using the express framework.
&gt;&gt;
&gt;&gt; In riak files are stored via a PHP frontend but they should be served
&gt;&gt; via a node.js backend. Anyway, connecting to riak via node.js is not
&gt;&gt; that hard and sending the response is also rather easy. But it seems,
&gt;&gt; somewhere the buffer I get via the client.get operation is truncated.
&gt;&gt; I am using this code:
&gt;&gt;
&gt;&gt; app.get('/images/', function(req, res){
&gt;&gt;    riakClient.get('images', 'some.jpg', function(err, image, meta) {
&gt;&gt;        if (err) {
&gt;&gt;            throw err;
&gt;&gt;        }
&gt;&gt;
&gt;&gt;        res.send(image, {
&gt;&gt;            'Content-Type': meta.contentType
&gt;&gt;        });
&gt;&gt;    });
&gt;&gt; });
&gt;&gt;
&gt;&gt; To test if the image is served, but whenn I access the node.js url,
&gt;&gt; the browser tells me that the image cannot be displayed as it contains
&gt;&gt; errors. The filesize of the served image is too small compared to the
&gt;&gt; original. If I access the url /images/some.jpg directly via rest
&gt;&gt; interface on the command line, the correct image is returned.
&gt;&gt;
&gt;&gt; Has anyone experience in how to stream binary data from riak?
&gt;&gt;
&gt;&gt; Thanks in advance!

&gt;

