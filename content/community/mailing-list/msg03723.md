---
title: "Re: Problem with deleting keys"
description: ""
project: community
lastmod: 2011-06-16T10:15:24-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03723"
mailinglist_parent_id: "msg03714"
author_name: "Andrew Thompson"
project_section: "mailinglistitem"
sent_date: 2011-06-16T10:15:24-07:00
---


On Thu, Jun 16, 2011 at 09:19:51AM -0700, Greg Nelson wrote:
&gt; "A tombstone
&gt; is put and then an async get is fired off and if the async get finds all
&gt; the primary nodes in the preflist are up, it does the delete. If not,
&gt; the next time the key is fetched, it does the same check again and will
&gt; do the delete then if the downed node is up."
&gt; 
&gt; What if the key is never fetched again after the node is up? Does this mean 
&gt; one would have to do GETs on all keys deleted while the node was down after 
&gt; the node is back online, in order to reclaim that space?

As I said, we know this is not the ideal solution. We have a proposal
internally that should solve this issue by not relying on GETs to
trigger actually erasing the key.

If this really concerns you, you could implement something like
postgres's VACUUM by doing a keylist and doing a fetch on all keys in a
slow background process (while you know all the nodes are up) to force
the issue.

Andrew

