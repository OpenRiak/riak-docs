---
title: "Cluster start problem"
description: ""
project: community
lastmod: 2012-09-11T01:09:02-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08488"
author_name: "Wolf Iem"
project_section: "mailinglistitem"
sent_date: 2012-09-11T01:09:02-07:00
---


Hi all,

We have 4 nodes Riak installation. They are running on Ubuntu 12.04 LTS Precise 
installed servers. 
We have installed 1.1.4 at August 1st 2012 and upgraded 1.2.0 when its 
available.


Server names are:

f1 - 10.10.0.12 - This is the first installed server. We have joined other ones 
to this server. This also serves Riak control.
s2 - 10.10.0.22 -
s3 - 10.10.0.23 -
s4 - 10.10.0.24 - This server also serves Riak control.

This morning we've seen "insufficient nodes available" error at our 
applications log and restarted all nodes. 3 of them became available except "f1"

UPDATE : while I prepare this message live 3 nodes became unavailable and need 
restart Riak.

wolfiem@f01:~$ sudo /etc/init.d/riak start
Riak failed to start within 15 seconds,
see the output of 'riak console' for more information.
If you want to wait longer, set the environment variable
WAIT\\_FOR\\_ERLANG to the number of seconds to wait.

I've tried to set WAIT\\_FOR\\_ERLANG value to 60 seconds but I can't.

adding this line in vm.args didn't work:
-env WAIT\\_FOR\\_ERLANG 60

I also tried to set this from terminal but it didn't work either.
wofliem@f01:~$ export WAIT\\_FOR\\_ERLANG=60

It still says "Riak failed to start within 15 seconds"

This is the console.log output:

2012-09-11 10:58:02.532 [info] &lt;0.7.0&gt; Application lager started on node 
'riak@10.10.0.12'
2012-09-11 10:58:02.560 [warning] 
&lt;0.148.0&gt;@riak\\_core\\_ring\\_manager:reload\\_ring:231 No ring file available.
2012-09-11 10:58:02.585 [error] &lt;0.164.0&gt; CRASH REPORT Process &lt;0.164.0&gt; with 0 
neighbours exited with reason: eaddrnotavail in gen\\_server:init\\_it/6 line 320

This is the error.log output
2012-09-11 10:58:02.585 [error] &lt;0.164.0&gt; CRASH REPORT Process &lt;0.164.0&gt; with 0 
neighbours exited with reason: eaddrnotavail in gen\\_server:init\\_it/6 line 320

This is the crash.log output:
2012-09-11 10:58:02 =CRASH REPORT====
 crasher:
 initial call: mochiweb\\_socket\\_server:init/1
 pid: &lt;0.164.0&gt;
 registered\\_name: []
 exception exit: 
{eaddrnotavail,[{gen\\_server,init\\_it,6,[{file,"gen\\_server.erl"},{line,320}]},{proc\\_lib,init\\_p\\_do\\_apply,3,[{file,"proc\\_lib.erl"},{line,227}]}]}
 ancestors: [riak\\_core\\_sup,&lt;0.135.0&gt;]
 messages: []
 links: [&lt;0.136.0&gt;]
 dictionary: []
 trap\\_exit: true
 status: running
 heap\\_size: 377
 stack\\_size: 24
 reductions: 403
 neighbours:


You can find the riak console output below:

wolfiem@f01:~$ riak console
Attempting to restart script through sudo -H -u riak
Exec: /usr/lib/riak/erts-5.9.1/bin/erlexec -boot 
/usr/lib/riak/releases/1.2.0/riak -embedded -config 
/etc/riak/app.config -pa /usr/lib/riak/basho-patches 
-args\\_file /etc/riak/vm.args -- console
Root: /usr/lib/riak
Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:8:8] [async-threads:64] 
[kernel-poll:true]


=INFO REPORT==== 11-Sep-2012::10:44:18 ===
 alarm\\_handler: {set,{system\\_memory\\_high\\_watermark,[]}}
\\*\\* /usr/lib/riak/lib/observer-1.1/ebin/etop\\_txt.beam hides 
/usr/lib/riak/lib/basho-patches/etop\\_txt.beam
\\*\\* Found 1 name clashes in code paths 
10:44:19.099 [info] Application lager started on node 'riak@10.10.0.12'
10:44:19.130 [warning] No ring file available.
10:44:19.158 [error] CRASH REPORT Process &lt;0.164.0&gt; with 0 neighbours exited 
with reason: eaddrnotavail in gen\\_server:init\\_it/6 line 320
/usr/lib/riak/lib/os\\_mon-2.2.9/priv/bin/memsup: Erlang has closed. 

=INFO REPORT==== 11-Sep-2012::10:44:19 ===
 alarm\\_handler: {clear,system\\_memory\\_high\\_watermark}
Erlang has closed
 {"Kernel pid 
terminated",application\\_controller,"{application\\_start\\_failure,riak\\_core,{shutdown,{riak\\_core\\_app,start,[normal,[]]}}}"}

Crash dump was written to: /var/log/riak/erl\\_crash.dump
Kernel pid terminated (application\\_controller) 
({application\\_start\\_failure,riak\\_core,{shutdown,{riak\\_core\\_app,start,[normal,[]]}}})

