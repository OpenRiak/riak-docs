---
title: "Re: riak on SSDs - how to manage potential SSD failures"
description: ""
project: community
lastmod: 2012-11-26T11:09:11-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09377"
mailinglist_parent_id: "msg09376"
author_name: "Matthew Von-Maszewski"
project_section: "mailinglistitem"
sent_date: 2012-11-26T11:09:11-08:00
---


Alex,

The eleveldb backend creates a CRC for every item placed on the disk. You can 
activate the test of the CRC on every read by adding:

 {verify\\_checksums, true}, 

to the "{eleveldb " portion of app.config. With riak 1.2, you must manually 
monitor each vnode directory for the lost/BLOCKS.bad file changing size. It 
only increases upon read operations detecting a CRC and/or compression 
corruption error.

Manually monitoring the BLOCKS.bad file is tacky (my apologies). The upcoming 
1.3 release will populate riak admin with a counter of errors seen. But that 
code is still weeks from release.

Matthew

On Nov 26, 2012, at 1:25 PM, Alex Babkin  wrote:

&gt; Hi all
&gt; 
&gt; first post here, so please be kind :)
&gt; 
&gt; I have plans to build an experimental riak cluster out of cheap ARM computing 
&gt; parts and consumer grade SSDs to measure performance and experiment to assess 
&gt; production viability
&gt; I plan to use levelDB as the backend
&gt; 
&gt; One thing to be concerned of, in light of various SSD failure stories, is of 
&gt; course a scenario of SSD failure and also the way it fails (some parts of SSD 
&gt; space just aren't writable anymore, but still readable, i.e stuck at some 
&gt; constant value). This may potentially result in a scenario where a replicated 
&gt; record on two clusters, one with working SSD and one with faulty, will have 
&gt; different data. Will riak try to account for this scenario? 
&gt; 
&gt; I'm trying to think of ways to mitigate this risk of nodes failing due to 
&gt; these SSD failures or at least get an early indication of a failure (however 
&gt; insignificant it may be).
&gt; Guess my first question should be "Does riak provide any form of checksums or 
&gt; what not on the data it reads/writes, or it blindly trusts that the 
&gt; backend/filesystem reads/writes data correctly?"
&gt; 
&gt; If not, are there any other tricks people use to trigger some alarm bells 
&gt; that an SSD is 'going' ?
&gt; 
&gt; Thanks
&gt; Alex
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
