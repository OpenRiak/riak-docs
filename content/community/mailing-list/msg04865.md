---
title: "Re: MR Output Changes"
description: ""
project: community
lastmod: 2011-09-26T06:53:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04865"
mailinglist_parent_id: "msg04864"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-09-26T06:53:21-07:00
---


This makes sense to me. 

Now I shall use this knowledge to take over the world. Or to re-write part of 
the CorrugatedIron MapReduce functionality.
---
Jeremiah Peschka - Founder, Brent Ozar PLF, LLC
Microsoft SQL Server MVP

On Sep 26, 2011, at 6:51 AM, Bryan Fink wrote:

&gt; On Sat, Sep 24, 2011 at 4:39 PM, Jeremiah Peschka
&gt;  wrote:
&gt;&gt; MapReduce phases with a keep set to true are returning in multiple 
&gt;&gt; RpbMapRedResp messages. I expected this, especially since hte API says it's 
&gt;&gt; possible. What's causing the issue is the output format.
&gt; â€¦
&gt;&gt; Is there a reason that Riak is returning discrete JSON chunks instead of 
&gt;&gt; streaming back raw bytes to the client? Is there less documented change in 
&gt;&gt; Riak 1.0 that will prevent this type of behavior (which incidentally didn't 
&gt;&gt; crop up until the 1.0 pre-release builds).
&gt; 
&gt; Hi, Jermiah. We recently found a similar misunderstanding in the Java
&gt; client. You read the API correctly, but the pre-1.0 MapReduce system
&gt; never exploited that feature, so clients implementing that behavior
&gt; didn't have much to test against.
&gt; 
&gt; The intent of returning discrete JSON chunks is to allow each response
&gt; chunk to be fully consumable without further information. You should
&gt; be able to parse each response independently, instead of having to
&gt; wait for a "done" signal. This encapsulation is also important when
&gt; multiple phases set keep=true, because it allows them to interleave
&gt; results in the response, instead of blocking on each other.
&gt; 
&gt; The HTTP interface uses a similar setup when streamed results are
&gt; requested, using the query parameter chunked=true. Since all PB
&gt; results are "streamed", the same encapsulation is used.
&gt; 
&gt; -Bryan


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

