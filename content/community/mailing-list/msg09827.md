---
title: "Re: What is the \"riak_kv_nodeq_total\" metric?"
description: ""
project: community
lastmod: 2013-01-17T02:35:37-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09827"
mailinglist_parent_id: "msg09819"
author_name: "Dave Brady"
project_section: "mailinglistitem"
sent_date: 2013-01-17T02:35:37-08:00
---


Thanks, Russell!

----- Original Message -----
From: "Russell Brown" 
To: "Dave Brady" 
Cc: "riak-users" 
Sent: Wednesday, January 16, 2013 9:20:20 PM
Subject: Re: What is the "riak\\_kv\\_nodeq\\_total" metric?

Hi Dave,

On 16 Jan 2013, at 11:29, Dave Brady  wrote:

&gt; Greetings, 
&gt; 
&gt; I won't bore everyone with details here: the short story is I ran "riak-admin 
&gt; cluster leave/plan/commit" to remove a node and got a lot of grief from our 
&gt; five-node ring. 
&gt; 
&gt; The ring was pretty well de-stabilized. One-or-more nodes would be down, then 
&gt; up, when repeatedly running "riak-admin ring-status". 
&gt; 
&gt; I have finally isolated a wildly misbehaving node (not the one I was trying 
&gt; to make "leave", by the way). 
&gt; 
&gt; None of the existing metrics I was graphing highlighted a problem, so I went 
&gt; through "/stats" (yet again), looking at the undocumented metrics to see what 
&gt; looked interested. 
&gt; 
&gt; I noticed that riak\\_kv\\_vnodeq\\_total was showing up with a non zero-value, so 
&gt; I set up a graph which plots the difference between the previous-and-current 
&gt; value (like I do for the other "\\*\\_total" metrics). 
&gt; 
&gt; The results were \\*very\\* interesting! The other four nodes showed occasional 
&gt; values of 1, 2 even 3 once or twice. Our troublesome node showed 152, 8000, 
&gt; 704... !! 
&gt; 
&gt; Does anyone know what riak\\_kv\\_vnodeq\\_total indicates? 

It is the total number of messages in the queues for all the riak\\_kv\\_vnodes 
running on the node. Large queues mean that a/some vnode(s) are not able to 
keep up with the requests made of it/them. 


Cheers

Russell

&gt; 
&gt; Thanks!
&gt; 
&gt; --
&gt; Dave Brady
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

