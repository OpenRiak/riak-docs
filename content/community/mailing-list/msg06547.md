---
title: "Re: Is riak the right choice to log and retrieve log data?"
description: ""
project: community
lastmod: 2012-02-06T04:32:17-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06547"
mailinglist_parent_id: "msg06545"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2012-02-06T04:32:17-08:00
---


Hello Heiner,

Looks like a very interesting project. Would love to hear how it turns out. Do 
let us know what you end up deploying. Here are some of my thoughts. 

Between secondary indexes and/or search you should not have a problem 
retrieving a "blip page" of data. 

Certainly do not use the bitcask backend due to in memory key index. You would 
definitely need to use leveldb.

Data bloat. Your 200B will triple on disk because Riak writes ~400B of data for 
itself per key (not exactly certain of the numbers in the post 1.0 branch). For 
this reason alone I'm not sure Riak is optimal for collection of large 
quantities of small values. The sweetspot is in the multi KB range where the 
overhead becomes some smaller % of total data. 

Ring state changes late in your collection cycle will result in a significant 
amount of data rebalancing which will obviously take a while. I would 
overdeploy more nodes early on and replace them in-place, over time to take 
advantage of newer hardware. I feel that although a lot of great work has 
already been done, there is still more work to be done on the rebalancing 
mechanics and algorithm to make this less of a pain point for larger systems. 

I would consider evaluating Cassandra or HBase for this project as well. 

Cheers,
Alexander

@siculars on twitter
http://siculars.posterous.com

Sent from my iRotaryPhone

On Feb 6, 2012, at 5:22, Heiner Bunjes  wrote:

&gt; I need a database to log and retrieve sensor data.
&gt; 
&gt; Is riak the right solution for this task and if, how?
&gt; If not, which other DB system might be a better fit?
&gt; 
&gt; I know that before the implementation of secondary indices riak probably was 
&gt; not suitable for this kind of task. I just hope it is now.
&gt; 
&gt; 
&gt; 
&gt; The details are as follows:
&gt; 
&gt; ######## 
&gt; 
&gt; Glossary
&gt; 
&gt; - Node = A computer on which an instance of the database
&gt; is running
&gt; 
&gt; - Blip = one data record send by a sensor
&gt; 
&gt; - Blip page = The sorted list of all blips for a specific sensor
&gt; and a specific time range.
&gt; 
&gt; 
&gt; The scale is as follows:
&gt; 
&gt; (01) 10E6 sensors deliver 1 blip every 100 seconds
&gt; -&gt; Insert rate = 10 kiloblip/s
&gt; -&gt; Insert rate ~ 315 gigablip/Year
&gt; 
&gt; (02) They have to be stored for ~3 years
&gt; -&gt; Size of database = 1 terablip
&gt; 
&gt; (03) Each blip has about 200 bytes
&gt; -&gt; Size of database = 200TB
&gt; 
&gt; (04) The system will start with just 10E4 sensors but will
&gt; soon increase upto the described volume.
&gt; 
&gt; 
&gt; The main operations on the data are:
&gt; 
&gt; (05) Add the new blips to the database
&gt; (written blips are never changed)!
&gt; 
&gt; (06) Return all blips for sensor X with a timestamp
&gt; between timestamp\\_a and timestamp\\_b!
&gt; With other words: Return a blip page.
&gt; 
&gt; (07) Return all the blips specified in (06) ordered
&gt; by timestamp!
&gt; 
&gt; (08) Delete all blips older than Y!
&gt; 
&gt; 
&gt; Further the following is true:
&gt; 
&gt; (09) Each added blip is clearly (without ambiguity) identifiable by
&gt; sensor\\_id+timestamp.
&gt; 
&gt; (10) 99.9% of the blips are inserted in
&gt; chronological order, the rest is not.
&gt; 
&gt; (11) The database system MUST be free and open source.
&gt; 
&gt; (12) The DB SHOULD be easy to administrate.
&gt; 
&gt; (13) All data MUST still be writable and readable while less
&gt; then the configurable number N of nodes are down (unexpectedly).
&gt; 
&gt; (14) The mechanisms to distribute the data to the available
&gt; nodes SHOULD be handled by the database.
&gt; This means that the database SHOULD automatically
&gt; redistribute the data when nodes are added or removed.
&gt; 
&gt; ######## 
&gt; 
&gt; 
&gt; Many thanks in advance
&gt; Heiner
&gt; 

