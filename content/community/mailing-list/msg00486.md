---
title: "Re: 400 on idle connection"
description: ""
project: community
lastmod: 2010-06-01T19:19:05-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00486"
mailinglist_parent_id: "msg00485"
author_name: "Jonathan Lee"
project_section: "mailinglistitem"
sent_date: 2010-06-01T19:19:05-07:00
---


Just realized that apps/riak\\_core/rebar.config is pointing to commit 115,
but the change was 116...

On Tue, Jun 1, 2010 at 10:16 PM, Jonathan Lee  wrote:

&gt; Ah, I missed that. Thanks for the quick response! I just re-cloned riak
&gt; and ran make, and the mochiweb pulled contains that changeset. However, it
&gt; is not checked out for me:
&gt;
&gt; [~/riak]&gt; cd deps/mochiweb
&gt; [~/riak/deps/mochiweb]&gt; hg parents
&gt; changeset: 115:5ccf25b213fc
&gt; user: Bryan Fink 
&gt; date: Thu Apr 08 16:33:24 2010 -0400
&gt; summary: copy riak/apps/mochiweb to external mochiweb repo
&gt;
&gt; Running hg up and rebuilding fixes this. Is this a config issue?
&gt;
&gt; - Jonathan
&gt;
&gt; On Tue, Jun 1, 2010 at 10:00 PM, Sean Cribbs  wrote:
&gt;
&gt;&gt; Jonathan,
&gt;&gt;
&gt;&gt; This has already been fixed on tip and should be released with 0.11. See:
&gt;&gt; http://hg.basho.com/mochiweb/changeset/6cc943959128
&gt;&gt;
&gt;&gt; Sean Cribbs 
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; http://basho.com/
&gt;&gt;
&gt;&gt; On Jun 1, 2010, at 9:57 PM, Jonathan Lee wrote:
&gt;&gt;
&gt;&gt; &gt; Here's a question regarding idle connection handling. Riak (actually,
&gt;&gt; mochiweb:request/2) automatically resets idle connections after 30 seconds.
&gt;&gt; But, before closing the connection, it sends a 400 response. For example:
&gt;&gt; &gt;
&gt;&gt; &gt; &gt; time telnet 127.0.0.1 8091
&gt;&gt; &gt; Trying 127.0.0.1...
&gt;&gt; &gt; Connected to localhost.
&gt;&gt; &gt; Escape character is '^]'.
&gt;&gt; &gt; HTTP/1.1 400 Bad Request
&gt;&gt; &gt; Server: MochiWeb/1.0 (Any of you quaids got a smint?)
&gt;&gt; &gt; Date: Wed, 02 Jun 2010 01:39:41 GMT
&gt;&gt; &gt; Content-Length: 0
&gt;&gt; &gt;
&gt;&gt; &gt; Connection closed by foreign host.
&gt;&gt; &gt;
&gt;&gt; &gt; real 0m30.010s
&gt;&gt; &gt; user 0m0.002s
&gt;&gt; &gt; sys 0m0.004s
&gt;&gt; &gt;
&gt;&gt; &gt; Is this expected behavior? At first glance, I don't see anything in the
&gt;&gt; HTTP RFC that requires or recommends this. Is there a specific reason for
&gt;&gt; sending the 400?
&gt;&gt; &gt;
&gt;&gt; &gt; My reason for asking this question is that the Java client misinterprets
&gt;&gt; this final 400 and returns it for the wrong request! This can be fixed by
&gt;&gt; having a separate thread actively evict idle connections, but if this is
&gt;&gt; unexpected behavior on the server side, it'd make more sense to change it
&gt;&gt; there.
&gt;&gt; &gt;
&gt;&gt; &gt; Thanks,
&gt;&gt; &gt; Jonathan
&gt;&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; &gt; riak-users mailing list
&gt;&gt; &gt; riak-users@lists.basho.com
&gt;&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;
&gt;&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

