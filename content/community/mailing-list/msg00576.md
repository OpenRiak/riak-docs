---
title: "Re: include mapByFields in riak by default"
description: ""
project: community
lastmod: 2010-06-12T06:44:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00576"
mailinglist_parent_id: "msg00508"
author_name: "francisco treacy"
project_section: "mailinglistitem"
sent_date: 2010-06-12T06:44:22-07:00
---


So what do you guys think? It is a bad idea?

2010/6/6 francisco treacy :
&gt; I find myself using a lot this kind of functions (this one
&gt; inspired/borrowed from Sean Cribbs) - a sort of SQL's conditions
&gt; ("where").
&gt;
&gt; Riak.mapByFields = function(value, keyData, fields) {
&gt;   if(!value.not\\_found){
&gt;     var object = Riak.mapValuesJson(value)[0];
&gt;     for(field in fields) {
&gt;         if(object[field] != fields[field])
&gt;             return [];
&gt;     }
&gt;     return [object];
&gt;   } else {
&gt;     return [];
&gt;   }
&gt; }
&gt;
&gt; Usage:
&gt; {"inputs":"test",
&gt;  "query":[{"map":{"language":"javascript",
&gt;                  "name":"Riak.mapByFields",
&gt;                  "arg": { "city": "Paris" },
&gt;                  "keep":true}}]
&gt; }
&gt;
&gt; Any real-world app \\*always\\* needs to query data by fields.
&gt;
&gt; Would it be a good idea to ship this by default in Riak?  I do believe
&gt; so because it is sufficiently general purpose (just as
&gt; Riak.mapValuesJson).
&gt;
&gt; A lot of libraries (for instance devise-ripple) could build upon this
&gt; function without forcing clients/users to alter their app.config,
&gt; define a js\\_source, and include the function in all their nodes.
&gt;
&gt; What do you think?
&gt;
&gt; Francisco
&gt;

