---
title: "Re: Best practice -- duplicating and syncing objects"
description: ""
project: community
lastmod: 2012-11-29T08:17:10-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09409"
mailinglist_parent_id: "msg09408"
author_name: "Eric Redmond"
project_section: "mailinglistitem"
sent_date: 2012-11-29T08:17:10-08:00
---


There's no general best practice for keeping denormalized data in sync, beyond 
the obvious case, which is to update all values through whatever client you use 
to update one. If your number of keys are few, this is not going to be a hard 
hit on your updates. If you have an unbounded number of keys, you may consider 
normalizing your data model a bit to reduce duplicate data.

Correct, you do not have to wait for a post commit to fire (actually, you 
can't).

You could functionally update objects in a post-commit, though I don't know how 
commonly this is done. If the post-commit job is long running, you might run 
out of pooled connections in javascript. You'd also have to be very careful to 
avoid your aforementioned "infinity loop", since whether by link walking or 
postcommit hooks, you still run the risk of objects updating each other 
recursively.

Eric

On Nov 29, 2012, at 7:53 AM, Felix Terkhorn  wrote:

&gt; Greetings!
&gt; 
&gt; In the event that we have several documents, [A1, A2, …, An], which contain 
&gt; the same data accessed via different keys, what is the best practice for 
&gt; keeping the data in sync?
&gt; 
&gt; Also, do post commit hooks fire after the client receives a successful 201 or 
&gt; 200 status on a PUT? That is to say, we don’t have to wait for all 
&gt; post-commit hooks to fire, in order for our client to receive an HTTP success 
&gt; status, right?
&gt; 
&gt; That’s our assumption, and if true, we’d like to exploit that fact in order 
&gt; to keep the response time of the PUT low. Basically, client could PUT A1, 
&gt; and we could let Riak handle the necessary updates in a post-processing step.
&gt; 
&gt; We could keep the list [A1, A2, …, An] somewhere else, and simply walk that 
&gt; list every time any document in the list is updated, excluding the document 
&gt; itself. Is this a standard approach?
&gt; 
&gt; We thought of linking objects together, and having them update each other on 
&gt; post-commit, but that seems like it will bring us into infinite loop 
&gt; territory. :-D
&gt; 
&gt; Thanks,
&gt; Felix

