---
title: "Re: include mapByFields in riak by default"
description: ""
project: community
lastmod: 2010-06-12T09:04:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00578"
mailinglist_parent_id: "msg00577"
author_name: "Andy Gross"
project_section: "mailinglistitem"
sent_date: 2010-06-12T09:04:55-07:00
---


I'm already all up in Bugzilla today, so I just created
http://issues.basho.com/show\\_bug.cgi?id=237 to track this. I'm in favor of
adding it too.

Andy Gross 
VP, Engineering
Basho Technologies, Inc.
http://basho.com


On Sat, Jun 12, 2010 at 9:53 AM, Sean Cribbs  wrote:

&gt; Best thing is to open a Bugzilla issue so it can get scheduled for a
&gt; release. I for one am in favor of it.
&gt;
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt;
&gt; On Jun 12, 2010, at 9:44 AM, francisco treacy wrote:
&gt;
&gt; &gt; So what do you guys think? It is a bad idea?
&gt; &gt;
&gt; &gt; 2010/6/6 francisco treacy :
&gt; &gt;&gt; I find myself using a lot this kind of functions (this one
&gt; &gt;&gt; inspired/borrowed from Sean Cribbs) - a sort of SQL's conditions
&gt; &gt;&gt; ("where").
&gt; &gt;&gt;
&gt; &gt;&gt; Riak.mapByFields = function(value, keyData, fields) {
&gt; &gt;&gt; if(!value.not\\_found){
&gt; &gt;&gt; var object = Riak.mapValuesJson(value)[0];
&gt; &gt;&gt; for(field in fields) {
&gt; &gt;&gt; if(object[field] != fields[field])
&gt; &gt;&gt; return [];
&gt; &gt;&gt; }
&gt; &gt;&gt; return [object];
&gt; &gt;&gt; } else {
&gt; &gt;&gt; return [];
&gt; &gt;&gt; }
&gt; &gt;&gt; }
&gt; &gt;&gt;
&gt; &gt;&gt; Usage:
&gt; &gt;&gt; {"inputs":"test",
&gt; &gt;&gt; "query":[{"map":{"language":"javascript",
&gt; &gt;&gt; "name":"Riak.mapByFields",
&gt; &gt;&gt; "arg": { "city": "Paris" },
&gt; &gt;&gt; "keep":true}}]
&gt; &gt;&gt; }
&gt; &gt;&gt;
&gt; &gt;&gt; Any real-world app \\*always\\* needs to query data by fields.
&gt; &gt;&gt;
&gt; &gt;&gt; Would it be a good idea to ship this by default in Riak? I do believe
&gt; &gt;&gt; so because it is sufficiently general purpose (just as
&gt; &gt;&gt; Riak.mapValuesJson).
&gt; &gt;&gt;
&gt; &gt;&gt; A lot of libraries (for instance devise-ripple) could build upon this
&gt; &gt;&gt; function without forcing clients/users to alter their app.config,
&gt; &gt;&gt; define a js\\_source, and include the function in all their nodes.
&gt; &gt;&gt;
&gt; &gt;&gt; What do you think?
&gt; &gt;&gt;
&gt; &gt;&gt; Francisco
&gt; &gt;&gt;
&gt; &gt;

