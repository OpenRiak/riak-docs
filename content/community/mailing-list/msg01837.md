---
title: "Re: timeouts while rebalancing"
description: ""
project: community
lastmod: 2010-12-21T19:30:41-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01837"
mailinglist_parent_id: "msg01833"
author_name: "Colin Surprenant"
project_section: "mailinglistitem"
sent_date: 2010-12-21T19:30:41-08:00
---


Hi,

My bucket is using the default N=3. When writing, I am using W=1 and
when reading N=1.

My cluster has settled down now. After the addition of the 4th node,
one of the node started to use diskspace at a very rapid pace, heading
quickly toward 100% usage so I had to remove the 4th node. It took a
few hours for the cluster to settle down. I am back at square one. I
think at this point it will be easier to lease my 0.10.1 cluster
as-is, create a new cluster using the latest 0.13 and extract and
refeed the data into the new cluster without letting it grow out of
proportion on each node.

What would be a reasonable single node data size to be able to cope
"seamlessly" with node additions?
Should I consider using bitcask over innostore, making sure each node
can hold its keyspace in memory?

Thanks.
Colin

On Tue, Dec 21, 2010 at 1:08 PM, Dan Reverri  wrote:
&gt; Hi Collin,
&gt; I would not expect keys to return not found even during handoff. An
&gt; individual vnode may return not found if the requested data has not been
&gt; transferred but the other replicas should be able to satisfy the quorum.
&gt; What values of N, R, and W are you using?
&gt; Thanks,
&gt; Dan
&gt; Daniel Reverri
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; d...@basho.com
&gt;
&gt;
&gt; On Mon, Dec 20, 2010 at 5:18 PM, Colin Surprenant
&gt;  wrote:
&gt;&gt;
&gt;&gt; Yup, same version.
&gt;&gt;
&gt;&gt; On Mon, Dec 20, 2010 at 7:58 PM, Alexander Sicular 
&gt;&gt; wrote:
&gt;&gt; &gt; Did you add the same version of riak to your 0.10.1 cluster? I wouldn't
&gt;&gt; &gt; mismatch...
&gt;&gt; &gt;
&gt;&gt; &gt; On Dec 20, 2010, at 3:46 PM, Colin Surprenant wrote:
&gt;&gt; &gt;
&gt;&gt; &gt;&gt; Hi,
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Actually, they're not timeout error but Not Found errors for a bunch
&gt;&gt; &gt;&gt; of keys that have been stored without error while the cluster is
&gt;&gt; &gt;&gt; rebalancing.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Is it "normal" to see Not Found errors while the cluster is
&gt;&gt; &gt;&gt; rebalancing? If not, what is my problem here? Is it a problem to
&gt;&gt; &gt;&gt; insert new keys while the cluster is rebalancing?
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Again, I cannot find any error report other that riak-admin failing
&gt;&gt; &gt;&gt; with a timeout as described below.
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Any help/hints approciated, thanks!
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Colin
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; On Mon, Dec 20, 2010 at 2:50 PM, Colin Surprenant
&gt;&gt; &gt;&gt;  wrote:
&gt;&gt; &gt;&gt;&gt; Hi,
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; I just added a 4th node in my 0.10.1 + innostore cluster and I am
&gt;&gt; &gt;&gt;&gt; seeing all kind of timeouts both for retrieving objects and trying to
&gt;&gt; &gt;&gt;&gt; execute riak-admin status which gives me:
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; RPC to 'r...@x.x.x' failed: {'EXIT',
&gt;&gt; &gt;&gt;&gt;                                     {timeout,
&gt;&gt; &gt;&gt;&gt;                                      {gen\\_server2,call,
&gt;&gt; &gt;&gt;&gt;                                       [riak\\_kv\\_stat,get\\_stats]}}}
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Also, the CPU load has seriously increased on the original 3 nodes.
&gt;&gt; &gt;&gt;&gt; The data rebalancing is quite slow.
&gt;&gt; &gt;&gt;&gt; I am not seeing anything wrong in the log files.
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Is this an indication that something is going wrong?
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;&gt; Thanks,
&gt;&gt; &gt;&gt;&gt; Colin
&gt;&gt; &gt;&gt;&gt;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; &gt;&gt; riak-users mailing list
&gt;&gt; &gt;&gt; riak-users@lists.basho.com
&gt;&gt; &gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;
&gt;

