---
title: "Re: Mac OS X install error"
description: ""
project: community
lastmod: 2010-06-11T14:43:31-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00574"
mailinglist_parent_id: "msg00562"
author_name: "Dan Reverri"
project_section: "mailinglistitem"
sent_date: 2010-06-11T14:43:31-07:00
---


Hi Allen,

To accurately verify that ".erlang" is not the cause:
1. install tsung
2. extract riak
3. run make rel
4. verify failure (ERROR: Failed to generate target from spec)
5. Remove the .erlang file
6. Repeat steps 2 and 3

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Fri, Jun 11, 2010 at 2:21 PM, Allen Kim wrote:

&gt; \\*Removed ~/.erlang file and it works good!!!!!!\\*
&gt;
&gt; ~/riak-0.11.0$ls ~/.erlang
&gt; ls: /Users/allen/.erlang: No such file or directory
&gt; ~/riak-0.11.0$make rel
&gt; abort: There is no Mercurial repository here (.hg not found)
&gt; ./rebar get-deps
&gt; ==&gt; luke (get-deps)
&gt; ==&gt; mochiweb (get-deps)
&gt; ==&gt; webmachine (get-deps)
&gt; ...
&gt; Compiled src/riak\\_kv\\_wm\\_stats.erl
&gt; Compiled src/riak\\_kv\\_wm\\_raw.erl
&gt; Compiled src/riak\\_object.erl
&gt; WARNING: 'generate' command does not apply to directory
&gt; /Users/allen/riak-0.11.0/apps/riak\\_kv
&gt; ==&gt; rel (compile)
&gt; ==&gt; rel (generate)
&gt; ==&gt; riak-0.11.0 (compile)
&gt; WARNING: 'generate' command does not apply to directory
&gt; /Users/allen/riak-0.11.0
&gt;
&gt; To verify it, put .erlang file back
&gt; ~$cat ~/.erlang
&gt; code:load\\_abs("/Users/allen/user\\_default").
&gt; ~$tar xvzf riak-0.11.0.tar.gz
&gt; ~/riak-0.11.0$make rel
&gt; abort: There is no Mercurial repository here (.hg not found)
&gt; ./rebar get-deps
&gt; ==&gt; luke (get-deps)
&gt; ==&gt; mochiweb (get-deps)
&gt; ==&gt; webmachine (get-deps)
&gt; ...
&gt; Compiled src/riak\\_kv\\_wm\\_link\\_walker.erl
&gt; Compiled src/riak\\_object.erl
&gt; Compiled src/riak\\_kv\\_wm\\_raw.erl
&gt; WARNING: 'generate' command does not apply to directory
&gt; /Users/allen/riak-0.11.0/apps/riak\\_kv
&gt; ==&gt; rel (compile)
&gt; ==&gt; rel (generate)
&gt; ==&gt; riak-0.11.0 (compile)
&gt; WARNING: 'generate' command does not apply to directory
&gt; /Users/allen/riak-0.11.0
&gt;
&gt; \\*Huh?.. it's the same as before. (.erlang is NOT the cause)\\*
&gt;
&gt; I might have been mistaken. Sorry about the misleading then.
&gt;
&gt; 1. I had R13B02 or R13B03(not sure) with tsung installed
&gt; 2. I installed erlang R13B04, installed riak, and failed because of tsung.
&gt; 3. So I tried to install tsung, but failed
&gt; 4. I removed all tsung files manually and ran 'sudo port uninstall tsung &&
&gt; sudo port clean tsung'
&gt; 5. Checked all tsung files are gone, and installed riak(it worked)
&gt;
&gt; Hope this helps.
&gt;
&gt; Allen Kim
&gt;
&gt; On 2010-06-11, at 4:47 PM, Dan Reverri wrote:
&gt;
&gt; Hi Allen,
&gt;
&gt; Can you try temporarily removing the ".erlang" file in your home directory
&gt; and testing the build again?
&gt;
&gt; We have not been able to reproduce the error with tsung installed via port.
&gt;
&gt; Thanks,
&gt; Dan
&gt;
&gt; Daniel Reverri
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; d...@basho.com
&gt;
&gt;
&gt; On Fri, Jun 11, 2010 at 1:26 PM, Allen Kim 
&gt; wrote:
&gt;
&gt;&gt; Dan,
&gt;&gt;
&gt;&gt; try "sudo port install tsung", it will install all tsung modules into your
&gt;&gt; erlang lib directory.
&gt;&gt; I think it will reproduce the error.(hope so)
&gt;&gt;
&gt;&gt; Yes, I have .erlang to use lm(),to load all module updated.
&gt;&gt; Here are the contents
&gt;&gt;
&gt;&gt; ~$cat .erlang
&gt;&gt; code:load\\_abs("/Users/allen/user\\_default").
&gt;&gt; ~$
&gt;&gt;
&gt;&gt; Here is my path to erl.
&gt;&gt;
&gt;&gt; /opt/local$which erl
&gt;&gt; /opt/local/bin/erl
&gt;&gt; /opt/local$ls -al /opt/local/bin/er\\*
&gt;&gt; -rwxr-xr-x 2 root admin 3882 8 Dec 2009 /opt/local/bin/erb
&gt;&gt; lrwxr-xr-x 1 root admin 21 4 Jun 18:11 /opt/local/bin/erl -&gt;
&gt;&gt; ../lib/erlang/bin/erl
&gt;&gt; lrwxr-xr-x 1 root admin 22 4 Jun 18:11 /opt/local/bin/erlc -&gt;
&gt;&gt; ../lib/erlang/bin/erlc
&gt;&gt;
&gt;&gt; erlang directory is not a sym link
&gt;&gt; /opt/local/lib$ls -al
&gt;&gt; total 460128
&gt;&gt; drwxr-xr-x 719 root admin 24446 11 Jun 14:18 .
&gt;&gt; drwxr-xr-x 15 root admin 510 4 Jan 14:10 ..
&gt;&gt; -rw-r--r-- 1 root admin 0 28 Sep 2009 .turd\\_MacPorts
&gt;&gt; drwxr-xr-x 4 root admin 136 4 Jan 16:02 ImageMagick-6.5.8
&gt;&gt; drwxr-xr-x 3 root admin 102 4 Jun 18:28 X11
&gt;&gt; drwxr-xr-x 3 root admin 102 20 Oct 2009 ao
&gt;&gt; drwxr-xr-x 14 root admin 476 20 Oct 2009 apr-util-1
&gt;&gt; -rw-r--r-- 2 root admin 8367 4 Jun 17:50 apr.exp
&gt;&gt; -rw-r--r-- 2 root admin 5165 20 Oct 2009 aprutil.exp
&gt;&gt; -rwxr-xr-x 2 root admin 9040 4 Jun 18:16 bindtextdomain.so
&gt;&gt; drwxr-xr-x 3 root admin 102 3 Dec 2009 bjam
&gt;&gt; drwxr-xr-x 21 root admin 714 4 Jan 14:42 db46
&gt;&gt; drwxr-xr-x 3 root admin 102 21 Oct 2009 dbus-1.0
&gt;&gt; drwxr-xr-x 12 root admin 408 3 Dec 2009 engines
&gt;&gt; drwxr-xr-x 14 root admin 476 4 Jun 18:11 erlang
&gt;&gt; ...
&gt;&gt;
&gt;&gt; Let me know if you need more.
&gt;&gt;
&gt;&gt; Allen kim
&gt;&gt;
&gt;&gt;
&gt;&gt; On 2010-06-11, at 2:54 PM, Dan Reverri wrote:
&gt;&gt;
&gt;&gt; Hi Allen,
&gt;&gt;
&gt;&gt; Is there anything of note about your system that might help us reproduce
&gt;&gt; the build error here? Are you using an symlinks in your Erlang libs folder?
&gt;&gt; Do you have a ".erlang" file defined in your home directory?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Dan
&gt;&gt;
&gt;&gt; Daniel Reverri
&gt;&gt; Developer Advocate
&gt;&gt; Basho Technologies, Inc.
&gt;&gt; d...@basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt; On Fri, Jun 11, 2010 at 11:35 AM, Sean Cribbs  wrote:
&gt;&gt;
&gt;&gt;&gt; Allen,
&gt;&gt;&gt;
&gt;&gt;&gt; The best answer we've come up with internally is that reltool (what's
&gt;&gt;&gt; used internally to rebar for part of the build process) tends to follow
&gt;&gt;&gt; certain symlinks blindly. If it's not critical for you to stay on Riak tip,
&gt;&gt;&gt; you should be able to use the binary packages without a hitch.
&gt;&gt;&gt;
&gt;&gt;&gt; Sean Cribbs 
&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;
&gt;&gt;&gt; On Jun 11, 2010, at 2:29 PM, Allen Kim wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; I removed tsung
&gt;&gt;&gt; $&gt;sudo port uninstall tsung
&gt;&gt;&gt; $&gt;sudo port clean tsung
&gt;&gt;&gt;
&gt;&gt;&gt; then, ran "make rel" command, it WORKS
&gt;&gt;&gt;
&gt;&gt;&gt; ...
&gt;&gt;&gt; Compiled src/riak\\_kv\\_wm\\_stats.erl
&gt;&gt;&gt; Compiled src/riak\\_kv\\_wm\\_link\\_walker.erl
&gt;&gt;&gt; Compiled src/riak\\_object.erl
&gt;&gt;&gt; Compiled src/riak\\_kv\\_wm\\_raw.erl
&gt;&gt;&gt; WARNING: 'generate' command does not apply to directory
&gt;&gt;&gt; /Users/allen/riak-0.11.0/apps/riak\\_kv
&gt;&gt;&gt; ==&gt; rel (compile)
&gt;&gt;&gt; ==&gt; rel (generate)
&gt;&gt;&gt; ==&gt; riak-0.11.0 (compile)
&gt;&gt;&gt; WARNING: 'generate' command does not apply to directory
&gt;&gt;&gt; /Users/allen/riak-0.11.0
&gt;&gt;&gt; ~/riak-0.11.0$
&gt;&gt;&gt;
&gt;&gt;&gt; However when I installed tsung(which installs tsung, tsung\\_recorder, and
&gt;&gt;&gt; tsung\\_controller) again, a part of erlang, it does not work(the same error)
&gt;&gt;&gt;
&gt;&gt;&gt; I personally use tsung for load testing and riak will be the perfect
&gt;&gt;&gt; example of it, and I will need to install tsung later.
&gt;&gt;&gt;
&gt;&gt;&gt; I will not use tsung for a while until you fix it, and please let me know
&gt;&gt;&gt; when it is fixed.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks for your hard work
&gt;&gt;&gt;
&gt;&gt;&gt; Allen Kim
&gt;&gt;&gt;
&gt;&gt;&gt; On 2010-06-11, at 1:40 PM, Dan Reverri wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; Hi Allen,
&gt;&gt;&gt;
&gt;&gt;&gt; When generating a release package with rebar the intention is to create a
&gt;&gt;&gt; fully independent release package that runs without any external
&gt;&gt;&gt; dependencies. During the release generation rebar will analyze the
&gt;&gt;&gt; specification of an application to determine dependencies. The tool will
&gt;&gt;&gt; then collect all the dependencies (including those from the system level
&gt;&gt;&gt; Erlang installation) and package them into a release. Tsung is not part of
&gt;&gt;&gt; the riak dependency specification and should not be pulled into the release.
&gt;&gt;&gt; My guess is that macports has configured Erlang in such a way that the Tsung
&gt;&gt;&gt; library is included in all releases. We have to look into this a bit further
&gt;&gt;&gt; and try to reproduce the issue locally.
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Dan
&gt;&gt;&gt;
&gt;&gt;&gt; Daniel Reverri
&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; d...@basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Fri, Jun 11, 2010 at 10:11 AM, Allen Kim &lt;
&gt;&gt;&gt; allen....@epicadvertising.com&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; If it helps, ts\\_client\\_proxy.beam file is not in tsung-1.3.1 folder but
&gt;&gt;&gt;&gt; in tsung\\_recorder-1.3.1, Don't know how to fix it though
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; /opt/local/lib/erlang/lib/tsung\\_recorder-1.3.1/ebin$ls
&gt;&gt;&gt;&gt; ts\\_client\\_proxy.beam ts\\_client\\_proxy\\_sup.beam ts\\_proxy\\_http.beam
&gt;&gt;&gt;&gt; ts\\_proxy\\_listener.beam ts\\_proxy\\_pgsql.beam ts\\_proxy\\_recorder.beam
&gt;&gt;&gt;&gt; ts\\_proxy\\_webdav.beam ts\\_recorder\\_sup.beam tsung\\_recorder.app
&gt;&gt;&gt;&gt; tsung\\_recorder.beam
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Allen Kim
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ==&gt; rel (generate)
&gt;&gt;&gt;&gt; ERROR: Failed to generate target from spec: "copy file
&gt;&gt;&gt;&gt; /opt/local/lib/erlang/lib/tsung-1.3.1/ebin/ts\\_client\\_proxy.beam -&gt;
&gt;&gt;&gt;&gt; /Users/allen/riak-0.11.0/rel/riak/lib/tsung-1.3.1/ebin/ts\\_client\\_proxy.beam:
&gt;&gt;&gt;&gt; no such file or directory\\n"
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 2010-06-11, at 12:31 PM, Allen Kim wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; information of erlang installed if helps
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; /opt/local/lib/erlang/bin$port installed erlang
&gt;&gt;&gt;&gt; The following ports are currently installed:
&gt;&gt;&gt;&gt; erlang @R13B02\\_2+darwin\\_10
&gt;&gt;&gt;&gt; erlang @R13B02\\_3+darwin\\_10
&gt;&gt;&gt;&gt; erlang @R13B03\\_0+darwin\\_10
&gt;&gt;&gt;&gt; erlang @R13B04\\_0+darwin\\_10 (active)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 2010-06-11, at 12:20 PM, Dan Reverri wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi Allen,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Sorry for not being more clear. You have to run the generate command
&gt;&gt;&gt;&gt; against a compiled folder.
&gt;&gt;&gt;&gt; make all
&gt;&gt;&gt;&gt; ./rebar -v generate
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt; Dan
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Daniel Reverri 
&gt;&gt;&gt;&gt; Developer Advocate
&gt;&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt;&gt; http://basho.com/
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

