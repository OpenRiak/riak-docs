---
title: "Re: Pass json as argument to mapreduce"
description: ""
project: community
lastmod: 2012-07-05T07:29:41-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07865"
mailinglist_parent_id: "msg07863"
author_name: "Venki Yedidha"
project_section: "mailinglistitem"
sent_date: 2012-07-05T07:29:41-07:00
---


Thanks,
 I tried the format you sent me earlier but when I tried to access the
args parameter inside the function, it is showing me the error:

{"inputs":['.$k.'],"query":[{"map":{"language":"javascript","source":"function(value,keydata,"arguments"){
var data = Riak.mapValuesJson(value)[0];
 var obj = {};
 obj[value.key] = {};
 for(var i=1;i&lt;3;i++)
 {
 var gender = \\"G\\"+ i;
 obj[value.key][gender] = {};
 for(var j=1;j&lt;=6;j++)
 {
 var agegroup = \\"A\\" + j;
 obj[value.key][gender][agegroup] = {};
 obj[value.key][gender][agegroup][\\"cpc\\_median\\"] =
data[gender][j][agegroup][\\"bid\\_estimations\\"][0][\\"cpc\\_median\\"];
 obj[value.key][gender][agegroup][\\"users\\"] =
data[gender][j][agegroup][\\"users\\"];

 }
 }
 return [obj];

}","args":{"gender":"G0,G1","agegroups":"A0,A2","metrics":"users,cpc\\_median","groupby":"country"},"keep":true}}]}';


Please help me on the above.

To clarify my requirement, I would like to access the args parameter
(before keep parameter) inside javascript function and if possible I would
also like to know the flow that what is the need for args param after js
function.

Thanks,
Venkatesh.Y

On Wed, Jul 4, 2012 at 2:11 PM, Mathias Meyer  wrote:

&gt; Venki,
&gt;
&gt; You don't have to serialize the argument as a JSON string, it can simply
&gt; be specified as a normal JSON data structure, just like the other data in
&gt; the MapReduce request:
&gt;
&gt; curl -v -d '{"inputs":[["artists", "Beatles"]],
&gt; "query":[{"map":{"language":"javascript","source":"function(v, k, a)
&gt; {return [a];}","arg":{"paul": true}}}]}' -H "Content-Type:
&gt; application/json" http://127.0.0.1:8098/mapred
&gt;
&gt; Cheers, Mathias
&gt; http://riakhandbook.com
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; On Wednesday, 4. July 2012 at 07:26, Venki Yedidha wrote:
&gt;
&gt; &gt; Hi all,
&gt; &gt; I don't know why, I can't pass a json argument to map function.
&gt; &gt;
&gt; &gt;
&gt; &gt; "inputs":"[b1,k1],[b2,k2],[b3,k3]"
&gt; &gt;
&gt; "query":[{map":{"language":"javascript","source":"function(value,keydata,args){}"
&gt; &gt;
&gt; &gt; for the args parameter I need to pass json of the form:
&gt; &gt; {\\"name\\":\\"venkatesh\\",\\"age\\":24}
&gt; &gt; (escaped " for json)
&gt; &gt; but it showing missing variable name..
&gt; &gt; On the other, If I am passing an array, it is not showing the error...
&gt; &gt; Please help me on the above.
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Venkatesh
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

