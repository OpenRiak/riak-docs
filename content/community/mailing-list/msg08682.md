---
title: "Re: transfers failing lookup_timeout"
description: ""
project: community
lastmod: 2012-09-24T12:47:23-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08682"
mailinglist_parent_id: "msg08677"
author_name: "Rich Sutton"
project_section: "mailinglistitem"
sent_date: 2012-09-24T12:47:23-07:00
---


More information ...

These errors come about a minute before the errors below:

2012-09-24 12:45:15.607 [info]
&lt;0.6099.0&gt;@riak\\_core\\_handoff\\_sender:start\\_fold:126 Starting
ownership\\_handoff transfer of riak\\_search\\_vnode from '
r...@sylvester.soiq.net' 1096126227998177188652763624537212264741949407232
to 'r...@daffyduck.soiq.net'
1096126227998177188652763624537212264741949407232
2012-09-24 12:45:15.607 [info]
&lt;0.6098.0&gt;@riak\\_core\\_handoff\\_sender:start\\_fold:126 Starting
ownership\\_handoff transfer of riak\\_search\\_vnode from '
r...@sylvester.soiq.net' 1004782375664995756265033322492444576013453623296
to 'r...@daffyduck.soiq.net'
1004782375664995756265033322492444576013453623296
2012-09-24 12:45:15.936 [error] &lt;0.1261.0&gt;@mi\\_server:handle\\_info:549
Unexpected info {#Port&lt;0.7254&gt;,{data,[2,0,0,0,0,0,0,0,1|&lt;&lt;128&gt;&gt;]}}
2012-09-24 12:45:16.886 [error] &lt;0.1297.0&gt;@mi\\_server:handle\\_info:549
Unexpected info {#Port&lt;0.7250&gt;,{data,[2,0,0,0,0,0,0,0,1|&lt;&lt;0&gt;&gt;]}}

Incidentally, this happens about once every minute. Some amount of memory
appears to leak, as the beam process reserved memory grows some each minute
until the kernel's OOM killer kicks in after a while.

Rich

On Mon, Sep 24, 2012 at 12:09 PM, Rich Sutton wrote:

&gt; Hi,
&gt;
&gt; I've got a two node riak cluster set up for testing. After joining the
&gt; second node to the cluster, I've got some failing transfers. Restarts on
&gt; both nodes don't resolve the situation. Any ideas?
&gt;
&gt; From error.log on transferrer node (sylvester.soiq.net):
&gt;
&gt; 2012-09-24 12:06:35.598 [error] &lt;0.3180.0&gt; gen\\_server &lt;0.3180.0&gt;
&gt; terminated with reason: bad return value: lookup\\_timeout
&gt; 2012-09-24 12:06:35.599 [error]
&gt; &lt;0.3276.0&gt;@riak\\_core\\_handoff\\_sender:start\\_fold:215 ownership\\_handoff
&gt; transfer of riak\\_search\\_vnode from 'r...@sylvester.soiq.net'
&gt; 1004782375664995756265033322492444576013453623296 to '
&gt; r...@daffyduck.soiq.net'
&gt; 1004782375664995756265033322492444576013453623296 failed because of
&gt; error:{badmatch,{error,{worker\\_crash,{bad\\_return\\_value,lookup\\_timeout},{fold,#Fun,#Fun}}}}
&gt; [{riak\\_core\\_handoff\\_sender,start\\_fold,5,[{file,"src/riak\\_core\\_handoff\\_sender.erl"},{line,161}]}]
&gt; 2012-09-24 12:06:35.617 [error]
&gt; &lt;0.3277.0&gt;@riak\\_core\\_handoff\\_sender:start\\_fold:215 ownership\\_handoff
&gt; transfer of riak\\_search\\_vnode from 'r...@sylvester.soiq.net'
&gt; 1096126227998177188652763624537212264741949407232 to '
&gt; r...@daffyduck.soiq.net'
&gt; 1096126227998177188652763624537212264741949407232 failed because of
&gt; error:{badmatch,{error,{worker\\_crash,{bad\\_return\\_value,lookup\\_timeout},{fold,#Fun,#Fun}}}}
&gt; [{riak\\_core\\_handoff\\_sender,start\\_fold,5,[{file,"src/riak\\_core\\_handoff\\_sender.erl"},{line,161}]}]
&gt; 2012-09-24 12:06:35.618 [error] &lt;0.3180.0&gt; CRASH REPORT Process &lt;0.3180.0&gt;
&gt; with 0 neighbours exited with reason: bad return value: lookup\\_timeout in
&gt; gen\\_server:terminate/6 line 747
&gt; 2012-09-24 12:06:35.709 [error] &lt;0.1293.0&gt; Supervisor poolboy\\_sup had
&gt; child riak\\_core\\_vnode\\_worker started with
&gt; {riak\\_core\\_vnode\\_worker,start\\_link,undefined} at &lt;0.3180.0&gt; exit with
&gt; reason bad return value: lookup\\_timeout in context child\\_terminated
&gt; 2012-09-24 12:06:35.730 [error] &lt;0.3181.0&gt; gen\\_server &lt;0.3181.0&gt;
&gt; terminated with reason: bad return value: lookup\\_timeout
&gt; 2012-09-24 12:06:35.753 [error] &lt;0.3181.0&gt; CRASH REPORT Process &lt;0.3181.0&gt;
&gt; with 0 neighbours exited with reason: bad return value: lookup\\_timeout in
&gt; gen\\_server:terminate/6 line 747
&gt; 2012-09-24 12:06:35.773 [error] &lt;0.1310.0&gt; Supervisor poolboy\\_sup had
&gt; child riak\\_core\\_vnode\\_worker started with
&gt; {riak\\_core\\_vnode\\_worker,start\\_link,undefined} at &lt;0.3181.0&gt; exit with
&gt; reason bad return value: lookup\\_timeout in context child\\_terminated
&gt;
&gt;
&gt; rich@daffyduck:~$ sudo riak-admin member-status
&gt; Attempting to restart script through sudo -H -u riak
&gt; ================================= Membership
&gt; ==================================
&gt; Status Ring Pending Node
&gt;
&gt; -------------------------------------------------------------------------------
&gt; valid 37.5% 50.0% 'r...@daffyduck.soiq.net'
&gt; valid 62.5% 50.0% 'r...@sylvester.soiq.net'
&gt;
&gt; -------------------------------------------------------------------------------
&gt; Valid:2 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt;
&gt; rich@daffyduck:~$ sudo riak-admin transfers
&gt; Attempting to restart script through sudo -H -u riak
&gt; 'r...@daffyduck.soiq.net' waiting to handoff 8 partitions
&gt;
&gt; Active Transfers:
&gt;
&gt; transfer type: ownership\\_handoff
&gt; vnode type: riak\\_search\\_vnode
&gt; partition: 1004782375664995756265033322492444576013453623296
&gt; started: 2012-09-24 18:24:41 [-81984015.00 us ago]
&gt; last update: no updates seen
&gt; objects transferred: unknown
&gt;
&gt; unknown
&gt; riak@sylvester.s =======================&gt; riak@daffyduck.s
&gt; unknown
&gt;
&gt; transfer type: ownership\\_handoff
&gt; vnode type: riak\\_search\\_vnode
&gt; partition: 1096126227998177188652763624537212264741949407232
&gt; started: 2012-09-24 18:24:51 [-91982788.00 us ago]
&gt; last update: no updates seen
&gt; objects transferred: unknown
&gt;
&gt; unknown
&gt; riak@sylvester.s =======================&gt; riak@daffyduck.s
&gt; unknown
&gt;
&gt; Rich
&gt;
&gt;


-- 
Rich Sutton
CTO / VP of Engineering
socialiqnetworks.com
mobile 714-318-7737
