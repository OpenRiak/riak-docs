---
title: "Re: Riak 0.11.0 hanging on OSX 10.6"
description: ""
project: community
lastmod: 2010-07-19T06:40:34-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00743"
mailinglist_parent_id: "msg00742"
author_name: "Shane Holloway"
project_section: "mailinglistitem"
sent_date: 2010-07-19T06:40:34-07:00
---


Thanks -- ulimit -n 1024 fixed my problem. It's wonderfully stable now -- even 
under high load.


On Jul 19, 2010, at 2:30 AM, Daniel Reverri wrote:

&gt; Hi Shane,
&gt; 
&gt; Can you try increasing the number of allowed open file handles on your system?
&gt; ulimit -n 1024
&gt; 
&gt; You can check this setting from a riak console by typing:
&gt; os:cmd("ulimit -a").
&gt; 
&gt; Thanks,
&gt; Dan
&gt; 
&gt; Sent from my iPhone
&gt; 
&gt; On Jul 18, 2010, at 10:32 PM, Shane Holloway  wrote:
&gt; 
&gt;&gt; I'm having a bit of a problem with Riak. When I keep my new documents to 
&gt;&gt; about 10 per second, Riak works fine. But as I increase my speed to about 
&gt;&gt; 100 docs per second, Riak gets dramatically slow. After a while, the beam 
&gt;&gt; process takes 100% of my CPU and no longer responds to ping/stop or any 
&gt;&gt; other command from the bin folder. I end up sending kill TERM to stop the 
&gt;&gt; process. 
&gt;&gt; 
&gt;&gt; If I restart Riak, the bitcask backend seems to be limited to about 1-2 
&gt;&gt; document stores per second, but read seems fairly responsive still. I'd 
&gt;&gt; appreciate any thoughts or troubleshooting tips you may have. It's an 
&gt;&gt; in-development database with demo data, so I can run any experiments you'd 
&gt;&gt; like to see.
&gt;&gt; 
&gt;&gt; Thanks,
&gt;&gt; -Shane
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; Riak/riakOne% ./bin/riak-admin status
&gt;&gt; 1-minute stats for 'r...@172.20.0.49'
&gt;&gt; -------------------------------------------
&gt;&gt; vnode gets : 104
&gt;&gt; vnode\\_puts : 103
&gt;&gt; vnode\\_gets\\_total : 136
&gt;&gt; vnode\\_puts\\_total : 127
&gt;&gt; node\\_gets : 36
&gt;&gt; node\\_gets\\_total : 47
&gt;&gt; node\\_get\\_fsm\\_time\\_mean : 2635.1111111111113
&gt;&gt; node\\_get\\_fsm\\_time\\_median : 667
&gt;&gt; node\\_get\\_fsm\\_time\\_95 : 9156
&gt;&gt; node\\_get\\_fsm\\_time\\_99 : 40652
&gt;&gt; node\\_get\\_fsm\\_time\\_100 : 40652
&gt;&gt; node\\_puts : 36
&gt;&gt; node\\_puts\\_total : 44
&gt;&gt; node\\_put\\_fsm\\_time\\_mean : 1670575.611111111
&gt;&gt; node\\_put\\_fsm\\_time\\_median : 1157
&gt;&gt; node\\_put\\_fsm\\_time\\_95 : 23900
&gt;&gt; node\\_put\\_fsm\\_time\\_99 : 60000511
&gt;&gt; node\\_put\\_fsm\\_time\\_100 : 60000511
&gt;&gt; cpu\\_nprocs : 0
&gt;&gt; cpu\\_avg1 : 0
&gt;&gt; cpu\\_avg5 : 0
&gt;&gt; cpu\\_avg15 : 0
&gt;&gt; mem\\_total : 0
&gt;&gt; mem\\_allocated : 0
&gt;&gt; disk : [{"none",0,0}]
&gt;&gt; nodename : 'r...@172.20.0.49'
&gt;&gt; connected\\_nodes : ['riak\\_maint\\_61...@172.20.0.49']
&gt;&gt; sys\\_driver\\_version : &lt;&lt;"1.5"&gt;&gt;
&gt;&gt; sys\\_global\\_heaps\\_size : 0
&gt;&gt; sys\\_heap\\_type : private
&gt;&gt; sys\\_logical\\_processors : 2
&gt;&gt; sys\\_otp\\_release : &lt;&lt;"R13B04"&gt;&gt;
&gt;&gt; sys\\_process\\_count : 167
&gt;&gt; sys\\_smp\\_support : true
&gt;&gt; sys\\_system\\_version : &lt;&lt;"Erlang R13B04 (erts-5.7.5) [source] [64-bit] 
&gt;&gt; [smp:2:2] [rq:2] [async-threads:5] [hipe] [kernel-poll:true]\\n"&gt;&gt;
&gt;&gt; sys\\_system\\_architecture : &lt;&lt;"i386-apple-darwin9.4.0"&gt;&gt;
&gt;&gt; sys\\_threads\\_enabled : true
&gt;&gt; sys\\_thread\\_pool\\_size : 5
&gt;&gt; sys\\_wordsize : 8
&gt;&gt; ring\\_members : ['r...@172.20.0.49']
&gt;&gt; ring\\_num\\_partitions : 64
&gt;&gt; ring\\_ownership : &lt;&lt;"[{'r...@172.20.0.49',64}]"&gt;&gt;
&gt;&gt; ring\\_creation\\_size : 64
&gt;&gt; storage\\_backend : riak\\_kv\\_bitcask\\_backend
&gt;&gt; pbc\\_connects\\_total : 0
&gt;&gt; pbc\\_connects : 0
&gt;&gt; pbc\\_active : 0
&gt;&gt; 

