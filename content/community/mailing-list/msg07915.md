---
title: "Re: reg. storageon Localfile system"
description: ""
project: community
lastmod: 2012-07-12T09:54:12-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07915"
mailinglist_parent_id: "msg07913"
author_name: "Alexander Sicular"
project_section: "mailinglistitem"
sent_date: 2012-07-12T09:54:12-07:00
---


First of all, when dealing with large csv files I always use split to
shrink them down to manageable size. That way you can do all sorts of
parallel loading tricks via bash. Google search for "unix split".

@siculars
http://siculars.posterous.com

Sent from my rotary phone.
On Jul 12, 2012 2:23 AM,  wrote:

&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; Thanks Sicular,
&gt;
&gt;
&gt;
&gt; Supervisor riak\\_core\\_vnode\\_sup had child undefined started with
&gt; riak\\_core\\_vnode:start\\_link() at undefined exit with reason
&gt; {timeout,{gen\\_server,call,[&lt;0.1164.0&gt;,stop]}} in context shutdown\\_error…
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; trying to insert csv data of 434 MB onto 2 node riak cluster….iam getting
&gt; the following error ..could you please share the reason for the same
&gt;
&gt; …Thanks In advance . attached app.config for your reference .
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; This is my another quest need your valuable suggestion please
&gt;
&gt; Dear team,
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; FYI:we have a 4 quad core intel processor on each server on 2 node
&gt; cluster with more than 1 TB of storage
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; I Ihave constructed the 2 node physical machine riak cluster with n\\_val
&gt; 2 and my app.config ,vm.args are attached for your reference..
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Please tell me where the bulk inserted data onto riak db gets stored on
&gt; Local file system…its taking huge time to load small size itself…how to
&gt; tune it to perform to large scale since we deal wit hbigdata of in few
&gt; hungred GB’s?????????????????
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Cmd used:time ./load\\_data1m Customercalls1m.csv
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; ./load\\_data100m CustomerCalls100m(got this error so changed default
&gt; config of app.config…from 8 MB to 3072 MB
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; escript: exception error: no match of right hand side value
&gt; {error,enoent}
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; size
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Load time
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; No of mappersonapp.config
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Js-max-vm-mem on app.config
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Js-thread-stack
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; \\*&gt; y this much time for small data \\*
&gt;
&gt; &gt;
&gt;
&gt; &gt; 100k(10,lakhrows)—5 MB takes
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 20m39.625 seconds
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 48
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 3 GB 3072MB(changedfromdefault 8MB)since i/p data is large)
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 3 GB 3072MB(changedfromdefault 8MB)since i/p data is large)
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 1millionrows---54 MB takes
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 198m42.375seconds
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 48
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 3 GB 3072MB(changedfromdefault 8MB)since i/p data is large)
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; 3 GB 3072MB(changedfromdefault 8MB)since i/p data is large)
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; .
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; ./load\\_data script used:
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; #!/usr/local/bin/escript
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; main([Filename]) -&gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; {ok, Data} = file:read\\_file(Filename),
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Lines = tl(re:split(Data, "\\r?\\n", [{return, binary},trim])),
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; lists:foreach(fun(L) -&gt; LS = re:split(L, ","), format\\_and\\_insert(LS)
&gt; end, Lines).
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; format\\_and\\_insert(Line) -&gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; JSON =
&gt; io\\_lib:format("{\\"id\\":\\"~s\\",\\"phonenumber\\":~s,\\"callednumber\\":~s,\\"starttime\\":~s,\\"endtime\\":~s,\\"status\\":~s}",
&gt; Line),
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Command = io\\_lib:format("curl -X PUT
&gt; http://10.232.5.169:8098/riak/CustomerCalls100k/~s -d '~s' -H
&gt; 'content-type: application/json'", [hd(Line),JSON]),
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; io:format("Inserting: ~s~n", [hd(Line)]),
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; os:cmd(Command).
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Thanks in advance!!!!!!!!!!waiting fr the reply…plz anyone help..struck
&gt; u pwit hbulk loading…..and make me clear how riak splits the data and gets
&gt; loaded on cluster
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; Thanks & regards
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; sangeetha
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt; &gt; This e-mail and any files transmitted with it are for the sole use of
&gt; the intended recipient(s) and may contain confidential and privileged
&gt; information. If you are not the intended recipient(s), please reply to the
&gt; sender and destroy all copies of the original message. Any unauthorized
&gt; review, use, disclosure, dissemination, forwarding, printing or copying of
&gt; this email, and/or any action taken in reliance on the contents of this
&gt; e-mail is strictly prohibited and may be unlawful.
&gt;
&gt; &gt;
&gt;
&gt; &gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; Regards
&gt;
&gt; Sangeetha
&gt;
&gt;
&gt;
&gt; \\*From:\\* Alexander Sicular [mailto:sicul...@gmail.com]
&gt; \\*Sent:\\* Thursday, July 12, 2012 11:30 AM
&gt; \\*To:\\* Pattabi Raman, Sangeetha (Cognizant)
&gt; \\*Cc:\\* riak-users@lists.basho.com
&gt; \\*Subject:\\* Re: reg. storageon Localfile system
&gt;
&gt;
&gt;
&gt; check your installations app.config file in the etc folder.
&gt;
&gt; @siculars
&gt; http://siculars.posterous.com
&gt;
&gt; Sent from my rotary phone.
&gt;
&gt; On Jul 11, 2012 11:18 PM,  wrote:
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; Hi team,
&gt;
&gt;
&gt;
&gt; Iam very new to riak ,can anyone say on loading onto riak
&gt; db 2 node cluster …where does it puts the data on the Local file
&gt; system.like we see on autosharding of mongodb or hadoop-hdfs over shards in
&gt; the cluster mode ….as in which of riak……………………
&gt;
&gt; FYI:
&gt;
&gt; I use curl in loading the same
&gt;
&gt;
&gt;
&gt; -module(time).
&gt;
&gt; -export([starttime/0]).
&gt;
&gt; -export([main/1]).
&gt;
&gt; -export([format\\_and\\_insert/1]).
&gt;
&gt; -export([endtime/0]).
&gt;
&gt; starttime() -&gt;
&gt;
&gt; starttime = {{Year,Month,Day},{Hour,Min,Sec}} = erlang:localtime().
&gt;
&gt; main([Filename]) -&gt;
&gt;
&gt; {ok, Data} = file:read\\_file(Filename),
&gt;
&gt; Lines = tl(re:split(Data, "\\r?\\n", [{return, binary},trim])),
&gt;
&gt; lists:foreach(fun(L) -&gt; LS = re:split(L, ","), format\\_and\\_insert(LS)
&gt; end, Lines).
&gt;
&gt;
&gt;
&gt; format\\_and\\_insert(Line) -&gt;
&gt;
&gt; JSON =
&gt; io\\_lib:format("{\\"id\\":\\"~s\\",\\"phonenumber\\":~s,\\"callednumber\\":~s,\\"starttime\\":~s,\\"endtime\\":~s,\\"status\\":~s}",
&gt; Line),
&gt;
&gt; Command = io\\_lib:format("curl -X PUT
&gt; http://10.232.5.169:8098/riak/goog1/~s -d '~s' -H 'content-type:
&gt; application/json'", [hd(Line),JSON]),
&gt;
&gt; io:format("Inserting: ~s~n", [hd(Line)]),
&gt;
&gt; os:cmd(Command).
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; Thanks & regards
&gt;
&gt; sangeetha
&gt;
&gt;
&gt;
&gt; This e-mail and any files transmitted with it are for the sole use of the
&gt; intended recipient(s) and may contain confidential and privileged
&gt; information. If you are not the intended recipient(s), please reply to the
&gt; sender and destroy all copies of the original message. Any unauthorized
&gt; review, use, disclosure, dissemination, forwarding, printing or copying of
&gt; this email, and/or any action taken in reliance on the contents of this
&gt; e-mail is strictly prohibited and may be unlawful.
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; This e-mail and any files transmitted with it are for the sole use of
&gt; the intended recipient(s) and may contain confidential and privileged
&gt; information. If you are not the intended recipient(s), please reply to the
&gt; sender and destroy all copies of the original message. Any unauthorized
&gt; review, use, disclosure, dissemination, forwarding, printing or copying of
&gt; this email, and/or any action taken in reliance on the contents of this
&gt; e-mail is strictly prohibited and may be unlawful.
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

