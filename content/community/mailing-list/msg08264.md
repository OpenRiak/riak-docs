---
title: "Re: LevelDB memory problem crashes Erlang"
description: ""
project: community
lastmod: 2012-08-10T18:45:19-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08264"
mailinglist_parent_id: "msg08261"
author_name: "Philipp Borgers"
project_section: "mailinglistitem"
sent_date: 2012-08-10T18:45:19-07:00
---


Seems like you don't have enough RAM. If you do a lot of inserts this
seems to be normal. I had this issue while benchmarking riak with
basho\\_bench. You should add limit for the requests per second in your
script. Take a look at the memory profile of the erlang process (htop,
dstat) while importing data.

Regards

Philipp

On Fri, 2012-08-10 at 13:36 -0700, leonickel wrote:
&gt; Hi all,
&gt; 
&gt; I'm facing a weird problem using eleveldb store option data. The amount of
&gt; memory starts to increase while i'm running a script to put data inside
&gt; riak, nearly 10 million of keys in a single bucket and suddenly riak process
&gt; crashes. My object is in json format and is about 1.5 kb each. At the
&gt; momment of running script, the proccess memory (beam.smp) increases to about
&gt; 450mb and then the Erlang crashes. I've got this message on logs:
&gt; 
&gt; terminate called after throwing an instance of 'std::bad\\_alloc'
&gt; what(): std::bad\\_alloc
&gt; Erlang has closed
&gt; /usr/lib/riak/lib/os\\_mon-2.2.9/priv/bin/memsup: Erlang has closed. 
&gt; 
&gt; In my script i'm using java client and sending requests over http protocol.
&gt; 
&gt; Here are some more information about my environment and riak configs:
&gt; 
&gt; - erlang version: R14B03;
&gt; - os: Ubuntu 11.04;
&gt; 
&gt; - single node;
&gt; - n\\_val = 1 (i've tried default value 3 and got the same behavior);
&gt; - ring\\_creation\\_size = 64
&gt; - allow\\_mult = false;
&gt; - last\\_write\\_wins = true;
&gt; - r = 1;
&gt; - w = 1;
&gt; 
&gt; I've done the same test using bitcask configuration and works fine, i could
&gt; put all my 10 million keys.
&gt; 
&gt; Can anyone help me with this?
&gt; 
&gt; Thanks in advance,
&gt; 
&gt; Leo
&gt; 
&gt; 
&gt; 
&gt; 
&gt; --
&gt; View this message in context: 
&gt; http://riak-users.197444.n3.nabble.com/LevelDB-memory-problem-crashes-Erlang-tp4024974.html
&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt; 

signature.asc
Description: This is a digitally signed message part
