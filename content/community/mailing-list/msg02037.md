---
title: "Re: Erlang API vs Erlang PBC"
description: ""
project: community
lastmod: 2011-01-21T04:12:36-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02037"
mailinglist_parent_id: "msg02036"
author_name: "David Dawson"
project_section: "mailinglistitem"
sent_date: 2011-01-21T04:12:36-08:00
---


I am not sure if this is any help but I have uploaded a protocol buffer pool 
client for riak which requires you to pass a client\\_id for each operation.

https://github.com/DangerDawson/riakc\\_pb\\_pool

It is very very basic, but does most of the useful things:

 - put / get / delete
 - riak disconnects, 
 - Clients that die after leasing a riak connection ( connection is 
returned to the pool )
 - Dynamically increasing the size of the connection pool
 - Queueing requests if there are no connections available
 - Useful Statistics

Of course the documentation is very sparse and needs improving, which I will 
get round to.

Dave


On 21 Jan 2011, at 00:43, Bob Ippolito wrote:

&gt; Another issue we've run into is that the Erlang native client allows
&gt; you to store non-binary values, which can not be accessed from the
&gt; PBC.... so if you're not careful or don't know better, you'll be in
&gt; for some migration if you're trying to use other clients.
&gt; 
&gt; The only real problem is that the PBC needs some additional software
&gt; around it to pool connections, where the Erlang native client got that
&gt; for free because it was leveraging Erlang distribution.
&gt; 
&gt; On Fri, Jan 21, 2011 at 3:57 AM, Ryan Maclear  wrote:
&gt;&gt; Agreed. So it therefore makes sense to start using the PBC from the outset, 
&gt;&gt; allowing for future moving of the client app off any cluster node(s) it 
&gt;&gt; might be residing on, as well as not being affecting by any subtle changes 
&gt;&gt; to the internals of the riak\\_kv code base (specifically the non-PB modules).
&gt;&gt; 
&gt;&gt; On 20 Jan 2011, at 9:37 PM, Mojito Sorbet wrote:
&gt;&gt; 
&gt;&gt;&gt; To me the major concern is that if you use the native (non-PB)
&gt;&gt;&gt; interface, your application cluster and the Riak cluster become merged
&gt;&gt;&gt; into one big Erlang cluster. The number of TCP connections can start
&gt;&gt;&gt; getting out of hand, and the work put on the cluster manager starts to
&gt;&gt;&gt; become significant.
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; 
&gt;&gt; 
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

