---
title: "Re: Riak on EC2, security etc"
description: ""
project: community
lastmod: 2010-08-31T14:46:01-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00995"
mailinglist_parent_id: "msg00994"
author_name: "Timothy Perrett"
project_section: "mailinglistitem"
sent_date: 2010-08-31T14:46:01-07:00
---


Yeah thats a nice trick - I wasn't aware of that header :-)

Cheers, Tim

On 31 Aug 2010, at 22:41, francisco treacy wrote:

&gt; Hi Tim,
&gt; 
&gt; The nginx trick is to send an 'X-Accel-Redirect' header from your app
&gt; code, which will cause an internal redirect within nginx - and so use
&gt; it to serve the resource.
&gt; 
&gt; In my node app this is what I've got:
&gt; 
&gt; # here i check for authorization credentials
&gt; response.header 'X-Accel-Redirect', "/riak/assets/#{asset\\_id}" #
&gt; sets the header
&gt; response.send '' # sends an empty body
&gt; 
&gt; The nginx config:
&gt; 
&gt; location /riak/ {
&gt; internal;
&gt; proxy\\_pass http://127.0.0.1:8098/riak/;
&gt; }
&gt; 
&gt; will serve http://127.0.0.1:8098/riak/assets/#{asset\\_id} directly from Riak.
&gt; 
&gt; 
&gt; 2010/8/31 Timothy Perrett :
&gt;&gt; wow! where can one obtain a recording of this webinar? very interested in 
&gt;&gt; the NGINX element of this.
&gt;&gt; 
&gt;&gt; Cheers, Tim
&gt;&gt; 
&gt;&gt; On 31 Aug 2010, at 18:59, Sean Cribbs wrote:
&gt;&gt; 
&gt;&gt;&gt; A number of Basho customers and open-source users alike are using Riak to 
&gt;&gt;&gt; store files. You might find the webinar I gave several weeks ago about 
&gt;&gt;&gt; Riak and Rails helpful -- it includes an example of how to store uploaded 
&gt;&gt;&gt; files in Riak and do internal redirects in nginx to serve the files 
&gt;&gt;&gt; directly from Riak.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt; 
