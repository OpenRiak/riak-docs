---
title: "Re: Memory footprint"
description: ""
project: community
lastmod: 2010-10-08T08:17:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01234"
mailinglist_parent_id: "msg01232"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-10-08T08:17:08-07:00
---


Tony,

Your assumption is correct - each node only has the keys that it stores 
replicas of.

Keep in mind that memory is used for other things than keys; the estimate given 
in that capacity planning spreadsheet is a baseline. In general, you'll want a 
decent amount above Riak's resident size for filesystem cache (which will boost 
performance for hot keys). For reference, we've found a 5 node cluster, 256 
partitions, with 30 million keys stored (and N=3) will consume around 1.6GB per 
node, and then easily fill up the rest of RAM with filesystem cache when under 
load.

With respect to your capacity planning, you'll generally get best performance 
if the number of nodes exceeds the N value, since this decreases the percentage 
of the cluster involved in each request. For example, at cluster size 3, every 
node will be involved in almost all requests. At 4 nodes, this decreases to 
roughly 75%. At 6, it becomes about 50%.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Oct 8, 2010, at 10:11 AM, Tony Novak wrote:

&gt; Quick question about Riak's memory footprint: I know that Bitcask
&gt; requires all keys to fit in memory. Does this mean only the keys that
&gt; reside on a given node, or does each node hold the keys of the entire
&gt; system? I assume it's the former, but I just want to be sure.
&gt; 
&gt; Basically what I'm trying to figure out is whether we should expect
&gt; better performance from a cluster of N nodes with 2\\*M GB of memory
&gt; each, or 2\\*N nodes with M GB each.
&gt; 
&gt; Thanks!
&gt; Tony Novak
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

