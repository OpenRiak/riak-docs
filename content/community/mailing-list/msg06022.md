---
title: "Re: Concurrent use of PCB Erlang Client"
description: ""
project: community
lastmod: 2011-12-21T11:07:28-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06022"
mailinglist_parent_id: "msg06020"
author_name: "Ciprian Dorin Craciun"
project_section: "mailinglistitem"
sent_date: 2011-12-21T11:07:28-08:00
---


On Wed, Dec 21, 2011 at 21:04, Ciprian Dorin Craciun
 wrote:
&gt; On Thu, Dec 15, 2011 at 17:42, Jeremy Raymond  wrote:
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; Are calls to the client riakc\\_pb\\_socket server blocking if I'm reusing the
&gt;&gt; same Pid across multiple threads? The pb\\_socket server will only process one
&gt;&gt; request at a time?
&gt;&gt;
&gt;&gt; --
&gt;&gt; Jeremy


 (The pevious email was "truncated"... :) )

    Disclaimer: I've only roughly used the `riak\\_erlang\\_client` library,
so take my opinion with a grain of "doubt".

    From what I've seen by quickly looking into the Erlang code, it seems that:
    \\* one request will block the client process (as it uses normal
 `gen\\_server:call` function);
    \\* but two requests from different processes don't "block" the
 `riakc\\_pb\\_socket` process, as
    \\* internally there is a queue of pending requests, handled in FIFO way;
    \\* but if a lot of requests queue there and stay more than the
timeout option for `gen\\_server:call` I think they are still going to
be serviced way after you've received a timeout error in your code;
(this has to be investigated);

 My solution is to create a pool of `riakc\\_pb\\_socket` and
round-robin through them.

 Hope this helps a bit,
 Ciprian.

