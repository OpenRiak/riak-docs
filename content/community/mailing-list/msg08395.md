---
title: "Re: riak-erlang-client issue with Riak EE 1.2"
description: ""
project: community
lastmod: 2012-08-29T12:54:59-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08395"
mailinglist_parent_id: "msg08387"
author_name: "Dave Parfitt"
project_section: "mailinglistitem"
sent_date: 2012-08-29T12:54:59-07:00
---


Hi Julian -
 The riak-erlang-client docs definitely need to be updated for search, index, 
and map/reduce. 

In the meantime, if you notice on this line:
https://github.com/basho/riak-erlang-client/blob/master/src/riakc\\_pb\\_socket.erl#L635
you'll see that the type for Options is "search\\_options()". 

You can find the definition of search\\_options() here:
https://github.com/basho/riak-erlang-client/blob/master/include/riakc.hrl#L77

and the definition for search\\_option() here:
https://github.com/basho/riak-erlang-client/blob/master/include/riakc.hrl#L122

Cheers -
Dave


On Aug 28, 2012, at 7:20 PM, Julian wrote:

&gt; Sure, I see the source code of search/\\*, but I'm kind of stuck at
&gt; figuring out the search\\_options properties and whether they can help
&gt; me or not. I've made stabs at 'rows', 'start' and 'sort' and they're
&gt; more or less the intuitive thing (although I couldn't do a reverse
&gt; sort order if I had to).
&gt; 
&gt; 
&gt; I don't see any code in riak\\_pb that sheds enlightenment; I'm guessing
&gt; that this #rpbsearchqueryrec record is just shoved into a packet and
&gt; sent to the server.
&gt; 
&gt; search\\_options([{rows, Rows} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{rows=Rows});
&gt; search\\_options([{start, Start} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{start=Start});
&gt; search\\_options([{sort, Sort} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{sort=Sort});
&gt; search\\_options([{filter, Filter} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{filter=Filter});
&gt; search\\_options([{df, DF} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{df=DF});
&gt; search\\_options([{op, OP} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{op=OP});
&gt; search\\_options([{fl, FL} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{fl=FL});
&gt; search\\_options([{presort, Presort} | Rest], Req) -&gt;
&gt; search\\_options(Rest, Req#rpbsearchqueryreq{presort=Presort});
&gt; search\\_options([{\\_, \\_} | \\_Rest], \\_Req) -&gt;
&gt; erlang:error(badarg).
&gt; 
&gt; Thanks,
&gt; Julian
&gt; 
&gt; On Tue, Aug 28, 2012 at 12:26 PM, Dave Parfitt  wrote:
&gt;&gt; Hello Julian -
&gt;&gt; 
&gt;&gt; Map-reduce is still available, it's just not what riakc\\_pb\\_socket:search/\\* 
&gt;&gt; uses under the hood anymore. Both map/reduce and Riak search functionality 
&gt;&gt; are implemented in the client using Protocol Buffers now.
&gt;&gt; 
&gt;&gt; The Map/Reduce functions are available here:
&gt;&gt; https://github.com/basho/riak-erlang-client/blob/master/src/riakc\\_pb\\_socket.erl#L454
&gt;&gt; 
&gt;&gt; and the Search functions are available here:
&gt;&gt; https://github.com/basho/riak-erlang-client/blob/master/src/riakc\\_pb\\_socket.erl#L618
&gt;&gt; 
&gt;&gt; Cheers -
&gt;&gt; Dave
