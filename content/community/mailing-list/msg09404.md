---
title: "Re: pub/sub messaging e.g. worker queue on riak?"
description: ""
project: community
lastmod: 2012-11-28T12:33:43-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09404"
mailinglist_parent_id: "msg09247"
author_name: "Mark Phillips"
project_section: "mailinglistitem"
sent_date: 2012-11-28T12:33:43-08:00
---


Hi Istvan,

I've not yet seen Riak hacked into a queue, and I suspect it's for
good reason. Your design sounds like a lot of work just to emulate the
functionality that something that like Kafka or RabbitMQ can do out of
the box (though I have to admit the "Riak as a Queue" headline on
HackerNews would be quite nice).

Out of curiosity, any chance you made a pass at it over the last few weeks?

Mark
twitter.com/pharkmillups


On Wed, Nov 7, 2012 at 11:58 PM, Istvan Soos  wrote:
&gt; Hi,
&gt;
&gt; I'm playing with the idea how Riak could be used to build a pub/sub
&gt; messaging on it. I know that there are specialized products for that,
&gt; I just find it an interesting problem to solve it with Riak only (+
&gt; not too much client code).
&gt;
&gt; The example scenario is the following:
&gt; - N producers create e.g. "task items", store it in Riak
&gt; - M workers/consumers try to complete them and after completion delete
&gt; the items from Riak
&gt; - workers choose from "one of the oldest" task items, e.g. there is a
&gt; close-to-fair scheduling (but no absolute ordering)
&gt; - workers try to not work on the same task
&gt;
&gt; In the first iteration, I'd use:
&gt; - secondary index with the actual timestamp to provide ordering
&gt; - the workers could use (hash modulo M) decision to work on a given task
&gt; - the workers periodically re-sync their status (e.g. number of active
&gt; workers) through a different bucket
&gt;
&gt; I'm not entirely convinced that this is a scalable design, but it
&gt; seems good on the design board. Does anyone have a working experience
&gt; with similar designs? Any hint that x/y/z could go wrong?
&gt;
&gt; Thanks,
&gt; Istvan
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

