---
title: "400 on idle connection"
description: ""
project: community
lastmod: 2010-06-01T18:58:20-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00483"
author_name: "Jonathan Lee"
project_section: "mailinglistitem"
sent_date: 2010-06-01T18:58:20-07:00
---


Here's a question regarding idle connection handling. Riak (actually,
mochiweb:request/2) automatically resets idle connections after 30 seconds.
 But, before closing the connection, it sends a 400 response. For example:

&gt; time telnet 127.0.0.1 8091
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
HTTP/1.1 400 Bad Request
Server: MochiWeb/1.0 (Any of you quaids got a smint?)
Date: Wed, 02 Jun 2010 01:39:41 GMT
Content-Length: 0

Connection closed by foreign host.

real 0m30.010s
user 0m0.002s
sys 0m0.004s

Is this expected behavior? At first glance, I don't see anything in the
HTTP RFC that requires or recommends this. Is there a specific reason for
sending the 400?

My reason for asking this question is that the Java client misinterprets
this final 400 and returns it for the wrong request! This can be fixed by
having a separate thread actively evict idle connections, but if this is
unexpected behavior on the server side, it'd make more sense to change it
there.

Thanks,
Jonathan
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

