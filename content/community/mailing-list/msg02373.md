---
title: "Re: 0.14 OSX riaksearch in inconsistent state"
description: ""
project: community
lastmod: 2011-02-18T08:51:29-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02373"
mailinglist_parent_id: "msg02372"
author_name: "Gary William Flake"
project_section: "mailinglistitem"
sent_date: 2011-02-18T08:51:29-08:00
---


Thanks Francisco.

Based on this hint, I succeeded in cleaning out a bucket by rewriting
a dummy value (thus forcing reindexing) and then doing the remove.

Moral of the story: install search hooks first.

-- GWF


On Fri, Feb 18, 2011 at 8:37 AM, francisco treacy
 wrote:
&gt; https://issues.basho.com/show\\_bug.cgi?id=970
&gt;
&gt; Francisco
&gt;
&gt; 2011/2/18 Gary William Flake :
&gt;&gt; I just ran a script on a my dev machine to remove everything in the
&gt;&gt; local riaksearch instance.  In the process, I found something very
&gt;&gt; strange.  Specifically, there exists objects in my instance that
&gt;&gt; cannot be deleted (I get an error whenever I try) and that always
&gt;&gt; appear with their data intact.
&gt;&gt;
&gt;&gt; Here's a specific example:
&gt;&gt;
&gt;&gt;&gt; curl 
&gt;&gt;&gt; 'http://localhost:8098/riak/clips/9ce2532a8d53b6335b1c4d3955d1267345905cac:4c8a0a1d8ef83af4be6a9aa170d6323ecba22b2f'
&gt;&gt; {"user":"9ce2532a8d53b6335b1c4d3955d1267345905cac","blob":"4c8a0a1d8ef83af4be6a9aa170d6323ecba22b2f","ctime":1297550238922,"mtime":1297550238922,"text":"something
&gt;&gt; matter gop imgur imgur com","title":"Something the matter, GOP? -
&gt;&gt; Imgur 
&gt;&gt; ","url":"http://imgur.com/Ir34G","domain":"imgur.com","tags":"","annote":"","private":1,"width":"625","height":"332","version":"0.1"}
&gt;&gt;
&gt;&gt;&gt; curl -X DELETE 
&gt;&gt;&gt; 'http://localhost:8098/riak/clips/9ce2532a8d53b6335b1c4d3955d1267345905cac:4c8a0a1d8ef83af4be6a9aa170d6323ecba22b2f'
&gt;&gt; 500 Internal Server
&gt;&gt; ErrorInternal Server Error
=====================

The server
&gt;&gt; encountered an error while processing this
&gt;&gt; request:  

```
{error,badarg,
&gt;&gt;       [{erlang,iolist_to_binary,[notfound]},
&gt;&gt;        {wrq,append_to_response_body,2},
&gt;&gt;        {riak_kv_wm_raw,delete_resource,2},
&gt;&gt;        {webmachine_resource,resource_call,3},
&gt;&gt;        {webmachine_resource,do,3},
&gt;&gt;        {webmachine_decision_core,resource_call,1},
&gt;&gt;        {webmachine_decision_core,decision,1},
&gt;&gt;        
&gt;&gt; {webmachine_decision_core,handle_request,2}]}
```


---

mochiweb+webmachine
&gt;&gt; web server


&gt;&gt;
&gt;&gt; Meanwhile, sasl-error.log shows for that last command:
&gt;&gt;
&gt;&gt;
&gt;&gt; =ERROR REPORT==== 18-Feb-2011::08:24:18 ===
&gt;&gt; webmachine error:
&gt;&gt; path="/riak/clips/9ce2532a8d53b6335b1c4d3955d1267345905cac:4c8a0a1d8ef83af4be6a9aa170d6323ecba22b2f"
&gt;&gt; {error,badarg,
&gt;&gt;       [{erlang,iolist\\_to\\_binary,[notfound]},
&gt;&gt;        {wrq,append\\_to\\_response\\_body,2},
&gt;&gt;        {riak\\_kv\\_wm\\_raw,delete\\_resource,2},
&gt;&gt;        {webmachine\\_resource,resource\\_call,3},
&gt;&gt;        {webmachine\\_resource,do,3},
&gt;&gt;        {webmachine\\_decision\\_core,resource\\_call,1},
&gt;&gt;        {webmachine\\_decision\\_core,decision,1},
&gt;&gt;        {webmachine\\_decision\\_core,handle\\_request,2}]}
&gt;&gt;
&gt;&gt; Does anyone have any ideas what is going on and how best to avoid it?
&gt;&gt; It stuff like this that terrifies me.
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; -- GWF

&gt;

