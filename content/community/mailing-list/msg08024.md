---
title: "Re: 2i with the riakc client"
description: ""
project: community
lastmod: 2012-07-22T14:02:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08024"
mailinglist_parent_id: "msg08023"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-07-22T14:02:54-07:00
---


Jeremy,

Your index field must have a "\\_bin" or "\\_int" suffix on it to signify
whether it is a binary or an integer. Add "\\_bin" to the field name you have
in your example, e.g.

MetaData = dict:store(&lt;&lt;"index"&gt;&gt;, [{&lt;&lt;"afield\\_bin"&gt;&gt;, &lt;&lt;"avalue"&gt;&gt;}],
dict:new())

On Sun, Jul 22, 2012 at 4:49 PM, Jeremy Ong  wrote:

&gt; I am trying to store objects with indexed metadata but am running into
&gt; various difficulties (commands in bold).
&gt;
&gt; \\*Obj = riakc\\_obj:new(&lt;&lt;"foo"&gt;&gt;, &lt;&lt;"bar"&gt;&gt;, &lt;&lt;"zing"&gt;&gt;).\\*
&gt; {riakc\\_obj,&lt;&lt;"foo"&gt;&gt;,&lt;&lt;"bar"&gt;&gt;,undefined,[],undefined,
&gt; &lt;&lt;"zing"&gt;&gt;}
&gt; \\*
&gt; \\*
&gt; \\*MetaData = dict:store(&lt;&lt;"index"&gt;&gt;, [{"afield", "avalue"}], dict:new()).\\*
&gt; {dict,1,16,16,8,80,48,
&gt; {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
&gt; {{[],[],[],[],[],[],[],[],[],[],[],
&gt; [[&lt;&lt;"index"&gt;&gt;,{"afield","avalue"}]],
&gt; [],[],[],[]}}}
&gt;
&gt; \\*Obj1 = riakc\\_obj:update\\_metadata(Obj, MetaData).\\*
&gt; {riakc\\_obj,&lt;&lt;"foo"&gt;&gt;,&lt;&lt;"bar"&gt;&gt;,undefined,[],
&gt; {dict,1,16,16,8,80,48,
&gt; {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],...},
&gt; {{[],[],[],[],[],[],[],[],[],[],[],[[...]],[],...}}},
&gt; &lt;&lt;"zing"&gt;&gt;}
&gt;
&gt; \\*{ok, Pid} = riakc\\_pb\\_socket:start\\_link("127.0.0.1", 8087).\\*
&gt; {ok,&lt;0.103.0&gt;}
&gt;
&gt; \\*riakc\\_pb\\_socket:put(Pid, Obj1).\\*
&gt; \\*
&gt; \\*
&gt; {error,{0,
&gt; &lt;&lt;"{precommit\\_fail,[{unknown\\_field\\_type,&lt;&lt;\\"afield\\"&gt;&gt;}]}"&gt;&gt;}}
&gt;
&gt;
&gt; I get this error when I try other things for the field name too. Any
&gt; ideas? I tried to look for documentation but nothing seems to be coming up.
&gt;
&gt; Thanks,
&gt; Jeremy
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

