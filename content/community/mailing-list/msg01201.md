---
title: "Re: Pervasive replication"
description: ""
project: community
lastmod: 2010-10-05T09:54:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01201"
mailinglist_parent_id: "msg01200"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-10-05T09:54:54-07:00
---


Make sure you set ulimit -n before starting Riak. A value of 1024 or larger is 
recommended (on OS/X the default is 256). Example:

$ ulimit -a
core file size (blocks, -c) 0
data seg size (kbytes, -d) unlimited
file size (blocks, -f) unlimited
max locked memory (kbytes, -l) unlimited
max memory size (kbytes, -m) unlimited
open files (-n) 256
pipe size (512 bytes, -p) 1
stack size (kbytes, -s) 8192
cpu time (seconds, -t) unlimited
max user processes (-u) 266
virtual memory (kbytes, -v) unlimited

$ ulimit -n 1024

This is a common cause of timeouts and connection failures on OS/X.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On Oct 5, 2010, at 12:43 PM, Alex Wolfe wrote:

&gt; I've run into a problem with Riak on my development machine, and I can't 
&gt; quite sort out what's happening. I've tried stopping the riak processes and 
&gt; restarting it back up again, but it will not service any requests.
&gt; 
&gt; Has anyone seen this before?
&gt; 
&gt; 
&gt; $ curl -v -X POST http://riak:8098/riak/test -d'{"foo":"bar"}' -H 
&gt; 'Content-Type:application/json'
&gt; \\* About to connect() to riak port 8098 (#0)
&gt; \\* Trying ::1... Connection refused
&gt; \\* Trying fe80::1... Connection refused
&gt; \\* Trying 127.0.0.1... connected
&gt; \\* Connected to riak (127.0.0.1) port 8098 (#0)
&gt;&gt; POST /riak/test HTTP/1.1
&gt;&gt; User-Agent: curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 
&gt;&gt; OpenSSL/0.9.8l zlib/1.2.3
&gt;&gt; Host: riak:8098
&gt;&gt; Accept: \\*/\\*
&gt;&gt; Content-Type:application/json
&gt;&gt; Content-Length: 13
&gt;&gt; 
&gt; &lt; HTTP/1.1 500 Internal Server Error
&gt; &lt; Vary: Accept-Encoding
&gt; &lt; Server: MochiWeb/1.1 WebMachine/1.7.1 (participate in the frantic)
&gt; &lt; Location: /riak/test/RmfYZCM8LtBPRu4gqZivu8pfVoh
&gt; &lt; Date: Tue, 05 Oct 2010 16:36:57 GMT
&gt; &lt; Content-Type: text/html
&gt; &lt; Content-Length: 713
&gt; &lt; 
&gt; 500 Internal Server ErrorInternal 
&gt; Server Error
========================

The server encountered an error while processing this 
&gt; request:  

```
{error,{error,{case_clause,{error,timeout}},
&gt;              [{riak_kv_wm_raw,accept_doc_body,2},
&gt;               {webmachine_resource,resource_call,3},
&gt;               {webmachine_resource,do,3},
&gt;               {webmachine_decision_core,resource_call,1},
&gt;               {webmachine_decision_core,accept_helper,0},
&gt;               {webmachine_decision_core,decision,1},
&gt;               {webmachine_decision_core,handle_request,2},
&gt; * Connection #0 to host riak left intact
&gt; * Closing connection #0
&gt;               
&gt; {webmachine_mochiweb,loop,1}]}}
```


---

mochiweb+webmachine web 
&gt; server


&gt; 
&gt; 
&gt; 
