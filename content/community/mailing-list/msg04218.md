---
title: "Re: In-Memory Performance"
description: ""
project: community
lastmod: 2011-08-04T07:57:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04218"
mailinglist_parent_id: "msg04215"
author_name: "Matt Savona"
project_section: "mailinglistitem"
sent_date: 2011-08-04T07:57:54-07:00
---


With Eric's suggestion, I re-ran my test using R=1, and the read
performance got much better. Those results can be seen here:
http://img59.imageshack.us/img59/2629/riakperformance2.png

If you compare Riak using the LRU cache backend and Membase, it
Membase is still roughly twice as fast for this particular test.

Not being intimately familiar Riak yet, there is definitely some small
amount of overhead per request, the sum of which becomes apparent in
my test. Basically, if you subtract network latency from my tests, and
you are working with objects that are purely resident in RAM then
whatever operations Membase must perform to retrieve an object versus
Riak seem to show that Riak is doing more work to fetch that object,
as Ryan mentioned in his email the other day.

I guess I was just naively assuming that for objects resident in
memory, regardless of the technology, retrieval times would be fairly
consistent.

If anyone has any other tips, I would definitely be interested to try
them. We have concerns about Membase presently too, though performance
is not one of them presently, my data feels "safer" in Riak and I'm
still interested to see if I can make it work the way we need.

Thanks!

- Matt

On Thu, Aug 4, 2011 at 10:23 AM, Ryan Zezeski  wrote:
&gt; On Wed, Aug 3, 2011 at 4:54 PM, Les Mikesell  wrote:
&gt;&gt;
&gt;&gt; Are you confusing membase with memcache?  The former is a persistent,
&gt;&gt; replicated store, or at least that is the claim; the latter a cache.
&gt;&gt; http://www.couchbase.org/wiki/display/membase/Membase+Architecture
&gt;&gt;
&gt;&gt; --
&gt;&gt;  Les Mikesell
&gt;&gt;   lesmikes...@gmail.com
&gt;&gt;
&gt;
&gt; Les,
&gt; You are right, I was thinking of memcached when I wrote that reply.
&gt;  However, I don't know if that changes much of what I said.  Looking at
&gt; membase docs [1,2] it is essentially a drop-in (they use the term "OTC" for
&gt; Over The Counter) replacement for shops traditional memcached deployments
&gt; but adds persistence, replication, etc (although, I thought I remember there
&gt; being two different kinds of buckets in membase, one that is persisted and
&gt; one that is not, what's the default?).  Looking at the vbucket literature it
&gt; sounds to me as if replication is something you decide to add, not on by
&gt; default [2].  Furthermore, it's a master/slave replication strategy which is
&gt; different from Riak's quorums.  For example, when doing a read against Riak
&gt; with N=3 it will \\_always\\_ contact 3 vnodes even if you set R=1 (it just
&gt; won't wait for all 3 replies).  Contrast that with membase which will only
&gt; perform a read from the master which will be less expensive because you
&gt; don't have to perform coordination on the replies.  For a membase deployment
&gt; to kinda look like a Riak one it should have 2 replicas using a one-to-many
&gt; strategy (as well as being persisted to disk).  I'd be interested to see how
&gt; the two would compare but now I'm drifting off topic a bit.
&gt; -Ryan
&gt; [1]: http://www.couchbase.org/wiki/display/membase/vBuckets
&gt; [2]: http://dustin.github.com/2010/06/29/memcached-vbuckets.html
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

