---
title: "Issue with riak_client:list_keys"
description: ""
project: community
lastmod: 2010-04-13T10:58:34-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00025"
author_name: "Alexander Zhuravlev"
project_section: "mailinglistitem"
sent_date: 2010-04-13T10:58:34-07:00
---


Hello,

We are having an issue with riak\\_client:list\\_keys function.
The thing is that the function returns information about the keys which
were successfully deleted from a bucket. For example, please check
output from our tests below:

(r...@macbook-siden)1&gt; {ok, C} = riak:client\\_connect('r...@macbook-siden').
{ok,{riak\\_client,'r...@macbook-siden',&lt;&lt;7,122,127,92&gt;&gt;}}
(r...@macbook-siden)2&gt; O0 = riak\\_object:new(&lt;&lt;"aaa"&gt;&gt;, &lt;&lt;"key1"&gt;&gt;, "val1").
{r\\_object,&lt;&lt;"aaa"&gt;&gt;,&lt;&lt;"key1"&gt;&gt;,
 [{r\\_content,{dict,0,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],[],[],...},
 {{[],[],[],[],[],[],[],[],[],[],[],[],...}}},
 "val1"}],
 [],
 {dict,1,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],...},
 {{[],[],[],[],[],[],[],[],[],[],[],[],[],...}}},
 undefined}
(r...@macbook-siden)3&gt; C:put(O0, 2).
ok
(r...@macbook-siden)4&gt; C:list\\_keys(&lt;&lt;"aaa"&gt;&gt;).
{ok,[&lt;&lt;"key1"&gt;&gt;]}
(r...@macbook-siden)5&gt; C:delete(&lt;&lt;"aaa"&gt;&gt;, &lt;&lt;"key1"&gt;&gt;, 2).
ok
(r...@macbook-siden)6&gt; C:get(&lt;&lt;"aaa"&gt;&gt;, &lt;&lt;"key1"&gt;&gt;, 2).
{error,notfound}
(r...@macbook-siden)7&gt; C:list\\_keys(&lt;&lt;"aaa"&gt;&gt;).
{ok,[&lt;&lt;"key1"&gt;&gt;]}

backend = ets
riak 0.9.1

As you can see the key was successfully deleted (as it can be confirmed by
the output from riak\\_client:get call), but riak\\_client:list\\_keys still
reports that the key
exists in the bucket. Is this the intended behavior of did we hit a bug in riak?
Please advise.

Thanks.
-- 
Alexander Zhuravlev

