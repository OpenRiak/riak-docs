---
title: "Re: Adding new indexed (2i) fields"
description: ""
project: community
lastmod: 2012-12-28T10:23:00-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09696"
mailinglist_parent_id: "msg09681"
author_name: "Thomas Santero"
project_section: "mailinglistitem"
sent_date: 2012-12-28T10:23:00-08:00
---


Hey Joshua,

Do you know all your keys, or are they predictable? If so, you can read
them in batches and write them back with the new indicies, which will not
put the strain of list\\_keys on your cluster.

That said, just wanted to point out that Option #2 necessitates Option #1,
indexing of object for Search happens at write time, so enabling search
would require a read/write on all the keys of your bucket before the values
were searchable.

Tom

On Thu, Dec 27, 2012 at 12:54 PM, Joshua Barratt wrote:

&gt; Good day the list,
&gt;
&gt; We're getting ready to launch a riak-backed application, and starting to
&gt; need to evolve things already. We're leaning on 2i quite a bit.
&gt;
&gt; The use case would be something like an 'account' object:
&gt;
&gt; { "id": ..., "first\\_name": ..., }
&gt;
&gt; .. where we have indexes on various fields. Now our customer service
&gt; department wants account records to magically pop up when people call, and
&gt; we want to add another field ('phone\\_number') that we'll need to do 2i on.
&gt;
&gt; So far the options seem to be:
&gt;
&gt; 1. List all the keys in the bucket (eew, I'm told) and re-save them with
&gt; the new index
&gt; 2. Have search enabled, and find all the objects that have that field
&gt; defined, then re-save them with the index
&gt; 3. I'm doing it wrong at the data modeling layer
&gt;
&gt; I apologize if this is an RTFM thing, I searched the list archives etc and
&gt; found no clear suggestions.
&gt;
&gt;

-- 
@tsantero 
Technical Evangelist
Basho Technologies
347-571-3995
