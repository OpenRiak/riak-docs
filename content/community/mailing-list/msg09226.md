---
title: "RE: Cluster on startup."
description: ""
project: community
lastmod: 2012-11-07T06:45:07-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09226"
mailinglist_parent_id: "msg09225"
author_name: "Kevin Burton"
project_section: "mailinglistitem"
sent_date: 2012-11-07T06:45:07-08:00
---


Thank you this will help. I am a little new to the administration of init.d. 
What do I need to edit to remove the startup of the Riak instance? What should 
be changed to the init.d to run the script on boot up? I notice that the script 
only has functions. How are the functions used? You also do ‘ulimit –n 1024’. 
On installation I received a warning that 1024 was too low. Should the ulimit 
be changed?

 

Thanks again.

 

 

From: riak-users [mailto:riak-users-boun...@lists.basho.com] On Behalf Of 
Jeremiah Peschka
Sent: Wednesday, November 07, 2012 8:17 AM
To: riak-users@lists.basho.com
Subject: Re: Cluster on startup.

 

To add a node to a cluster, you can execute riak-admin cluster join 
riak@192.168.0.1 See [1] for more details. There is no need to reboot for the 
cluster to be formed; the nodes will talk amongst themselves and once they find 
each other, the cluster is up.

 

To start and stop my dev cluster, I wrote a quick bash function [2] to handle 
starting and stopping my local dev cluster. In production, you'd add Riak to 
the init scripts like you did with your single node. You could even tell init.d 
to not start the main cluster and instead execute your dev cluster if you'd 
prefer.

 

If I were you, I'd remove (or at the very least, stop) the Riak instance you've 
got and walk through the Fast Track/Quick Start.

[1]: http://docs.basho.com/riak/latest/cookbooks/Adding-and-Removing-Nodes/

[2]: https://github.com/peschkaj/dotfiles/blob/master/bash/functions.sh#L4
---

Jeremiah Peschka

Founder, Brent Ozar Unlimited


On Nov 7, 2012, at 4:27 AM, "Kevin Burton"  wrote:

On more question. The “Quick Start” shows manually starting each riak server 
then joining. But when I start my Linux server I see that a riak server is 
started. I am assuming that this is the main riak server that was installed. 
How do I start three riak instances instead of just one or by starting one they 
all are started automatically? I understand the join cannot be configured. So 
after I have these three riak instances running (presumably after a reboot) 
then I join them into a cluster, reboot, and the cluster will be formed? After 
the cluster has been formed how do I “edit” it? I would foresee needing to add 
or remove nodes from the cluster.

 

From: Reid Draper [mailto:reiddra...@gmail.com] 
Sent: Tuesday, November 06, 2012 9:36 PM
To: Kevin Burton
Cc: riak-users@lists.basho.com
Subject: Re: Cluster on startup.

 

 

On Nov 6, 2012, at 5:43 PM, Kevin Burton  wrote:


This is probably an FAQ but I was unable to find an answer so hopefully there 
will be some patient people.

 

The “Quick Start” builds a simple cluster all on the same machine (called dev1, 
dev2, and dev3). It assigns the ports, IP addresses, etc. I would like to do 
something similar but I would like the cluster to startup automatically. What 
do I need to add to the configuration file so that all of the joins etc. happen 
on startup? This would be a Ubuntu Server if it makes any difference.

 

There is no configuration option to do this. However, once the nodes have been 
joined to a cluster, they'll

remain part of the same cluster even if they're restarted. Hope this helps.

 

Reid

 

 

Thank you.

 

Kevin

 

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
  riak-users@lists.basho.com
  
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

 

