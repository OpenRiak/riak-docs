---
title: "Re: Ripple one Association Troubles"
description: ""
project: community
lastmod: 2011-02-08T10:46:48-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02221"
mailinglist_parent_id: "msg02220"
author_name: "Stephen Allred"
project_section: "mailinglistitem"
sent_date: 2011-02-08T10:46:48-08:00
---


Sean,

$ puts journal\\_entry.robject.links.inspect
#; riaktag="user", 
; riaktag="up"}&gt;
 =&gt; nil 

$ journal\\_entry
 =&gt; 

$ journal\\_entry.user
(Object doesn't support #inspect)
 =&gt;

$ journal\\_entry.user.inspect
NoMethodError: undefined method `key' for nil:NilClass
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/activesupport-3.0.3/lib/active\\_support/whiny\\_nil.rb:48:in
 `method\\_missing'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:122:in
 `block in instantiate'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
 `tap'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/document/finders.rb:121:in
 `instantiate'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/one\\_linked\\_proxy.rb:25:in
 `find\\_target'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:113:in
 `load\\_target'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/ripple-0.8.3/lib/ripple/associations/proxy.rb:41:in
 `inspect'
 from (irb):17
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:44:in
 `start'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands/console.rb:8:in
 `start'
 from 
/Users/stephenallred/.rvm/gems/ruby-1.9.2-p0/gems/railties-3.0.3/lib/rails/commands.rb:23:in
 `'
 from script/rails:6:in `require'
 from script/rails:6:in `'

Hopefully those are useful,
Thanks for the quick response!
Steve

On 8 Feb 2011, at 6:37 PM, Sean Cribbs wrote:

&gt; Stephen,
&gt; 
&gt; Sounds like you've either found a bug. When you have saved the journal entry 
&gt; in irb, what is the output of this command?
&gt; 
&gt; puts journal\\_entry.robject.links.inspect
&gt; 
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 
&gt; On Feb 8, 2011, at 1:23 PM, Stephen Allred wrote:
&gt; 
&gt;&gt; Hi all,
&gt;&gt; 
&gt;&gt; I'm having trouble setting up a one association in a ripple document. I'm 
&gt;&gt; trying to setup an association between a user and a journal entry, such that 
&gt;&gt; the journal has one user, that the user created.
&gt;&gt; 
&gt;&gt; My JournalEntry document:
&gt;&gt; 
&gt;&gt; --- journal\\_entry.rb ---
&gt;&gt; require 'ripple'
&gt;&gt; 
&gt;&gt; class JournalEntry
&gt;&gt; include Ripple::Document
&gt;&gt; 
&gt;&gt; property :short\\_title, String, :presence =&gt; true
&gt;&gt; property :title, String, :presence =&gt; true
&gt;&gt; property :entry, String, :presence =&gt; true
&gt;&gt; 
&gt;&gt; timestamps!
&gt;&gt; 
&gt;&gt; one :user
&gt;&gt; 
&gt;&gt; key\\_on :short\\_title
&gt;&gt; end
&gt;&gt; ---
&gt;&gt; 
&gt;&gt; My User document:
&gt;&gt; 
&gt;&gt; --- user.rb ---
&gt;&gt; require 'ripple'
&gt;&gt; require 'digest'
&gt;&gt; 
&gt;&gt; class User
&gt;&gt; include Ripple::Document
&gt;&gt; 
&gt;&gt; devise :registerable, :confirmable, :database\\_authenticatable, :recoverable, 
&gt;&gt; :validatable
&gt;&gt; 
&gt;&gt; property :email, String, :presence =&gt; true
&gt;&gt; property :password, String
&gt;&gt; property :password\\_confirmation, String
&gt;&gt; timestamps!
&gt;&gt; 
&gt;&gt; key\\_on :email
&gt;&gt; 
&gt;&gt; def key
&gt;&gt; email
&gt;&gt; end
&gt;&gt; 
&gt;&gt; def id
&gt;&gt; email
&gt;&gt; end
&gt;&gt; end
&gt;&gt; ---
&gt;&gt; 
&gt;&gt; I've tried in the rails console to associate a user with journal\\_entry 
&gt;&gt; (journal\\_entry.user = user), save it and reload it. The resulting reloaded 
&gt;&gt; journal\\_entry does not have a user (calling journal\\_entry.user prints 
&gt;&gt; "(Object doesn't support #inspect)").
&gt;&gt; 
&gt;&gt; My journal entry in riak loaded via the browser looks like:
&gt;&gt; 
&gt;&gt; {"short\\_title":"test","title":"test","entry":"test","created\\_at":"Mon, 07 
&gt;&gt; Feb 2011 22:47:17 -0000","updated\\_at":"Tue, 08 Feb 2011 18:08:47 
&gt;&gt; -0000","\\_type":"JournalEntry"}
&gt;&gt; 
&gt;&gt; Does anyone know what I'm doing wrong?
&gt;&gt; Cheers!
&gt;&gt; Steve
&gt; 
