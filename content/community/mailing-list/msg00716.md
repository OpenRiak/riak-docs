---
title: "Re: Best way to back-up riak"
description: ""
project: community
lastmod: 2010-07-12T09:56:46-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00716"
mailinglist_parent_id: "msg00710"
author_name: "Jason J. W. Williams"
project_section: "mailinglistitem"
sent_date: 2010-07-12T09:56:46-07:00
---


Hey Justin,

Since Riak is lockless, what is the best approach to pulling a
distributed FS snapshot of the bitcask files across nodes? I assume if
they're not close to each other, you'll have an issue if you have to
restore a cluster.


-J

On Sun, Jul 11, 2010 at 8:14 PM, Justin Sheehy  wrote:
&gt; Hi, Jan.
&gt;
&gt; On Sun, Jul 11, 2010 at 8:53 PM, Jan Vincent  wrote:
&gt;
&gt;&gt; Given that riak is new in the database field, if ever I use riak in 
&gt;&gt; production,
&gt;&gt; what would be the best way to back it up? I know that there's redundancy
&gt;&gt; on the different nodes and NRW may be modifiable per request, but I'm
&gt;&gt; wondering if there's a way to snapshot the dataset periodically -- at least
&gt;&gt; until riak becomes provably battle tested.
&gt;
&gt; Riak is fairly battle-tested already: we were using its prior version
&gt; under Basho's own customer-facing applications in 2008, and a number
&gt; of external customers and users are in production today.  That said,
&gt; even a solid distributed database needs to be backed up as there are
&gt; many reasons to have backups.
&gt;
&gt; The easiest and best way to back up Riak is, if you are using bitcask
&gt; (the default) as the backend, to simply back up the filesystem of your
&gt; nodes with whatever backup system you use for the rest of your
&gt; systems.  Bitcask uses append-only files, and once it closes a file it
&gt; will never change the content of that file again.  This makes it very
&gt; backup-friendly.
&gt;
&gt; If you are using a backend with less backup-friendly disk format (such
&gt; as innostore) then you can use the "riak-admin backup" command at
&gt; either the per-node or whole-cluster level to produce a
&gt; backend-independent snapshot that can be loaded back in via
&gt; "riak-admin restore".  This method is much slower, will impose
&gt; additional load on your cluster when running, and requires that you
&gt; have a place to put the generated snapshot.  However, it will work
&gt; regardless of backend and is also a simple if heavyweight way to
&gt; migrate to a cluster with a different configuration.
&gt;
&gt; -Justin
&gt;
