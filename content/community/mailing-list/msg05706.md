---
title: "Re: Counting the number of items in a bucket"
description: ""
project: community
lastmod: 2011-11-22T05:48:41-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05706"
mailinglist_parent_id: "msg05704"
author_name: "Stephen Bennett"
project_section: "mailinglistitem"
sent_date: 2011-11-22T05:48:41-08:00
---


Thanks for that. I've tried to run this across my cluster but it just
returns an error message. Do I need to include a key filter as well?

 An error occurred parsing the "inputs" field.
 Key filter expression missing filter list.


On 22 November 2011 08:42, Fyodor Yarochkin  wrote:

&gt; You can try to limit input by particular subset of ranges, if that
&gt; helps. Here's my count m-r snippet:
&gt;
&gt; {
&gt; "inputs":{
&gt; "bucket":"data",
&gt; "index":"numero\\_int",
&gt; "start":0,
&gt; "end":1212
&gt; },
&gt; "query":[
&gt; {"map":
&gt; {"language":"erlang","module":"riak\\_kv\\_mapreduce","function":"map\\_object\\_value","arg":"filter\\_notfound"}
&gt; },
&gt; {"reduce": {"language":"erlang",
&gt;
&gt; "module":"riak\\_kv\\_mapreduce","function":"reduce\\_count\\_inputs","arg":"filter\\_notfound"}}
&gt;
&gt; ], "timeout": 9000
&gt; }
&gt;
&gt; hope it helps,
&gt; -fyodor
&gt;
&gt;
&gt;
&gt; On Tue, Nov 22, 2011 at 3:26 AM, Stephen Bennett 
&gt; wrote:
&gt; &gt; I have a bucket which contains images refernced by a key which is made up
&gt; &gt; from a guid. I have a number of servers in my cluster and my bucket is
&gt; set
&gt; &gt; up to store 3 versions of every item in the bucket across the servers in
&gt; the
&gt; &gt; cluster. I'd like to understand a little bit more about how my cluster is
&gt; &gt; performing in terms of data storage. I can find out how much space each
&gt; &gt; bitcask is currently taking up on each server, but I'd like to compare
&gt; &gt; reference this against the number of unique keys that are being stored in
&gt; &gt; the system.
&gt; &gt;
&gt; &gt; I've tried to use map-reduce methods using the erlang methods defined in
&gt; the
&gt; &gt; riak\\_kv\\_mapreduce, calling them against the HTTP interface but my queries
&gt; &gt; are timing out. I've tried to extend the timeout, but it's still timing
&gt; out.
&gt; &gt;
&gt; &gt; What's the most efficient way to find out how many keys exist in a
&gt; &gt; particular bucket?
&gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; riak-users mailing list
&gt; &gt; riak-users@lists.basho.com
&gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt;
&gt; &gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

