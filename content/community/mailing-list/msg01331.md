---
title: "Re: Riak backend when using Riak search"
description: ""
project: community
lastmod: 2010-10-20T05:47:50-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01331"
mailinglist_parent_id: "msg01264"
author_name: "Germain Maurice"
project_section: "mailinglistitem"
sent_date: 2010-10-20T05:47:50-07:00
---

 Hello,

I have to confess I tested Riak Search with Innostore to quickly because 
I just got these error messages when installing a new node :

&gt; riaksearch console

=ERROR REPORT==== 20-Oct-2010::14:32:58 ===
storage\\_backend innostore\\_riak is non-loadable.

=INFO REPORT==== 20-Oct-2010::14:32:58 ===
 application: riak\\_kv
 exited: {invalid\\_storage\\_backend,{riak\\_kv\\_app,start,[normal,[]]}}
 type: permanent
/usr/lib/riaksearch/lib/os\\_mon-2.2.5/priv/bin/memsup: Erlang has closed.
 Erlang 
has closed


&gt; riaksearch console

=ERROR REPORT==== 20-Oct-2010::14:39:35 ===
storage\\_backend riak\\_kv\\_innostore\\_backend is non-loadable.

=INFO REPORT==== 20-Oct-2010::14:39:35 ===
 application: riak\\_kv
 exited: {invalid\\_storage\\_backend,{riak\\_kv\\_app,start,[normal,[]]}}
 type: permanent
/usr/lib/riaksearch/lib/os\\_mon-2.2.5/priv/bin/memsup: Erlang has closed.

I'm using Riak Search 0.13.0 and innostore 1.0.2-2-amd64.

Is it normal ? Dan said me it could be not incompatible with innostore.

Thanks


Le 12/10/10 21:48, Germain Maurice a écrit :

Argh, i replied directly to Dan :/

==========
Hi Germain,

You can use Riak Search as you would a normal installation of Riak KV; 
Riak Search is a superset of Riak KV. You can modify the riak\\_kv 
portion of Riak Search exactly as you would a typical Riak KV 
installation.


One thing to note; along with index data Riak Search will also store a 
representation of indexed documents as an object in Riak KV. For 
example, indexing a document in the "search" index will do the following:
1. Store indexed data in the Merge Index backend using the merge\\_index 
data\\_root

2. Store a new document in Riak KV using the configured backend:
Bucket: \\_rsid\\_search
Key: DocId
Value: Data from the document

The document's data representation could be retrieved through the 
standard REST API as follows:

http://localhost:8098/riak/\\_rsid\\_search/DocId

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com 


On Tue, Oct 12, 2010 at 12:11 PM, Germain Maurice 
&gt; wrote:

Not really Dan, it was about pure data storage not about indexes storage.

I just tried Riak Search with Innostore for my buckets and it works, i 
was a bit hurry (and it was simple to make some test).

However, thank you for having answered.

Le 12/10/10 20:47, Dan Reverri a écrit :
Riak Search uses a custom backend called Merge Index. The Riak Search 
backend is configurable in app.config, however, Merge Index is the 
only backend that works for search:

 {riak\\_search, [
 {search\\_backend, merge\\_index\\_backend},
 {java\\_home, "/usr"}
 ]},

Merge index is configurable in app.config as well:
%% Merge Index Config
 {merge\\_index, [
 {data\\_root, "data/merge\\_index"},
 {buffer\\_rollover\\_size, 10485760},
 {buffer\\_delayed\\_write\\_size, 524288},
 {buffer\\_delayed\\_write\\_ms, 2000},
 {max\\_compact\\_segments, 20},
 {segment\\_query\\_read\\_ahead\\_size, 65536},
 {segment\\_compaction\\_read\\_ahead\\_size, 5242880},
 {segment\\_file\\_buffer\\_size, 20971520},
 {segment\\_delayed\\_write\\_size, 20971520},
 {segment\\_delayed\\_write\\_ms, 10000},
 {segment\\_full\\_read\\_size, 20971520},
 {segment\\_block\\_size, 32767},
 {segment\\_values\\_staging\\_size, 1000},
 {segment\\_values\\_compression\\_threshold, 0},
 {segment\\_values\\_compression\\_level, 1}
 ]},

The data\\_root parameter will tell Merge Index where to store it's 
data files.


Does this answer your question?

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com 


On Tue, Oct 12, 2010 at 9:51 AM, Germain Maurice 
&gt; wrote:


 Hi everybody,

 Is there any requirements concerning riak storage backend when we
 are using Riak Search ?
 I think it's independant but we have to be insured about this.

 Thank you..

 -- 
 Germain Maurice

 Administrateur Système/Réseau
 Tel : +33.(0)1.42.43.54.33

 http://www.linkfluence.net


--
Germain Maurice
Administrateur Système/Réseau
Tel : +33.(0)1.42.43.54.33

http://www.linkfluence.net

