---
title: "Re: Riak mapreduce function map_object_value return empty result on	erlang pb client"
description: ""
project: community
lastmod: 2012-10-15T11:41:52-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08923"
mailinglist_parent_id: "msg08921"
author_name: "Bryan Fink"
project_section: "mailinglistitem"
sent_date: 2012-10-15T11:41:52-07:00
---


On Mon, Oct 15, 2012 at 12:34 PM, Mikhail Kuznetsov
 wrote:
&gt; We fixed it, but I am very angryâ€¦

I agree. Breaking APIs without announcement is not okay. In this case,
I don't think it was intentional. Instead, I think we just didn't know
we broke this until your message arrived. In the latest version, we
changed get\\_index to use a new protocol buffer message instead of
piggy-backing on the MapReduce message. At the time this change was
made, no tests covered riakc\\_pb\\_socket:get\\_index:

https://github.com/basho/riak-erlang-client/blob/a33a677e393b90c88af2c05f4178984e3b634302/src/riakc\\_pb\\_socket.erl#L1398-2307

Without tests in place, we missed the fact that we changed the API. I
hope it improves your outlook to know that tests for get\\_index are now
included in the new riak\\_test project:

https://github.com/basho/riak\\_test/blob/master/tests/secondary\\_index\\_tests.erl

So, this kind of unknown, unexpected breakage should not happen again.

Thanks for spending time tracking this down, and sending in the report.

-Bryan

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

