---
title: "Re: 50-100 ops/sec on a 5 Node cluster"
description: ""
project: community
lastmod: 2012-06-29T09:28:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07833"
mailinglist_parent_id: "msg07827"
author_name: "Sean O'Connor"
project_section: "mailinglistitem"
sent_date: 2012-06-29T09:28:55-07:00
---


There are a few things you probably want to look at in regard to how your using 
ELB. 

If your using the straight ELB offering (e.g. not part of a virtual private 
cloud), that's probably your problem. This form of ELB was really only 
designed for routing traffic from outside the AWS network to servers within 
EC2. Using it route traffic with the AWS tends to be very slow/throttled as 
your traffic has to go out to the public network and then back into the private 
AWS network.

Recently (i.e. the last two or three weeks) Amazon announced a new version of 
ELB that you can use with virtual private cloud to route traffic between VPC 
networks. I haven't tried it yet but in theory this should avoid many of the 
problems mentioned above.

One last thing to be aware of with ELB is it can often take a while for an ELB 
instance to deal with spikes in capacity (e.g. load tests). Under the covers 
ELB is basically as series of managed EC2 instances running a load balancer 
program. When your capacity exceeds what one instance can handle, they'll spin 
up more instances but that takes time to happen. Accordingly when doing load 
testing with ELB, you often need to "prime" the ELB by running test traffic for 
10-15 minutes and then start recording your benchmark data.

With the possible exception of the new VPC ELB offering, I would strongly 
recommend against using ELB to load balance traffic to your riak cluster. 

-- 
Sean O'Connor
CTO/Co-Founder
(845)669-0883
http://focuslab.io

On Thursday, June 28, 2012 at 4:03 PM, Ruslan Bukin wrote:

&gt; On Tue, Jun 26, 2012 at 04:29:38PM +0530, Yousuf Fauzan wrote:
&gt; &gt; Hello,
&gt; &gt; 
&gt; &gt; Here is my setup of Riak 1.1.4
&gt; &gt; 
&gt; &gt; - 5 Nodes
&gt; &gt; - ami-a29943cb (EC2 AMI)
&gt; &gt; - m1.large (7.5GB Ram, 4 EC2 compute instances)
&gt; &gt; - EBS storage
&gt; &gt; - LevelDB backend
&gt; &gt; - Python Client with Protobuf (on a separate machine)
&gt; &gt; 
&gt; &gt; While loading data I am getting around 50 ops/sec.
&gt; &gt; 
&gt; &gt; I tried running basho benchmark on the setup and it showed 100 ops/sec
&gt; &gt; throughput.
&gt; &gt; 
&gt; &gt; After talking to people or Riak IRC, I realized that upwards of 1.5K
&gt; &gt; ops/sec is what I should be getting.
&gt; &gt; 
&gt; &gt; Could anyone help me in figuring out what I am doing wrong?
&gt; 
&gt; are your riak nodes located in the same DC?
&gt; 
&gt; -Ruslan
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com (mailto:riak-users@lists.basho.com)
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 
&gt; 
