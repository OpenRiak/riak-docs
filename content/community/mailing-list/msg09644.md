---
title: "CRASH REPORT Process <<\"TypeError: reduce of empty array with no	initial value\">>},{<<\"source\">>,<<\"unknown\">>}]}"
description: ""
project: community
lastmod: 2012-12-20T05:53:03-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09644"
author_name: "David Montgomery"
project_section: "mailinglistitem"
sent_date: 2012-12-20T05:53:03-08:00
---


2012-12-20 13:31:27.906 [error] &lt;0.30794.1&gt; CRASH REPORT Process
&lt;0.30794.1&gt; with 0 neighbours exited with reason:
{fitting\\_exited\\_abnormally,[{&lt;&lt;"lineno"&gt;&gt;,3},{&lt;&lt;"message"&gt;&gt;,&lt;&lt;"TypeError:
reduce of empty array with no initial
value"&gt;&gt;},{&lt;&lt;"source"&gt;&gt;,&lt;&lt;"unknown"&gt;&gt;}]} in gen\\_fsm:terminate/7 line 611
2012-12-20 13:31:27.912 [error] &lt;0.213.0&gt; Supervisor riak\\_pipe\\_builder\\_sup
had child undefined started with {riak\\_pipe\\_builder,start\\_link,undefined}
at &lt;0.30794.1&gt; exit with reason
{fitting\\_exited\\_abnormally,[{&lt;&lt;"lineno"&gt;&gt;,3},{&lt;&lt;"message"&gt;&gt;,&lt;&lt;"TypeError:
reduce of empty array with no initial
value"&gt;&gt;},{&lt;&lt;"source"&gt;&gt;,&lt;&lt;"unknown"&gt;&gt;}]} in context child\\_terminated


Hi,

The above is the crash report I get when I run the below script using the
api. The api does not return an error. I have to look at the logs on the
node running the query else will run till timeout is reached.

query.map('''
 function(value, keyData, arg) {
 var data = Riak.mapValuesJson(value)[0];
 if(data['adx']=='gdn'){
 try{
 var matches =
data['url'].match(/^https?\\:\\/\\/([^\\/?#]+)(?:[\\/?#]|$)/i);
 var alt\\_key = matches && matches[1];
 }
 catch(err){
 var alt\\_key = 'error';
 }
 obj[alt\\_key] = 1;
 return [ obj ];
 }else{
 return [];
 }
 }''')

query.reduce('''
 function(values, arg){
 return [ values.reduce( function(acc, item) {
 for (var state in item) {
 if (acc[state])
 acc[state] += item[state];
 else
 acc[state] = item[state];
 }
 return acc;
 })];
 }
 ''')

Thanks
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

