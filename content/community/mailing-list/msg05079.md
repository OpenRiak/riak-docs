---
title: "Re: Riak Search 1.0 Bug - Inline Fields"
description: ""
project: community
lastmod: 2011-10-06T12:21:26-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05079"
mailinglist_parent_id: "msg05055"
author_name: "Greg Pascale"
project_section: "mailinglistitem"
sent_date: 2011-10-06T12:21:26-07:00
---


Anybody have any ideas on this one? I was able to deploy a workaround, but it 
involved some ugly special case logic in my search code. 

Also, the last example should say "crashes", not "times out". It returned with 
that error immediately. 

-- 
Greg
Clipboard

On Wednesday, October 5, 2011 at 11:31 AM, Greg Pascale wrote:

&gt; Hi, 
&gt; 
&gt; I have uncovered what I think has to be a bug with inline field searches in 
&gt; Riak 1.0. In short, it seems that there are issues when including a field in 
&gt; both the query and filter query. I have a query in production that used to 
&gt; work with 14.2 but no longer does with 1.0.
&gt; 
&gt; I dove into the issue a bit and was able to come up with some simpler 
&gt; examples that illustrate what I'm seeing. I ran these on my dev box which 
&gt; only has about 15 items in the clips bucket, so I'm nowhere close to the 
&gt; results limit. ctime is a field with inline set to true.
&gt; 
&gt; Example 1: Works
&gt; 
&gt; search-cmd search clips 'ctime:([98682333448080 TO 98682333448089])'
&gt; 
&gt; :: Searching for 'ctime:([98682333448080 TO 98682333448089])' / '' in 
&gt; clips...
&gt; 
&gt; ------------------------------
&gt; 
&gt; index/id: clips/LR04QZTJS\\_wVDcb6
&gt; &lt;&lt;"ctime"&gt;&gt; -&gt; &lt;&lt;"98682333448084"&gt;&gt;
&gt; p -&gt; [0]
&gt; &lt;&lt;"ctime"&gt;&gt; -&gt; [&lt;&lt;"98682333448084"&gt;&gt;]
&gt; &lt;&lt;"private"&gt;&gt; -&gt; [&lt;&lt;"0"&gt;&gt;]
&gt; score -&gt; 0.0
&gt; 
&gt; ------------------------------
&gt; 
&gt; Example 2: Times out (should return 0 results)
&gt; 
&gt; search-cmd search clips 'ctime:([98682333448080 TO 98682333448089])' 
&gt; 'ctime:(99999999999999)' :: Searching for 'ctime:([98682333448080 TO 
&gt; 98682333448089])' / 'ctime:(99999999999999)' in clips... 
&gt; ------------------------------ :: ERROR: timeout 
&gt; 
&gt; Example 3: Times out (should return 1 result)
&gt; 
&gt; search-cmd search clips 'ctime:(98682333448084)' 'ctime:(98682333448084)'
&gt; 
&gt; :: Searching for 'ctime:(98682333448084)' / 'ctime:(98682333448084)' in 
&gt; clips...
&gt; 
&gt; ------------------------------
&gt; 
&gt; :: ERROR: 
&gt; {badarg,[{lists,member,[&lt;&lt;"98682333448084"&gt;&gt;,&lt;&lt;"98682333448084"&gt;&gt;]},
&gt; {riak\\_search\\_inlines,passes\\_inlines\\_1,3},
&gt; {lists,all,2},
&gt; {mi\\_server,iterate,6},
&gt; {mi\\_server,lookup,8}]}
&gt; 
&gt; 
&gt; Thanks
&gt; 
&gt; -- 
&gt; Greg
&gt; Clipboard

