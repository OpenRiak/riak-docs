---
title: "RE: Pending transfers when joining 1.0.3 node to 1.0.0 cluster"
description: ""
project: community
lastmod: 2012-01-18T13:43:38-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06309"
mailinglist_parent_id: "msg06305"
author_name: "Fredrik Lindström"
project_section: "mailinglistitem"
sent_date: 2012-01-18T13:43:38-08:00
---


After some digging I found a suggestion from Joseph Blomstedt in an earlier 
mail thread
http://lists.basho.com/pipermail/riak-users\\_lists.basho.com/2012-January/007116.html

in the riak console:
riak\\_core\\_ring\\_manager:force\\_update().
riak\\_core\\_vnode\\_manager:force\\_handoffs().

The symptoms would appear to be the same although the cluster referenced in the 
mail thread does not appear to have search enabled,
as far as I can tell from the log snippets. The mail thread doesn't really 
specify which node to run the commands on so I tried both the new node and the 
current claimant of the cluster.

Sadly the suggested steps did not produce any kind of ownership handoff.

Any helpful ideas would be much appreciated :)

/F


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
From: riak-users-boun...@lists.basho.com [riak-users-boun...@lists.basho.com] 
on behalf of Fredrik Lindström [fredrik.lindst...@qbranch.se]
Sent: Wednesday, January 18, 2012 4:00 PM
To: riak-users@lists.basho.com
Subject: Pending transfers when joining 1.0.3 node to 1.0.0 cluster

Hi everyone,
when we try to join a 1.0.3 node to an existing 1.0.0 (3 node) cluster the 
ownership transfer doesn't appear to take place. I'm guessing that we're making 
some stupid little mistake but we can't figure it out at the moment. Anyone run 
into something similar?

Riak Search is enabled on the original nodes in the cluster as well as the new 
node.
Ring size is set to 128

The various logfiles do not appear to contain any errors or warnings

Output from riak-admin member\\_status
================================= Membership ==================================
Status Ring Pending Node
-------------------------------------------------------------------------------
valid 33.6% 25.0% 'qbkp...@qbkpx01.ad.qnet.local'
valid 33.6% 25.0% 'qbkp...@qbkpx02.ad.qnet.local'
valid 32.8% 25.0% 'qbkp...@qbkpx03.ad.qnet.local'
valid 0.0% 25.0% 't...@qbkpxadmin01.ad.qnet.local'
-------------------------------------------------------------------------------

Output from riak-admin ring\\_status
See attached file

Output from riak-admin transfers
't...@qbkpxadmin01.ad.qnet.local' waiting to handoff 10 partitions
'qbkp...@qbkpx03.ad.qnet.local' waiting to handoff 62 partitions
'qbkp...@qbkpx01.ad.qnet.local' waiting to handoff 63 partitions


/F
