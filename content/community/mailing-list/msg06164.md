---
title: "Re: maximum limit of keys per buckets"
description: ""
project: community
lastmod: 2012-01-06T17:54:35-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06164"
mailinglist_parent_id: "msg06163"
author_name: "Karthik K"
project_section: "mailinglistitem"
sent_date: 2012-01-06T17:54:35-08:00
---


Further,
 ulimit -n is 10K on the box.


# tail -100 /var//log/riak/erlang.log.1

....
17:26:26.960 [info] alarm\\_handler: {set,{system\\_memory\\_high\\_watermark,[]}}
/usr/lib/riak/lib/os\\_mon-2.2.6/priv/bin/memsup: Erlang has closed.
Erlang has closed
17:26:34.443 [info] alarm\\_handler: {clear,system\\_memory\\_high\\_watermark}


So - is there a commit / flush setting that is missed when it comes to high
volume writes ?


On Fri, Jan 6, 2012 at 5:37 PM, Karthik K  wrote:

&gt; I am using Riak with LevelDB as the storage engine.
&gt;
&gt; app.config:
&gt;
&gt; {storage\\_backend, riak\\_kv\\_eleveldb\\_backend},
&gt;
&gt;
&gt; {eleveldb, [
&gt; {data\\_root, "/var/lib/riak/leveldb"},
&gt; {write\\_buffer\\_size, 4194304}, %% 4MB in bytes
&gt; {max\\_open\\_files, 50}, %% Maximum number of files open at once
&gt; per partition
&gt; {block\\_size, 65536}, %% 4K blocks
&gt; {cache\\_size, 33554432}, %% 32 MB default cache size
&gt; per-partition
&gt; {verify\\_checksums, true} %% make sure data is what we expected
&gt; it to be
&gt; ]},
&gt;
&gt;
&gt;
&gt;
&gt; I want to insert a million keys into the store ( into a given bucket ) .
&gt;
&gt; pseudo-code:
&gt; riakClient = RiakFactory.pbcClient();
&gt; myBucket =
&gt; riakClient.createBucket("myBucket").nVal(1).execute();
&gt; for (int i = 1; i &lt;= 1000000; ++i) {
&gt; final String key = String.valueOf(i);
&gt; myBucket.store(key, new String(payload)).returnBody(false);
&gt; }
&gt;
&gt;
&gt; after this operation, when I do:
&gt;
&gt; int count = 0;
&gt; for (String key : myBucket.keys() ) {
&gt; ++count;
&gt; }
&gt; return count;
&gt;
&gt; This returns a total of 14K keys, while I was expecting close to 1 million
&gt; or so.
&gt;
&gt; I am using riak-java-client (pbc).
&gt;
&gt; Which setting / missing client code can explain the discrepancy ? Thanks.
&gt;
&gt;
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

