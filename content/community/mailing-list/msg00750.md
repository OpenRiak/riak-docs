---
title: "Re: Riak 0.11.0 hanging on OSX 10.6"
description: ""
project: community
lastmod: 2010-07-20T10:53:28-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00750"
mailinglist_parent_id: "msg00743"
author_name: "Chris Dawson"
project_section: "mailinglistitem"
sent_date: 2010-07-20T10:53:28-07:00
---


I believe I have been having the same problem, so I appreciate this
information.

When I run ulimit on my machine I get "unlimited." Is this acceptable? I
ran ulimit -n 1024, and even after that it still returns unlimited.

Chris

On Mon, Jul 19, 2010 at 6:40 AM, Shane Holloway wrote:

&gt; Thanks -- ulimit -n 1024 fixed my problem. It's wonderfully stable now --
&gt; even under high load.
&gt;
&gt;
&gt; On Jul 19, 2010, at 2:30 AM, Daniel Reverri wrote:
&gt;
&gt; Hi Shane,
&gt;
&gt; Can you try increasing the number of allowed open file handles on your
&gt; system?
&gt; ulimit -n 1024
&gt;
&gt; You can check this setting from a riak console by typing:
&gt; os:cmd("ulimit -a").
&gt;
&gt; Thanks,
&gt; Dan
&gt;
&gt; Sent from my iPhone
&gt;
&gt; On Jul 18, 2010, at 10:32 PM, Shane Holloway 
&gt; wrote:
&gt;
&gt; I'm having a bit of a problem with Riak. When I keep my new documents to
&gt; about 10 per second, Riak works fine. But as I increase my speed to about
&gt; 100 docs per second, Riak gets dramatically slow. After a while, the beam
&gt; process takes 100% of my CPU and no longer responds to ping/stop or any
&gt; other command from the bin folder. I end up sending kill TERM to stop the
&gt; process.
&gt;
&gt; If I restart Riak, the bitcask backend seems to be limited to about 1-2
&gt; document stores per second, but read seems fairly responsive still. I'd
&gt; appreciate any thoughts or troubleshooting tips you may have. It's an
&gt; in-development database with demo data, so I can run any experiments you'd
&gt; like to see.
&gt;
&gt; Thanks,
&gt; -Shane
&gt;
&gt;
&gt;
&gt; Riak/riakOne% ./bin/riak-admin status
&gt; 1-minute stats for 'r...@172.20.0.49'
&gt; -------------------------------------------
&gt; vnode gets : 104
&gt; vnode\\_puts : 103
&gt; vnode\\_gets\\_total : 136
&gt; vnode\\_puts\\_total : 127
&gt; node\\_gets : 36
&gt; node\\_gets\\_total : 47
&gt; node\\_get\\_fsm\\_time\\_mean : 2635.1111111111113
&gt; node\\_get\\_fsm\\_time\\_median : 667
&gt; node\\_get\\_fsm\\_time\\_95 : 9156
&gt; node\\_get\\_fsm\\_time\\_99 : 40652
&gt; node\\_get\\_fsm\\_time\\_100 : 40652
&gt; node\\_puts : 36
&gt; node\\_puts\\_total : 44
&gt; \\*node\\_put\\_fsm\\_time\\_mean : 1670575.611111111\\*
&gt; \\*node\\_put\\_fsm\\_time\\_median : 1157\\*
&gt; \\*node\\_put\\_fsm\\_time\\_95 : 23900\\*
&gt; \\*node\\_put\\_fsm\\_time\\_99 : 60000511\\*
&gt; \\*node\\_put\\_fsm\\_time\\_100 : 600005\\*11
&gt; cpu\\_nprocs : 0
&gt; cpu\\_avg1 : 0
&gt; cpu\\_avg5 : 0
&gt; cpu\\_avg15 : 0
&gt; mem\\_total : 0
&gt; mem\\_allocated : 0
&gt; \\*disk : [{"none",0,0}]\\*
&gt; nodename : 'r...@172.20.0.49'
&gt; connected\\_nodes : ['riak\\_maint\\_61...@172.20.0.49']
&gt; sys\\_driver\\_version : &lt;&lt;"1.5"&gt;&gt;
&gt; sys\\_global\\_heaps\\_size : 0
&gt; sys\\_heap\\_type : private
&gt; sys\\_logical\\_processors : 2
&gt; sys\\_otp\\_release : &lt;&lt;"R13B04"&gt;&gt;
&gt; sys\\_process\\_count : 167
&gt; sys\\_smp\\_support : true
&gt; sys\\_system\\_version : &lt;&lt;"Erlang R13B04 (erts-5.7.5) [source] [64-bit]
&gt; [smp:2:2] [rq:2] [async-threads:5] [hipe] [kernel-poll:true]\\n"&gt;&gt;
&gt; sys\\_system\\_architecture : &lt;&lt;"i386-apple-darwin9.4.0"&gt;&gt;
&gt; sys\\_threads\\_enabled : true
&gt; sys\\_thread\\_pool\\_size : 5
&gt; sys\\_wordsize : 8
&gt; ring\\_members : ['r...@172.20.0.49']
&gt; ring\\_num\\_partitions : 64
&gt; ring\\_ownership : &lt;&lt;"[{'r...@172.20.0.49',64}]"&gt;&gt;
&gt; ring\\_creation\\_size : 64
&gt; storage\\_backend : riak\\_kv\\_bitcask\\_backend
&gt; pbc\\_connects\\_total : 0
&gt; pbc\\_connects : 0
&gt; pbc\\_active : 0
&gt;


-- 
Chris Dawson
971-533-8335
