---
title: "Re: -proto_dist inet_tls"
description: ""
project: community
lastmod: 2012-10-12T13:56:28-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08899"
mailinglist_parent_id: "msg08898"
author_name: "Michael Johnson"
project_section: "mailinglistitem"
sent_date: 2012-10-12T13:56:28-07:00
---


Well, I have ruled out this being an erlang problem. I've been able to
follow the erlang documentation to create 2 nodes (each in it's own virtual
machine) and connect successfully from one to the other in the same way
that nodetool tries to. This means something about the way riak is doing
things does not play nicely when proto\\_dist is set to inet\\_tls.

I'm going to be doing some more poking and proding, but maybe someone else
can provide some insight? Thanks.

On Fri, Oct 12, 2012 at 11:49 AM, Michael Johnson wrote:

&gt; Has anyone successfully configured riak so that the erlang cluster
&gt; communication happens over SSL? I ask because as near as I can tell it
&gt; simply does not work. The default vm.args (
&gt; https://github.com/basho/riak/blob/master/rel/files/vm.args) contains the
&gt; following lines:
&gt;
&gt;
&gt; ## To enable SSL encryption of the Erlang intra-cluster communication,
&gt; ## un-comment the three lines below and make certain that the paths
&gt; ## point to correct PEM data files. See docs TODO for details.
&gt;
&gt; ## -proto\\_dist inet\\_ssl
&gt; ## -ssl\\_dist\\_opt client\\_certfile "{{platform\\_etc\\_dir}}/erlclient.pem"
&gt; ## -ssl\\_dist\\_opt server\\_certfile "{{platform\\_etc\\_dir}}/erlserver.pem"
&gt;
&gt; This information is not correct for current versions of erlang (including
&gt; the one basho bundles in the binary packages). Instead of '-proto\\_dist
&gt; inet\\_ssl' it should be '-proto\\_dist inet\\_tls'
&gt;
&gt; Once I correct that problem, the beam process will start, however,
&gt; nodetool cannot talk to the node and thus the initscript fails (while
&gt; leaving a running riak process). At first I suspected this might be a
&gt; problem with nodetool, but I cannot join the nodes together.
&gt;
&gt; I am starting to think this may be a problem with erlang and thus just not
&gt; going to work. I'm going to try following the instructions at
&gt; http://www.erlang.org/doc/apps/ssl/ssl\\_distribution.html to build a
&gt; simple test app that handles the cluster communication over SSL, so then I
&gt; should know if this is a riak problem or if it is an erlang problem.
&gt;
&gt; In the mean time, if anyone has information one way or the other, it would
&gt; be appreciated.
&gt;
&gt;
