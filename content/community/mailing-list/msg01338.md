---
title: "Re: Curb performance when doing a PUT ( ripple 0.8.1 )"
description: ""
project: community
lastmod: 2010-10-20T09:07:46-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01338"
mailinglist_parent_id: "msg01337"
author_name: "David Dawson"
project_section: "mailinglistitem"
sent_date: 2010-10-20T09:07:46-07:00
---


Sean, 

Here is the info you requested

1. ruby 1.9.2-p0

2. There is nothing between the Ruby app and RIAK

3. Here is the output

ruby-1.9.2-p0 &gt; c.save!
\\* Re-using existing connection! (#0) with host 127.0.0.1
\\* Connected to 127.0.0.1 (127.0.0.1) port 8098 (#0)
&gt; PUT /riak/organisations/itv?returnbody=true HTTP/1.1
Host: 127.0.0.1:8098
Accept: multipart/mixed, application/json;q=0.7, \\*/\\*;q=0.5
X-Riak-Clientid: Z9ni5A==
Content-Type: application/json
X-Riak-Vclock: 
a85hYGAQzGDKBVIs/xeH22YwJTLlsTK4pBgf44MIszUnsYu+fwqUYARKNKbCJVh07R/kAoWZgcIZaQjh9bWSslDV8zKRjWF0mWONVYJlHvspqER2FsIg7uN3NkDN/4gkvFujQg+q2jMbxZjsK1aYEiy3p4rwQYVrUdQzejitxyrB+p75JlSCNw9hkH+oTQY0fHq6kdUz810Khqqf04dQr3H8SADU/cjC6TcfPYGqPt+HbAzbG35pZIksAA==
Content-Length: 829
Expect: 100-continue

\\* Done waiting for 100-continue
&lt; HTTP/1.1 100 Continue
&lt; HTTP/1.1 200 OK
&lt; X-Riak-Vclock: 
a85hYGAQzGDKBVIs/xeH22YwJTLlsTK4pBgf44MIszUnsYu+fwqUYARKNKbCJVh07R/kAoWZgcIZacjqGV3mWEPVz8tEqF9fKymLKQxUzzKP/RRUIjsLoZ77+J0NUPM/ZqGoz75iBVXvmY1Qv1ujQg9TGOQeD6f1UIlaJPW3p4rwYQoD1bO+Z74JleDNQ6j3D7XJgIZPTzdCWOP4kQCoM+f0IRvDzHcpGGoMqgTbG35pqMR5hARL+s1HT6Dmi/YDhbMA
&lt; Vary: Accept-Encoding
&lt; Server: MochiWeb/1.1 WebMachine/1.7.2 (participate in the frantic)
&lt; Link: ; rel="up"
&lt; Date: Wed, 20 Oct 2010 16:04:37 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 829
&lt; X-Charles-Received-Continue: HTTP/1.1 100 Continue
&lt; Connection: Keep-alive
&lt; 
\\* Expire cleared
\\* Connection #0 to host 127.0.0.1 left intact
/Users/ddawson/git/falcon\\_modules/rel/falcon\\_modules/modules/common/lib/falcon/document\\_extensions.rb:210:
 warning: already initialized constant OrganisationIndex
\\* Re-using existing connection! (#0) with host 127.0.0.1
\\* Connected to 127.0.0.1 (127.0.0.1) port 8098 (#0)
&gt; GET /riak/organisations/index HTTP/1.1
Host: 127.0.0.1:8098
Accept: multipart/mixed, application/json;q=0.7, \\*/\\*;q=0.5
X-Riak-Clientid: Z9ni5A==

&lt; HTTP/1.1 200 OK
&lt; X-Riak-Vclock: 
a85hYGBgzmDKBVIs/qE2GRlMicx5rAw93cbH+KDCGsePBACFGYHCc/oQwuk3Hz2BCl8ACWcBAA==
&lt; Vary: Accept-Encoding
&lt; Server: MochiWeb/1.1 WebMachine/1.7.2 (participate in the frantic)
&lt; Link: ; riaktag="documents", ; 
rel="up"
&lt; Last-Modified: Wed, 20 Oct 2010 16:03:28 GMT
&lt; ETag: 6cT6EKb6ruH0hUfc7J6xW0
&lt; Date: Wed, 20 Oct 2010 16:04:37 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 43
&lt; Connection: Keep-alive
&lt; 
\\* Expire cleared
\\* Connection #0 to host 127.0.0.1 left intact
\\* Re-using existing connection! (#0) with host 127.0.0.1
\\* Connected to 127.0.0.1 (127.0.0.1) port 8098 (#0)
&gt; PUT /riak/organisations/index?returnbody=true HTTP/1.1
Host: 127.0.0.1:8098
Accept: multipart/mixed, application/json;q=0.7, \\*/\\*;q=0.5
X-Riak-Clientid: Z9ni5A==
Content-Type: application/json
X-Riak-Vclock: 
a85hYGBgzmDKBVIs/qE2GRlMicx5rAw93cbH+KDCGsePBACFGYHCc/oQwuk3Hz2BCl8ACWcBAA==
Link: ; riaktag="documents"
Content-Length: 43
Expect: 100-continue

\\* Done waiting for 100-continue
&lt; HTTP/1.1 100 Continue
&lt; HTTP/1.1 200 OK
&lt; X-Riak-Vclock: 
a85hYGBgzmDKBVIs/qE2GRlMicx5rAw93cbH+KDCGsePBACFGYHCc/oQwuk3Hz0BCjMBhcX6gcJZAA==
&lt; Vary: Accept-Encoding
&lt; Server: MochiWeb/1.1 WebMachine/1.7.2 (participate in the frantic)
&lt; Link: ; riaktag="documents", ; 
rel="up"
&lt; Date: Wed, 20 Oct 2010 16:04:38 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 43
&lt; X-Charles-Received-Continue: HTTP/1.1 100 Continue
&lt; Connection: Keep-alive
&lt; 
\\* Expire cleared
\\* Connection #0 to host 127.0.0.1 left intact
 =&gt; # 


On 20 Oct 2010, at 16:53, Sean Cribbs wrote:

&gt; Dave,
&gt; 
&gt; A few questions:
&gt; 1) Which version of Ruby are you using?
&gt; 2) Do you have anything between your Ruby app and Riak (e.g. a load balancer, 
&gt; reverse proxy, etc)?
&gt; 3) Can you enable "verbose" mode on curl and paste the output? Here's how:
&gt; 
&gt; client.http.send(:curl).verbose = true
&gt; 
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 
&gt; On Oct 20, 2010, at 11:45 AM, David Dawson wrote:
&gt; 
&gt;&gt; I am currently doing some benchmarking with the current ripple library and 
&gt;&gt; have noticed that a 'PUT' ( on mac os x ) is taking over 1 sec when using 
&gt;&gt; the curb library!
&gt;&gt; 
&gt;&gt; If I force the riak-client to use net http instead then the same 'PUT' 
&gt;&gt; takes less than 20 ms
&gt;&gt; 
&gt;&gt; For now we are going to disable the curb library, although this is the 
&gt;&gt; library which is recommended for speed purposes?
&gt;&gt; 
&gt;&gt; BTW, we are using RIAK 0.13.0
&gt;&gt; 
&gt;&gt; Dave
&gt; 

