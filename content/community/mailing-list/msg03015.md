---
title: "Re: Large ring_creation_size"
description: ""
project: community
lastmod: 2011-04-13T14:11:28-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03015"
mailinglist_parent_id: "msg03014"
author_name: "Greg Nelson"
project_section: "mailinglistitem"
sent_date: 2011-04-13T14:11:28-07:00
---


Ok, how about in this case I described? It runs out of memory with a single 
pair of nodes...

(Or did you mean there's a connection between each pair of vnodes?)
On Wednesday, April 13, 2011 at 1:56 PM, Jon Meredith wrote:
Hi Greg et al,
&gt; 
&gt; As you say largest known is not largest possible. Internally within Basho, 
&gt; the largest cluster we've experimented with so far had 50 nodes.
&gt; 
&gt; Going beyond that it's speculation from me about pain points. 
&gt; 
&gt; 1) It is true that you need enough file descriptors to start up all 
&gt; partitions when a node restarts - Riak checks if there is any handoff data 
&gt; pending for each partition. We have work scheduled to address that in the 
&gt; medium term. The plan is to only spin up partitions the node owns and any 
&gt; that have been started as fallbacks that handoff has not completed for. Until 
&gt; that work is done you will need a high ulimit with large ring sizes. 
&gt; 
&gt; 2) It is also true that Erlang runs a fully connected network, so there will 
&gt; be connections between each node pair in the cluster. We haven't determined 
&gt; the point at which it becomes a problem. 
&gt; 
&gt; So it looks like you'll be pushing the known limits. Basho will do our very 
&gt; best to help overcome any obstacles as you encounter them.
&gt; 
&gt; Jon Meredith
&gt; Basho Technologies.
&gt; 
&gt; On Wed, Apr 13, 2011 at 1:41 PM, Greg Nelson  wrote:
&gt; &gt; The largest known riak cluster != the largest possible riak cluster. ;-)
&gt; &gt; 
&gt; &gt; The inter node communication of the cluster depends on the data set and 
&gt; &gt; usage pattern, doesn't it? Or is there some constant overhead that tops out 
&gt; &gt; at a few hundred nodes? I should point out that we'll have big data, but 
&gt; &gt; not a huge number of keys. 
&gt; &gt; 
&gt; &gt; The number of vnodes in the cluster should be equal to the 
&gt; &gt; ring\\_creation\\_size under normal circumstances, shouldn't it? So when I have 
&gt; &gt; a one node cluster, that node is running ring\\_creation\\_size vnodes... File 
&gt; &gt; descriptors probably isn't a problem -- these machines won't be doing 
&gt; &gt; anything else, and the limits are set to 65536. 
&gt; &gt; 
&gt; &gt; Thinking about the internode communication you mentioned, that's probably 
&gt; &gt; where the resource hog is.. socket buffers, etc.
&gt; &gt; 
&gt; &gt; Anyway, I'd also love to hear more from basho. :)
&gt; &gt; On Wednesday, April 13, 2011 at 12:33 PM, sicul...@gmail.com wrote:
&gt; &gt; &gt; Ill just chime in and say that this is not practical for a few reasons. 
&gt; &gt; &gt; The largest known riak cluster has like 50 or 60 nodes. Afaik, inter node 
&gt; &gt; &gt; communication of erlang clusters top out at a few hundred nodes. I'm also 
&gt; &gt; &gt; under the impression that each physical node has to have enough file 
&gt; &gt; &gt; descriptors to accommodate every virtual node in the cluster. 
&gt; &gt; &gt; 
&gt; &gt; &gt; I'd love to hear more from basho. 
&gt; &gt; &gt; 
&gt; &gt; &gt; -alexander 
&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; Sent from my Verizon Wireless BlackBerry
&gt; &gt; &gt; 
&gt; &gt; &gt; -----Original Message-----
&gt; &gt; &gt; From: Greg Nelson 
&gt; &gt; &gt; Sender: riak-users-boun...@lists.basho.com
&gt; &gt; &gt; Date: Wed, 13 Apr 2011 12:13:34 
&gt; &gt; &gt; To: 
&gt; &gt; &gt; Subject: Large ring\\_creation\\_size
&gt; &gt; &gt; 
&gt; &gt; &gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; &gt; &gt; riak-users mailing list
&gt; &gt; &gt; riak-users@lists.basho.com
&gt; &gt; &gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; 
&gt; 
&gt; 
