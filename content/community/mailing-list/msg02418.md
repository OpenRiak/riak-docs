---
title: "Re: Number of replica for Luwak"
description: ""
project: community
lastmod: 2011-02-23T07:12:09-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02418"
mailinglist_parent_id: "msg02385"
author_name: "Bryan Fink"
project_section: "mailinglistitem"
sent_date: 2011-02-23T07:12:09-08:00
---


On Fri, Feb 18, 2011 at 8:54 PM, Les Mikesell  wrote:
&gt; What happens if there is a read of the object while it is in the process of
&gt; being updated if the update is several different operations?

Luwak streams work in an "all or nothing" fashion. That is, no read
will see the result of any stream until that stream is flushed. Luwak
blocks are immutable, so old file trees will still reference
completely valid old blocks while new ones are being written. The
last action of flushing a stream is to point the file-metdata object
(in the luwak\\_tld bucket) at the head of the new tree.

A flush will only occur when a stream closes, unless your program
explicitly calls luwak\\_put\\_stream:flush/1.

-Bryan

