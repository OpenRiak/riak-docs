---
title: "Is it possible to express JOIN and GROUP in Riak?"
description: ""
project: community
lastmod: 2012-02-20T05:54:28-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06652"
author_name: "Sergei Tulentsev"
project_section: "mailinglistitem"
sent_date: 2012-02-20T05:54:28-08:00
---


Let's say, I have events and users. I want to group events by properties of
users. In SQL it looks like this:

SELECT u.gender,
 u.age,
 u.nfr,
 u.nafr,
 e.event\\_id,
 COUNT(e.id) ecount,
 SUM(e.event\\_value) esum
FROM sn\\_users u
JOIN daily\\_events e on e.sn\\_user\\_id = u.sn\\_id
GROUP BY u.gender, u.age, u.nfr, u.nafr, e.event\\_id;

I understand that link walking with mapreduce may help me with this.
However, all examples of link walking I've seen so far substitute the
original document. That is, if I were to link-walk event document I'd get a
bunch of users, without events.

How it ideally should be (in my imagination).

- Links are walked on event documents and corresponding users are embedded
into events.
- Map function now acts on a "joined" document and can emit appropriate
values.
- Reduce - nothing fancy here.

Is it possible at all?

-- 
Best regards,
Sergei Tulentsev
