---
title: "Re: Multiple disks"
description: ""
project: community
lastmod: 2011-03-22T10:10:21-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02707"
mailinglist_parent_id: "msg02705"
author_name: "Greg Nelson"
project_section: "mailinglistitem"
sent_date: 2011-03-22T10:10:21-07:00
---


Thanks for all the responses!

Regarding RAID 10, I think for now that's out because we can't afford to cut 
storage capacity in half when we're already using 2-3x for Riak level 
redundancy. And adding more redundancy at the RAID layer just seems... 
incorrect.

Running multiple instances on each box is probably not an option either since 
-- as Luke pointed out -- we risk storing N replicas of an object on one 
machine. And given that we're considering something like 12 or even 24 disks 
per machine, we can't realistically make N larger than that.

RAID 5 seems like it may be a decent option, as we'd only lose out on the 
capacity of one drive. e.g., if we had 12 1TB disks per machine we'd get 11TB 
of capacity per machine. Of course, we need to consider the failure rates with 
that many disks in RAID 5 and whether that sufficiently addresses the problem 
of exposing each machine to a higher surface of failure. But again, we can lose 
a node -- that's what Riak is for! We also need to investigate the write 
performance of such a setup; that said, even though we have a write-heavy 
application, we'll probably not be that write-heavy.

Joseph: your patch looks interesting, as that's exactly what I first thought 
of. I figured the directories under the main storage dir corresponded to 
partitions. I'll definitely give your code a looksy. One thing that immediately 
jumped out at me is: what happens when a disk fails? Does the handoff mechanism 
really work seamlessly there? Or is the assumption that a failure can only 
happen at the node layer (rather than subsets of vnodes within a node) baked 
into the fundamental design of Riak?

Greg
On Tuesday, March 22, 2011 at 8:53 AM, Alexander Sicular wrote:
Ya, my original message just highlighted the standard 0,1,5 that most 
people/hardware should know/be able to support. There are better options and 10 
would be one of them. 
&gt; 
&gt; 
&gt; @siculars on twitter
&gt; http://siculars.posterous.com
&gt; 
&gt; Sent from my iPhone
&gt; 
&gt; On Mar 22, 2011, at 8:43, Ryan Zezeski  wrote:
&gt; 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; On Tue, Mar 22, 2011 at 10:01 AM, Alexander Sicular  
&gt; &gt; wrote:
&gt; &gt; &gt; Save your ops dudes the headache and just use raid 5 and be done with it.
&gt; &gt; &gt; 
&gt; &gt; 
&gt; &gt; Depending on the number of disks available I might even argue running 
&gt; &gt; software RAID 10 for better throughput and less chance of data loss (as 
&gt; &gt; long as you can afford to cut your avail storage in half on every machine). 
&gt; &gt; It's not too hard to setup on modern Linux distros (mdadm); at least I was 
&gt; &gt; doing it 5 years ago and I'm no sys admin. 
&gt; &gt; 
&gt; &gt; -Ryan 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

