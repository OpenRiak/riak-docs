---
title: "Re: Riak 1.0, Clojure and the Java Client"
description: ""
project: community
lastmod: 2011-10-10T16:35:33-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05118"
mailinglist_parent_id: "msg05103"
author_name: "Reid Draper"
project_section: "mailinglistitem"
sent_date: 2011-10-10T16:35:33-07:00
---


On Fri, Oct 7, 2011 at 7:23 PM, Tim Robinson  wrote:

&gt; Hi Russell,
&gt;
&gt; Thanks for the response and the history (which is always the hardest part
&gt; in understanding a current state).
&gt;
&gt; Here are some thoughts/response to your write up:
&gt;
&gt; &gt; Let me know why not, please
&gt;
&gt; I think you misread my statement here, as I said I do believe I \\*can\\* use
&gt; it.
&gt;
&gt; &gt; [link...] give a more realistic comparison..
&gt;
&gt; I had read that previously, however, I had not realized the history of the
&gt; client, so I didn't know that represented an apples to apples comparison.
&gt; Now I know... thanx.
&gt;
&gt; &gt; it would be great to create a Statebox
&gt;
&gt; I just read the Satebox page you linked as an example and have a hard time
&gt; thinking I would want to use this. While automation is always nice, the
&gt; overhead is an unnecessary burden. Since Clojure provides
&gt; coordinated/transactional data structures, it's already easy \\*enough\\* to
&gt; resolve conflicts within your natural code flow without having to resort to
&gt; the rationalizing of queued values. Also, I can only speak for myself, but I
&gt; believe most people would only want this to apply in selective cases such
&gt; that a performance hit is not taken for the other 90% of data where last
&gt; write winning is just fine.
&gt;
&gt; Does that make sense to you? I could be completely off considering I only
&gt; read the 5 minute 'read-me' blurb.
&gt;

It's not immediately obvious to me how STM could replace what statebox gives
you. I'd be curious if anyone has some clever ideas though.

&gt;
&gt; Thanks again.
&gt; Tim
&gt;
&gt;
&gt;
&gt; At Friday, 10/07/2011 on 4:08 pm Russell Brown wrote:
&gt;
&gt; Hi Tim,
&gt;
&gt; On 7 Oct 2011, at 22:45, Tim Robinson wrote:
&gt;
&gt;
&gt; Hello,
&gt;
&gt; I have been \\*slowly\\* learning & evaluating Riak for a product I am
&gt; developing. Originally I gave Riak a whirl about 6 months back, but stopped
&gt; due to some missing features. With the recent release of 1.0 I've decided to
&gt; give it another chance.
&gt;
&gt; So here are a few kick off questions I hope you can help answer to get me
&gt; started again:
&gt;
&gt; 1. Since I am back to square one, I am looking at the clients again....
&gt; Currently my programming language of choice is Clojure, and initially I
&gt; had been playing around with the Clj-Riak library (
&gt; https://github.com/mmcgrana/clj-riak) which I had believed was a thin
&gt; wrapper around the standard Java protocol buffer client maintained by Basho,
&gt; however in looking at the source I notice clj-riak actually uses an
&gt; alternative client, linked here:
&gt; https://github.com/krestenkrab/riak-java-pb-client, written by some fellow
&gt; at trifork (isn't trifork Basho's primary investor?). Anyways it looks as
&gt; though this Kresten fellow has been able to improve the java client's
&gt; performance by a factor of 10. Has anyone upgraded this alternate version,
&gt; or have an opinion to its alignment with Riak 1.0?
&gt;
&gt;
&gt; So, (Dr.) Kresten's PB client was integrated into the Basho client about
&gt; 0.14. Basho fixed some minor bugs in it for our 0.14.1 release. As of now
&gt; (1.0rc1) it is one of the two bedrock APIs of the riak-java-client, although
&gt; it is somewhat smoothed over by a compatibility layer that allows you to use
&gt; either HTTP or PB with the same API. The Basho repo has fixes to Kresten's
&gt; repo, so, bottom line, if you want raw speed and can sacrifice API parity,
&gt; use the pbc.RiakClient from the 1.0rc1 release of Basho's riak-java-client,
&gt; it is basically Trifork code with some fixes.
&gt;
&gt;
&gt; Note: I'm sure I can use the new java client,
&gt;
&gt;
&gt; Let me know why not, please.
&gt;
&gt; but a 10x speed up sounds pretty appealing and I'm wondering why it's not
&gt; already a topic here.
&gt;
&gt;
&gt; Figures here (http://wiki.basho.com/Java-Client-Benchmark.html) give a
&gt; more realistic comparison, I am seeing 2.5x-4x speed up, still not to be
&gt; ignored.
&gt;
&gt; I would really like to be able to mould the riak-java-client to clojure.
&gt; Better still, it would be great to create a Statebox (
&gt; https://github.com/mochi/statebox) like clojure client for Riak. Greg Burd
&gt; (at Basho) and I have already talked about this, and if you're interested,
&gt; collaboration would be cool.
&gt;
&gt; I'll leave your other question to someone better informed.
&gt;
&gt; Cheers
&gt;
&gt; Russell
&gt;
&gt;
&gt; 2. Are there any known plans for a Riak cloud service? I know about Joyent,
&gt; but frankly I don't like their business model and can't see using them. Just
&gt; curious if there's anything in the works.
&gt;
&gt; Note: as a preemptive answe: I'm looking for a service which is 1. more
&gt; reasonably priced, 2. has an initial free tier and 3. automates the upgrades
&gt; and the linking/start-up process... so really, I'm looking for the MongoHQ
&gt; of Riak (https://mongohq.com/pricing).
&gt;
&gt; Thanks,
&gt; Tim Robinson
