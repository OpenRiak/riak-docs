---
title: "Updating metadata with Erlang PBC"
description: ""
project: community
lastmod: 2010-05-26T04:45:42-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00433"
author_name: "Mikl Kurkov"
project_section: "mailinglistitem"
sent_date: 2010-05-26T04:45:42-07:00
---



Hi!

It seems that protobuffers client doesn't allow to update metadata of
object.

Example: 

`-module(test).
-compile(export_all).

test1(Host, Port) -&gt;
 {ok,C} = riakc_pb_socket:start_link(Host, Port),
 O0 = riakc_obj:new(&lt;&lt;"b"&gt;&gt;, &lt;&lt;"k"&gt;&gt;, &lt;&lt;"d"&gt;&gt;),
 {ok, O1} = riakc_pb_socket:put(C, O0, [return_body]),
 M1 = riakc_obj:get_metadata(O1),
 M2 = dict:store(&lt;&lt;"Links"&gt;&gt;, [{{&lt;&lt;"b"&gt;&gt;, &lt;&lt;"k1"&gt;&gt;}, &lt;&lt;"t1"&gt;&gt;}], M1),
 O2 = riakc_obj:update_metadata(O1, M2),
 riakc_pb_socket:put(C, O2).`

Runnig test:test1("localhost", 8081), I see error 
{error,{required\\_field\\_is\\_undefined,1,bytes}}.

After tracing I realised that missing field is Value from RpbContent
structure. 
So updating value with riakc\\_obj:update\\_value/2 before calling put does the
trick. 
But I think metadata supposed to be updated without need of updating value.

--
Mikl
-- 
View this message in context: 
http://riak-users.197444.n3.nabble.com/Updating-metadata-with-Erlang-PBC-tp844697p844697.html
Sent from the Riak Users mailing list archive at Nabble.com.

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

