---
title: "Very, very slow data insert on two node cluster"
description: ""
project: community
lastmod: 2011-05-06T02:49:07-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03257"
author_name: "Vlatko Basic"
project_section: "mailinglistitem"
sent_date: 2011-05-06T02:49:07-07:00
---

Hi,

I've build a cluster with two physical Ubuntu 10.10 64-bit 4GB machines (laptop, 2 cores, 
2.4GHz and desktop, 4 cores, 3.1GHz) and I am trying to "load\\_data goog.csv" 
(around 1500 records) from a Fast Track tutorial. It took over 15 minutes.

Riak installation (both from DEB package) is correct and working. Other 
examples worked as shown.

1. Inserts are very, very slow. Maybe 1 insert in 2 secs??? Memory used around 
50%. Network is wired.
2. All inserts go to the local node that I'm working on, the other node is idle.

I attached status for both nodes and bucket properties.

Is it a bug, or have I made a bug? :-)

Thank for any ideas...


vlatko

P.S.: Sorry if this email was sent twice.

{"props":{"name":"goog","n\\_val":3,"allow\\_mult":false,"last\\_write\\_wins":false,"precommit":[],"postcommit":[],"chash\\_keyfun":{"mod":"riak\\_core\\_util","fun":"chash\\_std\\_keyfun"},"linkfun":{"mod":"riak\\_kv\\_wm\\_link\\_walker","fun":"mapreduce\\_linkfun"},"old\\_vclock":86400,"young\\_vclock":20,"big\\_vclock":50,"small\\_vclock":10,"r":"quorum","w":"quorum","dw":"quorum","rw":"quorum"}}
node\\_put\\_fsm\\_time\\_95 1870
connected\\_nodes ["riak@192.168.5.50"]
webmachine\\_version 1.8.0
node\\_put\\_fsm\\_time\\_99 1974
kernel\\_version 2.13.5
pbc\\_connects 0
ring\\_creation\\_size 64
sys\\_otp\\_release R13B04
crypto\\_version 1.6.4
node\\_get\\_fsm\\_time\\_mean 711
sys\\_process\\_count 192
vnode\\_gets\\_total 772
skerl\\_version 1.0.0
luke\\_version 0.2.3
node\\_put\\_fsm\\_time\\_100 1912
node\\_gets 31
sys\\_global\\_heaps\\_size 0
sys\\_system\\_version Erlang R13B04 (erts-5.7.5) [source] [64-bit] [smp:2:2] 
[rq:2] [async-threads:64] [kernel-poll:true]
mem\\_allocated 3.968802816E9
ring\\_members ["riak@192.168.5.49","riak@192.168.5.50"]
ring\\_ownership [{'riak@192.168.5.50',31},{'riak@192.168.5.49',33}]
node\\_puts\\_total 460
sys\\_threads\\_enabled true
stdlib\\_version 1.16.5
node\\_put\\_fsm\\_time\\_median 1312
cpu\\_nprocs 664
read\\_repairs\\_total 1
sys\\_system\\_architecture x86\\_64-unknown-linux-gnu
riak\\_kv\\_version 0.14.1
node\\_puts 31
riak\\_err\\_version 1.0.1
storage\\_backend riak\\_kv\\_bitcask\\_backend
mem\\_total 4.085137408E9
luwak\\_version 1.0.0
executing\\_mappers 0
pbc\\_connects\\_total 0
node\\_get\\_fsm\\_time\\_100 1382
cpu\\_avg15 13
sys\\_logical\\_processors 2
node\\_get\\_fsm\\_time\\_median 479
sasl\\_version 2.1.9
vnode\\_puts\\_total 713
bitcask\\_version 1.1.5
vnode\\_gets 45
nodename riak@192.168.5.49
os\\_mon\\_version 2.2.5
node\\_put\\_fsm\\_time\\_mean 1248
vnode\\_puts 45
cpu\\_avg5 5
sys\\_heap\\_type private
mochiweb\\_version 1.7.1
pbc\\_active 0
runtime\\_tools\\_version 1.8.3
sys\\_driver\\_version 1.5
cpu\\_avg1 0
erlang\\_js\\_version 0.5.0
node\\_get\\_fsm\\_time\\_99 1484
node\\_gets\\_total 493
riak\\_core\\_version 0.14.1
node\\_get\\_fsm\\_time\\_95 1422
cluster\\_info\\_version 1.1.0
sys\\_thread\\_pool\\_size 64
sys\\_wordsize 8
read\\_repairs 1
sys\\_smp\\_support true
ring\\_num\\_partitions 64node\\_put\\_fsm\\_time\\_95 0
connected\\_nodes ["riak@192.168.5.49"]
webmachine\\_version 1.8.0
node\\_put\\_fsm\\_time\\_99 0
kernel\\_version 2.13.5
pbc\\_connects 0
ring\\_creation\\_size 64
sys\\_otp\\_release R13B04
crypto\\_version 1.6.4
node\\_get\\_fsm\\_time\\_mean 0
sys\\_process\\_count 190
vnode\\_gets\\_total 714
skerl\\_version 1.0.0
luke\\_version 0.2.3
node\\_put\\_fsm\\_time\\_100 0
node\\_gets 0
sys\\_global\\_heaps\\_size 0
sys\\_system\\_version Erlang R13B04 (erts-5.7.5) [source] [64-bit] [smp:4:4] 
[rq:4] [async-threads:64] [kernel-poll:true]
mem\\_allocated 1939828736
ring\\_members ["riak@192.168.5.49","riak@192.168.5.50"]
ring\\_ownership [{'riak@192.168.5.50',31},{'riak@192.168.5.49',33}]
node\\_puts\\_total 1
sys\\_threads\\_enabled true
stdlib\\_version 1.16.5
node\\_put\\_fsm\\_time\\_median 0
cpu\\_nprocs 477
read\\_repairs\\_total 0
sys\\_system\\_architecture x86\\_64-unknown-linux-gnu
riak\\_kv\\_version 0.14.1
node\\_puts 0
riak\\_err\\_version 1.0.1
storage\\_backend riak\\_kv\\_bitcask\\_backend
mem\\_total 3.890270208E9
luwak\\_version 1.0.0
executing\\_mappers 0
pbc\\_connects\\_total 0
node\\_get\\_fsm\\_time\\_100 0
cpu\\_avg15 148
sys\\_logical\\_processors 4
node\\_get\\_fsm\\_time\\_median 0
sasl\\_version 2.1.9
vnode\\_puts\\_total 672
bitcask\\_version 1.1.5
vnode\\_gets 48
nodename riak@192.168.5.50
os\\_mon\\_version 2.2.5
node\\_put\\_fsm\\_time\\_mean 0
vnode\\_puts 48
cpu\\_avg5 143
sys\\_heap\\_type private
mochiweb\\_version 1.7.1
pbc\\_active 0
runtime\\_tools\\_version 1.8.3
sys\\_driver\\_version 1.5
cpu\\_avg1 118
erlang\\_js\\_version 0.5.0
node\\_get\\_fsm\\_time\\_99 0
node\\_gets\\_total 1
riak\\_core\\_version 0.14.1
node\\_get\\_fsm\\_time\\_95 0
cluster\\_info\\_version 1.1.0
sys\\_thread\\_pool\\_size 64
sys\\_wordsize 8
read\\_repairs 0
sys\\_smp\\_support true
ring\\_num\\_partitions 64

