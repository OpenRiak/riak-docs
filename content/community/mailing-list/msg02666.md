---
title: "A script to check bitcask keydir sizes"
description: ""
project: community
lastmod: 2011-03-16T12:05:00-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02666"
author_name: "Aphyr"
project_section: "mailinglistitem"
sent_date: 2011-03-16T12:05:00-07:00
---


I'm trying to track some basic metrics so we can plan for cluster 
capacity, monitor transfers, etc. Figured this might be of interest to 
other riak admins. Apologies if my erlang is nonidiomatic, I'm still 
learning. :)


#!/usr/bin/env escript
%%! -name riakstatuscheck -setcookie riak

main([]) -&gt; main(["riak@127.0.0.1"]);
main([Node]) -&gt;
 io:format("~w\\n", [
 lists:foldl(
 fun({\\_VNode, Count}, Sum) -&gt; Sum + Count end,
 0,
 rpc:call(list\\_to\\_atom(Node), riak\\_kv\\_bitcask\\_backend, key\\_counts, [])
 )
 ]).


$ ./riakstatus riak@127.0.0.1
18729

