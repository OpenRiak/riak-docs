---
title: "Riak Search."
description: ""
project: community
lastmod: 2011-12-01T03:29:10-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05831"
author_name: "Chris Cook"
project_section: "mailinglistitem"
sent_date: 2011-12-01T03:29:10-08:00
---


Hi,

Sorry, but I've done a lot of googling and haven't been to work out where
this is going wrong, could someone please point out where I may be going
wrong with it. I have riak search enabled and set to true and riak clusters
all restarted. I go through the following steps below using
riak-erlang-http-client, but whenever I do a search I get {ok, []} back.

Erlang R14B02 (erts-5.8.3) [source] [rq:1] [async-threads:0]
[kernel-poll:false]

Eshell V5.8.3 (abort with ^G)
1&gt; [ ok = application:start(A) || A &lt;- [sasl, ibrowse] ],
1&gt; IP = "127.0.0.1",
1&gt; Port = 8098,
1&gt; Prefix = "riak",
1&gt; Options = [],
1&gt; C = rhc:create(IP, Port, Prefix, Options).

---- Snipped Progress Reports from here, everything start with ok ----

{rhc,"127.0.0.1",8098,"riak",[{client\\_id,"At5+Yg=="}]}
2&gt; rhc:set\\_bucket(C, "my\\_books", [{&lt;&lt;"precommit"&gt;&gt;, [{struct, [{&lt;&lt;"mod"&gt;&gt;,
&lt;&lt;"riak\\_search\\_kv\\_hook"&gt;&gt;}, {&lt;&lt;"fun"&gt;&gt;,&lt;&lt;"precommit"&gt;&gt;}]}]}]).

=PROGRESS REPORT==== 1-Dec-2011::11:13:43 ===
 supervisor: {local,inet\\_gethost\\_native\\_sup}
 started: [{pid,&lt;0.53.0&gt;},{mfa,{inet\\_gethost\\_native,init,[[]]}}]

=PROGRESS REPORT==== 1-Dec-2011::11:13:43 ===
 supervisor: {local,kernel\\_safe\\_sup}
 started: [{pid,&lt;0.52.0&gt;},
 {name,inet\\_gethost\\_native\\_sup},
 {mfargs,{inet\\_gethost\\_native,start\\_link,[]}},
 {restart\\_type,temporary},
 {shutdown,1000},
 {child\\_type,worker}]
ok
3&gt; PropList = [{&lt;&lt;"id"&gt;&gt;, &lt;&lt;"123456789"&gt;&gt;},{&lt;&lt;"title"&gt;&gt;, &lt;&lt;"The Title"&gt;&gt;},
{&lt;&lt;"content"&gt;&gt;, &lt;&lt;"The Content"&gt;&gt;}].
[{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"123456789"&gt;&gt;},
 {&lt;&lt;"title"&gt;&gt;,&lt;&lt;"The Title"&gt;&gt;},
 {&lt;&lt;"content"&gt;&gt;,&lt;&lt;"The Content"&gt;&gt;}]
4&gt; Obj = riakc\\_obj:new("my\\_books", &lt;&lt;"123456789"&gt;&gt;, PropList,
list\\_to\\_binary("application/x-erlang-term")).
{riakc\\_obj,"my\\_books",&lt;&lt;"123456789"&gt;&gt;,undefined,[],
 {dict,1,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],...},

{{[],[],[],[],[],[],[],[],[],[],[[&lt;&lt;...&gt;&gt;|...]],[],[],...}}},
 [{&lt;&lt;"id"&gt;&gt;,&lt;&lt;"123456789"&gt;&gt;},
 {&lt;&lt;"title"&gt;&gt;,&lt;&lt;"The Title"&gt;&gt;},
 {&lt;&lt;"content"&gt;&gt;,&lt;&lt;"The Content"&gt;&gt;}]}
5&gt; rhc:put(C, Obj).
ok
6&gt; rhc:search(C, "my\\_books", &lt;&lt;"content:The Content"&gt;&gt;).
{ok,[]}
7&gt; rhc:search(C, &lt;&lt;"my\\_books"&gt;&gt;, &lt;&lt;"content:The Content"&gt;&gt;).
{ok,[]}
8&gt; {ok, Obj0} = rhc:get(C, &lt;&lt;"123456789"&gt;&gt;).
\\*\\* exception error: undefined function rhc:get/2
9&gt; {ok, Obj0} = rhc:get(C, "my\\_books", &lt;&lt;"123456789"&gt;&gt;).
{ok,{riakc\\_obj,"my\\_books",&lt;&lt;"123456789"&gt;&gt;,
 &lt;&lt;107,206,97,96,96,96,204,96,202,5,82,28,202,156,255,126,
 250,45,186,178,45,131,41,...&gt;&gt;,
 [{{dict,3,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],...},
 {{[],[],[],[],[],[],[],[],[],[],...}}},
 &lt;&lt;131,108,0,0,0,3,104,2,109,0,0,0,2,105,100,109,0,0,0,
 ...&gt;&gt;}],
 undefined,undefined}}
10&gt;

It's probably something to do with the content type, but I'm really unsure,
many thanks in advance Chris.
