---
title: "Dissecting a riak crash"
description: ""
project: community
lastmod: 2012-12-06T12:01:27-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09453"
author_name: "Deepak Balasubramanyam"
project_section: "mailinglistitem"
sent_date: 2012-12-06T12:01:27-08:00
---


Hi,

I'm running a 4 member riak cluster that failed today for unknown reasons.
At a particular point in time, I noticed that the HTTP riak connector began
refusing connections to my client

java.lang.RuntimeException: com.basho.riak.client.RiakRetryFailedException:
com.basho.riak.client.http.response.RiakIORuntimeException:
org.apache.http.conn.HttpHostConnectException: \\*Connection to
http://localhost:XXXX refused\\*

I initiated a start command on all clusters just in case some of them were
down. Cluster 1 (main) and cluster 4 accepted the start command. The others
maintained that they were already running.

After the system was back up I began my hunt for error / crash reports and
found nothing substantial. The error.log file on cluster 1 contained this

2012-12-06 08:44:35.322 [error] &lt;0.15539.62&gt; gen\\_fsm &lt;0.15539.62&gt; in state
wait\\_pipeline\\_shutdown terminated with reason: \\*{sink\\_died,normal}\\*
2012-12-06 08:44:35.423 [error] &lt;0.15539.62&gt; CRASH REPORT Process
&lt;0.15539.62&gt; with 0 neighbours crashed with reason: {sink\\_died,normal}
2012-12-06 08:44:35.428 [error] &lt;0.164.0&gt; Supervisor riak\\_pipe\\_builder\\_sup
had child undefined started with {riak\\_pipe\\_builder,start\\_link,undefined}
at &lt;0.15539.62&gt; exit with reason {sink\\_died,normal} in context
child\\_terminated

However I believe this error is normal, as mentioned here -
http://riak-users.197444.n3.nabble.com/Safe-to-ignore-a-sink-died-normal-error-td3824989.html

I ran riaknostic on the failed cluster through the 'riak-admin diag'
command and it did not find any crash reports either. I'm
running riak-1.1.4.

Do you have any pointers / advise that I could use ? Any help is
appreciated.

Thank you
-Deepak
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

