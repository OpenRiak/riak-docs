---
title: "Re: riak stats via http interface not working"
description: ""
project: community
lastmod: 2012-12-17T12:51:56-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09607"
mailinglist_parent_id: "msg09606"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-12-17T12:51:56-08:00
---


Michael,

Make sure the mapred\\_name and stats\\_urlpath values are strings, not atoms.
e.g.:

{mapred\\_name, "mapred"},
{stats\\_urlpath, "stats"}

On Mon, Dec 17, 2012 at 2:48 PM, Michael Johnson  wrote:

&gt; For some reason, I am not able to get the riak stats via the http
&gt; interface. Here is what I get:
&gt;
&gt; -bash-4.1$ curl -k https://127.0.0.1:8091/stats/ -E 'text/plain' -D -
&gt; HTTP/1.1 400 Bad Request
&gt; Server: MochiWeb/1.1 WebMachine/1.9.0 (someone had painted it blue)
&gt; Date: Mon, 17 Dec 2012 20:35:25 GMT
&gt; Content-Type: text/plain
&gt; Content-Length: 150
&gt;
&gt; This resource accepts POSTs with bodies containing JSON of the form:
&gt; {
&gt; "inputs":[...list of inputs...],
&gt; "query":[...list of map/reduce phases...]
&gt; }
&gt;
&gt; And here is the riak\\_kv section of my app.config:
&gt;
&gt; {riak\\_kv, [
&gt; {hook\\_js\\_vm\\_count, 2},
&gt; {http\\_url\\_encoding, on},
&gt; {js\\_max\\_vm\\_mem, 8},
&gt; {js\\_source\\_dir, "/tmp/js\\_source"},
&gt; {js\\_thread\\_stack, 16},
&gt; {legacy\\_keylisting, false},
&gt; {legacy\\_stats, true},
&gt; {listkeys\\_backpressure, true},
&gt; {map\\_cache\\_size, 10000},
&gt; {map\\_js\\_vm\\_count, 8},
&gt; {mapper\\_batch\\_size, 5},
&gt; {mapred\\_2i\\_pipe, true},
&gt; {mapred\\_name, mapred},
&gt; {mapred\\_queue\\_dir, "/var/lib/riak/mr\\_queue"},
&gt; {mapred\\_system, pipe},
&gt; {raw\\_name, "riak"},
&gt; {reduce\\_js\\_vm\\_count, 6},
&gt; {riak\\_kv\\_stat, true},
&gt; {stats\\_urlpath, stats},
&gt; {storage\\_backend, riak\\_kv\\_eleveldb\\_backend},
&gt; {vnode\\_vclocks, true}
&gt; ]},
&gt;
&gt; I have tried single and double quoting 'stats' in the stats\\_urlpath value,
&gt; and I have tried commenting that out as well as setting legacy\\_stats to
&gt; false and simply commenting out the legacy\\_stats declaration. The result
&gt; is always the same. I originally was running riak 1.2.0. Thinking this
&gt; might be and issue that was resolved in riak 1.2.1, I upgraded and
&gt; restarted all the nodes, but continue the get the exact same results.
&gt;
&gt; In all cases I can run 'riak-admin status' and get the data that way. Is
&gt; this a known issue, or am I missing something? I found some bug reports
&gt; that might be related be related, but nothing that I can say for sure.
&gt;
&gt; If someone else can let me know if they have the same problem, that would
&gt; be immensely helpful as it would confirm I an not just missing something.
&gt; I've read over the docs several times and have not been able to find
&gt; anything that indicates I am doing anything wrong, so I am at a bit of a
&gt; loss right now.
&gt;
&gt; Thanks!
&gt;

-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
