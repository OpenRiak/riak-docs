---
title: "Re: Node cannot join"
description: ""
project: community
lastmod: 2012-08-21T09:00:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08342"
mailinglist_parent_id: "msg08338"
author_name: "Daniel Iwan"
project_section: "mailinglistitem"
sent_date: 2012-08-21T09:00:57-07:00
---


Thanks Ryan!

I'll give it a try. Where I can find details about it, parameters options etc.?


D.


On 21 August 2012 14:36, Ryan Zezeski  wrote:
&gt; Daniel,
&gt;
&gt; Cluster operations (invoked by `riak-admin cluster`) are now multi-phase.
&gt; Instead of calling an operation and it taking effect immediately you need to
&gt; stage your changes, view your changes, and then commit them. E.g.
&gt;
&gt; riak-admin cluster join blah
&gt;
&gt; riak-admin cluster plan
&gt;
&gt; riak-admin cluster commit
&gt;
&gt; There is an `-f` option to keep the old behavior but we recommend against
&gt; this. Staged clustering was put in place to keep users from hurting their
&gt; clusters and to make multiple changes more efficient.
&gt;
&gt; -Z
&gt;
&gt; On Tue, Aug 21, 2012 at 9:28 AM, Daniel Iwan  wrote:
&gt;&gt;
&gt;&gt; Hi
&gt;&gt;
&gt;&gt; In my setup everything worked fine until I upgraded to riak 1.2
&gt;&gt; (although this may be a coincidence)
&gt;&gt; Nodes are installed from scratch with changes only to db backend (I'm
&gt;&gt; using eLevelDB)
&gt;&gt; and names.
&gt;&gt; For some reason node cannot join to another.
&gt;&gt; What am I doing wrong?
&gt;&gt;
&gt;&gt; I'm using Ubuntu 10.04 but I've seen the same behaviour on Ubuntu 12.04
&gt;&gt; I may miss openssl dependency. I don't know if that matters
&gt;&gt;
&gt;&gt;
&gt;&gt; user@node2:~$ riak-admin cluster join riak@10.173.240.1
&gt;&gt; Attempting to restart script through sudo -H -u riak
&gt;&gt; Success: staged join request for 'riak@10.173.240.2' to
&gt;&gt; 'riak@10.173.240.1'
&gt;&gt;
&gt;&gt;
&gt;&gt; user@node1:~$ riak-admin member-status
&gt;&gt; Attempting to restart script through sudo -H -u riak
&gt;&gt; ================================= Membership
&gt;&gt; ==================================
&gt;&gt; Status Ring Pending Node
&gt;&gt;
&gt;&gt; -------------------------------------------------------------------------------
&gt;&gt; joining 0.0% -- 'riak@10.173.240.2'
&gt;&gt; valid 100.0% -- 'riak@10.173.240.1'
&gt;&gt;
&gt;&gt; -------------------------------------------------------------------------------
&gt;&gt;
&gt;&gt; Valid:1 / Leaving:0 / Exiting:0 / Joining:1 / Down:0
&gt;&gt; user@node1:~$
&gt;&gt; user@node1:~$ riak-admin transfers
&gt;&gt;
&gt;&gt; Attempting to restart script through sudo -H -u riak
&gt;&gt; No transfers active
&gt;&gt;
&gt;&gt; Active Transfers:
&gt;&gt;
&gt;&gt; user@node1:~$
&gt;&gt;
&gt;&gt; riak-admin status
&gt;&gt; Attempting to restart script through sudo -H -u riak
&gt;&gt; 1-minute stats for 'riak@10.173.240.1'
&gt;&gt; -------------------------------------------
&gt;&gt; vnode\\_gets : 0
&gt;&gt; vnode\\_gets\\_total : 0
&gt;&gt; vnode\\_puts : 0
&gt;&gt; vnode\\_puts\\_total : 0
&gt;&gt; vnode\\_index\\_reads : 0
&gt;&gt; vnode\\_index\\_reads\\_total : 0
&gt;&gt; vnode\\_index\\_writes : 0
&gt;&gt; vnode\\_index\\_writes\\_total : 0
&gt;&gt; vnode\\_index\\_writes\\_postings : 0
&gt;&gt; vnode\\_index\\_writes\\_postings\\_total : 0
&gt;&gt; vnode\\_index\\_deletes : 0
&gt;&gt; vnode\\_index\\_deletes\\_total : 0
&gt;&gt; vnode\\_index\\_deletes\\_postings : 0
&gt;&gt; vnode\\_index\\_deletes\\_postings\\_total : 0
&gt;&gt; node\\_gets : 0
&gt;&gt; node\\_gets\\_total : 0
&gt;&gt; node\\_get\\_fsm\\_siblings\\_mean : 0
&gt;&gt; node\\_get\\_fsm\\_siblings\\_median : 0
&gt;&gt; node\\_get\\_fsm\\_siblings\\_95 : 0
&gt;&gt; node\\_get\\_fsm\\_siblings\\_99 : 0
&gt;&gt; node\\_get\\_fsm\\_siblings\\_100 : 0
&gt;&gt; node\\_get\\_fsm\\_objsize\\_mean : 0
&gt;&gt; node\\_get\\_fsm\\_objsize\\_median : 0
&gt;&gt; node\\_get\\_fsm\\_objsize\\_95 : 0
&gt;&gt; node\\_get\\_fsm\\_objsize\\_99 : 0
&gt;&gt; node\\_get\\_fsm\\_objsize\\_100 : 0
&gt;&gt; node\\_get\\_fsm\\_time\\_mean : 0
&gt;&gt; node\\_get\\_fsm\\_time\\_median : 0
&gt;&gt; node\\_get\\_fsm\\_time\\_95 : 0
&gt;&gt; node\\_get\\_fsm\\_time\\_99 : 0
&gt;&gt; node\\_get\\_fsm\\_time\\_100 : 0
&gt;&gt; node\\_puts : 0
&gt;&gt; node\\_puts\\_total : 0
&gt;&gt; node\\_put\\_fsm\\_time\\_mean : 0
&gt;&gt; node\\_put\\_fsm\\_time\\_median : 0
&gt;&gt; node\\_put\\_fsm\\_time\\_95 : 0
&gt;&gt; node\\_put\\_fsm\\_time\\_99 : 0
&gt;&gt; node\\_put\\_fsm\\_time\\_100 : 0
&gt;&gt; read\\_repairs : 0
&gt;&gt; read\\_repairs\\_total : 0
&gt;&gt; coord\\_redirs\\_total : 0
&gt;&gt; executing\\_mappers : 0
&gt;&gt; precommit\\_fail : 0
&gt;&gt; postcommit\\_fail : 0
&gt;&gt; pbc\\_active : 0
&gt;&gt; pbc\\_connects : 0
&gt;&gt; pbc\\_connects\\_total : 0
&gt;&gt; cpu\\_nprocs : 340
&gt;&gt; cpu\\_avg1 : 182
&gt;&gt; cpu\\_avg5 : 136
&gt;&gt; cpu\\_avg15 : 92
&gt;&gt; mem\\_total : 4154609664
&gt;&gt; mem\\_allocated : 1475477504
&gt;&gt; disk : [{"/",54417668,2},
&gt;&gt; {"/dev",2024188,1},
&gt;&gt; {"/dev/shm",2028616,0},
&gt;&gt; {"/var/run",2028616,1},
&gt;&gt; {"/var/lock",2028616,0},
&gt;&gt; {"/lib/init/rw",2028616,0},
&gt;&gt; {"/var/lib/ureadahead/debugfs",54417668,2},
&gt;&gt; {"/media/ARRAY1",10739982336,1},
&gt;&gt; {"/boot",186663,22}]
&gt;&gt; nodename : 'riak@10.173.240.1'
&gt;&gt; connected\\_nodes : ['riak@10.173.240.2']
&gt;&gt; sys\\_driver\\_version : &lt;&lt;"2.0"&gt;&gt;
&gt;&gt; sys\\_global\\_heaps\\_size : 0
&gt;&gt; sys\\_heap\\_type : private
&gt;&gt; sys\\_logical\\_processors : 4
&gt;&gt; sys\\_otp\\_release : &lt;&lt;"R15B01"&gt;&gt;
&gt;&gt; sys\\_process\\_count : 1392
&gt;&gt; sys\\_smp\\_support : true
&gt;&gt; sys\\_system\\_version : &lt;&lt;"Erlang R15B01 (erts-5.9.1) [source] [64-bit]
&gt;&gt; [smp:4:4] [async-threads:64] [kernel-poll:true]"&gt;&gt;
&gt;&gt; sys\\_system\\_architecture : &lt;&lt;"x86\\_64-unknown-linux-gnu"&gt;&gt;
&gt;&gt; sys\\_threads\\_enabled : true
&gt;&gt; sys\\_thread\\_pool\\_size : 64
&gt;&gt; sys\\_wordsize : 8
&gt;&gt; ring\\_members : ['riak@10.173.240.1','riak@10.173.240.2']
&gt;&gt; ring\\_num\\_partitions : 64
&gt;&gt; ring\\_ownership : &lt;&lt;"[{'riak@10.173.240.1',64}]"&gt;&gt;
&gt;&gt; ring\\_creation\\_size : 64
&gt;&gt; storage\\_backend : riak\\_kv\\_eleveldb\\_backend
&gt;&gt; erlydtl\\_version : &lt;&lt;"0.7.0"&gt;&gt;
&gt;&gt; riak\\_control\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; cluster\\_info\\_version : &lt;&lt;"1.2.2"&gt;&gt;
&gt;&gt; riak\\_api\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; riak\\_search\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; merge\\_index\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; riak\\_kv\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; riak\\_pipe\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; riak\\_core\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; lager\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; syntax\\_tools\\_version : &lt;&lt;"1.6.8"&gt;&gt;
&gt;&gt; compiler\\_version : &lt;&lt;"4.8.1"&gt;&gt;
&gt;&gt; bitcask\\_version : &lt;&lt;"1.5.1"&gt;&gt;
&gt;&gt; basho\\_stats\\_version : &lt;&lt;"1.0.2"&gt;&gt;
&gt;&gt; luke\\_version : &lt;&lt;"0.2.5"&gt;&gt;
&gt;&gt; webmachine\\_version : &lt;&lt;"1.9.2"&gt;&gt;
&gt;&gt; mochiweb\\_version : &lt;&lt;"1.5.1"&gt;&gt;
&gt;&gt; inets\\_version : &lt;&lt;"5.9"&gt;&gt;
&gt;&gt; erlang\\_js\\_version : &lt;&lt;"1.2.0"&gt;&gt;
&gt;&gt; runtime\\_tools\\_version : &lt;&lt;"1.8.8"&gt;&gt;
&gt;&gt; os\\_mon\\_version : &lt;&lt;"2.2.9"&gt;&gt;
&gt;&gt; riak\\_sysmon\\_version : &lt;&lt;"1.1.2"&gt;&gt;
&gt;&gt; ssl\\_version : &lt;&lt;"5.0.1"&gt;&gt;
&gt;&gt; public\\_key\\_version : &lt;&lt;"0.15"&gt;&gt;
&gt;&gt; crypto\\_version : &lt;&lt;"2.1"&gt;&gt;
&gt;&gt; sasl\\_version : &lt;&lt;"2.2.1"&gt;&gt;
&gt;&gt; stdlib\\_version : &lt;&lt;"1.18.1"&gt;&gt;
&gt;&gt; kernel\\_version : &lt;&lt;"2.15.1"&gt;&gt;
&gt;&gt; memory\\_total : 26853928
&gt;&gt; memory\\_processes : 6744452
&gt;&gt; memory\\_processes\\_used : 6744438
&gt;&gt; memory\\_system : 20109476
&gt;&gt; memory\\_atom : 429569
&gt;&gt; memory\\_atom\\_used : 406875
&gt;&gt; memory\\_binary : 58504
&gt;&gt; memory\\_code : 9277444
&gt;&gt; memory\\_ets : 774080
&gt;&gt;
&gt;&gt;
&gt;&gt; D.
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

