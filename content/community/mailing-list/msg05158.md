---
title: "Re: Timeout in precommit hook"
description: ""
project: community
lastmod: 2011-10-14T05:23:00-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05158"
mailinglist_parent_id: "msg05156"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-10-14T05:23:00-07:00
---


Hal,

I would be interested to see what the format of the object is after it has
passed through your precommit hook. We recently fixed some bugs related to
the JSON format of riak\\_objects that might result in an unclean round-trip
through the JavaScript VM. That is, the format coming out is not the same as
went in.

Could you do the first step (store a new object through your precommit
hook), and then fetch it by attaching to the console? Here's what you can
do on the console:

1&gt; {ok, C} = riak:local\\_client().
2&gt; rp(C:get(&lt;&lt;"bucket"&gt;&gt;,&lt;&lt;"key"&gt;&gt;)).

Of course, replace "bucket" and "key" as appropriate for your object.

On Fri, Oct 14, 2011 at 3:57 AM, Hal Eisen  wrote:

&gt; I made progress, thanks to Russell who answered my email the other day.
&gt;
&gt; I've got a simple javascript precommit hook installed and it seems to
&gt; work fine, most of the time. However, it will randomly timeout. There
&gt; aren't any interesting messages in any of the logs. I am able to store
&gt; a key/value pair one minute, but then not be able to store the same pair
&gt; in the next minute.
&gt;
&gt; Where should I be looking to get more info? Are there any "safe"
&gt; operations, or operations that are discouraged in precommit hooks?
&gt;
&gt; Thanks,
&gt; Hal
&gt;
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;



-- 
Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://www.basho.com/
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

