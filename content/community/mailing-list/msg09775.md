---
title: "Re: Riak packaging for RPM-based distros"
description: ""
project: community
lastmod: 2013-01-09T13:34:26-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09775"
mailinglist_parent_id: "msg09772"
author_name: "Aleksey Morarash"
project_section: "mailinglistitem"
sent_date: 2013-01-09T13:34:26-08:00
---


2013/1/9 Jared Morrow 
&gt; In our case, making a distributed database that people depend on to be stable 
&gt; and
&gt; performant also requires us to control the Erlang VM we use. In a particular 
&gt; case,
&gt; we've been fighting Erlang scheduler issues in regards to our use of NIF's 
&gt; that has
&gt; changed behavior between versions of Erlang. Because of this issue, we 
&gt; haven't
&gt; moved forward on using new versions past R15B02 of erlang. Because we are
&gt; responsible for any problems with Riak, I do not see anytime in the future we 
&gt; will
&gt; give up control of the Erlang we use at the expense of a slightly larger rpm 
&gt; / deb / tgz
&gt; size. That was just one example, another is the use of HiPE or no HiPE where
&gt; we've found segfaults when using HiPE on SunOS or \\*BSD due to fixed memory 
&gt; buffer sizes.

Hm. I`m familiar with such problems too :)

&gt; Regarding packaging components as separate RPM's. This is another thing that
&gt; distributions have tried to get us to do, make a riak\\_core, riak\\_kv, 
&gt; erlang\\_js, etc.,
&gt; etc. rpm. Again, I see no benefit at all to people who use riak. This is a 
&gt; benefit
&gt; solely to fit into packaging guidelines made by distributions. When testing 
&gt; such a
&gt; complicated system such as Riak, breaking it up into 30 pieces would simply 
&gt; make
&gt; testing harder and the product less stable. Unless you are writing a 
&gt; riak\\_core app,
&gt; who would just \\*just\\* want a riak\\_core RPM anyway?

Agree. Code, related only to Riak we can package in one package.
Creating package for each Erlang application is not strict dogma.

&gt; Right now if someone has a problem, I can say, "tell me what ./riak version 
&gt; says"
&gt; and know exactly what is running.

Mostly true, but... Most deps in 'rebar.config' files links to HEAD of
'master' branch. Seems output of './riak version' is not enough.
Anyway, when packaging is done right way (no packages was built with
new code but old version), 'rpm -q $pkgname' (for example) will give
good start point.

&gt;&gt; - honor filesystem hierarchy of underlying OS.
&gt; This one I'd like to hear more about. I've made some changes along the way 
&gt; for systems
&gt; I didn't know as much about at first pass (mainly SunOS flavors), but I know 
&gt; for a fact we
&gt; haven't got everything right. If you have some examples of where we are 
&gt; doing it wrong
&gt; in regards to our install, please let me know or file a bug at 
&gt; https://github.com/basho/riak

Ok, I will.

