---
title: "Re: Puppet Module for Riak"
description: ""
project: community
lastmod: 2011-06-22T16:04:26-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03790"
mailinglist_parent_id: "msg03788"
author_name: "Mark Phillips"
project_section: "mailinglistitem"
sent_date: 2011-06-22T16:04:26-07:00
---


re: puppet module - I just stumbled onto this simple puppet config
from Mårten Gustafson while digging through the irc logs for today's
recap:

https://gist.github.com/1038441

(I know some of you have already seen it but I figured I should attach
it to the thread nonetheless.)

Mark

On Wed, Jun 22, 2011 at 9:28 AM, Mark Phillips  wrote:
&gt; If any of this ever officially makes it to a Bitbucket/GitHub repo,
&gt; let's make sure it gets added to the "Recipes...." section on the
&gt; wiki. :)
&gt;
&gt; http://wiki.basho.com/Community-Developed-Libraries-and-Projects.html#Recipes%2C-Cookbooks%2C-and-Configurations
&gt;
&gt; Thanks,
&gt;
&gt; Mark
&gt;
&gt; On Tue, Jun 21, 2011 at 1:23 PM, Jacques  wrote:
&gt;&gt; Oops, forgot to include list.  Sorry.
&gt;&gt;
&gt;&gt; ---------- Forwarded message ----------
&gt;&gt; From: Jacques 
&gt;&gt; Date: Tue, Jun 21, 2011 at 1:22 PM
&gt;&gt; Subject: Re: Puppet Module for Riak
&gt;&gt; To: Ken Perkins 
&gt;&gt;
&gt;&gt;
&gt;&gt; I'm very new to using puppet but I'll give you what I have.  It is just a
&gt;&gt; basic example.
&gt;&gt; The init references two erb files:
&gt;&gt; app.config.erb = Utilizes &lt;%= ipaddress %&gt; for http, https and pb addresses
&gt;&gt; vm.args.erb = Actually just a straight config right now.  Originally used
&gt;&gt; ipaddress for the the host part of the name but then realized that wasn't
&gt;&gt; necessary since I have dns setup correctly for each of the nodes.
&gt;&gt; Hopefully something to get you started.
&gt;&gt; Jacques
&gt;&gt;
&gt;&gt; modules/riak/manifests/init.pp
&gt;&gt; class riak::config {
&gt;&gt;   file { "/etc/riak":
&gt;&gt;     ensure =&gt; directory,
&gt;&gt;     mode =&gt; 0555,
&gt;&gt;   }
&gt;&gt;   file { "/etc/riak/app.config":
&gt;&gt;     ensure =&gt; present,
&gt;&gt;     owner =&gt; 'root',
&gt;&gt;     group =&gt; 'root',
&gt;&gt;     content =&gt; template("riak/app.config.erb"),
&gt;&gt;     require =&gt; [File["/etc/riak"], Class["riak::install"]],
&gt;&gt;     notify =&gt; Class["riak::service"],
&gt;&gt;   }
&gt;&gt;   file { "/etc/riak/vm.args":
&gt;&gt;     ensure =&gt; present,
&gt;&gt;     owner =&gt; 'root',
&gt;&gt;     group =&gt; 'root',
&gt;&gt;     content =&gt; template("riak/vm.args.erb"),
&gt;&gt;     require =&gt; [File["/etc/riak"], Class["riak::install"]],
&gt;&gt;     notify =&gt; Class["riak::service"],
&gt;&gt;   }
&gt;&gt;   file { "/export/riak":
&gt;&gt;     ensure =&gt; directory,
&gt;&gt;     owner =&gt; 'riak',
&gt;&gt;     group =&gt; 'riak',
&gt;&gt;     require =&gt; Class["riak::install"],
&gt;&gt;   }
&gt;&gt; }
&gt;&gt; class riak::install {
&gt;&gt;   package {"erlang":
&gt;&gt;     ensure =&gt; present,
&gt;&gt;     require =&gt; Class["repos"],
&gt;&gt;   }
&gt;&gt;   package {"riak":
&gt;&gt;     ensure =&gt; present,
&gt;&gt;     require =&gt; Package["erlang"],
&gt;&gt;   }
&gt;&gt; }
&gt;&gt;
&gt;&gt; class riak::service {
&gt;&gt;   service {"riak":
&gt;&gt;     ensure =&gt; running,
&gt;&gt;     hasstatus =&gt; false,
&gt;&gt;     hasrestart =&gt; true,
&gt;&gt;     enable =&gt; true,
&gt;&gt;     require =&gt; Class["riak::config"]
&gt;&gt;   }
&gt;&gt; }
&gt;&gt; class riak {
&gt;&gt;   require repos
&gt;&gt;   include riak::install, riak::config, riak::service
&gt;&gt; }
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On Tue, Jun 21, 2011 at 9:44 AM, Ken Perkins  wrote:
&gt;&gt;&gt;
&gt;&gt;&gt; I've been searching and have had little success in finding a Riak Module
&gt;&gt;&gt; for puppet, so I wanted to turn to the community.
&gt;&gt;&gt; Are any of you using puppet to manage your riak boxes? Please share
&gt;&gt;&gt; anything if you do! It'd be great to have something to start from.
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt; --Ken
&gt;&gt;&gt; clipboard, inc.
&gt;&gt;&gt;

&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;

