---
title: "Re: Ring Cluster and CPU idle time"
description: ""
project: community
lastmod: 2010-12-09T02:40:41-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01760"
mailinglist_parent_id: "msg01754"
author_name: "David Dawson"
project_section: "mailinglistitem"
sent_date: 2010-12-09T02:40:41-08:00
---


Sean,

 We have used the ETS backend, to rule out Disk IO as much as possible 
and we are pretty sure that our memory IO is fine, this leaves either Network 
IO being a factor or the erlang VM itself ( highly unlikely ). In further 
testing we also discovered that just using 1 node in the ring gave us 80% cpu / 
0% wait / 17% idle / 3% sys, which could suggest that network chatter between 
the ring could be the factor, so we are planning to setup the RIAK ring so the 
handoff and chatter traffic is done over a separate NIC, in your experiences 
will this help? 

Dave


On 8 Dec 2010, at 17:57, Sean Cribbs wrote:

&gt; David,
&gt; 
&gt; It's expected that, especially when running basho\\_bench, your cluster will 
&gt; not use that much CPU. Riak is mostly I/O-bound, which is a good thing (vs. 
&gt; wasting CPU not delivering data to you). I would definitely expect network 
&gt; and disk (and possibly RAM) to be the primary limiting factors.
&gt; 
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 
&gt; On Dec 8, 2010, at 12:36 PM, David Dawson wrote:
&gt; 
&gt;&gt; We are currently running a ring of 3 machines each machine with 12 cores, 
&gt;&gt; and have noticed that we seem to only be using 60% of available CPU ( other 
&gt;&gt; 40% is spent idle ) when running basho bench against the cluster. We have 
&gt;&gt; tried changing the 'n\\_val' from 3 to 1 and also the backend from bitcask to 
&gt;&gt; ets, and it seems to make no difference. Is this expected? 
&gt;&gt; 
&gt;&gt; Also are there any suggested tuning parameters that should be used when 
&gt;&gt; running riak on machines with lots of cores? and if not what would you 
&gt;&gt; expect the bottleneck to be in a cluster? ( cpu / disk io/ memory / network 
&gt;&gt; io )
&gt;&gt; 
&gt;&gt; Dave
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt; 
