---
title: "Re: Corruption of leveldb database files"
description: ""
project: community
lastmod: 2012-01-26T04:26:39-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06425"
mailinglist_parent_id: "msg06290"
author_name: "Thomas Bakketun"
project_section: "mailinglistitem"
sent_date: 2012-01-26T04:26:39-08:00
---


Hello,

A fix for this bug in leveldb has been released now. I would recommend
that a service release of Riak with this fix included is done as soon as
possible.


On 2012-01-16 17:52, David Smith wrote:
&gt; Thomas,
&gt;
&gt; Thanks for the heads up -- I saw that bug report on the Level repo this 
&gt; morning.
&gt;
&gt; D.
&gt;
&gt; On Mon, Jan 16, 2012 at 9:50 AM, Thomas Bakketun
&gt;  wrote:
&gt;&gt; Hello,
&gt;&gt;
&gt;&gt; We have found a bug in leveldb that causes corruption of the CURRENT
&gt;&gt; file of leveldb databases. A bug report has been filed:
&gt;&gt; http://code.google.com/p/leveldb/issues/detail?id=68
&gt;&gt;
&gt;&gt; This bug can easily be reproduced by restarting restarting Riak and
&gt;&gt; force of the computer within 30 to 60 seconds. After reboot at least one
&gt;&gt; corrupt leveldb database can be expected. When this happens Riak fails
&gt;&gt; to start and logs this message:
&gt;&gt;
&gt;&gt; Failed to start riak\\_kv\\_eleveldb\\_backend Reason: {db\\_open,"Corruption:
&gt;&gt; CURRENT file does not end with newline"}
&gt;&gt;
&gt;&gt; Switching on the sync flag for leveldb has no effect.
&gt;&gt;
&gt;&gt; --
&gt;&gt; Thomas Bakketun, Senior software developer
&gt;&gt; T. +47 21 53 69 40
&gt;&gt; Copyleft Solutions
&gt;&gt; www.copyleftsolutions.com
&gt;&gt;
&gt;&gt;
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
Thomas Bakketun, Senior software developer
T. +47 21 53 69 40
Copyleft Solutions
www.copyleftsolutions.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

