---
title: "Re: cannot query bucket when a node is down"
description: ""
project: community
lastmod: 2010-06-02T14:26:57-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00491"
mailinglist_parent_id: "msg00479"
author_name: "Johan Harjono"
project_section: "mailinglistitem"
sent_date: 2010-06-02T14:26:57-07:00
---


Thanks for the bug fix Justin! It works wonderfully for me now :)

thanks,
Johan

On Tue, Jun 1, 2010 at 2:02 PM, Justin Sheehy  wrote:

&gt; On Tue, Jun 1, 2010 at 1:56 PM, Sam Tingleff  wrote:
&gt;
&gt; &gt; With no single point of failure there is no single index of keys. So
&gt; &gt; the only way to get an exhaustive list of keys in a given bucket is to
&gt; &gt; ask all nodes (I do not know if this is what riak is actually doing).
&gt;
&gt; Sam is exactly right that Riak doesn't centralize anything and so
&gt; there is no collected index of keys.
&gt;
&gt; However, you don't quite have to ask every node; you have to ask
&gt; enough nodes to know that you hit at least one replica of every
&gt; object. This is what listing keys (GET /bucket) does. There was a
&gt; bug that just recently got fixed that could in some cases cause the
&gt; whole listing to hang up due to a single misbehaving or down node,
&gt; depending on timing. This fix was placed in tip this morning and the
&gt; fix will go out in the next release.
&gt;
&gt; As long as you have enough nodes around that you could get every
&gt; object in the cluster using R=1, you should be able to list the keys
&gt; in a bucket.
&gt;
&gt; -Justin
&gt;
