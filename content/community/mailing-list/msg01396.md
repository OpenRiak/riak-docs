---
title: "Re: loading erlang terms"
description: ""
project: community
lastmod: 2010-10-28T12:47:54-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01396"
mailinglist_parent_id: "msg01394"
author_name: "Charles Blair"
project_section: "mailinglistitem"
sent_date: 2010-10-28T12:47:54-07:00
---


Thanks for spotting the "brainos". But even without those, here is a
repeat of the experiment.

erl -pa /usr/local/riak-0.13.0/rel/riak/lib/riak\\_core-0.13.0/ebin 
/usr/local/riak-0.13.0/rel/riak/lib/riak\\_kv-0.13.0/ebin 
/usr/local/riak-0.13.0/rel/riak/lib/riakc-1.0.1/ebin 
/usr/local/riak-0.13.0/rel/riak/lib/protobuffs-0.5.0/ebin

Erlang R14B (erts-5.8.1) [source] [smp:16:16] [rq:16] [async-threads:0] [hipe] 
[kernel-poll:false]

Eshell V5.8.1 (abort with ^G)
1&gt; {ok,Pid} = riakc\\_pb\\_socket:start\\_link("123.456.78.90", 8087).
{ok,&lt;0.33.0&gt;}
2&gt; riakc\\_pb\\_socket:get(Pid, &lt;&lt;"people"&gt;&gt;, &lt;&lt;"chas"&gt;&gt;).
{ok,{riakc\\_obj,&lt;&lt;"people"&gt;&gt;,&lt;&lt;"chas"&gt;&gt;,
 &lt;&lt;107,206,97,96,96,224,206,96,202,5,82,44,236,70,107,239,
 100,48,37,50,230,177,50,...&gt;&gt;,
 [{{dict,4,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],...},
 {{[],[],
 [[&lt;&lt;"Links"&gt;&gt;,
 {{&lt;&lt;"images"&gt;&gt;,&lt;&lt;"abc"&gt;&gt;},&lt;&lt;"avatar"&gt;&gt;},
 {{&lt;&lt;"posi"...&gt;&gt;,&lt;&lt;...&gt;&gt;},&lt;&lt;"posi"...&gt;&gt;}]],
 [],[],[],[],[],[],[],...}}},
 &lt;&lt;"Charles Blair"&gt;&gt;}],
 undefined,undefined}}
3&gt; riakc\\_pb\\_socket:get(Pid, &lt;&lt;"oai\\_test"&gt;&gt;,&lt;&lt;"AEP-WYS97"&gt;&gt;).
{error,disconnected}
4&gt; 
=ERROR REPORT==== 28-Oct-2010::14:30:25 ===
\\*\\* Generic server &lt;0.33.0&gt; terminating 
\\*\\* Last message in was {tcp\\_closed,#Port&lt;0.913&gt;}
\\*\\* When Server state == {state,"128.135.53.253",8087,false,false,undefined,
 undefined,
 {[],[]},
 1,[],100}
\\*\\* Reason for termination == 
\\*\\* disconnected
\\*\\* exception error: disconnected
4&gt; 

The directly attached shell also provides an error message:

=ERROR REPORT==== 28-Oct-2010::14:30:25 ===
\\*\\* Generic server &lt;0.3660.0&gt; terminating
\\*\\* Last message in was {tcp,#Port&lt;0.2753&gt;,
 [9|
 &lt;&lt;10,8,111,97,105,95,116,101,115,116,18,9,65,69,
 80,45,87,89,83,57,55&gt;&gt;]}
\\*\\* When Server state == {state,#Port&lt;0.2753&gt;,
 {riak\\_client,'r...@128.135.53.253',
 &lt;&lt;5,45,154,107&gt;&gt;},
 undefined,undefined}
\\*\\* Reason for termination ==
\\*\\* {function\\_clause,
 [{riakclient\\_pb,encode,
 [oai\\_dc,
 {oai\\_dc,"AEP-WYS97",
 {{2004,10,28},{17,21,25}},
 ["aep"],
 "/storage/aep2003/metadata/oai\\_dc/oai\\_dc-AEP-WYS97.xml"}]},
 {riakclient\\_pb,pack,5},
 {riakclient\\_pb,iolist,2},
 {riakclient\\_pb,encode,2},
 {riakclient\\_pb,pack,5},
 {riakclient\\_pb,pack,5},
 {riakclient\\_pb,iolist,2},
 {riakc\\_pb,encode,1}]}

---

I've repeated this several times with the same result. Trigger the error as 
many times as I want, but in the directly attached shell I can do this 
afterwards:

C:get(&lt;&lt;"oai\\_test"&gt;&gt;, &lt;&lt;"AEP-WYS97"&gt;&gt;, 1).
{ok,{r\\_object,&lt;&lt;"oai\\_test"&gt;&gt;,&lt;&lt;"AEP-WYS97"&gt;&gt;,
 [{r\\_content,{dict,2,16,16,8,80,48,
 {[],[],[],[],[],[],[],[],[],[],[],[],...},
 {{[],[],[],[],[],[],[],[],[],[],...}}},
 {oai\\_dc,"AEP-WYS97",
 {{2004,10,28},{17,21,25}},
 ["aep"],
 
"/storage/aep2003/metadata/oai\\_dc/oai\\_dc-AEP-WYS97.xml"}}],

I can't find the source for riakclient\\_pb in my distribution to see what might 
be going on:

% find riak-0.13.0 -name riakclient\\_pb"\\*"
riak-0.13.0/deps/riakc/ebin/riakclient\\_pb.beam
riak-0.13.0/deps/riakc/include/riakclient\\_pb.hrl
riak-0.13.0/rel/riak/lib/riakc-1.0.1/ebin/riakclient\\_pb.beam
riak-0.13.0/rel/riak/lib/riakc-1.0.1/include/riakclient\\_pb.hrl


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

