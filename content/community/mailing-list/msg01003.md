---
title: "Re: Ripple and formbuilding in rails 3"
description: ""
project: community
lastmod: 2010-09-01T11:53:43-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01003"
mailinglist_parent_id: "msg01002"
author_name: "Brian Kaney"
project_section: "mailinglistitem"
sent_date: 2010-09-01T11:53:43-07:00
---


I think you want to use the :key as the identifier for the selection.

 = f.collection\\_select(:web\\_server, WebServer.all, :key, :name)


--
Brian



On Sep 1, 2010, at 2:48 PM, John Axel Eriksson wrote:

&gt; I'm not exactly an expert on Rails but I've built a few simpler apps. Now
&gt; I'm working on an app using Ripple and I'm having a few issues, perhaps
&gt; I just haven't grasped riak/ripple yet...
&gt; 
&gt; 
&gt; Anyway...
&gt; 
&gt; 
&gt; class Client
&gt; include Ripple::Document
&gt; 
&gt; timestamps!
&gt; 
&gt; property :name, String
&gt; property :hostname, String
&gt; property :url, String
&gt; property :blocked, Boolean
&gt; 
&gt; key\\_on :hostname
&gt; 
&gt; one :web\\_server
&gt; 
&gt; def id
&gt; hostname
&gt; end
&gt; 
&gt; 
&gt; end
&gt; 
&gt; 
&gt; class WebServer
&gt; include Ripple::Document
&gt; 
&gt; timestamps!
&gt; 
&gt; property :name, String
&gt; many :users
&gt; many :clients
&gt; 
&gt; key\\_on :name
&gt; 
&gt; def id
&gt; name
&gt; end
&gt; 
&gt; end
&gt; 
&gt; in Rails console:
&gt; 
&gt; c = Client.new(:name =&gt; 'abc')
&gt; ws = WebServer.find('some.domain.name')
&gt; 
&gt; c.web\\_server = ws
&gt; 
&gt; c.save
&gt; 
&gt; the above works just fine (and doing curl -i against the resources in riak 
&gt; shows the links too) but...
&gt; 
&gt; in a (haml) form I do:
&gt; 
&gt; .select
&gt; %label= f.label :web\\_server
&gt; = f.collection\\_select(:web\\_server, WebServer.all, :id, :name)
&gt; 
&gt; but here I get an error when saving saying:
&gt; ArgumentError (Invalid value "some.domain.name" for association web\\_server 
&gt; of type WebServer on  UTC 2010 updated\\_at=Wed Sep 01 17:38:13 UTC 2010 url="abc.somedomain.name" 
&gt; blocked=nil hostname="abc"&gt;):
&gt; app/controllers/clients\\_controller.rb:63:in `update'
&gt; 
&gt; 
&gt; I ported the code over from a MongoDB-version of the app where these forms 
&gt; worked just fine. I'm having trouble seeing whats wrong with this, maybe I 
&gt; don't know rails
&gt; well enough...
&gt; 
&gt; Also, does ripple support accepts\\_nested\\_attributes\\_for (afaict it doesn't)?
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

