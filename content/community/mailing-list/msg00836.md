---
title: "Re: Structured data"
description: ""
project: community
lastmod: 2010-08-03T17:10:42-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00836"
mailinglist_parent_id: "msg00833"
author_name: "James Sadler"
project_section: "mailinglistitem"
sent_date: 2010-08-03T17:10:42-07:00
---


Dmitry,

On 4 August 2010 01:09, Dmitry Demeshchuk  wrote:
&gt; James,
&gt;
&gt; What mechanism are you trying to implement? Generally, it's not a good
&gt; way to let your database operate the format of your data.

It has advantages if the database understands certain datatypes. For,
instance I don't need to round-trip the entire value to and from the
client just to append an item to it if for example, it's a list. This
stuff \\*really\\* matters when you have performance constraints.

&gt; For example, if you want to store some lists of data and append new
&gt; items to them or remove existing ones, you won't need Riak to check
&gt; data types itself. All such checks should be handled by your Erlang
&gt; code.

Should, in what context? I'm talking about creating something new
here, on top of riak\\_core. My questions are about the feasibility of
whether I could extend riak\\_core to be able to handle these
situations. If the client \\_should\\_ be handling the data with
higher-level semantics (if for example, it's simply not possible to
impose other semantics on the values other than delete / replace in
the current incarnation of riak\\_core) then please explain why that's
necessary.

&gt;
&gt; But if you are speaking of Riak data consistency, it has two major
&gt; features for that: multi-values and vector-clocks. The first feature
&gt; guarantees that you won't lose any important data and will be able to
&gt; compare your old and new values and decide their consistency manually.
&gt; And the second one offers very reliable automatic consistency checks
&gt; that can solve consistency problems in many cases.
&gt;

And the multi-values and vector clocks are what I want to preserve in
system that has richer semantics on values (i.e. the values are typed
up to client API level). All I am interested in, is if this is
possible to build on top of a vanilla riak\\_core. Perhaps a better
question is this: "Is the fundamental operation of riak\\_core coupled
to the fact that values are opaque blobs?". I'm hoping that the
answer is 'no' and this seems like it might be the answer, given that
you said Riak values can be any Erlang term. It's just that that's
not exposed through client APIs, so I am wondering at what level of
the stack that ceases to be the case.

&gt; On Tue, Aug 3, 2010 at 6:15 PM, James Sadler  wrote:
&gt;&gt; Hi Dmitry,
&gt;&gt;
&gt;&gt; Being able to represent any Erlang term is a good start.
&gt;&gt;
&gt;&gt; Which leads me to Riak's conflict resolution.  Does this part of Riak
&gt;&gt; understand the data types or does it just present the N alternative
&gt;&gt; values for a key to the client when there is a conflict?
&gt;&gt;
&gt;&gt; There is potential for some semi-automated merging to be done
&gt;&gt; server-side in the case where values have richer semantics. I suspect
&gt;&gt; that it would depend on the application, and the client would need to
&gt;&gt; tell Riak it's OK to perform an automatic merge on write.
&gt;&gt;
&gt;&gt; On 3 August 2010 23:59, Dmitry Demeshchuk  wrote:
&gt;&gt;&gt; Hi, James.
&gt;&gt;&gt;
&gt;&gt;&gt; Actually, Riak can store all Erlang terms: lists, tuples, numbers,
&gt;&gt;&gt; binaries, etc.
&gt;&gt;&gt;
&gt;&gt;&gt; But if you use, for example, PHP or Python, you can just use your own
&gt;&gt;&gt; serialization format. So there are no problems here for any other
&gt;&gt;&gt; languages as well.
&gt;&gt;&gt;
&gt;&gt;&gt; On Tue, Aug 3, 2010 at 5:47 PM, James Sadler  wrote:
&gt;&gt;&gt;&gt; Hi guys,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Is there any plan for supporting more than opaque blobs as values in
&gt;&gt;&gt;&gt; the future?  For example, lists, sets, hashes etc, including
&gt;&gt;&gt;&gt; server-side support for operating on those data-types?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; In the meantime, I am curious about the feasibility of putting
&gt;&gt;&gt;&gt; riak\\_core in front of Redis, and supporting a richer API in the layers
&gt;&gt;&gt;&gt; above (which I suspect would need to be heavily modified to support
&gt;&gt;&gt;&gt; additional value manipulation functionality).
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Also, is anyone aware of anyone attempting such a project?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Cheers,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; --
&gt;&gt;&gt;&gt; James
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Best regards,
&gt;&gt;&gt; Dmitry Demeshchuk
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; James
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Best regards,
&gt; Dmitry Demeshchuk
&gt;

-- 
James

