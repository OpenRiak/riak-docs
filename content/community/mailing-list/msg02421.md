---
title: "Re: Number of replica for Luwak"
description: ""
project: community
lastmod: 2011-02-23T08:39:59-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02421"
mailinglist_parent_id: "msg02419"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2011-02-23T08:39:59-08:00
---


On Wed, Feb 23, 2011 at 10:40 AM, Les Mikesell wrote:
&gt;
&gt;
&gt;
&gt; Thanks! A couple more somewhat related questions: is that atomic update
&gt; nature hard to duplicate outside of luwak (say by a client that needs to
&gt; keep several items in sync), and if the luwak blocks are immutable, how do
&gt; you ever clean up the space used by data that has been deleted or modified
&gt; and no longer referenced?
&gt;
&gt;
For your first question, I believe the onus to make multiple object updates
atomic is on you, the application developer. One of the, perhaps easier,
ways to achieve this would be to wrap all the data in one object?

Second, you don't; not at this time at least. Luwak allows you to delete
the file reference, but not the data itself. It's the very nature of the
fact that it's an immutable, persistent data structure that makes this so.
 If two files share a block, then you can't simply delete the blocks under a
file, but instead must perform something more like garbage collection.

If you're up for it, I have some proof of concept code on my fork of Luwak.
 I got GC to work, to an extent. IIRC, once I got past 10-15GB things
started to degrade quickly. When I get more time I plan to return to it.

https://github.com/rzezeski/luwak

-Ryan
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

