---
title: "Re: Riak Search timeout when searching from erlang command line"
description: ""
project: community
lastmod: 2011-04-04T12:04:55-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02875"
mailinglist_parent_id: "msg02871"
author_name: "Mike Huffman"
project_section: "mailinglistitem"
sent_date: 2011-04-04T12:04:55-07:00
---


Hi Rusty,

Thanks for the response.

I should have mentioned that I also tried the search case sensitive with the
same results:

(dev1@127.0.0.1)19&gt; search:search(&lt;&lt;"my\\_index"&gt;&gt;, &lt;&lt;"title:Title"&gt;&gt;).

=ERROR REPORT==== 4-Apr-2011::13:48:48 ===

range\\_loop timed out!\\*\\* exception throw: {timeout,range\\_loop}
 in function riak\\_search\\_backend:collect\\_info\\_response/3
 in call from riak\\_search\\_op\\_term:info/3
 in call from riak\\_search\\_op\\_term:preplan/2
 in call from riak\\_search\\_op\\_scope:preplan/2
 in call from riak\\_search\\_client:parse\\_query/3
 in call from search:search/2

In answer to the questions:

It produces the same results if run on a single node (which is what this
example is from) or the 3-node devrel setup.

Mac OS X 10.6.7 (Macbook Pro, 2.8 GHz Intel Core 2 Duo, 8 GB Ram), Erlang
R14B02, riaksearch from git repository

ulimit -n returns 400000


Like wise if it run:
 ./bin/search-cmd shell my\\_index
s(&lt;&lt;"title:Title"&gt;&gt;)

I get:

Error: {timeout,range\\_loop}


On Mon, Apr 4, 2011 at 10:42 AM, Rusty Klophaus  wrote:

&gt; Hi Mike,
&gt;
&gt; The Whitespace tokenizer (the default) is case sensitive, so the query
&gt; should be:
&gt;
&gt; search:search(&lt;&lt;"my\\_index"&gt;&gt;, &lt;&lt;"title:Title"&gt;&gt;)
&gt;
&gt; If you want a tokenizer that is case-insensitive and also filters out
&gt; stopwords (basically, something more appropriate for prose) you can use the
&gt; Standard analyzer factory. Details are here:
&gt; http://wiki.basho.com/Riak-Search---Schema.html
&gt;
&gt; I'm not sure why you see a range\\_loop exception. That's odd. You should
&gt; just see zero results returned.
&gt;
&gt; Some diagnostic questions:
&gt;
&gt; - Are you running on a single node?
&gt; - What platform are you running?
&gt; - If you run the command "ulimit -n", what does it return?
&gt;
&gt; Best,
&gt; Rusty
&gt;
&gt;
&gt;
&gt; On Mon, Apr 4, 2011 at 2:18 AM, Mike Huffman wrote:
&gt;
&gt;&gt; Hi Everyone!
&gt;&gt;
&gt;&gt; I am having the following problem and google is not helping as far as a
&gt;&gt; solution.
&gt;&gt;
&gt;&gt; From a fresh built of riak search from git source, I try the following
&gt;&gt; commands:
&gt;&gt;
&gt;&gt; make rel
&gt;&gt; cd rel/riaksearch
&gt;&gt; ./bin/riaksearch start
&gt;&gt; ./bin/riaksearch attach
&gt;&gt;
&gt;&gt; now I try the following commands from the erlang command line:
&gt;&gt;
&gt;&gt; (next line directly from
&gt;&gt; http://wiki.basho.com/Riak-Search---Indexing.html )
&gt;&gt;
&gt;&gt; search:index\\_doc(&lt;&lt;"my\\_index"&gt;&gt;, &lt;&lt;"my\\_doc"&gt;&gt;, [{&lt;&lt;"title"&gt;&gt;, &lt;&lt;"The
&gt;&gt; Title"&gt;&gt;}, {&lt;&lt;"content"&gt;&gt;, &lt;&lt;"The Content"&gt;&gt;}]).
&gt;&gt;
&gt;&gt; response is "ok"
&gt;&gt;
&gt;&gt; (next line directly from
&gt;&gt; http://wiki.basho.com/Riak-Search---Querying.html )
&gt;&gt;
&gt;&gt; search:search\\_doc(&lt;&lt;"my\\_index"&gt;&gt;, &lt;&lt;"title:title"&gt;&gt;). or search:search
&gt;&gt; (&lt;&lt;"my\\_index"&gt;&gt;, &lt;&lt;"title:title"&gt;&gt;).
&gt;&gt;
&gt;&gt; response is:
&gt;&gt;
&gt;&gt; =ERROR REPORT==== 4-Apr-2011::02:13:32 ===
&gt;&gt; range\\_loop timed out!\\*\\* exception throw: {timeout,range\\_loop}
&gt;&gt; in function riak\\_search\\_backend:collect\\_info\\_response/3
&gt;&gt; in call from riak\\_search\\_op\\_term:info/3
&gt;&gt; in call from riak\\_search\\_op\\_term:preplan/2
&gt;&gt; in call from riak\\_search\\_op\\_scope:preplan/2
&gt;&gt; in call from riak\\_search\\_client:parse\\_query/3
&gt;&gt; in call from search:search\\_doc/2
&gt;&gt;
&gt;&gt;
&gt;&gt; Am I using the erlang commands incorrectly?
&gt;&gt;
&gt;&gt; Any help pointing me in the right direction would be greatly appreciated.
&gt;&gt;
&gt;&gt; Thanks.
&gt;
