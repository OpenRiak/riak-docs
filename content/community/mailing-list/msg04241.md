---
title: "Re: Score for each search"
description: ""
project: community
lastmod: 2011-08-05T08:09:01-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04241"
mailinglist_parent_id: "msg04233"
author_name: "Rusty Klophaus"
project_section: "mailinglistitem"
sent_date: 2011-08-05T08:09:01-07:00
---


Hi Archana,

Yes, the 'p' attribute is positional information. That list is indicating
that the term occurs on the 0th and 43rd positions in the document, and is
0-indexed. Not sure why you are getting two positions if the word only
occurred once. What was the original query?

The scoring information that you see is a bug. For now, as a workaround, you
can add the scores together. This will give you a \\*relative\\* score, allowing
you to rank results for the current query.

To fix this issue, some processing needs to happen within riak to combine
and normalize the scores into a final score that can be used for correct
ranking against other queries as well. (This is being done for the Solr
interface, but not the Map/Reduce interface.) Riak Search models scoring
after Lucene as much as possible, so you can read this for more information
about scoring, especially the final normalization step:
http://lucene.apache.org/java/2\\_4\\_0/api/org/apache/lucene/search/Similarity.html

This issue is tracked in https://issues.basho.com/show\\_bug.cgi?id=1154

Best,
Rusty


On Thu, Aug 4, 2011 at 3:27 PM, Archana Bhattarai
wrote:

&gt; Hi Rusty,
&gt;
&gt; Thanks a lot for the answer. We could get some data in the keydata as
&gt; follows:
&gt;
&gt;
&gt; [{"p":[43,0],"score":[5.3669048584479,1.7201627119528418]}
&gt;
&gt; But couldn't exactly interpret what it's representing. I believe p is
&gt; giving positional information. But why is it two dimensional when the word
&gt; we searched only occurred once in the document. Does the position ignore
&gt; stopword positions and just count other words? Also why are there two scores
&gt; ? Isn't the score normalized ? Or am I doing something wrong to get these
&gt; scores ?
&gt;
&gt;
&gt; Thanks a lot in advance,
&gt; Archana
&gt;
&gt;
&gt;
&gt; On Jul 22, 2011, at 11:09 AM, Rusty Klophaus wrote:
&gt;
&gt; Hi Archana,
&gt;
&gt; Yes. When you use a search query to initiate a map/reduce job, the scores
&gt; are fed into the first phase as keydata, along with other metadata about the
&gt; search result including positional information and any inline fields.
&gt;
&gt; More information in the links below:
&gt;
&gt; -
&gt; 
&gt; http://wiki.basho.com/Riak-Search---Querying.html#Querying-Integrated-with-Map-Reduce
&gt; - http://wiki.basho.com/MapReduce.html (search for "keydata")
&gt;
&gt; Best,
&gt; Rusty
&gt;
&gt; On Fri, Jul 22, 2011 at 10:53 AM, Archana Bhattarai &lt;
&gt; abhatta...@sharecare.com&gt; wrote:
&gt;
&gt;&gt; Hi,
&gt;&gt;
&gt;&gt; Is there a way to get back the score while querying via solr interface or
&gt;&gt; ideally mapreduce over search ? It looks like solr interface only supports
&gt;&gt; sorting.
&gt;&gt;
&gt;&gt;
&gt;&gt; Thanks in advance,
&gt;&gt; Archana
&gt;&gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Rusty Klophaus
&gt;
&gt; \\*Basho Technologies, Inc.\\*
&gt; 11921 Freedom Drive, Suite 550
&gt; Reston, VA 20190
&gt; www.basho.com
&gt;
&gt;
&gt;
&gt;
&gt;

-- 
Rusty Klophaus

\\*Basho Technologies, Inc.\\*
11921 Freedom Drive, Suite 550
Reston, VA 20190
www.basho.com
