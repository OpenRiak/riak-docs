---
title: "Re: Reduce phase only on one node?"
description: ""
project: community
lastmod: 2010-07-23T17:15:00-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00780"
mailinglist_parent_id: "msg00779"
author_name: "Dan Reverri"
project_section: "mailinglistitem"
sent_date: 2010-07-23T17:15:00-07:00
---


Currently, reduce functions run on the coordinating node. The coordinating
node runs 2 processes per reduce phase to achieve some parallelism. There
are two features requests open to improve the implementation:

Allow users to toggle the number of processes used during reduce
https://issues.basho.com/148 

Distribute reduce phases across the cluster
https://issues.basho.com/149 

There is no target release set for either issue but you should be able to
add yourself to the CC list in Bugzilla to receive notifications.

Thanks,
Dan

Daniel Reverri
Developer Advocate
Basho Technologies, Inc.
d...@basho.com


On Fri, Jul 23, 2010 at 2:34 PM, John D. Rowell  wrote:

&gt; +1 to this, my understanding is that you can use the same reduce funcion to
&gt; re-reduce a stream of data and still get the same results. Is this what
&gt; actually happens in Riak internally (i.e. the coordinating node only
&gt; re-reduces each node's reduce) or does the reduce function only run on the
&gt; coordinating node, which receives the raw map data?
&gt;
&gt; 2010/7/23 John Butler 
&gt;
&gt;
&gt;&gt; Hello,
&gt;&gt; I went through the Riak Fast Track and overall I'm excited about the
&gt;&gt; possibilities of Riak. However, I did see one thing that concerns me in
&gt;&gt; regard to MapReduce jobs. From the Riak docs and this page here:
&gt;&gt; http://seancribbs.com/tech/2010/02/06/why-riak-should-power-your-next-rails-app/it
&gt;&gt; seems to suggest that while Map jobs are performed in parallel Reduce
&gt;&gt; jobs are not.
&gt;&gt; Wouldn't be better if each node performed the reduce function on it's own
&gt;&gt; set of data before sending it to the main coordinator? Imagine if you are
&gt;&gt; mapping over a high number of objects (millions) and are trying to aggregate
&gt;&gt; the data grouped by some demographic (such as state). If all the mappers
&gt;&gt; send the data to coordinating node to be reduced then you are going to send
&gt;&gt; millions of items from each data node all to one coordinating node. If
&gt;&gt; instead each node called reduce first, then sent it to the coordinating
&gt;&gt; node, then each node would be at most sending over 50 objects (for 50
&gt;&gt; states). Not only would this greatly reduce network traffic, it would be
&gt;&gt; able to execute in parallel greatly improving performance. Since all reduce
&gt;&gt; jobs are communicative, associative and idempotent I see no reason why this
&gt;&gt; couldn't happen (of course I'm not familiar with the Riak internals to
&gt;&gt; strongly assert this).
&gt;&gt; Maybe I misunderstood and this is already happening. If it's not
&gt;&gt; happening, why and is that on the roadmap to be added later?
&gt;&gt; -John
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; Hotmail is redefining busy with tools for the New Busy. Get more from your
&gt;&gt; inbox.
&gt;&gt;
&gt;&gt; http://www.windowslive.com/campaign/thenewbusy?ocid=PID28326::T:WLMTAGL:ON:WL:en-US:WM\\_HMP:042010\\_2
&gt;&gt;
&gt;
&gt;

