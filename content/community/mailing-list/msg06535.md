---
title: "Re: Low PUT throughput using Riak"
description: ""
project: community
lastmod: 2012-02-03T11:17:00-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06535"
mailinglist_parent_id: "msg06528"
author_name: "Hussam Abu-Libdeh"
project_section: "mailinglistitem"
sent_date: 2012-02-03T11:17:00-08:00
---


Sure!

Here is the basho\\_bench config file I used to benchmark Riak: (recall,
this was testing a single-node cluster)

{mode, max}.
{duration, 4}.
{concurrent, 1}.
{driver, basho\\_bench\\_driver\\_riakclient}.
{code\\_paths, ["deps/stats",
 "/usr/er/riak/deps/riak\\_kv",
 "/usr/er/riak/deps/riak\\_core"]}.
{key\\_generator, {int\\_to\\_bin, {uniform\\_int, 1000000}}}.
{value\\_generator, {fixed\\_bin, 10000}}.
{riakclient\\_nodes, ['riak@10.1.1.3']}.
{riakclient\\_mynode, ['riak\\_bench@10.1.1.3', longnames]}.
{riakclient\\_replies, 1}.
{operations, [{put, 1}]}.


And for reference, here is the bash\\_bench config file I used to
benchmark Bitcask:

{mode, max}.
{duration, 4}.
{concurrent, 1}.
{driver, basho\\_bench\\_driver\\_bitcask}.
{key\\_generator, {int\\_to\\_bin, {uniform\\_int, 1000000}}}.
{value\\_generator, {fixed\\_bin, 10000}}.
{operations, [{put, 1}]}.
{code\\_paths, ["deps/stats", "/usr/er/riak/deps/bitcask"]}.
{bitcask\\_dir, "/usr/er/bitcask.bench"}.
{bitcask\\_flags, [{sync\\_strategy, none}]}.


Thanks,

On Fri, Feb 3, 2012 at 11:05 AM, Ian Plosker  wrote:
&gt; Hussam,
&gt;
&gt; Could you paste the contents of your basho\\_bench config into an email and
&gt; send it over?
&gt;
&gt; --
&gt; Ian Plosker 
&gt; Developer Advocate
&gt; Basho Technologies
&gt;
&gt; On Thursday, February 2, 2012 at 7:33 PM, Hussam Abu-Libdeh wrote:
&gt;
&gt; Hello,
&gt;
&gt; I am trying to benchmark Riak on a local cluster. I have Riak v1.0.2
&gt; compiled from source. I am benchmarking using Basho's benchmarking
&gt; tool, and I used Riaknostic to help me with configuration. My machines
&gt; are all Dual Xeon with 2GB of RAM and 1Gb ethernet. I get about 50MB/s
&gt; write throughput on the local disks, and the local disks are mounted
&gt; with the noatime flag as Riaknostic suggested.
&gt;
&gt; I benchmarked the write throughput of Bitcask by running a local
&gt; experiment where 1 worker was continuously writing 10K fixed\\_binary
&gt; objects ( {value\\_generator, {fixed\\_bin, 10000}}. ) with the only
&gt; bitcask-specific flag being: {bitcask\\_flags, [{sync\\_strategy, none}]}.
&gt; I got about 50 MB/s write throughput from Bitcask, so that is good.
&gt;
&gt; Then I tried to benchmark Riak. I setup a cluster of 8 Riak nodes with
&gt; the same configuration as used for Bitcask. I used the riakclient
&gt; driver from the benchmarking suite, and set the required riak\\_client
&gt; replies to 1. The client was generating PUT operations continuously
&gt; with 10K binaries as before. I only got a throughput of about 4 MB/s.
&gt; I thought this might be an issue of storing extra copies due to
&gt; replication, so I modified the app.config file on all the nodes to
&gt; specify that N, R, and W are all set to 1. No improvement. I thought
&gt; this could be an issue in the network, so I benchmarked a single-node
&gt; cluster, with the client being local to the same machine (and N,R,W
&gt; all set to 1), and I still got the same low throughput. Finally, out
&gt; of desperation, I even modified the target\\_n\\_val parameter to 1 and
&gt; the ring\\_creation\\_size to 1 so there is only 1 Bitcask directory, ran
&gt; the experiment with 1 local client, and I still got the same very low
&gt; throughput.
&gt;
&gt; Any help would be greatly appreciated. I have been stuck at this for a
&gt; while now.
&gt;
&gt; Thanks,
&gt;
&gt; --Hussam
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

