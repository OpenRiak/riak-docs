---
title: "Re: Riak performance issue with many connected objects (11 million +)"
description: ""
project: community
lastmod: 2012-08-31T10:41:02-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08424"
mailinglist_parent_id: "msg08422"
author_name: "Jared Morrow"
project_section: "mailinglistitem"
sent_date: 2012-08-31T10:41:02-07:00
---


\\*My first reply bounced due to it being too big, so I'll try again with
your original email shortened. So pardon duplicate replies if it did in
fact go through.\\*

Lei,

One issue that stands out is that you are running a single-node cluster.
With a n\\_val of 3, you will be storing 3 copies of every piece of data on
that one node. Also, if you are doing a read with a r of 3, you are
waiting for the data to be read three times from a single node. If
possible, consider making a larger cluster (even with smaller machines) to
get a better idea about how Riak operates. We recommend a minimum of five
physical nodes for a n\\_val of 3. If you lower your n\\_val you can possibly
lower your physical node count and still get good performance at the
sacrifice of higher availability.

Given all of the above, it is still unusual that your reads \\*never\\* return.
 There might be another issue there irregardless of cluster size. When you
say "connected" objects, are you referring to links and link-walking? If
so, how deep are you going with your links? Some context here would be
helpful.

Thanks,
Jared

On Fri, Aug 31, 2012 at 9:54 AM, Lei Gu  wrote:

&gt; I started performance testing Riak by loading 11 million connected objects
&gt; in Riak. Loading has not been an issue, although it did take a long time.
&gt; Now when I tried to access an object, Riak never returns and was using
&gt; 100% of CPU and 74% of memory.
&gt;
&gt; PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND
&gt; 8952 riak 20 0 23.4g 11g 1708 S 100.6 74.1 1520:49 beam.smp
&gt; 
