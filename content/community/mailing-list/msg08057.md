---
title: "Re: Riak search q.op=and misunderstanding"
description: ""
project: community
lastmod: 2012-07-25T06:57:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08057"
mailinglist_parent_id: "msg08014"
author_name: "Ryan Zezeski"
project_section: "mailinglistitem"
sent_date: 2012-07-25T06:57:44-07:00
---


Mick,

This is a bug. At one time I fixed it but it had to be reverted because it
broke rolling upgrade [1]. It has languished ever since. To work around
explicitly put AND in the query. E.g.
q=nickname:Ring%20AND%20breed:Shepherd

-Z

[1]:
https://github.com/basho/riak\\_search/commit/67ca6efca7cd0a92c4d7e323aa3fd7a37df27315

On Sat, Jul 21, 2012 at 9:13 AM, Mick Brooks  wrote:

&gt; Hi,
&gt;
&gt; I'm playing with Riak thanks to working through the Seven DBs in Seven
&gt; Weeks book: &lt;
&gt; http://pragprog.com/book/rwdata/seven-databases-in-seven-weeks&gt;.
&gt; One of the examples has left me confused, and I wondered if anyone could
&gt; spot where I'm going wrong.
&gt;
&gt; I've got a dev cluster running Riak 1.1.4, and have turned on Riak search.
&gt; I've
&gt; created a bucket named new\\_animals and added the following 3 objects:
&gt;
&gt; $ curl -X PUT http://localhost:8091/riak/new\\_animals/dragon \\
&gt; -H "Content-Type: application/json" \\
&gt; -d '{"nickname" : "Dragon", "breed" : "Briard", "score" : 1 }'
&gt; $ curl -X PUT http://localhost:8091/riak/new\\_animals/ace \\
&gt; -H "Content-Type: application/json" \\
&gt; -d '{"nickname" : "The Wonder Dog", "breed" : "German Shepherd",
&gt; "score" : 3 }'
&gt; $ curl -X PUT http://localhost:8091/riak/new\\_animals/rtt \\
&gt; -H "Content-Type: application/json" \\
&gt; -d '{"nickname" : "Rin Tin Tin", "breed" : "German Shepherd", "score" :
&gt; 4 }'
&gt;
&gt; Now I try to search using the and operator:
&gt;
&gt; $ curl '
&gt; http://localhost:8091/solr/new\\_animals/select?q=nickname:Rin%20breed:Shepherd&q.op=and
&gt; '
&gt; xml version="1.0" encoding="UTF-8"?
&gt; 
&gt; 
&gt; 0
&gt; 4
&gt; 
&gt; on
&gt; 0
&gt; nickname:Rin breed:Shepherd
&gt; and
&gt; 
&gt; value
&gt; standard
&gt; 1.1
&gt; 2
&gt; 
&gt; 
&gt; 
&gt; 
&gt; rtt
&gt; 
&gt; German Shepherd
&gt; 
&gt; Rin Tin Tin
&gt; 
&gt; 4
&gt; 
&gt; 
&gt; 
&gt; ace
&gt; 
&gt; German Shepherd
&gt; 
&gt; The Wonder Dog
&gt; 
&gt; 3
&gt; 
&gt; 
&gt; 
&gt; 
&gt;
&gt; I expected only one result to match, but have two. 'ace' should fail
&gt; to match the nickname:Rin term, so does it make sense that it's returned
&gt; for this query?
&gt;
&gt; Cheers,
&gt;
&gt; Mick
&gt;
&gt; --
&gt; Mick Brooks
&gt; ACCU Membership Secretary - accumembers...@accu.org
&gt; http://www.accu.org/ - Professionalism in Programming
&gt;

