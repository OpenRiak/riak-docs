---
title: "Upgrading from 1.1.2 to 1.2.0"
description: ""
project: community
lastmod: 2012-09-17T09:25:16-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08572"
author_name: "Colin Alston"
project_section: "mailinglistitem"
sent_date: 2012-09-17T09:25:16-07:00
---


Hi

I'm having serious issues trying to upgrade Riak from 1.1.2 to 1.2.0\\_1
on Ubuntu.

To upgrade I stop a cluster node, purge the old package and install
1.2.0\\_1 but MapReduce fails on 1.2.

Exception: Error running MapReduce operation. Status: 500 :
500 Internal Server
ErrorInternal Server Error
=====================

The server
encountered an error while processing this
request:  

```
{error,function_clause,
       [{string,tokens1,[undefined,";",[]],[{file,"string.erl"},{line,202}]},
        {mochiweb_util,parse_header,1,
                       [{file,"src/mochiweb_util.erl"},{line,367}]},
        {riak_kv_wm_mapred,base_type,1,
                           [{file,"src/riak_kv_wm_mapred.erl"},{line,110}]},
        {riak_kv_wm_mapred,ctype_ok,1,
                           [{file,"src/riak_kv_wm_mapred.erl"},{line,99}]},
        {riak_kv_wm_mapred,known_content_type,2,
                           [{file,"src/riak_kv_wm_mapred.erl"},{line,62}]},
        {webmachine_resource,resource_call,3,
                             [{file,"src/webmachine_resource.erl"},
                              {line,169}]},
        {webmachine_resource,do,3,
                             [{file,"src/webmachine_resource.erl"},
                              {line,128}]},
        {webmachine_decision_core,resource_call,1,
                                  [{file,"src/webmachine_decision_core.erl"},

{line,48}]}]}
```


---

mochiweb+webmachine web
server

What is the real upgrade procedure supposed to be? Do I need to kill
the Riak store directories as well (/var/lib/riak) and let them
re-replicate one at a time? A fresh install of 1.2 elsewhere does
work, with a totally new store, but spouts failures with a 1.1.2
store.

