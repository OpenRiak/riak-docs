---
title: "Re: Differing results from same index query"
description: ""
project: community
lastmod: 2011-12-22T06:18:53-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06035"
mailinglist_parent_id: "msg06034"
author_name: "Jeremy Raymond"
project_section: "mailinglistitem"
sent_date: 2011-12-22T06:18:53-08:00
---


I ran the queries against the production cluster and could not reproduce
the issue (\\*whew\\*). It gave me consistent correct results for the repeated
queries.

The main difference I see is that the data on the prod cluster is written
directly to Riak and on the dev machine it is restored data. Do the
riak-admin backup/restore commands do more than read all the objects out of
riak, serialize them to disk, and then write them back via normal put
operations when restoring?

--
Jeremy


On Thu, Dec 22, 2011 at 8:24 AM, Jeremy Raymond  wrote:

&gt; The output from the commands all look normal (just running a single node).
&gt; I'm going to see if I can reproduce this outside of this setup.
&gt;
&gt; $ bin/riak-admin ringready
&gt; TRUE All nodes agree on the ring ['dev1@127.0.0.1']
&gt; $ bin/riak-admin transfers
&gt; No transfers active
&gt; $ bin/riak-admin member\\_status
&gt; ================================= Membership
&gt; ==================================
&gt; Status Ring Pending Node
&gt;
&gt; -------------------------------------------------------------------------------
&gt; valid 100.0% -- 'dev1@127.0.0.1'
&gt;
&gt; -------------------------------------------------------------------------------
&gt; Valid:1 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
&gt; $ bin/riak-admin ring\\_status
&gt; ================================== Claimant
&gt; ===================================
&gt; Claimant: 'dev1@127.0.0.1'
&gt; Status: up
&gt; Ring Ready: true
&gt;
&gt; ============================== Ownership Handoff
&gt; ==============================
&gt; No pending changes.
&gt;
&gt; ============================== Unreachable Nodes
&gt; ==============================
&gt; All nodes are up and reachable
&gt;
&gt; --
&gt; Jeremy
&gt;
&gt;
&gt;
&gt; On Wed, Dec 21, 2011 at 7:33 PM, Rusty Klophaus  wrote:
&gt;
&gt;&gt; Hi Jeremy,
&gt;&gt;
&gt;&gt; That is strange. Can you try running "bin/riak-admin ringready",
&gt;&gt; "bin/riak-admin transfers", "bin/riak-admin member\\_status", and
&gt;&gt; "bin/riak-admin ring\\_status"? Does everything look normal?
&gt;&gt;
&gt;&gt; Also, if possible, a zip file of your ./data directory would help us
&gt;&gt; immensely while troubleshooting. (Feel free to email the link to me off
&gt;&gt; list.)
&gt;&gt;
&gt;&gt; Best,
&gt;&gt; Rusty
&gt;&gt;
&gt;&gt; On Wed, Dec 21, 2011 at 12:32 PM, Jeremy Raymond wrote:
&gt;&gt;
&gt;&gt;&gt; I'm seeing an issue where running the same index query multiple times
&gt;&gt;&gt; against an unchanging set of data returns a differing numbers of items.
&gt;&gt;&gt; Riak error and crash logs are empty.
&gt;&gt;&gt;
&gt;&gt;&gt; I've seen this on my dev machine (haven't noticed it in production, but
&gt;&gt;&gt; it could be happening). The production cluster is running Riak 1.0.2 and my
&gt;&gt;&gt; dev machine is running 1.0 (96d0b8011 from Oct 6) compiled from source. The
&gt;&gt;&gt; data on my dev machine is an import of the data from production (via
&gt;&gt;&gt; riak-admin backup/restore).
&gt;&gt;&gt;
&gt;&gt;&gt; Anyone seen this issue? Help on debugging the cause appreciated.
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Jeremy
&gt;&gt;&gt;

&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Rusty Klophaus (@rustyio)
&gt;&gt; \\*Basho Technologies, Inc.\\*
&gt;&gt; www.basho.com
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;
