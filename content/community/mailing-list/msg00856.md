---
title: "Re: Complete Riak failure."
description: ""
project: community
lastmod: 2010-08-09T07:21:19-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00856"
mailinglist_parent_id: "msg00855"
author_name: "Dmitry Demeshchuk"
project_section: "mailinglistitem"
sent_date: 2010-08-09T07:21:19-07:00
---


Greetings, Bob.

I thought that the ulimit command concerns only the number of possible
connections to \\_one\\_ file/socket.
When I written my own MySQL client in Erlang, I was getting the
{error, einval} error sometimes because I had too many opened
connections to the MySQL server. And ulimit solved this problem.
So, the "ulimit" problem seems to me like a problem for a single
client that tries to make many connections to a server.

However, as far as I understood the explanation of the {error, emfile}
error, it means that too many \\_different\\_ files are opened for now (I
guess, it's some limit of the file system). I didn't find any
universal ways to increase this limit.
This problem seems to be a problem of a server that opened too many
simultaneous sockets. And these sockets are really different files so
I'm not sure if ulimit can solve this problem.

Am I wrong?

On Mon, Aug 9, 2010 at 6:11 PM, Bob Ippolito  wrote:
&gt; On Mon, Aug 9, 2010 at 10:07 PM, Dmitry Demeshchuk  
&gt; wrote:
&gt;&gt; The error you get means that too many sockets are opened
&gt;&gt; simultaneously. I guess there are two main possible reasons:
&gt;&gt;
&gt;&gt; 1. You are being spammed by someone
&gt;&gt; 2. Your REST requests to Riak are somehow handled slower than new
&gt;&gt; requests come. So, the number of opened HTTP connections increase over
&gt;&gt; time and you start getting this message.
&gt;
&gt; Well, file handles are for sockets and files, there might be a
&gt; backend/schema combination that likes lots of open files. Adding a
&gt; "ulimit -n SOME\\_BIG\\_NUMBER" in your start script would make sure you
&gt; have plenty of filenos to spare.
&gt;
&gt; -bob
&gt;



-- 
Best regards,
Dmitry Demeshchuk

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

