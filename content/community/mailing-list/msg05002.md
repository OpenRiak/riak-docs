---
title: "Re: script erlang contrib function"
description: ""
project: community
lastmod: 2011-10-03T13:11:32-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05002"
mailinglist_parent_id: "msg05001"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2011-10-03T13:11:32-07:00
---



On 3 Oct 2011, at 20:43, francisco treacy wrote:

&gt; Hi Greg
&gt; 
&gt; Thanks, but what I'm really after is executing a script (non-interactive)
&gt; 
&gt; This is what i've got:
&gt; 
&gt; #!/usr/bin/env escript
&gt; %% -\\*- erlang -\\*-
&gt; %%! -name riakinspect -setcookie riak
&gt; 
&gt; main([]) -&gt;
&gt; %{ok, Client} = riak:client\\_connect('riaksearch@127.0.0.1'),
&gt; % i have the module compiled in /tmp
&gt; code:add\\_path("/tmp"),
&gt; bucket\\_inspector:inspect(&lt;&lt;"bucket"&gt;&gt;, 'riaksearch@127.0.0.1').
&gt; 
&gt; 
&gt; Outputs:
&gt; 
&gt; escript: exception error: undefined function riak:client\\_connect/1
&gt; in function bucket\\_inspector:inspect/2
&gt; in call from erl\\_eval:local\\_func/5
&gt; in call from escript:interpret/4
&gt; in call from escript:start/1
&gt; in call from init:start\\_it/1
&gt; in call from init:start\\_em/1
&gt; 
&gt; Looks like it can't find riak in its path. I could pass-in a client, but have 
&gt; no clue how.
&gt; 
&gt; tl;dr I want to do something like this: http://contrib.basho.com/usage.html 
&gt; but on a script.


Why not just script the remote client of your choice in the language you \\_are\\_ 
comfortable with to do the same thing? Say if you're a pythonista use the 
python client to list keys and fetch each key. That is all the contrib does, or 
am I missing something?

&gt; 
&gt; Thanks,
&gt; Francisco
&gt; 
&gt; 
&gt; 
&gt; 2011/10/3 Greg Pascale 
&gt; Hey Francisco,
&gt; 
&gt; If what you're looking to do is connect to Riak in Erlang without having to 
&gt; run 'riak attach', try this little bit of magic.
&gt; 
&gt; http://www.clipboard.com/clip/LR04fvr5rXWvT\\_\\_G
&gt; 
&gt; The value for "cookie" will be "riak" unless you've changed it.
&gt; 
&gt; -- 
&gt; Greg
&gt; Clipboard
&gt; 
&gt; On Monday, October 3, 2011 at 6:20 AM, francisco treacy wrote:
&gt; 
&gt;&gt; Please? at least a pointer!
&gt;&gt; 
&gt;&gt; 2011/9/29 francisco treacy 
&gt;&gt;&gt; I'm wanting to use the `bucket\\_inspector` contrib function (but have zero 
&gt;&gt;&gt; Erlang experience).
&gt;&gt;&gt; 
&gt;&gt;&gt; Following the "usage" page, I do the following:
&gt;&gt;&gt; $ /opt/riak/erts-5.7.5/bin/erlc -o /tmp /tmp/bucket\\_inspector.erl
&gt;&gt;&gt; $ riak attach
&gt;&gt;&gt; (riak@127.0.0.1)1&gt; code:add\\_path("/tmp").
&gt;&gt;&gt; (riak@127.0.0.1)2&gt; m(bucket\\_inspector).
&gt;&gt;&gt; (riak@127.0.0.1)3&gt; bucket\\_inspector:inspect(&lt;&lt;"bucket"&gt;&gt;, 
&gt;&gt;&gt; 'riaksearch@127.0.0.1').
&gt;&gt;&gt; And it works.
&gt;&gt;&gt; 
&gt;&gt;&gt; Now, if I want to run that non-interactively, as a script, how should I 
&gt;&gt;&gt; proceed?
&gt;&gt;&gt; 
&gt;&gt;&gt; I played around with escript but I can't seem to load the Riak path (so the 
&gt;&gt;&gt; script will fail at `code` et al)
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; 
&gt;&gt;&gt; Francisco
&gt;&gt; 
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

