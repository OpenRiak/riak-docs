---
title: "Re: 50-100 ops/sec on a 5 Node cluster"
description: ""
project: community
lastmod: 2012-06-26T09:44:22-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07793"
mailinglist_parent_id: "msg07792"
author_name: "Yousuf Fauzan"
project_section: "mailinglistitem"
sent_date: 2012-06-26T09:44:22-07:00
---


My client is multi threaded. Instead of haproxy I had ELB in from of my
cluster

On Tuesday, June 26, 2012, Yousuf Fauzan  wrote:
&gt; I used ephemeral storage without any improvement.
&gt;
&gt; Also iotop and iostat did not show any saturation.
&gt;
&gt; After talking with Sean Cribbs on IRC, I tried disabling nagle in riak
config, changed IO scheduler to noop, decreased cache size to 1 MB from 372
MB, removed load balancer.
&gt;
&gt; After doing all this too, there was absolutely no change in throughput.
&gt;
&gt; For Basho bench, I used examples/riakc\\_pb.config.
&gt;
&gt;
&gt;
&gt; On Tuesday, June 26, 2012, Reid Draper  wrote:
&gt;&gt;
&gt;&gt; On Jun 26, 2012, at 11:48 AM, David Smith wrote:
&gt;&gt;
&gt;&gt;&gt; What does your basho\\_bench config file look like?
&gt;&gt;&gt;
&gt;&gt;&gt; Seeing a low number of ops/sec is usually an indicator that you're
&gt;&gt;&gt; hitting a bottleneck on the I/O path -- typically due to random reads.
&gt;&gt;&gt; LevelDB has a number of characteristics that can make this worse --
&gt;&gt;&gt; what happens if you use bitcask?
&gt;&gt;&gt;
&gt;&gt;&gt; D.
&gt;&gt;&gt;
&gt;&gt;&gt; On Tue, Jun 26, 2012 at 4:57 AM, Yousuf Fauzan 
wrote:
&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Here is my setup of Riak 1.1.4
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 5 Nodes
&gt;&gt;&gt;&gt; ami-a29943cb (EC2 AMI)
&gt;&gt;&gt;&gt; m1.large (7.5GB Ram, 4 EC2 compute instances)
&gt;&gt;&gt;&gt; EBS storage
&gt;&gt; I'd recommend giving ephemeral storage a shot as well. It tends to have
significantly less variable performance than EBS.
&gt;&gt;&gt;&gt; LevelDB backend
&gt;&gt;&gt;&gt; Python Client with Protobuf (on a separate machine)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; While loading data I am getting around 50 ops/sec.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I tried running basho benchmark on the setup and it showed 100 ops/sec
&gt;&gt;&gt;&gt; throughput.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; After talking to people or Riak IRC, I realized that upwards of 1.5K
ops/sec
&gt;&gt;&gt;&gt; is what I should be getting.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Could anyone help me in figuring out what I am doing wrong?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Yousuf
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Dave Smith
&gt;&gt;&gt; VP, Engineering
&gt;&gt;&gt; Basho Technologies, Inc.
&gt;&gt;&gt; diz...@basho.com
&gt;&gt;&gt;

&gt;&gt;
&gt;&gt;
