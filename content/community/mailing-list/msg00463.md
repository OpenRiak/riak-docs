---
title: "Re: Riak changing the first two bytes of data?"
description: ""
project: community
lastmod: 2010-05-28T15:18:19-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg00463"
mailinglist_parent_id: "msg00461"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2010-05-28T15:18:19-07:00
---


Your other alternative is to write with the Java client, then download the data 
with an external program like curl, and see if the bytes are mangled before 
they get to Riak (using a hex editor or something). You might even use 
something like Wireshark to see what is sent in the TCP packets, if you want to 
get fancy.

My suspicion is that they are being modified somewhere in the Java stack. Riak 
is completely agnostic about any binary data you give it.

Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://basho.com/

On May 28, 2010, at 6:06 PM, Sam Tingleff wrote:

&gt; It looks like byte values &lt; 0 are consistently modified on read.
&gt; 
&gt; On Fri, May 28, 2010 at 2:58 PM, Sam Tingleff  wrote:
&gt; Yeah, you're right... I'm sending as application/octet-stream. Is there some 
&gt; special handling depending on content-type?
&gt; 
&gt; 
&gt; On Fri, May 28, 2010 at 2:56 PM, Sean Cribbs  wrote:
&gt; It seems more than just the first two bytes are changed. What content-type 
&gt; are you sending the data as?
&gt; 
&gt; Sean Cribbs 
&gt; Developer Advocate
&gt; Basho Technologies, Inc.
&gt; http://basho.com/
&gt; 
&gt; On May 28, 2010, at 5:46 PM, Sam Tingleff wrote:
&gt; 
&gt; &gt;
&gt; &gt; It sounds crazy, I know.
&gt; &gt;
&gt; &gt; I'm using the Java client with riak 0.10.1-1. Sending a byte array seems to 
&gt; &gt; work if it is a UTF-8 encoded string. But if I send serialized object data, 
&gt; &gt; or just compressed bytes, the first two bytes seem to come back modified on 
&gt; &gt; read.
&gt; &gt;
&gt; &gt; From the debugger... Sending:
&gt; &gt; [31, -117, 8, 0, 0, 0, 0, 0, 0, 0, -53, 72, -51, -55, -55, 87, 72, 41, 77, 
&gt; &gt; 73, 5, 0, 108, 24, 72, 30, 10, 0, 0, 0]
&gt; &gt;
&gt; &gt; I get back:
&gt; &gt; [31, 63, 8, 0, 0, 0, 0, 0, 0, 0, -24, 72, -22, -125, -125, 87, 72, 41, 77, 
&gt; &gt; 73, 5, 0, 108, 24, 72, 30, 10, 0, 0, 0]
&gt; &gt;
&gt; &gt; What's going on? Thanks!
&gt; 
&gt; 
&gt; 

