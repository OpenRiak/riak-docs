---
title: "Re: Correct way to use pbc/mapreduce to do multiget where keys and	bucket names are binary values?"
description: ""
project: community
lastmod: 2011-06-02T01:01:08-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03528"
mailinglist_parent_id: "msg03524"
author_name: "Russell Brown"
project_section: "mailinglistitem"
sent_date: 2011-06-02T01:01:08-07:00
---


Hi Jaques,

Where to start...hm.

On 2 Jun 2011, at 02:47, Jacques wrote:

&gt; I'm using Java and looking to replicate multi-get using a map-only job per 
&gt; everyone's recommendation.
&gt; 
&gt; My bucket and key names are binary values, not strings.
&gt; 
&gt; I attempted to run a map reduce job using a json input object, base 64 
&gt; encoding the values. This failed.
&gt; 
&gt; What is the correct way to submit a pbc map reduce job where the inputs info 
&gt; is binary? 
&gt; 
&gt; Thanks,
&gt; Jacques
&gt; 
&gt; 
&gt; 
&gt; Error when trying base 64 values:
&gt; \\*\\* Reason for termination ==
&gt; \\*\\* {json\\_encode,{bad\\_term,{not\\_found,{&lt;&lt;"dGVzdDI="&gt;&gt;,&lt;&lt;"dGVzdEtleQ=="&gt;&gt;}, 
&gt; undefined}}}

This is a bug in the pb interface of Riak that I have patched and will be in 
master soon. The error is because the {not\\_found} term you see in the log is 
not able to be serialised to JSON. The fix is here 
https://github.com/basho/riak\\_kv/pull/103

However, this error just means that your bucket/key combo 
&lt;&lt;"dGVzdDI="&gt;&gt;,&lt;&lt;"dGVzdEtleQ=="&gt;&gt; is not found. Which is another problem all 
together.

Are you're bucket and key names actual binary values, or base64 encoded binary 
values?

Cheers

Russell

&gt; 
&gt; 
&gt; JSON {
&gt; "inputs": [
&gt; [
&gt; "dGVzdDI=",
&gt; "dGVzdEtleQ=="
&gt; ],
&gt; [
&gt; "dGVzdDI=",
&gt; "dGVzdEtleQ=="
&gt; ]
&gt; ],
&gt; "query": [{"map": {
&gt; "keep": true,
&gt; "language": "javascript",
&gt; "source": "function(v) { return [v]; }"
&gt; }}]
&gt; }
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

