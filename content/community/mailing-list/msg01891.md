---
title: "Re: precommit_fail - missing_field"
description: ""
project: community
lastmod: 2011-01-05T07:33:29-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg01891"
mailinglist_parent_id: "msg01889"
author_name: "Rusty Klophaus"
project_section: "mailinglistitem"
sent_date: 2011-01-05T07:33:29-08:00
---


Hi Bogdan,

Can you send me your schema definition?

Best,
Rusty

On Wed, Jan 5, 2011 at 10:27 AM, bogdan  wrote:

&gt;
&gt; Hello,
&gt;
&gt; I have three-node riak search cluster, with buckets enabled for indexing
&gt; and
&gt; the apropriate schema for the index
&gt;
&gt; Using riak http client the document is inserted with success.
&gt;
&gt; But using riak protocol buffer client the following error occurs:
&gt; {error,&lt;&lt;"{precommit\\_fail,{error,missing\\_field,&lt;&lt;\\"value\\"&gt;&gt;}}"&gt;&gt;}
&gt;
&gt; when trying to insert the document like this:
&gt;
&gt; 365&gt; {ok, Pid1} = riakc\\_pb\\_socket:start\\_link(Server, 8087).
&gt; 366&gt; f(Obj),Obj = riakc\\_obj:new(&lt;&lt;"noi"&gt;&gt;, &lt;&lt;"0000314855"&gt;&gt;,
&gt; term\\_to\\_binary(Data), list\\_to\\_binary("application/x-erlang-term")).
&gt; {riakc\\_obj,&lt;&lt;"noi"&gt;&gt;,&lt;&lt;"0000314855"&gt;&gt;,undefined,[],
&gt; {dict,1,16,16,8,80,48,
&gt; {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],...},
&gt;
&gt; {{[],[],[],[],[],[],[],[],[],[],[[&lt;&lt;...&gt;&gt;|...]],[],[],...}}},
&gt; &lt;&lt;131,108,0,0,0,113,97,123,107,0,11,34,100,111,109,97,
&gt; 105,110,95,105,100,34,...&gt;&gt;}
&gt; 367&gt; riakc\\_pb\\_socket:put(Pid1, Obj).
&gt; {error,&lt;&lt;"{precommit\\_fail,{error,missing\\_field,&lt;&lt;\\"value\\"&gt;&gt;}}"&gt;&gt;}
&gt; 368&gt;
&gt;
&gt; The schema defines all fields in the document with their type correctly.
&gt;
&gt; I don't know what causing this problem.
&gt;
&gt; If I insert the same Object into a bucket with index hook disabled,
&gt; everything works fine.
&gt;
&gt; What stopping the pb\\_socket erlang client to insert a document into an
&gt; index-enabled bucket?
&gt;
&gt; Thank you in advanced
&gt;
&gt;
&gt; --
&gt; View this message in context:
&gt; http://riak-users.197444.n3.nabble.com/precommit-fail-missing-field-tp2199170p2199170.html
&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt;

