---
title: "Re: Riak taking up lots memory on a write heavy bucket?"
description: ""
project: community
lastmod: 2012-08-22T15:41:40-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg08350"
mailinglist_parent_id: "msg08077"
author_name: "Mark Phillips"
project_section: "mailinglistitem"
sent_date: 2012-08-22T15:41:40-07:00
---


Sorry for the late response here, Metin.

On Thu, Jul 26, 2012 at 1:08 AM, Metin Akat  wrote:
&gt; Hi list,
&gt;
&gt; I have a bucket with allow\\_mult=false, last\\_write\\_wins=true. I use it to
&gt; store text files (up to 1 megabyte of text). Some of these objects are write
&gt; heavy. The application overwrites them several times a minute (at times).
&gt; Now I see my dev riak node (where I'm still developing the feature) is
&gt; taking up 450M of reserved memory. Is this normal? is this caused by the
&gt; bucket/objects in question? Is it dangerous, will it start eating even more
&gt; memory, or will it auto balance itself (seems likely for now)? How can I
&gt; diagnose what is taking up this memory? Riaknostic doesn't show anything of
&gt; particular interest.
&gt; Also, what are the correct settings to be used for such kind of buckets?
&gt; It's storing data of no high value (n\\_val=1) which is autoexpiring
&gt; (bitcask). It is also indexed in riak search. (btw, is the search index for
&gt; an object auto deleted when that object expires?).
&gt;

So, as far as the memory usage goes, it's hard to say. If you were
using vector clocks, I would say you were creating a huge object via
crazy sibling generation. That said, with lww enabled, it's hard to
say. A few questions:

\\* What size machines are in your dev cluster? How many?
\\* The "riak-admin cluster\\_info" utility [0] might be useful here. Can
you run that and send along the results?

Mark

[0] http://wiki.basho.com/Command-Line-Tools---riak-admin.htm (towards
the bottom)

