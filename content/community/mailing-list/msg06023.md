---
title: "Re: Concurrent use of PCB Erlang Client"
description: ""
project: community
lastmod: 2011-12-21T11:11:17-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg06023"
mailinglist_parent_id: "msg06022"
author_name: "Jeremy Raymond"
project_section: "mailinglistitem"
sent_date: 2011-12-21T11:11:17-08:00
---


I think your right. I was actually experimenting with this earlier today
and saw just the behaviour you described (single thread blocking, queuing,
timeouts, etc).
--
Jeremy


On Wed, Dec 21, 2011 at 2:07 PM, Ciprian Dorin Craciun &lt;
ciprian.crac...@gmail.com&gt; wrote:

&gt; On Wed, Dec 21, 2011 at 21:04, Ciprian Dorin Craciun
&gt;  wrote:
&gt; &gt; On Thu, Dec 15, 2011 at 17:42, Jeremy Raymond 
&gt; wrote:
&gt; &gt;&gt; Hello,
&gt; &gt;&gt;
&gt; &gt;&gt; Are calls to the client riakc\\_pb\\_socket server blocking if I'm reusing
&gt; the
&gt; &gt;&gt; same Pid across multiple threads? The pb\\_socket server will only
&gt; process one
&gt; &gt;&gt; request at a time?
&gt; &gt;&gt;
&gt; &gt;&gt; --
&gt; &gt;&gt; Jeremy
&gt;
&gt;
&gt; (The pevious email was "truncated"... :) )
&gt;
&gt; Disclaimer: I've only roughly used the `riak\\_erlang\\_client` library,
&gt; so take my opinion with a grain of "doubt".
&gt;
&gt; From what I've seen by quickly looking into the Erlang code, it seems
&gt; that:
&gt; \\* one request will block the client process (as it uses normal
&gt; `gen\\_server:call` function);
&gt; \\* but two requests from different processes don't "block" the
&gt; `riakc\\_pb\\_socket` process, as
&gt; \\* internally there is a queue of pending requests, handled in FIFO way;
&gt; \\* but if a lot of requests queue there and stay more than the
&gt; timeout option for `gen\\_server:call` I think they are still going to
&gt; be serviced way after you've received a timeout error in your code;
&gt; (this has to be investigated);
&gt;
&gt; My solution is to create a pool of `riakc\\_pb\\_socket` and
&gt; round-robin through them.
&gt;
&gt; Hope this helps a bit,
&gt; Ciprian.
&gt;
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

