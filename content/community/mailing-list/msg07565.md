---
title: "Re: Java Client Riak Builders..."
description: ""
project: community
lastmod: 2012-05-29T11:05:49-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07565"
mailinglist_parent_id: "msg07564"
author_name: "Brian Roach"
project_section: "mailinglistitem"
sent_date: 2012-05-29T11:05:49-07:00
---


Guido - 

Thanks, looking forward to it. 

Also as an FYI, on Friday I fixed the bug that was causing the requirement of 
the @JsonIgnore for Riak annotated fields without getters. 

- Brian Roach

On May 29, 2012, at 11:52 AM, Guido Medina wrote:

&gt; I will request a "pull request", I fixed it, I enabled @RiakIndex for 
&gt; collection fields AND methods (String, Integer or Collection of any of 
&gt; those), on our coding is working, but still I need to test it more before 
&gt; making it final.
&gt; 
&gt; I will share the details tomorrow, I already created a fork from your master 
&gt; branch.
&gt; 
&gt; Now you can have something like:
&gt; 
&gt; @RiakIndex
&gt; @JsonIgnore
&gt; Collection getNumbers()
&gt; 
&gt; Also this works as index and with no getter (as of 1.0.6-SNAPSHOT) will only 
&gt; be that, an index:
&gt; 
&gt; @RiakIndex
&gt; Collection numbers;
&gt; That will act as index and be ignored as property which is the intention of 
&gt; the index, to be a dynamic calculated value(s) and not as property which 
&gt; requires the caller to call a post-construct.
&gt; 
&gt; And of course, all subclasses of a collection apply.
&gt; 
&gt; Thanks for the answer,
&gt; 
&gt; Guido.
&gt; 
&gt; -----Original Message----- From: Brian Roach
&gt; Sent: Tuesday, May 29, 2012 6:09 PM
&gt; To: Guido Medina
&gt; Cc: riak-users@lists.basho.com
&gt; Subject: Re: Java Client Riak Builders...
&gt; 
&gt; Guido -
&gt; 
&gt; The real fix is to enhance the client to support a Collection, I'll add an 
&gt; issue for this in github.
&gt; 
&gt; What you would need to do right now is write your own Converter (which would 
&gt; really just be a modification of our JSONConverter if you're using JSON) that 
&gt; does this for you.
&gt; 
&gt; If you look at the source for JSONConverter you'll see where the indexes are 
&gt; processed. As it is, the index processing is handled by the 
&gt; RiakIndexConverter class which is where the limitation of requiring the 
&gt; annotated field to be a String is coming from (it's actually buried lower 
&gt; than that in the underlying annotation processing, but that's the starting 
&gt; point for the problem). The actual RiakIndexes class that encapsulates the 
&gt; data and exists in the IRiakObject doesn't have this problem.
&gt; 
&gt; The catch is that you'll need to do all the reflection ugliness yourself, as 
&gt; that's the part that's broken (the annotation processing).
&gt; 
&gt; Basically, in JSONConverter.fromDomain() you would need to replace
&gt; RiakIndexes indexes = riakIndexConverter.getIndexes(domainObject);
&gt; with your own annotation processing. The same would need to be done in 
&gt; JSONConverter.toDomain() at
&gt; riakIndexConverter.populateIndexes(â€¦)
&gt; 
&gt; Obviously this is not ideal and I'm considering it a bug; I'll put this 
&gt; toward to top of the list of things I'm working on right now.
&gt; 
&gt; Thanks,
&gt; Brian Roach
&gt; 
&gt; 
&gt; 
&gt; 
&gt; On May 28, 2012, at 8:03 AM, Guido Medina wrote:
&gt; 
&gt;&gt; Hi,
&gt;&gt; 
&gt;&gt; I'm looking for a work around @RiakIndex annotation to support multiple 
&gt;&gt; values per index name, since the annotation is limited to one single value 
&gt;&gt; per annotated property (no collection support), I would like to know if 
&gt;&gt; there is a way of using the DomainBucketBuilder, mutation & conflict 
&gt;&gt; resolver and at the same time has access to a method signature like 
&gt;&gt; addIndex(String or int)...addIndex(String or int)...build() same as you can 
&gt;&gt; do with RiakObjectBuilder which lacks support for conflict resolution and 
&gt;&gt; mutation style.
&gt;&gt; 
&gt;&gt; Regards,
&gt;&gt; 
&gt;&gt; Guido.
&gt;&gt; 
&gt;&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt; 
&gt; 
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com


\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

