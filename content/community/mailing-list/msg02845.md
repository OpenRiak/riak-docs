---
title: "Re: Python client and allow_mult"
description: ""
project: community
lastmod: 2011-04-01T10:23:12-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg02845"
mailinglist_parent_id: "msg02843"
author_name: "Greg Nelson"
project_section: "mailinglistitem"
sent_date: 2011-04-01T10:23:12-07:00
---


Unfortunately that does seem to be the way the code ends up looking. In fact, 
one gotcha I've noticed is that obj.exists() will be False when 
obj.has\\_siblings() is True. So, you'd probably want to swap your ifs around, 
like:

obj = bucket.get("mykey")

if obj.has\\_siblings():
# do conflict resolution
elif obj.exists():
obj.set\\_data(data)
else:
obj = bucket.new("mykey", data=data)

obj.store() # Also note here that return\\_body=True by default, and even if you 
specify return\\_body=False, the http transport actually ignores this! I have an 
outstanding pull request on github which fixes this.

At the SF Riak Meetup a couple weeks ago, the Yammer guys complained about the 
client library support for Scala / Java. And the Python library leaves much to 
be desired too. It is on github, though, so we should all feel free to 
contribute to it and make it better.
On Friday, April 1, 2011 at 10:08 AM, Eric Moritz wrote: 
&gt; Does anyone have a standard pattern for working with allow\\_mult with
&gt; the Python library? I feels a bit awkward to me. I assume I need to
&gt; do the following:
&gt; 
&gt; data = {"foo": "bar"}
&gt; obj = bucket.get("mykey")
&gt; 
&gt; if not obj.exists():
&gt; obj = bucket.new("mykey", data=data)
&gt; else:
&gt; if obj.has\\_siblings():
&gt; # do conflict resolution
&gt; else:
&gt; obj.set\\_data(data)
&gt; 
&gt; obj.store()
&gt; 
&gt; Is the the way to do it? If so, that seems like a lot of boiler plating to me.
&gt; 
&gt; Eric.
&gt; 
 
