---
title: "Re: Riak behind a Load Balancer"
description: ""
project: community
lastmod: 2012-06-25T04:44:11-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07774"
mailinglist_parent_id: "msg07772"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2012-06-25T04:44:11-07:00
---


Another typical setup is to have each client node have its own haproxy, and
when Riak nodes are added or removed (not a common occurrence, mind you), a
configuration management tool like Chef/Puppet/cfengine/etc can adjust the
config and signal the process to reload it (I think it's `kill -HUP`). Then
your client code also only ever needs to connect to localhost, and doesn't
have to have itself reconfigured.

On Mon, Jun 25, 2012 at 4:40 AM, Samuel Elliott  wrote:

&gt; On Mon, Jun 25, 2012 at 7:36 AM, Matt Black 
&gt; wrote:
&gt; &gt; Dear list,
&gt; &gt;
&gt; &gt; Does anyone have an opinion on the concept of putting a Riak cluster
&gt; behind
&gt; &gt; a load balancer?
&gt;
&gt; It has been done before. there are various results when searching
&gt; "riak haproxy" in your favourite search engine.
&gt;
&gt; &gt;
&gt; &gt; We wish to be able to automatically add/remove nodes from the cluster, so
&gt; &gt; adding an extra layer at the front is desirable. We should also benefit
&gt; for
&gt; &gt; incoming requests behind shared across all nodes.
&gt; &gt;
&gt; &gt; Can anyone see any drawbacks / problems with doing this?
&gt;
&gt; If your load balancer falls over, what do you do then? Highly
&gt; available may go down the pan. Have more than one would be the obvious
&gt; answer.
&gt;
&gt; What do you do when you want to transparently add more machines to
&gt; your load balancer?
&gt;
&gt; Maybe it might be better to have a list of riak nodes stored in a
&gt; separate registry (I'm thinking something like zookeeper), that your
&gt; application servers can then poll for changes (or even subscribe to
&gt; changes) to the list of servers.
&gt;
&gt; Sam
&gt;
&gt; &gt;
&gt; &gt; Thanks
&gt; &gt; Matt
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt;
&gt;
&gt;
&gt; --
&gt; Samuel Elliott
&gt; s...@lenary.co.uk
&gt; http://lenary.co.uk/
&gt; +44 (0)7891 993 664
&gt;


-- 
Sean Cribbs 
Software Engineer
Basho Technologies, Inc.
http://basho.com/
