---
title: "Re: riak-admin leave behavior"
description: ""
project: community
lastmod: 2012-04-23T18:53:44-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg07302"
mailinglist_parent_id: "msg07301"
author_name: "Joseph Blomstedt"
project_section: "mailinglistitem"
sent_date: 2012-04-23T18:53:44-07:00
---


Kyle is correct.

"riak-admin leave" ensures that all replicas are handed off to other
nodes before the leaving node exits the cluster. This has been the
behavior since Riak 1.0 (released last September).

"riak-admin force-remove" is the command which immediately removes a
node from the cluster without ensuring handoff of its replicas. This
is a dangerous command, and is designed to only be used in cases were
the normal, safe leave behavior cannot be used -- eg. when the node
you are removing had a major hardware failure and is unrecoverable.
Using "force-remove" will result in a loss of all replicas living on
the removed node, which will need to be recovered through other means
-- such as read repair.

The standard leave command is an exact opposite of join. Just like a
join, during a leave, you can inspect the current/pending ring state
using "riak-admin member\\_status" as well as see the list of pending
transfers using "riak-admin ring\\_status".

Regards,
Joe

On Mon, Apr 23, 2012 at 6:26 PM, Kyle Kingsbury  wrote:
&gt; On 04/23/2012 06:23 PM, Michael Radford wrote:
&gt;&gt;
&gt;&gt; Can someone from Basho clarify?
&gt;&gt;
&gt;&gt; I understood "handoff" to mean just that it was handing off
&gt;&gt; \\*responsibility\\* for a vnode to another node, and not proactively
&gt;&gt; creating additional replicas of the data. This information just came
&gt;&gt; from our technical contact at Basho on 4/18, so I would assume it's up
&gt;&gt; to date. But I would be happy to learn that riak-admin leave now does
&gt;&gt; the right thing.
&gt;
&gt;
&gt; Not that I work for basho, but I can absolutely confirm that riak-admin
&gt; leave (&gt;= 1.1, don't recall 1.0) does involve taking data the local node is
&gt; responsible for and giving it to the remote node. You can watch the file
&gt; sizes on hosts or network traffic to confirm.
&gt;
&gt;
&gt; --Kyle
&gt;

-- 
Joseph Blomstedt 
Software Engineer
Basho Technologies, Inc.
http://www.basho.com/

