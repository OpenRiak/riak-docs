---
title: "Re: Bulk loading data and \"Could not contact Riak Server\" error"
description: ""
project: community
lastmod: 2011-08-01T14:19:26-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg04169"
mailinglist_parent_id: "msg04168"
author_name: "Jeremiah Peschka"
project_section: "mailinglistitem"
sent_date: 2011-08-01T14:19:26-07:00
---


There are a few things you can do to load data into Riak faster. I blogged 
about it a while back: http://www.brentozar.com/go/riak-writes/

Basically, set w = 0, dw = 0, and return-body = false. This will effectively 
throw data into your Riak cluster as fast as possible and not care if the write 
succeeds. If you actually care about the data, you could set w to 1.
---
Jeremiah Peschka
Founder, Brent Ozar PLF, LLC

On Aug 1, 2011, at 2:13 PM, gtuhl wrote:

&gt; I am currently load testing Riak using riak\\_0.14.2-1\\_amd64.deb with
&gt; fs.file-max set to 503840 for all users.
&gt; 
&gt; I have a reasonably large set of data (hundreds of millions of documents,
&gt; many terabytes in size) that is currently stored in a combination of
&gt; PostgreSQL+Redis and Disco/DDFS. The first for key/value and the second for
&gt; map/reduce to satisfy the full set of user requirements.
&gt; 
&gt; I am trying to consolidate these data sources so trying out a variety of
&gt; different data stores with the potential of satisfying both usage types.
&gt; 
&gt; With Riak, my main challenge is getting this data loaded. Using the PHP
&gt; library I am able to push 100-200 documents/sec. Is there a recommended
&gt; approach to bulk loading data? At that pace it would take a couple months
&gt; to load everything. That is not necessarily a deal breaker, but wanted to
&gt; sniff around for better options.
&gt; 
&gt; Related to this, I did attempt to break up my records and load them with a
&gt; bunch of concurrently running loaders. This actually seems to work fairly
&gt; well with not much of a penalty in terms of documents/sec on any single
&gt; loader process. But, once I reach 4-5 loaders running concurrently I
&gt; consistently get the "Could not contact Riak Server" error and all of my
&gt; loader processes die simultaneously. If I wait a few seconds the Riak
&gt; server does begin to respond again.
&gt; 
&gt; Any idea for approaching this differently? Is attempting to run many
&gt; loaders concurrently a bad idea with Riak?
&gt; 
&gt; I am running a single server right now while I test with bucket nval set to
&gt; 1.
&gt; 
&gt; --
&gt; View this message in context: 
&gt; http://riak-users.197444.n3.nabble.com/Bulk-loading-data-and-Could-not-contact-Riak-Server-error-tp3217091p3217091.html
&gt; Sent from the Riak Users mailing list archive at Nabble.com.
&gt; 
