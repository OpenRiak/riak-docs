---
title: "Re: Link walking and keep field"
description: ""
project: community
lastmod: 2011-10-21T11:37:56-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg05234"
mailinglist_parent_id: "msg05180"
author_name: "Sean Cribbs"
project_section: "mailinglistitem"
sent_date: 2011-10-21T11:37:56-07:00
---


Anton,

Sorry for the delay. Yes you can use MapReduce link-phases in a similar way,
but unlike the link-walking resource, the objects pointed to in each phase
will not be returned. The way link-walking does its work is to split the
URL into segments for each phase that has keep=true (1), then issue a
MapReduce request for the traversal up to the first keep, then take the
results of that and feed it to another that goes up to the next keep, and so
on. So your link-walking query is actually more like:

[users/userid] -&gt; link(projects, \\_, 1) -&gt; map\\_value
(results from previous) -&gt; link(parts, \\_, 1) -&gt; map\\_value
(results from previous) -&gt; link(units, \\_, 1) -&gt; map\\_value


On Mon, Oct 17, 2011 at 2:21 PM, Anton Podviaznikov
wrote:

&gt; Hi,
&gt;
&gt; I had question about Link walking.
&gt; I need to walk links in few levels and keep results from previous steps.
&gt; I managed to achieve this using URL syntax
&gt; /users/userid/projects,\\*,1/parts,\\*,1/units,\\*,\\*
&gt; Here I find all user's projects than parts and finally units.
&gt;
&gt; However I couldn't achieve the same results using map-reduce and link
&gt; phases.
&gt;
&gt; curl -X POST -H "content-type: application/json"
&gt; http://localhost:8098/mapred --data @-&lt;&lt;\\EOF
&gt; {"inputs":[["users","userid"]],"query":[{"link":{"bucket":"projects","keep":true}},{"link":{"bucket":"parts","keep":true}},{"link":{"bucket":"units"}},{"map":{"language":"javascript","source":"function(v)
&gt; { return [v]; }"}}]}
&gt; EOF
&gt;
&gt;
&gt; I got full documents from last step but for projects and parts I got only
&gt; bucket, key and tag (there was no document body and metadata).
&gt;
&gt; Is it some problem in map function? Any hints, advises?
&gt;
&gt; Best regards,
&gt; Anton Podviaznikov
&gt;
&gt; \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
&gt; riak-users mailing list
&gt; riak-users@lists.basho.com
&gt; http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com
&gt;
&gt;


-- 
Sean Cribbs 
Developer Advocate
Basho Technologies, Inc.
http://www.basho.com/
\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\\_lists.basho.com

