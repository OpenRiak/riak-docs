---
title: "Re: crash after single insert"
description: ""
project: community
lastmod: 2011-05-09T07:09:46-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg03288"
mailinglist_parent_id: "msg03287"
author_name: "Nico Meyer"
project_section: "mailinglistitem"
sent_date: 2011-05-09T07:09:46-07:00
---


Hi Dave,

I believe problem occours if there happens to be another process with
the same PID as the old (now gone) riak node. This can happen if the
machine was rebooted since the riak node crashed or if the PIDs wrapped,
they are only two bytes after all.
os\\_pid\\_exists/1 only checks for ANY process with the PID from the
lockfile
(https://github.com/basho/bitcask/blob/master/src/bitcask\\_lockops.erl#L116).

Am Montag, den 09.05.2011, 07:06 -0600 schrieb David Smith:
&gt; On Sat, May 7, 2011 at 9:25 AM, Gary William Flake  wrote:
&gt; &gt; That was it, Nico. Thanks.
&gt; &gt;
&gt; &gt; I know we did a forced shutdown this week, which was probably the cause. 
&gt; &gt; But I would have thought that riak would have taken care of its own lock 
&gt; &gt; file bookkeeping on restarting.
&gt; 
&gt; Bitcask does:
&gt; 
&gt; https://github.com/basho/bitcask/blob/master/src/bitcask\\_lockops.erl#L46
&gt; 
&gt; It's curious that the logic didn't handle the case. What platform/OS
&gt; are you on? Are you using init scripts to restart on boot?
&gt; 
&gt; Thanks,
&gt; 
&gt; D.

