---
title: "Re: Riak fails to start"
description: ""
project: community
lastmod: 2013-01-21T03:00:04-08:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg09851"
mailinglist_parent_id: "msg09828"
author_name: "Daniel Iwan"
project_section: "mailinglistitem"
sent_date: 2013-01-21T03:00:04-08:00
---


THe issue was that one of the ring snapshot files had size 0

user@node1:~$ ls -la /var/lib/riak/ring/
total 32
drwxr-xr-x 2 riak riak 138 Jan 17 10:27 .
drwxr-xr-x 7 riak riak 129 Jan 17 13:22 ..
-rw-rw-r-- 1 riak riak 12584 Jan 15 17:19
riak\\_core\\_ring.default.20130115171955
-rw-rw-r-- 1 riak riak 12584 Jan 17 10:27
riak\\_core\\_ring.default.20130117102756
-rw-rw-r-- 1 riak riak 0 Jan 17 10:27
riak\\_core\\_ring.default.20130117102757

After deleting it riak process started correctly.
I guess riak process should check if ring file is corrupted or 0 bytes
long, delete/rename it automatically
and use previous version?

Regards
Daniel

On 17 January 2013 14:00, Daniel Iwan  wrote:

&gt; One of our nodes fails to start
&gt;
&gt; $ sudo riak console
&gt; Attempting to restart script through sudo -H -u riak
&gt; Exec: /usr/lib/riak/erts-5.9.1/bin/erlexec -boot
&gt; /usr/lib/riak/releases/1.2.1/riak -embedded -config
&gt; /etc/riak/app.config -pa /usr/lib/riak/lib/basho-patches
&gt; -args\\_file /etc/riak/vm.args -- console
&gt; Root: /usr/lib/riak
&gt; Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:4:4] [async-threads:64]
&gt; [kernel-poll:true]
&gt;
&gt; \\*\\* /usr/lib/riak/lib/basho-patches/etop\\_txt.beam hides
&gt; /usr/lib/riak/lib/observer-1.1/ebin/etop\\_txt.beam
&gt; \\*\\* Found 1 name clashes in code paths
&gt; 13:22:47.424 [info] Application lager started on node 'riak@10.173.240.1'
&gt; 13:22:47.466 [error] CRASH REPORT Process &lt;0.149.0&gt; with 0 neighbours
&gt; exited with reason: bad argument in call to erlang:binary\\_to\\_term(&lt;&lt;&gt;&gt;) in
&gt; riak\\_core\\_ring\\_manager:read\\_ringfile/1 line 154 in gen\\_server2:init\\_it/6
&gt; line 384
&gt; /usr/lib/riak/lib/os\\_mon-2.2.9/priv/bin/memsup: Erlang has closed.
&gt; Erlang
&gt; has closed
&gt;
&gt; {"Kernel pid terminated",application\\_controller,"{application\\_
&gt; start\\_failure,riak\\_core,{shutdown,{riak\\_core\\_app,start,[normal,[]]}}}"}
&gt;
&gt; Crash dump was written to: /var/log/riak/erl\\_crash.dump
&gt; Kernel pid terminated (application\\_controller) ({application\\_start\\_failure,
&gt; riak\\_core,{shutdown,{riak\\_core\\_app,start,[normal,[]]}}})
&gt;
&gt;
&gt; Which suggest that something happened to ring files?
&gt;
&gt; Any idea what and why it happened?
&gt;
&gt; Dump file available at:
&gt; http://www.filedropper.com/erlcrash
&gt;
&gt; Regards
&gt; Daniel
&gt;
&gt;
&gt;
